'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[13],{1035:function(r,C,a){a.d(C,"a",function(){return c});r=a(0);class c{}c.Kvb="CommentPaneTextbox";c.cMe="CommentDeleteButton";c.jMe="CommentSaveButton";c.iMe="CommentReplyButton";c.bMe="CommentCancelButton";c.b$c="CommentTextEntry";c.qhh="TaskPaneClose";c.mhh="CommentPaneCloseButton";c.$9c="CommentTabHelp";Object(r.a)(c,"CommentManagerConstants",null,[])},1385:function(r,C,a){a.d(C,"a",function(){return z});r=
a(0);var c=a(88),b=a(1386),e=a(274),f=a(6),d=a(189),h=a(326),l=a(906),k=a(597),u=a(469),v=a(907),x=a(187),w=a(147),m=a(111),t=a(27);class z{constructor(y){this.iia=this.dA=this.IB=null;this.mmb=0;this.eGa=this.JB=this.Nc=null;this.mre=!1;this.ROc=null;this.oad=!0;this.Na=y;this.Ih()}get fi(){return this.IB}get model(){return this.dA}get quh(){return f.AFrameworkApplication.xTj}get G6j(){return f.AFrameworkApplication.xgg}get Xvh(){return CommonUIStrings.l_DeleteCommentConfirm}get Qmg(){return!1}get Byh(){return!1}get VYi(){return!1}get JJj(){return!1}get p6a(){return this.JB}set p6a(y){this.JB=
y}get mode(){return this.mmb}set mode(y){y!==this.mmb&&(this.mmb=y,-1!==this.mmb&&(this.IB.ncb(),this.dA.ncb()))}get Fqa(){return this.mre}set Fqa(y){this.mre=y}get exj(){return!1}get nig(){return!0}dispose(){this.IB&&(this.IB.dispose(),this.IB=null);this.dA&&(this.dA.dispose(),this.dA=null);this.iia&&(this.iia.dispose(),this.iia=null)}selectComment(y,D=1){const H=this.dA.Ou(y);!H||2===this.mode&&1!==H.commentType||(this.dA.selectComment(H),this.iia.highlightComment(H,!0),this.IB.selectComment(H,
D),1===D&&this.Fqa&&this.JB.selectComment(y))}QP(){const y=this.dA.QP();y&&(this.iia.highlightComment(y,!0),this.IB.selectComment(y),this.Fqa&&this.JB.selectComment(y.id))}ET(){const y=this.dA.ET();y&&(this.iia.highlightComment(y,!0),this.IB.selectComment(y),this.Fqa&&this.JB.selectComment(y.id))}Uag(y){y?this.selectComment(y,0):this.IB.ZGd&&this.JL().ag.Km(this.IB.ZGd)}Dw(){this.dA.Dw();this.Fqa&&this.JB.selectComment(null)}paneClosing(){this.Byh||(2===this.mmb?(this.Dw(),this.deleteComment(this.dA.Tu)):
this.Dw())}Yrb(y){if(1===this.mode){y=b.a.Nph(y);var D=({anchor:H}={returnValue:0,anchor:null}).returnValue;if(H&&0===D)this.addComment(y,H);else{switch(D){case 1:y=CommonUIStrings.l_NewCommentError;break;case 2:y=CommonUIStrings.l_NewCommentInvalidContent;break;default:y=CommonUIStrings.l_NewCommentError}var H=new w.StandardDialog;H.Ac=0;H.Rqa(CommonUIStrings.l_DefaultDialogTitle,y,null)}}}addComment(y){0!==this.mode&&(this.dA.USg(y),this.IB.W5f(y),0===y.commentType||this.VYi||this.selectComment(y.id),
this.Na.processAction(t.a.fMe,2))}editComment(y,D){1===this.mode&&y&&(this.dA.bfd(y,D),this.IB.Q5f(y),this.selectComment(y.id))}tbh(y){this.dA.RHe();this.IB.Q5f(y)}addReply(y,D){1===this.mode&&(y=this.dA.cmh(y,D),this.IB.W5f(y),this.selectComment(y.id,0),this.Na.processAction(t.a.commentReply,2))}deleteComment(y){if(1!==this.mode)if(2===this.mode){if(1!==y.commentType)return;this.mode=1}else return;this.nig&&1!==y.commentType?(this.eGa=y,y=new w.StandardDialog,y.Ac=4,y.R2(2),y.mjg(CommonUIStrings.l_DefaultDialogTitle,
this.Xvh,Object(c.a)(this,this.awh,"deleteDialogHandler"))):this.zbc(y)}Ih(){this.Na.pf(t.a.fhh,m.a.frame,d.ActionManager.fh,64);this.Na.pf(t.a.ghh,m.a.frame,d.ActionManager.fh,64);this.Na.pf(t.a.hhh,m.a.frame,d.ActionManager.fh,64);this.Na.Hc(t.a.W9c,m.a.frame,d.ActionManager.fh);this.Na.Hc(t.a.commentDelete,m.a.frame,d.ActionManager.fh);this.Na.Hc(t.a.dMe,m.a.frame,d.ActionManager.fh);this.Na.pf(t.a.jhh,m.a.frame,d.ActionManager.fh,64);this.Na.pf(t.a.khh,m.a.frame,d.ActionManager.fh,64);this.Na.Hc(t.a.fMe,
m.a.frame,d.ActionManager.fh);this.Na.Hc(t.a.gMe,m.a.frame,d.ActionManager.fh);this.Na.Hc(t.a.commentReply,m.a.frame,d.ActionManager.fh);this.Na.pf(t.a.nhh,m.a.frame,d.ActionManager.fh,64);this.Na.pf(t.a.phh,m.a.frame,d.ActionManager.fh,64);this.Na.pf(t.a.ohh,m.a.frame,d.ActionManager.fh,64);this.Na.Hc(t.a.lMe,m.a.frame,d.ActionManager.fh);this.Na.Hc(t.a.Jcb,m.a.frame,()=>{this.Jcb();return 32})}awh(y){1===y?this.zbc(this.eGa):(this.eGa&&this.selectComment(this.eGa.id),this.eGa=null)}zbc(y){const D=
y.fl;1===y.commentType?this.Na.processAction(t.a.W9c,2):this.Na.processAction(t.a.commentDelete,2);this.eGa=null;this.Fqa||this.Dw();y=this.dA.deleteComment(y);this.IB.DRd(y);for(let H=0;H<y.length;H++)y[H].dispose();this.Uag(D)}x8b(y,D){0!==this.mode&&(this.Na.processAction(D?t.a.dMe:t.a.lMe,2),this.dA.x8b(y,D))}WKa(y){this.dA.WKa(y);this.mode=1;this.Na.processAction(t.a.gMe,2)}VKa(y){this.dA.VKa(y);this.mode=1}f$c(y,D){this.dA.Ssj(y,D)}v$(y,D,H,F,G){return this.IB.v$(y,D,H,F,G)}rjb(y,D,H,F,G){return this.IB.rjb(y,
D,H,F,G)}JL(){var y=this.Nc.mO(e.AFrame.hq);if(!y){const D=this.Nc.rj(e.AFrame.hq);y=new h.DOMFocusListing(()=>this.fi.Rt);y.Ofb=!0;y.xp(3);y.xp(2);y.xp(4);y.xp(1);y.xp(6);y.xp(5);this.Nc.Cva(()=>this.fi.Rt,D,y);y=this.Nc.mO(e.AFrame.hq);y.cOb();y.y1=!0;y.cLa=!0;D.ul(this.Nc.H4);D.ul(this.Nc.I4)}return y}Jcb(){x.UISurfaces.aJ().then(y=>{var D=Object.assign(new l.a,{target:this.JJj?'[data-unique-id*="ShowCommentsTopBar"]':'[data-unique-id~="ShowCommentsTopBar"]',showCloseIcon:!0,content:CommonUIStrings.l_DeepLinkedCommentDoesNotExistNotification,
calloutProps:Object.assign(new v.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1})});D=y.callout(D);const H=Object.assign(new u.a,{expirationOptions:Object.assign(new k.a,{displayTimeoutSeconds:10,onExpire:Object(c.a)(this,this.dismiss,"dismiss")})});this.ROc=y.addNotification(D,H)})}dismiss(){x.UISurfaces.aJ().then(y=>{y.removeNotification(this.ROc);return this.ROc=null})}static get instance(){return z.Oa||(z.factory?z.Oa=z.factory():null)}static set instance(y){z.Oa=y}}z.Oa=null;z.factory=null;
Object(r.a)(z,"CommentManager",null,[834,835,2])},1386:function(r,C,a){a.d(C,"a",function(){return e});r=a(0);var c=a(6),b=a(667);class e{constructor(){this.Sf=null;this.Qj=[];this._changes=[];this.OQ=this.Sia=this.Nm=null}get pDa(){return this.Nm}get Tu(){return this.OQ}initialize(f){this.Sf=f}dispose(){const f=this.Qj.length;for(let d=0;d<f;d++)this.Qj[d].dispose();this.Qj=[]}ncb(){this.Nm&&this.Nm.ncb();this.Sia&&this.Sia.ncb()}selectComment(f){this.Dw();f.tDa=1;this.Nm=f;if(f.fl){var d=Array.indexOf(this.Qj,
f);for(--d;0<=d;d--){const h=this.Qj[d];if(h.id===f.fl){h.tDa=2;this.Sia=h;break}}}c.AFrameworkApplication.sa&&c.AFrameworkApplication.sa.Qa.$x&&b.ShyRibbon.bL(1,0)}QP(){if(!this.Qj.length)return null;let f;f=this.Nm?this.FAb(this.Nm,!0):this.Qj[0];this.selectComment(f);return f}ET(){if(!this.Qj.length)return null;let f;f=this.Nm?this.bhc(this.Nm,!0):this.Qj[this.Qj.length-1];this.selectComment(f);return f}Dw(){this.Nm&&(this.Nm.tDa=0,this.Nm=null);this.Sia&&(this.Sia.tDa=0,this.Sia=null)}bfd(f,d){this.Sf.mode=
3;f.commentType=2;f.Ugb=0;f.Iv=d;this.OQ=f}RHe(){this.OQ=null;this.Sf.mode=1}cmh(f,d){var h=this.Ou(f);this.Sf.mode=2;this.OQ=f=a(900).Comment.S$b(c.AFrameworkApplication.userName,f,h.J8a,d);for(d=this.Qj.length-1;0<=d;d--)if(h=this.Qj[d],h.fl===f.fl||h.id===f.fl){Array.insert(this.Qj,d+1,f);break}return f}WKa(f){this.oMe(f,2)}VKa(f){this.oMe(f,4)}deleteComment(f){const d=[],h=Array.indexOf(this.Qj,f);for(;h<this.Qj.length;){const l=this.Qj[h];if(l.id===f.id||l.fl===f.id)Array.removeAt(this.Qj,h),
Array.add(d,l);else break}this.FNb(d,3);-1<Array.indexOf(d,this.OQ)&&(this.OQ=null,this.Sf.mode=1);return d}x8b(f,d){const h=[];let l=Array.indexOf(this.Qj,f);for(;l<this.Qj.length;){const k=this.Qj[l];if(k.id===f.id||k.fl===f.id)k.done=d,Array.add(h,k),l++;else break}this.FNb(h,d?0:1)}pAb(){return Array.clone(this.Qj)}Jrd(){return!!this.Qj&&!!this.Qj.length}Ou(f){for(let d=0;d<this.Qj.length;d++){const h=this.Qj[d];if(h.id===f)return h}return null}FAb(f,d){f=Array.indexOf(this.Qj,f);return f===this.Qj.length-
1?d?this.Qj[0]:null:this.Qj[f+1]}bhc(f,d){return(f=Array.indexOf(this.Qj,f))?this.Qj[f-1]:d?this.Qj[this.Qj.length-1]:null}oMe(f,d){const h=[];f.commentType=0;Array.add(h,f);this.FNb(h,d);this.OQ=null}static Nph(f){return a(900).Comment.S$b(c.AFrameworkApplication.userName,null,a(900).Comment.ygj,f)}}Object(r.a)(e,"CommentModel",null,[2,862])},1531:function(r,C,a){a.r(C);r=a(522);C=a(804);var c=a(900),b=a(921),e=a(829),f=a(0),d=a(724),h=a(15),l=a(6),k=a(667),u=a(429),v=a(199),x=a(19),w=a(55),m=a(27),
t=a(63),z=a(1),y=a(150),D=a(30);class H{constructor(wa,hb,Ja){this.excelCommentManager=wa;this.commentTaskPane=hb;this.$=Ja}dispose(){this.commentTaskPane=this.excelCommentManager=null}yd(wa,hb){wa=!0;switch(hb){case 467845448:case -1667294294:case -189526492:case -1213022552:wa=this.excelCommentManager.isCommentOperationEnabled(H.B9e(hb));break;case 557817481:wa=this.excelCommentManager.zth&&e.a.xt(this.$);break;case 2041505397:wa=!this.excelCommentManager.hasCommentAtActiveCell&&e.a.xt(this.$);
break;case -560890829:wa=!this.excelCommentManager.hasCommentAtActiveCell;break;case -865270283:wa=!!this.excelCommentManager.eo&&this.excelCommentManager.eo.Urd&&(!z.EwaSettings.isChangeGateEnabled("OfficeVSO:7063228_SheetProtectionPasteBugFix")||(new y.a(this.$.ua)).He(1));break;case 1627476102:wa=this.excelCommentManager.eo.GG;break;case -1565161385:wa=this.excelCommentManager.eo.GG&&e.a.xt(this.$)}return!wa}executeCommand(wa,hb){var Ja=!1;wa=hb.command;switch(wa){case -1460047381:this.$.workbookContext.NavigationContentFound||
(Ja=u.a.PF.notificationBar.Y5(CommonUIStrings.l_CommentDeepLinkingCommentNotExists,!1),D.a.cGb()?Ja.image=2:Ja.image=0,u.a.PF.notificationBar.LD(Ja));(Ja=x.h(this.$).tc(null))?(this.excelCommentManager.JCc(Ja.range),this.$.workbookContext.NavigationContentFound&&this.excelCommentManager.fYj()):(h.ULS.sendTraceTag(537167438,12,50,"Deep linking to the comments pane since the target cell was not found"),this.v$(hb,!0,this.$.workbookContext.NavigationContentFound));Ja=!0;break;case 600686207:case 999391620:this.v$(hb,
!1,!1);Ja=!0;break;case -1667294294:Ja=this.excelCommentManager.umg(H.B9e(wa),hb);break;case 467845448:this.excelCommentManager.Yvh(hb);Ja=!0;break;case -189526492:this.excelCommentManager.rQb(!0);Ja=!0;break;case -1213022552:this.excelCommentManager.rQb(!1);Ja=!0;break;case 557817481:this.excelCommentManager.Fnj();Ja=!0;break;case 2041505397:case -560890829:!this.excelCommentManager.eo.GG&&e.a.xt(this.$)?this.excelCommentManager.eo.vbd():this.excelCommentManager.eo.GG&&this.excelCommentManager.eo.adc();
Ja=!0;break;case -865270283:this.excelCommentManager.eo.Add();Ja=!0;break;case 634192287:case 2023967433:this.excelCommentManager.eo.ETh(634192287===wa);Ja=!0;break;case 1627476102:this.excelCommentManager.eo.XYj();Ja=!0;break;case -2078523262:this.excelCommentManager.eo.showOrHideAllNotes();Ja=!0;break;case -1565161385:this.excelCommentManager.eo.Fkh(),Ja=!0}H.yZi.has(wa)&&l.AFrameworkApplication.sa.Qa.$x&&k.ShyRibbon.bL(1,2);return Ja?t.Task.Ua(!0):v.a(wa)}fd(wa,hb){switch(hb.command){case -1460047381:case 600686207:case 999391620:case -1667294294:case 467845448:case -189526492:case -1213022552:case 557817481:case 2041505397:case -560890829:case -865270283:case 634192287:case 2023967433:case 1627476102:case -2078523262:case -1565161385:wa=
!0;break;default:wa=!1}return wa}Cd(){return!1}v$(wa,hb,Ja){this.eSi(wa,hb,Ja);this.excelCommentManager.RK.g2(m.a.rjb,null,2,null,null)}eSi(wa,hb,Ja){const Fa={};Fa.a=this.$.xa.UserSessionId;Fa.b=1===wa.method&&!wa.tabName;Fa.c=!this.commentTaskPane.isVisible;Fa.d=hb;Fa.e=Ja;w.b().Of(31,Fa)}static B9e(wa){switch(wa){case -1667294294:return 1;case 467845448:return 3;case -189526492:return 4;case -1213022552:return 5;default:return 0}}}H.yZi=new Set([557817481,2041505397,-560890829,-865270283,634192287,
2023967433,1627476102,-2078523262,-1565161385]);Object(f.a)(H,"CommentPaneCommandHandler",null,[210,2]);var F=a(52),G=a(426),L=a(40),M=a(100),O=a(149),B=a(35),E=a(72);class I extends d.a{constructor(wa){super(wa);this.L_=null;this.ue()}ue(){if(!this.L_){this.L_=F.GetServiceTaskFactory.create(this.$.da,89,this.ka,this.La);var wa=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateCommonUiStrings",!1)?Object(M.d)(O.a.resolve(B.p,{Wa:this.La})):F.GetServiceTaskFactory.create(this.$.da,
155,this.ka,this.La);const hb=G.a(this.$);wa=[wa,this.L_,hb,Object(E.b)("OfficeVSO:7624847_MigrateOAuthToNewServiceInfra")?Object(M.d)(O.a.resolve(B.ib,{Wa:this.La})):F.GetServiceTaskFactory.Za(this.$.da,349,350,this.La)];L.TaskExtensions.za(L.TaskExtensions.xe(wa,this.ka),()=>{const Ja=this.L_.result;D.a.de()||hb.result.wS(Ja);this.Zd([new H(Ja.excelCommentManager,Ja,this.$)])},this.ka)}}static la(wa){wa.da.Ja(81,new I(wa))}}Object(f.a)(I,"CommentPaneCommandHandlerFactory",d.a,[]);d=a(230);var S=
a(2),J=a(1382),K=a(249);class R{}R.tGh="ewa-ctp";R.Q5="CommentPane";Object(f.a)(R,"CssClassNames",null,[]);var Z=a(7),P=a(273);class V{constructor(){this.type="SharedCommentsTaskPaneProps";this.focusCallback=null}}Object(f.a)(V,"ExcelSharedCommentsTaskPaneProps",null,[]);var Ea=a(777),oa=a(260),ea=a(13),aa=a(16),ia=a(734);const ya=a(20).a.DMh;class za extends K.a{constructor(wa,hb,Ja){super(wa);this.pvf=this.QFb=!1;this.nx=0;this.$za=!1;this.FGa=null;this.kd=(Fa,Ba)=>{Ba.Ag||(this.excelCommentManager.endCommentSession(!0),
this.excelCommentManager.m4a())};this.$=hb;this.taskPaneManager=Ja;P.a(hb).Zi(this);this.$.ik(this.kd);D.a.de()&&(this.isVisible=!1)}iV(wa){this.get_events().addHandler("commentTaskPaneRemoved",wa)}lY(wa){this.get_events().removeHandler("commentTaskPaneRemoved",wa)}UF(wa){this.addHandler("commentTaskPaneVilibilityChanged",wa)}rH(wa){this.removeHandler("commentTaskPaneVilibilityChanged",wa)}get isVisible(){return D.a.de()?this.pvf:super.isVisible}set isVisible(wa){if(D.a.de())this.pvf=wa,this.QFb&&
this.raiseEvent("commentTaskPaneVilibilityChanged");else{const hb=super.isVisible;super.isVisible=wa;hb!==wa&&this.raiseEvent("commentTaskPaneVilibilityChanged")}}get Fg(){return this.isVisible}get Qe(){return oa.a.rhh}get Ji(){return 7}get Dl(){return ya}get uS(){return aa.a.instance.ha(1072)}get titleText(){return aa.a.instance.ha(1072)}get fr(){return 300}get isResizable(){return!1}get Wc(){return this.domElement}get height(){return this.taskPaneManager.hQ.offsetHeight}get excelCommentManager(){return this.FGa}get Nr(){return ea.DOMElementExtensions.Nr+
",div[tabindex]"}get ENi(){return this.taskPaneManager.Oxa(this.Wc,this.titleText,this.fr,this.isResizable,()=>{this.isVisible=this.QFb=!0},()=>{this.QFb=this.isVisible=!1},()=>{this.isVisible=!0},()=>{this.isVisible=!1},this.fr)}get wB(){return D.a.Luf()?Object(S.a)(new J.a,{title:this.titleText,width:this.fr,hideHeader:!1,location:2,contentProps:Object(S.a)(new V,{focusCallback:()=>{this.raiseEvent("commentTaskPaneVilibilityChanged")}}),enableResize:this.isResizable,onOpen:()=>{this.isVisible=this.QFb=
!0},onClose:()=>{this.QFb=this.isVisible=!1},onShow:()=>{this.isVisible=!0},onHide:()=>{this.isVisible=!1},minResizeWidth:this.fr}):this.ENi}Sr(){return D.a.de()?this.$za:this.$za||!z.EwaSettings.isChangeGateEnabled("OfficeVSO:4465901_HideCommentsTaskPaneButtonOnClosePane")&&1<this.taskPaneManager.pF.length}Vu(){return this.$za}LX(wa){this.excelCommentManager.U4i(wa)}dispose(){this.$&&this.$.Wl(this.kd);this.FGa=this.taskPaneManager=this.$=null;super.dispose()}$g(wa,hb){return this.excelCommentManager.setFocus(wa,
hb)}ui(wa){return ea.DOMElementExtensions.zg(this.Wc,wa)}pk(){}Rk(){}QW(wa,hb){const Ja=ea.DOMElementExtensions.Bm(this.domElement.querySelectorAll(this.Nr));return wa.Da.target===Ja&&wa.Da.shiftKey&&(wa=ea.DOMElementExtensions.pC(hb.querySelectorAll(this.Nr)))?(ea.DOMElementExtensions.setFocus(wa),!0):!1}Oh(wa){this.$za=wa;const hb=this.taskPaneManager;if(D.a.de())wa?hb.m9("CommentTaskPane",this.wB):hb.hideTaskPane("CommentTaskPane");else{var Ja=ea.DOMElementExtensions.isVisible(hb.jQ),Fa=1===hb.pF.length&&
!!hb.Ci&&hb.Ci.taskPane===this;wa&&!Ja?(hb.mD(),h.ULS.sendTraceTag(537167436,12,50,"Comment pane opened.")):!wa&&Fa?(hb.mD(),this.raiseEvent("commentTaskPaneVilibilityChanged")):this.isVisible=wa;wa&&0<hb.pF.length&&(!hb.Ci||7!==hb.Ci.taskPane.Ji||hb.isCollapsed)&&hb.$J(this,!0);this.$.ig()}}static t3g(wa,hb,Ja){let Fa=null;wa.yc&&(Fa=wa.yc.vh("ComponentAttach","AttachCommentTaskPane"),Fa.start());var Ba=wa.qc,fa=document.getElementById(Ba+Z.a.a$c);fa||(fa=za.K7g(wa),D.a.de()||(Ba=document.getElementById(Ba+
Z.a.GX),void 0!==Ba&&null!==Ba?Ba.appendChild(fa):h.ULS.sendTraceTag(537167435,0,10,`CommentTaskPane.AttachCommentTaskPane: couldn't find novTaskPaneBodyDiv. IsAppUnloading: ${wa.SG}`)));Ba=wa.da;hb=Ba.Ba(52)||Ba.Ja(52,new za(fa,wa,hb));hb.excelCommentManager||(fa=x.h(wa),hb.FGa=Ea.ExcelCommentManager.la(wa,fa,fa.ga,hb,wa.ea,Ja));Fa&&Fa.stop();return hb}static K7g(wa){return ia.a("div",wa.qc+Z.a.a$c,R.tGh)}}Object(f.a)(za,"CommentTaskPane",K.a,[153,2,418,26]);class la extends d.a{constructor(wa){super();
this.fi=this.mj=null;this.$=wa;this.uc()}get bF(){if(!this.mj){const wa=F.GetServiceTaskFactory.Za(this.$.da,389,390,this.La),hb=G.a(this.$);this.mj=L.TaskExtensions.za(L.TaskExtensions.xe([hb,wa],this.ka),()=>{this.fi=za.t3g(this.$,hb.result,wa.result)},this.ka,3)}return this.mj}nOi(){const wa=F.GetServiceTaskFactory.create(this.$.da,203,this.ka,this.La),hb=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateCommonUiStrings",!1)?Object(M.d)(O.a.resolve(B.p,{Wa:this.La})):F.GetServiceTaskFactory.create(this.$.da,
155,this.ka,this.La);return[wa,hb]}create(){L.TaskExtensions.za(L.TaskExtensions.ts(L.TaskExtensions.xe(this.nOi(),this.ka),()=>this.bF,this.ka),()=>{this.$b(this.fi)},this.ka,3)}dispose(){this.fi=this.mj=this.$=null;super.dispose()}static la(wa){wa.da.Ja(89,new la(wa))}}Object(f.a)(la,"CommentTaskPaneFactory",d.a,[]);var xa=a(10);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.CommentPane");Type.registerNamespace("_Ewa");r.a.sj(".ewa-ctp .CommentPane{background-color:#fff;overflow:auto;z-index:991}.ewa-ctp .CommentPane p{margin:0}.ConvertCommentText{max-width:300px}");
Type.registerNamespace("Common.Comments");Type.registerNamespace("Common.App.CommentsSmartReply");C.a.prototype.toString=c.Comment.prototype.toString;b.a.prototype.toString=c.Comment.prototype.toString;e.a.prototype.toString=c.Comment.prototype.toString;(()=>{xa.a.Fa(wa=>{la.la(wa);I.la(wa)})})()},777:function(r,C,a){a.r(C);var c=a(0),b=a(2),e=a(15),f=a(1385),d=a(173),h=a(31),l=a(113),k=a(14),u=a(111),v=a(1477),x=a(6),w=a(198),m=a(425);class t{}t.beginDraftingAsync="OSC:BDA";t.aVh="OSC:FEQ";t.selectComment=
"OSC:SC";Object(c.a)(t,"CommentTaskNames",null,[]);class z{constructor(La){this.hTi=La;this.$Si=[]}get handler(){return this.hTi}get mW(){return this.$Si}}Object(c.a)(z,"RegisteredListener",null,[]);class y{constructor(La,Kb){this.type=0;this.payload=null;this.type=La;this.payload=Kb}}Object(c.a)(y,"OfficeSharedCommentsEvent",null,[910]);class D{constructor(){this.eventType=0;this.newViewContainer=null;this.viewContainerVisibilityState=1}}Object(c.a)(D,"ViewContainerEvent",null,[910]);var H=a(315);
class F{constructor(La){this.tEd=!1;this.EX=new w.a;this.asc=La}guj(La){La=new z(La);this.EX.add(La)}ksg(La){for(let Kb=0;Kb<this.EX.count;++Kb)if(this.EX.ma(Kb).handler===La){this.EX.removeAt(Kb);break}}D2(La=!1){const Kb=()=>{if(x.AFrameworkApplication.ih)e.ULS.sendTraceTag(40420181,201,50,"Skipped processing comment pane events since app is shutting down.");else for(let nd=0;nd<this.EX.count;++nd){const Jd=this.EX.ma(nd);for(;0<Jd.mW.length;){var uc=Array.dequeue(Jd.mW);if(Object(m.a)(D,uc)){var Sc=
Jd.handler;Sc(uc)}else Object(m.a)(y,uc)&&(Sc=Jd.handler,Sc(uc.type,uc.payload))}}};La?Kb():this.tEd||(this.tEd=!0,H.a.w1a(this.asc,()=>{Kb();this.tEd=!1},t.aVh))}}Object(c.a)(F,"GenericEventHost",null,[]);class G{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=this.changes=this.commentId=this.comment=this.comments=null;this.virtualized=!1;this.index=0;this.tempId=this.threadIds=null;this.errorType=0;this.tasks=null;this.richTextCapabilityFlags=this.modelCapabilityFlags=
0;this.rehydrationDrafts=this.contextDrafts=this.smartReplies=null}}Object(c.a)(G,"BasicEventPayload",null,[911]);class L{constructor(La){this.nextPopulatedContextDetails=0;this.commentThreadCounts=null;this.isReadOnly=!1;this.isReadOnly=La}}Object(c.a)(L,"CommentContextDetails",null,[]);class M{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=null;this.selectedThreadIndex=0;this.virtualized=!1;this.rehydrationDrafts=this.contextDrafts=null}}Object(c.a)(M,"ContextChangeWithSelectedThreadIndex",
null,[911]);class O{constructor(){this.tasks=this.comments=null}}Object(c.a)(O,"LoadCommentsNoVirtualization",null,[911]);class B extends F{constructor(La){super(La);this.fqe=0}Duj(La,Kb,uc,Sc,nd,Jd,ke=0){La=new z(La);Jd&&Array.enqueue(La.mW,this.VOe(Jd,this.fqe));Jd=Kb?Kb.length:0;Array.enqueue(La.mW,this.aPe(Jd,uc,Sc,ke,null));Jd&&Array.enqueue(La.mW,this.LPe(Kb,nd));this.EX.add(La);this.D2()}z6d(La){this.ksg(La)}RJj(La,Kb,uc,Sc=0,nd=null){this.nna(this.aPe(La,Kb,uc,Sc,nd));this.D2()}SJj(La,Kb,
uc,Sc,nd=0,Jd=null){this.nna(this.snh(La,Kb,uc,Sc,nd,Jd));this.D2()}TJj(La,Kb,uc){this.nna(this.vnh(La,Kb,uc));this.D2()}oKj(La,Kb){this.nna(this.LPe(La,Kb));this.D2()}selectComment(La){this.nna(this.CQe(La,6));this.D2()}highlightComment(La){this.nna(this.CQe(La,7));this.D2()}Nfk(La,Kb){this.nna(this.Uph(La,Kb));this.D2()}Ifk(La){this.nna(this.VOe(La,this.fqe));this.D2()}mNd(La,Kb){this.nna(this.csh(La,Kb));this.D2()}VOe(La,Kb=0){const uc=new G;uc.modelCapabilityFlags=La;uc.richTextCapabilityFlags=
Kb;return new y(12,uc)}aPe(La,Kb,uc,Sc,nd=null){const Jd=new G;Jd.numberOfComments=La;Jd.numberOfThreads=Kb;Jd.contextDetails=Object.assign(new L(uc),{nextPopulatedContextDetails:Sc});Jd.contextDrafts=nd;Jd.rehydrationDrafts=null;return new y(0,Jd)}snh(La,Kb,uc,Sc,nd,Jd=null){const ke=new M;ke.numberOfComments=La;ke.numberOfThreads=Kb;ke.selectedThreadIndex=uc;ke.contextDetails=Object.assign(new L(Sc),{nextPopulatedContextDetails:nd});ke.contextDrafts=Jd;ke.rehydrationDrafts=null;return new y(0,ke)}vnh(La,
Kb,uc){const Sc=new G;Sc.comments=La;Sc.numberOfThreads=Kb;Sc.tasks=uc;return new y(2,Sc)}LPe(La,Kb){const uc=new O;uc.comments=La;uc.tasks=Kb;return new y(1,uc)}CQe(La,Kb){const uc=new G;uc.commentId="";La&&(uc.commentId=La);return new y(Kb,uc)}Uph(La,Kb){const uc=new G;uc.changes=[];uc.contextDetails=Object.assign(new L(Kb),{nextPopulatedContextDetails:La});return new y(10,uc)}csh(La,Kb){const uc=new G;uc.commentId=La;uc.smartReplies=Kb;return new y(15,uc)}nna(La){for(let Kb=0;Kb<this.EX.count;++Kb)Array.enqueue(this.EX.ma(Kb).mW,
La)}}Object(c.a)(B,"OfficeSharedCommentsEventHost",F,[856]);var E=a(108),I=a(88);class S{constructor(){this.actionBehavior=this.actionType=0}}Object(c.a)(S,"CommentUIActionPayload",null,[]);var J=a(270);class K extends J.ScriptSharpLegacyMap{constructor(){super()}}Object(c.a)(K,"UIntDictionary",J.ScriptSharpLegacyMap,[]);class R{constructor(La,Kb){this.Na=La;this.EFa=Kb;this.nMc=new K;for(let uc of this.EFa)this.nMc.ia(uc.value.canvasActionId,uc.key),La=uc.value,La.delayActionsUntilRegistration||
this.Hc(La)}Hc(La){La.withFlags?this.Na.pf(La.canvasActionId,La.canvasContextId,Object(I.a)(this,this.actionHandler,"actionHandler"),97):this.Na.Hc(La.canvasActionId,La.canvasContextId,Object(I.a)(this,this.actionHandler,"actionHandler"))}$Ta(La,Kb){this.EFa.Pb(La)&&(this.EFa.ma(La).delayActionsUntilRegistration&&this.Hc(this.EFa.ma(La)),this.EFa.ma(La).registeredCallback=Kb)}g2(La,Kb,uc,Sc,nd){return this.actionHandler(La,Kb,uc,Sc,nd)}actionHandler(La,Kb,uc,Sc,nd){if(this.nMc.Pb(La)){var Jd=this.nMc.ma(La);
if(!this.EFa.Pb(Jd))return 8;const ke=this.EFa.ma(Jd);if(ke.preCallback){const ne=ke.preCallback(La,Kb,uc,Sc,nd);if(2!==ne)return ne}if(!ke.registeredCallback)return 1===uc?8:2;Jd=Object.assign(new S,{actionType:Jd});1===uc&&(Jd.actionBehavior=1);Jd=ke.registeredCallback(Jd);return ke.postCallback?ke.postCallback(Jd,La,Kb,uc,Sc,nd):Jd?32:8}return 2}}Object(c.a)(R,"OfficeSharedCommentsActionHost",null,[162]);var Z=a(556);class P{static Nhc(La){return La===P.create?0:La===P.reply?1:La===P.edit?2:La===
P.metadata?3:null}}P.create="CREATE";P.reply="REPLY";P.edit="EDIT";P.metadata="METADATA";Object(c.a)(P,"CommentSessionType",null,[]);class V{constructor(La,Kb){this.CommentId=La;this.ResolveState=Kb}}Object(c.a)(V,"CommentProperties",null,[]);var Ea=a(274),oa=a(235),ea=a(27),aa=a(189);class ia{}Object(c.a)(ia,"CommentActivityData",null,[]);var ya=a(175);class za{constructor(La,Kb,uc,Sc,nd,Jd,ke,ne,Ue,of=null,He=null){this.Pve={["CancelCommentCreateThreadAction"]:ea.a.vZd,["CommitComment"]:ea.a.wZd,
["CommitDraftAction"]:ea.a.xZd,["CommitDraftCreateAction"]:ea.a.pEc,["CommitDraftEditAction"]:ea.a.qEc,["CommitDraftReplyAction"]:ea.a.oEc,["CreateReplyAction"]:ea.a.oEc,["CreateReplyWithMentions"]:ea.a.yZd,["CreateReplyWithTaskAssigned"]:ea.a.zZd,["CreateThreadAction"]:ea.a.pEc,["CreateThreadWithMentions"]:ea.a.AZd,["CreateThreadWithTaskAssigned"]:ea.a.BZd,["DeletePostAction"]:ea.a.CZd,["DeleteThreadAction"]:ea.a.DZd,["DeleteThreadWithTask"]:ea.a.EZd,["DiscardDraftAsync"]:ea.a.FZd,["PresentLinkToCommentAction"]:ea.a.mgg,
["ResolveThreadAction"]:ea.a.JZd,["ResolveThreadWithTask"]:ea.a.KZd,["ReopenThreadAction"]:ea.a.GZd,["ReopenThreadWithTask"]:ea.a.HZd,["RequestInitCommentSession"]:ea.a.IZd,["SelectCommentAction"]:ea.a.LZd,["UpdateCommentBodyAction"]:ea.a.qEc};this.dataCenter=this.ring=this.sessionId=this.releaseChannel=this.releaseAudience=this.appVersion=this.appName=null;this.disableUpload=!1;this.sovereignEnvironmentName=null;this.appName=La;this.appVersion=Kb;this.releaseAudience=uc;this.releaseChannel=Sc;this.sessionId=
nd;this.ring=Jd;this.dataCenter=ke;this.disableUpload=ne;this.sovereignEnvironmentName=He;this.Na=Ue;this.goe=of;this.Lvi()}Lvi(){this.Na.Hc(ea.a.vZd,u.a.frame,aa.ActionManager.fh);this.Na.Hc(ea.a.wZd,u.a.frame,aa.ActionManager.fh);this.Na.Hc(ea.a.xZd,u.a.frame,aa.ActionManager.fh);this.Na.Hc(ea.a.oEc,u.a.frame,aa.ActionManager.fh);this.Na.Hc(ea.a.yZd,u.a.frame,aa.ActionManager.fh);this.Na.Hc(ea.a.zZd,u.a.frame,aa.ActionManager.fh);this.Na.Hc(ea.a.pEc,u.a.frame,aa.ActionManager.fh);this.Na.Hc(ea.a.AZd,
u.a.frame,aa.ActionManager.fh);this.Na.Hc(ea.a.BZd,u.a.frame,aa.ActionManager.fh);this.Na.Hc(ea.a.CZd,u.a.frame,aa.ActionManager.fh);this.Na.Hc(ea.a.DZd,u.a.frame,aa.ActionManager.fh);this.Na.Hc(ea.a.EZd,u.a.frame,aa.ActionManager.fh);this.Na.Hc(ea.a.FZd,u.a.frame,aa.ActionManager.fh);this.Na.Hc(ea.a.mgg,u.a.frame,aa.ActionManager.fh);this.Na.Hc(ea.a.JZd,u.a.frame,aa.ActionManager.fh);this.Na.Hc(ea.a.KZd,u.a.frame,aa.ActionManager.fh);this.Na.Hc(ea.a.GZd,u.a.frame,aa.ActionManager.fh);this.Na.Hc(ea.a.HZd,
u.a.frame,aa.ActionManager.fh);this.Na.Hc(ea.a.IZd,u.a.frame,aa.ActionManager.fh);this.Na.Hc(ea.a.LZd,u.a.frame,aa.ActionManager.fh);this.Na.Hc(ea.a.qEc,u.a.frame,aa.ActionManager.fh)}sendULSTrace(La,Kb,uc,Sc){e.ULS.sendTraceTag(La,Kb,uc,Sc)}recordActivity(La){this.Pve[La]&&this.Na.processAction(this.Pve[La],2)}sendOtelEvent(La){ya.a.sendOtelEvent(La)}recordPerfData(La,Kb){this.goe&&(La=Object.assign(new ia,{durationMs:Kb,name:La}),this.goe.QJ(La))}}Object(c.a)(za,"OfficeSharedCommentsTelemetry",
null,[]);var la=a(102),xa=a(126),wa=a(8),hb=a(42),Ja=a(59);const Fa=(La,Kb,uc,Sc,nd,Jd,ke,ne,Ue,of=null)=>{of=La.Pa(9,of);of.options=Kb;of.content=uc;of.anchor=Sc;of.commentId=nd;return Ja.g(La,"ApplyComment",of,Jd,ke,ne,Ue,0)},Ba=(La,Kb,uc,Sc,nd,Jd,ke,ne,Ue,of,He,We,$e=null)=>{$e=La.Pa(9,$e);$e.options=Kb;$e.content=uc;$e.anchor=Sc;$e.commentId=nd;$e.parentCommentId=Jd;$e.isResolved=ke;$e.taskHistoryRecords=ne;return Ja.g(La,"ApplyThreadedComment",$e,Ue,of,He,We,0)},fa=(La,Kb,uc,Sc,nd,Jd,ke=null)=>
{ke=La.Pa(9,ke);ke.commentId=Kb;return Ja.g(La,"UpgradeLegacyComments",ke,uc,Sc,nd,Jd,0)},ta=(La,Kb,uc,Sc,nd,Jd,ke,ne=null)=>{ne=La.Pa(1,ne);ne.activeCell=Kb;ne.findNext=uc;return Ja.g(La,"FindNextOrPreviousComment",ne,Sc,nd,Jd,ke,4)},Oa=(La,Kb,uc,Sc,nd,Jd,ke,ne=null)=>{ne=La.Pa(1,ne);ne.activeCell=Kb;ne.findNext=uc;return Ja.g(La,"FindNextOrPreviousNoteCrossSheet",ne,Sc,nd,Jd,ke,4)},Ma=(La,Kb,uc,Sc,nd,Jd,ke,ne,Ue,of=null)=>{of=La.Pa(1,of);of.objectMetadataType=Kb;of.currentSheetName=uc;of.version=
Sc;of.startIndex=nd;return Ja.g(La,"GetObjectMetadataFromStartIndex",of,Jd,ke,ne,Ue,4)};var fb=a(92),pa=a(276),Ua=a(156),Sa=a(200);class Ia{static get Qkh(){return Ua.a.lq(Ia.NNe,Sa.a.Ha(438),Sa.a.ha(1319))}static get rkh(){return Ua.a.lq(Ia.NNe,Sa.a.Ha(439),Sa.a.ha(1319))}}Ia.NNe="<div class='WACDialogRowNoBreak' id='CCHeaderId'> <label id='ConvertTextContentId' class='ConvertCommentText WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='CCHeaderId'> <a id='ConvertHelpLinkId' class='ConvertHelpLink' href=\"#\" target='_self' >{1}</a> </div>";
Object(c.a)(Ia,"ConvertLegacyCommentDialogHtml",null,[]);var X=a(571),ca=a(12),U=a(16);class ma extends pa.a{constructor(La,Kb,uc,Sc){super(La);this.BC=null;this.Ckh=nd=>{1===nd?(e.ULS.sendTraceTag(25249740,0,50,"ConvertLegacyCommentDialog Continue button pressed."),void 0!==this.Nfb&&null!==this.Nfb&&this.Nfb("InitCommentSession was cancelled by LegacyConvertDialog (Convert Comments)."),this.Pg.upgradeLegacyComments(this.commentId)):(e.ULS.sendTraceTag(25249741,0,50,"ConvertLegacyCommentDialog Cancel button pressed."),
void 0!==this.Nfb&&null!==this.Nfb&&this.Nfb("InitCommentSession was cancelled by LegacyConvertDialog (Cancel)."))};this.tfa=()=>{ca.HelperMethods.iT(this.$.sF,"XLWAEndUser_CommentsConvertLegacy",this.$.wQ)};this.Pg=Kb;this.Nfb=Sc;this.commentId=uc;this.Qg=this.DW();La=this.qmd();this.R2(1);this.Qc(1,U.a.instance.Ha(440));this.initializeAndShow(La,this.Ckh,null);(La=document.getElementById("ConvertHelpLinkId"))?(this.BC=X.a.create(La),this.BC.d_(this.tfa)):e.ULS.sendTraceTag(537167434,0,10,"ConvertLegacyComment Dialog help link not found.");
e.ULS.sendTraceTag(537167433,0,50,"ConvertLegacyComment Dialog opened.")}get dd(){return"ConvertLegacyCommentDialog"}dispose(){this.BC&&this.BC.P9(this.tfa);fb.a.ed([this.BC]);this.BC=null;super.dispose()}DW(){return this.commentId?Ia.Qkh:Ia.rkh}qmd(){return U.a.instance.Ha(this.commentId?436:437)}}Object(c.a)(ma,"ConvertLegacyCommentDialog",pa.a,[]);var ra=a(804);class Va{constructor(){this.zPc={};this.zPc.ops=[]}insertImage(La,Kb){La=this.wbd(La,{});const uc={};uc.base64=Kb.base64;Kb={};Kb.image=
uc;La.optional=Kb;Array.add(this.zPc.ops,La)}insertHyperLink(La,Kb){const uc={};uc.link=Kb.link;this.mQj(uc,Kb);Array.add(this.zPc.ops,this.wbd(La,uc))}wbd(La,Kb){const uc={};uc.insert=La;uc.attributes=Kb;return uc}mQj(La,Kb){this.pVa(Kb.weight>=Va.qWi,La,"weight",Kb.weight);this.pVa(Kb.italic,La,"italic",!0);this.pVa(Kb.underline,La,"underline",!0);this.pVa(Kb.strikethrough,La,"strikethrough",!0);this.pVa(!!Kb.highlight,La,"highlight",Kb.highlight);this.pVa(!!Kb.color,La,"color",Kb.color);this.pVa(!!Kb.paragraph,
La,"paragraph",Kb.paragraph)}pVa(La,Kb,uc,Sc){La&&(Kb[uc]=Sc)}static g$e(La){return Sys.Serialization.JavaScriptSerializer.deserialize(La,!0)}}Va.qWi=700;Object(c.a)(Va,"DeltaFormatCreator",null,[898]);class ob{static get oVi(){return 50}static sbi(La){if(""===La)return"";let Kb=0,uc="";try{const Sc=Va.g$e(La);for(const nd of Sc.ops)if(ob.fzi(nd))Kb||(uc+=ob.u6h(nd.attributes.atmention.fullName)),Kb+=1;else{const Jd=nd.insert?nd.insert:"";" "!==Jd&&0<Jd.length&&(Kb=0,uc+=Jd)}}catch(Sc){e.ULS.sendTraceTag(558428681,
327,10,"Comment formatString could not be deserialized since it is not in a proper Delta Format.")}return uc}static X2h(La){La=ob.sbi(La);return 0<La.length&&La.split(" ").length<=ob.oVi?La:null}static u6h(La){let Kb="";La&&(La=La.split(" "),0<La.length&&(Kb=La[0]));return Kb}static fzi(La){return!!La.attributes&&!!La.attributes.atmention}}Object(c.a)(ob,"BaseCommentSmartReplyHelpers",null,[]);class ja extends ob{constructor(){super()}static Wld(La,Kb,uc=!1){if(!La)return null;La=La.text&&0<La.text.length?
La.text[0]:"";Kb=!Kb||!Kb.fl||""===Kb.fl;return 0<La.length&&Kb&&!uc?ob.X2h(La):null}}Object(c.a)(ja,"CommentSmartReplyHelpers",ob,[]);class lb{constructor(){this.insertIndex=0;this.author=this.updatedSessionParams=this.anchorHintText=this.authorIdentity=this.authorName=null}}Object(c.a)(lb,"InitCommentSessionResult",null,[]);class wb extends lb{constructor(){super();this.updatedDraftSessionConfiguration=null}}Object(c.a)(wb,"BeginDraftingHostResult",lb,[]);var Ab=a(584);class nb{constructor(La,Kb=
"",uc="",Sc="",nd=!1){this.Email=this.DisplayName=this.Provider=this.UserId=null;this.IsCurrentUser=!1;this.UserId=La;this.Provider=Kb;this.DisplayName=uc;this.Email=Sc;this.IsCurrentUser=nd}}Object(c.a)(nb,"OfficeSharedCommentUser",null,[]);var pb=a(84),cb=a(91),Da=a(1),zb=a(107);class qb{constructor(La,Kb,uc,Sc,nd,Jd,ke,ne,Ue=null){this.Pg=La;this.lgg=Kb;this.USj=uc;this.taskManager=Sc;this.$=nd;this.Lfa=Jd;this.zf=ke;this.UKa=ne;this.kMe=Ue}beginDraftingAsync(La){if(!La)return new Promise((nd,
Jd)=>{Jd(H.a.Iu(-2130915327))});const Kb=new wb;var uc=P.Nhc(La.sessionType);if(void 0===uc||null===uc)return new Promise((nd,Jd)=>{Jd(H.a.Iu(-2130915317))});const Sc=this.Pg.mode;if(1!==Sc)return e.ULS.sendTraceTag(537167432,327,10,`Create InitCommentSession Failed. CommentingMode=${Sc}`),new Promise((nd,Jd)=>{Jd(H.a.Iu(-2130915325))});0===uc&&this.Pg.hasCommentAtActiveCell&&(e.ULS.sendTraceTag(537167431,12,50,"Converting Create into Reply"),uc=this.Pg.cE,La.sessionType=P.reply,La.threadId=uc.fl||
uc.id,Kb.updatedSessionParams=La,uc=1);la.FocusManager.instance().vk(Ea.AFrame.hq);switch(uc){case 0:uc=this.P$b(Kb,()=>{Kb.insertIndex=this.Pg.Csi(La)});break;case 1:if(!La.threadId||!La.threadId.length)return new Promise((ne,Ue)=>{Ue(H.a.Iu(-2130915324))});const nd=this.zf.Ou(La.threadId);if(null===nd||void 0===nd?0:nd.done)return new Promise((ne,Ue)=>{Ue(H.a.Iu(-2130915320))});if(this.Pg.Gxd(La.threadId))return this.llj(La.threadId);const Jd=Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartRepliesIsEnabled",
!1),ke=Jd?this.zf.FAb(nd,!1):null;uc=this.P$b(Kb,()=>{Kb.insertIndex=this.Pg.kti(La.threadId,La);if(Jd&&this.kMe&&nd){const ne=ja.Wld(nd,ke,nd.isCurrentUser);ne&&this.kMe.invoke(La.threadId,ne)}});break;case 2:if(!La.commentId||!La.commentId.length)return new Promise((ne,Ue)=>{Ue(H.a.Iu(-2130915324))});if(!this.zf.Ou(La.commentId))return new Promise((ne,Ue)=>{Ue(H.a.Iu(-2130915323))});uc=this.P$b(Kb,()=>{Kb.insertIndex=this.Pg.Gsi(La.commentId,La)});break;case 3:e.ULS.shipAssertTag(537167430,12,this.Pg.MEb,
"Metadata session type start without document tasks enabled.");if(this.Pg.Gxd(La.threadId))throw new ma(this.$,this.Pg,La.threadId,null),H.a.Iu(-2130915316);uc=this.P$b(Kb,()=>{Kb.insertIndex=this.Pg.Wsi(La.threadId,La)});break;default:return new Promise((ne,Ue)=>{Ue(H.a.Iu(-2130915322))})}return uc}commit(La,Kb,uc){const Sc=this.zf.Tu;if(!Sc)throw e.ULS.sendTraceTag(537167429,12,10,"VSO3351297: InvalidCommentDataState- Commiting a draft when InProgressComment is null"),H.a.Iu(-2130915320);const nd=
Sc.Iv;if(!nd)throw e.ULS.sendTraceTag(537167428,12,10,"VSO3351297: InvalidCommentDataState- Commiting a draft when DraftSessionConfiguration is null"),H.a.Iu(-2130915320);const Jd=P.Nhc(nd.sessionType);if(void 0===Jd||null===Jd)throw H.a.Iu(-2130915317);if(La!==nd.draftId)throw H.a.Iu(-2130915327);Kb&&(Kb.endsWith('\\n"}]}')?Kb=Kb.substring(0,Kb.length-6)+'"}]}':e.ULS.sendTraceTag(537167427,12,10,"Comment delta text is expected to end with a newline character."));Sc.text=3===Jd?null:[Kb];uc&&uc.Task&&
this.Pg.f$c(Sc,uc.Task);switch(Jd){case 0:this.Pg.WKa(Sc);this.oqg(uc);this.nqg();break;case 1:this.Pg.WKa(Sc);this.oqg(uc);this.nqg();break;case 2:this.Pg.VKa(Sc);break;case 3:e.ULS.shipAssertTag(537167426,12,!Kb,"Metadata session type has comment text.");Sc.Dsf=!0;this.Pg.xhh(Sc,uc.Resolve);break;default:throw H.a.Iu(-2130915322);}return Sc.id}endCommentSession(La){const Kb=this.zf.Tu;if(Kb&&Kb.Iv&&Kb.Iv.draftId!==La)throw H.a.Iu(-2130915327);this.Pg.endCommentSession(!1)}deleteComment(La){this.Pg.cwh(La)}selectComment(La){this.Pg.Cwd(La)?
this.Pg.pYi():this.Pg.xWd(La,0)}highlightComment(){}setThreadResolvedState(La,Kb){if(this.Pg.Gxd(La))throw new ma(this.$,this.Pg,La,null),H.a.Iu(-2130915316);this.Pg.setThreadResolvedState(La,Kb)}selectFirstThreadInNextCommentContext(){this.Pg.selectFirstThreadInNextCommentContext()}selectLastThreadInPreviousCommentContext(){this.Pg.selectLastThreadInPreviousCommentContext()}presentLinkToComment(La){const Kb={SourceControlId:"LinkToComment"};Kb.navId=this.x5h(La);La=new cb.a(869186573,2,this.$.Tc,
this.Pg.commentTaskPane.isVisible?12:9,null);this.$.Ia.mc(La,Kb)}x5h(La){const Kb=this.p8a(this.$.ua.na);La=btoa("10_{"+La+"}_"+Kb);La=La.replace(RegExp("\\+","g"),"-");La=La.replace(RegExp("\\/","g"),"_");return La=La.replace(RegExp("\\=+$","g"),"")}registerForCommentEvents(La){this.UKa.Pbf().then(Kb=>{this.lgg.Duj(La,this.Pg.lic(),this.Pg.ood(),0===this.Pg.mode,this.Pg.wai(),Kb,this.Pg.R4a)})}unregisterForCommentEvents(La){this.lgg.z6d(La)}registerForAction(La,Kb){this.USj.$Ta(La,Kb)}unregisterForAction(){}loadThreads(){e.ULS.sendTraceTag(537167425,
12,10,"LoadThreads incorrectly called on unsupported platform.")}checkAtMentionCapability(){return this.$.OFb()?new Promise(La=>{La(!1)}):this.Lfa?this.Lfa.atMentionsEnabledAsync():(e.ULS.sendTraceTag(537167424,12,10,"AtMentionEnabled called before initialization."),new Promise(La=>{La(!1)}))}resolveSupported(){return!0}mlj(La){var Kb=this.zf.Tu;if(null===Kb||void 0===Kb?0:Kb.Iv){const uc=Da.EwaSettings.isChangeGateEnabled("OfficeVSO:5703292_ExcelPlumbEmailThroughCG")?Ab.a.UMa(Kb.authorIdentity||
""):"";Kb=new nb(Kb.authorIdentity,Kb.WDe,Kb.author,uc,!0);La.author=Kb}La.authorName=x.AFrameworkApplication.userName;La.authorIdentity=""}P$b(La,Kb){return new Promise((uc,Sc)=>{H.a.w1a(this.taskManager,()=>{try{Kb()}catch(nd){Sc(nd);return}this.mlj(La);uc(La)})})}llj(La){let Kb=null;const uc=new Promise((Sc,nd)=>{Kb=nd});new ma(this.$,this.Pg,La,Kb);return uc}p8a(La){return(La=Object(xa.a)(zb.a,La))?La.sheetId:null}oqg(La){if(Da.EwaSettings.isChangeGateEnabled("OfficeVSO:5065546_CommentsTasksFpsIsEnabled")&&
(null===La||void 0===La?0:La.Task))try{const Kb=pb.a.instance.Dc("Common.ISystemInitiatedFeedback");Kb&&Kb.execute(uc=>{uc.logActivity("ExcelWebCommitTaskActivity","CommentsTasksFpsIsEnabled")})}catch(Kb){e.ULS.sendTraceTag(537167395,12,10,`Exception thrown while triggering ExcelWebCommitTaskActivity. Exception: ${Kb}`)}}nqg(){if(Da.EwaSettings.isChangeGateEnabled("OfficeVSO:4995535_CommentsFpsIsEnabled"))try{const La=pb.a.instance.Dc("Common.ISystemInitiatedFeedback");La&&La.execute(Kb=>{Kb.logActivity("ExcelWebCommitNewCommentActivity",
"CommentsFpsIsEnabled")})}catch(La){e.ULS.sendTraceTag(537167394,12,10,`Exception thrown while triggering ExcelWebCommitNewCommentActivity. Exception: ${La}`)}}}Object(c.a)(qb,"ExcelCommentAPI",null,[892,893]);class Pa{}Object(c.a)(Pa,"ExcelCommentAnchorInfo",null,[891]);class Nb{constructor(La,Kb){this.excelCommentManager=La;this.$=Kb}initialize(){}dispose(){this.$=this.excelCommentManager=null}highlightComment(La){La&&!this.excelCommentManager.zAi(La)&&(this.excelCommentManager.JCc(La.anchor),La.focus())}static createInstance(La,
Kb,uc,Sc,nd){return new Nb(La,Kb,uc,Sc,nd)}}Object(c.a)(Nb,"ExcelCommentHintManager",null,[858,2]);var Tb=a(1386),Vb=a(218),Jb=a(921);class Qa{constructor(La,Kb,uc,Sc,nd,Jd){this.commentType=0;this.parentCommentId=this.commentId=this.anchor=this.content=null;this.isResolved=!1;this.commentType=La;this.content=Kb;this.anchor=uc;this.commentId=Sc;this.parentCommentId=nd;this.isResolved=Jd}getContent(){return this.content}}Object(c.a)(Qa,"MacroRecorderWorkbookCommentedPayload",null,[144]);var Db=a(136),
sa=a(47),Ha=a(201),mb=a(231),qa=a(248),Xa=a(137),Ca=a(55);class va extends Tb.a{constructor(La,Kb,uc,Sc){super();this.ude=0;this.GRb=null;this.oQc="";this.j1i=(nd,Jd,ke)=>{mb.a(nd)?(this.FIf(null,Jd,ke),this.ea.ep(nd.Errors)):(1===this.TSa&&Jd&&e.ULS.shipAssertTag(537167321,12,!!this.Ou(Jd),"can't find the newly created comments."),this.yPi(this.TSa,Jd));this.oAe(Jd);this.oQc=""};this.FIf=(nd,Jd)=>{if(this.excelCommentManager.Fwa||!Jd)e.ULS.shipAssertTag(537167320,12,!!Jd||3===this.TSa,"Only comment deletion can pass an invalid commentId.");
else switch(nd=this.Ou(Jd),this.TSa){case 2:nd?(e.ULS.shipAssertTag(537167319,12,!!nd,"can't find the edited comments."),nd.text=nd.W5j):Xa.b(this.$).Vd(Db.a.Bhh,{["Location"]:"floatie"},void 0,!0);break;case 1:e.ULS.shipAssertTag(537167318,12,!!nd,"can't find the inserted comments.");this.Sf.zbc(nd);break;case 3:e.ULS.shipAssertTag(537167317,12,!nd,"The deleted comment should not exist."),this.excelCommentManager.wVg(Jd)}this.excelCommentManager.ckb(!0);this.oAe(Jd)};this.excelCommentManager=La;
this.$=Kb;this.ga=uc;this.ea=Sc;this.TSa=0}get R4a(){return this.ude}get pW(){return this.oQc}set pW(La){this.oQc=La}USg(La){this.Qrb(La,!0)}Qrb(La,Kb){Kb&&(this.Sf.mode=2,this.OQ=La);if(La.fl)for(Kb=this.Qj.length-1;0<=Kb;Kb--){const uc=this.Qj[Kb];if(uc.fl===La.fl||uc.id===La.fl){this.Qj.splice(Kb+1,0,La);break}}else Kb=La.anchor,e.ULS.shipAssertTag(537167360,12,!!Kb,"Fail to get valid range for newly inserted comment!"),Kb=this.A9e(Kb),this.Qj.splice(~Kb,0,La)}nha(La,Kb){this.Qj.length=0;this.Qj=
La;this.GRb&&(this.GRb.length=0);this.GRb=Kb;this.Nm&&(this.Nm=this.Ou(this.Nm.id));this.Sia&&(this.Sia=this.Ou(this.Sia.id));this.ofk()}npd(){return this.GRb?[...this.GRb]:[]}dek(La,Kb,uc,Sc){this.nha(La,Kb);this.nih(uc,!!La&&0<La.length,Sc)}Zqd(La){let Kb=null;this.ga.pa.rX&&(Kb=this.excelCommentManager.cE,!Kb&&this.excelCommentManager.eo.GG&&e.ULS.shipAssertTag(537167331,12,!1,"Not expecting to reach here when there is a separate button for DeleteNote."));this.applyComment(3,Kb,La)}FNb(La,Kb){if(0!==
this.TSa)e.ULS.sendTraceTag(537167330,12,15,"RecordChanges: Attempting to commit a note/comment change while another operation is in progress.");else{var uc=Object(xa.a)(ra.a,La[0]);if(1!==uc.commentType||3!==Kb){switch(Kb){case 3:1<La.length&&uc.fl&&(uc=Object(xa.a)(ra.a,this.Ou(uc.fl)));La=3;break;case 2:La=1;break;case 4:La=(La=Object(xa.a)(286,uc))&&La.Dsf?7:2;break;case 0:case 1:La=6;break;default:return}this.applyComment(La,uc,null)}}}Ssj(La,Kb){if(this.excelCommentManager.MEb){const Sc=!Kb.taskId;
if(!Sc||La.Iv.sessionType===P.create||Da.EwaSettings.isChangeGateEnabled("OfficeVSO:4017579_DocumentTasksCreateFromReply")&&La.Iv.sessionType===P.reply){var uc=null;La.Iv.sessionType!==P.metadata&&(uc=La.id);Kb=Da.EwaSettings.isChangeGateEnabled("OfficeVSO:4084663_DocumentTasksDefaultTitleEnabled")&&La.text&&0<La.text.length?this.excelCommentManager.Khd.DHf.g7e(uc,Kb,Sc,La.text[0]):this.excelCommentManager.Khd.DHf.g7e(uc,Kb,Sc);La.tze=Kb}else e.ULS.shipAssertTag(537167325,12,!1,"Attempted to create task with invalid session type : "+
La.Iv.sessionType)}}QP(){return this.rQb(!0)}ET(){return this.rQb(!1)}HNa(La){if(0<this.Qj.length&&(e.ULS.shipAssertTag(537167324,12,!!La,"invalid comment range"),La=this.A9e(La),0<=La)){La=this.Qj[La];if(null===La||void 0===La?0:La.fl)La=this.Ou(La.fl);return La}return null}A9e(La){return va.jbf(La,this.Qj)}GAb(La){let Kb=0;La&&(Kb=Array.indexOf(this.Qj,La));return Kb}oAe(La){La&&(La=this.Ou(La))&&(La.Ugb=2);this.Sf.mode=1;this.TSa=0}rQb(La){if(!this.Qj.length)return null;let Kb=null;if(this.Nm||
(Kb=this.Qj[La?0:this.Qj.length-1]).mmc){const uc=this.Nm||Kb;Kb=uc;do Kb=La?this.FAb(Kb,!0):this.bhc(Kb,!0);while((null===Kb||void 0===Kb?0:Kb.mmc)&&Kb!==uc)}this.selectComment(Kb);return Kb}applyComment(La,Kb,uc){Kb&&(Kb.Ugb=1);this.Sf.mode=4;this.TSa=La;const Sc=(null===Kb||void 0===Kb?0:Kb.text)&&0<Kb.text.length?Kb.text[0]:null,nd=Kb?sa.q(Kb.anchor,this.$):sa.r(this.ga.pa.selectedRanges,this.$),Jd=Kb?Kb.id:null,ke=Kb?Kb.done:!1;let ne=null;Kb&&void 0!==Kb.fl&&null!==Kb.fl&&0<Kb.fl.length&&(ne=
Kb.fl);var Ue=Object(xa.a)(286,Kb);e.ULS.shipAssertTag(537167322,12,!Kb||Kb.G$a||!!Ue,"Apply threaded comment operation must have a threaded comment or a note");let of;of=Ue?this.excelCommentManager.Khd.x9j(Ue.tze):null;Ue=new Ha.a(181,0,(He,We,$e)=>Ba(this.$.qa.va,La,Sc,nd,Jd,ne,ke,of,qa.b(He,this.j1i),qa.a(We,this.FIf),$e,Kb?Kb.id:null),1,()=>new Qa(La,Sc,nd,Jd,ne,ke));this.$.userOperationManager.Bd(Ue,uc)}yPi(La,Kb){const uc={};uc.a=this.$.xa.UserSessionId;uc.b=La;uc.c=Kb;uc.d=this.Qj.length;Ca.b().Of(32,
uc)}nih(La,Kb,uc){this.ude=uc?La||Kb?3:2:La?4:Kb?5:1}ofk(){if(this.OQ){var La=this.Ou(this.OQ.id),Kb=this.$.ua.na,uc=P.Nhc(this.OQ.Iv.sessionType);e.ULS.shipAssertTag(537167316,12,!(void 0===uc||null===uc),"Invalid comment draft");La?(e.ULS.shipAssertTag(537167315,12,2===uc,"Expecting an edit draft"),La.Iv=this.OQ.Iv,this.OQ=La):Kb&&this.pW===Kb.sheetId&&this.Qrb(this.OQ,!1)}}static createInstance(La,Kb,uc,Sc){return new va(La,Kb,uc,Sc)}static Oph(La,Kb,uc){return ra.a.S$b(x.AFrameworkApplication.userName,
La,Kb,uc)}static Pph(La,Kb,uc){const Sc={};Sc.DisplayName=x.AFrameworkApplication.userName;Sc.UserId=x.AFrameworkApplication.fa.Va("PresenceUserId");Sc.Provider=x.AFrameworkApplication.fa.Va("PresenceProvider");return Jb.a.xsh(Sc,La,Kb,uc)}static Qph(La,Kb,uc,Sc){const nd={};nd.DisplayName=x.AFrameworkApplication.userName;nd.UserId=x.AFrameworkApplication.fa.Va("PresenceUserId");nd.Provider=x.AFrameworkApplication.fa.Va("PresenceProvider");return Jb.a.ysh(nd,La,Kb,uc,Sc)}static jbf(La,Kb){const uc=
new Vb.a(Kb);return ca.HelperMethods.Ry(uc,0,Kb.length,La,va.Whh)}static hod(La,Kb,uc){La=va.jbf(La,uc);0<=La?La+=Kb?1:-1:(La=~La,Kb||--La);return{returnValue:0<=La&&La<uc.length?uc[La]:null,fsi:La}}static Whh(La,Kb){const {ExcelCommentManager:uc}=a(777);return uc.Qvb(La.anchor,Kb)}}Object(c.a)(va,"ExcelCommentModel",Tb.a,[890,862]);var na=a(563);class Ka{constructor(){this.ire=this.vse=!1;this.kQg=[]}get Cjb(){return this.kQg}get RWa(){return this.vse}set RWa(La){this.vse=La;for(const Kb of this.Cjb)Kb.RWa=
La}get DVa(){return this.ire}set DVa(La){this.ire=La;for(const Kb of this.Cjb)Kb.DVa=La}xra(La){for(const Kb of this.Cjb)La=Kb.xra(La);return La}}Object(c.a)(Ka,"AggregateCommentTaskPersonTransformer",null,[929]);class ib{constructor(La,Kb,uc,Sc,nd=!1){this.priority=this.completion=-1;this.type=La;this.user=Kb;this.time=uc;this.recordId=Sc;this.isLossy=nd}}Object(c.a)(ib,"HistoryRecord",null,[]);class Ra{constructor(La,Kb){this.uKg=new na.a(()=>Kb.xra(La.value))}l4h(){return new Date}Ika(La,Kb,uc){if(0===
La)throw e.ULS.sendTraceTag(594650201,327,10,"CreateBlankHistoryRecord: we do not expect user to be able to create a record of type Unknown in the browser."),Error.argument("recordType");const Sc=d.a.create().toString();uc=new ib(La,this.uKg.value,uc,Sc,!1);uc.commentId=Kb;e.ULS.sendTraceTag(42796192,327,50,"History Record Generated. [RecordType: {0}]",La);return uc}}Object(c.a)(Ra,"HistoryRecordFactory",null,[938]);class ka{constructor(){this.endDate=this.startDate=null}}Object(c.a)(ka,"CommentTaskSchedule",
null,[]);class da{constructor(La,Kb,uc,Sc,nd,Jd){this.isLossy=La;this.title=Kb;this.assignees=uc;this.schedule=Sc;this.completion=nd;this.priority=Jd}}Object(c.a)(da,"CommentTaskState",null,[]);class kb{constructor(){this.commentId=null}}Object(c.a)(kb,"HistoryItem",null,[]);class Ob{constructor(La,Kb,uc,Sc,nd,Jd,ke){this.YSc=!1;if(1!==Kb.type)throw Error.argument("createRecord");this.wmb=uc;this.umb=Sc;this.vmb=nd;this.Cme=1;this.kZb=La;this.gLg=Jd;this._state=new da(!1,this.wmb,ke,new ka,this.vmb,
this.umb);this._history=[];this.VPe(Kb)}N4a(La,Kb){if(1!==La.type)throw Error.argument("createRecordTemplate");const uc=Ob.jgi(La,this.Cme);this.Cme++;return Object.assign(new ib(Kb,La.user,La.time,uc),{commentId:La.commentId})}get Cxf(){return this.history[this.history.length-1]}get gjf(){return this.state.completion===this.vmb}get fjf(){return this.state.priority===this.umb}get hjf(){return(void 0===this.state.schedule.startDate||null===this.state.schedule.startDate)&&(void 0===this.state.schedule.endDate||
null===this.state.schedule.endDate)}get ijf(){return this.state.title===this.wmb}VPe(La){La=Object.assign(new kb,{commentId:La.commentId,records:[La]});this.history.push(La)}h8e(La){let Kb=-1;for(let uc=0;uc<this.state.assignees.length;uc++)if(this.kZb.equals(this.state.assignees[uc],La)){Kb=uc;break}return Kb}ATj(La){const Kb=this.Cxf,uc=Kb.records[Kb.records.length-1];return this.kZb.equals(uc.user,La.user)&&Kb.commentId===La.commentId&&uc.time.getTime()===La.time.getTime()?!0:!1}xhk(La){switch(La.type){case 2:-1===
this.h8e(La.assignee)&&this.state.assignees.push(La.assignee);break;case 3:const Kb=this.h8e(La.assignee);0<=Kb&&this.state.assignees.splice(Kb,1);break;case 4:Array.clear(this.state.assignees);break;case 5:this.state.schedule=La.schedule;break;case 6:this.state.completion=La.completion;break;case 9:this.state.title=La.title;break;case 10:this.state.priority=La.priority;break;case 0:this.state.isLossy=!0;break;case 1:e.ULS.sendTraceTag(595198540,327,10,"Create record passed for state evaluation");
break;case 7:this.YSc=!0;break;case 8:this.YSc=!1;break;case -1:e.ULS.sendTraceTag(51139905,327,10,"Undo record passed for state evaluation");break;default:this.state.isLossy=!0}La.isLossy&&(this.state.isLossy=!0);this.ATj(La)?this.Cxf.records.push(La):this.VPe(La)}get isDeleted(){return this.YSc}get state(){return this._state}get history(){return this._history}Z7h(La){if(!La)return this.history;const Kb=Array.clone(this.history),uc=Kb[0],Sc=uc.records.shift();if(!this.gLg){var nd=this.N4a(Sc,4);
uc.records.unshift(nd)}!La.gjf&&this.gjf&&(nd=this.N4a(Sc,6),nd.completion=this.vmb,uc.records.unshift(nd));!La.fjf&&this.fjf&&(nd=this.N4a(Sc,10),nd.priority=this.umb,uc.records.unshift(nd));!La.hjf&&this.hjf&&(nd=this.N4a(Sc,5),nd.schedule=new ka,uc.records.unshift(nd));!La.ijf&&this.ijf&&(nd=this.N4a(Sc,9),nd.title=this.wmb,uc.records.unshift(nd));La.isDeleted&&(La=this.N4a(Sc,8),uc.records.unshift(La));return Kb}static jgi(La,Kb){return"Synthesized-"+La.recordId+"-"+Kb}}Object(c.a)(Ob,"CommentTaskStateBuilder",
null,[]);var lc=a(1327);class tc{constructor(La,Kb,uc,Sc){this.id=La;this.commentId=Kb;this.currentState=uc;this.history=Sc}}Object(c.a)(tc,"CommentTaskItem",null,[]);class Pb{constructor(La,Kb="",uc="",Sc=""){this.IsCurrentUser=!1;this.UserId=La;this.Provider=Kb;this.DisplayName=uc;this.Email=Sc}}Object(c.a)(Pb,"CommentTaskPerson",null,[928]);const tb=La=>{const Kb=new Pb(La.UserId,La.Provider,La.DisplayName,La.Email);Kb.IsCurrentUser=La.IsCurrentUser;return Kb};var gc=a(1265);a(281);class Xb{constructor(La){this.extensions=
La}}Object(c.a)(Xb,"ExtensionList",null,[]);class Ga{static clone(La){La=Ga.Nfh(La.extensions);return new Xb(La)}static LKe(La){return La?Ga.clone(La):null}static isEmpty(La){return!La.extensions||!La.extensions.count}static Gh(La){return!La||Ga.isEmpty(La)}static Nfh(La){if(!La)return null;const Kb=new gc.a;La.forEach((uc,Sc)=>{Kb.add(uc,Sc);return!0});return Kb}}Object(c.a)(Ga,"ExtensionListExtensions",null,[]);class Za{static clone(La){var Kb=tb(La.user);Kb=new ib(La.type,Kb,La.time,La.recordId,
La.isLossy);Kb.commentId=La.commentId;Kb.anchorExtensionList=Ga.LKe(La.anchorExtensionList);Kb.recordExtensionList=Ga.LKe(La.recordExtensionList);La.assignee&&(Kb.assignee=tb(La.assignee));if(La.schedule){var uc=La.schedule;const Sc=new ka;Sc.startDate=uc.startDate;Sc.endDate=uc.endDate;Kb.schedule=Sc}Kb.completion=La.completion;Kb.title=La.title;Kb.priority=La.priority;Kb.undoId=La.undoId;return Kb}}Object(c.a)(Za,"HistoryRecordExtensions",null,[]);class Sb{constructor(La,Kb,uc,Sc,nd,Jd,ke,ne=!1){this.kZb=
La;this.q0b=Kb;this.Zaa=uc;this.rFg=Sc;this.wmb=nd;this.umb=Jd;this.vmb=ke;this.KZb=ne}ssh(La,Kb,uc,Sc=null){if(!La)throw e.ULS.sendTraceTag(42796181,327,10,"taskId cannot be null."),Error.argumentNull("taskId");if(!Kb)throw e.ULS.sendTraceTag(42796182,327,10,"parentCommentId cannot be null."),Error.argumentNull("parentCommentId");if(!uc||!uc.length)throw e.ULS.sendTraceTag(42796183,327,10,"records cannot be null or empty."),Error.argumentNull("records");if(1!==uc[0].type)throw e.ULS.sendTraceTag(42796184,
327,10,"First record must be a Create record."),Error.argument("First record must be a Create record.");var nd=[],Jd=null,ke=this.snj(uc);for(var ne of uc)if(!ke.contains(ne.recordId))if(uc=this.Uff(ne.commentId,Sc),uc=this.LZh(ne,uc),1===uc.type){let of=[];this.KZb&&Jd&&Jd.state&&(of=Jd.state.assignees);Jd=new Ob(this.kZb,uc,this.wmb,this.umb,this.vmb,this.KZb,of);nd.push(Jd)}else if(Jd)Jd.xhk(uc);else throw e.ULS.sendTraceTag(595198539,327,10,"Undo resulted in ignoring of Task creation without also ignoring records after the create record."),
Error.argument("Undo resulted in ignoring of Task creation without also ignoring records after the create record.");ke=null;ne=[];if(Jd){Jd.isDeleted||(ke=Jd.state);Jd=null;for(var Ue of nd)nd=Ue.Z7h(Jd),Array.addRange(ne,nd),Jd=Ue}Ue=this.Uff(Kb,Sc);ke&&(ke.completion=this.mih(Kb,Sc,ke.completion));return new tc(La,Ue,ke,ne)}g7e(La,Kb,uc,Sc=null){if(!Kb)throw e.ULS.sendTraceTag(42796185,327,10,"update cannot be null."),Error.argumentNull("update");if(uc&&!La)throw e.ULS.sendTraceTag(42796187,327,
10,"CommentId must be specified for task creation."),Error.argument("commentId");const nd=[],Jd=this.Zaa.l4h();if(uc){var ke=this.Zaa.Ika(1,La,Jd);nd.push(ke)}ke=null;if(Kb.assigneeUpdate){if(!Kb.assigneeUpdate.assigneesToAdd||!Kb.assigneeUpdate.assigneesToRemove)throw e.ULS.sendTraceTag(536999254,327,15,"Invalid AssigneeUpdate."),Error.argument("Schedule","Invalid AssigneeUpdate.");for(var ne=0;ne<Kb.assigneeUpdate.assigneesToAdd.length;ne++){var Ue=this.WPe(2,Kb.assigneeUpdate.assigneesToAdd[ne],
La,Jd);Ue&&nd.push(Ue)}for(ne=0;ne<Kb.assigneeUpdate.assigneesToRemove.length;ne++)(Ue=this.WPe(3,Kb.assigneeUpdate.assigneesToRemove[ne],La,Jd))&&nd.push(Ue)}else Kb.assignee&&(uc||(ke=this.Zaa.Ika(4,La,Jd),nd.push(ke)),ne=this.Zaa.Ika(2,La,Jd),ke=this.q0b.xra(Kb.assignee),ne.assignee=ke,nd.push(ne));Kb.title?(Sc=this.Zaa.Ika(9,La,Jd),Sc.title=Kb.title,nd.push(Sc)):uc&&Sc&&(ne=this.Zaa.Ika(9,La,Jd),ne.title=this.rFg.uhi(Sc,ke),nd.push(ne));if(Kb.schedule){if(Kb.schedule.startDate>Kb.schedule.endDate)throw e.ULS.sendTraceTag(42796188,
327,10,"Invalid schedule."),Error.argument("Schedule","Invalid schedule.");Sc=this.Zaa.Ika(5,La,Jd);Sc.schedule=Kb.schedule;nd.push(Sc)}if(void 0!==Kb.completion&&null!==Kb.completion){Sc=Kb.completion;if(0>Sc||100<Sc)throw e.ULS.sendTraceTag(42796189,327,10,"Invalid completion state."),Error.argumentOutOfRange("completion");uc||e.ULS.sendTraceTag(595198538,327,50,"Task progress change. [Progress: {0}]",Sc);uc=this.Zaa.Ika(6,La,Jd);uc.completion=Sc;nd.push(uc)}if(void 0!==Kb.priority&&null!==Kb.priority){Kb=
Kb.priority;if(0>Kb||10<Kb)throw e.ULS.sendTraceTag(42796190,327,10,"Invalid priority state."),Error.argumentOutOfRange("priority");La=this.Zaa.Ika(10,La,Jd);La.priority=Kb;nd.push(La)}return nd}WPe(La,Kb,uc,Sc){if(2!==La&&3!==La)return e.ULS.sendTraceTag(0,327,10,"Assignee field should only be used for an Assign or Unassign HistoryRecord."),null;La=this.Zaa.Ika(La,uc,Sc);La.assignee=this.q0b.xra(Kb);return La}snj(La){const Kb=new lc.a,uc=new lc.a;for(let Sc=La.length-1;0<=Sc;Sc--){const nd=La[Sc],
Jd=uc.contains(nd.recordId);Jd||-1!==nd.type||(uc.contains(nd.undoId)?e.ULS.sendTraceTag(578670598,327,50,"Multiple Undo records attempting to undo the same record."):uc.add(nd.undoId));if(Jd||-1===nd.type)Kb.contains(nd.recordId)?e.ULS.sendTraceTag(578670599,327,50,"Record was already added to records to ignore. There must be multiple records with same ID."):Kb.add(nd.recordId)}return Kb}LZh(La,Kb){const uc=Za.clone(La);uc.commentId=Kb;uc.user=this.q0b.xra(La.user);uc.assignee=this.q0b.xra(La.assignee);
return uc}mih(La,Kb,uc){let Sc=uc;La&&Kb&&(({value:Kb}=Kb.Ad(La)).returnValue?(Sc=Kb.ResolveState?100:100===uc?0:uc,Sc!==uc&&e.ULS.sendTraceTag(592719873,327,50,"Task completion state has been changed to match comment resolution state for comment {0}",La)):e.ULS.sendTraceTag(592719874,327,50,"Comment {0} not found in translation map. Completion unchanged",La));return Sc}Uff(La,Kb){let uc=La;La&&Kb&&(({value:Kb}=Kb.Ad(La)).returnValue?uc=Kb.CommentId:(e.ULS.sendTraceTag(42796191,327,50,"Id not found in translation map. Possible Orphan task candidate [CommentId: {0}]",
La),uc=La));return uc}}Object(c.a)(Sb,"CommentTaskTranslatorImpl",null,[937]);class sb{static initialize(La){sb.jl=La;Sys.UI.DomElement.addCssClass(sb.jl,"HtmlScratchPad");sb.jYd(!1)}static reset(){sb.jl=null}static gei(){let La=sb.Ovg.WordBreakUtils;La||(La=sb.jl.ownerDocument.createElement("div"),sb.jl.appendChild(La),sb.Ovg.WordBreakUtils=La);return La}static u5g(){sb.NWb++;1===sb.NWb&&sb.jYd(!0)}static CDh(){sb.NWb--;sb.NWb||sb.jYd(!1)}static jYd(La){La?Sys.UI.DomElement.removeCssClass(sb.jl,
"Hidden"):Sys.UI.DomElement.addCssClass(sb.jl,"Hidden")}static get isInitialized(){return!!sb.jl}}sb.jl=null;sb.Ovg={};sb.NWb=0;Object(c.a)(sb,"HtmlScratchPadProvider",null,[]);var bc=a(32);class kc{constructor(La,Kb){this.owb=La;this.Rxg=Kb}}Object(c.a)(kc,"WordBreak",null,[]);class vb{constructor(){this.wordCount=0}}Object(c.a)(vb,"WordCountFromWordBreaksResult",null,[]);class ub{constructor(){ub.D0b=null}kaf(La,Kb){Kb=this.jaf(La,Kb);return!Kb||0===Kb.Rxg&&(Kb=this.jaf(La,Kb.owb),!Kb)?La.length:
Kb.owb}m8e(La,Kb){Kb=this.l8e(La,Kb);return!Kb||0===Kb.Rxg&&(Kb=this.l8e(La,Kb.owb),!Kb)?0:Kb.owb}jaf(La,Kb){return this.a7h(La,Kb,La.length)}l8e(La,Kb){return this.z0h(La,Kb)}a7h(La,Kb,uc){if(Kb>=uc-1)return null;let Sc=Kb;for(;Sc<uc;){const nd=this.Nma(La,Sc);switch(nd){case 2:return La=this.z8e(La,Kb,!0),!La||La.owb>=uc?null:La;case 3:case 1:case 0:case 5:case 6:if(Sc>=uc-1)return null;const Jd=Sc+1,ke=this.Nma(La,Jd);if(nd!==ke&&this.Ggg(nd,ke)&&(2!==ke||!ub.Tmg))return new kc(Jd,ke)}Sc+=1}return null}z0h(La,
Kb){if(1>=Kb)return null;let uc=Kb;for(;0<uc;){const Sc=this.Nma(La,uc-1);switch(Sc){case 2:return(La=this.z8e(La,Kb,!1))?La:null;case 3:case 1:case 0:case 5:case 6:if(1>=uc)return null;const nd=uc-1,Jd=this.Nma(La,nd-1);if(Sc!==Jd&&this.Ggg(Sc,Jd)&&(2!==Jd||!ub.Tmg))return new kc(nd,Sc)}--uc}return null}Ggg(La,Kb){return 5===La&&3!==Kb||3===La&&5!==Kb||1===La||6===La||0===La}UDh(){ub.SFa||(ub.SFa=sb.gei(),ub.SFa.className="WACWordBreakSurface")}iek(La){ub.rZ!==La&&(ub.SFa.innerText=La,ub.rZ=La)}z8e(La,
Kb,uc){this.UDh();this.iek(La);let Sc=-1;var nd=!1;h.a.g3d?(Sc=this.c6j(Kb,uc),Kb!==Sc&&(nd=!0)):h.a.Wmg&&(Sc=this.Cqj(Kb,uc),Kb!==Sc&&(nd=!0));nd||(Sc=this.hZi(Kb,uc));nd=-1;uc?Sc>=ub.rZ.length?Sc=-1:Sc===Kb?nd=4:Sc<Kb&&(Sc=-1):(0>=Sc&&(Sc=-1),Sc>=Kb&&(Sc=-1));if(-1===Sc)return null;-1===nd&&(nd=this.Nma(La,Sc));return new kc(Sc,nd)}c6j(La,Kb){x.AFrameworkApplication.Jm.HDb(ub.r$d);ub.tua||(ub.tua=document.body.createTextRange());ub.tua.moveToElementText(ub.SFa);ub.tua.collapse();ub.tua.move("character",
La);Kb?ub.tua.moveEnd("word",1):ub.tua.moveStart("word",-1);var uc=ub.tua.text.length;uc=Kb?La+uc:La-uc;if(0>uc||uc>ub.rZ.length)uc=La;return uc=this.jOe(La,uc,Kb)}Cqj(La,Kb){x.AFrameworkApplication.Jm.HDb(ub.r$d);sb.u5g();const uc=ub.SFa.firstChild,Sc=ub.SFa.ownerDocument.createRange();Sc.setStart(uc,La);Sc.setEnd(uc,La);Sc.expand("word");let nd=Kb?Sc.endOffset:Sc.startOffset;nd===La&&!Kb&&0<La&&(Sc.setStart(uc,La-1),Sc.setEnd(uc,La-1),Sc.expand("word"),nd=Sc.startOffset);nd=this.jOe(La,nd,Kb);sb.CDh();
return nd}jOe(La,Kb,uc){return La===Kb?Kb:uc?this.Clh(La,Kb):this.Blh(La,Kb)}Clh(La,Kb){let uc=!1;for(;La<Kb;La++){const Sc=this.Nma(ub.rZ,La);if(uc){if(1===Sc||0===Sc)return x.AFrameworkApplication.Jm.HDb(ub.s$d),La}else 2===Sc&&(uc=!0)}return Kb}Blh(La,Kb){let uc=!1;for(--La;La>=Kb;La--){const Sc=this.Nma(ub.rZ,La);if(uc){if(1===Sc||0===Sc)return x.AFrameworkApplication.Jm.HDb(ub.s$d),La+1}else 2===Sc&&(uc=!0)}return Kb}hZi(La,Kb){return Kb?this.jZi(La):this.iZi(La)}jZi(La){let Kb=La;for(;Kb<ub.rZ.length&&
2===this.Nma(ub.rZ,Kb)&&!bc.a.vqf(bc.a.charCodeAt(ub.rZ,Kb));)Kb++;Kb===La&&(Kb++,this.Ppf(Kb)&&Kb++);return Kb}iZi(La){let Kb=La;for(;0<Kb&&2===this.Nma(ub.rZ,Kb-1)&&!bc.a.vqf(bc.a.charCodeAt(ub.rZ,Kb-1));)Kb--;Kb===La&&(Kb--,this.Ppf(Kb)&&Kb--);return Kb}Ppf(La){return bc.a.zEi(ub.rZ,La-1)}Nma(La,Kb){La=La.charAt(Kb).toString();return this.Yyi(La)?3:this.wKi(La)?0:this.gGi(La)?1:this.hGi(La)?5:this.DCi(La)?6:2}Yyi(La){return bc.a.Xyi(La.charAt(0))}wKi(La){ub.r0c||(ub.r0c=RegExp("[\\u0000-\\u001F]|\\u0020|[\\u007F-\\u009F]|\\u00A0|[\\u2000-\\u200B]|\\u202F|\\u205F|\\u2420|[\\u2422-\\u2424]|\\u3000|\\uFF02"));
return ub.r0c.test(La)}gGi(La){ub.D0b||(ub.D0b=RegExp("[!-&]|[\\(-\\.]|/|[:-@]|[\\[-`]|[{-~]|\u00a1|\u00a6|\u00a7|\u00a9|\u00ab|\u00ac|\u00ae|\u00b0|\u00b1|[\u00b4-\u00b7]|\u00bb|\u00bf|\u00d7|\u00f7|\u01c3|\u037e|[\u2012-\u2015]|[\u201a-\u2022]|[\u2024-\u2026]|\\u202F|\u2030|\u2039|\u203a|\u203c|\u203d|\u2048|\u2049|\\u2060|\u2103|\u2105|\u2106|\u2109|\u2116|\u2122|\u2211|\u2212|\u221a|\u221e|\u222b|\u2248|\u2260|\u2264|\u2265|\\u25A1|\\u25AA|\\u25AB|\u25ca|\u25cf|\u25e6|[\u2639-\u263b]|\u2762|\\uFEFF|\uff01|\uff0e|\uff1b|\uff1f|\uff61"));
return ub.D0b.test(La)}hGi(La){return"'"===La||"\u2018"===La||"\u2019"===La}DCi(La){return"\ue000"===La}static get Tmg(){return h.a.g3d||h.a.Wmg}static get instance(){ub.Oa||(ub.Oa=new ub);return ub.Oa}}ub.s$d=10265;ub.r$d=10266;ub.r0c=null;ub.D0b=null;ub.SFa=null;ub.rZ="";ub.tua=null;ub.Oa=null;Object(c.a)(ub,"WordBreakUtils",null,[173]);class Ub{constructor(){this.gda=CommonUIStrings.l_Ellipsis}uhi(La,Kb){if(!La)throw e.ULS.sendTraceTag(592998807,327,10,"Missing commentRichText"),Error.argumentNull("commentRichText");
try{var uc=Va.g$e(La)}catch(Ue){throw e.ULS.sendTraceTag(592998806,327,10,"commentRichText not in Delta Format"),Error.format("Improperly formatted Delta text in commentRichText");}var Sc=La=0,nd=0;const Jd=RegExp("\\s+","g"),ke=new Sys.StringBuilder;for(var ne of uc.ops)ne.attributes&&ne.attributes.atmention&&ne.attributes.atmention.email&&Kb&&(uc=ne.attributes.atmention.email,0<uc.length&&(uc===Kb.UserId||uc===Kb.Email||uc===Ab.a.UMa(Kb.UserId))&&(Sc=La,nd=Sc+ne.insert.length)),uc=ne.insert.replace(Jd,
" "),La+=uc.length,ke.append(uc);!nd&&Kb&&e.ULS.sendTraceTag(592998805,327,10,"Assignee was not found in comment text",Kb.Provider);Kb=ke.toString().trimEnd();La=Kb.length;255<La?(ne=(255-(nd-Sc))/2,0>Sc-ne?(La=ub.instance.m8e(Kb,255-this.gda.length),nd=Kb.substring(0,La)+this.gda,La="Trimmed End"):nd+ne>La?(Sc=ub.instance.kaf(Kb,La-255+this.gda.length),nd=this.gda+Kb.substring(Sc,La),La="Trimmed Start"):(Sc=ub.instance.kaf(Kb,Sc-ne+this.gda.length),La=ub.instance.m8e(Kb,nd+ne-this.gda.length),nd=
this.gda+Kb.substring(Sc,La)+this.gda,La="Trimmed Both")):(La="No Trim",nd=Kb);e.ULS.sendTraceTag(592998804,327,50,La);return nd}}Object(c.a)(Ub,"ContentExtractor",null,[]);class Rd{constructor(La,Kb){this.CIg=La;this.vKg=Kb;this.DVa=this.RWa=!1}xra(La){if(!La)return null;if(void 0===La.UserId||null===La.UserId)throw e.ULS.sendTraceTag(593368219,327,10,"Unexpected user missing UserId field"),Error.argumentType();if(La.IsCurrentUser||!this.CIg.equals(this.vKg.value,La))return La;La=tb(La);La.IsCurrentUser=
!0;return La}}Object(c.a)(Rd,"EnsureIsCurrentUserSetTransformer",null,[929]);class Cd{constructor(){this.DVa=this.RWa=!1}xra(La){if(!La)return null;if(void 0===La.UserId||null===La.UserId)return La;if(!La.Email||""===La.Email){let Kb;if(Kb=Ab.a.UMa(La.UserId))return La=tb(La),La.Email=Kb,La}return La}}Object(c.a)(Cd,"RestoreEmailTransformer",null,[929]);class Yc{constructor(){this.DVa=this.RWa=!1}xra(La){if(!La)return null;if(void 0!==La.UserId&&null!==La.UserId)return La;switch(this.RWa?this.DVa?
2:1:0){case 0:if(void 0===La.UserId||null===La.UserId)throw e.ULS.sendTraceTag(593368215,327,10,"assignee missing UserId"),Error.argument("assignee.UserId");La=tb(La);break;case 1:if(void 0===La.Id||null===La.Id)throw e.ULS.sendTraceTag(593368214,327,10,"assignee missing Id"),Error.argument("assignee.Id");if(void 0===La.Email||null===La.Email)throw e.ULS.sendTraceTag(593368213,327,10,"assignee missing Email"),Error.argument("assignee.Email");var Kb=Yc.lVf(La.Id,La.Email,null);if(!Kb||""===Kb)throw e.ULS.sendTraceTag(593368212,
327,10,"Failed to generate UserId"),Error.argument("UserId");var uc=x.AFrameworkApplication.fa.Va("HostAuthType")||"";if("aad"!==uc.toLowerCase()||Kb.startsWith("S::")){if("msa"===uc.toLowerCase())throw e.ULS.sendTraceTag(593368210,327,10,"Unexpected IPersonObject in MSA Environment"),Error.argument("CommentTaskUserType");e.ULS.sendTraceTag(593368209,327,50,"Receiving IPersonObject with AuthType {0}",uc)}else throw e.ULS.sendTraceTag(593368211,327,10,"Unexpected UserID format"),Error.argument("userId");
La=new Pb(Kb,"AD",La.DisplayName,La.Email);break;case 2:if(void 0===La.UserPrincipalName||null===La.UserPrincipalName)throw e.ULS.sendTraceTag(593368208,327,10,"assignee missing UserPrincipalName"),Error.argument("assignee.UserPrincipalName");if(void 0!==La.SuggestionSubtype&&null!==La.SuggestionSubtype)if("OrganizationUser"===La.SuggestionSubtype)Kb="AD";else throw e.ULS.sendTraceTag(593368207,327,10,"Unexpected LPP SuggestionSubtype : {0}",La.SuggestionSubtype),Error.argument("assignee.SuggestionSubtype");
else throw e.ULS.sendTraceTag(593368206,327,10,"Missing SuggestionSubtype"),Error.argument("assignee.SuggestionSubtype");uc=Yc.lVf(La.Id,La.UserPrincipalName,La.AadObjectId);if(!uc||""===uc)throw e.ULS.sendTraceTag(593368205,327,10,"Failed to generate UserId"),Error.argument("UserId");if("AD"===Kb&&!uc.startsWith("S::"))throw e.ULS.sendTraceTag(593368204,327,10,"Unexpected UserID and Provider combination"),Error.argument("userId");La=new Pb(uc,Kb,La.Name,La.UserPrincipalName);break;default:throw e.ULS.sendTraceTag(593368203,
327,10,"Unexpected UserType"),Error.argument("assignee.UserType");}return La}static lVf(La,Kb,uc){if(!Kb||""===Kb)return e.ULS.sendTraceTag(593368218,327,50,"Missing UPN"),La;if(uc&&""!==uc)return"S::"+Kb+"::"+uc;if(!La||""===La)return e.ULS.sendTraceTag(593368217,327,50,"Missing ID"),La;if(La.startsWith("S::"))return La;if(-1!==La.indexOf("@")){uc=La.split("@");if(d.a.isValid(uc[0]))return"S::"+Kb+"::"+uc[0];e.ULS.sendTraceTag(593368216,327,50,"ID is not in AadObjectId@TenantId format")}return La}}
Object(c.a)(Yc,"UserIdCanonicalizationTransformer",null,[929]);class Kd{constructor(La,Kb,uc=!1,Sc=!1){this.DGg=La;this.jce=Kb;this.AKg=uc;this.KZb=Sc}dnh(){const La=new Ab.a;var Kb=new na.a(Kd.R3h);const uc=new Ka;this.jce&&(uc.Cjb.push(new Yc),uc.Cjb.push(new Cd));this.DGg&&uc.Cjb.push(new Rd(La,Kb));uc.RWa=this.jce;uc.DVa=this.AKg;Kb=new Ra(Kb,uc);const Sc=new Ub;return new Sb(La,uc,Kb,Sc,Kd.Cvh,Kd.rvh,Kd.svh,this.KZb)}static R3h(){const La=new Pb(x.AFrameworkApplication.fa.Va("PresenceUserId")||
"",x.AFrameworkApplication.fa.Va("PresenceProvider")||"",x.AFrameworkApplication.userName||"");La.IsCurrentUser=!0;return La}}Kd.Cvh="";Kd.rvh=5;Kd.svh=0;Object(c.a)(Kd,"CommentTaskTranslatorFactory",null,[908]);class oc{constructor(){this.eDf=(new Kd(!0,!0,!0)).dnh()}get DHf(){return this.eDf}D9j(La,Kb){const uc=La.HistoryRecords.length,Sc=Array(uc);for(let nd=0;nd<uc;++nd)Sc[nd]=oc.$kh(La.HistoryRecords[nd]);try{return this.eDf.ssh(La.TaskId,La.AnchorId,Sc,Kb)}catch(nd){return e.ULS.sendTraceTag(50918081,
12,10,`TranslateToSharedCommentTaskItem Failed due to [${nd.message}]`),null}}x9j(La){const Kb=La?La.length:0,uc=Array(Kb);for(let Sc=0;Sc<Kb;++Sc)uc[Sc]=this.w9j(La[Sc]);return uc}w9j(La){const Kb={};Kb.AnchorId=La.commentId;La.assignee&&(Kb.Assignee={},Kb.Assignee.UserId=La.assignee.UserId,Kb.Assignee.Provider=La.assignee.Provider,Kb.Assignee.DisplayName=La.assignee.DisplayName);La.schedule&&(Kb.DueDate=La.schedule.endDate?La.schedule.endDate.getTime():null,Kb.StartDate=La.schedule.startDate?La.schedule.startDate.getTime():
null);Kb.Id=La.recordId;Kb.Priority=La.priority;Kb.Progress=La.completion;Kb.Time=La.time.getTime();Kb.Title=La.title;switch(La.type){case 2:Kb.Type=2;break;case 1:Kb.Type=1;break;case 7:Kb.Type=8;break;case 10:Kb.Type=7;break;case 6:Kb.Type=6;break;case 8:Kb.Type=9;break;case 5:Kb.Type=5;break;case 9:Kb.Type=10;break;case 3:Kb.Type=3;break;case 4:Kb.Type=4;break;default:e.ULS.shipAssertTag(51230686,12,!1,"Unexpected task history type: "+La.type)}Kb.UndoId=null;return Kb}static elh(La){switch(La){case 0:return 0;
case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;case 6:return 6;case 7:return 10;case 8:return 7;case 10:return 9;case 9:return 8;case 11:return-1;default:return 0}}static $kh(La){var Kb=null;La.User&&(Kb=new Pb(La.User.UserId,La.User.Provider,La.User.DisplayName));Kb=new ib(oc.elh(La.Type),Kb,new Date(La.Time),La.Id);Kb.commentId=La.AnchorId;La.Assignee&&(Kb.assignee=new Pb(La.Assignee.UserId,La.Assignee.Provider,La.Assignee.DisplayName));if(La.StartDate||La.DueDate)Kb.schedule=
new ka,Kb.schedule.startDate=La.StartDate?new Date(La.StartDate):null,Kb.schedule.endDate=La.DueDate?new Date(La.DueDate):null;Kb.priority=La.Priority;Kb.completion=La.Progress;Kb.title=La.Title;La.UndoId&&(Kb.undoId=La.UndoId);return Kb}}Object(c.a)(oc,"ExcelCommentTaskTranslator",null,[888]);class eb{constructor(La,Kb,uc,Sc,nd,Jd,ke=null){this.date=this.author=this.commentBody=this.parentId=this.commentId=null;this.commentFlags=0;this.usersByReactionType=null;this.commentId=La;this.parentId=Kb;
this.commentBody=uc;this.author=Sc;this.date=nd;this.commentFlags=Jd;this.usersByReactionType=ke}}Object(c.a)(eb,"OfficeSharedCommentModel",null,[]);class yb extends eb{constructor(La,Kb,uc,Sc,nd,Jd,ke){super(La,Kb,uc,Sc,nd,Jd);this.anchorHintText=null;this.anchorHintText=ke}}Object(c.a)(yb,"ExcelOfficeSharedComment",eb,[]);class zc{B9j(La,Kb,uc){if(!La)return null;let Sc=0;La.Cvf&&(Sc|=4);if(Kb||uc&&La.G$a)Sc|=1;La.done&&(Sc|=8);La.BBi&&(Sc|=16);Kb=Da.EwaSettings.isChangeGateEnabled("OfficeVSO:5703292_ExcelPlumbEmailThroughCG")?
Ab.a.UMa(La.authorIdentity||""):"";Kb=new nb(La.authorIdentity||"",La.WDe||"",La.author||"",Kb||"",La.isCurrentUser);return new yb(La.id,La.fl||"",La.commentBody,Kb,La.date,Sc,La.G0g||"")}C9j(La,Kb,uc){const Sc=[];if(La)for(const nd of La)1!==nd.commentType&&Sc.push(this.B9j(nd,Kb,uc));return Sc}}Object(c.a)(zc,"ExcelSharedCommentModelTranslator",null,[887]);var dd=a(118),od=a(1035),Ed=a(734),ce=a(828);class wc{constructor(La,Kb){this.o3b=La;this.inputMethod=Kb}}Object(c.a)(wc,"ActionDataWithInputMethod",
null,[]);var ed=a(131),md=a(90),Yd=a(438),$d=a(537),bd=a(483),Vd=a(159),De=a(133),Pe=a(60);class Zb{constructor(La,Kb,uc,Sc,nd){this.SQ=this.hs=this.XGa=this.Sf=null;this.$Oc=this.Dae=!1;this.a3b=null;this.Aae=!1;this.Ice=this.zme=null;this.Jaa=this.jWe=!1;this.Taa=this.Une=this.NWc=null;this.Na=La;this.yj=Kb;this.Te=uc;this.Nc=Sc;this.MQ=nd;this.Ysa=l.KeyInputManager.Fm(md.a.Tra,0)}get Lrb(){return this.Aae}set Lrb(La){(this.Aae=La)||this.X1c()}get lhh(){return"CommentPane"}get isVisible(){return this.Jaa}set isVisible(La){this.Jaa=
La}get Rt(){return this.NWc}get ZGd(){return this.SQ}get Fec(){return this.MQ}get Egj(){return this.Une}get fi(){return this.Taa}get ORb(){return!0}get Hgg(){return!0}get aDh(){return CommonUIStrings.l_CommentPaneEmpty1}get bDh(){return CommonUIStrings.l_CommentPaneEmpty2}get Qmc(){return 2===this.Sf.mode||3===this.Sf.mode}initialize(La,Kb){this.Sf=La;this.Une=Kb;La=this.mqh();this.Egj.appendChild(La);this.Ih()}dispose(){this.ORb&&this.hs&&(this.yj.Aa(k.a.click,this.hs,Object(I.a)(this,this.lm,"onClosePaneClick")),
this.Te.By(this.hs,this.Ice));this.Hgg&&this.SQ&&(this.yj.Aa(k.a.click,this.SQ,Object(I.a)(this,this.lKd,"onNewCommentClick")),this.Te.By(this.SQ,this.zme));this.fi&&this.yj.Aa(k.a.click,this.fi,Object(I.a)(this,this.Dw,"clearSelection"));const La=this.Nc.rj(Ea.AFrame.hq);La.ul(this.Ysa);La.ul(la.FocusManager.instance().H4);La.ul(la.FocusManager.instance().I4);this.SQ=this.NWc=this.hs=this.Taa=null}yig(){this.Rt.innerText="";var La=Ed.a("div","","CommentPaneEmpty1");La.innerText=this.aDh;this.Rt.appendChild(La);
0!==this.Sf.mode&&(La=Ed.a("div","","CommentPaneEmpty2"),La.innerText=this.bDh,this.Rt.appendChild(La))}PT(){this.Rt.innerText="";const La=Ed.a("div","","CommentPaneEmpty1");La.innerText=CommonUIStrings.l_CommentPaneError;this.Rt.appendChild(La)}GYj(){this.Rt.innerText="";const La=Ed.a("div","","");La.style.textAlign="center";var Kb=document.createElement("img");Kb.className="CommentPaneLoading";Kb.src=ed.a.Xva("progress.gif");La.appendChild(Kb);Kb=Ed.a("div","","CommentPaneLoadingText");Kb.innerText=
CommonUIStrings.l_CommentLoading;La.appendChild(Kb);this.Rt.appendChild(La)}showComments(La){Pe.a.pvb(this.Rt);if(La.length)for(let Kb=0;Kb<La.length;Kb++){const uc=La[Kb],Sc=Kb?La[Kb-1]:null;(!Kb||Sc.J8a<uc.J8a)&&this.Rt.appendChild(this.cac());this.Rt.appendChild(uc.render())}else this.yig();this.$Oc=!0;this.Lra();this.a3b&&(this.a3b.focus(),this.a3b=null)}selectComment(La){this.$Oc?La.focus():this.a3b=La}mqf(La,Kb){return!La||!Kb||La.J8a!==Kb.J8a}W5f(La){var Kb=this.Sf.model.bhc(La,!1);const uc=
this.Sf.model.FAb(La,!1);Kb||uc||Pe.a.pvb(this.Rt);Kb=this.mqf(Kb,La);const Sc=this.mqf(uc,La);let nd=null;uc&&(nd=uc.zk,Sc&&(nd=nd.previousSibling));this.X5f(La,nd,Kb&&Sc)}Q5f(La){const Kb=La.zk.nextSibling;this.Rt.removeChild(La.zk);this.X5f(La,Kb,!1)}R0i(La){Zb.qKe(La.element);Zb.s3f(La.element)}rIf(La){La.element.style.marginTop="";Zb.s3f(La.element)}DRd(La){const Kb=[];var uc=null,Sc=null;for(var nd=0;nd<La.length;nd++){uc=La[nd];nd||(Sc=uc.zk.previousSibling);if(nd===La.length-1){const Jd=uc.zk.nextSibling;
Sc&&Sys.UI.DomElement.containsCssClass(Sc,"CommentGroupDivider")&&(!Jd||Sys.UI.DomElement.containsCssClass(Jd,"CommentGroupDivider"))&&Array.add(Kb,Sc)}uc=uc.zk;Array.add(Kb,uc)}Sc=0;if(La=uc.nextSibling){Sc=La.offsetTop;for(nd=0;nd<Kb.length;nd++)Kb[nd].style.display="none";Sc=La.offsetTop-Sc;for(nd=0;nd<Kb.length;nd++)Kb[nd].style.display=""}Zb.I0g(Kb,La,Sc,Object(I.a)(this,this.S0i,"onAfterFadeOut"),Object(I.a)(this,this.rIf,"onAfterMove"))}Ih(){this.Na.Hc(ea.a.Sda,u.a.frame,Object(I.a)(this,this.Sda,
"hideCommentPane"));this.Na.Hc(ea.a.editComment,u.a.frame,Object(I.a)(this,this.editComment,"editComment"));this.Na.Hc(ea.a.QP,u.a.frame,Object(I.a)(this,this.QP,"selectNextComment"));this.Na.Hc(ea.a.ET,u.a.frame,Object(I.a)(this,this.ET,"selectPrevComment"));this.Na.pf(ea.a.nNb,u.a.frame,Object(I.a)(this,this.nNb,"queryToggleCommentPane"),96);this.Na.Hc(ea.a.Z9c,u.a.frame,Object(I.a)(this,this.eMe,"commentMoveFocusForTabsHandler"));this.Na.Hc(ea.a.Y9c,u.a.frame,Object(I.a)(this,this.eMe,"commentMoveFocusForTabsHandler"))}S0i(La){La.element.parentNode&&
La.element.parentNode.removeChild(La.element);this.Rt.childNodes.length||this.yig()}ncb(){this.Lra()}mqh(){const La=Ed.a("div",this.lhh,"CommentPane");var Kb=Ed.a("label",od.a.$9c,od.a.$9c);Kb.innerText=CommonUIStrings.l_CommentTabHelp;La.appendChild(Kb);this.ORb&&(Kb=this.XN(),La.appendChild(Kb));this.Hgg&&(Kb=this.gbd(),La.appendChild(Kb));Kb=Ed.a("div","CommentPaneSurface","CommentPaneSurface");this.Sf.oad||(Sys.UI.DomElement.addCssClass(La,"DisableSelection"),La.setAttribute("Unselectable","on"));
La.appendChild(Kb);this.Taa=La;this.NWc=Kb;this.Lra();this.NVa();this.yj.ta(k.a.click,La,Object(I.a)(this,this.Dw,"clearSelection"));this.GYj();return La}XN(){const La=Ed.b("div","CommentPaneHeader","CommentPaneHeader"),Kb=Ed.b("span","CommentPaneTitle","PaneTitle CommentPaneTitle UIFontLight");Kb.innerText=CommonUIStrings.L_OpenCommentPane;const uc=ce.a.Vb("CloseCommentPane","CommentPaneCloseButton",CommonUIStrings.l_Close,"ClosePaneGlyph_16x16x32",!1);Sys.UI.DomElement.addCssClass(uc,x.AFrameworkApplication.isRtl?
"FloatLeft":"FloatRight");this.yj.ta(k.a.click,uc,Object(I.a)(this,this.lm,"onClosePaneClick"));this.Ice=this.Te.ev(uc,Object(I.a)(this,this.lm,"onClosePaneClick"),md.a.Li);La.appendChild(Kb);La.appendChild(uc);this.hs=uc;return La}gbd(){this.XGa=Ed.b("div","CommentPaneControls","CommentPaneControls");const La=ce.a.Vb("CommentPaneNewComment","CommentPaneNewComment",CommonUIStrings.l_CommentNewCommentButton,"CommentNew_16x16x32");this.XGa.appendChild(La);this.yj.ta(k.a.click,La,Object(I.a)(this,this.lKd,
"onNewCommentClick"));this.zme=this.Te.ev(La,Object(I.a)(this,this.lKd,"onNewCommentClick"),md.a.Li);this.SQ=La;return this.XGa}cac(){const La=Ed.a("div","","CommentGroupDivider");this.Dae||Sys.UI.DomElement.addCssClass(La,"CommentGroupDividerFirst");this.Dae=!0;La.innerText="";return La}Lra(){0===this.Sf.mode||-1===this.Sf.mode?(this.XGa&&(this.XGa.style.display="none"),Sys.UI.DomElement.addCssClass(this.Rt,"ReadOnly")):(Sys.UI.DomElement.removeCssClass(this.Rt,"ReadOnly"),this.XGa&&(this.XGa.style.display=
"inline-block"),this.Qmc||4===this.Sf.mode?(Sys.UI.DomElement.addCssClass(this.Rt,"CommentInProgress"),Sys.UI.DomElement.removeCssClass(this.Rt,"Interactive"),this.SQ&&this.seg(!1)):(Sys.UI.DomElement.addCssClass(this.Rt,"Interactive"),Sys.UI.DomElement.removeCssClass(this.Rt,"CommentInProgress"),this.SQ&&this.seg(this.$Oc)))}seg(La){ce.a.rhb(this.SQ,La)}NVa(){const La=this.Nc.rj(Ea.AFrame.hq);La.parent=Ea.AFrame.mV;this.yj.Urb(Ea.AFrame.hq,this.fi);La.Tua(()=>{let Kb;Kb=this.SQ.disabled&&this.hs?
this.hs:this.SQ;Kb.focus();this.Sf.JL().ag.Km(Kb);this.Sf.JL().ag.xp(5)});La.Z1c(()=>{2!==this.Sf.mode&&3!==this.Sf.mode&&this.Sf.Dw()});this.MQ.Srb(Ea.AFrame.hq);La.bindAction(l.KeyInputManager.Fm(md.a.Ura,0),ea.a.ET);La.bindAction(l.KeyInputManager.Fm(md.a.W$,0),ea.a.QP);La.bindAction(this.Ysa,ea.a.Sda)}h1f(La){La.ul(this.Nc.H4);La.ul(this.Nc.I4);La.bindAction(this.Nc.H4,ea.a.Z9c);La.bindAction(this.Nc.I4,ea.a.Y9c)}eMe(La){let Kb=this.Sf.JL().ag.Ej;const uc=this.Sf.model.pDa;if(!Kb){Kb=document.activeElement;
this.fi.contains(Kb)||(Kb=uc?uc.zk:this.Sf.fi.ZGd);if(!Kb)return 4;this.Sf.JL().ag.Km(Kb)}return La===ea.a.Z9c?this.hBa(Kb,uc):La===ea.a.Y9c?this.WRa(Kb,uc):2}hBa(La,Kb){const uc=this.Qmc;if(La===this.SQ&&this.Sf.model.Jrd()&&!this.Qmc)return this.Sf.QP(),32;if(Kb&&La===Kb.zk)this.Sf.JL().ag.Km(La.firstChild);else if(-1!==La.className.indexOf(od.a.cMe)){if(Kb){if(this.Sf.model.FAb(Kb,!1))return this.Sf.QP(),32;uc||this.Sf.model.Dw();this.Sf.JL().ag.Km(Kb.zk)}}else{if(-1!==La.className.indexOf(od.a.b$c))return this.Sf.JL().ag.Km(Kb.mMe.TGj),
32;-1!==La.className.indexOf(od.a.jMe)&&this.Sf.JL().ag.Km(Kb.zk)}this.Sf.JL().hBa();return 32}WRa(La,Kb){if(La===this.SQ)return this.Sf.JL().WRa(),32;if(Kb)if(La===Kb.zk)if(La=this.Qmc,this.Sf.model.bhc(Kb,!1)){if(!La)return this.Sf.ET(),(Kb=this.Sf.model.pDa.mMe.Wvh)&&this.Sf.JL().ag.Km(Kb),32}else La||this.Sf.Dw();else{if(-1!==La.className.indexOf(od.a.iMe)||-1!==La.className.indexOf(od.a.bMe))return this.Sf.JL().ag.Km(Kb.zk),32}else if((-1!==La.className.indexOf(od.a.qhh)||-1!==La.className.indexOf(od.a.mhh))&&
this.Sf.model.Jrd())return this.Sf.ET(),32;this.Sf.JL().WRa();return 32}lm(){this.Na.processAction(ea.a.Sda,2);return!0}Dw(){this.Nc.vk(Ea.AFrame.hq);this.Sf&&2!==this.Sf.mode&&3!==this.Sf.mode&&this.Sf.Dw();return!0}lKd(){if(this.SQ.disabled)return!0;this.X1c();return!0}X1c(){this.Nc.vk(Ea.AFrame.hq);this.Sf.Yrb(null)}Yrb(La,Kb,uc,Sc,nd){1!==uc&&(this.isVisible?this.X1c():(La=0,Object(m.a)(wc,nd)&&(La=nd.inputMethod),nd=new wc(nd,La),this.Lrb=!0,this.Na.Le(ea.a.v$,2,nd)))}editComment(La,Kb,uc,Sc,
nd){if(1===uc)return 1===this.Sf.mode?32:8;if(this.isVisible){La=this.Sf.model.Ou(nd);if(!La)return 8;La.uJd()}else this.jWe=!0,this.Na.Le(ea.a.v$,2,nd);return 32}QP(La,Kb,uc){if(1===uc)return 32;this.Sf.QP();return 32}ET(La,Kb,uc){if(1===uc)return 32;this.Sf.ET();return 32}X5f(La,Kb,uc){const Sc=La.render(),nd=[];let Jd=0,ke=0;Kb?(ke=Kb.offsetTop,this.Rt.insertBefore(Sc,Kb)):this.Rt.appendChild(Sc);Array.add(nd,Sc);uc&&(uc=this.cac(),this.Rt.insertBefore(uc,Sc),Array.add(nd,uc));Kb&&(Jd=Kb.offsetTop-
ke);Zb.K0g(nd,Kb,Jd,Object(I.a)(this,this.R0i,"onAfterFadeIn"),Object(I.a)(this,this.rIf,"onAfterMove"));0!==La.commentType&&La.focus()}static K0g(La,Kb,uc,Sc,nd){for(let ke=0;ke<La.length;ke++){var Jd=La[ke];Kb?Vd.WacAirSpace.IM(Jd,"WAC_DelayShowClass"):Vd.WacAirSpace.IM(Jd,"Shared_BasicClass");Jd=new bd.a(Jd);Jd.DN(0,1);Vd.WacAirSpace.animate(Jd,null,Sc)}Kb&&(La=Zb.I$e(Kb),Kb.style.position="relative",Vd.WacAirSpace.IM(Kb,"Shared_BasicClass"),Kb=new $d.a(Kb),Kb.gva(La-uc,La),Vd.WacAirSpace.animate(Kb,
null,nd))}static I0g(La,Kb,uc,Sc,nd){for(let ke=0;ke<La.length;ke++){var Jd=La[ke];Vd.WacAirSpace.IM(Jd,"Shared_BasicClass");Jd=new Yd.a(Jd);Jd.DN(1,0);Vd.WacAirSpace.animate(Jd,null,Sc)}Kb&&(La=Zb.I$e(Kb),Kb.style.position="relative",Vd.WacAirSpace.IM(Kb,"WAC_DelayMoveClass"),Kb=new $d.a(Kb),Kb.gva(La,uc+La),Vd.WacAirSpace.animate(Kb,null,nd))}static s3f(La){var Kb=La.className;if(Kb){Kb=Kb.split(" ");for(let uc=0;uc<Kb.length;uc++){const Sc=Kb[uc];Sc.startsWith(Vd.WacAirSpace.Osb)&&Sys.UI.DomElement.removeCssClass(La,
Sc)}}}static I$e(La){La=De.a.DA(La);let Kb=0;La&&La.marginTop&&(Kb=parseInt(La.marginTop),Kb=isNaN(Kb)?0:Kb);return Kb}static qKe(La){h.a.Qna?La.style.filter="":La.style.opacity=""}}Object(c.a)(Zb,"CommentPane",null,[2,857]);class Vc extends F{constructor(La){super(La)}Evj(La){this.guj(La)}Ick(La){this.ksg(La)}rRj(La){La=this.onh(La);for(let Kb=0;Kb<this.EX.count;++Kb)Array.enqueue(this.EX.ma(Kb).mW,La);this.D2(!0)}onh(La){const Kb=new D;Kb.eventType=3;Kb.viewContainerVisibilityState=La;return Kb}EVh(){const La=
this.Ysh();for(let Kb=0;Kb<this.EX.count;++Kb)Array.enqueue(this.EX.ma(Kb).mW,La);this.D2(!0)}Ysh(){const La=new D;La.eventType=2;return La}}Object(c.a)(Vc,"ViewContainerEventHost",F,[896]);class Nc{constructor(){this.fZc=this.rae=!1;this.Wia=this.No=this.Nhe=this.ele=this.iue=this.eoe=this.Rse=this.fde=this.ou=this.qqb=null}initialize(La,Kb,uc,Sc=null,nd=null,Jd=null,ke=null,ne=null,Ue=null,of=null){this.ou=La;this.fde=Kb;this.Rse=uc;this.eoe=Sc;this.iue=nd;this.ele=Jd;this.Nhe=ke;this.No=ne;this.rae=
!0;this.Wia=Ue;this.qqb=of}Rwi(La=null){if(!this.rae)return e.ULS.sendTraceTag(41424203,201,10,"InstantiateSharedComments called before activation manager initialization."),new Promise((Kb,uc)=>{uc(H.a.Iu(-2130915313))});if(this.fZc)return e.ULS.sendTraceTag(41424204,201,10,"InstantiateSharedComments called after shared comments was already instantiated."),new Promise(()=>{});this.qqb||(x.AFrameworkApplication.fa.ra("DynamicBundlesIsEnabled")?this.qqb=appResourceLoader.loadChunk("sharedComments"):
this.qqb=this.ou.loadScript("sharedComments"));return this.qqb.then(()=>{La&&La();this.fZc||(this.Wia&&this.Wia.execute(Kb=>{Kb.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate","InitializeFloodgateServiceInCommentsPane")}),sharedComments.instantiate(this.fde,this.Rse,this.eoe,this.iue,this.ele,this.Nhe,this.No));this.fZc=!0})}}Object(c.a)(Nc,"CommentActivationManager",null,[909]);class ld{constructor(La,Kb,uc,Sc){this.isRightToLeft=!1;this.dataCulture=this.uiCulture=this.appLocale=
null;this.isRightToLeft=La;this.appLocale=Kb;this.uiCulture=uc;this.dataCulture=Sc}}Object(c.a)(ld,"LocalizationDetails",null,[]);var yd=a(529);class sd{constructor(La,Kb){this.WQg=La;this.JB=Kb}getViewContainer(){return this.WQg}registerForViewContainerEvents(La){this.JB.Evj(La)}unregisterForViewContainerEvents(La){this.JB.Ick(La)}}Object(c.a)(sd,"ViewContainerProvider",null,[907]);class ic{constructor(La,Kb){this.canvasContextId=this.canvasActionId=0;this.withFlags=!1;this.postCallback=this.registeredCallback=
this.preCallback=null;this.delayActionsUntilRegistration=!1;this.canvasActionId=La;this.canvasContextId=Kb}}Object(c.a)(ic,"CommentUIAction",null,[]);var Ic=a(225),kd=a(163),Hd=a(177),Ud=a(865),de=a(728);class qe extends Ud.a{constructor(){super();this.comment=this.commentId=null;this.H_=Object.assign(new de.a,{T_:qe.getTypeName(),B_:qe.we()})}static getTypeName(){return"AugLoop_SmartReply_CommentSmartReplySignal"}static we(){return["AugLoop_Signals_Signal"]}}Object(c.a)(qe,"CommentSmartReplySignal",
Ud.a,[]);var fe=a(748);class Ke extends fe.a{constructor(){super();this.DomainName=this.CommentId=null;this.ConfidenceLevel=0;this.ElapsedTime=this.ResultSets=null;this.H_=Object.assign(new de.a,{T_:Ke.getTypeName(),B_:Ke.we()})}static getTypeName(){return"AugLoop_SmartReply_SmartReply"}static we(){return["AugLoop_Core_Annotation"]}}Object(c.a)(Ke,"SmartReply",fe.a,[]);var Te=a(914),Se=a(1023);class df{constructor(La){this.cFg=La}wbd(La,Kb){return Object.assign(new Se.a,{parentPath:["Signal",qe.getTypeName()],
items:[Object.assign(new Te.a,{body:Object.assign(new qe,{commentId:La,comment:Kb})})]})}mNd(La){const Kb=new w.a;if(La&&La.CommentId&&La.ResultSets&&0<La.ResultSets.length&&La.ResultSets[0].Documents&&0<La.ResultSets[0].Documents.length){for(const uc of La.ResultSets[0].Documents)Kb.add(uc.Caption);0<Kb.count&&this.cFg.mNd(La.CommentId,Kb.toArray())}else e.ULS.sendTraceTag(574493152,327,10,"Invalid response from SmartReplies request")}getTypeName(){return Ke.getTypeName()}}Object(c.a)(df,"BaseCommentSmartReplyProvider",
null,[884]);var te=a(747);class gf extends df{constructor(La,Kb){super(La);this.tki=(uc,Sc)=>{(uc=Sc.YB)&&te.a.Fya(uc)===this.getTypeName()&&1===Sc.operationType?this.mNd(uc):e.ULS.sendTraceTag(537167437,12,10,"Invalid annotation event for smart replies")};this.augmentationLoopManager=Kb}initialize(){if(this.augmentationLoopManager){const La=this.getTypeName();this.augmentationLoopManager.register(this.augmentationLoopManager.v0().S2("CommentSmartReply").P2(()=>{}).activateAnnotation({annotationType:La,
Tv:!1,WO:this.tki}).build())}}invoke(La,Kb){this.augmentationLoopManager&&this.augmentationLoopManager.eTb(Object(b.a)(new qe,{commentId:La,comment:Kb}))}}Object(c.a)(gf,"CommentSmartReplyProvider",df,[]);class cf{constructor(){this.No=null;this.llb=this.AMg=this.lNc=this.Pse=this.kue=this.apb=this.Jpe=!1}Pei(){this.No||(e.ULS.sendTraceTag(588292828,327,10,"OfficeSharedCommentsAppCapabilities: AppSettings object should not be empty"),this.Zeg());return this.No}Pbf(){return new Promise((La,Kb)=>{this.llb?
La(this.Qbf()):this.wcg().then(()=>{La(this.Qbf())}).catch(uc=>{Kb(uc)})})}Qbf(){this.llb||e.ULS.sendTraceTag(588292829,327,10,"OfficeSharedCommentsAppCapabilities: GetModelCapabilitiesInternal should not be called before AtMentions are resolved");let La;La=33;this.lNc&&(La|=2);this.Jpe&&(La|=8);this.kue&&(La|=16);this.apb&&(La|=4);this.Pse&&(La|=64);this.AMg&&(La|=128);return La}}Object(c.a)(cf,"OfficeSharedCommentsAppCapabilities",null,[863]);var bf=a(30);class $a extends cf{constructor(La,Kb,uc,
Sc){super();this.$=La;this.DVf=uc;this.excelCommentManager=Kb;this.p6a=Sc;this.dPj();this.Zeg()}get qGf(){return this.apb}set qGf(La){this.apb!==La&&(this.apb=La,this.fUh())}Zeg(){const La=this.excelCommentManager.MEb;this.No={};this.No.LivePersonaPicker="true";this.No.PersonaColor="true";this.No.NewCommentButton="true";this.No.DisabledChangeGates="WebThemeIntegrationHighContrastFixes,"+this.$.xa.DisabledChangeGatesInSharedComments;this.No.CommentsFluentUI="true";this.No.CommentTasks=La.toString();
this.No.CommentTasksFromReply=(La&&Da.EwaSettings.isChangeGateEnabled("OfficeVSO:4017579_DocumentTasksCreateFromReply")).toString();this.No.CommentsFluentUIV2="true";this.No.AtMentionFloodgateSurvey=this.$.xa.AtMentionFloodgateSurveyEnabled.toString();this.No.DiscreteHostedComments="true";this.No.LogDraftCommentIdPair="true";this.No.NewModelState="true";this.No.NewResolvedCardDesignInWeb="true";this.No.HyperlinksInComments="true";this.No.HyperlinksWithDisplayText="true";this.No.NewBorderAndFocusLookInWeb=
"true";this.No.ExtendedDrafting="true";this.No.NewSelectionInteractions="true";this.No.SmartReplies=Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartRepliesIsEnabled",!1).toString();this.No.PersonaIconImageForWeb="true";this.No.TaskPaneWithNewInfrastructure=bf.a.Luf().toString();this.No.LinkToComment="true";this.No.NoDiscardOnFocusLoss="true";this.No.WebThemeIntegration="true";this.No.TaskHistoryRecordIDs=Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TaskHistoryRecordIDs",
!1).toString()}dPj(){this.Pse=this.excelCommentManager.MEb;this.kue=!1;this.apb=this.Jpe=!0;this.wcg()}wcg(){return new Promise((La,Kb)=>{this.$.OFb()?(this.lNc=!1,this.llb=!0,La(!1)):this.DVf?this.DVf.atMentionsEnabledAsync().then(uc=>{this.lNc=uc;this.llb=!0;La(this.llb)}):(e.ULS.sendTraceTag(537167308,0,10,"OfficeSharedCommentsAppCapabilities: SetAtMentionCapabilityAsync should not be called before _peopleAPIInstance is initialized"),Kb(H.a.Iu(-2130915320)))})}fUh(){this.Pbf().then(La=>{this.p6a.Ifk(La)})}}
Object(c.a)($a,"ExcelSharedCommentsAppCapabilities",cf,[]);class Y{constructor(La,Kb){this.mGg=La;this.su=Kb}get contextId(){return 1}get Ecb(){return null}get BEb(){return!1}get mFb(){return!1}get qed(){return this.mGg}get gridView(){return this.su}}Object(c.a)(Y,"NextOrPrevCommentContext",null,[165]);var Ta=a(535),Bb=a(52),Rb=a(150),jc=a(40),vc=a(33),bb=a(386),Mb=a(35),hc=a(100),Cc=a(149);class Wb extends Zb{constructor(La,Kb,uc,Sc,nd,Jd,ke,ne,Ue,of,He){super(La,uc,Sc,nd,Jd);this.Mzf=this.Taa=this.h0b=
this.UKa=this.Lfa=null;this.Lhb=this.vFc=this.Cae=!1;this.setWebpackPublicPath=()=>{Ta.a(this.$)};this.$A=()=>{this.X8d.rRj(this.commentTaskPane.isVisible?3:1);if(Da.EwaSettings.isChangeGateEnabled("OfficeVSO:5015813_SyncNewCommentButtonWithRibbon")){const We=Hd.a(this.$);We&&(this.commentTaskPane.isVisible?We.PYg(this.uif):We.Hzj(this.uif))}};this.uif=()=>{const We=kd.b(this.$).Co("-1667294294");this.UKa.qGf=We};this.Sda=(We,$e,Uf)=>{1!==Uf&&(this.commentTaskPane.Oh(!1),this.isVisible=!1,this.excelCommentManager.gridViewSetFocus());
return 32};this.nNb=()=>32;this.Lj=()=>{};this.wvc=()=>{this.Nc.vk(Ea.AFrame.hq);return!1};this.mYj=(We,$e,Uf)=>1===Uf?this.Lhb?2:32:2!==Uf||this.Lhb?2:(this.vFc=!0,32);this.lYj=(We,$e,Uf,Re)=>this.vFc&&2===Re&&We?(this.vFc=!1,this.Zmf(),32):2;this.Rih=(We,$e,Uf)=>1===Uf?this.excelCommentManager.yna()?8:this.excelCommentManager.Zif()?this.msf(this.excelCommentManager.cE)||this.excelCommentManager.yna()?8:32:8:2;this.Sih=(We,$e,Uf)=>1===Uf&&(We=this.excelCommentManager.cE,($e=(!We||!We.Cvf)&&this.excelCommentManager.pAe(this.excelCommentManager.mode)&&
!this.msf(We))&&We&&We.isResolved&&($e=!1),this.excelCommentManager.eo&&this.excelCommentManager.eo.GG||!$e)?8:this.isVisible||1!==Uf||this.Lhb?2:32;this.ZMe=(We,$e,Uf)=>1!==Uf&&!this.excelCommentManager.hasCommentAtActiveCell&&this.excelCommentManager.yth&&2===Uf?($e=Object(xa.a)(Y,$e),this.excelCommentManager.iJj(We===ea.a.QP,$e?$e.qed:!1),32):2;this.J5e=(We,$e,Uf,Re)=>{$e=($e=Object(xa.a)(Y,Uf))?$e.qed:!1;We&&2===Re&&$e&&(this.excelCommentManager.setFocus(!0,!1),this.Nc.vk(Ea.AFrame.hq));return We?
32:8};this.Mrg=We=>{if(this.excelCommentManager.yna()||this.Dni&&!this.$.isEditMode)return 2;We=new cb.a(We===ea.a.k6d?-1502853784:-111689794,1,2,6,null);this.$.Ia.mc(We);return 32};this.yj=uc;this.Nc=nd;this.excelCommentManager=ke;this.X8d=new Vc(x.AFrameworkApplication.Xi,"CommentPane");this.$=ne;this.$.kA(this.Lj);this.commentTaskPane=Ue;this.commentTaskPane.UF(this.$A);this.taskManager=Kb;this.FRg=this.Slh();this.eve=new Nc;this.p6a=of;this.ga=He;this.Dni=Da.EwaSettings.isChangeGateEnabled("OfficeVSO:7741787_handleUndoRedoCommentActionInViewMode")}get X9c(){return"CommentPane"}dispose(){this.$&&
this.$.$C(this.Lj);this.Taa&&this.yj.Aa(k.a.click,this.Taa,Object(I.a)(this,this.Dw,"clearSelection"));this.commentTaskPane&&this.commentTaskPane.rH(this.$A);const La=this.Nc.rj(Ea.AFrame.hq);La.ul(la.FocusManager.instance().H4);La.ul(la.FocusManager.instance().I4);this.h0b=this.Taa=this.Lfa=this.commentTaskPane=this.$=this.excelCommentManager=null;super.dispose()}initialize(La,Kb){this.Sf=La;this.h0b=Kb;La=this.nqh();this.h0b.appendChild(La);this.Ih();this.yj.NCa(k.a.click,this.h0b,this.wvc,null,
!0);this.Taa.style.display="flex";this.Mzf=new ld(x.AFrameworkApplication.isRtl,Sys.CultureInfo.CurrentCulture.name,x.AFrameworkApplication.uiCulture,x.AFrameworkApplication.dataCulture);La=pb.a.instance.Dc("Common.App.People.IExternalPeopleAPI");this.Nti(La)}Nti(La){yd.a.mr(La).continueWith(Kb=>{this.Lfa=Kb.result;Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartRepliesIsEnabled",!1)?(this.Qmf(this.Lfa),this.$ti(uc=>{this.excelCommentManager.Umf(this.Lfa,this.UKa,uc);this.Xmf()})):
(this.Qmf(this.Lfa),this.excelCommentManager.Umf(this.Lfa,this.UKa,null),this.Xmf())})}Xmf(){void(()=>Object(dd.a)(this,void 0,void 0,function*(){const La=yield Cc.a.resolve(Mb.C,{Wa:0});this.eve.initialize(La.ou,this.excelCommentManager.P5,this.excelCommentManager.Tng,this.Lfa,new sd(this.excelCommentManager.W8d,this.X8d),this.Mzf,null,this.UKa.Pei());yield this.eve.Rwi(this.setWebpackPublicPath);this.xud()}))()}$ti(La){jc.TaskExtensions.za(Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateAugmentationLoopToNewServiceInfra",
!1)?Object(hc.d)(Cc.a.resolve(Mb.f,{Wa:1})):Bb.GetServiceTaskFactory.Za(this.$.da,328,327,1),Kb=>{(Kb=Kb.result)?(e.ULS.sendTraceTag(537167312,12,50,"ExcelSharedCommentPane::InitializeCommentSmartReplyProvider - AugmentationLoopManager instantiated."),Kb=new gf(this.p6a,Kb),Kb.initialize(),La(Kb)):(e.ULS.sendTraceTag(537167313,12,10,"ExcelSharedCommentPane::InitializeCommentSmartReplyProvider - Failed to instantiate AugmentationLoopManager."),La(null))},this.$.ka,3)}Qmf(La){this.UKa=new $a(this.$,
this.excelCommentManager,La,this.p6a)}xud(){this.Lhb=!0;this.excelCommentManager.tud();this.f4b?(this.f4b=!1,this.excelCommentManager.RK.g2(ea.a.Bcb,null,2,null,null)):this.vFc?this.excelCommentManager.RK.g2(ea.a.rjb,null,2,null,null):this.Zmf();const La=this.excelCommentManager.P5;La&&La.checkAtMentionCapability().then(uc=>{uc&&(uc=pb.a.instance.Dc("Common.ISystemInitiatedFeedback"))&&uc.execute(Sc=>{Sc.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate","InitializeFloodgateServiceInCommentsPane")})});
const Kb=sharedComments.RichContentEditAPIFactoryGlobal.getRichContentEditAPI();void Cc.a.resolve(Mb.rb,{Wa:0}).then(uc=>{Kb.registerSafelinksNavigator(uc.mha.bind(uc))})}setFocus(){this.mUh&&this.X8d.EVh()}selectComment(){this.isVisible&&this.Nc.vk(Ea.AFrame.hq)}Ih(){this.Na.Hc(ea.a.Sda,u.a.frame,this.Sda);this.Na.Hc(ea.a.editComment,u.a.frame,Object(I.a)(this,this.editComment,"editComment"));this.Na.Hc(ea.a.k6d,u.a.frame,this.Mrg);this.Na.Hc(ea.a.P1f,u.a.frame,this.Mrg);this.Na.pf(ea.a.nNb,u.a.frame,
this.nNb,96)}lm(La){const Kb=new cb.a(999391620,2,this.$.Tc,30,null);this.$.Ia.mc(Kb,{["event"]:La.Da},La.Da);return!0}get f4b(){return this.Cae}set f4b(La){this.Cae=La}get mUh(){return document.getElementById(H.a.cri)}Yrb(La,Kb,uc,Sc,nd){this.commentTaskPane.isVisible?this.excelCommentManager.JCc(nd):this.Sf.model.Jrd()||this.Lhb||(this.f4b=!0);this.Nc.vk(Ea.AFrame.hq);this.Lhb&&(this.excelCommentManager.hasCommentAtActiveCell?H.a.w1a(this.taskManager,()=>{this.excelCommentManager.RK.g2(ea.a.Bcb,
Kb,uc,Sc,nd)}):this.excelCommentManager.RK.g2(ea.a.Bcb,Kb,uc,Sc,nd));e.ULS.sendTraceTag(537167310,12,50,`Comment pane opened. Source=${Sc.UV}. Method=${Sc.S_}`)}v$(La,Kb,uc,Sc,nd){if(1===uc)return 32;e.ULS.sendTraceTag(36988121,12,50,"New Comment Pane opened.");La=this.Sf.mode;if(4===La||2===La||3===La)return 32;La=null;this.$.yc&&(La=this.$.yc.vh("ModelUpdate","CommentPaneRender"),La.start());this.isVisible=!0;this.Lrb&&nd?(this.excelCommentManager.JCc(nd),this.Lrb=!1):(this.setFocus(),this.Nc.vk(Ea.AFrame.hq),
this.excelCommentManager.hasCommentAtActiveCell&&(nd=this.excelCommentManager.cE)&&this.Sf.selectComment(nd.id,1));La&&La.stop();return 32}rjb(La,Kb,uc,Sc,nd){return this.isVisible?this.Sda(La,Kb,uc,Sc,nd):this.v$(La,Kb,uc,Sc,nd)}DRd(){}nqh(){const La=Ed.a("div",this.X9c,this.X9c);this.Taa=La;this.rSj();return La}rSj(){const La=this.Nc.rj(Ea.AFrame.hq);La.parent=Ea.AFrame.mV;La.LO=!0;La.S7d=!0;this.yj.Urb(Ea.AFrame.hq,this.Taa,La.S7d);La.Tua(()=>{this.setFocus()});La.Z1c(()=>{2===this.Sf.mode||3===
this.Sf.mode||this.excelCommentManager.hasCommentAtActiveCell||this.Sf.Dw()});this.MQ.Srb(Ea.AFrame.hq);La.bindAction(l.KeyInputManager.Fm(md.a.bMc,l.KeyInputManager.WLe),ea.a.k6d);La.bindAction(l.KeyInputManager.Fm(md.a.aMc,l.KeyInputManager.WLe),ea.a.P1f)}msf(La){return!!La&&La.G$a&&(new Rb.a(this.$.ua)).ki}Slh(){const La=new bb.a;var Kb=new ic(ea.a.Bcb,u.a.frame);Kb.preCallback=this.Sih;const uc=new ic(ea.a.QP,u.a.frame);uc.preCallback=this.ZMe;uc.postCallback=this.J5e;const Sc=new ic(ea.a.ET,
u.a.frame);Sc.preCallback=this.ZMe;Sc.postCallback=this.J5e;const nd=new ic(467845448,u.a.frame);nd.preCallback=this.Rih;La.ia(0,Kb);La.ia(1,uc);La.ia(2,Sc);La.ia(3,nd);Kb=new ic(ea.a.rjb,u.a.frame);Kb.preCallback=this.mYj;Kb.postCallback=this.lYj;La.ia(6,Kb);return La}Zmf(){H.a.w1a(x.AFrameworkApplication.Xi,()=>{this.excelCommentManager.hasCommentAtActiveCell&&this.excelCommentManager.xWd(this.excelCommentManager.cE.id,1);H.a.w1a(this.taskManager,()=>{this.setFocus();this.Nc.gl(Ea.AFrame.hq);this.$.workbookContext.NavigationContentFound&&
(Ca.b().poa(vc.a.Lb.hf.m,Ca.a),Ic.a.instance.log())})})}static createInstance(La,Kb,uc,Sc,nd,Jd,ke,ne,Ue,of,He){return new Wb(La,Kb,uc,Sc,nd,Jd,ke,ne,Ue,of,He)}}Object(c.a)(Wb,"ExcelSharedCommentPane",Zb,[886,857]);var mc=a(147);class Mc{constructor(La,Kb){this.containerType="full-pane";this.identifier=null;this.commentTaskPane=La;this.identifier=Kb}openView(){this.commentTaskPane.Oh(!0)}closeView(){this.commentTaskPane.Oh(!1)}invokeModalConfirmationDialog(La,Kb,uc){const Sc=new mc.StandardDialog;
uc||(e.ULS.sendTraceTag(537167307,12,10,"InvokeModalConfirmationDialog: No localized strings provided."),uc=new v.a("","","",""));Sc.Ac=1;Sc.Qc(1,uc.confirmButton);Sc.Qc(0,uc.cancelButton);Sc.km(uc.title,uc.body,1,nd=>{1===nd?La():Kb()})}}Object(c.a)(Mc,"ExcelViewContainerAPI",null,[882,883]);var hd=a(36),pd=a(7),Nd=a(74),Xd=a(13),ae=a(23),Ve=a(19),we=a(37);class Mf{constructor(){this.contentId=null;this.anchorTop=this.containerContentType=0;this.anchorBottom=this.anchorRight=this.anchorLeft=null}}
Object(c.a)(Mf,"IContentAnchorPosition",null,[]);class Ye{constructor(){this.y=this.x=this.height=this.width=0}}Object(c.a)(Ye,"IViewportInfo",null,[]);class kf{constructor(){this.contentId=null;this.containerContentType=0}}Object(c.a)(kf,"ContainerContentDescriptor",null,[]);class Bf{constructor(La,Kb,uc,Sc){this.tJ=null;this.$5b=!1;this.Gde=this.gz=this.q0=null;this.Vnb=!1;this.age=null;this.xZb=!1;this.Xxb=null;this.bbe=this.xig=!1;this.Bed=0;this.Efc=null;this.zMd=this.bLc=!1;this.Kj=()=>{this.dvg()};
this.rTf=()=>{this.d7c()};this.Lj=()=>{this.dvg();this.Mze()};this.WLf=nd=>nd.Da.keyCode===md.a.NH&&this.rea?(this.bza(this.mE,!1),this.gridView.T2(),!0):!1;this.dNf=(nd,Jd)=>{this.rea&&this.Pna&&(this.bza(this.mE,!1),Jd.ap===Sys.UI.MouseButton.leftButton&&Xd.DOMElementExtensions.R$e(Jd.Fc,hd.a.nGh,!0)&&(nd=this.d2h(Jd.clientPoint),nd=this.excelCommentManager.HNa(nd),this.dKf(nd)))};this.$A=()=>{this.commentTaskPane.isVisible||!this.excelCommentManager.model.Tu||this.Xmc||this.luc()};this.o5i=nd=>
{const Jd=nd.contentId;switch(nd.containerChangeType){case 0:this.r5i(Jd);break;case 1:this.p5i(Jd);break;case 2:Bf.mva(Jd,this.EL)?this.zyb():this.rea&&(this.Pna=!0);break;case 3:this.q5i()}};this.Mp=(nd,Jd)=>{Jd.na!==Jd.WC&&(this.RDh(),Xd.DOMElementExtensions.setVisible(this.gz,!1))};this.tk=(nd,Jd)=>{(nd=Object(xa.a)(zb.a,Jd.na))&&this.Jmc(nd.sheetId)&&this.wig()};this.excelCommentManager=La;this.commentTaskPane=Kb;this.$=uc;this.gridView=Sc;this.sjc=new Sys.UI.Bounds(0,0,0,0);this.commentTaskPane.UF(this.$A)}get o2a(){return this.bbe}get rea(){return!!this.mE}get EL(){return this.age}set EL(La){this.age=
La;this.Fza=!!La}get Xmc(){return!!this.EL}get Fza(){return this.xZb}set Fza(La){this.xZb=La}get Pna(){return this.Vnb}set Pna(La){!this.Vnb&&La?(this.Vnb=!0,this.gridView.ga.rsb(this.dNf)):this.Vnb&&!La&&(this.Vnb=!1,this.gridView.ga.IOb(this.dNf))}get mE(){return this.Gde}set mE(La){this.Gde=La;La||(this.Pna=!1)}dispose(){this.gridView&&(this.iYe(),this.gridView.Ca.gx(this.Kj));this.commentTaskPane&&this.commentTaskPane.rH(this.$A);this.$&&this.$.$C(this.Lj);this.q0&&l.KeyInputManager.instance.Aa(k.a.Ic,
this.q0,this.WLf);this.q0=this.gz=this.tJ=this.gridView=this.$=this.excelCommentManager=null}tud(){this.uOi(La=>{La.continueWith(()=>{this.q0=document.createElement("div");this.q0.classList.add(hd.a.AIh);Xd.DOMElementExtensions.xy(this.q0,pd.a.LJa);Ve.h(this.$).zk.appendChild(this.q0);this.Mze();l.KeyInputManager.instance.ta(k.a.Ic,this.q0,this.WLf);this.tJ=floatingContainerManager.FloatingContainerManagerFactoryGlobal.getIsolatedFloatingContainerManagerInstanceWithCallback(this.o5i);this.KJc();this.$.kA(this.Lj);
this.gridView.Ca.Aw(this.Kj);this.gmh();this.tJ.setFloatingContainerParentElement(this.q0)})})}uVh(){if(this.Fza){var La=new kf;La.containerContentType=0;La.contentId=this.EL;this.tJ.focusContainer(La)}}KJc(){var La=Ve.h(this.$).zk;La=this.Gze(new Sys.UI.Bounds(La.clientLeft,La.clientTop,La.clientWidth,La.clientHeight));La=Object(b.a)(new Ye,{x:La.x,y:La.y,width:we.a(this.$).Bi(La.width),height:we.a(this.$).Bi(La.height)});this.tJ.updateViewport(La,this.gridView.rtl);this.bLc=!1}luc(){this.excelCommentManager.Jpj();
if(this.Fza)e.ULS.sendTraceTag(537167304,12,10,"Another draft is already shown");else if(this.o2a){var La=this.excelCommentManager.model.Tu;if(La){var Kb=P.Nhc(La.Iv.sessionType);if(void 0===Kb||null===Kb)e.ULS.sendTraceTag(537167302,12,10,"Invalid comment draft");else{this.wig();this.OGc();var uc=0===Kb;Kb=uc?La.Iv.draftId:La.fl||La.id;if(this.rea&&Bf.mva(this.mE,Kb))this.mE=null,this.EL=Kb,La=new kf,La.containerContentType=0,La.contentId=Kb,this.tJ.cancelDeleteContainerRequest(La),Da.EwaSettings.isChangeGateEnabled("OfficeVSO:5473527_MakeFloatingContainerStickyForNewDraft")&&
this.tJ.setContainerStickyState(La,!0);else if(!this.commentTaskPane.isVisible||this.Xmc){var Sc=this.ahc(Kb,this.wmd(La));Sc||(e.ULS.sendTraceTag(537167301,12,50,"IContentAnchorPosition is null"),Sc=this.q4h(Kb));this.EL=Kb;uc&&(this.Xxb=La.id);this.bLc&&this.KJc();this.zMd?(this.tJ.addAndShowContainer(Sc,!0),this.zMd=!1):this.tJ.addContainer(Sc)}}}else e.ULS.sendTraceTag(537167303,12,10,"InProgressComment is null")}else this.xig=!0}gmh(){this.gz=document.createElement("div");this.gz.classList.add(hd.a.dLh);
this.q0.appendChild(this.gz);this.Bed=this.gz.clientWidth;Xd.DOMElementExtensions.setVisible(this.gz,!1);var La=document.createElement("div");La.classList.add(hd.a.eLh);this.gz.appendChild(La);La=document.createElement("div");La.classList.add(hd.a.mGh);this.gz.appendChild(La)}stg(){if(this.Jmc(Nd.d(this.$.na))){var La=this.excelCommentManager.model.Tu;if(La){var Kb=this.wmd(La);La=this.z9e(Kb);Kb=this.gridView.tc(Kb);if(La&&Kb&&this.gridView.sea(Kb.range)){var uc=this.gridView.rtl?La.x:La.x+La.width-
this.Bed,Sc=0;Kb.hasAutoFilter&&30>(Kb.UG?Kb.cell.ODb:Kb.height)&&(uc=this.gridView.rtl?uc+17:uc-17);bf.a.qk()&&this.gridView.rtl&&(Sc=this.sjc.width-uc);this.gz&&we.a(this.$).teg(this.gz);this.gz&&(bf.a.qk()?(this.gridView.rtl?Xd.DOMElementExtensions.updatePosition(this.gz,Math.max(Sc-this.Bed,this.gridView.dt),Math.max(La.y,this.gridView.gL),!0,!0):Xd.DOMElementExtensions.updatePosition(this.gz,Math.max(uc,this.gridView.dt),Math.max(La.y,this.gridView.gL),!0),this.gz.style.position="absolute"):
Sys.UI.DomElement.setLocation(this.gz,Math.max(uc,this.gridView.dt),Math.max(La.y,this.gridView.gL)),Xd.DOMElementExtensions.yEa(this.gz,this.gridView.rtl,hd.a.pGh,hd.a.oGh),Xd.DOMElementExtensions.setVisible(this.gz,!0))}else Xd.DOMElementExtensions.setVisible(this.gz,!1)}}}wig(){this.q0&&!Xd.DOMElementExtensions.isVisible(this.gz)&&(Xd.DOMElementExtensions.setVisible(this.gz,!0),this.stg())}a3i(La){Xd.DOMElementExtensions.setVisible(this.gz,!1);if(this.Xmc)if(this.rea&&this.bza(this.mE,!1),this.Xxb){var Kb=
new kf;Kb.containerContentType=0;Kb.contentId=this.EL;La?(this.tJ.deleteContainer(Kb),this.gridView.T2()):(this.tJ.changeContentId(Kb,this.Xxb),this.mE=this.Xxb,this.Pna=!0);this.Xxb=this.EL=null;this.OGc()}else this.Fza&&(this.mE=this.EL,this.Pna=!0),this.EL=null;else this.commentTaskPane.isVisible||e.ULS.sendTraceTag(537167300,12,15,"No draft currently shown")}dKf(La){-1===this.gridView.ga.selectionType&&(!La||La.fl?e.ULS.sendTraceTag(537167299,12,50,"Mouseenter on an comment thread"):(Xa.b(this.$).Vd(Db.a.HUh,
{["Location"]:"floatie"}),this.Fig(La,!0,!1)))}b3i(La){Xa.b(this.$).Vd(Db.a.IUh,{["Location"]:"floatie"});this.bza(La,!0)}$2i(){this.MXj();this.d7c()}MXj(){this.Jmc(Nd.d(this.$.na))&&!this.Fza&&this.luc()}oFc(La,Kb){!La||La.fl?e.ULS.sendTraceTag(537167298,12,15,"Attemping to show invalid comment thread"):this.o2a?this.Fig(La,!1,Kb):this.Efc=La.id}zyb(){this.rea&&this.bza(this.mE,!1)}RDh(){this.EL&&this.bza(this.EL,!1);this.mE&&this.bza(this.mE,!1)}Fig(La,Kb,uc){const Sc=La.id;if(this.rea){if(Kb&&
this.Pna||!Kb&&Bf.mva(this.mE,Sc)||this.Fza&&Bf.mva(this.EL,Sc))return;Bf.mva(this.mE,Sc)||this.bza(this.mE,Kb)}(La=this.ahc(Sc,La.anchor))?(this.bLc&&this.KJc(),Kb?this.tJ.requestAddContainerWithDelay(La):this.tJ.addAndShowContainer(La,uc),Kb||(this.Pna=!0)):e.ULS.sendTraceTag(537167297,12,15,"ShowFloatingCommentThread: Could not get anchor bounds")}bza(La,Kb){if(!La)e.ULS.sendTraceTag(537167296,12,15,"Attempting to hide an invalid comment");else if(!Kb||!this.Pna){var uc=new kf;uc.containerContentType=
0;uc.contentId=La;Kb?this.tJ.requestDeleteContainerWithDelay(uc):this.tJ.deleteContainer(uc)}}uOi(La){void Cc.a.resolve(Mb.B).then(Kb=>La(hc.d(Kb("floatingContainerManager"))))}d7c(){if(this.rea){var La=this.excelCommentManager.model.Ou(this.mE);if(!La){e.ULS.sendTraceTag(537167267,12,10,"currentlyShownNonDraftThreadId is null");return}(La=this.ahc(La.id,La.anchor))&&this.tJ.updateContainer(La)}if(this.Fza&&this.Jmc(Nd.d(this.$.na))){La=this.excelCommentManager.model.Tu;if(!La){e.ULS.sendTraceTag(537167266,
12,10,"InProgressComment is null");return}(La=this.ahc(this.EL,this.wmd(La)))&&this.tJ.updateContainer(La)}this.stg()}wmd(La){if(La.fl&&0<La.fl.length){const Kb=this.excelCommentManager.model.Ou(La.fl);return Kb?Kb.anchor:La.anchor}return La.anchor}ahc(La,Kb){return(Kb=this.z9e(Kb))?this.G9e(Kb,La):null}G9e(La,Kb){const uc=new Mf;uc.anchorLeft=we.a(this.$).Bi(La.x);uc.anchorTop=we.a(this.$).Bi(La.y);uc.anchorRight=we.a(this.$).Bi(La.x+La.width);uc.anchorBottom=we.a(this.$).Bi(La.y+La.height);uc.containerContentType=
0;uc.contentId=Kb;return uc}q4h(La){var Kb=Ve.h(this.$).zk;Kb=this.Gze(new Sys.UI.Bounds(this.gridView.rtl?Kb.clientWidth:Kb.clientLeft,Kb.clientTop,0,0));return this.G9e(new Sys.UI.Bounds(Kb.x,Kb.y,0,0),La)}z9e(La){La=this.gridView.Mv(La)||La;La.isSingle||(La=sa.B(this.gridView.Eq.z$e(La)).topRight);La=this.gridView.tc(La);if(!La||!La.cell.Zk)return null;La=this.gridView.getCellBounds(La.cell);this.sjc=Xd.DOMElementExtensions.getBoundingClientRect(this.gridView.zk);return new Sys.UI.Bounds(La.x-
this.sjc.x,La.y-this.sjc.y,La.width,La.height)}Gze(La){if(!Nd.b(this.$.na))return La;const Kb=this.gridView.rtl?La.x:La.x+this.gridView.dt,uc=La.y+this.gridView.gL;return Da.EwaSettings.isChangeGateEnabled("OfficeVSO:5198843_FloatingCommentHeaderDimensions")?new Sys.UI.Bounds(Kb,uc,La.width-this.gridView.dt,La.height-this.gridView.gL):new Sys.UI.Bounds(Kb,uc,this.gridView.rtl?La.width-this.gridView.dt:La.width,La.height)}Mze(){we.a(this.$).UDc(this.q0)}dvg(){this.Xmc||this.rea?(this.KJc(),this.d7c()):
this.bLc=!0}d2h(La){({W3a:La}=this.gridView.Ngc(La));return this.gridView.Wb.fQa(La)?this.gridView.Mv(La):La}r5i(La){Bf.mva(La,this.EL)?this.xZb=!0:(this.mE=La,this.OGc())}p5i(La){Bf.mva(La,this.EL)?this.xZb=!1:Bf.mva(La,this.mE)?(this.mE=null,this.OGc()):e.ULS.sendTraceTag(537167263,12,15,"A comment has been hidden that we're not currently tracking as being shown")}q5i(){this.bbe=!0;this.xig&&this.luc();if(this.Efc){const La=this.excelCommentManager.model.Ou(this.Efc);La?(this.oFc(La,!0),this.Efc=
null):e.ULS.sendTraceTag(537167261,12,15,"Comment not found")}}Jmc(La){const Kb=Object(xa.a)(a(777).ExcelCommentManager,this.excelCommentManager);return!Kb||!Kb.zf.Tu||""!==Kb.zf.pW&&Kb.zf.pW!==La?!1:!0}OGc(){this.rea||this.excelCommentManager.model.Tu?this.sEh():this.iYe()}sEh(){this.$5b||(this.gridView.view.As(this.rTf),this.$.ua.UK(this.Mp),this.$.ua.Vg(this.tk),this.$5b=!0)}iYe(){this.$5b&&(this.gridView.view.wq(this.rTf),this.$.ua.zM(this.Mp),this.$.ua.xh(this.tk),this.$5b=!1)}static mva(La,
Kb){return ae.a.equals(La,Kb,!0)}}Object(c.a)(Bf,"FloatingCommentManager",null,[2]);var vf=a(829),Rf=a(38),re=a(49),Aa=a(250),Eb=a(232),cc=a(249),pc=a(298),Hc=a(222),td=a(68);class me extends Sys.EventArgs{constructor(La){super();this.yVh=La}}Object(c.a)(me,"DismissFloatingNoteEventArgs",Sys.EventArgs,[]);var ve=a(866),Qe=a(116),Ze=a(76),nf=a(476);class Cb extends cc.a{constructor(La,Kb,uc,Sc=null,nd=!1,Jd=1){super(document.createElement(Hc.a.div));this.ayd=!1;this.Sgf=0;this.ODd=this.wRa=null;this.ULf=
(ne,Ue)=>{this.FUd(Ue);Xd.DOMElementExtensions.Rq(this.Tm)!==this.Tm&&Xd.DOMElementExtensions.setFocus(this.Tm,!0);this.raiseEvent("OnFloatingNoteResized",Ue)};this.e$i=()=>{this.raiseEvent("OnFloatingNoteMouseEnter");return!0};this.f$i=()=>{this.raiseEvent("OnFloatingNoteMouseLeave");return!0};this.g$i=ne=>{this.gridView.ga.Sa.LI(null);Ze.g(ne.Da,!1);this.raiseEvent("OnFloatingNotePointerDown");return!1};this.b$i=ne=>{this.gridView.ga.Sa.LI(null);Ze.g(ne.Da,!1);return!1};this.c$i=ne=>{Ze.g(ne.Da,
!1);return!1};this.BZi=ne=>{if(ne.Da.keyCode===md.a.NH||ne.Da.keyCode===md.a.aA)return Xd.DOMElementExtensions.setFocus(this.Tm,!0),!0;!ne.Da.shiftKey||ne.Da.keyCode!==md.a.X$&&ne.Da.keyCode!==md.a.Ura&&ne.Da.keyCode!==md.a.cFa&&ne.Da.keyCode!==md.a.W$||ne.Da.stopPropagation();return!1};this.GUh=ne=>ne.Da.keyCode===md.a.NH?(this.gridView.focus(),!0):ne.Da.keyCode===md.a.aA?(Xd.DOMElementExtensions.setFocus(this.GC),!0):!1;this.h$i=ne=>{this.ayd&&(this.raiseEvent("OnFloatingNoteTextEdited"),this.ayd=
!1);this.d_f(ne.rawEvent)};this.n5i=ne=>{this.d_f(ne.rawEvent)};this.l$i=()=>{this.raiseEvent("OnFloatingNoteTextScrolled")};this.j$i=()=>{this.ayd=!0;this.raiseEvent("OnFloatingNoteTextInput")};this.k$i=ne=>{ne.stopPropagation()};this.i$i=()=>{this.setActive();this.raiseEvent("OnFloatingNoteGotFocus");this.Sgf=Qe.toTimestamp(new Date).m};this.gridView=Ve.h(La);this.cpb=Kb.id;const ke=document.createElement(Hc.a.textArea);this.Z3d=this.kf.Re(ke);this.Tm.classList.add(hd.a.UZe);ke.classList.add(hd.a.bJh);
vf.a.xt(La)||(ke.readOnly=!0);this.Tm.tabIndex=0;this.Tm.appendChild(ke);this.fi=this.gridView.sg(Jd);this.fi.CZi.appendChild(this.Tm);this.Czb=uc.tLa(this.Tm,this.gridView,0);this.Czb.Tye(this.ULf);this.KXa(Kb.text.toString());this.hRb(Kb.anchor);Sc&&this.Pgk(Sc);this.Tm.dir=La.isChromeRtl?pc.a.rtl:pc.a.Obb;Xd.DOMElementExtensions.xy(this.Tm,pd.a.TCe);this.Tm.setAttribute(pd.a.U2g,U.a.instance.ha(877));nd&&ke.setAttribute(pd.a.xv,U.a.instance.ha(878));this.Guj();this.jRd();Xa.a(this.gridView.$,ne=>
{this.wRa=ne.DR(Db.a.ODj,!1,!0)});Xa.a(this.gridView.$,ne=>{this.ODd=ne.DR(Db.a.KUh,!1,!0)})}get efa(){return this.cpb}w4b(La){this.addHandler("DismissFloatingNote",La)}Yzc(La){this.removeHandler("DismissFloatingNote",La)}nsb(La){this.addHandler("OnFloatingNoteMouseEnter",La)}iAc(La){this.removeHandler("OnFloatingNoteMouseEnter",La)}osb(La){this.addHandler("OnFloatingNoteMouseLeave",La)}jAc(La){this.removeHandler("OnFloatingNoteMouseLeave",La)}S2c(La){this.addHandler("OnFloatingNotePointerDown",La)}LSd(La){this.removeHandler("OnFloatingNotePointerDown",
La)}EYg(La){this.addHandler("OnFloatingNoteTextInput",La)}xzj(La){this.removeHandler("OnFloatingNoteTextInput",La)}FYg(La){this.addHandler("OnFloatingNoteTextScrolled",La)}yzj(La){this.removeHandler("OnFloatingNoteTextScrolled",La)}AYg(La){this.addHandler("OnFloatingNoteResized",La)}uzj(La){this.removeHandler("OnFloatingNoteResized",La)}J4b(La){this.addHandler("OnFloatingNoteTextEdited",La)}kAc(La){this.removeHandler("OnFloatingNoteTextEdited",La)}tYg(La){this.addHandler("OnFloatingNoteGotFocus",
La)}rzj(La){this.removeHandler("OnFloatingNoteGotFocus",La)}get bSa(){return this.GC.value}get HGf(){return this.GC.scrollTop}get m$a(){return!!this.GC&&Xd.DOMElementExtensions.Rq(this.Tm)===this.GC}get paneType(){return this.fi.paneType}get dimensions(){return new Sys.UI.Bounds(0,0,this.Tm.clientWidth,this.Tm.clientHeight)}get Tm(){return this.domElement}get GC(){return this.Tm?this.Tm.firstChild:null}dispose(){this.Czb&&(this.Czb.tzj(this.ULf),this.Czb.dispose(),this.Czb=null);this.Tm&&(this.GC&&
(re.a.Mpa(this.GC),this.Z3d.oE(),fb.a.ed([this.Z3d]),this.Tm.removeChild(this.GC)),re.a.Mpa(this.Tm),this.Dd.oE(),Xd.DOMElementExtensions.tg(this.Tm));this.gridView=this.cpb=null;super.dispose()}focus(){if(this.GC){if(this.GC.value){const La=this.GC.value.length;nf.a(this.GC,La,La)}Xd.DOMElementExtensions.setFocus(this.GC,!1)}}hRb(La){this.gridView.$Y(La)?(La=this.gridView.Mv(La)||La,La=this.gridView.gh(La,this.fi.paneType,void 0,void 0,!1)||td.a.A6,Xd.DOMElementExtensions.updatePosition(this.Tm,
La.bottomRight.x,La.topLeft.y,!0,this.gridView.rtl)):this.ODd&&this.ODd(()=>({["PaneType"]:this.fi.paneType.toString(),["Location"]:"floatie"}))}KXa(La){this.bSa!==La&&(this.GC.value=La)}B7d(La){this.HGf!==La&&(this.GC.scrollTop=La)}Pgk(La){La=new ve.a(La.width,La.height,!1,!1);this.FUd(La)}FUd(La){if(La.height!==this.Tm.clientHeight||La.width!==this.Tm.clientWidth)La.height=Math.max(La.height,30),La.width=Math.max(La.width,30),this.gridView.rtl&&Sys.UI.DomElement.setLocation(this.Tm,this.Tm.offsetLeft-
(La.width-this.Tm.clientWidth),this.Tm.offsetTop),Xd.DOMElementExtensions.uK(this.Tm,La.height),Xd.DOMElementExtensions.qx(this.Tm,La.width),this.wRa&&this.wRa(()=>({["IsRTL"]:this.gridView.rtl,["Location"]:"floatie"}))}setActive(){this.Tm.classList.add(hd.a.Ogd)}Zdg(){this.Tm.classList.remove(hd.a.Ogd)}Guj(){Aa.a.instance.ta(k.a.XX,this.Tm,this.e$i);Aa.a.instance.ta(k.a.TC,this.Tm,this.f$i);Aa.a.instance.ta(k.a.pointerDown,this.Tm,this.g$i);Eb.a.instance.ta(k.a.click,this.domElement,this.b$i);Eb.a.instance.ta(k.a.nl,
this.domElement,this.c$i);this.Dd.la("contextmenu",La=>{Ze.g(La,!1)});this.Z3d.la("blur",this.h$i);this.Dd.la("blur",this.n5i);re.a.addHandler(this.GC,k.a.scroll,this.l$i);re.a.addHandler(this.GC,k.a.focus,this.i$i)}jRd(){l.KeyInputManager.instance.ta(k.a.Ic,this.GC,this.BZi);l.KeyInputManager.instance.ta(k.a.Ic,this.Tm,this.GUh);re.a.addHandler(this.GC,k.a.input,this.j$i);re.a.addHandler(this.GC,k.a.EWd,this.k$i)}d_f(La){this.Tm.contains(La.relatedTarget)||(50>Qe.toTimestamp(new Date).m-this.Sgf&&
Xa.b(this.gridView.$).Vd(Db.a.JUh,{["Location"]:"floatie",["callstack"]:Error().stack},void 0,!0),this.Zdg(),this.raiseEvent("DismissFloatingNote",new me(La.relatedTarget)))}}Object(c.a)(Cb,"FloatingNoteControl",cc.a,[894,2]);class ac{constructor(){this.roc=!1;this.dimensions=ac.edd}static iBi(La){return La.height===ac.edd.height&&La.width===ac.edd.width}}ac.edd=new Sys.UI.Bounds(0,0,210,150);Object(c.a)(ac,"FloatingNoteState",null,[]);var qc=a(129);class Oc extends cc.a{constructor(La,Kb,uc,Sc=null,
nd=!1){super(document.createElement(Hc.a.div));this.JJf=Jd=>{this.KXa(Jd.bSa)};this.KJf=Jd=>{this.B7d(Jd.HGf)};this.CJf=(Jd,ke)=>{qc.b(this.pr.values,ne=>ne.domElement.contains(ke.yVh))||(Rf.a.forEach(this.pr.Pt,ne=>{ne.value.Zdg()}),this.raiseEvent("DismissFloatingNote"))};this.EJf=()=>{this.raiseEvent("OnFloatingNoteMouseEnter")};this.FJf=()=>{this.raiseEvent("OnFloatingNoteMouseLeave")};this.GJf=()=>{this.raiseEvent("OnFloatingNotePointerDown")};this.HJf=(Jd,ke)=>{const ne=Jd.paneType;Rf.a.forEach(this.pr.Pt,
Ue=>{Ue=Object(xa.a)(Cb,Ue.value);Ue.paneType!==ne&&Ue.FUd(ke)})};this.IJf=()=>{this.raiseEvent("OnFloatingNoteTextEdited")};this.DJf=()=>{Rf.a.forEach(this.pr.Pt,Jd=>{Jd.value.setActive()})};this.YQg=new Rf.a(!1);this.behaviorsFactory=uc;for(uc=1;4>=uc;uc++)this.Yti(La,Kb,Sc,nd,uc);this.cpb=Kb.id}get pr(){return this.YQg}get efa(){return this.cpb}get bSa(){return this.pr.Wg(0).bSa}get m$a(){return qc.b(this.pr.values,La=>La.m$a)}get dimensions(){return this.pr.Wg(0).dimensions}w4b(La){this.addHandler("DismissFloatingNote",
La)}Yzc(La){this.removeHandler("DismissFloatingNote",La)}nsb(La){this.addHandler("OnFloatingNoteMouseEnter",La)}iAc(La){this.removeHandler("OnFloatingNoteMouseEnter",La)}osb(La){this.addHandler("OnFloatingNoteMouseLeave",La)}jAc(La){this.removeHandler("OnFloatingNoteMouseLeave",La)}S2c(La){this.addHandler("OnFloatingNotePointerDown",La)}LSd(La){this.removeHandler("OnFloatingNotePointerDown",La)}J4b(La){this.addHandler("OnFloatingNoteTextEdited",La)}kAc(La){this.removeHandler("OnFloatingNoteTextEdited",
La)}dispose(){Rf.a.forEach(this.pr.Pt,La=>{La=La.value;La.xzj(this.JJf);La.yzj(this.KJf);La.Yzc(this.CJf);La.iAc(this.EJf);La.jAc(this.FJf);La.LSd(this.GJf);La.uzj(this.HJf);La.kAc(this.IJf);La.rzj(this.DJf);La.dispose()});this.cpb=null;super.dispose()}focus(){this.pr.Wg(0).focus()}hRb(La){Rf.a.forEach(this.pr.Pt,Kb=>{Kb.value.hRb(La)})}KXa(La){Rf.a.forEach(this.pr.Pt,Kb=>{Kb.value.KXa(La)})}B7d(La){Rf.a.forEach(this.pr.Pt,Kb=>{Kb.value.B7d(La)})}Yti(La,Kb,uc,Sc,nd){La=new Cb(La,Kb,this.behaviorsFactory,
uc,Sc,nd);this.pr.add(nd.toString(),La);La.EYg(this.JJf);La.FYg(this.KJf);La.w4b(this.CJf);La.nsb(this.EJf);La.osb(this.FJf);La.S2c(this.GJf);La.AYg(this.HJf);La.J4b(this.IJf);La.tYg(this.DJf)}}Object(c.a)(Oc,"MultiPanesFloatingNoteControl",cc.a,[894,2]);var xd=a(51),Md=a(48);class je{constructor(La,Kb,uc){this.uMb=this.cfa=this.Ure=this.olf=this.XTb=this.Joa=this.Icb=null;this.mX=this.iHa=!1;this.Ffc=new Rf.a(!1);this.qDd=this.sDd=null;this.Bxb=()=>{this.hw&&(this.nMe(this.hw),this.hw.Yzc(this.jSf),
this.hw.kAc(this.Fuc),this.YQe(this.hw.efa,this.hw.dimensions),this.hw.dispose(),this.hw=null)};this.gfd=Sc=>{const nd=this.gridView.$.na.sheetName!==Sc.SheetName,Jd=sa.E(Sc);this.gridView.Eh(Sc,Jd,Jd,null,0,"NoteManager.EditNoteAtRange",void 0,void 0,void 0,void 0,!0);nd||this.mX||!this.GG||!this.NFb(this.ZO)?(Xa.b(this.gridView.$).Vd(Db.a.CTh,this.Cm(),void 0,!1),this.uMb=Sc,this.sDd&&fb.a.Ka(this.sDd),this.sDd=xd.a.instance.create(()=>{this.uMb&&Xa.b(this.gridView.$).Vd(Db.a.DTh,{["isDifferentSheet"]:nd,
["isRecreatingInstancesRequired"]:this.mX,["HasNoteAtActiveCell"]:this.GG,["IsNoteInLoadedRange"]:this.NFb(this.ZO),["Location"]:"floatie"},void 0,!0)},1500,Md.a.zZi,!0,!0)):(this.adc(),this.uMb=null)};this.Ckc=()=>{this.uFb&&this.Ddd()};this.sNf=()=>{this.a8b()};this.tNf=()=>{this.Joa&&this.Joa.ir()};this.uNf=()=>{this.q9j()};this.rNf=()=>{this.Ckc()};this.jSf=()=>{this.Bxb()};this.Fuc=Sc=>{this.nMe(Sc)};this.wBa=(Sc,nd)=>{nd.na!==nd.WC&&this.vkc()};this.mMf=()=>{this.mX=!0};this.lIf=()=>{this.mX=
!0};this.mIf=()=>{this.mX=!0};this.kd=()=>{this.mX=!0};this.Vr=()=>{let Sc=null;this.mX&&(this.mX=!1,this.hw&&this.hw.m$a&&(Sc=this.Jz.kod(this.hw.efa),Xa.b(this.gridView.$).Vd(Db.a.Mwh,this.Cm(),void 0,!0)),this.vkc());this.LQd();e.ULS.shipAssertTag(537167244,12,!this.mX);this.Jz.Trd&&Xa.b(this.gridView.$).Vd(Db.a.d$i,this.Cm());Sc&&this.GNd(Sc)};this.Lj=()=>{this.LQd()};this.excelCommentManager=La;this.gridView=Ve.h(La.$);this.ga=this.gridView.ga;this.Jz=Kb;this.behaviorsFactory=uc;this.gridView.$.ua.UK(this.wBa);
this.gridView.$.ua.Vua(this.mMf);this.gridView.$.ua.$xe(this.lIf);this.gridView.$.ua.J2c(this.mIf);this.gridView.$.ik(this.kd);this.gridView.fV(this.Vr);this.gridView.$.kA(this.Lj);this.qoe=new Rf.a(!1);Xa.a(this.gridView.$,Sc=>{this.qDd=Sc.DR(Db.a.GXi,!1,!1)})}get i1c(){const La=this.gridView.Mv(this.ga.pa.activeCell);return La?La.topLeft:this.ga.pa.activeCell}get GG(){return!!this.ZO}get ZO(){return this.Jz.jic(this.i1c)}get Urd(){const {ExcelCommentManager:La}=a(777);return La.FCe(this.Jz.notes.values,
this.ga.pa.selectedRanges)}get FBi(){return!!this.hw&&this.hw.m$a||oa.a.any(this.UX.values,La=>La.m$a)}get kIi(){return this.iHa}get uFb(){return!!this.EE}get UX(){return this.qoe}get hw(){return this.Ure}set hw(La){this.MHe();this.Ure=La}get EE(){return this.olf}set EE(La){this.olf=La}dispose(){this.gridView&&(this.gridView.BP(this.Vr),this.gridView.$&&(this.gridView.$.Wl(this.kd),this.gridView.$.ua.zM(this.wBa),this.gridView.$.ua.SCa(this.mMf),this.gridView.$.ua.DSd(this.mIf),this.gridView.$.ua.M4f(this.lIf),
this.gridView.$.$C(this.Lj)));this.XTb=this.Jz=this.ga=this.gridView=null;this.Icb&&(this.Icb.dispose(),this.Icb=null);this.Joa&&(this.Joa.dispose(),this.Joa=null);this.vkc();this.qoe=null}NFb(La){return!!La&&!!this.gridView.$Y(La.anchor)}boc(La){if(!La)return!0;La=La.anchor;La=this.gridView.Mv(La)||La;return this.gridView.Eq.Ei(La)}kbi(La){return this.UX.getItem(La)}Zmd(La){return this.Ffc.getItem(La)}YQe(La,Kb,uc=!1){if(uc===this.iHa&&ac.iBi(Kb))this.Ffc.remove(La);else{var Sc=this.Zmd(La);Sc||
(Sc=new ac,this.Ffc.add(La,Sc));Sc.dimensions=Kb;Sc.roc=uc}}Ksg(La){this.Ffc.forEach(Kb=>{Kb.value.roc=La})}ysg(){this.EE.iAc(this.sNf);this.EE.jAc(this.tNf);this.EE.LSd(this.uNf);this.EE.Yzc(this.rNf)}Ddd(){this.EE&&(this.ysg(),this.EE.dispose(),this.EE=null)}Edd(La,Kb=!1){let uc=this.UX.getItem(La);uc&&(this.Jz.jug(uc.efa,uc.bSa),uc.kAc(this.Fuc),this.YQe(uc.efa,uc.dimensions,!Kb),uc.dispose(),this.UX.remove(La),this.gridView.focus())}vkc(La=!1){this.Ddd();this.Bxb();this.UX.forEach(Kb=>{this.Edd(je.rcf(Kb),
La)})}etj(){this.UX.forEach(La=>{this.NQd(je.z6h(La),()=>{this.Edd(je.rcf(La))})})}LQd(){this.cfa?this.hw.hRb(this.cfa.anchor):this.NQd(this.hw,this.Bxb);this.etj();this.NQd(this.EE,this.Ckc);this.b0f();this.uMb&&this.gfd(this.uMb)}YZi(){this.LQd()}vbd(){this.gridView.Eq.Ei(this.ga.pa.activeCell)||(this.cfa=vf.a.Wph(this.i1c,this.excelCommentManager),this.GNd(this.cfa),Xa.b(this.gridView.$).Vd(Db.a.vbd,this.Cm(),void 0,!1))}adc(){this.NFb(this.ZO)?this.boc(this.ZO)||(this.UX.Pb(this.ZO.id)?this.kbi(this.ZO.id).focus():
this.GNd(this.ZO),Xa.b(this.gridView.$).Vd(Db.a.adc,this.Cm(),void 0,!1)):this.gfd(sa.v(this.ZO.anchor,this.gridView.$))}Add(){this.Jz.Add(this.ga.pa)}ETh(La){this.Bxb();this.Jz.FTh(La,this.i1c,this.gfd);Xa.b(this.gridView.$).Vd(Db.a.findNextOrPreviousNote,this.Cm(),void 0,!1)}XYj(){const {ExcelCommentManager:La}=a(777);if(!this.GG)e.ULS.sendTraceTag(592541398,12,10,"Show/Hide Note button is expected to be disabled when no note at active cell");else if(!this.boc(this.ZO)){this.MHe();this.Bxb();var Kb=
this.ZO;this.UX.Pb(Kb.id)?(this.Edd(Kb.id,!0),Xa.b(this.gridView.$).Vd(Db.a.Jpi,this.Cm(),void 0,!1)):(this.sXf(this.ZO),Xa.b(this.gridView.$).Vd(Db.a.Pni,this.Cm(),void 0,!1));this.gridView.focus();La.vag(this.UX.Pb(Kb.id)?881:882,this.gridView.$)}}showOrHideAllNotes(){const {ExcelCommentManager:La}=a(777);(this.iHa=!this.iHa)?(this.Ksg(!0),this.b0f(),Xa.b(this.gridView.$).Vd(Db.a.fXj,this.Cm(),void 0,!1)):(this.vkc(!0),this.Ksg(!1),Xa.b(this.gridView.$).Vd(Db.a.eXj,this.Cm(),void 0,!1));this.gridView.$.ig();
this.gridView.focus();La.vag(this.iHa?879:880,this.gridView.$)}Fkh(){this.GG?(new ma(this.gridView.$,this.excelCommentManager,this.ZO.id,null),Xa.b(this.gridView.$).Vd(Db.a.convertNote,this.Cm(),void 0,!0)):e.ULS.sendTraceTag(574739536,12,10,"Convert Note button is expected to be disabled when no note at active cell")}a$i(La,Kb){(Kb=this.Jz.jic(Kb))?this.UX.Pb(Kb.id)||this.hw||(La?this.mKd(Kb):this.tvc()):e.ULS.sendTraceTag(592541397,12,50,"ECM.OnNoteCellHoverChange: Mouse hover triggered for null comment at cell with notch. Comments might not have been loaded yet.")}mKd(La){if(this.uFb){if(La.id===
this.EE.efa){this.a8b();return}this.XTb=La.id}Xa.b(this.gridView.$).Vd(Db.a.mKd,this.Cm());this.Icb=xd.a.instance.create(()=>{this.z0d(La);this.XTb=null},200,Md.a.AZi,!0,!1)}tvc(){this.XTb?this.uFb&&this.XTb===this.EE.efa?this.w7c():(Xa.b(this.gridView.$).Vd(Db.a.tvc,this.Cm()),this.Joa=xd.a.instance.create(()=>{this.Ckc()},250,Md.a.GGf,!0,!1)):this.uFb?(Xa.b(this.gridView.$).Vd(Db.a.tvc,this.Cm()),this.Joa=xd.a.instance.create(()=>{this.Ckc()},250,Md.a.GGf,!0,!1)):this.w7c()}z0d(La){this.uFb&&(this.Ddd(),
this.a8b());this.ylj(La);Xa.b(this.gridView.$).Vd(Db.a.z0d,this.Cm(),void 0,!1)}MHe(){this.a8b();this.w7c()}a8b(){this.Joa&&this.Joa.cancel()}w7c(){this.Icb&&this.Icb.cancel()}q9j(){this.ysg();this.hw=this.EE;this.EE=null;this.zmg();Xa.b(this.gridView.$).Vd(Db.a.B0j,this.Cm(),void 0,!1)}zmg(){this.hw.w4b(this.jSf);this.hw.J4b(this.Fuc)}ylj(La){this.EE=this.Yad(La);this.EE.nsb(this.sNf);this.EE.osb(this.tNf);this.EE.S2c(this.uNf);this.EE.w4b(this.rNf)}GNd(La){e.ULS.shipAssertTag(537167248,12,!this.hw,
"Should not have two soft pinned floaties on the grid.");this.hw=this.Yad(La);this.zmg();this.hw.focus()}sXf(La){const Kb=this.Yad(La);Kb.J4b(this.Fuc);this.UX.add(La.id,Kb)}Yad(La){e.ULS.shipAssertTag(537167246,12,!this.UX.Pb(La.id)&&(!this.hw||this.hw.efa!==La.id),"Should not have more than one floating note with the same ID.");var Kb=this.Zmd(La.id);Kb=Kb?Kb.dimensions:null;return this.gridView.Mb.tj?(this.qDd&&this.qDd(()=>this.Cm()),new Oc(this.gridView.$,La,this.behaviorsFactory,Kb,!!this.cfa)):
new Cb(this.gridView.$,La,this.behaviorsFactory,Kb,!!this.cfa)}NQd(La,Kb){if(La){var uc=this.Jz.kod(La.efa);uc&&this.NFb(uc)&&!this.boc(uc)?(La.hRb(uc.anchor),La.m$a||La.KXa(uc.text.toString())):Kb()}}nMe(La){this.cfa?(this.cfa.text=[La.bSa],this.Jz.Rph(this.cfa),this.cfa=null):this.Jz.jug(La.efa,La.bSa)}b0f(){var La=this.Jz.notes.values;for(const Kb of La)La=this.Zmd(Kb.id),!this.UX.Pb(Kb.id)&&(this.iHa?!La||La.roc:La&&La.roc)&&this.NFb(Kb)&&!this.boc(Kb)&&this.sXf(Kb)}Cm(){return{["Location"]:"floatie"}}static rcf(La){return La.key}static z6h(La){return La.value}}
Object(c.a)(je,"NoteManager",null,[880,2]);var oe=a(86),Ge=a(119);class Ce extends oe.a{constructor(La,Kb){super();this.notes=new Rf.a(!1);this.e1i=(uc,Sc,nd)=>{mb.a(uc)?(this.IIf(null,Sc,nd),this.$.ea.ep(uc.Errors)):(e.ULS.shipAssertTag(537167241,12,0<=uc.Result,"Invalid note id (insert order) provided by server when inserting new note into note model."),Xa.b(this.$).Vd(Db.a.lth,this.Cm(),void 0,!1),this.$.ig(),Ve.h(this.$).focus())};this.IIf=(uc,Sc)=>{e.ULS.sendTraceTag(579089047,12,10,`Failed to create a note. ${Sc}`)};
this.Y3i=uc=>{e.ULS.sendTraceTag(537167238,12,10,"Failed to delete one or more notes in the selected ranges.");uc&&this.$.ea.ep(Ge.a.vf(uc.data))};this.PLf=()=>{e.ULS.sendTraceTag(574365953,12,10,"Failed to find next/previous note.")};this.$=La;this.Z1e=Kb}get Trd(){return!!this.notes&&0<this.notes.count}dispose(){this.notes=null;super.dispose()}kod(La){return this.Trd&&La?this.notes.getItem(La):null}jic(La){return this.Trd&&(La=this.scf(La),0<=La)?this.notes.Wg(La):null}nha(La){this.notes.clear();
for(const Kb of La)this.notes.Pb(Kb.id)?e.ULS.sendTraceTag(537167243,12,15,"Note id already exists!"):this.notes.add(Kb.id,Kb);this.notes.L1d((Kb,uc)=>{const {ExcelCommentManager:Sc}=a(777);return Sc.Qvb(Kb.anchor,uc.anchor)})}jug(La,Kb){La=this.kod(La);La?Kb!==La.text.toString()&&(La.text=[Kb],this.Z1e.FNb([La],4),Xa.b(this.$).Vd(Db.a.Ahh,this.Cm(),void 0,!1)):e.ULS.sendTraceTag(588890946,12,15,"UpdateNoteText: the note we're tring to edit doesn't exist.")}Rph(La){this.d2g(La)}d2g(La){if(La){var Kb=
new Ha.a(182,0,(uc,Sc,nd)=>Fa(this.$.qa.va,1,La.text[0],sa.q(La.anchor,this.$),-1,qa.b(uc,this.e1i),qa.a(Sc,this.IIf),nd,La.id),1);this.$.userOperationManager.Bd(Kb,null)}}Add(La){if(La.rX){var Kb=this.jic(La.selectedRanges[0]);Kb?(this.Z1e.FNb([Kb],3),Xa.b(this.$).Vd(Db.a.mwh,this.Cm(),void 0,!1)):e.ULS.sendTraceTag(537167240,12,15,"DeleteNotesInSelectedRanges: the note we're tring to delete doesn't exist.")}else{var uc=Sc=>{Sc&&mb.a(Sc)&&(e.ULS.sendTraceTag(537167239,12,50,"Delete notes succeeded but received warning message."),
this.$.ea.ep(Sc.Errors));Xa.b(this.$).Vd(Db.a.iwh,this.Cm(),void 0,!1)};Kb=new Ha.a(182,0,(Sc,nd,Jd)=>Fa(this.$.qa.va,3,null,sa.r(La.selectedRanges,this.$),-1,qa.b(Sc,uc),qa.a(nd,this.Y3i),Jd,null),65);this.$.userOperationManager.Bd(Kb,null)}}FTh(La,Kb,uc){var Sc=va.hod(Kb,La,this.notes.values).returnValue;if(Sc)for(Kb=null,Sc=this.scf(Sc.anchor);La?Sc<this.notes.count:0<=Sc;Sc+=La?1:-1)if(Kb=this.notes.Wg(Sc).anchor,Kb=Ve.h(this.$).Mv(Kb)||Kb,!Ve.h(this.$).Eq.Ei(Kb)){uc(sa.v(Kb,this.$));return}this.findNextOrPreviousNoteCrossSheet(La,
Kb,uc)}findNextOrPreviousNoteCrossSheet(La,Kb,uc){const Sc=(Jd,ke,ne)=>{Jd&&Jd.Result&&!mb.a(Jd)?(Jd=Jd.Result,Jd.SheetName===this.$.activeItemName&&Kb.equals(sa.E(Jd))&&!this.jic(Kb)?Ve.h(this.$).focus():uc(Jd)):this.PLf(null,ke,ne)},nd=new Ha.a(590,0,(Jd,ke,ne)=>Oa(this.$.qa.va,sa.o(Kb,this.$),La,qa.b(Jd,Sc),qa.a(ke,this.PLf),ne,null),80);this.$.userOperationManager.Bd(nd,null)}scf(La){const Kb=new Vb.a(this.notes.values);return ca.HelperMethods.Ry(Kb,0,this.notes.count,La,(uc,Sc)=>{const {ExcelCommentManager:nd}=
a(777);return nd.Qvb(uc.anchor,Sc)})}Cm(){return{["Location"]:"floatie"}}}Object(c.a)(Ce,"NoteModel",oe.a,[881,2]);var Ya=a(25),Qb=a(382),Ec=a(34),id=a(77);class Bd{constructor(){this.draftId=null;this.insertIndex=0;this.anchorHintText=null}}Object(c.a)(Bd,"CurrentContextDraft",null,[]);var Id=a(43),ee=a(106);a.d(C,"ExcelCommentManager",function(){return Fe});class Fe extends f.a{constructor(La,Kb,uc,Sc,nd,Jd,ke,ne,Ue,of){super(uc);this.H3b=[wa.a.idle,wa.a.XUa,wa.a.xga];this.Ta=new hb.a;this.Gac=
0;this.n0d=this.BWd=this.Bde=this.Ade=this.kAd=!1;this.LMa=this.pz=this.jQc=this.mMc=this.Tng=this.W8d=this.P5=null;this.R1a=0;this.ora=null;this.l$b=d.a.nil;this.WVf=this.VVf=null;this.qMb=0;this.bxc=null;this.Fwa=!1;this.Jz=this.h4d=null;this.correlationId=0;this.xPf=He=>{let We=!1;h.a.Fh&&window.focus();113===He.Da.keyCode&&He.Da.shiftKey&&(He=new cb.a(-1667294294,1,this.Ub.Tc,6,null),We=this.umg(1,He));return We};this.Ff=()=>{this.Plg();this.ctg()};this.tk=(He,We)=>{this.activeSheet!==We.na&&
(this.activeSheet=We.na)&&(this.cBc(),this.Czf(),this.m4a(),this.dtg(!0))};this.ZE=(He,We)=>{He=We.item;!He||""!==this.zf.pW&&Nd.d(He)!==this.zf.pW||this.akd()};this.eP=He=>{switch(He.Lv){case 1:this.bxc||this.cBc()}};this.W1=()=>{this.cBc()};this.ho=()=>{this.CM();this.cBc()};this.d6i=(He,We)=>{if(this.Kfa&&We===this.correlationId){this.Kfa=null;if(Ec.a.ng(He.Errors))this.kAd&&Ec.a.Oba(He.Errors)&&this.Ub.ea.fkd();else if(He=He.Result,this.aAd()){if(He&&He.ObjectMetadataArray){if(null===this.ora||
0===He.StartIndex?this.ora=He:this.ora.ObjectMetadataArray=this.ora.ObjectMetadataArray.concat(He.ObjectMetadataArray),0<He.AdditionalStartIndex){this.R1a=He.AdditionalStartIndex;this.Xba();return}}else this.ora=null;if(this.ora||this.version===Fe.GA)this.activeSheet.iL=this.ora,this.ckb(!1)}else if(He||this.version===Fe.GA)this.activeSheet.iL=He,this.ckb(!1);this.kAd=!1;this.l$b!==d.a.nil?(32!==this.RFf(this.l$b)&&e.ULS.sendTraceTag(537167382,12,15,"ExcelCommentManager.OnGetCommentsComplete: Deferred comment selection failed - comment may not exist."),
this.l$b=d.a.nil):this.n0d&&(this.m0d(),this.n0d=!1)}};this.e6i=He=>{this.Kfa=null;10===He.data.status?this.Xba():8!==He.data.status&&14!==He.data.status&&404!==He.data.httpStatus&&502!==He.data.httpStatus&&503!==He.data.httpStatus&&e.ULS.sendTraceTag(594886745,12,10,this.aAd()?`Comment information couldn't be retrieved. RequestStatus is ${He.data.status}. Http Status is ${He.data.httpStatus}. AdditionalCommentStartIndex is ${this.R1a}.`:`Comment information couldn't be retrieved. RequestStatus is ${He.data.status}. Http Status is ${He.data.httpStatus}.`)};
this.$A=()=>{this.kAd=this.commentTaskPane.$za;this.ymg(this.commentTaskPane.$za)};this.ee=()=>{this.activeSheet&&this.activeSheet.iL&&(this.activeSheet.iL.Version=Fe.GA);this.mode=this.Ub.isEditMode?1:0;this.commentTaskPane.Oh(this.commentTaskPane.$za)};this.Xdj=(He,We,$e)=>{mb.a(He)?(this.eTf(null,We,$e),this.ea.ep(He.Errors)):(this.ckb(!0),this.kBf(!0))};this.eTf=()=>{this.ckb(!0);this.kBf(!1)};this.i5i=(He,We,$e)=>{He&&He.Result&&!mb.a(He)?(this.bxc=null,$e=We.gridView,e.ULS.shipAssertTag(537167381,
12,Object(m.a)(240,$e),"ExcelCommentManager.OnFindNextOrPreviousCommentCrossSheetWebMethodSuccess: the userContext is null or not an IGridView."),this.qAf(!0),He=He.Result,this.dVj(He)&&(He=this.Gef(),this.pz.zMd=!0),this.SFf(He,$e,We.qed),this.qMb=0):this.OLf(null,We,$e)};this.OLf=()=>{this.bxc=null;this.qMb=0;this.qAf(!1)};this.k4a=(He,We,$e,Uf,Re)=>{if(!Re)return e.ULS.sendTraceTag(537167376,12,10,"actionData is null"),8;He=Re.NavigationId;We=this.K$h(He);if(isNaN(We))return e.ULS.sendTraceTag(537167375,
12,10,"Unable to extract nav type from navigation id"),8;11<We&&e.ULS.sendTraceTag(537167374,12,15,`Unexpected navigation type, type=${We}`);We=this.Kef(He);if(We.equals(d.a.nil))return e.ULS.sendTraceTag(537167373,12,10,"Unable to extract sheet id from navigation id"),8;if(!this.E4j(We))return e.ULS.sendTraceTag(537167372,12,15,"Destination sheet no longer exists"),8;He=this.H9e(He);return He.equals(d.a.nil)?(e.ULS.sendTraceTag(537167371,12,10,"Unable to extract content id from navigation id"),8):
this.activeSheet.iL?this.RFf(He):(this.l$b=He,32)};this.gMa=(He,We,$e,Uf,Re)=>{if(!Re)return e.ULS.sendTraceTag(537167370,12,10,"DoesCommentExist: actionData is null"),8;He=Re.NavigationId;if(!He)return e.ULS.sendTraceTag(537167369,12,10,"DoesCommentExist: navigation ID is null"),8;We=this.Kef(He);if(We.equals(d.a.nil))return e.ULS.sendTraceTag(537167368,12,10,"DoesCommentExist: Failed to parse sheet ID from navigation ID"),8;We=this.Jef(We);if(!We)return e.ULS.sendTraceTag(537167367,12,50,"DoesCommentExist: Sheet not found from Sheet ID; Sheet has been deleted"),
8;He=this.H9e(He);if(He.equals(d.a.nil))return e.ULS.sendTraceTag(537167366,12,10,"DoesCommentExist: Failed to parse content ID from navigation ID"),8;if(We.iL){for(const gb of We.iL.ObjectMetadataArray)if(He.equals(d.a.Gca(gb.CommentId)))return 32;e.ULS.sendTraceTag(537167365,12,50,"DoesCommentExist: Comment has been deleted");return 8}return 32};this.Ub=Sc;this.gridView=nd;this.ga=Jd;this.commentTaskPane=ke;this.ea=ne;this.Mr=Ue;this.l4a=La;this.UWi=new zc;this.RLi='"ops" : [';this.inh(of);this.TDb(Kb);
this.mode=Sc.isEditMode?1:0;0===this.mode&&this.l4a.classList.add("Interactive");this.l4a&&l.KeyInputManager.instance.ta(k.a.Ic,this.l4a,this.xPf);this.ga.add_activeCellChanged(this.Ff);this.Kfa=null;this.activeSheet=Sc.ua.na;for(let He=0,We=this.H3b.length;id.a(this.Ub)&&He<We;++He)id.a(this.Ub).eS(this.H3b[He]).Ar(this.eP);this.Ub.ua.Vg(this.tk);this.Ub.ua.e_(this.ZE);this.ea.MD(this.W1);Da.EwaSettings.isChangeGateEnabled("OfficeVSO:3298264_LoadOnDemandShouldResetCommentVersion")&&this.ea.VK(this.ho);
this.Ub.$l(this.ee);this.commentTaskPane.UF(this.$A);this.Dpf()&&(this.R1a=0,this.Xba());this.Na.Hc(ea.a.k4a,u.a.frame,this.k4a);this.Na.Hc(ea.a.gMa,u.a.frame,this.gMa);this.Na.Hc(ea.a.Jcb,u.a.frame,()=>{this.Jcb();return 32})}get mode(){return this.Gac}set mode(La){this.Gac=La;this.Ub.ig()}get RK(){return this.mMc}get Khd(){return this.jQc}get zf(){return this.VVf}get Q5(){return this.WVf}get $(){return this.Ub}get eo(){return this.LMa}get hasCommentAtActiveCell(){return!!this.cE}get yth(){return this.Ade}get zth(){return this.Bde}get cE(){return this.zf.HNa(this.ga.pa.activeCell)}get version(){return this.activeSheet.iL?
this.activeSheet.iL.Version:Fe.GA}get Qmg(){return 1===this.mode}get Fqa(){return!0}get Slc(){return 2===this.mode||3===this.mode}get R4a(){return this.zf.R4a}get zyh(){return new v.a(U.a.instance.Ha(441),CommentPaneStrings.DiscardDialogBody,CommentPaneStrings.DiscardDialogAbandon,CommentPaneStrings.DiscardDialogResume)}get MEb(){let La=Da.EwaSettings.ya(144)&&!this.Ub.OFb();Da.EwaSettings.isChangeGateEnabled("OfficeVSO:3999480_ShouldCheckTasksHostIsEnabled")&&(La=La&&x.AFrameworkApplication.fa.ra("TasksHostIsEnabled"));
return La}get nig(){return!1}oYg(La){this.Ta.addHandler(Fe.dJd,La)}pzj(La){this.Ta.removeHandler(Fe.dJd,La)}Jpj(){this.Ta.raiseEvent(Fe.dJd)}dispose(){this.l4a&&l.KeyInputManager.instance.Aa(k.a.Ic,this.l4a,this.xPf);this.ga&&this.ga.remove_activeCellChanged(this.Ff);this.Ub&&(this.Ub.ua.xh(this.tk),this.Ub.ua.R9(this.ZE),this.ea.gF(this.W1),this.Ub.hn(this.ee),Da.EwaSettings.isChangeGateEnabled("OfficeVSO:3298264_LoadOnDemandShouldResetCommentVersion")&&this.ea.EP(this.ho));this.commentTaskPane&&
this.commentTaskPane.rH(this.$A);for(let La=0,Kb=this.H3b.length;this.Ub&&La<Kb;++La)id.a(this.Ub).eS(this.H3b[La]).$r(this.eP);this.pz=this.ea=this.commentTaskPane=this.ga=this.gridView=this.Ub=null;this.LMa&&(this.LMa.dispose(),this.LMa=null);this.Jz&&(this.Jz.dispose(),this.Jz=null);this.Na.fB(ea.a.k4a,u.a.frame,this.k4a);this.Na.fB(ea.a.gMa,u.a.frame,this.gMa);super.dispose()}inh(La){this.JB=new B(E.a.instance);this.IB=this.WVf=Wb.createInstance(this.Na,E.a.instance,x.AFrameworkApplication.sa.Xz,
x.AFrameworkApplication.sa.jv,x.AFrameworkApplication.sa.Hf,x.AFrameworkApplication.sa.fha,this,this.Ub,this.commentTaskPane,this.JB,this.ga);this.mMc=new R(this.Na,this.IB.FRg);this.jQc=new oc;this.W8d=new Mc(this.commentTaskPane,this.IB.X9c);this.Tng=this.ush();this.pz=new Bf(this,this.commentTaskPane,this.Ub,this.gridView);this.dA=this.VVf=va.createInstance(this,this.Ub,this.ga,this.ea);this.iia=Nb.createInstance(this,this.Ub,this.gridView,this.ga,this.commentTaskPane);this.Nc=this.Mr;this.Jz=
new Ce(this.Ub,this.zf);this.LMa=new je(this,this.Jz,La)}Zif(){return Fe.FCe(this.zf.pAb(),this.ga.pa.selectedRanges)}TDb(La){this.Q5.initialize(this,this.l4a);this.zf.initialize(this);this.iia.initialize(La)}zAi(La){return!!La&&La===this.cE}umg(La,Kb){e.ULS.shipAssertTag(537167392,12,1===La||2===La&&this.hasCommentAtActiveCell||3===La,"ExcelCommentManager.SubmitCommentAction: we can't submit a delete/edit operation if there is no comment in the active selection.");let uc=!0;const Sc=1!==La?this.cE:
null;switch(La){case 3:this.zf.Zqd(Kb);break;case 2:this.Q5.editComment(ea.a.editComment,null,2,null,Sc.id);break;case 1:La=new Z.a;La.UV=Kb.Jf;La.S_=Kb.method;this.Q5.Yrb(ea.a.Bcb,null,2,La,this.ga.pa.activeCell.clone());break;default:uc=!1}return uc}setFocus(La,Kb){Kb||this.Q5.setFocus();return!Kb}Yrb(La){if(1===this.mode){La=va.Oph(this.ga.pa.activeCell,this,La);var Kb=new Pa;this.addComment(La,Kb);this.Ub.ig()}}WKa(La){this.yNa("ExcelCommentManager::CommitNewComment",La);super.WKa(La);this.mode=
4}VKa(La){this.yNa("ExcelCommentManager::CommitEditComment",La);super.VKa(La);this.mode=4}selectComment(La,Kb=1){this.Fyh(La);const uc=this.zf.Ou(La);uc&&(this.zf.selectComment(uc),this.iia.highlightComment(uc,!0),this.Q5.selectComment(uc,Kb),1===Kb&&(this.Cwd(La)?this.JB.selectComment(this.d5h()):this.JB.selectComment(La)))}xhh(La,Kb){Kb&&(La.done=Kb.isResolved);super.VKa(La);this.mode=4}f$c(La,Kb){super.f$c(La,Kb);this.mode=4}Csi(La=null){this.AVa();La=va.Pph(this.ga.pa.activeCell,this,La);this.yNa("ExcelCommentManager::InitCreateCommentSession",
La);this.zf.Qrb(La,!0);this.KHd();return this.zf.GAb(La)}kti(La,Kb=null){La=va.Qph(this.model.Ou(La).anchor,this,La,Kb);this.yNa("ExcelCommentManager::InitReplyCommentSession",La);this.zf.Qrb(La,!0);this.KHd();return this.zf.GAb(La)}Gsi(La,Kb=null){La=this.model.Ou(La);La.Glc(2,Kb);this.yNa("ExcelCommentManager::InitEditCommentSession",La);this.zf.bfd(La,Kb);this.KHd();return this.zf.GAb(La)}Wsi(La,Kb){La=this.model.Ou(La);this.zf.bfd(La,Kb);return this.zf.GAb(La)}w$c(){const La=this.zf.Tu;(null===
La||void 0===La?0:La.Iv)?this.endCommentSession(!0):e.ULS.sendTraceTag(537167391,12,10,"Attempting to discard when there is no active draft!")}endCommentSession(La){this.pz&&this.pz.a3i(this.yna());this.yna()&&(this.yNa("ExcelCommentManager::EndCommentSession",this.zf.Tu),this.zf.RHe(),this.zf.pW="",this.ckb(!0),La&&this.akd())}Fnj(){new ma(this.Ub,this,null,null)}upgradeLegacyComments(La){if(this.Ub&&id.a(this.Ub)&&this.Ub.qa){var Kb=new Ha.a(124,0,(uc,Sc,nd)=>fa(this.Ub.qa.va,La,qa.b(uc,this.Xdj),
qa.a(Sc,this.eTf),nd,this.correlationId));this.Ub.userOperationManager.Bd(Kb,null)}}Gxd(La){return(La=this.model.Ou(La))?La.G$a:!1}Mck(){this.Dw()}zbc(La){this.yNa("ExcelCommentManager::DeleteCommentConfirmed",La);if(La){this.eGa=null;this.Dw();La=this.zf.deleteComment(La);this.Q5.DRd(La);for(let Kb=0;Kb<La.length;Kb++)La[Kb].dispose()}}Yvh(La){if(this.ga.pa.rX&&this.commentTaskPane.isVisible){const Kb=this.cE;Kb?this.RK.g2(467845448,null,2,null,Kb.id):this.zf.Zqd(La)}else this.zf.Zqd(La)}cwh(La){(La=
this.model.Ou(La))&&this.deleteComment(La)}xWd(La,Kb=0){if(0===Kb){const uc=this.model.Ou(La);uc?this.iFc(uc.anchor,!1):e.ULS.sendTraceTag(537167390,12,15,"SelectExcelComment: comment is null, which means we will fail to select it")}this.selectComment(La,Kb)}Fyh(La){!this.commentTaskPane.isVisible&&this.pz&&this.yAi(La)&&this.zyb()}yAi(La){return!!this.zf.Tu&&this.zf.Tu.id===La}bJj(La){this.selectComment(La,1);H.a.w1a(E.a.instance,()=>{this.AVa()})}m4a(){var La=[];this.zf.pW===Nd.d(this.Ub.na)&&this.zf.Tu&&
(La=0,this.zf.Tu.Iv.sessionType===P.create&&(La=this.zf.GAb(this.zf.Tu)),La=[Object(b.a)(new Bd,{draftId:this.zf.Tu.Iv.draftId,insertIndex:La})]);this.akd(La)}shh(){const La=this.lic();this.JB?(this.JB.Nfk(this.R4a,0===this.mode),this.JB.TJj(La,this.ood(),this.zf.npd())):e.ULS.sendTraceTag(537167389,12,10,"Event host should not be null.")}lic(){return[...this.UWi.C9j(this.model.pAb(),!this.Ub.isEditMode,(new Rb.a(this.Ub.ua)).ki)]}wai(){return this.zf.npd()}ood(){const La=this.lic();let Kb=0;for(const uc of La)uc.parentId&&
uc.parentId.length||Kb++;return Kb}isCommentOperationEnabled(La){if(!this.pAe(this.mode)||this.Ub.Xe.get(1)||1!==this.ga.rf)return!1;let Kb=!1;switch(La){case 3:Kb=8!==this.RK.g2(ea.a.commentDelete,null,1,null,null);break;case 1:Kb=8!==this.RK.g2(ea.a.Bcb,null,1,null,null);break;case 4:Kb=8!==this.RK.g2(ea.a.QP,null,1,null,null);break;case 5:Kb=8!==this.RK.g2(ea.a.ET,null,1,null,null)}return Kb}pAe(La){return 1===La||2===La||3===La}yna(){return!!this.zf.Tu}dCc(){""===this.zf.pW&&(this.zf.pW=Nd.d(this.Ub.na))}ckb(La){if(La||
!this.Slc)this.Czf(),this.shh();this.dtg(La)}dtg(La){La||!this.Slc?(this.BWd||this.ctg(),this.commentTaskPane.$za&&this.BWd&&(this.ymg(!0),this.BWd=!1),this.pz&&this.pz.$2i()):this.Fwa=!0;this.BOi()}JCc(La){this.gridView.Eh(sa.v(La,this.Ub),La,null,null,60,"ExcelCommentManager.SelectRangeInGrid",void 0,void 0,void 0,void 0,!0)}wVg(La){if(La=this.Lgi(La))La=this.VQe(La),this.zf.Qrb(La,!1)}U4i(La){!La||this.commentTaskPane.isVisible?(this.hasCommentAtActiveCell&&this.selectComment(this.cE.id,1),(La=
this.model.pDa)&&La.focus()):this.Plg()}HNa(La){return this.zf.HNa(La)}Umf(La,Kb,uc=null){this.P5=new qb(this,this.JB,this.mMc,E.a.instance,this.Ub,La,this.zf,Kb,uc)}rQb(La){const Kb=new Y(!0,this.gridView);La?this.RK.g2(ea.a.QP,Kb,2,null,null):this.RK.g2(ea.a.ET,Kb,2,null,null)}Eig(){this.qqf()&&this.pz.uVh();this.commentTaskPane.isVisible||this.qqf()||this.m0d()}qqf(){const La=this.zf.pDa;return La?this.Cwd(La.id):!1}iJj(La,Kb){const uc=va.hod(this.ga.pa.activeCell,La,this.zf.pAb()).returnValue;
uc?(La=uc.anchor,this.iFc(La,Kb),this.gridView.Eh(sa.v(La,this.Ub),La,null,null,60,"ExcelCommentManager.SelectNextOrPreviousCommentFromActiveCell",void 0,void 0,void 0,void 0,!0)):this.CWd(La,Kb)}selectFirstThreadInNextCommentContext(){this.CWd(!0,!1)}selectLastThreadInPreviousCommentContext(){this.CWd(!1,!1)}setThreadResolvedState(La,Kb){this.x8b(this.model.Ou(La),Kb)}gridViewSetFocus(){this.gridView.setFocus()}tud(){this.pz.tud()}bKf(La,Kb,uc){Kb=new Ya.Range(Kb+1,uc+1,Kb+1,uc+1,!1,!1);(uc=this.zf.HNa(Kb))?
this.pz.o2a?La?this.pz.dKf(uc):this.pz.b3i(uc.id):e.ULS.sendTraceTag(537167388,12,50,"OnCommentCellHoverChange: floating comments not yet initialized"):this.LMa&&this.LMa.a$i(La,Kb)}eYj(La){this.pz.o2a&&(La=this.zf.HNa(La))&&this.pz.oFc(La,!1)}fYj(){this.m0d()}m0d(){this.cE?this.pz.oFc(this.cE,!0):this.Kfa?this.n0d=!0:e.ULS.sendTraceTag(537167387,12,15,"Trying to show a comment at the active cell for deep linking when none exists")}zyb(){this.pz.o2a&&this.pz.zyb()}E4j(La){const Kb=this.activeSheet;
if(Kb&&d.a.Gca(Kb.sheetId).equals(La))return!0;La=this.Jef(La);if(!La)return!1;La.activate(!0);return!0}pYi(){if(this.zf.Tu){var La=this.Gef();this.Ub.activeItemName===La.SheetName?this.xWd(this.c5h()):this.SFf(La,this.gridView)}}Cwd(La){const Kb=this.zf.Tu;if(!Kb||!Kb.Iv)return!1;const uc=Kb.Iv;return uc.draftId===La||uc.threadId===La||Kb.id===La||Kb.fl===La}BOi(){const La=[];var Kb=null;this.activeSheet&&this.activeSheet.iL&&(Kb=this.activeSheet.iL.ObjectMetadataArray);if(Kb)for(const uc of Kb)Kb=
uc,Kb.IsLegacy&&(Kb=new vf.a(Kb.CommentId,Kb.Author.DisplayName,Kb.Text,new Ya.Range(Kb.AnchorRow+1,Kb.AnchorColumn+1,Kb.AnchorRow+1,Kb.AnchorColumn+1,!1,!1),Kb.IsTextLocked?2:0,this),La.push(Kb));this.Bde=0<La.length;e.ULS.shipAssertTag(537167386,12,!!this.Jz,"LoadLegacyNotesData: not expecting NoteModel to be null");this.Jz&&this.Jz.nha(La);this.eo&&this.eo.YZi();this.Fwa=!1}Czf(){var La=null,Kb=null;this.activeSheet&&this.activeSheet.iL&&(Kb=this.activeSheet.iL.ObjectMetadataArray,La=this.activeSheet.iL);
const uc=[];var Sc=null;const nd=[];if(Kb){Sc=[];for(const Jd of Kb){Kb=Jd;const ke=this.VQe(Kb);if(!ke.G$a&&(Sc.push(Jd),ke.commentBody.startsWith(this.RLi)&&(ke.commentBody="{ "+ke.commentBody),"}"!==this.i9h(ke.commentBody)&&(ke.commentBody+="}"),uc.push(ke),this.MEb&&Kb.DocumentTaskObject)){const ne=new ee.a;ne.add(ke.id,new V(ke.id,ke.isResolved));Kb=this.jQc.D9j(Kb.DocumentTaskObject,ne);nd.push(Kb)}}}this.h4d=Sc;La?(Sc=La.HasCommentsInSheetBefore||this.FAh(),La=La.HasCommentsInSheetAfter||
this.GAh(),this.zf.dek(uc,nd,Sc,La)):this.zf.nha(uc,nd);this.Fwa=!1;this.Ade=0<uc.length}Oef(La){for(let Kb=0,uc=this.Ub.ua.count;Kb<uc;++Kb){const Sc=this.Ub.ua.getItem(Kb);if(Nd.d(Sc)===La)return Sc}return null}m8h(La){return(La=this.Oef(La))?La.index:-1}xmd(){let La=-1;if(!this.zf.Tu||""===this.zf.pW)return La;La=this.m8h(this.zf.pW);0>La&&e.ULS.shipAssertTag(537167384,12,!1,"ExcelCommentManager.GetDraftSheetIndex: there should be a known sheet index for a valid sheet ID!");return La}FAh(){const La=
this.xmd();return 0<=La&&La<this.activeSheet.index}GAh(){const La=this.xmd();return 0<=La&&La>this.activeSheet.index}d5h(){const La=this.zf.Tu;return La&&La.Iv?La.fl||La.Iv.commentId||La.Iv.draftId:null}c5h(){const La=this.zf.Tu;return La&&La.Iv?La.fl||La.Iv.commentId||La.id:null}Ih(){}ymg(La){var Kb=null;this.Q5.Lrb?Kb=this.ga.pa.activeCell.clone():this.Q5.jWe&&(Kb=this.cE,e.ULS.shipAssertTag(537167383,12,!!Kb,"ExcelCommentManager.SubmitShowCommentPaneAction: active cell should have a comment to edit!"),
Kb=Kb.id);La?this.Q5.v$(ea.a.v$,null,2,null,Kb):this.Q5.Sda(ea.a.Sda,null,2,null,null)}Lgi(La){if(this.h4d&&La)for(const Kb of this.h4d)if(Kb.CommentId===La)return Kb;return null}ctg(){if(this.commentTaskPane.isVisible||this.pz.o2a){var La=this.cE;La?this.zf.pDa&&La.id===this.zf.pDa.id||this.selectComment(La.id,1):this.zf.pDa&&this.Mck();this.Ub.ig()}}Dpf(){return this.ea.Oc&&!this.Ub.userOperationManager.operationCount&&Nd.i(this.activeSheet)}vei(){const La=this.model.pAb();let Kb=-1;var uc=this.zf.pDa;
if(!uc)return Kb;uc=uc.fl&&0<uc.fl.length?uc.fl:uc.id;let Sc=!1;for(const nd of La)if(!(nd.fl&&0<nd.fl.length)&&(Kb+=1,uc===nd.id)){Sc=!0;break}return Sc?Kb:-1}akd(La=null){const Kb=this.lic(),uc=0===this.mode,Sc=this.ood(),nd=this.vei();0<=nd&&nd<Sc?this.JB.SJj(Kb.length,Sc,nd,uc,this.R4a,La):this.JB.RJj(Kb.length,Sc,uc,this.R4a,La);this.JB.oKj(Kb,this.zf.npd())}cBc(){this.Dpf()&&(this.t_(),this.R1a=0,this.Xba())}CM(){for(let La=0,Kb=this.Ub.ua.count;La<Kb;++La){const uc=this.Ub.ua.getItem(La);if(null===
uc||void 0===uc?0:uc.iL)uc.iL.Version=Fe.GA}}t_(){this.Kfa&&(Ge.a.lw(this.Kfa.yv),this.Kfa=null)}Xba(){this.Ub&&id.a(this.Ub)&&this.Ub.qa&&(id.a(this.Ub).EPa?this.Kfa||(this.correlationId+=1,this.Kfa=Ma(this.Ub.qa.va,3,this.activeSheet.name,this.aAd()&&0<this.R1a&&this.ora?this.ora.Version:this.version,this.R1a,this.d6i,this.e6i,null,this.correlationId)):this.t_())}KHd(){this.pz&&this.pz.luc()}AVa(){this.setFocus(!0,!1);this.Mr.vk(Ea.AFrame.hq)}VQe(La){let Kb=null;La.DocumentTaskObject&&!oa.a.Gh(La.DocumentTaskObject.HistoryRecords)&&
La.DocumentTaskObject.HistoryRecords[0].User&&(Kb=La.DocumentTaskObject.HistoryRecords[0].User.DisplayName);return new Jb.a(La.CommentId,La.ParentCommentId,La.Text,La.DateTime?new Date(La.DateTime):null,La.Author,new Ya.Range(La.AnchorRow+1,La.AnchorColumn+1,La.AnchorRow+1,La.AnchorColumn+1,!1,!1),La.IsTextLocked,La.IsLegacy,La.IsEditRestricted,this,La.IsResolved,La.IsCurrentUser,!!La.DocumentTaskObject,Kb)}kBf(La){const Kb={};Kb.a=this.Ub.xa.UserSessionId;Kb.b=La;Ca.b().Of(33,Kb)}CWd(La,Kb){this.yna()?
(this.dCc(),this.tNe(La)):this.$ag(La,Kb)}hJd(La){this.w$c();this.tNe(La)}tNe(La){this.m4a();this.$ag(La,!1)}$ag(La,Kb){const uc=this.Ub.qa.va.Lc();let Sc;const nd=this.model.pAb();Sc=nd&&nd.length?sa.o((La?nd[nd.length-1]:nd[0]).anchor,this.Ub):sa.o(this.ga.pa.activeCell,this.Ub);this.qMb=La?2:1;this.bxc=Qb.a(this.Ub.userOperationManager,(Jd,ke,ne)=>ta(this.Ub.qa.va,Sc,La,qa.b(Jd,this.i5i),qa.a(ke,this.OLf),ne,new Y(Kb,this.gridView),uc),Jd=>new Ha.a(509,0,Jd,80),null)}$ei(){const La=this.Oef(this.zf.pW);
return La?La.sheetName:null}Gef(){const La=sa.v(this.zf.Tu.anchor,this.Ub);La.SheetName=this.$ei()||La.SheetName;return La}dVj(La){const Kb=this.xmd();if(!La||0===this.qMb||0>Kb)return!1;const uc=2===this.qMb,Sc=this.Ub.ua.getItemByName(La.SheetName);return Sc&&Kb!==this.activeSheet.index?Kb===Sc.index?(La=Fe.Qvb(this.zf.Tu.anchor,sa.E(La)),uc&&0>=La||!uc&&0<=La):uc?Kb<Sc.index&&!(Kb<this.activeSheet.index&&this.activeSheet.index<Sc.index)||Kb>this.activeSheet.index&&this.activeSheet.index>=Sc.index:
Kb>Sc.index&&!(Kb>this.activeSheet.index&&this.activeSheet.index>Sc.index)||Kb<this.activeSheet.index&&this.activeSheet.index<=Sc.index:!1}SFf(La,Kb,uc=!1){let Sc=null;Sc=()=>{this.Ub.ua.xh(Sc);this.iFc(sa.E(La),uc)};this.Ub.activeItemName===La.SheetName?this.iFc(sa.E(La),uc):this.Ub.ua.Vg(Sc);Kb.Eh(La,sa.E(La),null,null,60,"ExcelCommentManager.OnFindNextOrPreviousCommentCrossSheetWebMethodSuccess",void 0,void 0,void 0,void 0,!0)}iFc(La,Kb){let uc=null;uc=(Sc,nd)=>{this.gridView.xSd(uc);if(nd.Xgf){if((Sc=
this.gridView.tc(La))&&Sc.cell.Zk)this.Eig();else{let Jd=null;Jd=ke=>{ke.mf.contains(La)&&(this.gridView.ySd(Jd),this.Eig())};this.gridView.E2c(Jd)}Kb&&this.hasCommentAtActiveCell&&this.bJj(this.cE.id)}else e.ULS.sendTraceTag(537167380,12,15,"Failed to navigate to the next or previous comment")};this.gridView.B2c(uc)}qAf(La){const Kb={};Kb.a=this.Ub.xa.UserSessionId;Kb.b=La;Ca.b().Of(34,Kb)}ush(){let La="Unknown",Kb="Unknown";try{var uc=Id.b(x.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());
La=uc.Ring||"Unknown";Kb=uc.WACDatacenter||"Unknown"}catch(Sc){e.ULS.sendTraceTag(537167379,12,10,`Error fetching session start info from app settings. Threw ${Sc}`)}uc=this.Ub.xa.LokiComplianceEnvironment;return new za("Excel",x.AFrameworkApplication.buildVersion,null,null,this.Ub.xa.UserSessionId,La,Kb,!this.Ub.xa.AriaLoggingIsEnabled,this.Na,null,uc&&""!==uc?uc:x.AFrameworkApplication.fa.Va("SovereignEnvironmentName"))}i9h(La){for(let Kb=La.length-1;0<=Kb;Kb--){const uc=La.charAt(Kb);if(" "!==
uc&&"\n"!==uc&&"\t"!==uc&&"\r"!==uc)return uc}return"\x00"}yNa(La,Kb){Kb?e.ULS.sendTraceTag(537167377,12,50,"VSO3351297: InvalidCommentDataState- "+La+". Id: "+Kb.id+", Type: "+Kb.commentType):e.ULS.sendTraceTag(537167378,12,10,"VSO3351297: InvalidCommentDataState- "+La+". inProgressComment is null")}Plg(){this.Slc&&(this.mode=1)}RFf(La){La=La.toString();if(!La)return e.ULS.sendTraceTag(537167364,12,10,"NavigateToCommentById: contentId is null"),8;let Kb=Object(xa.a)(ra.a,this.zf.Ou(La));if(!Kb)return e.ULS.sendTraceTag(537167363,
12,15,"NavigateToFloatingCommentThread: comment does not exist"),8;Kb.fl&&(Kb=Object(xa.a)(ra.a,this.zf.Ou(Kb.fl)));this.selectComment(La,1);this.pz.oFc(Kb,!0);return 32}Jef(La){const Kb=this.Ub.ua.items;for(let uc=0;uc<Kb.length;++uc)if(Kb[uc]&&d.a.Gca(Kb[uc].sheetId).equals(La))return Kb[uc];return null}K$h(La){return(La=this.iid(La,0))?parseInt(La,10):Number.NaN}H9e(La){return(La=this.iid(La,1))?d.a.Gca(La):d.a.nil}Kef(La){return(La=this.iid(La,2))?d.a.Gca(La):d.a.nil}iid(La,Kb){if(!La)return null;
La=La.split("_");return La.length<Kb+1?null:La[Kb]}aAd(){return Da.EwaSettings.isChangeGateEnabled("OfficeVSO:7833004_ThreadedCommentPagination")}set Fqa(La){super.Fqa=La}static Qvb(La,Kb){return La.top!==Kb.top?La.top-Kb.top:La.left-Kb.left}static vag(La,Kb){jc.TaskExtensions.za(Bb.GetServiceTaskFactory.Za(Kb.da,211,212,0),uc=>{uc=uc.result;uc.setEnabled(!0);uc.readText(U.a.instance.ha(La))},Kb.ka,3)}static FCe(La,Kb){if(!(La&&La.length&&Kb&&Kb.length))return!1;for(const uc of Kb)if({fsi:Kb}=va.hod(uc.topLeft,
!0,La),!(0>Kb))for(Kb=0<Kb?Kb-1:Kb;Kb<La.length;Kb++){const Sc=La[Kb].anchor;if(0<Fe.Qvb(Sc,uc.bottomRight))break;if(uc.Yd(Sc))return!0}return!1}static la(La,Kb,uc,Sc,nd,Jd){Kb=Fe.createInstance(La,Kb,uc,Sc,nd,Jd);f.a.instance=Kb;return La.da.Ja(65,Kb)}static createInstance(La,Kb,uc,Sc,nd,Jd){const ke=Sc.Wc;return new Fe(ke,ke,x.AFrameworkApplication.dc,La,Kb,uc,Sc,nd,la.FocusManager.instance(),Jd)}}Fe.GA=-1;Fe.dJd="OnCommentDraftStarted";Object(c.a)(Fe,"ExcelCommentManager",f.a,[871,2])},804:function(r,
C,a){a.d(C,"a",function(){return d});r=a(0);var c=a(102),b=a(274),e=a(173),f=a(900);class d extends f.Comment{constructor(h,l,k,u,v,x,w,m,t,z=!1){super(h,f.Comment.khf,l,w,m,z,w?[k]:d.Wld(k),-1);this.W5j=null;this.anchor=u;this.hMe=v;this.Sf=x;this.yJg=t}get mmc(){return 1===(this.hMe&1)}get Cvf(){return 2===(this.hMe&2)}get G$a(){return this.yJg}get isResolved(){return this.done}focus(){this.mmc||this.qLb()}qLb(){this.mmc||c.FocusManager.instance().vk(b.AFrame.hq)}Glc(h,l){this.lZ=h;this.Pia=0;this.iYb=
l}static S$b(h,l,k,u){h=new d(e.a.create().toString(),h,null,l,0,k,null,null,!0);h.Glc(1,u);return h}static Wld(h){return h?h.split("<br/>")||[h]:[]}}Object(r.a)(d,"ExcelComment",f.Comment,[801])},829:function(r,C,a){a.d(C,"a",function(){return f});r=a(0);var c=a(173),b=a(6);C=a(804);var e=a(150);class f extends C.a{constructor(d,h,l,k,u,v){super(d,h,l,k,u,v,null,null,!0);this.$=v.$}static xt(d){return d.isEditMode&&(new e.a(d.ua)).He(1)}static Wph(d,h){return new f(c.a.create().toString(),b.AFrameworkApplication.userName,
String.format("{0}:\n",b.AFrameworkApplication.userName),d,0,h)}}Object(r.a)(f,"Note",C.a,[800,801])},900:function(r,C,a){a.r(C);r=a(0);var c=a(1385),b=a(88),e=a(1035),f=a(734),d=a(828),h=a(274),l=a(6),k=a(131),u=a(166),v=a(565),x=a(232),w=a(14),m=a(102),t=a(90),z=a(113),y=a(112),D=a(93),H=a(60),F=a(41),G=a(31),L=a(27);class M{constructor(E){this.Nsc=4;this.Qoe=0;this.eee=this.ice=this.Bpe=this.Hee=this.tqe=this.L4=this.L0a=this.vn=this.NZa=this.fse=this.hge=this.ige=this.MZ=this.Kia=this.QPc=this.xaa=
this.saa=this.Nb=this.Dsa=this.S3=null;G.a.gX&&(this.Nsc=6);this.vm=E;this.Ysa=z.KeyInputManager.Fm(t.a.Tra,0);this.render()}get zk(){return this.Nb}get Wvh(){return this.saa}get TGj(){return this.MZ}dispose(){var E=l.AFrameworkApplication.sa.Xz;const I=l.AFrameworkApplication.sa.jv;E.Aa(w.a.click,this.Nb,Object(b.a)(this,this.rKf,"onContainerClick"));E.Aa(w.a.nl,this.Nb,Object(b.a)(this,this.sKf,"onContainerDoubleClick"));I.Aa(w.a.De,this.Nb,Object(b.a)(this,this.tKf,"onContainerKeyPress"));this.saa&&
(E.Aa(w.a.click,this.saa,Object(b.a)(this,this.bdb,"onDeleteButtonClick")),I.By(this.saa,this.eee));this.xaa&&(E.Aa(w.a.click,this.xaa,Object(b.a)(this,this.sJd,"onDoneButtonClick")),I.By(this.xaa,this.Hee));this.MZ&&(E.Aa(w.a.click,this.MZ,Object(b.a)(this,this.Nvc,"onSaveButtonClick")),I.By(this.MZ,this.tqe));this.S3&&(E.Aa(w.a.click,this.S3,Object(b.a)(this,this.Roa,"onCancelButtonClick")),I.By(this.S3,this.ice));this.Kia&&(E.Aa(w.a.click,this.Kia,Object(b.a)(this,this.JKd,"onReplyButtonClick")),
I.By(this.Kia,this.Bpe));this.vn&&(I.Aa(w.a.sq,this.vn,Object(b.a)(this,this.KX,"onKeyEvent")),I.Aa(w.a.De,this.vn,Object(b.a)(this,this.KX,"onKeyEvent")),G.a.Fh&&(E=l.AFrameworkApplication.sa.cjb,E.Aa(w.a.Tvb,this.vn,Object(b.a)(this,this.U8,"onCompositionEvent")),E.Aa(w.a.Svb,this.vn,Object(b.a)(this,this.U8,"onCompositionEvent")),E.Aa(w.a.Uvb,this.vn,Object(b.a)(this,this.U8,"onCompositionEvent"))),v.a.instance.Aa(w.a.paste,this.vn,Object(b.a)(this,this.onPaste,"onPaste")));this.NZa=this.L4=this.L0a=
this.vn=this.S3=this.MZ=this.QPc=this.xaa=this.Kia=this.saa=this.Nb=null}focus(){m.FocusManager.instance().vk(h.AFrame.hq);this.Nb.focus();this.vm.Pg.JL().ag.Km(this.Nb)}G5e(){m.FocusManager.instance().vk(e.a.Kvb);this.vn.focus();this.vm.Pg.JL().ag.Km(this.vn);2===this.vm.commentType&&this.vn.value&&0<this.vn.value.length&&F.a.Ygb(this.vn);const E=this.vm.Pg.fi.Rt,I=F.a.cdi(E,this.Nb);I.y+this.Nb.clientHeight>E.scrollTop+E.clientHeight&&(E.scrollTop=I.y+this.Nb.clientHeight-E.clientHeight)}WTh(){Sys.UI.DomElement.removeCssClass(this.Nb,
"NewOrEditComment");this.S3.style.display="none";this.vn.style.display="none";m.FocusManager.L5d(this.vn);m.FocusManager.L5d(this.MZ);m.FocusManager.instance().rj(e.a.Kvb).ul(this.Ysa);m.FocusManager.instance().kUa(e.a.Kvb);z.KeyInputManager.instance.Aa(w.a.sq,this.vn,Object(b.a)(this,this.KX,"onKeyEvent"));z.KeyInputManager.instance.Aa(w.a.De,this.vn,Object(b.a)(this,this.KX,"onKeyEvent"));if(G.a.Fh){const E=l.AFrameworkApplication.sa.cjb;E.Aa(w.a.Tvb,this.vn,Object(b.a)(this,this.U8,"onCompositionEvent"));
E.Aa(w.a.Svb,this.vn,Object(b.a)(this,this.U8,"onCompositionEvent"));E.Aa(w.a.Uvb,this.vn,Object(b.a)(this,this.U8,"onCompositionEvent"))}v.a.instance.Aa(w.a.paste,this.vn,Object(b.a)(this,this.onPaste,"onPaste"));this.Dsa.removeChild(this.vn);this.Dsa.removeChild(this.L0a);this.L4=this.L0a=this.vn=null;this.v7d();this.Lra();this.focus()}Lra(){this.nga(this.fse,this.ige,this.hge,this.xaa,this.QPc,this.Nb)}render(){var E=f.a("a",this.$S("cc"),"CommentContainer");D.a.ni(E,D.a.yI,e.a.$9c);E.tabIndex=
0;this.vm.fl&&(E.className+=" Reply1");var I=f.a("div",this.$S("ch"),"CommentHeaderRow");const S=f.a("span",this.$S("ca"),"CommentAuthor UIFontBold");S.innerText=this.vm.author;I.appendChild(S);const J=f.a("span",this.$S("ct"),"CommentDate");J.innerText=M.tuh(this.vm.date,this.vm.Pg.quh,this.vm.Pg.G6j);Sys.UI.DomElement.addCssClass(J,l.AFrameworkApplication.isRtl?"FloatLeft":"FloatRight");I.appendChild(J);const K=f.a("span",this.$S("ci"),"CommentStatusIcon");I.appendChild(K);let R=null;this.vm.MPa&&
(R=d.a.Vb(this.$S("cl"),e.a.bMe,CommonUIStrings.l_CommentCancelButton,"ClosePaneGlyph_16x16x32",!1),Sys.UI.DomElement.addCssClass(R,l.AFrameworkApplication.isRtl?"FloatLeft":"FloatRight"),R.tabIndex=0,I.appendChild(R));this.Dsa=f.a("div",this.$S("cn"),"CommentContent");let Z=null,P=null,V=null;this.vm.MPa?(Z=f.a("textarea",this.$S("ce"),e.a.b$c+" UIFont"),Z.rows=this.Nsc,Z.cols=50,Z.tabIndex=0,D.a.ni(Z,"title",CommonUIStrings.l_CommentContent),this.Dsa.appendChild(Z),P=f.a("div","","CommentTextMeasurementContainer"),
V=f.a("textarea","",e.a.b$c+" UIFont"),V.rows=1,V.cols=50,V.style.visibility="hidden",V.spellcheck=!1,P.appendChild(V),this.Dsa.appendChild(P),2===this.vm.commentType&&(Z.value=this.vm.text.join("\n")+"\n")):this.v7d();const Ea=f.a("div","","CommentFooterRow"),oa=f.a("span",this.$S("cf"),""),ea=d.a.Vb(this.$S("cr"),e.a.iMe+" CommentFooterButton",CommonUIStrings.l_CommentReplyButton,"CommentReply_16x16x32",!1);ea.tabIndex=0;ea.setAttribute(D.a.te,D.a.Au);oa.appendChild(ea);const aa=d.a.Vb(this.$S("cd"),
"CommentDoneButton CommentFooterButton",CommonUIStrings.l_CommentDoneButton,"CheckboxUnchecked_16x16x32",!1);aa.tabIndex=0;const ia=aa.childNodes[0].childNodes[0];oa.appendChild(aa);const ya=d.a.Vb(this.$S("cx"),e.a.cMe+" CommentFooterButton",CommonUIStrings.l_CommentDeleteButton,"Delete_16x16x32",!1);aa.tabIndex=0;oa.appendChild(ya);Ea.appendChild(oa);const za=f.a("span",this.$S("cfa"),""),la=d.a.Vb(this.$S("cs"),e.a.jMe,CommonUIStrings.l_CommentSaveCommentButton,null);d.a.rhb(la,!1);la.tabIndex=
0;za.appendChild(la);Ea.appendChild(za);this.nga(K,oa,za,aa,ia,E);this.vm.Pg.oad||(S.setAttribute("Unselectable","on"),J.setAttribute("Unselectable","on"));E.appendChild(I);E.appendChild(this.Dsa);E.appendChild(Ea);this.Nb=E;this.xaa=aa;this.QPc=ia;this.saa=ya;this.Kia=ea;this.MZ=la;this.vn=Z;this.L0a=P;this.L4=V;this.S3=R;this.ige=oa;this.hge=za;this.fse=K;this.NZa=I;E=l.AFrameworkApplication.sa.Xz;I=l.AFrameworkApplication.sa.jv;E.ta(w.a.click,this.Nb,Object(b.a)(this,this.rKf,"onContainerClick"));
E.ta(w.a.nl,this.Nb,Object(b.a)(this,this.sKf,"onContainerDoubleClick"));I.ta(w.a.De,this.Nb,Object(b.a)(this,this.tKf,"onContainerKeyPress"));this.xaa&&(E.ta(w.a.click,this.xaa,Object(b.a)(this,this.sJd,"onDoneButtonClick")),this.Hee=I.ev(this.xaa,Object(b.a)(this,this.sJd,"onDoneButtonClick"),t.a.Li));this.Kia&&(E.ta(w.a.click,this.Kia,Object(b.a)(this,this.JKd,"onReplyButtonClick")),this.Bpe=I.ev(this.Kia,Object(b.a)(this,this.JKd,"onReplyButtonClick"),t.a.Li));this.MZ&&(E.ta(w.a.click,this.MZ,
Object(b.a)(this,this.Nvc,"onSaveButtonClick")),this.tqe=I.ev(this.MZ,Object(b.a)(this,this.Nvc,"onSaveButtonClick"),t.a.Li));this.saa&&(E.ta(w.a.click,this.saa,Object(b.a)(this,this.bdb,"onDeleteButtonClick")),this.eee=I.ev(this.saa,Object(b.a)(this,this.bdb,"onDeleteButtonClick"),t.a.Li));this.S3&&(E.ta(w.a.click,this.S3,Object(b.a)(this,this.Roa,"onCancelButtonClick")),this.ice=I.ev(this.S3,Object(b.a)(this,this.Roa,"onCancelButtonClick"),t.a.Li));Z&&(I.ta(w.a.sq,Z,Object(b.a)(this,this.KX,"onKeyEvent")),
I.ta(w.a.De,Z,Object(b.a)(this,this.KX,"onKeyEvent")),G.a.Fh&&(E=l.AFrameworkApplication.sa.cjb,E.ta(w.a.Tvb,Z,Object(b.a)(this,this.U8,"onCompositionEvent"),null),E.ta(w.a.Svb,Z,Object(b.a)(this,this.U8,"onCompositionEvent"),null),E.ta(w.a.Uvb,Z,Object(b.a)(this,this.U8,"onCompositionEvent"),null)),v.a.instance.ta(w.a.paste,Z,Object(b.a)(this,this.onPaste,"onPaste")),this.ySj())}Teg(E){d.a.rhb(this.MZ,E)}$S(E){return E+"_"+this.vm.id}nga(E,I,S,J,K,R){switch(this.vm.Ugb){case 0:case 1:this.Ajg(E,
0);break;case 2:case 4:E.style.display="none";break;case 3:Sys.UI.DomElement.addCssClass(R,"SaveFailure"),Sys.UI.DomElement.addCssClass(R,"NoReply"),this.Ajg(E,1)}this.vm.done?(Sys.UI.DomElement.addCssClass(R,"CommentIsDone"),K.className=u.getImageClass("CheckboxChecked_16x16x32")):(Sys.UI.DomElement.removeCssClass(R,"CommentIsDone"),K.className=u.getImageClass("CheckboxUnchecked_16x16x32"));this.vm.MPa?(Sys.UI.DomElement.addCssClass(R,"NewOrEditComment"),Sys.UI.DomElement.addCssClass(R,"SelectedComment"),
E.style.display="none",I.style.display="none",S.style.display="inline",0===this.vm.Pg.mode&&(this.Teg(!1),d.a.rhb(this.S3,!1))):(1===this.vm.tDa?(Sys.UI.DomElement.addCssClass(R,"SelectedComment"),Sys.UI.DomElement.removeCssClass(R,"SelectedParentComment"),I.style.display=1!==this.vm.Pg.mode||3===this.vm.Ugb||this.vm.ki?"none":"inline"):(2===this.vm.tDa?(Sys.UI.DomElement.removeCssClass(R,"SelectedComment"),Sys.UI.DomElement.addCssClass(R,"SelectedParentComment")):(Sys.UI.DomElement.removeCssClass(R,
"SelectedComment"),Sys.UI.DomElement.removeCssClass(R,"SelectedParentComment")),I.style.display="inline"),S.style.display="none")}Ajg(E,I){H.a.ovb(E);switch(I){case 0:I=document.createElement("img");I.alt=CommonUIStrings.l_CommentProgressTooltip;I.src=k.a.Xva("progress16.gif");E.appendChild(I);break;case 1:I=u.createClusteredImage(16,16,"Risks_16x16x32","",!0,CommonUIStrings.l_CommentFailTooltip),E.appendChild(I)}E.style.display="inline-block"}v7d(){H.a.pvb(this.Dsa);var E=this.vm.text;1===E.length&&
E[0]&&(E=E[0].split("\n"));for(const I of E)E=f.a("p","","CommentContentPara"),E.innerText=I||"\u00a0",this.vm.Pg.oad||E.setAttribute("Unselectable","on"),this.Dsa.appendChild(E)}ySj(){const E=m.FocusManager.instance().rj(e.a.Kvb);E.parent=h.AFrame.hq;x.a.instance.Urb(e.a.Kvb,this.vn);E.bindAction(z.KeyInputManager.Fm(t.a.bae,2),L.a.doNothing);E.bindAction(this.Ysa,L.a.W9c);E.bindAction(z.KeyInputManager.Fm(t.a.Ura,0),L.a.ela);E.bindAction(z.KeyInputManager.Fm(t.a.W$,0),L.a.ela);E.ul(m.FocusManager.instance().H4);
E.ul(m.FocusManager.instance().I4)}rKf(E){if(this.vm.MPa&&E.Da.target===this.vn)return!0;this.vm.qLb();return!0}sKf(){this.vm.uJd();return!0}tKf(E){let I=!1;E.Da.keyCode===t.a.Li&&(0===this.vm.tDa?this.vm.qLb():this.vm.uJd(),I=!0);return I}bdb(){if(this.saa.disabled)return!0;this.vm.quc();return!0}sJd(){if(this.xaa.disabled)return!0;this.vm.Ddj();return!0}JKd(){if(this.Kia.disabled)return!0;this.vm.Jaj();return!0}Nvc(){if(this.MZ.disabled)return!0;this.vm.kbj(this.vn.value);return!0}Roa(){if(this.S3.disabled)return!0;
this.vm.kfa();return!0}KX(E){if(E.Da.ctrlKey&&E.Da.keyCode===t.a.Li)return 0<this.vn.value.length&&this.Nvc(null),!0;if(E.Da.keyCode===t.a.Tra)return!0;this.onTextEntered(E.eventName===w.a.sq&&E.Da.charCode===t.a.Li);return!1}U8(){this.onTextEntered(!1);return!1}onPaste(){const E=new y.a(0,1,0,()=>{this.onTextEntered(!1)},1);l.AFrameworkApplication.Xi.wg(E);return!1}onTextEntered(E){if(0!==this.vm.Pg.mode&&(this.Teg(0<this.vn.value.length),!G.a.gX)){this.L0a.clientWidth!==this.vn.clientWidth&&(this.L0a.style.width=
this.vn.clientWidth+"px");this.L4.value=this.vn.value+"___";this.Qoe>this.vn.value.length&&(this.L4.rows=1);for(var I=0,S=Number.MAX_VALUE;1<=(I=this.L4.scrollHeight-this.L4.clientHeight)&&I<S;)S=I,this.L4.rows++;this.L4.rows<this.Nsc?this.vn.rows=this.Nsc:(E&&this.L4.rows++,this.vn.rows=this.L4.rows);this.Qoe=this.vn.value.length}}static tuh(E,I,S){if(!E||isNaN(E.getDate()))return"";let J=S;const K=new Date;if(K.getFullYear()!==E.getFullYear()||K.getMonth()!==E.getMonth()||K.getDate()!==E.getDate())J=
String.format(CommonUIStrings.l_CommentLongDateFormat,I,S);return E.localeFormat(J)}}Object(r.a)(M,"CommentViewObject",null,[2,836]);var O=a(173);a.d(C,"Comment",function(){return B});class B{constructor(E,I,S,J,K,R,Z,P,V,Ea,oa,ea=null){this.t1b=0;this.Pia=2;this.lZ=0;this.objectId=this.iYb=this.Bx=null;this.ki=!1;this._id=E;this.obe=S;this.QXb=J;this.Y0b=K;this.Imb=R;this.Aia=Z;this.Cge=P;this.usersByReactionType=ea;this.Sf=c.a.instance}get id(){return this._id}set id(E){this._id=E}get author(){return this.yuf?
CommonUIStrings.l_RemovedAuthorName:this.obe}get date(){return this.yuf?null:this.QXb}set date(E){this.QXb=E}get done(){return this.Imb}set done(E){this.Imb!==E&&(this.Imb=E,this.Bx&&this.Bx.Lra())}get J8a(){return this.Cge}set J8a(E){this.Cge=E}get fl(){return this.Y0b}set fl(E){this.Y0b=E}get text(){return this.Aia}set text(E){this.Aia=E;this.Bx&&this.Bx.v7d()}get tDa(){return this.t1b}set tDa(E){this.t1b!==E&&(this.t1b=E,this.Bx&&this.Bx.Lra())}get Ugb(){return this.Pia}set Ugb(E){this.Pia===E||
0===this.Pia&&2===E||3===this.Pia||(this.Pia=E,this.Bx&&this.Bx.Lra())}get commentType(){return this.lZ}set commentType(E){if(this.lZ!==E){const I=this.MPa&&0===E;this.lZ=E;I&&this.Bx&&this.Bx.WTh()}}get MPa(){return 1===this.lZ||2===this.lZ}get yuf(){return!!this.Sf&&this.Sf.exj}get zk(){return this.Bx?this.Bx.zk:null}get Pg(){return this.Sf}get mMe(){return this.Bx}get Iv(){return this.iYb}set Iv(E){this.iYb=E}dispose(){this.Bx&&(this.Bx.dispose(),this.Bx=null)}render(){this.Bx=new M(this);return this.Bx.zk}ncb(){this.Bx&&
this.Bx.Lra()}focus(){this.qLb();this.Bx.focus();this.MPa&&this.Bx.G5e()}toString(){let E="[null]";this.Aia&&0<this.Aia.length&&(E=30<this.Aia[0].length?this.Aia[0].substr(0,30)+"...":this.Aia[0]);return String.format('I:{0} A:{1} T:{2} R:{3} D:{4} "{5}"',this._id||"[null]",this.obe||"[null]",this.QXb?this.QXb.toString():"[null]",this.Y0b||"[null]",this.Imb,E)}qLb(){2===this.Pg.mode||3===this.Pg.mode?this.MPa&&this.Bx.G5e():(m.FocusManager.instance().vk(h.AFrame.hq),1!==this.t1b&&this.Pg.selectComment(this._id))}uJd(){this.Pg.Qmg&&
0===this.lZ&&(m.FocusManager.instance().vk(h.AFrame.hq),this.lZ=2,this.Pia=0,this.Pg.editComment(this,null))}z4i(){3===this.Pg.mode&&(m.FocusManager.instance().vk(h.AFrame.hq),this.lZ=0,this.Pia=2,this.Pg.tbh(this))}quc(){m.FocusManager.instance().vk(h.AFrame.hq);this.Pg.deleteComment(this)}Ddj(){this.Pg.x8b(this,!this.Imb)}Jaj(){2!==this.Pg.mode&&(m.FocusManager.instance().vk(h.AFrame.hq),this.Pg.addReply(this.Y0b||this._id,null))}kbj(E){m.FocusManager.instance().vk(h.AFrame.hq);this.Aia=Array(1);
this.Aia[0]=E;1===this.lZ?this.Pg.WKa(this):this.Pg.VKa(this)}kfa(){m.FocusManager.instance().vk(h.AFrame.hq);this.Pg.fi.Rt&&this.Pg.fi.Rt.focus();1===this.lZ?(this.Pg.deleteComment(this),this.Pg.Uag(this.fl)):this.z4i()}static S$b(E,I,S,J){const K=O.a.create().toString();E=new B(K,B.khf,E,new Date,I,!1,[],S,!1,l.AFrameworkApplication.fa.Va("PresenceUserId"),l.AFrameworkApplication.fa.Va("PresenceProvider"));E.lZ=1;E.Pia=0;E.iYb=J;return E}}B.khf=null;B.ygj=-1;Object(r.a)(B,"Comment",null,[2,802])},
921:function(r,C,a){a.d(C,"a",function(){return b});r=a(0);var c=a(173);a=a(804);class b extends a.a{constructor(e,f,d,h,l,k,u,v,x,w,m,t,z=!1,y=null){super(e,l.DisplayName,d,k,u?2:0,w,h,f,v,m);this.Dsf=!1;this.tze=null;this.WBf=l;this.YSi=x;this.iTi=t;this.jTi=z;this.wTi=y}get commentBody(){return this.text&&0<this.text.length?this.text[0]:""}set commentBody(e){this.text[0]=e}get authorIdentity(){return this.WBf.UserId}get WDe(){return this.WBf.Provider}get G0g(){return this.anchor?this.anchor.toString():
""}get BBi(){return this.YSi}get isCurrentUser(){return this.iTi}get cJi(){return this.jTi}get w5j(){return this.wTi}static xsh(e,f,d,h){e=new b(c.a.create().toString(),null,null,null,e,f,!1,!1,!1,d,!1,!0);e.Glc(1,h);return e}static ysh(e,f,d,h,l){e=new b(c.a.create().toString(),h,null,null,e,f,!1,!1,!1,d,!1,!0);e.Glc(1,l);return e}}Object(r.a)(b,"ExcelThreadedComment",a.a,[286])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSOpt.commentpane.js.map/95c95f72df5b4ad7b9cd603cfbcbd82d/EwaDSOpt.commentpane.js.map