'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[20],{1187:function(r,C,a){a.d(C,"a",function(){return b});var c=a(522);const b=()=>{c.a.sj(".ewa-fb{height:20px;background-color:#fff;color:#444;overflow:hidden;padding:10px 8px;position:relative;margin:auto}.grid-visual-refresh .ewa-fb{height:32px;overflow:hidden;padding:0;background-color:#f5f5f5}.ewa-fb-placeholder{color:#bbb}.ewa-root-ltr .ewa-fb{padding-right:4px}.ewa-root-rtl .ewa-fb{padding-left:4px}.ewa-fb-text-box,.ewa-fb-presence-cover{display:inline-block;margin:0 0 0 1px;padding:0;height:18px;width:100%;z-index:101}.ewa-fb-presence-cover{opacity:.2;position:absolute;margin:1px 10px 0 10px}.ewa-fb-text-box,.ewa-fb-text-box-monospace-experiment{overflow:hidden;border:1px solid #e6e7e8;outline:none;resize:none;position:relative;flex-grow:1;white-space:pre}.ewa-fb-text-box:focus-within{outline:1px auto}.grid-visual-refresh .ewa-fb-text-box{background-color:#fff;height:18px;line-height:22px;margin:0 0 0 0;top:4px;width:auto;position:relative;padding:2px}.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new{background-color:#fff;height:18px;line-height:18px;margin:0;top:4px;width:auto;position:relative;padding:2px}.ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{height:18px;overflow:hidden;margin-top:1px}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{height:100%;width:calc(100% - 4px);scrollbar-width:thin;scrollbar-color:#b1b0b0 #fff}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-button:start{background-color:#fff;height:18px}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-button:end{background-color:#fff;height:4px}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-thumb{border-radius:10px;background-color:#b1b0b0}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar{width:6px}.ewa-fb-extended .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{overflow-y:auto;overflow-x:hidden}.grid-visual-refresh .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{line-height:inherit;height:inherit}.grid-visual-refresh .ewa-fb-text-box.ie .ewa-rteTextElement>.ewa-rteLine{line-height:inherit}.ewa-fb-text-box.ql-container{pointer-events:none}.ewa-fb-text-box .ewa-rteTextElement{pointer-events:all}.ewa-root-ltr .ewa-fb-text-box,.ewa-root-ltr .ewa-fb-presence-cover{left:33px}.ewa-root-ltr .grid-visual-refresh .ewa-fb-text-box{right:4px;left:38px}.ewa-root-rtl .ewa-fb-text-box .ewa-root-rtl .ewa-fb-presence-cover{right:33px}.ewa-root-rtl .grid-visual-refresh .ewa-fb-text-box{right:38px;left:4px}.ewa-fb .functionbox{position:relative;top:10px;width:29px;height:18px;background-color:#fff;border:1px solid #e6e7e8;z-index:101}.green-fill-paths:hover path{fill:#217346}.grid-visual-refresh .ewa-fb .functionbox{position:relative;top:4px;height:22px;background-color:#fff}.ewa-root-ltr .grid-visual-refresh .ewa-fb .functionbox{margin-right:3px}.ewa-root-rtl .grid-visual-refresh .ewa-fb .functionbox{margin-left:3px}.ewa-fb-presence-cover-internal{height:100%}.ewa-root-ltr .ewa-fb-presence-cover-internal{margin-right:50px}.ewa-root-rtl .ewa-fb-presence-cover-internal{margin-left:50px}.ewa-fb .functionbox .clip13x13{margin:2px 8px 1px 8px}.grid-visual-refresh .ewa-fb .functionbox .clip13x13{margin-top:4px;margin-bottom:4px}.ewa-fb .functionbox:hover .ewaboot_formulabar13{margin-top:-13px}.ewa-root-ltr .ewa-fb.drop-down{padding-left:3px}.ewa-root-rtl .ewa-fb.drop-down{padding-right:3px}.ewa-fb .ok-cancel-buttons-container{position:relative;z-index:101;display:none;flex-flow:row}.ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{display:flex;order:1;height:22px;border:1px solid #e6e7e8;top:4px}.ewa-root-rtl .ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{margin-left:3px}.ewa-root-ltr .ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{margin-right:3px}.grid-visual-refresh .ewa-fb .ok-cancel-buttons-container{position:relative}.ewa-fb .okbox{position:relative;top:10px;width:29px;height:18px;background-color:#fff;border:1px solid #e6e7e8;z-index:101;margin:0 2px 0 2px;display:flex;justify-content:center;align-items:center}.grid-visual-refresh .ewa-fb .okbox{position:relative;top:4px;height:22px;background-color:#fff}.ewa-fb .cancelbox{position:relative;top:10px;width:29px;height:18px;background-color:#fff;border:1px solid #e6e7e8;z-index:101;display:flex;justify-content:center;align-items:center}.grid-visual-refresh .ewa-fb .cancelbox{position:relative;top:4px;height:22px;background-color:#fff}.ewa-fb-nb{display:flex;flex-flow:row}.grid-visual-refresh .ewa-fb-nb{background-color:#f5f5f5;height:32px}.ewa-fb-nb .ewa-fb.drop-down{flex:1 1 auto}.grid-visual-refresh .ewa-fb-nb .ewa-fb.drop-down{right:0;height:32px;display:flex;flex-flow:row}.ewa-fb-name-box-placeholder{position:relative;width:118px;float:left;display:block;overflow:hidden;height:20px;background-color:#fff;padding:2px;align-self:center;margin:0 0 0 4px}.ewa-root-rtl .ewa-fb-name-box-placeholder{float:right;margin:0 4px 0 0}.button-disabled{pointer-events:none;background-color:#f0f0f0 !important}.ewa-fb-extended .ewa-fb-expand-button-img{transform:rotate(180deg)}.ewa-fb-expand-button-container{padding-top:3px;position:absolute;z-index:102}.ewa-root-ltr .ewa-fb-expand-button-container{padding-right:7px;right:0}.ewa-root-rtl .ewa-fb-expand-button-container{padding-left:7px;left:0}.ewa-fb-text-div-container{width:100%;position:relative}.ewa-fb-refactor .ewa-fb-text-div-container{order:2}body.ewa-fb-drag-resize *{cursor:inherit !important}body.ewa-fb-drag-resize{cursor:ns-resize}.ewa-fb-drag-handler{position:absolute;height:6px;width:100%;cursor:ns-resize;z-index:102;bottom:0}.grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new{height:calc(100% - 8px);box-sizing:border-box;width:100%}.grid-visual-refresh .ewa-fb-refactor.ewa-fb-nb .ewa-fb.drop-down{height:inherit}.grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{height:auto;overflow:hidden;white-space:pre-wrap}.ewa-root-ltr .grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{padding-right:20px}.ewa-root-rtl .grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{padding-left:20px}.grid-visual-refresh .ewa-fb-refactor .ewa-fb .functionbox{top:0;order:2;border:none;margin:0}.grid-visual-refresh .ewa-fb-refactor .ewa-fb .okbox{top:0;margin:0;border:none;order:1}.grid-visual-refresh .ewa-fb-refactor .ewa-fb .cancelbox{top:0;border:none;order:0}.ewr-presentMode-on .ewa-fb{color:#f3f2f1}.ewr-presentMode-on.grid-visual-refresh .ewa-fb-text-box,.ewr-presentMode-on.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new{background-color:#3c3c3c;border:1px solid #3c3c3c;border-radius:2px}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb-text-box,.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new{background-color:#292827 !important;border:1px solid #292827 !important}.ewr-presentMode-on.grid-visual-refresh .ewa-fb,.ewr-presentMode-on.grid-visual-refresh .ewa-fb-nb{background-color:#323130}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb,.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb-nb{background-color:#000 !important}.ewr-presentMode-on.grid-visual-refresh .ewa-fb .functionbox{background-color:#323130;border:1px solid #323130}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb .functionbox{background-color:#000 !important;border:1px solid #000 !important}.ewr-presentMode-on .green-fill-paths:hover path{fill:#37a660}.ewr-presentMode-on .ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{border:none}.ewr-presentMode-on.grid-visual-refresh .ewa-fb .okbox,.ewr-presentMode-on .ewa-fb .okbox{background-color:#3c3c3c;border:1px solid #3c3c3c;border-top-right-radius:2px;border-bottom-right-radius:2px}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb .okbox,.ewr-presentMode-on.ewr-namedsheetview .ewa-fb .okbox{background-color:#292827 !important;border:1px solid #292827 !important}.ewr-presentMode-on.grid-visual-refresh .ewa-fb .cancelbox,.ewr-presentMode-on .ewa-fb .cancelbox{background-color:#3c3c3c;border:1px solid #3c3c3c;border-top-left-radius:2px;border-bottom-left-radius:2px}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb .cancelbox,.ewr-presentMode-on.ewr-namedsheetview .ewa-fb .cancelbox{background-color:#292827 !important;border:1px solid #292827 !important}.ewr-presentMode-on .ewa-fb-expand-button-img{fill:#e1dfdd}.ewr-presentMode-on .ql-editor *::selection{background-color:#605e5c}.ewr-presentMode-on .functionbox.button-disabled{background-color:#323130 !important}.ewr-presentMode-on .ewa-fb-function-button-img{fill:#e1dfdd}.ewr-presentMode-on .functionbox.button-disabled .ewa-fb-function-button-img{fill:#8a8886 !important}.ewr-presentMode-transition.grid-visual-refresh .ewa-fb-text-box,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb .functionbox,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb .okbox,.ewr-presentMode-transition .ewa-fb .okbox,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb .cancelbox,.ewr-presentMode-transition .ewa-fb .cancelbox{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-fb,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb-nb,.ewr-presentMode-transition .functionbox.button-disabled{transition:background-color .4s linear,color .4s linear}.ewa-fb-nb-fix{flex:0 0 auto !important}.ewa-fb-nb .cui-cb{flex:0 1 auto;align-self:center;z-index:101}.ewa-fb-refactor.ewa-fb-nb .cui-cb{align-self:baseline;top:4px}@media screen and (-ms-high-contrast:active){.ewa-fb-nb .cui-cb:hover .cui-dd-arrow-button path,.ewa-fb-nb .cui-fa-dropped .cui-dd-arrow-button .ewa-svg-icon path,.ewa-fb-nb .cui-cb-focus .cui-dd-arrow-button .ewa-svg-icon path{fill:HighlightText}.ewa-fb-nb .cui-cb .cui-cb-input{border-color:WindowText;background-color:Window !important}.ewa-fb-nb .cui-fa-dropped .cui-dd-arrow-button{background-color:Highlight}.ewa-fb-nb .cui-dd-arrow-button .ewa-svg-icon path{fill:ButtonText}}.ewa-root-ltr .grid-visual-refresh .ewa-fb-nb .cui-cb{position:relative;margin:0 0 0 4px}.ewa-root-rtl .grid-visual-refresh .ewa-fb-nb .cui-cb{position:relative;margin:0 4px 0 0}.ewa-fb-nb .cui-cb-input{height:14px;font-size:14.7px;font-family:Calibri}.grid-visual-refresh .ewa-fb-nb .cui-cb-input{height:18px}.ewa-fb-nb .cui-dd-arrow-button{height:18px;background-color:#fff}.grid-visual-refresh .ewa-fb-nb .cui-dd-arrow-button{height:18px;padding-top:2px;padding-bottom:2px}.ewr-presentMode-on .ewa-fb-nb .cui-cb-input{background-color:#3c3c3c;color:#f3f2f1;border:1px solid #3c3c3c;border-top-left-radius:2px;border-bottom-left-radius:2px}.ewr-presentMode-on .ewa-fb-nb .cui-disabled .cui-cb-input{background-color:#3c3c3c !important;border:1px solid #3c3c3c !important}.ewr-presentMode-on .ewa-fb-nb .cui-cb:hover .cui-cb-input{border-color:#37a660 !important}.ewr-presentMode-on.ewr-namedsheetview .ewa-fb-nb .cui-cb-input{background-color:#292827;border:1px solid #292827}.ewr-presentMode-on .ewa-fb-nb .cui-dd-arrow-button{background-color:#3c3c3c;border-top:1px solid #3c3c3c;border-right:1px solid #3c3c3c;border-bottom:1px solid #3c3c3c;border-top-right-radius:2px;border-bottom-right-radius:2px}.ewr-presentMode-on .ewa-fb-nb .cui-disabled .cui-dd-arrow-button{background-color:#3c3c3c !important;border-top:1px solid #3c3c3c !important;border-right:1px solid #3c3c3c !important;border-bottom:1px solid #3c3c3c !important}.ewr-presentMode-on .ewa-fb-nb .cui-cb:hover .cui-dd-arrow-button{border-color:#37a660 !important}.ewr-presentMode-on .ewa-fb-nb-dropdown-button-img{fill:#e1dfdd}.ewr-presentMode-on .ewa-fb-nb .cui-disabled .cui-dd-arrow-button .ewa-fb-nb-dropdown-button-img{fill:#8a8886 !important}.ewr-presentMode-on.ewr-namedsheetview .ewa-fb-nb .cui-dd-arrow-button{background-color:#292827;border-top:1px solid #292827;border-right:1px solid #292827;border-bottom:1px solid #292827}#presentModeNamedObjectsMenu{z-index:1056 !important;background-color:#3c3c3c !important;border:1px solid #323130 !important}#presentModeNamedObjectsMenu .cui-ctl-mediumlabel{color:#e1dfdd !important}#presentModeNamedObjectsMenu .cui-ctl-menu:hover .cui-ctl-mediumlabel,#presentModeNamedObjectsMenu .cui-ctl-menu:focus .cui-ctl-mediumlabel{color:#f3f2f1 !important}#presentModeNamedObjectsMenu .cui-ctl-menu:hover,#presentModeNamedObjectsMenu .cui-ctl-menu:focus{background-color:#484644 !important;border-color:#484644 !important}.ewr-presentMode-transition .ewa-fb-nb .cui-cb-input,.ewr-presentMode-transition .ewa-fb-nb .cui-disabled .cui-cb-input,.ewr-presentMode-transition .ewa-fb-nb .cui-dd-arrow-button,.ewr-presentMode-transition .ewa-fb-nb .cui-disabled .cui-dd-arrow-button{transition:background-color .4s linear,color .4s linear}")}},
1188:function(r,C,a){a.d(C,"d",function(){return l});a.d(C,"c",function(){return k});a.d(C,"b",function(){return u});a.d(C,"a",function(){return v});var c=a(23),b=a(901),e=a(1189),f=a(120),d=a(138),h=a(577);const l=w=>255<w.length||!x(w)||c.a.iD(w,"_xl")?!1:!0,k=(w,m)=>{var t=m.ga;m=t.pa.Vh;t=t.pa.activeRange;return w.ua.na&&m?b.b(w.oc,t,w.ua.na.name):null},u=w=>{let m=null;w=w.ga.Sa;w.DS&&(m=w.Pc.floatingObject);return m},v=(w,m=!0)=>{const t=e.a.getInstance(w),z=t.Q$h();z&&!w.oc.Pk(z)&&h.a(d.a.zgh,
[f.a.GFf],!0,!0,!1,!1,null);t.stop(m)},x=w=>{if(!w.length)return!1;for(let m=0;m<w.length;m++){const t=w.charAt(m),z=w.charCodeAt(m);if(!m){if("\\"!==t&&"_"!==t&&!c.a.isLetter(z))return!1}else if("_"!==t&&"."!==t&&!c.a.osf(z)&&!c.a.isNumeral(z))return!1}return!0}},1189:function(r,C,a){a.d(C,"a",function(){return b});r=a(0);var c=a(15);class b{constructor(e){this.start=f=>{this.inProgress?c.ULS.sendTraceTag(528053384,0,50,"NameBoxTelemetry: Received start when an instance of this stopwatch was already ongoing"):
(this.Wi.start(),this.inProgress=!0,this.sGf=f)};this.stop=(f=!0)=>{this.inProgress&&(this.Wi.stop(),f&&c.ULS.sendTraceTag(528053383,0,50,`{"CreateNamedRange_UserPerspective": ${this.Wi.vd}}`),this.inProgress=!1,this.sGf=void 0)};this.Q$h=()=>this.sGf;this.Wi=e.yc.vh("UserAction","CreateNamedObjectTimer");this.inProgress=!1}}b.getInstance=e=>{void 0===b.instance&&(b.instance=new b(e));return b.instance};Object(r.a)(b,"NameBoxTelemetry",null,[])},1234:function(r,C,a){var c=a(10);r=a(0);var b=a(724),
e=a(52),f=a(40),d=a(198),h=a(15),l=a(830),k=a(145),u=a(274),v=a(74),x=a(75),w=a(136),m=a(30),t=a(121),z=a(9),y=a(25),D=a(47),H=a(901),F=a(119),G=a(390),L;(function(X){X[X.NONE=0]="NONE";X[X.FLOATING_OBJECTS=1]="FLOATING_OBJECTS";X[X.PRINT_AREA=2]="PRINT_AREA";X[X.DISCONTINUOUS_RANGES=3]="DISCONTINUOUS_RANGES";X[X.ILLEGAL_SHEET_SCOPE=4]="ILLEGAL_SHEET_SCOPE";X[X.INVALID_NAME=5]="INVALID_NAME";X[X.EMPTY_RANGE=6]="EMPTY_RANGE";X[X.GENERIC_ERROR=7]="GENERIC_ERROR"})(L||(L={}));Object(r.b)("NameBoxInvalidOperation",
L);var M=a(129),O=a(34),B=a(23),E=a(16),I=a(120),S=a(138),J=a(577),K=a(106);class R extends G.a{constructor(X,ca,U=null){super(X,ca);this.QXi=U;this.ooa();this.ft()}get dd(){return"NameBoxErrorDialog"}ft(){super.ft();const X=this.error.Caption,ca=this.E5h(this.error),U=this.D5h(this.error);this.Ac=0;this.Mua(U);this.km(X,ca,2,this.z$)}E5h(X){return B.a.equals(X.MessageIdName,R.hJc,!0)?String.format(X.Description):B.a.equals(X.MessageIdName,R.fEb,!0)?"":X.Description}D5h(X){const ca=[];B.a.equals(X.MessageIdName,
R.fEb,!0)&&(X=String.format(E.a.instance.ha(2253)),ca.push(...M.f(X.split("-"),U=>U.trim())));return ca}ooa(){if(this.error.MessageIdName===R.fEb)h.ULS.sendTraceTag(528053385,0,50,this.error.Caption);else{let X=this.error.Caption;this.error.MessageIdName===R.hJc&&(X=`Unsupported Operation: ${L[this.QXi]}`);const ca=new K.a;ca.ia("errorCaption",X);J.a(S.a.wQh,[I.a.GFf],!0,!0,!1,!1,ca)}}static Wd(X){switch(X){case 3:case 1:case 2:return O.a.Wd(1,0,2254,2255,0,-1280789630,R.hJc);case 5:case 4:return O.a.Wd(1,
0,2252,2253,0,875859818,R.fEb);case 7:return O.a.Wd(1,0,0,1,0,424201999,R.fEb);case 6:return O.a.Wd(1,0,2256,2257,0,-1280789630,R.hJc);default:throw Error.invalidOperation("Error should not be created if there is no valid NameBoxInvalidOperation");}}}R.hJc="NameBoxUnsupportedOperation";R.fEb="NameBoxInvalidName";Object(r.a)(R,"NameBoxErrorDialog",G.a,[]);class Z{constructor(){this.type=this.location=this.name=this.key=null}}Object(r.a)(Z,"NamedObjectOption",null,[]);const P=(X,ca,U,ma)=>{const ra=
new Z;ra.key=X;ra.name=ca;ra.location=U;a:switch(ma){case 2:X="Table";break a;case 3:X=B.a.b6a(ca,"Print_Area")?"Print Area":"Named Range";break a;default:X="Unknown"}ra.type=X;return ra};var V=a(1188),Ea=a(1),oa=a(19),ea=a(137),aa=a(1189);class ia{constructor(X,ca){this.printArea="Print_Area";this.TFj="R";this.Kgh="C";this.PXi="Value";this.$=X;this.gridView=oa.h(this.$);this.lBa=ca;this.RXi=aa.a.getInstance(this.$)}Xjj(){var X=this.$.oc.items,ca=this.$.na.name;const U={};for(var ma of X){X=H.a(ma.name);
var ra=X.Rhb;if(v.h(ma)&&(!ra||B.a.equals(X.scope,ca,!1))){const Va=X.name in U;if(!Va||Va&&ra)U[X.name]={["namedObjectDetails"]:X,["namedObjectItem"]:ma}}}ca=[];for(let Va in U)X=U[Va],ma=X.namedObjectItem,X=X.namedObjectDetails,ra=`${ma.sheetName}!${ma.usedRange.topLeft.vz(!1)}:${ma.usedRange.bottomRight.vz(!1)}`,ca.push(P(ma.name,X.name,ra,ma.type));ca.sort((Va,ob)=>Va.name.localeCompare(ob.name));this.lBa.Yjj(ca);V.a(this.$,!1);this.HTd(ca.length)}fmi(X){X=H.a(X[this.PXi].toString());const ca=
X.name,U=X.scope.length?X.scope:null;var ma=this.Pdh(X);this.lJj(X)||(this.XPi(X),0!==ma?(this.lBa.GUe(this.$,ma),this.V8f()):V.d(ca)?(ma=D.r(oa.h(this.$).ga.pa.selectedRanges,this.$),this.lBa.Iph(this.$,ca,ma,U,ia.I0i,ia.H0i),this.RXi.start(X.name)):(this.lBa.GUe(this.$,5),this.V8f()))}Pjd(){this.lBa.Pjd()}lJj(X){const ca=X.fullName,U=X.name,ma=X.scope;let ra,Va,ob=!1;!({sheetName:ra,range:Va}=D.ab(ca,this.$.ua)).returnValue||!Va.OA&&Ea.EwaSettings.isChangeGateEnabled("OfficeVSO:4653651_CheckIsValidRangeInNamedObjectDropDown")?
B.a.equals(U,this.TFj,!0)?(this.mJj(ma),this.uUa(2)):B.a.equals(U,this.Kgh,!0)?(this.dJj(ma),this.uUa(2)):this.$.oc.Pk(ca)?(this.Xag(ca),this.uUa(X.Rhb?1:0)):this.$.oc.Pk(U)?(this.Xag(U),this.uUa(0)):ob=!0:(this.eJj(ra,Va),this.uUa(3));return!ob}eJj(X,ca){X=X||this.$.ua.na.name;var U=H.b(this.$.oc,ca,X);H.c(U)||(U=D.v(ca,this.$),U.SheetName=X,oa.h(this.$).Eh(U,ca.topLeft,null,null,60,"NameBoxCommandHandler.SelectNamedObjectByRange"),this.gridView.focus())}mJj(X=null){const ca=this.gridView.ga.pa.activeCell;
this.VIe(X)&&(X=new y.Range(ca.top,0,ca.bottom,z.a.Rg,!0,!1),this.gridView.ga.wH([X],0,X,0))}dJj(X=null){const ca=this.gridView.ga.pa.activeCell;this.VIe(X)&&(X=new y.Range(0,ca.left,z.a.Sg,ca.right,!0,!1),this.gridView.ga.wH([X],0,X,0))}VIe(X){return X?(X=this.$.ua.getItemByName(X),(null===X||void 0===X?0:X.visible)?(X.activate(),!0):!1):!0}Xag(X){X=this.$.oc.getItemByName(X);H.c(X);this.gridView.focus()}Pdh(X){return this.uCi()?1:B.a.equals(X.name,this.printArea,!0)?2:this.Ayh()?3:this.rri(X)?4:
this.KBi()?6:0}V8f(){var X=V.b(this.gridView);null!=X?this.lBa.f8c("",X.name):(X=V.c(this.$,this.gridView))?this.lBa.f8c(X.name,X.name):this.lBa.f8c("",this.gridView.ga.pa.activeCell.toString())}uCi(){return!!this.gridView.ga.Sa.activeFloatingObjectControlId}Ayh(){return 1<this.gridView.ga.pa.selectedRanges.length}rri(X){return X.Rhb&&!this.$.qX(X.scope)}KBi(){return this.gridView.Wb.Xza(this.gridView.ga.pa.selectedRanges[0])}static I0i(X){return ca=>{O.a.ng(ca.Errors)&&(new R(X,ca.Errors[0]),aa.a.getInstance(X).stop(!1))}}static H0i(X){return ca=>
{(ca=F.a.vf(ca.data))&&0<ca.length?new R(X,ca[0]):new R(X,R.Wd(7));aa.a.getInstance(X).stop(!1)}}XPi(X){const ca=null!=V.c(this.$,this.gridView);X.Rhb?this.uUa(ca?7:6):this.uUa(ca?5:4)}uUa(X){ea.b(this.$).Vd(w.a.E3j,{type:X.toString()},null,!0)}HTd(X){ea.b(this.$).Vd(w.a.FWf,{vnk:X},null,!0)}}Object(r.a)(ia,"NameBoxCommandHandler",null,[]);var ya=a(382),za=a(201),la=a(59);const xa=(X,ca,U,ma,ra,Va,ob,ja,lb,wb,Ab=null)=>{Ab=X.Pa(9,Ab);Ab.name=ca;Ab.selectedRanges=U;Ab.sheetName=ma;Ab.formula=ra;Ab.comment=
Va;return la.g(X,"AddDefinedName",Ab,ob,ja,lb,wb,0)};var wa=a(248),hb=a(140);class Ja{Yjj(X){hb.c()&&appChrome.populateNameBoxMenu(X)}Iph(X,ca,U,ma,ra,Va){ya.a(X.userOperationManager,(ob,ja,lb)=>xa(X.qa.va,ca,U,ma,"","",wa.b(ob,ra(X)),wa.a(ja,Va(X)),lb,X),ob=>new za.a(1020,0,ob),null)}GUe(X,ca){new R(X,R.Wd(ca),ca)}Pjd(){appChrome.updateNameBoxState({["focus"]:!0})}f8c(X,ca){appChrome.setNamedObjectOrActiveCellRange(X,ca)}}Object(r.a)(Ja,"NamedObjectsService",null,[397]);var Fa=a(199),Ba=a(383),fa=
a(63),ta=a(7);class Oa{constructor(X,ca){this.$=X;this.gridView=oa.h(this.$);this.Ya=ca;this.BGd=(this.pQa=Ea.EwaSettings.isChangeGateEnabled("OfficeVSO:7843354_AddNamedRange"))?new ia(X,new Ja):null}yd(){return!1}executeCommand(X,ca,U){ca=ca.command;X=null;switch(ca){case 1726517890:this.pQa?this.BGd.fmi(U):U[l.a.IsFreeForm]||((U=this.$.oc.getItemByName(U[x.a.Gd].toString()))?U.activate():h.ULS.sendTraceTag(537161937,0,15,"FormulaBarCommandHandler.ExecuteCommand: Can't find named Object related to selected item in ComboBox"));
break;case 2045896573:U=t.a(this.$);(null===U||void 0===U?0:U.mNa)?U.mNa.L2e():h.ULS.sendTraceTag(537161936,0,15,"FormulaBarCommandHandler.ExecuteCommand: FormulaBarResizeControl is null when trying to expand the formula bar");break;case -1003645154:this.BGd.Pjd();break;case -1790328692:U=t.a(this.$);ca=!this.$.gFb;U.isVisible=ca;U.textBox.isVisible=ca;this.$.gFb=ca;this.$.ig();try{k.a.$t(ta.a.orf,ca.toString(),u.AFrame.tQ)}catch(ma){h.ULS.sendTraceTag(509216780,0,15,`Failed setting ExcelIsFormulaBarOn cookie with error message: ${ma.message}`)}break;
default:X=Fa.a(ca)}return X||fa.Task.Ua(!0)}fd(X,ca,U){X=!1;switch(ca.command){case 1726517890:X=!!U;break;case -1003645154:X=!0;break;case 2045896573:X=m.a.T7();break;case -1790328692:X=Ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DisplaySettings",!1)}return X}Cd(X,ca,U){if("PopulateNameBoxMenu"!==ca)return!1;X=this.$.yc.Fd("UserAction","PopulateNameBoxMenuTimer");if(this.pQa)this.BGd.Xjj();else{ca=Oa.vfi(this.$.oc.items,this.$.na.name);const ra=this.Ya.Er();Ba.a(this.$)&&(ra.id=
"presentModeNamedObjectsMenu");const Va=this.Ya.zd();Va.Nq="Menu";for(var ma of ca){const ob=this.Hph(ma);Va.buttons.push(ob)}ca.count||(ma=this.Ya.obd("EmptyMenuLabel",E.a.instance.ha(711)),Va.buttons.push(ma));ra.hd.push(Va);U.PopulationXML=this.Ya.xgf(ra);Ea.EwaSettings.isChangeGateEnabled("OfficeVSO:5404120_NameboxTelemetry")&&this.HTd(ca.count)}X.stop();return!0}Hph(X){let ca=X;X.includes("!")&&(ca=X.split("!")[1]);X=this.Ya.BR(222,X,1726517890,null,3,"None",0,0,X,!1,0);X.label=ca;X.JT(ca);return X}HTd(X){X=
{["NamedObjectsCount"]:X};ea.b(this.$).Vd(w.a.FWf,X,null,!0)}static vfi(X,ca){const U=new d.a;for(let ma=0,ra=X.length;ma<ra;ma++){const Va=X[ma];if(v.h(Va)){if(Va.name.includes("!")){const ob=Va.name.split("!"),ja=ob[1];if(ob[0]!==ca)continue;U.contains(ja)&&U.remove(ja)}U.add(Va.name)}}U.sort();return U}}Object(r.a)(Oa,"FormulaBarCommandHandler",null,[210]);class Ma extends b.a{constructor(X){super(X)}ue(){f.TaskExtensions.za(e.GetServiceTaskFactory.create(this.$.da,102,this.$.ka,this.La),X=>{this.Zd([new Oa(this.$,
X.result)])},this.$.ka)}static la(X){b.a.Ie(280,new Ma(X))}}Object(r.a)(Ma,"FormulaBarCommandHandlerFactory",b.a,[]);G=a(230);var fb=a(887),pa=a(44),Ua=a(727);class Sa extends G.a{constructor(X){super();this.$=X;this.uc()}create(){pa.PageLoadTrackingInfo.instance.uqa(ta.a.$la);const X=e.GetServiceTaskFactory.Za(this.$.da,388,387,this.La);f.TaskExtensions.za(f.TaskExtensions.xe([X],this.ka),()=>{this.$b(Object(Ua.a)(this.$.da,172,()=>new fb.FormulaBar(this.$,X.result)))},this.$.ka,3)}}Object(r.a)(Sa,
"FormulaBarFactory",G.a,[]);a.d(C,"a",function(){return Ia});const Ia=()=>{c.a.Fa(X=>{X.da.Ja(186,new Sa(X));Ma.la(X)})}},1503:function(r,C,a){a.r(C);r=a(1187);a=a(1234);Object(r.a)();Object(a.a)()},887:function(r,C,a){a.r(C);r=a(0);var c=a(15),b=a(90),e=a(6),f=a(113),d=a(14),h=a(92),l=a(720),k=a(31),u=a(374),v=a(71),x=a(143),w=a(97);class m{}m.XHh="ewa-fb";m.bIh="ewa-fb-placeholder";m.cIh="ewa-fb-text-box";m.dIh="ewa-fb-text-box-monospace-experiment";m.eIh="ewa-fb-text-box-new";m.EZe="ewa-fb-refactor";
m.CZe="ewa-fb-extended";m.xZi="not-ie";m.K6e="functionbox";m.Iji="green-fill-paths";m.KR="drop-down";m.Rtc="ok-cancel-buttons-container";m.aIf="okbox";m.lIe="cancelbox";m.DZe="ewa-fb-nb";m.aIh="ewa-fb-name-box-placeholder";m.qGe="button-disabled";m.$Hh="ewa-fb-expand-button-img";m.ZHh="ewa-fb-expand-button-container";m.fIh="ewa-fb-text-div-container";m.BZe="ewa-fb-drag-resize";m.YHh="ewa-fb-drag-handler";m.z_e="ewa-svg-icon";m.MV="cui-disabled";Object(r.a)(m,"CssClassNames",null,[]);var t=a(7),z=
a(273),y=a(632),D=a(630),H=a(489),F=a(163),G=a(136),L=a(52),M=a(86),O=a(101);class B extends O.a{constructor(Xa,Ca,va,na,Ka,ib){super(Xa);this.hP=()=>{this.domElement.disabled||(this.z9b.className=this.mbc+" "+this.gFf)};this.gP=()=>{this.domElement.disabled||(this.z9b.className=this.mbc+" "+this.iXi)};this.IOf=Ra=>{if(!this.domElement.disabled){const ka=Ra.keyCode;if("mousedown"===Ra.type||13===ka||32===ka)this.z9b.className=this.mbc+" "+this.amj}};this.JOf=()=>{this.domElement.disabled||(this.z9b.className=
this.mbc+" "+this.gFf)};this.mbc=va;this.gFf=na;this.iXi=Ka;this.amj=ib;this.Dd.la("mouseover",this.hP);this.Dd.la("mouseout",this.gP);this.Dd.la("focus",this.hP);this.Dd.la("blur",this.gP);this.Dd.la("mousedown",this.IOf);this.Dd.la("keydown",this.IOf);this.Dd.la("mouseup",this.JOf);this.Dd.la("keyup",this.JOf);this.z9b=Ca}}Object(r.a)(B,"PseudoClassBehavior",O.a,[]);var E=a(13);class I extends M.a{constructor(Xa){super();this.Uud=[];this.$=Xa}dispose(){h.a.ed(this.Uud);this.Uud.length=0;this.$=
null;super.dispose()}z6b(Xa,Ca,va,na,Ka){const ib=E.DOMElementExtensions.getElementById(this.$.domElement,this.$.qc+Xa);Xa=Xa===Ca?ib:E.DOMElementExtensions.getElementById(this.$.domElement,this.$.qc+Ca);if(!ib)return null;va=new B(ib,Xa,va,na,"",Ka);this.Uud.push(va);return va}}I.U9g="ewa-menu-btn-hover";I.W9g="ewa-menu-btn-pressed";Object(r.a)(I,"InitializePseudoClasses",M.a,[]);var S=a(30),J=a(260),K=a(204),R=a(150),Z=a(40),P=a(32),V=a(830),Ea=a(16),oa=a(74),ea=a(47),aa=a(901),ia=a(186);class ya{constructor(Xa=
"",Ca=""){this.menuItemId=Xa;this.commandValueId=Ca}Gda(){return""}lma(){return this.commandValueId}h7(){return this.menuItemId}Lz(){}}Object(r.a)(ya,"NotSelectedMenuItem",null,[112,88]);var za=a(141),la=a(34),xa=a(1),wa=a(109),hb=a(19),Ja=a(50),Fa=a(739);class Ba{constructor(Xa,Ca,va,na,Ka=null){this.D9a=this.E_=this.vca=this.Rr=null;this.Rgh=Ea.a.instance.ha(710);this.stb="EditableNamedObjectDropdownArrowId";this.nCa=this.Qwa=null;this.tSa=()=>{const ib=this.gridView.ga,Ra=ib.pa.O8a()?ib.pa.t5a:
ib.pa.activeRange;this.Rr.value=Ra.isSingle?ib.pa.activeCell.toString():Ra.Adf()};this.O2=()=>{let ib=this.Zbf();this.e6d(ib)||(this.vca.gVa&&(ib=this.$.oc.getItemByName(this.vca.gVa.lma()))&&ib.deactivate(),this.jx(this.gridView.ga.pa.activeCell.toString()))};this.O8=(ib,Ra)=>{if(ib=Ra.na){Ra=ib.usedRange;2===ib.type&&(Ra=ia.a(ib));var ka=this.gridView.ga.pa.Vh,da=this.gridView.inRangePicker||this.gridView.hj,kb=!1;2===ib.type&&ka&&!da&&(ka=this.gridView.ga.pa.activeRange,kb=ib.sheetName===this.$.ua.na.name&&
!!ka&&ka.top===Ra.top&&ka.left===Ra.left&&ka.bottom===Ra.bottom&&ka.right===Ra.right);kb||(Ra=ea.v(Ra,this.$),Ra.NamedObjectName=ib.name,Ra.SheetName=ib.sheetName,this.gridView.Eh(Ra,null,null,null,60,"EditableNamedObjectsDropdownList.OnActiveNamedObjectChanged"));Ra=ib.name.split("!")[1];this.jx(Ra||ib.name,ib.name)}};this.Xr=()=>{this.gridView.ga.Sa.Pc&&this.jx(this.gridView.ga.Sa.Pc.floatingObject.name)};this.MKb=(ib,Ra)=>{this.tSa(ib,Ra)};this.j9=()=>{this.vca.enabled=!1};this.i9=()=>{this.vca.enabled=
!0};this.Wu=()=>{this.vca.enabled=this.$.isEditMode};this.iH=(ib,Ra)=>{this.vca.enabled=Ra.xN?!1:this.$.isEditMode};this.Dki=()=>{this.Yag()};this.Lli=ib=>{if(ib.keyCode!==b.a.Li)ib.keyCode===b.a.NH&&this.E2e();else{var Ra=this.Rr.value;c.ULS.sendTraceTag(39653979,0,50,"FormulaBarCommandHandler.HandleInputCommit: Name Box commit input value.");if(!({sheetName:ib,range:ka}=ea.ab(Ra,this.$.ua)).returnValue||!ka.OA&&xa.EwaSettings.isChangeGateEnabled("OfficeVSO:4653651_CheckIsValidRangeInNamedObjectDropDown"))if(this.$.oc.Pk(Ra)){var ka=
this.$.oc.getItemByName(Ra);this.e6d(ka);this.gridView.focus()}else c.ULS.sendTraceTag(39653980,0,15,"FormulaBarCommandHandler.HandleInputCommit: Input value is not a valid range or a Named Range."),ka=la.a.Wd(1,0,84,83,0,-1137246675,"GotoInvalidReference"),Z.TaskExtensions.za(Ja.a(this.$).wk(ka),()=>{this.E2e()},this.$.ka);else ib=ib||this.$.ua.na.name,Ra=aa.b(this.$.oc,ka,ib),this.e6d(Ra)||(Ra=ea.v(ka,this.$),Ra.SheetName=ib,hb.h(this.$).Eh(Ra,ka.topLeft,null,null,60,"EditableNamedObjectsDropdownList.HandleInputCommit"),
this.gridView.focus())}};this.$=Xa;this.gridView=hb.h(Xa);this.i4a=this.$.qc+t.a.AGd;this.Qgh=this.$.qc+"NameBoxMenu";this.Iib=Ca.OTb;this.svgIconProvider=Ka;Xa=null;Ka&&(Xa=document.createElement("div"),Xa.style.display="none",this.Qwa=Ka.Ima(Fa.a.Ghh,8),this.Qwa.id=this.stb,Xa.appendChild(this.Qwa),document.body.appendChild(Xa));this.q6c(va,na)&&(this.Rr=E.DOMElementExtensions.getElementById(this.E_,this.i4a),c.ULS.shipAssertTag(537161952,0,!!this.Rr,"EditableNamedObjectDropdownList: InputElement inside ComboBoxElement is null"),
this.Rr.setAttribute(x.a.spellcheck,v.a.Vra),this.jx(this.gridView.ga.pa.activeCell.toString()),this.vca.enabled=!Ja.a(this.$).Zq()&&this.$.isEditMode,this.vj(),Xa&&(c.ULS.shipAssertTag(537161951,0,this.Qwa.parentNode!==Xa,"EditableNamedObjectDropdownList: SVG element was not extraced from invisible DIV."),document.body.removeChild(Xa)))}dispose(){this.Iib&&this.Iib.ERd(this.i4a);this.$&&(this.$.Zb.xAc(this.j9),this.$.Zb.wAc(this.i9),this.$.ea.jY(this.Wu),wa.a(this.$).AOb(this.MKb),wa.a(this.$).rAc(this.Xr),
Ja.a(this.$).Lg.lga(this.iH));this.$.oc&&(this.$.oc.xh(this.O8),this.$.oc.DOb(this.O2));this.$.ua&&this.$.ua.xh(this.O2);if(this.gridView){const Xa=this.gridView.ga;Xa.v2(this.O2);Xa.GP(this.tSa);Xa.Sa.u2(this.Xr)}this.$&&this.D9a&&this.D9a.detach("keyup");h.a.Ka(this.D9a);this.Iib=null;E.DOMElementExtensions.ZD(this.Rr);this.Rr.className="";this.nCa=this.Qwa=this.Rr=null}Rek(Xa){!this.nCa&&this.svgIconProvider&&(this.nCa=this.svgIconProvider.Ima(Fa.a.Ihh,8))&&(this.Qwa.parentNode.appendChild(this.nCa),
this.nCa.classList.add("ewa-fb-nb-dropdown-button-img"));this.Qwa&&this.nCa&&(E.DOMElementExtensions.setVisible(this.Qwa,!Xa),E.DOMElementExtensions.setVisible(this.nCa,Xa))}vj(){this.$.Zb.$4b(this.j9);this.$.Zb.Z4b(this.i9);this.$.ea.gV(this.Wu);const Xa=this.gridView.ga;this.$.oc.Vg(this.O8);this.$.ua.Vg(this.O2);Xa.f5(this.O2);Xa.WK(this.tSa);Xa.Sa.bR(this.Xr);wa.a(this.$).S4b(this.Xr);wa.a(this.$).jsb(this.MKb);this.D9a=za.a.instance.Re(this.Rr);xa.EwaSettings.isChangeGateEnabled("OfficeVSO:4696898_DisableFormulaFunctionBoxAndNamedObjectsDropdownDuringPI")&&
Ja.a(this.$).Lg.xba(this.iH);xa.EwaSettings.isChangeGateEnabled("OfficeVSO:4619995_NamedRangeHandleBlur")&&this.D9a.la("blur",this.Dki);this.D9a.la("keyup",this.Lli);this.$.oc.lsb(this.O2)}q6c(Xa,Ca){const va=Xa.zrh(this.i4a,this.Qgh,P.a.dg(this.Rgh),Ba.Sgh,this.stb);if(!va)return c.ULS.sendTraceTag(537161950,0,10,"EditableNamedObjectDropdownList.BuildAndAttachComboBox: ribbonComboBox is null"),!1;Xa=Xa.xgf(va);this.Iib.X4(this.i4a,Xa);this.E_=this.Iib.$9e(this.i4a,t.a.FFf);c.ULS.shipAssertTag(537161949,
0,!!this.E_,"EditableNamedObjectDropdownList: ComboBoxElement was not Created after BuildAndAttachComboBox called");xa.EwaSettings.isChangeGateEnabled("OfficeVSO:5663983_NameBoxOverFlowFix")&&this.E_.classList.add(Ba.OXi);this.vca=this.Iib.kqd(this.i4a);Xa=document.getElementById(this.$.qc+t.a.nkd);void 0!==Xa&&null!==Xa&&Ca.removeChild(Xa);Ca.insertBefore(this.E_,Ca.firstChild);return!0}E2e(){this.Yag();this.gridView.focus()}Yag(){const Xa=this.Zbf();Xa?this.jx(Xa.name):this.jx(this.gridView.ga.pa.activeCell.toString())}Zbf(){var Xa=
this.gridView.ga;const Ca=Xa.pa.Vh;Xa=Xa.pa.activeRange;return this.$.ua.na&&Ca?aa.b(this.$.oc,Xa,this.$.ua.na.name):null}jx(Xa,Ca=""){Xa=new ya(Xa,Ca);this.vca.jx(Xa);this.vca.xc[V.a.Value]=Xa.h7()}e6d(Xa){return Xa&&oa.h(Xa)?(Xa.activate(),!0):!1}}Ba.Sgh="102px";Ba.OXi="ewa-fb-nb-fix";Object(r.a)(Ba,"EditableNamedObjectDropdownList",null,[2]);class fa{constructor(Xa,Ca){this.$=Xa;this.lc=Ca;z.a(this.$).Zi(this)}get Wc(){return this.lc.textBox.Gf}get Fg(){return hb.h(this.$).Ob&&hb.h(this.$).Gm}get Qe(){return J.a.h6e}$g(Xa,
Ca){Ca||E.DOMElementExtensions.setFocus(this.Wc);return!Ca}ui(Xa){return E.DOMElementExtensions.zg(this.Wc,Xa)}pk(){}Rk(){}dispose(){z.a(this.$).gB(this)}}Object(r.a)(fa,"FormulaBarFocusManager",null,[26,2]);var ta=a(232),Oa=a(250),Ma=a(20),fb=a(54),pa=a(91),Ua=a(166);class Sa extends M.a{constructor(Xa,Ca,va,na=null){super();this.zTa=this.m9a=null;this.fMf=()=>{const Ka=new pa.a(753860909,2,this.$.Tc,2,null);this.$.Ia.mc(Ka);return!0};this.gMf=Ka=>Ka.Da.keyCode===b.a.Li?(Ka=new pa.a(753860909,1,
this.$.Tc,2,null),this.$.Ia.mc(Ka),!0):!1;this.hMf=()=>{if(this.gridView.Ob){const Ka=this.gridView.ai;xa.EwaSettings.isChangeGateEnabled("OfficeVSO:7561900_InsertFunctionPositionBugFix")?Ka.textBox.$6b():Ka.textBox.JG=!0}return!1};this.$=va;this.gridView=hb.h(va);this.svgIconProvider=na;this.gXh=Ca.ha(1035);this.fXh=m.K6e+" "+m.KR;this.k2=Xa.z6b(t.a.Yfc,t.a.Yfc,this.fXh,m.Iji,"");this.m9a=na?na.dea(Fa.a.dXh,13,13,this.k2.domElement,void 0,void 0,void 0,Ca.ha(1035)):Ua.createClusteredImageFromClusterWithImageClass(13,
13,Ma.a.ELh,fb.a.yg(0),null,null,!0,Ca.ha(1035));this.k2.domElement.appendChild(this.m9a);ta.a.instance.ta(d.a.click,this.k2.domElement,this.fMf);f.KeyInputManager.instance.ta(d.a.Ic,this.k2.domElement,this.gMf);Oa.a.instance.ta(d.a.pointerDown,this.k2.domElement,this.hMf)}dispose(){this.k2&&(ta.a.instance.Aa(d.a.click,this.k2.domElement,this.fMf),f.KeyInputManager.instance.Aa(d.a.Ic,this.k2.domElement,this.gMf),Oa.a.instance.Aa(d.a.pointerDown,this.k2.domElement,this.hMf));h.a.Ka(this.k2);this.k2=
null;E.DOMElementExtensions.tg(this.m9a);this.zTa=this.m9a=null;super.dispose()}Qek(Xa){!this.zTa&&this.svgIconProvider&&(this.zTa=this.svgIconProvider.dea(Fa.a.qXh,13,13,this.k2.domElement,void 0,void 0,void 0,this.gXh))&&this.zTa.classList.add("ewa-fb-function-button-img");this.m9a&&this.zTa&&(E.DOMElementExtensions.setVisible(this.m9a,!Xa),E.DOMElementExtensions.setVisible(this.zTa,Xa))}}Object(r.a)(Sa,"FormulaBarFunctionControl",M.a,[]);var Ia=a(180),X=a(170),ca=a(49),U=a(9),ma=a(158),ra=a(12);
class Va{constructor(Xa){this.Uwa=this.vla=this.YQc=this.XQc=this.WQc=null;this.Woc=this.Gwd=this.J7=!1;this.Hpe=this.vob=this.KGe=this.f8f=0;this.Auc=Ca=>{this.L2e();Ca.Da.rawEvent.preventDefault();return!0};this.wuc=Ca=>{this.Gwd=!0;this.f8f=Ca.clientPoint.y;document.body.classList.add(m.BZe);this.J7||(this.BUa=0);this.P5a.la("mousemove",this.cLf,!0);this.P5a.la("touchmove",this.cLf);this.P5a.la("mouseup",this.tJd);this.P5a.la("touchend",this.tJd);this.P5a.la("mouseleave",this.tJd);return!0};this.tJd=
()=>{this.Gwd=!1;this.BUa=this.Ep.clientHeight-ma.c;document.body.classList.remove(m.BZe);this.P5a.oE();c.ULS.sendTraceTag(575426571,0,50,`FormulaBarResizeControl.OnDragHandlerResizeEnd formula bar drag resized to: ${this.Ep.clientHeight} pixel`)};this.cLf=Ca=>{this.Gwd?(Ca=ra.HelperMethods.Ugc(Ca).y,Ca=this.ccf(this.BUa+Math.min(Ca,this.$.domElement.clientHeight-75)-this.f8f),this.J7=Ca>=this.lineHeight,E.DOMElementExtensions.toggleCssClass(this.Ep,m.CZe,this.J7),Ca=ma.c+Math.round(Math.max(Ca-2,
0)),this.Ep.clientHeight!==Ca&&(this.Ep.style.height=Ca+"px",this.$.bDa())):c.ULS.shipAssertTag(537161935,0,!1,"FormulaBarResizeControl.OnDragHandlerResize: reached OnDragHandlerResize with isDuringResize false")};this.jP=Ca=>{this.J7&&(this.nNa=Math.round((Math.round(this.nNa/this.lineHeight)+(0<Ca.Zra?1:-1))*this.lineHeight));Ca.Da.preventDefault();return!1};this.e9=()=>{this.ADj();this.Woc&&(Ia.a.instance.Aa(d.a.GJ,document.body,this.e9),Ia.a.instance.Aa(d.a.eBa,document.body,this.e9),X.a.instance.Aa(d.a.jf,
document.body,this.e9),this.Woc=!1);return!1};this.Ff=()=>{this.nNa=0};this.onScroll=Ca=>{this.Woc||(Ia.a.instance.ta(d.a.GJ,document.body,this.e9),Ia.a.instance.ta(d.a.eBa,document.body,this.e9),X.a.instance.ta(d.a.jf,document.body,this.e9),this.Woc=!0);Ca.preventDefault()};this.jdj=Ca=>{this.nNa=this.KGe;Ca.preventDefault()};this.$=Xa;this.P5a=za.a.instance.qLa(document.body.ownerDocument)}get lineHeight(){return this.vob?this.vob:U.a.j6e}set lineHeight(Xa){this.vob=Xa}get Ep(){const {FormulaBar:Xa}=
a(887);this.WQc||(this.WQc=Xa.Ehc(this.$));return this.WQc}get Zfc(){this.XQc||(this.XQc=document.getElementById(t.a.Wzb));return this.XQc}get ama(){this.YQc||(this.YQc=document.getElementById(t.a.Wzb+"_"+t.a.NHc));return this.YQc}get nNa(){return this.ama.scrollTop}set nNa(Xa){this.KGe=Xa;this.ama.scrollTop!==Xa&&(this.ama.scrollTop=Xa)}get mWh(){return 2*this.lineHeight-2}get BUa(){return this.Hpe}set BUa(Xa){this.Hpe=Xa}L2e(){this.J7=!this.J7;E.DOMElementExtensions.toggleCssClass(this.Ep,m.CZe,
this.J7);this.J7&&!this.BUa&&(this.BUa=this.mWh);this.Ep.style.height=ma.c+(this.J7?this.BUa:0)+"px";this.vla.setAttribute(t.a.xv,this.J7?"Collapse the formula bar":"Expand the formula bar");this.$.bDa();c.ULS.sendTraceTag(575426572,0,50,`FormulaBarResizeControl.OnExpandButtonClick formula bar ${this.J7?"expanded":"collapsed"}`)}wsh(Xa){const Ca=document.createElement("div");Ca.id=this.$.qc+t.a.l6e;Ca.className=m.fIh;this.vla=Va.voh(this.$.qc,Xa);Ca.appendChild(this.vla);this.Uwa=Va.Unh(this.$.qc);
Ca.appendChild(this.Uwa);return Ca}fvj(){Ia.a.instance.ta(d.a.vq,this.vla,this.Auc);X.a.instance.ta(d.a.mg,this.vla,this.Auc);Ia.a.instance.ta(d.a.vq,this.Uwa,this.wuc);X.a.instance.ta(d.a.mg,this.Uwa,this.wuc)}ivj(){Ia.a.instance.ta(d.a.TE,this.Zfc,this.jP);ca.a.addHandler(this.ama,d.a.scroll,this.onScroll);ca.a.addHandler(this.ama,d.a.focus,this.jdj);hb.h(this.$).ga.add_activeCellChanged(this.Ff)}Ack(){void 0!==this.vla&&null!==this.vla&&(Ia.a.instance.Aa(d.a.vq,this.vla,this.Auc),X.a.instance.Aa(d.a.mg,
this.vla,this.Auc));void 0!==this.Uwa&&null!==this.Uwa&&(Ia.a.instance.Aa(d.a.vq,this.Uwa,this.wuc),X.a.instance.Aa(d.a.mg,this.Uwa,this.wuc));void 0!==this.Zfc&&null!==this.Zfc&&Ia.a.instance.Aa(d.a.TE,this.Zfc,this.jP);hb.h(this.$).ga.remove_activeCellChanged(this.Ff)}ADj(){this.nNa=Math.round(this.ccf(this.nNa))}ccf(Xa){return Math.round(Xa/this.lineHeight)*this.lineHeight}static voh(Xa,Ca){const va=document.createElement("a");va.id=Xa+t.a.pWh;va.classList.add(m.ZHh);E.DOMElementExtensions.xy(va,
t.a.Au);va.setAttribute(t.a.xv,"Expand the formula bar");Ca.dea(Fa.a.Hhh,12,12,va).classList.add(m.$Hh);return va}static Unh(Xa){const Ca=document.createElement("div");Ca.id=Xa+t.a.nWh;Ca.className=m.YHh;return Ca}}Object(r.a)(Va,"FormulaBarResizeControl",null,[]);O=a(249);var ob=a(1188);class ja{}ja.disabled="disabled";ja.y1j="stale";ja.Vlj="presentationMode";Object(r.a)(ja,"NameBoxStateUpdateKey",null,[]);class lb extends O.a{constructor(Xa,Ca){super(document.createElement("div"));this.We=null;
this.e$j=()=>{this.$.Ia.qCb("PopulateNameBoxMenu",{menuId:"NameBox"})};this.tSa=()=>{var va=this.gridView.ga;const na=va.pa.O8a()?va.pa.t5a:va.pa.activeRange;va=na.isSingle?va.pa.activeCell.toString():na.Adf();this.jx(va)};this.tk=(va,na)=>{this.aga(va,na);this.O2(va,na)};this.O2=()=>{let va=ob.c(this.$,this.gridView);aa.c(va,xa.EwaSettings.isChangeGateEnabled("OfficeVSO:7317913_FixFocusLostOnQuerySelection"))||(this.We&&(va=this.$.oc.getItemByName(this.We))&&va.deactivate(),this.jx(this.gridView.ga.pa.activeCell.toString()))};
this.O8=(va,na)=>{if(va=na.na){var Ka=va.usedRange;2===va.type&&(Ka=ia.a(va));var ib=this.gridView.ga.pa.Vh,Ra=this.gridView.inRangePicker||this.gridView.hj,ka=!1;2===va.type&&ib&&!Ra&&(ib=this.gridView.ga.pa.activeRange,ka=va.sheetName===this.$.ua.na.name&&!!ib&&ib.top===Ka.top&&ib.left===Ka.left&&ib.bottom===Ka.bottom&&ib.right===Ka.right);Ka=ea.v(Ka,this.$),Ka.NamedObjectName=va.name,Ka.SheetName=va.sheetName,xa.EwaSettings.isChangeGateEnabled("OfficeVSO:7317913_FixFocusLostOnQuerySelection")?
this.gridView.Eh(Ka,null,null,null,60,"EditableNamedObjectsDropdownList.OnActiveNamedObjectChanged",0,!0,!0,null,na.disableAutoFocusOnGrid):this.gridView.Eh(Ka,null,null,null,60,"EditableNamedObjectsDropdownList.OnActiveNamedObjectChanged");na=aa.a(va.name);this.jx(na.name,na.fullName)}};this.Xr=()=>{const va=ob.b(this.gridView);null!=va&&this.jx(va.name)};this.MKb=(va,na)=>{this.tSa(va,na)};this.ebj=()=>{this.$La(this.$.isEditMode&&this.gridView.ai.l$a())};this.Ug=()=>{this.$La(!1)};this.j9=()=>
{this.$La(!0)};this.i9=()=>{this.$La(!1)};this.Wu=()=>{this.$La(!this.$.isEditMode)};this.iH=(va,na)=>{this.$La(na.xN?!0:!this.$.isEditMode)};this.onKeyDown=va=>va.Da.keyCode===b.a.Tra?(this.gridView.focus(),!0):!1;this.aga=()=>{this.n7d({[ja.y1j]:!0})};this.$=Xa;this.gridView=hb.h(Xa);this.q6c(Ca)&&(this.jx(this.gridView.ga.pa.activeCell.toString()),this.$La(Ja.a(this.$).Zq()||!this.$.isEditMode),this.vj(),f.KeyInputManager.instance.ta(d.a.Ic,this.domElement,this.onKeyDown.bind(this)))}dispose(){this.$&&
(this.$.Zb.xAc(this.j9.bind(this)),this.$.Zb.wAc(this.i9.bind(this)),this.$.ea.jY(this.Wu.bind(this)),wa.a(this.$).AOb(this.MKb.bind(this)),wa.a(this.$).rAc(this.Xr.bind(this)),Ja.a(this.$).Lg.lga(this.iH.bind(this)),this.$.oc&&(this.$.oc.xh(this.O8.bind(this)),this.$.oc.DOb(this.O2.bind(this)),this.$.oc.DOb(this.S1f.bind(this)),this.$.oc.R9(this.aga.bind(this)),this.$.oc.Qpa(this.aga.bind(this)),this.$.oc.pUa(this.aga.bind(this)),this.$.oc.COb(this.aga.bind(this))),this.$.ua&&this.$.ua.xh(this.tk.bind(this)));
if(this.gridView){const Xa=this.gridView.ga;Xa.v2(this.O2.bind(this));Xa.GP(this.tSa.bind(this));Xa.Sa.u2(this.Xr.bind(this))}super.dispose()}Oek(Xa){this.n7d({[ja.Vlj]:Xa})}q6c(Xa){const Ca=document.getElementById(this.$.qc+t.a.nkd);void 0!==Ca&&null!==Ca&&Xa.removeChild(Ca);appChrome.renderNameBoxUI(this.domElement,this.e$j.bind(this));Xa.insertBefore(this.domElement,Xa.firstChild);return!0}vj(){this.$.Zb.$4b(this.j9.bind(this));this.$.Zb.Z4b(this.i9.bind(this));this.$.ea.gV(this.Wu.bind(this));
const Xa=this.gridView.ga;this.$.oc.Vg(this.O8.bind(this));this.$.ua.Vg(this.tk.bind(this));Xa.f5(this.O2.bind(this));Xa.WK(this.tSa.bind(this));Xa.Sa.bR(this.Xr.bind(this));wa.a(this.$).S4b(this.Xr.bind(this));wa.a(this.$).jsb(this.MKb.bind(this));xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddNamedRangePLTFix",!1)||(this.$.xsb(this.ebj.bind(this)),this.gridView.ai.Pm(this.Ug.bind(this)));xa.EwaSettings.isChangeGateEnabled("OfficeVSO:4696898_DisableFormulaFunctionBoxAndNamedObjectsDropdownDuringPI")&&
Ja.a(this.$).Lg.xba(this.iH.bind(this));this.$.oc.lsb(this.O2.bind(this));this.$.oc.lsb(this.S1f.bind(this));this.$.oc.e_(this.aga.bind(this));this.$.oc.yja(this.aga.bind(this));this.$.oc.jJa(this.aga.bind(this));this.$.oc.A1a(this.aga.bind(this))}jx(Xa,Ca=""){this.We=""!==Ca?Ca:this.We;appChrome.setNamedObjectOrActiveCellRange(Ca,Xa)}$La(Xa){this.n7d({[ja.disabled]:Xa})}S1f(Xa,Ca){ob.a(this.$,!0);this.aga(Xa,Ca)}n7d(Xa){appChrome.updateNameBoxState(Xa)}}Object(r.a)(lb,"NameBox",O.a,[2]);var wb=a(185);
const Ab=m.aIf+" "+m.KR,nb=m.lIe+" "+m.KR;class pb extends M.a{constructor(Xa,Ca,va,na){super();this.Qub=this.mKb=this.wKa=this.kSa=null;this.nJ=this.Ioc=!1;this.Q2f=()=>{this.gridView.sL.ro(this.Ui);this.gridView.sL.Pm(this.Ug);this.Ioc=!0};this.Ui=()=>{this.ZEb?this.ppg(!0):this.Rtc.style.display="flex"};this.Ug=()=>{this.ZEb?this.ppg(!1):this.Rtc.style.display="none"};this.jPf=ib=>this.euc(!0,`OkCancelEditControl.OnOkClick: ${ib.kc}`,ra.HelperMethods.Fp(ib));this.kPf=ib=>this.euc(!0,`OkCancelEditControl.OnOkKeyDown: ${ib.kc}`);
this.nJf=ib=>this.euc(!1,`OkCancelEditControl.OnCancelClick: ${ib.kc}`,ra.HelperMethods.Fp(ib));this.qJf=ib=>this.euc(!1,`OkCancelEditControl.OnCancelKeyDown: ${ib.kc}`);this.onPointerDown=()=>{this.gridView.Ob&&(this.gridView.ai.textBox.JG=!0);return!1};const {FormulaBar:Ka}=a(887);this.$=va;this.gridView=hb.h(va);this.nJ=S.a.nJ();this.Rtc=pb.xai(va);this.ZEb=S.a.T7();na?(this.kSa=na.Ima(Fa.a.beh,16),this.wKa=na.Ima(Fa.a.ewh,16),this.ZEb&&(this.mKb=na.Ima(Fa.a.ceh,16),this.Qub=na.Ima(Fa.a.fwh,16),
this.kSa.style.display="none",this.wKa.style.display="none")):(this.kSa=Ua.createClusteredImageFromClusterWithImageClass(16,16,Ma.a.wLh,fb.a.yg(1),null,null,!0,Ca.ha(1041)),this.wKa=Ua.createClusteredImageFromClusterWithImageClass(16,16,Ma.a.yLh,fb.a.yg(1),null,null,!0,Ca.ha(1042)));this.N8=Xa.z6b(Ka.qId,Ka.qId,Ab,"","");this.N8.domElement.appendChild(this.kSa);this.C5=Xa.z6b(Ka.s7c,Ka.s7c,nb,"","");this.C5.domElement.appendChild(this.wKa);this.ZEb&&(this.N8.domElement.appendChild(this.mKb),this.C5.domElement.appendChild(this.Qub));
this.gridView.cellTextEditBox.ro(this.Ui);this.gridView.cellTextEditBox.Pm(this.Ug);ta.a.instance.ta(d.a.click,this.N8.domElement,this.jPf);f.KeyInputManager.instance.ta(d.a.Ic,this.N8.domElement,this.kPf);Oa.a.instance.ta(d.a.pointerDown,this.N8.domElement,this.onPointerDown);ta.a.instance.ta(d.a.click,this.C5.domElement,this.nJf);f.KeyInputManager.instance.ta(d.a.Ic,this.C5.domElement,this.qJf);Oa.a.instance.ta(d.a.pointerDown,this.C5.domElement,this.onPointerDown);this.nJ&&this.gridView.QWg(this.Q2f)}dispose(){this.gridView&&
this.gridView.cellTextEditBox&&(this.gridView.cellTextEditBox.io(this.Ui),this.gridView.cellTextEditBox.fn(this.Ug));this.gridView&&this.nJ&&(this.gridView.hyj(this.Q2f),this.Ioc&&(this.gridView.sL.io(this.Ui),this.gridView.sL.fn(this.Ug),this.Ioc=!1));this.N8&&(ta.a.instance.Aa(d.a.click,this.N8.domElement,this.jPf),f.KeyInputManager.instance.Aa(d.a.Ic,this.N8.domElement,this.kPf),Oa.a.instance.Aa(d.a.pointerDown,this.N8.domElement,this.onPointerDown));this.C5&&(ta.a.instance.Aa(d.a.click,this.C5.domElement,
this.nJf),f.KeyInputManager.instance.Aa(d.a.Ic,this.C5.domElement,this.qJf),Oa.a.instance.Aa(d.a.pointerDown,this.C5.domElement,this.onPointerDown));h.a.Ka(this.N8);this.N8=null;h.a.Ka(this.C5);this.C5=null;E.DOMElementExtensions.tg(this.wKa);this.wKa=null;E.DOMElementExtensions.tg(this.kSa);this.kSa=null;this.ZEb&&(E.DOMElementExtensions.tg(this.Qub),this.Qub=null,E.DOMElementExtensions.tg(this.mKb),this.mKb=null);super.dispose()}euc(Xa,Ca,va=null){const na=this.gridView.ai;if(va){const Ka=this.gridView.Gm?
"formulaBar_end_edit_ok_cancel_btn":"cell_text_end_edit_ok_cancel_btn";let ib=void 0;xa.EwaSettings.W$a&&(ib=[Object(wb.a)(this.gridView.cellTextEditBox.textBox.pEa)]);wb.b(this.$).HEa(va.rawEvent,Ka,ib)}this.Ioc&&this.gridView.sL.nG?this.gridView.sL.endEdit(Xa,Ca,0):na.endEdit(Xa,Ca,0);this.gridView.focus();return!0}ppg(Xa){const Ca=Xa?"block":"none";Xa=Xa?"none":"block";this.kSa.style.display=Ca;this.wKa.style.display=Ca;this.mKb.style.display=Xa;this.Qub.style.display=Xa}static xai(Xa){const {FormulaBar:Ca}=
a(887);return document.getElementById(Xa.qc+Ca.$Hf)}}Object(r.a)(pb,"OkCancelEditControl",M.a,[]);var cb=a(297),Da=a(272),zb=a(76),qb=a(199),Pa=a(264),Nb=a(223),Tb=a(295),Vb=a(137),Jb=a(169),Qa=a(44),Db=a(325),sa=a(327),Ha=a(178),mb;(function(Xa){Xa[Xa.loaded=0]="loaded";Xa[Xa.error=1]="error";Xa[Xa.loading=2]="loading";Xa[Xa.unloaded=3]="unloaded";Xa[Xa.missing=4]="missing"})(mb||(mb={}));Object(r.b)("LoadStatus",mb);a.d(C,"FormulaBar",function(){return qa});class qa extends u.a{constructor(Xa,Ca=
null){super(hb.h(Xa));this.yog=null;this.CGd=["nameBox","nameBoxData"];this.nge=this.Mr=this.clearContentNotifier=this.nameBox=this.YRa=this.Ep=null;this.l9d=!1;this.ama=null;this.xsf=this.tBf=this.CCb=!1;this.Ui=()=>{this.lnc&&(this.l9d=!1);this.XYd()};this.Ug=()=>{this.XYd();this.jc||this.ZJe()};this.zSf=()=>{this.Ob||this.textBox.disabled||this.startEdit(!0,!1,null)};this.Go=()=>{this.GDa()};this.iH=(na,Ka)=>{this.GDa();qa.Mxa&&(Ka.xN?qa.Mxa.classList.add(m.qGe):this.x3c())};this.Wr=(na,Ka)=>{na=
this.grid;this.lnc&&(this.l9d=!0);this.Ob?(this.B$a||(Ka.NEb||this.rF(null),this.raiseEvent(u.a.Yub,Ka)),this.jc&&this.B$a||(this.jc?na.cellTextEditBox.textBox.isCursorAttached()&&!this.textBox.isCursorAttached()&&na.cellTextEditBox.textBox.clearCursorFormatLocation():this.jc||this.Zjb())):na.Ob&&this.GDa()};this.gg=(na,Ka)=>{(na=this.grid.ga.pa.activeCell)&&(Ka=this.grid.pD(Ka.Td.hash))&&na.Yd(Ka.mf)&&this.GDa()};this.vKd=(na,Ka)=>{-185374993===Ka.command&&(c.ULS.sendTraceTag(537161939,0,50,"FormulaBar: OnPasteCSERendered updated instantaneously"),
this.GDa())};this.Oe=()=>{this.GDa();Z.TaskExtensions.za(K.a(this.$.da),()=>{this.Mdg()},this.ka,11)};this.lfa=()=>{this.Mdg();Qa.PageLoadTrackingInfo.instance.w2(t.a.$la,["formulaButton","textbox","textboxData"]);Qa.PageLoadTrackingInfo.instance.oY(t.a.$la,["formulaButton","textbox","textboxData"]);Qa.PageLoadTrackingInfo.instance.nY(t.a.$la,["formulaButton"])};this.onKeyDown=na=>{if(!this.jc){var Ka=this.$.shortcutKeyManager.Ms(na.Da);this.WXf(na.Da,Ka)}if(na.Da.keyCode===b.a.aA){var ib=this.hya();
Ka=E.DOMElementExtensions.Bm(ib);ib=E.DOMElementExtensions.pC(ib);return E.DOMElementExtensions.CDa(na.Da,Ka,ib)}return!1};this.fP=()=>{this.x3c()};this.UDb=()=>{this.Ep?(this.nameBox=new lb(this.$,this.Ep),this.S6f()):this.ITd()};this.Rui=(na,Ka,ib,Ra,ka)=>{this.Ep?(this.YRa=new Ba(na,Ka,ib,Ra,ka),this.S6f()):this.ITd()};Ca||c.ULS.sendTraceTag(509223749,0,50,"FormulaBar.ctor: SVGIconProvider must always exist.");S.a.T7()?(this.nge=new Va(Xa),this.initialize(this.nYd(Xa,Ca)),this.mNa.fvj()):(this.initialize(qa.AOj(Xa)),
this.Ep=qa.Ehc(Xa));if(e.AFrameworkApplication.sa.Qa.$f){var va=document.getElementById("AdditionalBarsRegion");va&&(va.style.height="")}this.owd=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:5160311_CrossBookCrossSheetDataBookPickerOverlay");this.SD=new cb.a(this.Ep,1);this.pQa=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:7843354_AddNamedRange");this.JCi=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:6148798_FormulaBarCrossSessionPicker");this.ICi=S.a.BO(this.$);this.Lab=this.JE&&xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ParenthesesCoupling",
!1);this.lnc=xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaBarTabbingBehaviorChangeXLO",!1);this.xsf=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:7367969_formulaEditingLogLoadedFontStatus");this.Hlc=new I(Xa);this.Hlc.z6b(t.a.npg,t.a.npg,t.a.$7j+" cui-TabRowRight",I.U9g,I.W9g);this.i6e=new Sa(this.Hlc,Ea.a.instance,Xa,Ca);this.v0i=new pb(this.Hlc,Ea.a.instance,Xa,Ca);this.yog=sa.b(()=>{this.kfg()},1,this.$.ka,"FormulaBar.setTextBoxForActiveItem",!0);Xa.ua.Vg(this.Oe);va=this.grid;
va.cellTextEditBox.ro(this.Ui);va.cellTextEditBox.Pm(this.Ug);va.cellTextEditBox.gJa(this.Wr);va.TF(this.Go);va.Ca.vv(this.gg);va.Ca.vba(this.gg);va.Wye(this.vKd);Ja.a(Xa).Lg.xba(this.iH);Xa.ea.c5(this.fP);wa.a(Xa).S4b(this.Go);xa.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&Xa.da.Qb(313,na=>{this.clearContentNotifier=na;this.clearContentNotifier.Mxe(this.Wr)});f.KeyInputManager.instance.ta(d.a.Ic,this.Wc,this.onKeyDown);va=this.textBox.style;Pa.c(va,
Xa.isChromeRtl,"0px");va.textAlign=this.Vof?"right":"left";this.isVisible=!1;this.owd&&(this.textBox.isVisible=!1);F.a(this.$).kJa(this.lfa);this.$.ea.xna&&(c.ULS.sendTraceTag(537161948,0,50,"FormulaBar: CommandUI already generated when registering to: OnCommandUIAttachCompleted"),this.lfa(null,null));this.GDa();this.x3c();this.textBox.lhg=!0;this.$ui(Xa,Ca);z.a(Xa).Zi(this);this.textBox.iye(this.zSf);this.B$a=!1;this.Mr=new fa(this.$,this);S.a.nrf()&&this.yti();this.textBox.qR(()=>{Qa.PageLoadTrackingInfo.instance.nY(t.a.$la,
["textbox","textboxData"]);this.toggleEditingEvents(!1)})}set text(Xa){this.jc&&this.Ob?this.textBox.setPlainText(Xa):super.text=Xa}get Ob(){return super.Ob}set Ob(Xa){super.Ob=Xa;this.toggleEditingEvents(Xa)}get kTb(){return!0}get formattedText(){return this.jc?this.textBox.getFormattedText():super.formattedText}set formattedText(Xa){this.jc?this.textBox.setFormattedText(Xa):super.formattedText=Xa}get n$a(){return this.Ob}get isVisible(){return E.DOMElementExtensions.isVisible(this.Ep)}set isVisible(Xa){this.owd?
E.DOMElementExtensions.setVisible(this.Ep,Xa):(E.DOMElementExtensions.setVisible(this.Ep,Xa),this.textBox.isVisible=Xa)}get Wc(){return this.Ep}get Fg(){return this.isVisible}get Qe(){return J.a.mkd}get mNa(){return this.nge}$g(Xa,Ca){Xa=!1;Ca||(Xa=this.vVh());return Xa}dispose(){const Xa=this.$;if(Xa){Xa.ua.xh(this.Oe);var Ca=this.grid;Ca.cellTextEditBox.io(this.Ui);Ca.cellTextEditBox.fn(this.Ug);Ca.cellTextEditBox.oUa(this.Wr);Ca.qH(this.Go);Ca.Ca.Vt(this.gg);Ca.Ca.nUa(this.gg);Ja.a(this.$).Lg.lga(this.iH);
Xa.ea.O9(this.fP);wa.a(Xa).rAc(this.Go);Ca=F.a(this.$);f.KeyInputManager.instance.Aa(d.a.Ic,this.Wc,this.onKeyDown);S.a.T7()&&this.mNa.Ack();Ca&&Ca.qUa(this.lfa);z.a(Xa).gB(this);xa.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&(this.clearContentNotifier&&this.clearContentNotifier.mSd(this.Wr),Xa.da.XV(313))}this.textBox&&this.textBox.T4f(this.zSf);this.pQa&&this.nameBox&&this.$.ea.en(this.UDb);h.a.ed([this.SD,this.i6e,this.v0i,this.Hlc,this.YRa,this.nameBox]);
h.a.Ka(this.Mr);this.Ep&&(E.DOMElementExtensions.ZD(this.Ep),this.Ep.className="");c.ULS.sendTraceTag(537161946,0,50,"FormulaBar.Dispose: setting this.formulaBarElement to null");this.Ep=null;super.dispose()}endEdit(Xa,Ca,va,na=null){this.textBox.addEventLogRecord("FormulaBar.EndEdit",{["Commit"]:Xa,["Caller"]:Ca});this.gEa(!1);if(this.Ob){var Ka=null;this.lnc&&na&&(Ka=this.$.shortcutKeyManager.Ms(na));if(xa.EwaSettings.isChangeGateEnabled("OfficeVSO:4011777_investigateCalculateMaximumClippingExtentsCrash")){var ib=
this.grid.cellTextEditBox.textBox.domElement;c.ULS.sendTraceTag(537161945,0,50,`FormulaBar.EndEdit: gridKeyboardHandler is: ${ib.id}, parent is: ${ib.parentNode?ib.parentNode.id:"null"}`)}ib=this.grid.Gc;this.jc||this.textBox.clear("FormulaBar.EndEdit");this.Ob=!1;this.aG(!0);this.eAa()&&this.grid.At&&this.grid.At.Jxa&&this.grid.At.hhb(t.a.DDb);if(Xa){var Ra=new y.a(this.grid.ga.pa.activeCell,ib.text,ib.text,!1,this.grid.$.ua.na);this.a_f(Ra);null!==Ra&&(ib.text=Ra.newValue)}else this.textBox.setPlainText(this.text);
Ra=new D.a(this.grid.ga.pa.activeCell,ib.text,Xa);this.sPd(Ra);ib.endEdit(Xa,`${Ca}->FormulaBar.EndEdit`,va,na);this.jvf(Ka)||ib.textBox.focus();this.textBox.Oib("FormulaBar.EndEdit")}else this.textBox.Oib("FormulaBar.EndEdit",{["IsEditing"]:"false"})}T6(Xa,Ca,va,na=!0,Ka=!0){super.T6(Xa,Ca,va,na,Ka);this.jc&&this.grid.Gc.T6(Xa,Ca,va,na,Ka)}YXf(Xa){if(this.jc){const Ca=this.grid.Gc,va=this.textBox.selection;va.length&&Ca.T6(va.index,va.length,Xa,!1,!1)}}ui(Xa){return E.DOMElementExtensions.zg(this.Ep,
Xa)}pk(){e.AFrameworkApplication.sa.Hf.gl(this.Qe)}Rk(){}Itg(Xa){this.pQa?this.nameBox.Oek(Xa):this.YRa.Rek(Xa);this.i6e.Qek(Xa)}Rug(){if(this.ama){var Xa=Object(Ha.g)(this.text);this.CCb!==Xa&&(this.lfg(Xa),this.CCb=Xa)}}rKb(){this.textBox.addEventLogRecord("FormulaBar.OnAutoCompleteCommandHandled");const Xa=this.grid.Gc;if(this.jc){if(!Xa.Ob||!this.Ob)return;Xa.formattedText=this.formattedText}else Xa.text=this.text;Xa.setCaretPosition(this.textBox.caretPosition)}BLb(Xa){this.textBox.disabled||
(this.grid.cellTextEditBox.textBox.JG=!0,this.jc&&this.Ob||this.startEdit(!1,!0,Xa),this.z_())}KSa(Xa){this.jc?(this.uM&&(this.rN=this.textBox.caretPosition,this.LU=this.textBox.HT.length),this.JE&&this.rF(null)):super.KSa(Xa);this.qga();this.srg()}gpa(Xa){var Ca=this.$.shortcutKeyManager.Ms(Xa);const va=this.jc&&this.B$a;1872288872===Ca||125627505===Ca||267796030===Ca?this.ICi?super.gpa(Xa):zb.g(Xa):va?zb.g(Xa):this.Ob&&this.grid.Gc.Ob&&(Ca=this.grid.Gc,this.jc?Ca.formattedText=this.formattedText:
Ca.text=this.text,Ca.setCaretPosition(this.textBox.caretPosition),this.GJc(),this.Lab&&0===this.textBox.selection.length&&this.rF(null,null),this.JCi&&this.inRangePicker&&this.c2d(),super.gpa(Xa))}Od(Xa,Ca){this.Ob&&super.Od(Xa,Ca)}Ws(Xa,Ca){this.Ob&&super.Ws(Xa,Ca)}yti(){const Xa=this.grid.tc(void 0);Xa?(this.CCb=Xa.yz||Object(Ha.g)(Xa.text),this.lfg(this.CCb)):c.ULS.sendTraceTag(509720320,0,50,"FormulaBar.initTextElementStyles: failed to get active cell")}lfg(Xa){E.DOMElementExtensions.toggleCssClass(this.ama,
m.dIh,Xa);this.xsf&&!this.tBf&&this.CCb&&(this.tBf=!0,this.BQi())}BQi(){setTimeout(()=>{const Xa=gridRenderer.CanvasRendererGlobals.getFontsLoadStatus(["Consolas","Monaco","Menlo","Courier New","monospace"]);let Ca="FormulaBar: Formula fonts load status: ";for(const va of Xa)Ca+=`${va.font}: ${mb[va.status]}; `;c.ULS.sendTraceTag(509642332,0,50,Ca)},2E3)}nYd(Xa,Ca){this.Ep=qa.Ehc(Xa);this.Ep.classList.add(m.DZe);this.Ep.classList.add(m.EZe);const va=this.mNa.wsh(Ca);Ca=qa.nac(this.jc,!0);va.appendChild(Ca);
qa.Mxa=qa.xPe(Xa.qc);const na=qa.tPe(),Ka=qa.aQe(Xa.qc),ib=qa.$Pe(Xa.qc),Ra=qa.UOe(Xa.qc);ib.tabIndex=-1;Ra.tabIndex=-1;Ka.appendChild(Ra);Ka.appendChild(ib);Ka.appendChild(qa.Mxa);na.appendChild(Ka);na.appendChild(va);Xa=qa.SPe(Xa.qc);this.Ep.appendChild(Xa);this.Ep.appendChild(na);const ka=new Tb.a(Ca,this.jc,!1);this.ama=Ca;this.mNa.lineHeight=ka.Y6h();ka.qR(()=>{Db.c(ka.Gf,l.a.ariaLabel,"formula bar")});ka.qR(()=>{this.mNa.ivj()});ka.isVisible=!1;return ka}JSa(Xa){this.yyc(Xa);super.JSa(Xa);Vb.b(this.$).Vd(G.a.rWh,
{["Location"]:"canvas"});k.a.Fh&&window.focus();const Ca=this.$.shortcutKeyManager.Ms(Xa);this.jc&&this.WXf(Xa,Ca);this.textBox.disabled||this.jc&&this.Ob||this.startEdit(!0,!1,Xa);let va;va={};va.wasEditing=this.Ob;va.formulaBar=!0;let na=this.wi(Xa,Ca);!na&&qb.d(Ca,this.Q$a,!0)&&(na=this.jvf(Ca)?!0:this.grid.ga.wi(Xa,Ca,va));na||Jb.a(this.$).LDd(Xa,0,7)}startEdit(Xa,Ca,va){const na=this.grid;if(!this.Ob||!na.Ob){this.textBox.Oib("FormulaBar.StartEdit");this.textBox.addEventLogRecord("FormulaBar.StartEdit",
{["SetCaretPositionToEnd"]:Xa,["IsOnMouseDown"]:Ca});Vb.b(na.$).Vd(G.a.qWh,{["Location"]:"canvas"});this.Ob=this.B$a=!0;na.Zr&&na.Zr.sDc(this);na.cellTextEditBox.aG(!1);na.cellTextEditBox.jUd();this.Ieg(!1);if(xa.EwaSettings.isChangeGateEnabled("OfficeVSO:4011777_investigateCalculateMaximumClippingExtentsCrash")){const ib=this.grid.cellTextEditBox.textBox.domElement;c.ULS.sendTraceTag(537161940,0,50,`FormulaBar.StartEdit: gridKeyboardHandler is: ${ib.id}, parent is: ${ib.parentNode?ib.parentNode.id:
"null"}`)}var Ka=()=>{var ib=na.$.ua.na;const Ra=na.tc(null);ib=new H.a(Ra,ib,void 0,void 0,void 0,this.Jnd(Ra));this.tPd(ib);this.jc&&this.zDc(na.cellTextEditBox.textBox.pG);!this.jc&&Ra&&Ra.w0d&&(this.text="");this.jc?(window.setTimeout(()=>{if(this.Ob&&na.Ob){na.Ob&&na.cellTextEditBox.textBox.detachCursorFormat();if(!this.rF(null)){const da=na.cellTextEditBox.formattedText;var ka=this.textBox.caretPosition;const kb=da.Text.length;ka=this.textBox.text.length!==kb?kb:ka;this.formattedText=da;this.textBox.caretPosition=
ka}this.B$a=!1;this.textBox.clearHistory()}else this.Ob=!1},0),na.cellTextEditBox.pUd()):(Ca||(this.Zjb(),this.rF(null)),na.cellTextEditBox.pUd(),this.B$a=!1)};if(na.Ob)na.sG=1,Ka();else if(this.textBox.JG=!0,Z.TaskExtensions.za(na.startEdit(!1,1,va,!1,void 0,Ca,1),ib=>{ib.result?(na.Ob||(this.textBox.addErrorLogRecord("FormulaBar.StartEdit","tag_cnkc7"),c.ULS.sendTraceTag(37003425,0,10,"FormulaBar.StartEdit: grid.IsEditing is false after calling grid.StartEdit. Stack=")),this.Ob&&na.Ob?(na.cellTextEditBox.textBox.JG=
!0,ib=na.tc(null),this.textBox.K5e(Number.NaN,this.Jnd(ib)),Xa&&this.textBox.setCaretPositionToEnd(),Ka()):this.Ob=!1):this.Ob=!1},this.ka,11),this.textBox.JG=!1,va=na.tc(null),null===va||void 0===va?0:va.Fxd)this.textBox.addEventLogRecord("FormulaBar.StartEditStripOutLegacyArrayCurlyBraces"),this.text=ra.HelperMethods.omg(this.text)}}Ff(Xa,Ca){super.Ff(Xa,Ca);this.XYd()}MVa(Xa){xa.EwaSettings.isChangeGateEnabled("OfficeVSO:7549189_logsForNullTextboxInvestigation")&&c.ULS.sendTraceTag(509445518,0,
50,`FormulaBar.set_textBox: Setting the text box for the formula bar, textBox defined: ${!!Xa}`);super.MVa(Xa)}XYd(){const Xa=this.grid;Xa.Ob&&2===Xa.sG||this.GDa()}Uf(){var Xa=this.grid;this.Ob&&Xa.Ob&&(Xa=Xa.Gc,Xa.text=this.text,Xa.setCaretPosition(this.textBox.caretPosition),this.inRangePicker&&this.textBox.focus())}GDa(){this.jc?this.yog():this.kfg()}kfg(){if(this.textBox){var Xa=this.grid;this.textBox.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal",{["IsEditing"]:this.Ob,["TextBox.Initialized"]:this.textBox.initialized,
["Grid.IsEditing"]:Xa.Ob});if(!this.Ob){var Ca=Ja.a(this.$).Zq();this.Ep.disabled=Ca||!this.$.isEditMode;var va=(Ca=this.$.N_===Xa)&&1===Xa.ga.rf;this.textBox.initialized&&(this.textBox.disabled=this.Ep.disabled||Ca&&!va);Ca=new Nb.a(this.textBox.style);var na=!1;if(va)if(Xa.Ob)this.textBox.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["ActiveCellContents"]:"CellTextEditBox.Text"}),va=Xa.cellTextEditBox.text;else{na=Xa.tc(null);va=new R.a(this.$.ua);if(!na||
!va.uGb(na.range,Xa))return;Xa=va.ki;va=na.Ei;var Ka=na.formulaBarText;const ib=na.text;this.textBox.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["sheetProtection.IsLocked"]:Xa,["activeCell.IsHidden"]:va,["activeCell.FormulaBarText"]:!!Ka,["activeCell.Text"]:!!ib});va=Xa&&va?"":Ka||ib;na=na.w0d}else va="",Ka=Xa.ga.Sa.Pc,Ka=(null===Ka||void 0===Ka?0:Ka.floatingObject)?Ka.floatingObject.nc:null,64===Xa.ga.rf&&Ka&&Ka.IsShapeFormulaPresent&&((Xa=(Xa=Ka.ShapeText)?
Xa.substring(Xa.indexOf("\nFormula:")+9,Xa.indexOf(";FormulaVal:")):null)?(this.textBox.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["ActiveCellContents"]:"ShapeFormula"}),va="="+Xa):c.ULS.sendTraceTag(537161938,0,15,"FormulaBar.setTextBoxForActiveItemInternal: IsShapeFormulaPresent is true but formula not found in shapeText"));this.Ieg(na);this.uZb=this.e7c();Ca.jD.direction=this.g$a?w.a.rtl:w.a.Obb;Ca.jD.textAlign=this.g$a?w.a.right:w.a.left;Ca.h5();this.text=
va}}}Mdg(){var Xa=this.$.N_;if(this.owd){const Ca=!!this.grid.sL&&this.grid.sL.nG;this.isVisible=Xa=!!Xa&&this.$.okd&&!this.$.ea.Rc.inEmbedView;Ca||(this.textBox.isVisible=Xa)}else this.isVisible=!!Xa&&this.$.okd&&!this.$.ea.Rc.inEmbedView;this.$.rC(t.a.JSb);this.$.TJ()}Ieg(Xa){E.DOMElementExtensions.toggleCssClass(this.textBox.domElement,m.bIh,Xa)}hya(){return this.Ep.querySelectorAll(E.DOMElementExtensions.Nr+", div[tabindex]")}Bm(){return E.DOMElementExtensions.Bm(this.hya())}vVh(){const Xa=this.Bm();
return Xa?(E.DOMElementExtensions.setFocus(Xa),!0):!1}WXf(Xa,Ca){Ca=-287251124===Ca||-1925065947===Ca||1764140053===Ca;Da.a.IQa()&&Ca&&Xa.preventDefault()}x3c(){qa.Mxa&&E.DOMElementExtensions.toggleCssClass(qa.Mxa,m.qGe,!this.$.isEditMode)}zDc(Xa){this.jc&&(this.textBox.pG=Xa)}toggleEditingEvents(Xa){this.textBox.toggleEditingEvents(Xa)}$ui(Xa,Ca=null){this.Ep?this.pQa?xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InitNameBoxEagerly",!1)?this.UDb():xa.EwaSettings.isChangeGateEnabled("OfficeVSO:7134788_FixingNameBoxReliabliity")?
this.$.ea.fg?this.UDb():this.$.ea.yk(this.UDb):this.$.ea.yk(this.UDb):Xa.da.Qb(53,va=>{Z.TaskExtensions.za(L.GetServiceTaskFactory.create(Xa.da,102,this.ka,1),na=>{this.Rui(Xa,va,na.result,this.Ep,Ca)},this.ka)}):this.ITd()}S6f(){Qa.PageLoadTrackingInfo.instance.w2(t.a.$la,this.CGd);Qa.PageLoadTrackingInfo.instance.oY(t.a.$la,this.CGd);Qa.PageLoadTrackingInfo.instance.nY(t.a.$la,this.CGd)}ITd(){c.ULS.sendTraceTag(537161947,0,50,"FormulaBar.ctor: this.formulaBarElement is null (probably after dispose)")}jvf(Xa){return this.lnc&&
!this.l9d&&(125627505===Xa||706199415===Xa)}get text(){return super.text}static Ehc(Xa){return document.getElementById(Xa.qc+t.a.i5a)}static AOj(Xa){const Ca=xa.EwaSettings.jc(),va=qa.Ehc(Xa);va.classList.add(m.DZe);qa.Mxa=qa.xPe(Xa.qc);const na=qa.nac(Ca,!0),Ka=qa.tPe();Ka.appendChild(qa.Mxa);Ka.appendChild(na);const ib=qa.aQe(Xa.qc),Ra=qa.$Pe(Xa.qc),ka=qa.UOe(Xa.qc);ib.appendChild(Ra);ib.appendChild(ka);Ka.appendChild(ib);Xa=qa.SPe(Xa.qc);va.appendChild(Xa);va.appendChild(Ka);const da=new Tb.a(na,
Ca,!1);da.qR(()=>{Db.c(da.Gf,l.a.ariaLabel,"formula bar")});da.isVisible=!1;return da}static tPe(){const Xa=document.createElement("div");Xa.className=m.XHh;Xa.classList.add(m.KR);return Xa}static aQe(Xa){const Ca=document.createElement("div");Ca.id=Xa+qa.$Hf;Ca.className=m.Rtc;Ca.classList.add(m.KR);return Ca}static nac(Xa,Ca){const va=Da.a.IQa(),na=document.createElement(va?"div":"textarea");na.className=m.cIh;Ca&&Xa&&na.classList.add(m.eIh);Xa?na.classList.add(m.xZi):(na.setAttribute(x.a.autoCorrect,
v.a.off),na.setAttribute(x.a.wrap,v.a.virtual),na.setAttribute(x.a.spellcheck,v.a.Vra),E.DOMElementExtensions.xy(na,t.a.s2a),na.tabIndex=0);va?(na.id=t.a.Wzb,Xa||na.setAttribute(x.a.contentEditable,v.a.F8d)):(na.cols=20,na.rows=2);return na}static xPe(Xa){const Ca=document.createElement("div");Ca.id=Xa+t.a.Yfc;Ca.className=m.K6e;E.DOMElementExtensions.xy(Ca,t.a.Au);Ca.setAttribute(t.a.xv,"insert function");Ca.tabIndex=0;Ca.classList.add(m.KR);return Ca}static $Pe(Xa){const Ca=document.createElement("div");
Ca.id=Xa+qa.qId;Ca.className=m.aIf;E.DOMElementExtensions.xy(Ca,t.a.Au);Ca.setAttribute(t.a.xv,"commit edit");Ca.tabIndex=0;Ca.classList.add(m.KR);return Ca}static UOe(Xa){const Ca=document.createElement("div");Ca.id=Xa+qa.s7c;Ca.className=m.lIe;E.DOMElementExtensions.xy(Ca,t.a.Au);Ca.setAttribute(t.a.xv,"cancel edit");Ca.tabIndex=0;Ca.classList.add(m.KR);return Ca}static SPe(Xa){const Ca=document.createElement("div");Ca.id=Xa+t.a.nkd;Ca.className=m.aIh;return Ca}}qa.$Hf="okCancelButtonContainer";
qa.qId="okboxButton";qa.s7c="cancelboxButton";qa.Mxa=null;Object(r.a)(qa,"FormulaBar",u.a,[26])},901:function(r,C,a){var c=a(74);r=a(0);class b{constructor(){this.Rhb=!1;this.fullName=this.name=this.scope=null}}Object(r.a)(b,"NamedObjectDetails",null,[]);var e=a(186),f=a(129),d=a(23);a.d(C,"b",function(){return h});a.d(C,"a",function(){return l});a.d(C,"c",function(){return k});const h=(u,v,x,w=!1)=>{for(let m=0,t=u.count;m<t;m++){const z=u.getItem(m),y=2===z.type?e.a(z):z.usedRange,D=w&&2===z.type?
z.usedRange:null;if((y.equals(v)||v.equals(D))&&z.sheetName===x)return z}return null},l=u=>{const v=new b;v.fullName=u;u=f.c(u.split(RegExp("[!']")),x=>!d.a.equals(x,"",!0));2===u.length?(v.Rhb=!0,v.scope=u[0],v.name=u[1]):(v.Rhb=!1,v.scope="",v.name=u[0]);return v},k=(u,v=!1)=>u&&c.h(u)?(u.activate(v),!0):!1}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSOpt.vrd.js.map/6b25c2bf85db85415c174f5a43118dc6/EwaDSOpt.vrd.js.map