'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[21],{1190:function(r,C,a){a.d(C,"a",function(){return b});var c=a(522);const b=()=>{c.a.sj(".ewa-svg-icon{height:100%;width:100%}")}},1191:function(r,C,a){a.d(C,"a",function(){return b});var c=a(522);const b=()=>{c.a.sj('.ewa-stb-uir{background-color:#f5f5f5;height:32px}.grid-visual-refresh .ewa-stb-ltr,.grid-visual-refresh .ewa-stb-rtl{background-color:#f5f5f5}.ewa-stb-drag{cursor:pointer}.ewa-stb-navarea{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-uir .ewa-stb-navarea-dimensions{height:32px}.ewa-stb-ltr .ewa-stb-navarea{left:0}.ewa-stb-rtl .ewa-stb-navarea{right:0}a.ewa-stb-navbutton.cui-disabled:focus{outline:auto 1px}.ewa-stb-navareaextra a.ewa-stb-navbutton:focus-visible{outline-offset:-1px}.ewa-stb-navbutton{border:0;padding:0;margin:0;width:27px;height:27px}.ewa-stb-uir .ewa-stb-navbutton{width:24px;height:24px;margin:4px;border-radius:2px}.ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#e1dfdd}.ewa-stb-uir .ewa-stb-navbutton:active{background-color:#bebbb8}.ewa-stb-ltr .ewa-stb-navbutton{float:left}.ewa-stb-rtl .ewa-stb-navbutton{float:right}.ewa-stb-navbutton .clip16x16{display:inline-block;margin:5px 6px 6px 5px}.ewa-stb-uir .ewa-stb-navbutton .clip12x12{display:inline-block;margin:6px}.ewa-stb-uir .cui-disabled svg{fill-opacity:.3}.ewa-stb-navbutton.cui-disabled .cui-img-container{opacity:.3}.ewa-stb-navareaextra{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-contentarea{position:relative;flex:0 1 auto;min-width:0%;top:0;left:0;right:0;border:0;height:27px;padding:0;margin:0;white-space:nowrap}.ewa-stb-uir .ewa-stb-contentarea{height:32px}.ewa-stb-uir .ewa-stb-left-scrollable.ewa-stb-contentarea::before{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-uir .ewa-stb-right-scrollable.ewa-stb-contentarea::after{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(-90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-tabarea{position:relative;top:0;height:27px;left:0;right:0}.ewa-stb-uir .ewa-stb-tabarea{height:32px}.ewa-stb-sheettabmoveindicator{position:absolute;top:-4px}.ewa-stb-tabs{display:block;height:27px;list-style:none;left:0;right:0;margin:0;padding:0;overflow-x:scroll;overflow-y:hidden;white-space:nowrap}.ewa-stb-uir .ewa-stb-tabs{height:32px}.ewa-stb-tabs-smooth{scroll-behavior:smooth}@media(prefers-reduced-motion:reduce){.ewa-stb-tabs{scroll-behavior:auto}}.ewa-stb-tabs .tab-active,.ewa-stb-tabs .tab-inactive{background-color:#f6f6f6;background-image:none;border:0 solid #ababab;border-left-width:1px;padding:0;height:22px;margin:2px 0 3px 0;display:inline-block;overflow:hidden;transform:translateX(0);transition:transform .2s}.ewa-stb-tabs .tab-active{border-bottom-width:2px;border-bottom-color:#217346;border-bottom-style:solid;margin:2px 0 3px 0;height:20px;background-color:#f6f6f6;transform:translateX(0);transition:transform .2s}.ewa-stb-uir .tab-active,.ewa-stb-uir .tab-inactive{background-color:#f5f5f5;border:0;margin:0;height:32px}.ewa-stb-uir .tab-hover{background-color:#e1dfdd}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active{background-color:Highlight;forced-color-adjust:none}}.ewa-stb-tabs .tab-active.ewa-stb-tabs-ghost,.ewa-stb-uir .ewa-stb-tabs-ghost{position:fixed;z-index:1000;border-right-width:1px;transition:none}.ewa-stb-tabs .tab-anchor-text{text-decoration:none;white-space:nowrap;height:22px;display:block}.tab-anchor-text:focus-visible{outline-offset:-1px}.ewa-stb-uir .tab-anchor-text{height:32px}.ewa-stb-tabs .dark{color:#444;white-space:pre;height:18px}.ewa-stb-tabs .light{color:#fff;white-space:pre;height:18px}.ewa-stb-tabs .tab-active-text{color:#217346;height:14px}.ewa-stb-uir .tab-active-text{color:#444;line-height:16px;padding-bottom:5px}.ewa-stb-uir .tab-active .tab-content-container::before{content:"";position:absolute;display:inline-block;top:0;bottom:0;left:0;right:0;color:rgba(0,0,0,0);border-bottom:3px solid #217346;padding-bottom:5px;width:calc(100% - 18px);margin:auto;transition:width 400ms cubic-bezier(.17,.17,0,1) 0s}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active .tab-content-container::before{border-bottom-color:HighlightText}.ewa-stb-uir .tab-active svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-stb-uir .tab-active.tab-hover .tab-content-container:hover::before{width:calc(100%)}.ewa-stb-tabs .tab-text,.ewa-stb-tabs .tab-content-container{white-space:pre;font-size:10pt;display:inline-block;text-align:center;margin-bottom:0}.ewa-stb-tabs .tab-content-container{padding:0 18px 0 18px;margin:0 2px 0 2px}.ewa-stb-uir .tab-content-container{padding:3px 6px 3px 6px;border-radius:2px;margin:2px 3px 2px 3px;font-size:14px}.ewa-stb-tabs .cui-img-container{top:1px}.ewa-stb-tabs .tab-content-container .clip12x12,.ewa-stb-tabs .tab-content-container .clip16x16,.ewa-stb-tabs .tab-content-container .clip24x16{display:inline-block}.ewa-stb-nsv-inactive{opacity:.7}.ewa-stb-nsv-inactive-svg{fill-opacity:.7}.ewa-stb-nsv-active{opacity:1}.ewa-stb-nsv-active-svg{fill-opacity:1}.ewa_nsv_margin{margin-left:4px !important;height:14px}.ewa-stb-rtl .ewa_nsv_margin{margin-left:0 !important;margin-right:4px !important}@media screen and (-ms-high-contrast:active){.ewa-stb-tabs .tab-active-text{color:ButtonText}}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active-text{color:HighlightText}}.ewa-stb-disable-scrollbar *::-webkit-scrollbar{display:none}.ewa-stb-disable-scrollbar *{scrollbar-width:none}.leave-size-fixed-on-tab-hover-old::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden}.leave-size-fixed-on-tab-hover::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden;height:0}.ewa-stb-locked-sheet{margin-right:4px !important;height:13px !important;width:12px !important}.ewa-stb-tabs .ewa-stb-locked-sheet-svg-16px{margin-right:4px}.ewa-stb-rtl .ewa-stb-locked-sheet{margin-right:0 !important;margin-left:4px !important}.ewa-stb-dropdown-menu-button{position:relative;display:inline-block;padding:0;margin:0;border:0}.ewa-active-sheet-menu-item{background-color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir,.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive,.ewr-presentMode-on .ewa-stb-uir .tab-active,.ewr-presentMode-on .ewa-stb-uir .tab-inactive,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-rtl{background-color:#3b3a39}.ewr-presentMode-on .ewa-stb-uir .tab-hover,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#484644}.ewr-presentMode-on .ewa-stb-tabs .tab-active :focus,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive :focus,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton.cui-disabled:focus{background-color:#3b3a39 !important;border:1px solid #e5e5e5 !important}.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-active-text{border-bottom-color:#37a660}.ewr-presentMode-on .ewa-stb-uir .tab-active .tab-content-container::before{border-bottom:3px solid #37a660}.ewr-presentMode-on .ewa-stb-tabs .light{color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir .tab-active-text{color:#f3f2f1}.ewa-active-sheet-menu-item-present-mode{background-color:#605e5c}.ewr-presentMode-transition .ewa-stb-uir,.ewr-presentMode-transition .ewa-stb-tabs .tab-active,.ewr-presentMode-transition .ewa-stb-tabs .tab-inactive,.ewr-presentMode-transition .ewa-stb-uir .tab-active,.ewr-presentMode-transition .ewa-stb-uir .tab-inactive,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-rtl{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-stb-tabs .light,.ewr-presentMode-transition .ewa-stb-uir .tab-active-text{transition:color .4s linear}')}},
1206:function(r,C,a){var c=a(10),b=a(0),e=a(724),f=a(52),d=a(40),h=a(199),l=a(63);class k{constructor(tb){this.ZAh=tb}yd(){return!1}executeCommand(tb,gc){tb=gc.command;gc=null;switch(tb){case 1243860697:this.ZAh.f8j();break;default:gc=h.a(tb)}return gc||l.Task.Ua(!0)}fd(tb,gc){return 1243860697===gc.command}Cd(){return!1}}Object(b.a)(k,"SheetDropdownMenuCommandHandler",null,[210]);var u=a(72),v=a(149),x=a(35);class w extends e.a{constructor(tb){super(tb)}ue(){Object(u.b)("OfficeVSO:7624897_MigrateContextMenuController")?
void v.a.resolve(x.mb,{Wa:this.La}).then(()=>{d.TaskExtensions.za(f.GetServiceTaskFactory.Za(this.$.da,32,33,this.La),tb=>{this.Zd([new k(tb.result.ogg)])},this.$.ka)}):this.$.wz(tb=>{tb.tlc().then(()=>{d.TaskExtensions.za(f.GetServiceTaskFactory.Za(this.$.da,32,33,this.La),gc=>{this.Zd([new k(gc.result.ogg)])},this.$.ka)})})}static la(tb){e.a.Ie(392,new w(tb))}}Object(b.a)(w,"SheetDropdownMenuCommandHandlerFactory",e.a,[]);var m=a(230),t=a(7),z=a(83),y=a(15),D=a(31),H=a(180),F=a(14),G=a(92),L=a(49),
M=a(250),O=a(170),B=a(113),E=a(41),I=a(425),S=a(126),J=a(16),K=a(38);class R{constructor(){this.oUe=new K.a(!0);this.LPc=0}get Sdd(){return this.LPc}get navigationButtonsDisabled(){return!!(this.Sdd&1)}get operationButtonsDisabled(){return!!(this.Sdd&2)}W1g(tb,gc){this.oUe.add(tb,gc);this.cU()}cU(){this.LPc=0;K.a.forEach(this.oUe.Pt,tb=>{this.LPc=this.Sdd|tb.value})}}Object(b.a)(R,"SheetTabBarDisabledStateManager",null,[]);var Z=a(249),P=a(36);class V{}V.WKh="ewa-stb-uir";V.IKh="ewa-stb-navarea";
V.JKh="ewa-stb-navarea-dimensions";V.LKh="ewa-stb-navbutton";V.MV="cui-disabled";V.KKh="ewa-stb-navareaextra";V.Oka="cui-img-container";V.CKh="ewa-stb-contentarea";V.r_e="ewa-stb-left-scrollable";V.w_e="ewa-stb-right-scrollable";V.UKh="ewa-stb-tabarea";V.TKh="ewa-stb-sheettabmoveindicator";V.y_e="ewa-stb-tabs";V.M4j="tab-active";V.U4j="tab-inactive";V.T4j="tab-hover";V.VKh="ewa-stb-tabs-ghost";V.O4j="tab-anchor-text";V.dark="dark";V.light="light";V.N4j="tab-active-text";V.R4j="tab-content-container";
V.W4j="tab-text";V.NKh="ewa-stb-nsv-inactive-svg";V.MKh="ewa-stb-nsv-active-svg";V.uJh="ewa_nsv_margin";V.DKh="ewa-stb-disable-scrollbar";V.nNi="leave-size-fixed-on-tab-hover-old";V.mNi="leave-size-fixed-on-tab-hover";V.s_e="ewa-stb-locked-sheet-svg-16px";V.EKh="ewa-stb-dropdown-menu-button";V.wFh="ewa-active-sheet-menu-item";Object(b.a)(V,"CssClassNames",null,[]);var Ea=a(766),oa=a(20),ea=a(273),aa=a(94),ia=a(201),ya=a(30),za=a(260),la=a(48),xa=a(297),wa=a(54),hb=a(13),Ja=a(76),Fa=a(1),Ba=a(327),
fa=a(12),ta=a(107),Oa=a(358),Ma=a(19),fb=a(185),pa=a(383),Ua=a(379),Sa=a(50),Ia=a(232),X=a(90);class ca extends Z.a{constructor(tb,gc,Xb=!1){super(tb);this.Ceb=this.Dva=null;this.$=gc;this.sZ=Xb}get disabled(){return this.sZ}dispose(){this.Ceb=this.Dva=this.$=null;super.dispose()}YT(tb){this.sZ=tb;this.domElement.setAttribute(t.a.ova,tb.toString());hb.DOMElementExtensions.toggleCssClass(this.domElement,Ea.a.MV,tb)}}Object(b.a)(ca,"SheetBarButton",Z.a,[]);var U=a(739);class ma extends ca{constructor(tb,
gc,Xb,Ga=!1){super(document.createElement("a"),gc,Ga);this.Ud=Za=>{this.disabled||this.$.Ed(-1935155518,Za.kc,30,null);return!0};this.iKd=Za=>{Za="mouseover"===Za.type||"focus"===Za.type;const Sb=pa.a(this.$)?this.Ceb:this.Dva;fa.HelperMethods.lpg(Sb,ma.dka,ma.dka+t.a.ctd,Za&&!Ma.h(this.$).inRangePicker)};this.Ui=()=>{this.YT(!0)};this.Ug=()=>{Fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DetachEndEditInsertSheetButtonListener",!1)&&Ma.h(this.$).cellTextEditBox.Ob||this.YT(!1)};this.Dva=
Xb.Vb(this.domElement,J.a.instance.ha(509),0,ma.dka,J.a.instance.ha(510),U.a.g$c,Ga);tb.appendChild(this.domElement);this.Dd.la("contextmenu",Za=>{Ja.g(Za)});Ia.a.instance.ta(F.a.click,this.domElement,this.Ud);this.eoa=B.KeyInputManager.instance.ev(this.domElement,this.Ud,X.a.Li,X.a.YY);Ma.h(this.$).cellTextEditBox.ro(this.Ui);Fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DetachEndEditInsertSheetButtonListener",!1)?Ma.h(this.$).cellTextEditBox.x4b(this.Ug):Ma.h(this.$).cellTextEditBox.Pm(this.Ug)}dispose(){Ia.a.instance.Aa(F.a.click,
this.domElement,this.Ud);B.KeyInputManager.instance.By(this.domElement,this.eoa);Ma.h(this.$)&&Ma.h(this.$).cellTextEditBox&&(Ma.h(this.$).cellTextEditBox.io(this.Ui),Fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DetachEndEditInsertSheetButtonListener",!1)?Ma.h(this.$).cellTextEditBox.tSd(this.Ug):Ma.h(this.$).cellTextEditBox.fn(this.Ug));super.dispose()}YT(tb){const gc=ma.Ugg(this.$);super.YT(tb||gc)}static Ugg(tb){return!tb.isEditMode||!tb.ua.count}}ma.dka=oa.a.Sgd;Object(b.a)(ma,
"InsertSheetButton",ca,[]);class ra extends ca{constructor(tb,gc,Xb){super(document.createElement("a"),gc);this.Ud=Ga=>{this.$.Ed(-684145703,Ga.kc,0,null);return!0};this.iKd=Ga=>{fa.HelperMethods.lpg(this.rGe,ra.dka,ra.dka+t.a.ctd,("mouseover"===Ga.type||"focus"===Ga.type)&&!Ma.h(this.$).inRangePicker)};this.$=gc;this.rGe=Xb.Vb(this.domElement,J.a.instance.ha(511),0,ra.dka,J.a.instance.ha(512),U.a.g$c);tb.appendChild(this.domElement);this.Dd.la("contextmenu",Ga=>{Ja.g(Ga)});this.Dd.la("mouseover",
this.iKd);this.Dd.la("mouseout",this.iKd);Ia.a.instance.ta(F.a.click,this.domElement,this.Ud);this.eoa=B.KeyInputManager.instance.ev(this.domElement,this.Ud,X.a.Li,X.a.YY)}dispose(){Ia.a.instance.Aa(F.a.click,this.domElement,this.Ud);B.KeyInputManager.instance.By(this.domElement,this.eoa);this.rGe=null;super.dispose()}}ra.dka=oa.a.Sgd;Object(b.a)(ra,"InsertTemplateButton",ca,[]);class Va{constructor(tb,gc){this.sheetName=null;this.newSheetIndex=0;this.sheetName=tb;this.newSheetIndex=gc}getSheetName(){return this.sheetName}}
Object(b.a)(Va,"MacroRecorderSheetReorderedPayload",null,[144]);var ob=a(91);class ja extends Z.a{constructor(tb,gc){super(document.createElement("div"));this.gT=()=>{y.ULS.sendTraceTag(537153794,0,50,"SheetDropdownMenu.OnSheetsChanges");this.f6f(!1,"OnSheetsChanged")};this.v4i=()=>{this.vj()};this.u4i=()=>{this.xj()};this.$=tb;this.u5j=gc;this.nW=!1;this.bUb=0}dispose(){this.xj();super.dispose()}f8j(){this.f6f(!0,"TogglerSheetDropdownMenu")}f6f(tb,gc){y.ULS.sendTraceTag(537153795,0,50,`SheetDropdownMenu.RenderSheetMenuInternal: render start. caller: ${gc}, toggle: ${tb}, toggleStateId: ${this.bUb}`);
tb&&(this.bUb+=1);const Xb=this.$.yc.Fd("UserAction",`SheetDropdownMenu.RenderSheetMenuInternal: caller: ${gc}, toggle: ${tb}, toggleStateId: ${this.bUb}, sheetCount: ${this.$.ua.count}`);tb=this.Urh();appChrome.renderSheetDropdownMenu(this.domElement,this.u5j,tb,this.bUb,this.v4i,this.u4i,()=>{Xb.stop()},pa.a(this.$))}Urh(){const tb=this.$.ua,gc=[];for(let Ga=0;Ga<tb.count;Ga++){var Xb=Object(S.a)(ta.a,tb.getItem(Ga));0===Xb.qB&&(Xb=this.Trh(Xb),gc.push(Xb))}return gc}Trh(tb){const gc={};gc.key=
tb.name;gc.text=tb.name;gc.onClick=this.Vrh(tb);tb.active&&(gc.className=pa.a(this.$)?"ewa-active-sheet-menu-item-present-mode":V.wFh);return gc}Vrh(tb){return()=>{const gc=new ob.a(-1876836819,0,this.$.Tc,30,null);this.$.Ia.mc(gc,{[t.a.TZd]:tb.name})}}vj(){if(!this.nW){const tb=this.$.ua;tb.Vg(this.gT);tb.w2c(this.gT);tb.e_(this.gT);tb.yja(this.gT);tb.jJa(this.gT);tb.xye(this.gT);tb.A1a(this.gT);this.nW=!0}}xj(){if(this.nW){const tb=this.$.ua;tb.xh(this.gT);tb.oSd(this.gT);tb.R9(this.gT);tb.Qpa(this.gT);
tb.pUa(this.gT);tb.g5f(this.gT);tb.COb(this.gT);this.nW=!1}}}Object(b.a)(ja,"SheetDropdownMenu",Z.a,[475,2]);var lb=a(362);class wb extends ca{constructor(tb,gc,Xb){super(document.createElement("a"),tb,!0);this.Tg=()=>{this.YT(!1);this.$.ea.en(this.Tg)};this.Ud=Ga=>{this.mpg(Ga.kc);return!0};this.onKeyDown=Ga=>13===Ga.Da.keyCode||32===Ga.Da.keyCode?(this.mpg(Ga.kc),!0):!1;this.Dva=gc.Vb(this.domElement,J.a.instance.ha(513),0,oa.a.BKh,J.a.instance.ha(513),U.a.lki,this.disabled);this.domElement.classList.add(V.EKh);
Xb.appendChild(this.domElement);this.dDh();this.Vtj()}dispose(){this.ick();super.dispose()}YT(tb){super.YT(tb||!this.$.ea.xna)}dDh(){const tb=this.$.ea;tb.fg?this.YT(!1):tb.yk(this.Tg)}mpg(tb){this.disabled||(y.ULS.sendTraceTag(537153793,0,50,`SheetDropdownMenuAnchor.ToggleMenu: inputMethod: ${lb.a[tb]}`),this.$.Ia.mc(new ob.a(1243860697,tb,this.$.Tc,30,null)))}Vtj(){Ia.a.instance.ta(F.a.click,this.domElement,this.Ud);B.KeyInputManager.instance.ta(F.a.Ic,this.domElement,this.onKeyDown)}ick(){Ia.a.instance.Aa(F.a.click,
this.domElement,this.Ud);B.KeyInputManager.instance.Aa(F.a.Ic,this.domElement,this.onKeyDown)}}Object(b.a)(wb,"SheetDropdownMenuAnchor",ca,[]);var Ab=a(59);const nb=(tb,gc,Xb,Ga,Za,Sb,sb,bc=null)=>{bc=tb.Pa(9,bc);bc.sheetName=gc;bc.newSheetIndex=Xb;return Ab.g(tb,"ReorderSheets",bc,Ga,Za,Sb,sb,0)};var pb=a(187),cb=a(145),Da=a(198),zb=a(136),qb=a(58),Pa=a(217),Nb=a(209),Tb=a(182),Vb=a(137);class Jb{constructor(tb){this.sheet=tb;this.altText=J.a.instance.ha(1994)}qX(){return this.sheet.active}txd(){return this.sheet.isLockPausedInSession}fra(){return this.sheet.ki?
U.a.nZf:U.a.Vbk}m3d(){return 16}Pva(){return null}Qva(){return V.s_e}T4d(){return null}eu(){return null}e4c(){return!0}}Object(b.a)(Jb,"LockPausedSheetIconDataSource",null,[438]);class Qa{constructor(tb){this.sheet=tb;this.altText=J.a.instance.ha(1993)}qX(){return this.sheet.active}txd(){return this.sheet.ki}fra(){return U.a.nZf}m3d(){return 16}Pva(){return null}Qva(){return V.s_e}T4d(){return null}eu(){return null}e4c(){return!0}}Object(b.a)(Qa,"LockedSheetIconDataSource",null,[438]);class Db{constructor(tb,
gc,Xb){this.sheet=tb;this.altText=J.a.instance.ha(1908);this.u8j=gc;this.VWj=Xb}qX(){return this.sheet.active}txd(){return this.sheet.Ze.yC}Pva(){return this.qX()?V.MKh:V.NKh}fra(){return!this.qX()&&this.VWj()?U.a.sTj:U.a.rTj}m3d(){return 14}Qva(){return V.uJh}T4d(){return this.sheet.Ze.Brb}eu(){return this.u8j}e4c(){return!1}}Object(b.a)(Db,"NamedSeetViewSheetIconDataSource",null,[438]);var sa=a(172),Ha=a(141);class mb{constructor(tb,gc){this.WUc=this.a4=this.hEa=this.qq=null;this.Btf=!1;this.GZc=
this.fra=this.Qva=this.Pva=null;this.hP=()=>{this.dataSource.qX()&&d.TaskExtensions.za(this.yzf,()=>{dialogControls.renderToolTip(this.dataSource.eu(),"SheetIconTooltip",this.dataSource.T4d(),this.TT,10,!1,!1,1)},this.$.ka,3)};this.gP=()=>{this.dataSource.qX()&&this.clearToolTip()};this.$=tb;this.dataSource=gc}get Dd(){return this.a4||(this.a4=Ha.a.instance.Re(this.TT))}get yzf(){if(this.WUc)return this.WUc;const tb=new sa.a;this.$.wz(gc=>{d.TaskExtensions.za(gc.izf(),()=>{tb.setResult(!0)},this.$.ka,
3)});return this.WUc=tb.task}get TT(){return this.GZc}Ptg(){if(this.TT&&(this.qq||this.hEa)){var tb=this.dataSource.fra();this.fra!==tb&&(this.hEa&&this.hEa.parentNode.removeChild(this.hEa),this.rnf(),this.fra=tb);tb=this.dataSource.Pva();this.Pva!==tb&&(this.aBj(this.hEa,this.Pva,tb),this.Pva=tb);tb=this.dataSource.Qva();this.Qva!==tb&&(this.$Aj(this.TT,this.Qva,tb),this.Qva=tb);this.dataSource.eu()&&!this.dataSource.qX()&&this.clearToolTip()}}oYj(tb,gc,Xb){this.Avi(tb,gc,Xb);hb.DOMElementExtensions.setVisible(this.TT,
this.dataSource.txd())}clearToolTip(){d.TaskExtensions.za(this.yzf,()=>{dialogControls.clearToolTip(this.dataSource.eu())},this.$.ka,3)}Avi(tb,gc,Xb){this.TT&&this.Btf!==tb&&(this.TT.parentNode.removeChild(this.TT),this.Qva=this.Pva=this.fra=this.GZc=null,this.dataSource.eu()&&(this.Dd.detach("mouseover",!0),this.Dd.detach("mouseout",!0)));this.TT||(this.GZc=document.createElement("span"),Sys.UI.DomElement.addCssClass(this.TT,Ea.a.Oka),Sys.UI.DomElement.addCssClass(this.TT,oa.a.aE),tb===this.dataSource.e4c()?
gc.appendChild(this.TT):gc.insertBefore(this.TT,Xb),this.rnf(),this.dataSource.eu()&&(this.Dd.la("mouseover",this.hP,!0),this.Dd.la("mouseout",this.gP,!0)),this.Btf=tb)}aBj(tb,gc,Xb){tb&&(Sys.UI.DomElement.removeCssClass(tb,gc),Sys.UI.DomElement.addCssClass(tb,Xb))}$Aj(tb,gc,Xb){gc&&Sys.UI.DomElement.removeCssClass(tb,gc);Xb&&Sys.UI.DomElement.addCssClass(tb,Xb)}dispose(){G.a.Ka(this.a4)}rnf(){const tb=this.$.da.Ba(388);tb?(this.hEa=tb.Ima(this.dataSource.fra(),this.dataSource.m3d()))?this.TT.appendChild(this.hEa):
y.ULS.shipAssertTag(537153763,0,!1,`Sheeticon.InsertCurrentSvgIcon: Svg with id ${this.dataSource.fra()} was not found.`):y.ULS.shipAssertTag(537153792,0,!1,"Sheeticon.InsertCurrentSvgIcon: Unable to recieve SvgIconProvider service.")}}Object(b.a)(mb,"SheetIcon",null,[2]);var qa=a(364),Xa=a(101),Ca=a(168);class va extends Xa.a{constructor(tb,gc){super(tb.domElement);this.onKeyDown=Xb=>{121===Xb.keyCode&&Xb.shiftKey&&!this.Jqa.disabled&&(this.showContextMenu(new Sys.UI.Point(0,0),1,this.Jqa.anchor),
Ja.g(Xb))};this.ofa=Xb=>{if(!this.$.isEditMode||this.Jqa.disabled)return!0;this.rename(!1,Xb.kc);return!0};this.Zm=Xb=>this.Jqa.disabled?!0:this.showContextMenu(Xb.clientPoint,Xb.kc,Xb.Fc);this.ure=tb;this.$=gc;Ia.a.instance.ta(F.a.nl,tb.domElement,this.ofa);qa.a.instance.ta(tb.domElement,this.Zm);this.Dd.la("keydown",this.onKeyDown)}get Jqa(){return this.ure}dispose(){this.Jqa&&(Ia.a.instance.Aa(F.a.nl,this.Jqa.domElement,this.ofa),qa.a.instance.Aa(this.Jqa.domElement,this.Zm),this.ure=null);this.$=
null;super.dispose()}showContextMenu(tb,gc,Xb){this.Jqa.activate(gc,ya.a.ivf());gc=new ob.a(-1075099431,gc,this.$.Tc,30,null);let Ga;return!Ca.a(Ga=this.$.Ia.mc(gc,{[t.a.qgg]:tb,[va.iTj]:this.Jqa.sheet,[t.a.rgg]:Xb}))&&(6!==Ga.status||Ga.result)}rename(tb,gc){this.$.Ed(817296323,gc,tb?19:0,null)}}va.iTj="Sheet";Object(b.a)(va,"SheetOpsSheetClickHelper",Xa.a,[]);var na=a(43),Ka=a(61),ib=a(100);class Ra extends ca{constructor(tb,gc,Xb,Ga,Za){super(document.createElement("li"),tb);this.gTj=100;this.hTj=
500;this.MLe=this.LLe=0;this.wRe=.5;this.nW=this.RZd=!1;this.color=this.xPc=this.kL=this.AJb=this.mQ=null;this.woc=this.rsf=!1;this.Qac="#BEBBB8";this.VMc=null;this.onKeyDown=Sb=>13!==Sb.Da.keyCode||this.disabled?!1:(this.activateSheet(1),!0);this.ZA=Sb=>32!==Sb.Da.charCode||this.disabled?!1:(this.activateSheet(1),!0);this.hP=()=>{this.disabled||this.X2.IS||this.zqa(!0,void 0,"OnMouseOver")};this.gP=()=>{this.disabled||this.zqa(!1,void 0,"OnMouseOut")};this.bLb=()=>{this.X2.IS||(this.S1j(),Object(Ka.c)(this.sheet.sheetProcessedData)||
Ma.h(this.$).Vpa(this.sheet.sheetName,"sheetTabButton.onMouseEnter"));return!1};this.b9=()=>{this.yXe(!1);return!1};this.Ud=Sb=>{if(this.disabled)return!0;const sb=Ma.h(this.$);this.sheet.active||3!==Sb.kc||!ya.a.KQa()&&!this.RGb||sb.Ob||sb.hj||sb.Hxb();this.activateSheet(Sb.kc);return 3!==Sb.kc};this.onPointerDown=Sb=>{if(this.disabled)return!0;this.yXe(!0);Ma.h(this.$).inRangePicker&&y.ULS.sendTraceTag(35985038,0,15,"SheetTabButton:OnPointerDown() - Tried clicking different sheet while in range picker (e.g editing a formula).");
var sb=3===Sb.kc;if(2===Sb.kc||sb&&this.Yza)this.zqa(!0,!sb,"OnPointerDown"),sb=l.Task.delay(sb?this.hTj:this.gTj).Mq(()=>!0),this.iGb&&(this.woc=!0,this.X2.IAc=d.TaskExtensions.za(sb,()=>{this.woc&&this.X2.pcj(this,Sb)},this.ka,11));return!1};this.Wh=Sb=>{if(this.disabled||!this.iGb&&Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))return!0;this.woc=!1;this.zqa(2===Sb.kc,void 0,"OnPointerUp");this.X2.IAc&&(d.TaskExtensions.za(this.X2.IAc,()=>{this.X2.ocj()},
this.ka,11),this.X2.IAc=null);return!1};this.lP=()=>{this.woc=!1;this.RZd||this.zqa(!1,void 0,"OnTouchMove");return!1};this.BKe=new va(this,tb);this.RGb=ya.a.RGb();this.LLe=18;this.MLe=20;this.$=tb;this.F1b=Ga;this.X2=Za;this.iGb=Za.rAe();this.dsh();this.$lh();this.btd=tb.yc.vh("UserAction",this.name);this.sxd=!1;hb.DOMElementExtensions.xy(this.domElement,t.a.Ds,null,null);this.domElement.appendChild(this.anchor);this.anchor.appendChild(this.kL);this.Hqa=new Da.a;tb=new Qa(this.sheet);this.Hqa.add(new mb(this.$,
tb));this.$.ea.IRb&&(tb=new Jb(this.sheet),this.Hqa.add(new mb(this.$,tb)));tb=new Db(this.sheet,this.X2.vEc,()=>this.color?Ra.b0d(this.color):!1);this.AJb=new mb(this.$,tb);this.Hqa.add(this.AJb);this.Yza=this.X2.Yza;this.tkb();this.qvj();this.wFe=new xa.a(this.domElement,1);gc.insertBefore(this.domElement,Xb);pa.a(this.$)&&this.Kug(!0)}get zvh(){return this.xPc||(this.xPc=Nb.a.mq("#F5F5F5"))}get name(){return this.mQ.innerText}set name(tb){this.mQ&&(this.mQ.innerText=tb,this.pJc(),this.Lug())}get sheet(){return this.F1b}get anchor(){return this.VMc}get tabIndex(){return this.anchor.tabIndex}set tabIndex(tb){this.anchor.tabIndex=
tb}J6h(){return hb.DOMElementExtensions.Fg(this.anchor)?this.anchor:null}dispose(){if(this.nW){M.a.instance.Aa(F.a.pointerDown,this.domElement,this.onPointerDown);B.KeyInputManager.instance.Aa(F.a.Ic,this.domElement,this.onKeyDown);B.KeyInputManager.instance.Aa(F.a.sq,this.domElement,this.ZA);Ia.a.instance.Aa(F.a.click,this.domElement,this.Ud);M.a.instance.Aa(F.a.XX,this.domElement,this.bLb);M.a.instance.Aa(F.a.TC,this.domElement,this.b9);if(this.iGb||Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))M.a.instance.Aa(F.a.Zg,
this.domElement,this.Wh),this.Yza&&(O.a.instance.Aa(F.a.jf,this.domElement,this.Wh),O.a.instance.Aa(F.a.lh,this.domElement,this.lP));this.nW=!1;this.Qac="#BEBBB8"}G.a.ed([this.BKe,this.wFe]);this.mQ=this.kL=this.VMc=this.X2=this.wFe=this.BKe=null;if(this.Hqa){for(let tb of this.Hqa)tb.dispose();this.Hqa=null}this.color=this.F1b=null;super.dispose()}YT(tb){tb&&this.zqa(!1,!1);super.YT(tb)}Wig(tb){if(qb.a.qh.HS){this.vUe();var gc=Object(u.b)("OfficeVSO:7629405_namedSheetViewPublic_Migration")?Object(ib.d)(v.a.resolve(x.eb,
{Wa:1})):f.GetServiceTaskFactory.Za(this.$.da,322,323,1);d.TaskExtensions.za(gc,Xb=>{pb.UISurfaces.aJ().then(Ga=>{const Za=Xb.result;Za.jPj(Ga);Za.show(tb);return null},Ga=>{y.ULS.sendTraceTag(537153688,0,15,`SheetTabButton.ShowNamedSheetViewTeachingUI: Failed to GetNotificationsAPIAsync: ${Ga}`);return null})},this.ka,3)}}NUg(){if(this.sheet.active&&this.$.Hq){var tb=this.$.Hq,gc=Ma.h(this.$),Xb=gc.rk;if(this.sheet.Ze.yC){if(!this.AJb){const Ga=new Db(this.sheet,this.X2.vEc,()=>this.color?Ra.b0d(this.color):
!1);this.AJb=new mb(this.$,Ga);this.Hqa.add(this.AJb)}Xb&&gc.gkb(1);tb.classList.add(oa.a.H1e);tb=Ra.Xbf(t.a.PFf);gc=Ra.Xbf(t.a.EGd);"true"===tb&&"true"===gc?this.$.ea.O_d&&this.$.ea.bSb&&(this.sheet.Ze.JO?(tb=1,cb.a.$t(t.a.EGd,"false",cb.a.D1),this.$.ea.bSb=!1):tb=0,cb.a.$t(t.a.PFf,"false",cb.a.D1),this.$.ea.O_d=!1,this.Wig(tb)):this.sheet.Ze.JO&&"true"===gc&&this.$.ea.bSb&&(cb.a.$t(t.a.EGd,"false",cb.a.D1),this.$.ea.bSb=!1,this.Wig(2))}else this.vUe(),Xb&&gc.gkb(0),tb.classList.remove(oa.a.H1e)}}vUe(){const tb=
Object(u.a)({jfa:322,new:x.eb,registry:this.$.da,tR:"OfficeVSO:7629405_namedSheetViewPublic_Migration"});tb&&tb.dismiss()}tkb(){this.name=this.sheet.name;this.domElement.className=this.sheet.active||this.U$a()?V.M4j:V.U4j;Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:5262355_SheetTabFocusBugFix")?this.mQ.parentNode.classList.add(V.mNi):this.mQ.parentNode.classList.add(V.nNi);this.Lug();this.pYj();this.Sug();this.pJc();this.NUg()}ncj(){this.RZd=!0;this.zqa(!0,!0,"OnSheetReorderStarted")}mcj(){this.RZd=
!1;this.zqa(!1,void 0,"OnSheetReorderEnded")}activate(tb=0,gc=!1){this.F8b()||(this.sheet.activate(),gc&&Ma.h(this.$).focus(),tb={["InputMethod"]:lb.a[tb],["AppMode"]:this.$.Tc,["Location"]:"canvas"},Vb.b(this.$).Vd(zb.a.dTj,tb))}Kug(tb){this.Qac=tb?"#797775":"#BEBBB8";this.wRe=tb?-.5:.5;this.xPc=tb?Nb.a.mq("#3B3A39"):Nb.a.mq("#F5F5F5");this.Sug()}PLj(tb){this.iGb=tb}hJd(tb){tb.w$c();this.RIe(tb)}RIe(tb){tb.m4a();this.sheet.activate()}URg(tb){tb=new ob.a(-1876836819,tb,this.$.Tc,30,null);return this.$.Ia.mc(tb,
{[t.a.TZd]:this.sheet.name})}Lug(){this.mQ.parentNode.setAttribute("sheet-title",this.mQ.innerText)}pJc(){const tb=this.h0h();this.anchor.setAttribute(t.a.xv,tb);this.anchor.setAttribute(t.a.Qba,this.sheet.active.toString())}h0h(){const tb=this.sheet.Ze.yC,gc=this.sheet.Ze.Brb,Xb=this.sheet.ki,Ga=this.sheet.isLockPausedInSession;return tb&&Xb?String.format(J.a.instance.Xb(20),this.name,gc):tb&&Ga?String.format(J.a.instance.Xb(22),this.name,gc):tb?String.format(J.a.instance.Xb(19),this.name,gc):Xb?
String.format(J.a.instance.Xb(18),this.name):Ga?String.format(J.a.instance.Xb(21),this.name):this.name}activateSheet(tb=0){if(ya.a.ivf()){if(Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:4099273_PromptForCommentsOnSheetChange")&&this.F8b())return l.Task.Ua(!1);Tb.a.current.NP="ActivateSheet";this.sheet.activate();return l.Task.Ua(!0)}return this.URg(tb)}Sug(){const tb=this.sheet.tabColor;this.color=tb?Nb.a.mq(tb):this.zvh;this.rsf=Ra.b0d(this.color);this.zqa(!1,void 0,"UpdateTabColor")}zqa(tb,gc=
!1,Xb=null){if(this.sheet){Xb=this.sheet.active;var Ga=this.U$a(),Za=!!this.sheet.tabColor,Sb=Nb.a.nK(Xb||Ga?Pa.a.white:this.color);this.kL.style.background="";Xb||Ga?(Za&&(Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:5293663_SheetTabHighContrastBackgroundBug")&&this.$.UOa?this.$Qj():this.ZQj()),this.kL.style.height=this.LLe.toString()+"px"):(this.kL.style.filter="",this.kL.style.backgroundColor=Sb,this.kL.style.height=this.MLe.toString()+"px");this.mQ.className=Xb?V.N4j:Ga?V.dark:this.rsf?V.light:
V.dark;for(let sb of this.Hqa)sb.Ptg();tb&&!Za&&(this.kL.style.backgroundColor="#E1DFDD");hb.DOMElementExtensions.toggleCssClass(this.domElement,V.T4j,tb);gc?(Za||(this.kL.style.backgroundColor=this.Qac),this.domElement.style.backgroundColor=this.Qac):(Za||(this.kL.style.backgroundColor=""),this.domElement.style.backgroundColor="");this.mQ.style.fontWeight=Xb||Ga?"600":""}else y.ULS.sendTraceTag(537153687,0,15,`SheetTabButton.SetTabColors: can't change colors to a sheet tab without sheet, whihc means its not rendered. caller: ${Xb}`)}ZQj(){const tb=
this.kL.style,gc=Nb.a.nK(Ra.Ich(this.color,this.wRe));tb.background=gc}$Qj(){this.kL.style.background="transparent"}$lh(){this.VMc=document.createElement("a");this.anchor.removeAttribute("Href");this.anchor.className=V.O4j;hb.DOMElementExtensions.xy(this.anchor,t.a.qtb,null,null);this.tabIndex=-1}dsh(){this.kL=document.createElement("span");this.kL.className=V.R4j;this.mQ=document.createElement("span");this.mQ.className=V.W4j;this.mQ.dir=this.sheet.rtlName?"rtl":"ltr";this.kL.appendChild(this.mQ)}pYj(){const tb=
this.$.zN;for(let gc of this.Hqa)gc.oYj(tb,this.kL,this.mQ)}U$a(){return Ma.h(this.$).U$a(this.sheet)}S1j(){this.btd.start();this.sxd=!0}yXe(tb){this.sxd&&(this.btd.stop(),y.ULS.sendTraceTag(537153686,0,50,na.c({["Sheet index"]:this.sheet.index,["Active Sheet"]:this.sheet.active,["Hovering time"]:this.btd.vd,["Has been clicked"]:tb})),this.sxd=!1)}qvj(){M.a.instance.ta(F.a.pointerDown,this.domElement,this.onPointerDown);B.KeyInputManager.instance.ta(F.a.Ic,this.domElement,this.onKeyDown);B.KeyInputManager.instance.ta(F.a.sq,
this.domElement,this.ZA);this.Dd.la("mouseover",this.hP);this.Dd.la("mouseout",this.gP);M.a.instance.ta(F.a.XX,this.domElement,this.bLb);M.a.instance.ta(F.a.TC,this.domElement,this.b9);if(this.iGb||Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))M.a.instance.ta(F.a.Zg,this.domElement,this.Wh),this.Yza&&(O.a.instance.ta(F.a.jf,this.domElement,this.Wh),O.a.instance.ta(F.a.lh,this.domElement,this.lP));Ia.a.instance.ta(F.a.click,this.domElement,this.Ud);this.nW=
!0}F8b(){const tb=this.$.da.Ba(65);return tb&&tb.yna()?(tb.dCc(),this.RIe(tb),!0):!1}static Xbf(tb){let gc=cb.a.get(tb);gc||(cb.a.$t(tb,"true",cb.a.D1),gc=cb.a.get(tb));return gc}static Ich(tb,gc){if(1<gc||-1>gc)return tb;let Xb=tb.r,Ga=tb.g;tb=tb.b;0<gc?(Xb=Xb*(1-gc)+255*gc,Ga=Ga*(1-gc)+255*gc,tb=tb*(1-gc)+255*gc):(Xb*=1+gc,Ga*=1+gc,tb*=1+gc);return Pa.a.$zb(Math.round(Xb),Math.round(Ga),Math.round(tb))}static b0d(tb){return 128>=(222*tb.r+707*tb.g+71*tb.b)/1E3}}Object(b.a)(Ra,"SheetTabButton",ca,
[]);class ka extends ca{constructor(tb,gc,Xb){super(document.createElement("a"),gc);this.dka=oa.a.Sgd;Xb.Vb(this.domElement,J.a.instance.ha(713),0,this.dka,J.a.instance.ha(713),U.a.g$c,!0);tb.appendChild(this.domElement);this.Dd.la("contextmenu",Ga=>{Ja.g(Ga)})}}Object(b.a)(ka,"WorkbookProtectionButton",ca,[]);var da=a(55),kb=a(44),Ob=a(65);class lc extends Z.a{constructor(tb,gc,Xb=null){super(gc);this.sheetTabActivatePreviousHidden=J.a.instance.ha(722);this.sheetTabActivateNextHidden=J.a.instance.ha(724);
this.svgIconProvider=null;this.oi=[];this.TO=Array(6);this.NGd=Array(6);this.OVa=this.YDb=this.xS=this.Shb=this.ZZd=this.YZd=this.Hn=null;this.isRtl=!1;this.wX=this.yA=0;this.Ecc=this.HAc=!1;this.qxc=this.gqa=0;this.$N=this.t6=this.bda=this.Occ=null;this.mjc=this.AE=0;this.qTb=null;this.nHb=-1;this.g6=null;this.xwc=0;this.pGc=-1;this.Cpa=0;this.Mwa=new R;this.ITc=!1;this.IAc=this.zEc=this.JRb=this.sre=this.J1=null;this.sje=!1;this.rre=null;this.ZE=(Ga,Za)=>{this.QRf(Za.item)};this.SBa=(Ga,Za)=>{Ga=
this.$.ua.na.index;for(let Sb=0,sb=this.oi.length;Sb<sb;Sb++){const bc=this.JW(Sb);if(bc.name===Za.oldName){bc.name=Za.newName;this.q2();Sb===Ga&&this.zga(6);break}}};this.URf=(Ga,Za)=>{(Ga=this.lzb(Za.item))&&Ga.tkb()};this.VRf=(Ga,Za)=>{Za.visible?(this.HVa(!1),this.RRf(Za.item)):this.QRf(Za.item)};this.W8=Ga=>{this.IS?(this.g6=Ga,this.IUb()):(this.g6&&(this.qxc+=this.g6.clientPoint.x-Ga.clientPoint.x),this.g6=Ga,Math.abs(this.qxc)>=this.RAh&&this.IUb());return!0};this.lP=Ga=>{Ga.Da.preventDefault();
return!1};this.Lag=Ga=>{this.Iag(Ga,!0)};this.Kag=Ga=>{this.Iag(Ga,!1)};this.X8=Ga=>{if(this.IS){this.Ecc=this.YBi(Ga);let Za;Ga=(Za=this.JW(this.AE+1))?Za.sheet:null;this.reorderSheets(Ga,this.AE+1===this.WZd,!0)}this.hW();return!0};this.tk=(Ga,Za)=>{Za.WC&&this.L7d(Za.WC);this.DDc(!1);this.q2();Za.na&&(this.L7d(Za.na),this.zga(6),this.ea.kpa())};this.hIf=(Ga,Za)=>{this.lKc(Za.item)};this.iIf=(Ga,Za)=>{this.lKc(Za.item)};this.jIf=(Ga,Za)=>{this.lKc(Za.item)};this.vSa=(Ga,Za)=>{this.lKc(Za.item)};
this.ABa=()=>{this.X8c()};this.ee=()=>{this.isVisible=!this.ea.isNamedObjectViewMode;this.X8c();this.Pbd();if(Ob.d(this.$)||Ob.e(this.$))kb.PageLoadTrackingInfo.instance.oY(t.a.LDa,["sheetTabBar"]),kb.PageLoadTrackingInfo.instance.nY(t.a.LDa,["sheetTabBar"]);this.xbd();this.q2();this.HVa(!0);this.zga(6)};this.Lj=()=>{this.isVisible&&(this.q2(),this.zga(6))};this.rg=()=>{Object(I.a)(ma,this.xS)===aa.m(this.$.Df)&&this.xbd();for(const Ga of this.oi)Ga.PLj(!aa.m(this.$.Df))};this.TRf=(Ga,Za)=>{this.RAj(Za.item,
Za.isUserOperation)};this.tLb=(Ga,Za)=>{this.RRf(Za.item)};this.onKeyDown=Ga=>{switch(Ga.keyCode){case 9:var Za=this.domElement.querySelectorAll(hb.DOMElementExtensions.Nr);const Sb=hb.DOMElementExtensions.Bm(Za);Za=hb.DOMElementExtensions.pC(Za);hb.DOMElementExtensions.CDa(Ga,Sb,Za);break;case 39:case 37:hb.DOMElementExtensions.Kdg(Ga,this.domElement.querySelectorAll(hb.DOMElementExtensions.Nr),39===Ga.keyCode?!this.isRtl:this.isRtl)}y.ULS.sendTraceTag(537153691,0,50,`SheetTabBarControl.OnKeyDown: Press on ${Ga.keyCode}`)};
this.onScroll=()=>{this.Hn.scrollLeft!==this.gqa&&this.y6j()};this.jP=Ga=>{if(Ga.ctrlKey||Ga.O5)return!1;this.Hn.scrollLeft+=Math.floor(30*Ga.Zra);if(this.IS){const Za=this.raf("OnMouseWheel");Za&&this.p3d(0<Ga.Zra,Za.x+Za.width/2)}return!0};this.iH=(Ga,Za)=>{if(this.Mwa)this.wif("PartialInteractivity",Za.xN?3:0);else{this.hW(!1);this.yYd(Za.xN);for(const Sb of this.qEe)Sb&&Sb.YT(Za.xN);for(const Sb of this.oi)Sb&&Sb.YT(Za.xN)}};this.DKb=(Ga,Za)=>{Ga=0;Za.ove&&(Ga=2|(Za.jTj?1:0));this.wif("ComponentRangePicker",
Ga)};this.$=tb;this.ea=this.$.ea;this.Wcc=!Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2");this.Puf=!this.$.Sv;this.sje=!D.a.Dz;this.MDi=Fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InSheetTemplates",!1);this.kYi=this.$.xa.SheetTabNavigateButtonLongKeyPressPeriodMS;this.jYi=this.$.xa.SheetTabNavigateButtonIntervalPeriodMS;this.RAh=this.$.xa.SheetTabDragStartPixelThreshold;this.mTa=this.nTa=-1;this.U$c=!1;this.svgIconProvider=
Xb;this.SD=new xa.a(this.domElement,3);this.domElement.classList.add(V.WKh);this.Lph();this.pnh();this.Mph();Fa.EwaSettings.FO()&&document.getElementById(t.a.Pda)||this.Rqh();this.DDc(!0);this.ee(null,null);tb=this.$.ua;tb.Vg(this.tk);tb.w2c(this.ABa);tb.e_(this.ZE);tb.yja(this.tLb);tb.jJa(this.SBa);tb.xye(this.TRf);tb.A1a(this.VRf);tb.JXg(this.URf);tb.J2c(this.hIf);tb.uye(this.iIf);tb.vye(this.jIf);tb.wye(this.vSa);this.$.$l(this.ee);this.$.kA(this.Lj);ea.a(this.$).Zi(this);this.$.da.Ja(32,this);
Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport")&&this.$.ea.wv(this.rg);this.yEc=this.kf.Re(this.domElement);this.yEc.la("keydown",this.onKeyDown);Sa.a(this.$).Zq()&&this.iH(null,new Ua.a(!0));Sa.a(this.$).Lg.xba(this.iH);Ma.h(this.$).Rxe(this.DKb);this.yEc.la("mousedown",Ga=>{Ga.preventDefault()});H.a.instance.ta(F.a.TE,this.domElement,this.jP);this.XZd=this.kf.Re(this.Hn);this.XZd.la("scroll",this.onScroll);this.y6j=Ba.b(()=>{this.q2()},200,this.$.ka,la.a.pTj,
!0);this.$.rC(t.a.x_j);this.Puf&&(this.rre=new ja(this.$,this.OVa.domElement));kb.PageLoadTrackingInfo.instance.w2(t.a.LDa,["sheetTabBar"])}get Wc(){return this.domElement}get Fg(){return this.isVisible}get Qe(){return za.a.VZd}get IS(){return this.ITc}get WZd(){return this.oi.length}get vEc(){return this.sre}get Yza(){return this.sje}get navigationButtonsDisabled(){return!!this.Mwa&&this.Mwa.navigationButtonsDisabled}get operationButtonsDisabled(){return!!this.Mwa&&this.Mwa.operationButtonsDisabled}get wYi(){return this.$.zN?
[oa.a.q_e,oa.a.u_e,oa.a.v_e,oa.a.p_e,oa.a.Xdc,oa.a.Xdc]:[oa.a.p_e,oa.a.v_e,oa.a.u_e,oa.a.q_e,oa.a.Xdc,oa.a.Xdc]}get OGd(){return this.$.zN?[null,U.a.uMe,U.a.sMe]:[null,U.a.sMe,U.a.uMe]}get JXf(){return this.$.zN?[null,U.a.vMe,U.a.tMe]:[null,U.a.tMe,U.a.vMe]}get RHb(){if(this.isRtl){if(D.a.WG)return 0;if(D.a.Bg)return-1*(this.Hn.scrollWidth-this.Hn.clientWidth);if(D.a.Dz)return this.Hn.scrollWidth-this.Hn.clientWidth;y.ULS.sendTraceTag(537153762,0,15,"SheetTabBarControl.ScrollLeftEdgeValue: unknown browser")}return 0}get GPb(){if(this.isRtl){if(D.a.WG)return this.Hn.scrollWidth-
this.Hn.clientWidth;if(D.a.Bg||D.a.Dz)return 0;y.ULS.sendTraceTag(537153761,0,15,"SheetTabBarControl.ScrollRightEdgeValue: unknown browser")}return this.Hn.scrollWidth-this.Hn.clientWidth}get qEe(){return this.Mwa?[this.xS,this.YDb]:[this.xS,this.YDb,this.OVa]}get V4j(){return this.oi.concat(this.OVa)}get ogg(){return this.rre}Vb(tb,gc,Xb,Ga,Za,Sb,sb=!1){tb.removeAttribute("Href");tb.setAttribute(t.a.te,t.a.Au);tb.className=V.LKh;tb.title=gc;tb.tabIndex=0;Sb?Xb=this.svgIconProvider.dea(Sb,12,12,tb,
24,24):(gc=document.createElement("span"),gc.className=oa.a.zfh,gc.classList.add(Ea.a.Oka),gc.tabIndex=-1,tb.appendChild(gc),Sb=document.createElement("img"),Sb.src=wa.a.yg(Xb),Sb.className=Ga,Sb.alt=Za,Sb.tabIndex=-1,gc.appendChild(Sb),Xb=Sb);sb&&tb.classList.add(Ea.a.MV);return Xb}dispose(){if(this.$){var tb=this.$.ua;tb.xh(this.tk);tb.oSd(this.ABa);tb.R9(this.ZE);tb.Qpa(this.tLb);tb.pUa(this.SBa);tb.g5f(this.TRf);tb.COb(this.VRf);tb.Nyj(this.URf);tb.DSd(this.hIf);tb.d5f(this.iIf);tb.e5f(this.jIf);
tb.f5f(this.vSa);this.$.hn(this.ee);this.$.$C(this.Lj);Sa.a(this.$)&&Sa.a(this.$).Lg.lga(this.iH);this.Mwa&&Ma.h(this.$).F4f(this.DKb);H.a.instance.Aa(F.a.TE,this.domElement,this.jP)}G.a.ed(this.NGd);this.NGd=null;if(this.TO)for(tb=0;tb<this.TO.length;tb++){const gc=hb.DOMElementExtensions.CG(this.TO[tb],this.domElement,!1,"a");gc&&L.a.Mpa(gc)}G.a.Ka(this.SD);G.a.Ka(this.yEc);G.a.Ka(this.XZd);this.XZd=this.yEc=this.YDb=this.xS=this.SD=null;this.$&&this.hW(!1);this.bda=null;this.TXd(null,"Dispose");
this.qTb=this.$N=this.Occ=null;this.X8c();this.Shb=this.ZZd=this.YZd=this.Hn=this.TO=this.$=this.ea=null;super.dispose()}$g(tb,gc){if(!gc){y.ULS.shipAssertTag(537153760,0,0<this.oi.length,"There is no sheet tab button.");if(!this.oi.length)return!1;tb=null;for(const Xb of this.oi)if(tb=Xb.J6h())break;if(!tb)return y.ULS.shipAssertTag(537153759,0,!1,"There is no focusable tab element."),!1;hb.DOMElementExtensions.setFocus(tb)}return!gc}ui(tb){return hb.DOMElementExtensions.zg(this.Wc,tb)}pk(){}Rk(){}reorderSheets(tb,
gc,Xb){if(this.J1&&this.J1!==tb){const Ga=this.J1.index;this.QAj(this.J1,tb,gc);tb=tb?tb.index-1:gc?this.$.ua.count-1:0;Ga!==tb&&(this.ORi(Ga,tb,Xb),this.LDh(this.J1.name,tb))}}wii(tb){tb=this.Hla(tb);return-1!==tb&&this.yA<=tb&&tb<=this.wX?this.oi[tb].domElement:null}Mgk(tb){for(var gc=0;gc<this.TO.length;gc++){const Xb=this.TO[gc];if(Xb&&this.svgIconProvider){const Ga=Xb.parentNode;this.i4f(Xb);Ga&&(this.TO[gc]=this.svgIconProvider.dea(tb?this.JXf[gc]:this.OGd[gc],12,12,Ga,24,24))}}for(gc=0;gc<
this.oi.length;gc++)this.oi[gc].Kug(tb);this.OVa&&this.OVa.Dva&&this.Jug(U.a.mki,this.OVa,tb);this.xS&&this.xS.Dva&&this.Jug(U.a.Jhh,this.xS,tb)}Jug(tb,gc,Xb){gc.Ceb||(gc.Ceb=this.svgIconProvider.dea(tb,12,12,gc.Dva.parentNode,24,24));gc.Ceb&&(hb.DOMElementExtensions.setVisible(gc.Dva,!Xb),hb.DOMElementExtensions.setVisible(gc.Ceb,Xb))}pcj(tb,gc){var Xb=Ma.h(this.$);const Ga=Xb.inRangePicker,Za=fa.HelperMethods.Fp(gc);if(Xb.Ob&&!Ga){const Sb=Xb.Gm?"formulaBar_end_edit_sheet_changed":"cell_text_end_edit_sheet_changed";
let sb=void 0;Fa.EwaSettings.W$a&&(sb=[Object(fb.a)(Xb.cellTextEditBox.textBox.pEa)]);fb.b(this.$).HEa(Za.rawEvent,Sb,sb);Xb.endEdit(!0,"SheetTabBar.OnSheetTabMouseDown")}Xb=this.Yza&&3===gc.kc;!(2===gc.kc&&Za.button===Sys.UI.MouseButton.leftButton||Xb)||Ga||this.IS||Sa.a(this.$).Zq()||(Xb&&tb.ncj(),this.nHb=gc.clientPoint.x,this.g6=gc,this.v5g(tb))}ocj(){this.q2()}rAe(){return this.$.isEditMode&&!aa.m(this.$.Df)}q2(){const tb=fa.HelperMethods.aT(()=>{this.Dek();this.EQj();this.yYd()});y.ULS.sendTraceTag(537153757,
0,50,`SheetTabBarControl.RearrangeContentAreaAndNavAreaExtra: duration = ${tb}`)}EQj(){const tb=this.wX===this.oi.length-1;hb.DOMElementExtensions.toggleCssClass(this.Shb,this.$.zN?V.w_e:V.r_e,!!this.yA);hb.DOMElementExtensions.toggleCssClass(this.Shb,this.$.zN?V.r_e:V.w_e,!tb)}yYd(tb=!1){const gc=!this.yA,Xb=this.wX===this.oi.length-1;this.qeg(4,this.sheetTabActivatePreviousHidden,!gc);this.qeg(5,this.sheetTabActivateNextHidden,!Xb);this.SDc(0,gc||tb);this.SDc(1,gc||tb);this.SDc(2,Xb||tb);this.SDc(3,
Xb||tb)}qeg(tb,gc,Xb){if(tb=this.TO[tb]){hb.DOMElementExtensions.setVisible(tb,Xb);var Ga=this.bcf(tb);Ga.title="img"===tb.nodeName?tb.alt=0<this.oi.length&&Xb?gc:"":tb.title=0<this.oi.length&&Xb?gc:"";Ga.tabIndex=Xb?0:-1}}bcf(tb){return tb.parentNode}SDc(tb,gc){if(tb=this.TO[tb])tb=this.bcf(tb),void 0!==tb&&null!==tb&&(!this.oi.length||gc?(tb.classList.add(Ea.a.MV),tb.setAttribute(t.a.ova,"true")):(tb.classList.remove(Ea.a.MV),tb.setAttribute(t.a.ova,"false")))}HVa(tb){const gc=this.$.zN?this.oi.length-
1:0;let Xb=this.Mef(this.$.zN?0:this.oi.length-1);Xb&&(Xb.borderRightWidth=tb?"1px":"0");this.yA!==this.wX&&(Xb=this.Mef(gc))&&(Xb.borderRightWidth="0")}lxe(tb,gc){this.oi||(this.oi=[]);-1===gc?this.oi.push(tb):this.oi.splice(gc,0,tb)}kac(tb,gc){let Xb=-1,Ga=null;gc||(Xb=this.Y$h(tb.index),-1!==Xb&&(Ga=this.qOa(Xb)));tb=new Ra(this.$,this.Hn,Ga,tb,this);this.lxe(tb,Xb);hb.DOMElementExtensions.setVisible(tb.domElement,!0)}zga(tb){const gc=fa.HelperMethods.aT(()=>{switch(tb){case 0:this.wCc(0);break;
case 1:this.wCc(this.yA-1);break;case 2:this.wCc(this.yA+1);break;case 3:this.scrollIntoView(this.oi.length-1);break;case 4:this.yA&&1<=this.oi.length&&(this.ave(this.yA-1),this.kWd());break;case 5:this.wX!==this.oi.length-1&&1<=this.oi.length&&(this.ave(this.wX+1),this.kWd());break;case 6:this.kWd()}});this.Wcc&&this.IS&&this.IUb();y.ULS.sendTraceTag(537153755,0,50,`SheetTabBarControl.ScrollSheetTabs: operation = ${tb}, duration = ${gc}`)}ave(tb){(tb=this.JW(tb))&&tb.activate()}STh(tb){if(0===tb.qB){const gc=
this.$.ua;let Xb=0;for(let Ga=0,Za=gc.count;Ga<Za;Ga++){const Sb=Object(S.a)(ta.a,gc.getItem(Ga));if(Sb===tb)return Xb;0===Sb.qB&&Xb++}}return-1}GTh(tb){const gc=this.$.ua;for(let Xb=tb.index+1,Ga=gc.count;Xb<Ga;Xb++)if(tb=Object(S.a)(ta.a,gc.getItem(Xb)),0===tb.qB)return tb;return null}Hla(tb){for(let gc=0;gc<this.oi.length;gc++){const Xb=this.JW(gc);if(!Xb)y.ULS.sendTraceTag(537153754,0,15,`SheetTabBarControl.FindMatchingSheetTabIndex: sheetTabButton[${gc}] is null even though index is not out of bounds!`);
else if(Xb.sheet===tb)return gc}return-1}lzb(tb){tb=this.Hla(tb);return this.JW(tb)}ORi(tb,gc,Xb){const Ga={};Ga.a=this.$.xa.UserSessionId;Ga.b=Xb;Ga.c=this.Ecc;Ga.d=tb;Ga.e=gc;Ga.f=this.$.ua.count;da.b().Of(2,Ga,Xb)}QAj(tb,gc,Xb){const Ga=Object(S.a)(Oa.a,this.$.ua);gc?(gc=gc.index,gc=tb.index<gc?gc-1:gc):gc=Xb?Ga.count-1:0;Ga.reorderSheet(tb,gc,!0)}dOj(tb){Ma.h(this.$).Nh.zq(tb)}v5g(tb){if(!this.HAc){const gc=this.domElement.ownerDocument.body;M.a.instance.ta(F.a.dl,document.documentElement,this.W8);
this.Yza&&(O.a.instance.ta(F.a.lh,document.documentElement,this.W8),O.a.instance.ta(F.a.lh,this.domElement,this.lP));M.a.instance.ta(F.a.Zg,document.documentElement,this.X8);O.a.instance.ta(F.a.jf,gc,this.X8);this.HAc=!0}this.J1=tb.sheet;this.Ecc=!1;this.$N=null;this.Occ=tb;this.bda=tb.domElement;this.TXd(hb.DOMElementExtensions.getBoundingClientRect(this.bda),"BeginSheetTabButtonDrag")}hW(tb=!0){if(this.HAc){this.dOj(t.a.LW);const gc=this.domElement.ownerDocument.body;M.a.instance.Aa(F.a.dl,document.documentElement,
this.W8);this.Yza&&(O.a.instance.Aa(F.a.lh,document.documentElement,this.W8),O.a.instance.Aa(F.a.lh,this.domElement,this.lP));M.a.instance.Aa(F.a.Zg,document.documentElement,this.X8);O.a.instance.Aa(F.a.jf,gc,this.X8);this.ITc=this.HAc=!1}this.qxc=0;this.Ecc=!1;this.J1=null;this.bda&&(this.bda.style.visibility="visible",this.bda=null);this.Occ=null;this.TXd(null,"EndSheetTabButtonDrag");this.$N&&(this.$N.parentNode&&this.$N.parentNode.removeChild(this.$N),this.$N=null);this.iDj(tb)}iDj(tb){this.C2d(tb);
this.AE=this.nHb=-1}LDh(tb,gc){const Xb=this.$.qa,Ga=Xb?Xb.va:null;this.$.userOperationManager.Bd(new ia.a(557,0,(Za,Sb,sb)=>nb(Ga,tb,gc,Za,Sb,sb,null),64,()=>new Va(tb,gc)),null)}JW(tb){return 0<=tb&&tb<this.oi.length?this.oi[tb]:null}cfi(tb){return(tb=this.JW(tb))?tb.sheet:null}qOa(tb){return(tb=this.JW(tb))?tb.domElement:null}Mef(tb){return(tb=this.qOa(tb))?tb.style:null}Y$h(tb){const gc=this.$.ua;tb+=1;let Xb=-1;const Ga=this.oi?this.oi.length:0;for(;tb<gc.count;){const Za=Object(S.a)(ta.a,gc.getItem(tb));
if(0===Za.qB){for(Xb=0;Xb<Ga&&this.cfi(Xb)!==Za;Xb++);break}tb++}return-1===Xb||Xb===Ga?-1:Xb}QRf(tb){var gc=this.lzb(tb);gc&&(this.IS&&(y.ULS.sendTraceTag(537153751,0,50,"SheetTabBarControl.OnSheetDeletedOrHidden: A sheet has been deleted while re-order operation is midway."),Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.hW()),this.Hn.removeChild(gc.domElement),gc=Array.indexOf(this.oi,gc),this.oi.splice(gc,1),this.q2(),(!this.isRtl&&
gc===this.oi.length||this.isRtl&&!gc)&&this.HVa(!0),this.Wcc&&this.IS?tb===this.J1?(this.hW(),this.zga(6)):this.IUb():this.zga(6))}RRf(tb){const gc=Object(S.a)(ta.a,tb);this.IS&&(y.ULS.sendTraceTag(537153750,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: A sheet has been added to the sheet tab bar while re-order operation is midway."),Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.hW());if(0===gc.qB){this.HVa(!1);var Xb=this.Hla(tb);
-1===Xb&&(y.ULS.sendTraceTag(537153749,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: could not find matching sheet tab index. Creating sheet tab..."),this.kac(gc,!1),Xb=this.Hla(tb));this.Fif(Xb,!0)}}RAj(tb,gc){const Xb=this.lzb(tb);Xb&&(this.IS&&!gc&&(y.ULS.sendTraceTag(537153748,0,50,"SheetTabBarControl.ReorderSheetTab: A sheet has been re-ordered while re-order operation is midway."),Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&
this.hW()),tb=this.I4j(tb,Xb),!Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:4176044_CancelCallsToSetTabColorAfterReorder")&&tb&&gc&&tb.mcj())}I4j(tb,gc){var Xb=Array.indexOf(this.oi,gc);const Ga=this.STh(Object(S.a)(ta.a,tb));if(-1===Ga||-1===Xb)return null;this.HVa(!1);({uUh:this.yA,lMi:this.wX}=lc.NAj(Xb,Ga,this.yA,this.wX));gc&&gc.domElement.parentNode===this.Hn&&(this.Hn.removeChild(gc.domElement),this.oi.splice(Xb,1));gc=this.GTh(tb);Xb=this.Hla(gc);gc=new Ra(this.$,this.Hn,this.qOa(Xb),Object(S.a)(ta.a,
tb),this);this.lxe(gc,Xb);Xb=this.Hla(tb);this.Fif(Xb,!1);return gc}zEh(){const tb=this.oi?this.oi.length:0,gc=this.yA,Xb=this.wX;for(let Ga=0;Ga<tb;Ga++){const Za=this.JW(Ga),Sb=Ga>=gc;Za&&(Za.tabIndex=Sb&&Ga<=Xb?0:-1)}}ndk(){const tb=this.oi?this.oi.length:0;for(let gc=0;gc<tb;gc++){const Xb=this.JW(gc);Xb&&Xb.tkb()}}Fif(tb,gc){gc&&tb<=this.yA&&this.yA++;this.zEh();this.HVa(!0);this.q2();this.Wcc&&this.IS&&this.IUb()}DDc(tb){const gc=this.$.zN;if(tb||this.isRtl!==gc)this.isRtl=gc,this.domElement.classList.remove(this.isRtl?
oa.a.t_e:oa.a.x_e),this.domElement.classList.add(this.isRtl?oa.a.x_e:oa.a.t_e),this.domElement.dir=this.isRtl?"rtl":"ltr",this.ndk();tb||this.HVa(!0);for(tb=0;tb<this.TO.length;tb++)0!==tb&&3!==tb&&4!==tb&&5!==tb&&this.reg(tb)}Lph(){const tb=this.YZd=document.createElement("div");tb.className=V.IKh;tb.classList.add(V.JKh);this.domElement.appendChild(tb);this.TPe(tb,1,717,716);this.TPe(tb,2,719,718);this.Puf&&(this.OVa=new wb(this.$,this,tb))}Mph(){const tb=this.ZZd=document.createElement("div");tb.className=
V.KKh;this.domElement.appendChild(tb);this.xbd()}Rqh(){const tb=document.getElementById(t.a.eTj),gc=document.getElementById(t.a.fTj);tb&&!gc&&y.ULS.sendTraceTag(537153746,0,50,`CreateProgressBarArea - progressBar div is not null, separator div is null. progressBarDiv parent ID: ${tb.parentNode.id}. progressBar div has child: ${!!tb.firstChild}. ProgressBarMessage div exists: ${!!document.getElementById(t.a.OZd)}`);const Xb=ya.a.Uuf(this.$);if(Xb&&tb&&gc)this.domElement.appendChild(tb),this.JRb=tb.firstChild,
this.zEc=document.getElementById(t.a.OZd),gc.style.visibility="visible";else{const Ga=document.createElement("div"),Za=document.createElement("div");Ga.className=oa.a.RKh;Za.className=oa.a.PKh;Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:7103434_sheetTabProgressBarId")&&(Za.id=t.a.Ohb);Za.style.display="none";const Sb=document.createElement("div");Sb.className=oa.a.SKh;const sb=document.createElement("div");sb.className=oa.a.QKh;const bc=document.createElement("div");bc.className=oa.a.OKh;Za.appendChild(Sb);
Za.appendChild(sb);Za.appendChild(bc);Ga.appendChild(Za);this.domElement.appendChild(Ga);this.JRb=Za;this.zEc=sb;y.ULS.sendTraceTag(512275475,0,50,"SheetTabBarControl.createProgressBarArea: Create the progress bar in this function, because isSkeletonProgressBarEnabled = {0}, skeletonProgressBar={1}, skeletonProgressBarSeperator={2}.",Xb,tb,gc)}}reg(tb){var gc=this.TO[tb];if(gc){const Xb=gc.parentNode;this.i4f(gc);gc=pa.a(this.$)?this.JXf[tb]:this.OGd[tb];this.TO[tb]=this.svgIconProvider.dea(gc,12,
12,Xb,24,24)}}i4f(tb){(null===tb||void 0===tb?0:tb.parentNode)&&tb.parentNode.removeChild(tb)}pnh(){const tb=this.Shb=document.createElement("div");tb.className=V.CKh;this.domElement.appendChild(tb);this.Wrh(tb)}Wrh(tb){const gc=document.createElement("div");gc.className=V.UKh;gc.classList.add(V.DKh);this.$.printingEnabled||gc.classList.add(P.a.A1e);tb.appendChild(gc);this.Hn=document.createElement("ul");hb.DOMElementExtensions.xy(this.Hn,t.a.L4c,null,null);this.Hn.className=P.a.y_e;gc.appendChild(this.Hn);
this.Eph();this.sre=document.createElement("div");this.vEc.id="SheetIconTooltipContainer";gc.appendChild(this.vEc)}Eph(){const tb=document.createElement("div"),gc=document.createElement("div"),Xb=wa.a.p9e(oa.a.SLh);gc.className=oa.a.Dfh;gc.appendChild(Xb);tb.appendChild(gc);tb.className=V.TKh;hb.DOMElementExtensions.setVisible(tb,!1);this.Hn.appendChild(tb)}Pbd(){const tb=this.$.ua;for(let gc=0,Xb=tb.count;gc<Xb;gc++){const Ga=Object(S.a)(ta.a,tb.getItem(gc));0===Ga.qB&&(this.kac(Ga,!0),Ga.active&&
Ga.activate())}}X8c(){G.a.ed(this.oi);this.oi=[];this.wX=this.yA=0}TPe(tb,gc,Xb,Ga){const Za=document.createElement("a");tb.appendChild(Za);tb=this.OGd[gc];this.TO[gc]=this.Vb(Za,J.a.instance.ha(Ga),0,this.wYi[gc],J.a.instance.ha(Xb),tb);if(5===gc||4===gc)hb.DOMElementExtensions.CG(this.TO[gc],Za,!1,"span").style.marginTop="10px";this.reg(gc);Xb=this.NGd[gc]=this.kf.Re(Za);M.a.instance.ta(F.a.pointerDown,Za,sb=>sb.ctrlKey&&this.M3i(gc)?!0:this.XOf(gc));M.a.instance.ta(F.a.Zg,Za,()=>this.YOf());O.a.instance.ta(F.a.jf,
Za,()=>this.YOf());M.a.instance.ta(F.a.pointerOut,Za,()=>this.P8c());B.KeyInputManager.instance.ta(F.a.Ic,Za,sb=>13!==sb.Da.keyCode&&32!==sb.Da.keyCode||this.U$c?!1:(this.U$c=!0,this.XOf(gc)));B.KeyInputManager.instance.ta(F.a.De,Za,sb=>13===sb.Da.keyCode||32===sb.Da.keyCode?(this.U$c=!1,this.P8c()):!1);const Sb=this.rAe();Ga=sb=>{"mouseup"===sb.type&&this.IS||Ja.g(sb);!Za.classList.contains(Ea.a.MV)&&Sb&&this.T9i(sb,gc)};Xb.la("mouseover",Ga);Xb.la("mouseout",Ga);Xb.la("focus",Ga);Xb.la("blur",Ga);
Sb&&Xb.la("mouseup",Ga)}YBi(tb){let gc=!1;const Xb=this.$.og;Xb&&(gc=E.a.FS(hb.DOMElementExtensions.getBoundingClientRect(Xb),tb.clientPoint));return gc}IUb(){if(!this.$N){y.ULS.sendTraceTag(537153743,0,50,"SheetTabBarControl.UpdateDragAndDropState: Starting modern sheet tab drag and drop.");this.$N=this.bda.cloneNode(!0);if(!this.k$f(this.$N,this.bda,!0,"UpdateDragAndDropState"))return;this.bda.style.visibility="hidden";this.$N.classList.add(V.VKh);this.$N.style.borderRightWidth="";this.mjc=this.g6.clientPoint.x-
this.t6.width/2;this.$N.style.left=this.mjc+"px";this.AE=this.Hla(this.J1);0>this.AE&&y.ULS.sendTraceTag(537153742,0,15,"SheetTabBarControl.UpdateDragAndDropState: ghostIndex < 0!")}this.Wcc&&(this.AE=this.Hla(this.J1));var tb=hb.DOMElementExtensions.getBoundingClientRect(this.Hn);const gc=tb.x;tb=tb.x+tb.width;let Xb=this.g6.clientPoint.x-this.t6.width/2;Xb=Math.min(Xb,tb-this.t6.width);Xb=Math.max(Xb,gc);this.$N.style.transform="translateX("+Math.abs(Xb-this.mjc)*(this.mjc<Xb?1:-1)+"px)";const Ga=
this.g6.clientPoint.x>this.nHb;let Za=this.g6.clientPoint.x;Xb>=tb-this.t6.width?(Za=tb-this.t6.width/2,this.hWd()||this.Cpa||(y.ULS.sendTraceTag(537153741,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the right."),this.xwc=this.Hn.scrollLeft,this.Cpa=window.requestAnimationFrame(this.Lag))):Xb<=gc?(Za=gc+this.t6.width/2,this.gWd()||this.Cpa||(y.ULS.sendTraceTag(537153740,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the left."),
this.xwc=this.Hn.scrollLeft,this.Cpa=window.requestAnimationFrame(this.Kag))):this.Cpa&&(y.ULS.sendTraceTag(537153739,0,50,"SheetTabBarControl.UpdateDragAndDropState: Ending scroll as dragged sheet left renderd edge of stb."),this.C2d());this.g6.clientPoint.x!==this.nHb&&(this.p3d(Ga,Za),this.nHb=this.g6.clientPoint.x);this.ITc=!0}p3d(tb,gc){let Xb;for(;({e8b:Xb}=this.SAh(gc,tb)).returnValue;)this.qTb=Xb,this.L0g(tb)}L0g(tb){if(this.qTb){var gc=(tb?1:-1)*this.t6.width;if(tb&&!this.$.zN||!tb&&this.$.zN){var Xb=
this.bda;var Ga=this.AE+1;var Za=!0}else Xb=(Ga=this.JW(this.AE+1))?Ga.domElement:null,Ga=this.AE-1,Za=!1;if(this.k$f(this.qTb,Xb,Za,"AnimateSheetSwap")){y.ULS.sendTraceTag(537153738,0,50,`SheetTabBarControl.AnimateSheetSwap: Sheet swap between ghost-index ${this.AE} and other sheet-index ${Ga}. amount of sheets in the bar: ${this.WZd} isMovingRight: ${tb}`);0<=this.AE&&this.AE<this.oi.length&&0<=Ga&&Ga<this.oi.length?(tb=this.oi[Ga],this.oi[Ga]=this.oi[this.AE],this.oi[this.AE]=tb):(y.ULS.sendTraceTag(537153737,
0,15,`SheetTabBarControl.AnimateSheetSwap: indices are out of range! length: ${this.oi.length}, ghostIndex: ${this.AE}, swappedSheetIndex: ${Ga}`),this.hW());this.AE=Ga;var Sb=this.qTb;Sb.style.transform="translateX("+gc+"px)";window.requestAnimationFrame(()=>{Sb.style.transform="translateX(0px)"})}}}k$f(tb,gc,Xb,Ga){const Za=Sb=>Sb?`Node ID: ${Sb.id} , Node class: ${Sb.className}, Node name: ${Sb.nodeName},`:null;try{return this.Hn.insertBefore(tb,gc),!0}catch(Sb){return tb=this.lzb(this.J1),y.ULS.sendTraceTag(537153736,
0,15,"SheetTabBarControl.SafeInsertSheetBefore: Reference node is not a descendant of the sheet tab bar. sheetTabButonState: [{0}], Caller: [{1}], Node to insert before [{2}], That node's parent: [{3}],SheetTabListElement: [{4}], isReferenceSheetTheDraggedSheet:[{5}], ghostIndex:[{6}], sheetTabButtons length:[{7}], Exception: [{8}]",tb?tb!==this.Occ?"Changed":"NoChange":"Removed",Ga,Za(gc),Za(gc.parentNode),Za(this.Hn),Xb,this.AE,this.WZd,Sb),this.hW(),!1}}SAh(tb,gc){var Xb=this.$.zN===gc?this.JW(this.AE-
1):this.JW(this.AE+1);if(!Xb)return{returnValue:!1,e8b:null};Xb=Xb.domElement;const Ga=hb.DOMElementExtensions.getBoundingClientRect(Xb);return this.t6?gc?{returnValue:tb+this.t6.width/2>=Ga.x+.5*Ga.width,e8b:Xb}:{returnValue:tb-this.t6.width/2<=Ga.x+.5*Ga.width,e8b:Xb}:(y.ULS.sendTraceTag(537153735,0,50,"SheetTabBarControl.DraggedSheetCrossesSiblingSheet: Avoding JS crash and ending drag and drop due to client bounds of dragged sheet being null."),this.hW(),{returnValue:!1,e8b:Xb})}Iag(tb,gc){let Xb;
Xb=gc?this.Lag:this.Kag;if(-1===this.pGc)this.pGc=tb,this.Cpa=window.requestAnimationFrame(Xb);else{tb=Math.floor((tb-this.pGc)/1E3*300);var Ga=this.GPb>this.RHb?1:-1;this.scrollLeft(Math.abs(this.Hn.scrollLeft-(gc?this.xwc+tb*Ga:this.xwc-tb*Ga))*(gc?-1:1));if(tb=this.raf("ScrollStep"))this.p3d(gc,tb.x+tb.width/2),gc&&!this.hWd()||!gc&&!this.gWd()?this.Cpa=window.requestAnimationFrame(Xb):(y.ULS.sendTraceTag(537153734,0,50,"SheetTabBarControl.ScrollStep: Ending scroll as dragged sheet reached first/last sheet."),
this.C2d())}}hWd(){const tb=this.GPb>this.RHb;return tb&&this.gqa>=this.GPb||!tb&&this.gqa<=this.GPb}gWd(){const tb=this.GPb>this.RHb;return tb&&this.gqa<=this.RHb||!tb&&this.gqa>=this.RHb}C2d(tb=!0){this.Hn&&(this.gqa=this.Hn.scrollLeft);window.cancelAnimationFrame(this.Cpa);this.Cpa=0;this.pGc=-1;tb&&this.q2()}TXd(tb,gc){tb||y.ULS.sendTraceTag(537153733,0,50,`SheetTabBarControl.SetDraggedSheetTabButtonRect: DraggedSheetTabButtonRect set to null by ${gc}`);this.t6=tb}M3i(tb){return 2===tb?(this.zga(3),
!0):1===tb?(this.zga(0),!0):!1}XOf(tb){y.ULS.shipAssertTag(537153732,0,-1===this.nTa&&-1===this.mTa,"SheetTabBarControl.OnNavigateButtonDown: PeriodicNavigateSetTimeoutID and PeriodicNavigateSetIntervalID should be -1 on button down!");-1!==this.nTa&&(window.clearTimeout(this.nTa),this.nTa=-1);-1!==this.mTa&&(window.clearInterval(this.mTa),this.mTa=-1);this.zga(tb);this.nTa=window.setTimeout(()=>{this.h2j(tb)},this.kYi);return!0}h2j(tb){this.mTa=window.setInterval(()=>{this.zga(tb)},this.jYi)}YOf(){this.P8c();
return!this.IS}P8c(){window.clearTimeout(this.nTa);window.clearInterval(this.mTa);this.mTa=this.nTa=-1;return!0}T9i(tb,gc){const Xb=this.ync(gc),Ga=5===gc;"mouseup"!==tb.type||!Ga&&4!==gc||(Xb||this.reorderSheets(null,Ga,!1),this.hW())}ync(tb){return!!hb.DOMElementExtensions.Vmd(this.TO[tb],"a").title}lKc(tb){this.L7d(tb);this.q2()}L7d(tb){(tb=this.lzb(tb))&&tb.tkb()}kWd(){var tb=this.$.ua;if(tb.na&&(!Ob.e(this.$)||tb.count))if(tb=this.Hla(tb.na),-1===tb)y.ULS.sendTraceTag(537153729,0,50,"SheetTabBarControl.ScrollToActiveIndex: shouldn't have an invisible, active sheet");
else{var gc=this.qOa(tb);tb<this.yA?this.wCc(tb):tb>this.yA&&!this.Tzd(gc)&&this.scrollIntoView(tb)}}Dek(){this.yA=0;this.wX=this.oi.length-1;let tb=!1;for(let gc=0;gc<this.oi.length;gc++){const Xb=this.JW(gc);if(!Xb)break;const Ga=this.Tzd(Xb.domElement);Xb.tabIndex=Ga?0:-1;if(!tb&&Ga)this.yA=gc,tb=!0;else if(tb&&!Ga){this.wX=gc-1;break}}}wCc(tb){this.$.ua.count&&(this.oi.length||this.Pbd(),this.Bcg(this.qOa(Math.max(0,Math.min(tb,this.oi.length-1)))),this.q2())}scrollIntoView(tb){y.ULS.shipAssertTag(537153697,
0,tb>=this.yA,"SheetTabBarControl.ScrollIntoView: sheetTabIndex must be greater than the first visible sheet tab index!");if(this.$.ua.count){this.oi.length||this.Pbd();var gc=this.qOa(Math.max(0,Math.min(tb,this.oi.length-1))),Xb=this.qOa(this.yA);if(!this.Tzd(gc)){gc=hb.DOMElementExtensions.getBoundingClientRect(gc);var Ga=hb.DOMElementExtensions.getBoundingClientRect(this.Shb);gc=this.isRtl?Ga.x-gc.x:gc.x+gc.width-(Ga.x+Ga.width);for(Ga=0;Xb&&Ga<gc;){const Za=hb.DOMElementExtensions.getBoundingClientRect(Xb);
Ga+=Za.width;Xb=Xb.nextSibling}Xb?this.Bcg(Xb):y.ULS.sendTraceTag(537153696,0,15,`SheetTabBarControl.ScrollIntoView: new firstVisible is null. firstVisibleSheetTabIndex = ${this.yA}, lastVisibleSheetTabIndex = ${this.wX}, scroll to index: ${tb}`)}this.q2()}}Bcg(tb){const gc=hb.DOMElementExtensions.getBoundingClientRect(this.Hn);tb=hb.DOMElementExtensions.getBoundingClientRect(tb);this.isRtl?this.scrollLeft(Math.floor(gc.x+gc.width-(tb.x+tb.width+.5))):this.scrollLeft(Math.ceil(gc.x-tb.x-.5))}scrollLeft(tb){(0>
tb&&this.hWd()||0<tb&&this.gWd())&&y.ULS.sendTraceTag(537153695,0,50,"SheetTabBarControl.Scrollleft: attempt to scroll after the edge (overflow) in sheet tab bar.");const gc=this.Hn.scrollLeft;if(this.isRtl){if(D.a.WG||D.a.Bg){this.Hn.scrollLeft=this.gqa=gc-tb;return}if(D.a.TG){this.Hn.scrollLeft=this.gqa=gc+tb;return}y.ULS.sendTraceTag(537153694,0,15,"SheetTabBarControl.ScrollLeft: unknown browser")}this.Hn.scrollLeft=this.gqa=gc-tb}Tzd(tb){tb=hb.DOMElementExtensions.getBoundingClientRect(tb);const gc=
hb.DOMElementExtensions.getBoundingClientRect(this.Shb);return tb&&gc?tb.x>=gc.x-1&&tb.x+tb.width<=gc.x+gc.width+1:(y.ULS.sendTraceTag(537153693,0,15,"SheetTabBarControl.IsTabCompletelyVisible: sheetTabRect is null or contentAreaRect is null"),!1)}fqh(){const tb=this.ZZd;ma.Ugg(this.$)?(G.a.Ka(this.xS),this.xS=new ma(tb,this.$,this,!0)):(G.a.Ka(this.xS),aa.m(this.$.Df)?this.xS=new ka(tb,this.$,this):this.xS=new ma(tb,this.$,this))}cQe(tb,gc){var Xb=this.$.ua;if(!this.$.isEditMode||!Xb.count)G.a.Ka(gc),
gc=null;else if(!gc)if(Xb=this.YZd,aa.m(this.$.Df))gc=new ka(Xb,this.$,this);else switch(tb){case 0:gc=new ma(Xb,this.$,this);break;case 1:gc=new ra(Xb,this.$,this);break;default:y.ULS.sendTraceTag(537153692,0,10,"Unsupported SheetTabBarButtonType. Are you trying to create a new button? Make sure to update the SheetTabBarButtonType enum and add a case here to support creation of your new button.")}return gc}xbd(){this.MDi?(this.xS=this.cQe(0,this.xS),this.YDb=this.cQe(1,this.YDb)):this.fqh()}raf(tb){const gc=
hb.DOMElementExtensions.getBoundingClientRect(this.$N);gc||(y.ULS.sendTraceTag(537153689,0,50,`SheetTabBarControl.${tb}: GetBoundingClientRect returned null for the dragged sheet.`),this.hW());return gc}wif(tb,gc){this.Mwa.W1g(tb,gc);this.hW(!1);this.yYd(this.navigationButtonsDisabled);for(const Xb of this.V4j)Xb&&Xb.YT(this.navigationButtonsDisabled);for(const Xb of this.qEe)Xb&&Xb.YT(this.operationButtonsDisabled)}static NAj(tb,gc,Xb,Ga){tb<Xb?(gc>Xb&&Xb--,gc>Ga&&Ga--):tb>Ga?(gc<Xb&&Xb++,gc<Ga&&
Ga++):gc<Xb&&Xb++;return{uUh:Xb,lMi:Ga}}}Object(b.a)(lc,"SheetTabBarControl",Z.a,[381,2,26]);class tc extends m.a{constructor(tb){super();this.$=tb;this.uc()}create(){const tb=this.$.qc;if(z.a(this.$.xa,1))kb.PageLoadTrackingInfo.instance.oga(t.a.LDa,["sheetTabBar"]);else{var gc=document.getElementById(tb+t.a.Ucd);if(gc){kb.PageLoadTrackingInfo.instance.uqa(t.a.LDa);var Xb=f.GetServiceTaskFactory.Za(this.$.da,388,387,this.La);d.TaskExtensions.za(d.TaskExtensions.xe([Xb],this.$.ka),()=>{this.$b(this.$.da.Ba(32)||
new lc(this.$,gc,Xb.result))},this.$.ka,3)}else kb.PageLoadTrackingInfo.instance.oga(t.a.LDa,["sheetTabBar"])}}static la(tb){tb.da.Ja(33,new tc(tb))}}Object(b.a)(tc,"SheetTabBarFactory",m.a,[]);a.d(C,"a",function(){return Pb});const Pb=()=>{c.a.Fa(tb=>{tc.la(tb);w.la(tb)})}},1230:function(r,C,a){var c=a(10);r=a(0);var b=a(230),e=a(52),f=a(40),d=a(1),h=a(2),l=a(573),k=a(16),u=a(15),v=a(6),x=a(570),w=a(385),m=a(623);class t{constructor(){this.Alt=this.DisplayColor=this.Color=null}}Object(r.a)(t,"ColorCellProps",
null,[]);var z=a(425),y=a(20),D=a(54),H=a(217),F=a(209),G=a(32),L=a(235),M=a(126),O=a(218),B=a(271),E=a(12),I=a(358),S=a(23),J=a(19);class K{constructor(Ba){this.GNc=null;this.$=Ba;this.grid=J.h(this.$)}get borderFormatManager(){this.GNc||(this.GNc=this.$.da.Ba(296));return this.GNc}X7h(Ba){let fa=null;switch(Ba){case 467002767:Ba={};this.$.Qk(Ba);fa=Object(M.a)(I.a,this.$.ua).Nef(Ba.SheetName,!0);break;case -236759591:fa=this.Y0h();break;case 1970784898:fa=this.gaf(0);break;case 1650812936:case 1378078823:fa=
this.gaf(1);break;case -400966242:fa=this.getShapeOutlineColor();break;default:u.ULS.sendTraceTag(537154460,0,50,`ColorHighlighterHelper.GetHighlightColorBasedOnCommand: HighlightColor is not supported for ribbon command '${Ba}'`)}return fa}Y0h(){let Ba=null;this.borderFormatManager&&(Ba=this.borderFormatManager.d6);(Ba="black"===Ba?"000000":Ba)&&(Ba=G.a.h8a(Ba));return Ba}getShapeOutlineColor(){let Ba=null;if(this.grid.ga.Sa&&this.grid.ga.Sa.Pc){const fa=this.grid.ga.Sa.Pc.floatingObject;5===fa.type&&
fa.nc&&-1!==fa.nc.ShapeOutlineColor&&(Ba=F.a.HH(fa.nc.ShapeOutlineColor),Ba=Ba.toUpperCase())}return Ba}gaf(Ba){let fa=null;if(this.grid.ga.Sa&&this.grid.ga.Sa.Pc){var ta=this.grid.ga.Sa.Pc.floatingObject;5===ta.type&&ta.nc?1===Ba&&-1!==ta.nc.ShapeFillColor?(fa=F.a.HH(ta.nc.ShapeFillColor),fa=fa.toUpperCase()):u.ULS.sendTraceTag(537154459,0,50,"ColorHighlighterHelper.GetFontOrFillColor: HighlightColor for Font ColorPicker is not supported for Shapes."):u.ULS.sendTraceTag(537154458,0,50,"ColorHighlighterHelper.GetFontOrFillColor: HighlightColor for Font or Fill ColorPicker is not supported for Floating Object other than Shapes.");
return fa}ta=this.grid.Z5("ColorHighlighterHelper.GetFontOrFillColor",this.grid.ga.pa.selectedRanges,1,!0);try{for(ta.$$rst();ta.$$mn();){const Oa=ta.$$cu().cell;if(!Oa)continue;let Ma="#000000";if(0===Ba){Ma=Oa.color;if(d.EwaSettings.jc()&&this.grid.Ob)return this.M6h();Oa.hasRichText&&(Ma=this.N6h(Oa))}else if(1===Ba){const fb=Oa.backgroundColor;Ma=S.a.compare(fb,"transparent",!0)&&fb?Oa.backgroundColor:null}if(!fa)fa=Ma;else if(fa!==Ma){fa=null;break}}}finally{ta&&ta.dispose()}return fa}M6h(){var Ba=
null,fa=this.grid.Gc,ta=this.grid.cellTextEditBox.formattedText;if(ta){Ba=ta.TextRuns;const Oa=L.a.map(Ba,Ma=>Ma.StartIndex);ta=ta.Fonts;fa=fa.textBox.caretPosition;fa=E.HelperMethods.i4e(new O.a(Oa),Oa.length,fa,E.HelperMethods.eH);Ba=ta[Ba[fa].FontID].Color}return Ba?Ba.toUpperCase():null}N6h(Ba){Ba=B.a(Ba.formattedText.Fonts);if(B.e(Ba,32))(Ba=F.a.uga(F.a.HH(Ba.FontColor)))&&(Ba="#"+Ba.toUpperCase());else return null;return Ba}}Object(r.a)(K,"ColorHighlighterHelper",null,[410]);var R=a(324);class Z{constructor(Ba,
fa,ta){this.Pyc=this.USb=this.sEa=null;this.gbg="-1";this.$=Ba;this.moreColorsHelper=fa;this.themesManager=ta;this.NLe=new K(Ba);this.OE=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)}Kbf(Ba,fa=null,ta=null,Oa=null,Ma=null,fb=null,pa=null,Ua=null,Sa=null){return this.KV(null!=fa,null!=ta,null!=Oa,null!=Ua,!0,Ba,fa,ta,Oa,Ma,fb,pa,Ua,Sa)}Dfi(Ba,fa,ta,Oa){return this.KV(Ba,fa,ta,Oa,!1)}Lbf(Ba,fa=null,ta=null,Oa=null,Ma=null,fb=null){const pa=[];Ba=this.Kbf(Ba,fa,ta,Oa,void 0,
void 0,void 0,Ma,fb);for(let Ua=0,Sa=Ba.length;Ua<Sa;Ua++)pa.push(R.r(Ba[Ua]));return pa}KV(Ba,fa,ta,Oa,Ma,fb=null,pa=null,Ua=null,Sa=null,Ia=null,X=null,ca=null,U=null,ma=null){u.ULS.shipAssertTag(537154456,0,!Ma||null!=fb,"ColorPickerBuilder: must provide value for applyColorCommand if created for ribbon.");const ra=[];let Va=null,ob=3,ja=null,lb=null,wb=null;this.AEh();if(d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&this.$&&this.$.isEditMode&&!this.ikj(ma))return u.ULS.sendTraceTag(537154455,
0,50,`Theme Info not present at the time of ${ma} menu opening`),ra;Ba&&(Ma&&null==pa?u.ULS.shipAssertTag(537154454,0,!1,"ColorPickerBuilder: must provide automaticColorCommand when addAutomaticSection is true."):ra.push(this.oOa(Z.L4g,this.LXh(Z.iEe,pa,ca,X))));Ma&&null!=fb&&this.Frf()&&this.NLe&&(lb=ja="-1",Va=this.NLe.X7h(fb))&&(u.ULS.sendTraceTag(537154453,0,50,`ColorPickerBuilder: Highlighter color for the command ${fb} is not null .`),Va=F.a.uga(Va),ob=this.Maf(Va),ja=this.ipd(Va,ob,0,!0),lb=
this.ipd(Va,ob,1,!1));ra.push(this.oOa(Z.n6j,this.Skd(Z.qog,ja,this.sEa,fb,Ia,X),1341));ra.push(this.oOa(Z.C1j,this.Skd(Z.B1j,lb,this.USb,fb,Ia,X),1342));this.$&&this.$.isEditMode&&this.moreColorsHelper&&(this.gkj(),Ma&&this.Frf()&&(wb="-1",Va&&(wb=this.ipd(Va,ob,2,!0))),this.moreColorsHelper&&this.moreColorsHelper.YHb&&0<this.moreColorsHelper.YHb.count&&ra.push(this.oOa(Z.fsj,this.Skd(Z.esj,wb,this.Pyc,fb,Ia,X),1349)));fa&&(Ma&&null==Ua?u.ULS.shipAssertTag(537154452,0,!1,"ColorPickerBuilder: must provide clearColorCommand when addClearColorSection is true."):
ra.push(this.oOa(Z.dZi,this.OXh(Z.bKe,Ua,this.w2h(Ua),ca,X))));ta&&(v.AFrameworkApplication.NO("XLS-HighlightWhenCFExperiment-Treatment;XLS-HighlightWhenCFExperiment-Control"),d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.HighlightWhenCFExperiment",!1)&&(Ma&&!Sa?u.ULS.shipAssertTag(520668946,0,!1,"ColorPickerBuilder: must provide highlightWhenCommand when addHighlightWhenSection is true."):ra.push(this.oOa(Z.mqi,this.qYh(Z.Pkf,Sa)))));Oa&&(Ma&&null==U?u.ULS.shipAssertTag(537154451,0,
!1,"ColorPickerBuilder: must provide moreColorsCommand when addMoreColorsSection is true."):ra.push(this.oOa(Z.eXi,this.OYh(Z.eFf,U,this.p$h(U)))));return ra}ipd(Ba,fa,ta,Oa){3===fa&&(fa=this.Maf(Ba));return this.OE&&0===ta&&fa===ta?this.gbg.toLowerCase():fa===ta?Oa?Ba.toLowerCase():Ba:"-1"}Maf(Ba){if(!Ba)return 3;const fa=Ba.toLowerCase();if(this.OE){if(this.sEa&&this.tJi(fa,this.sEa))return 0}else if(this.sEa&&this.dwd(fa,this.sEa))return 0;return this.USb&&this.dwd(Ba,this.USb)?1:this.Pyc&&this.dwd(fa,
this.Pyc)?2:3}oOa(Ba,fa,ta=null){Ba=Object(h.a)(new x.a,{Id:Ba,Title:null!=ta?k.a.instance.ha(ta):"",ControlList:[],ControlsId:Ba+".Controls"});Ba.ControlList.push(fa);return Ba}OXh(Ba,fa,ta,Oa=null,Ma=null){return this.V6e(Ba,fa,ta,y.a.E_e,"transparent",Oa,Ma)}qYh(Ba,fa){return Object(h.a)(new w.a,{Command:null!=fa?fa.toString():null,LabelText:k.a.instance.ha(1433),Id:Ba,ExternalId:this.O7a(Ba,fa),ExternalImageId:"JotNotebookColor2_20"})}LXh(Ba,fa,ta=null,Oa=null){return this.V6e(Ba,fa,542,y.a.D_e,
"000000",ta,Oa)}V6e(Ba,fa,ta,Oa,Ma,fb=null,pa=null){return Object(h.a)(new w.a,{Command:null!=fa?fa.toString():null,CommandPreviewId:null!=fb?fb.toString():null,CommandRevertId:null!=pa?pa.toString():null,MenuItemsStatefulData:this.Z9h(Ba,fa,Ma),LabelText:k.a.instance.ha(ta),Id:Ba,ExternalId:this.O7a(Ba,fa),Image16by16:D.a.yg(1),Image16by16Class:Oa})}Z9h(Ba,fa,ta){const Oa={};Ba=this.O7a(Ba,fa);Oa[Ba]={};Oa[Ba].iconColor=ta;return Oa}dwd(Ba,fa){for(let ta=0;ta<fa.length;ta++)if(Ba===fa[ta].Color)return!0;
return!1}DHi(Ba,fa){Ba=F.a.mq(Ba);fa=F.a.mq(fa);return 1>=Math.abs(Ba.r-fa.r)&&1>=Math.abs(Ba.g-fa.g)&&1>=Math.abs(Ba.b-fa.b)?!0:!1}tJi(Ba,fa){for(let ta=0;ta<fa.length;ta++){const Oa=fa[ta].Color;if(this.DHi(Ba,Oa))return this.gbg=Oa.toLowerCase(),!0}return!1}Skd(Ba,fa,ta,Oa,Ma=null,fb=null){return Object(h.a)(new m.a,{McuLayout:!0,Command:null!=Oa?Oa.toString():null,CommandPreviewId:null!=Ma?Ma.toString():null,CommandRevertId:null!=fb?fb.toString():null,Width:10,Id:`${Ba}.ColorPicker`,SelectedColorId:fa,
Colors:ta,Stateful:!0,ExternalId:this.O7a(Ba,Oa),McuExternalId:`${this.O7a(Ba,Oa)}.MCU`})}O7a(Ba,fa){return`${Ba}.${null!=fa?fa.toString():""}`}lgc(...Ba){const fa=[];for(let ta=0,Oa=Ba.length;ta<Oa;ta+=2)fa.push(Object(h.a)(new t,{Color:Ba[ta],DisplayColor:F.a.nK(H.a.BG(parseInt(String("0x"+Ba[ta]),16))),Alt:Object(z.a)(String,Ba[ta+1])&&this.$?Ba[ta+1]:k.a.instance.ha(Ba[ta+1])}));return fa}OYh(Ba,fa,ta){const Oa=y.a.V_e;Ba=Object(h.a)(new w.a,{Command:null!=fa?fa.toString():null,LabelText:k.a.instance.ha(ta),
Id:Ba,ExternalId:this.O7a(Ba,fa),Image16by16:D.a.yg(1),Image16by16Class:Oa});Ba.ShouldTakeFocus=!1;return Ba}AEh(){this.sEa||(this.sEa=this.lgc("ffffff",1360,"000000",1361,"e6e6e7",1362,"6a5444",1363,"c47244",1364,"317ded",1365,"a5a5a5",1366,"00c0ff",1367,"d59b5b",1368,"47ad70",1369,"f2f2f2",1370,"808080",1371,"ceced0",1372,"e4dcd6",1373,"f2e1d9",1374,"d6e4fc",1375,"ededed",1376,"ccf2ff",1377,"f7ebdd",1378,"daefe2",1379,"d9d9d9",1380,"595959",1381,"aaaaae",1382,"cab9ac",1383,"e7c6b4",1384,"adcbf8",
1385,"dbdbdb",1386,"99e6ff",1387,"eed7bd",1388,"b4e0c6",1389,"bfbfbf",1390,"404040",1391,"717175",1392,"b09784",1393,"dba98e",1394,"84b0f4",1395,"c9c9c9",1396,"66d9ff",1397,"e6c29b",1398,"8ed0a9",1399,"a6a6a6",1400,"262626",1401,"38383a",1402,"4f3f33",1403,"965430",1404,"1159c6",1405,"7b7b7b",1406,"008fbf",1407,"b5752f",1408,"358254",1409,"808080",1410,"0d0d0d",1411,"161616",1412,"352b22",1413,"643720",1414,"0c3c83",1415,"525252",1416,"006080",1417,"784e1f",1418,"235637",1419));this.USb||(this.USb=
this.lgc("0000C0",1355,"0000FF",1352,"00C0FF",1354,"00FFFF",1356,"50D092",1357,"50B000",1358,"F0B000",1359,"C07000",1351,"602000",1350,"A03070",1353))}gkj(){this.moreColorsHelper.Iid();if(this.moreColorsHelper.YHb){var Ba=this.moreColorsHelper.YHb;const fa=[];for(let ta of Ba)Ba=F.a.uga(ta.substr(1)),fa.push(Ba,ta);this.Pyc=this.lgc(...fa)}}ikj(Ba){this.themesManager.Tec(Ba);if(this.themesManager.fjb&&this.themesManager.rog&&!this.themesManager.$zd){Ba=this.themesManager.fjb;const fa=this.themesManager.rog,
ta=[];for(let Oa=0;Oa<Ba.count;Oa++)ta.push(Ba.ma(Oa),fa.ma(Oa));this.sEa=this.lgc(...ta);return!0}return!1}p$h(Ba){switch(Ba){case -458147525:Ba=1344;break;case 1610379174:Ba=1345;break;default:Ba=1343}return Ba}w2h(Ba){switch(Ba){case 1549407384:Ba=541;break;case -1744769642:Ba=539;break;default:Ba=540}return Ba}Frf(){return d.EwaSettings.ya(580)}}Z.dZi="NoColor";Z.L4g="Automatic";Z.n6j="ThemeColors";Z.C1j="StandardColors";Z.fsj="RecentColors";Z.bKe="ClearColor";Z.mqi="HighlightWhen";Z.Pkf="HighlightWhen";
Z.iEe="AutomaticColor";Z.qog="ThemeColorPicker";Z.B1j="StandardColorPicker";Z.eXi="MoreColors";Z.eFf="MoreColors";Z.esj="RecentColorPicker";Object(r.a)(Z,"ColorPickerBuilder",null,[]);var P=a(357);class V{constructor(){this.sections=null}}Object(r.a)(V,"ColorPickerButtonMenuProps",null,[]);class Ea{constructor(){this.title=null;this.type=0;this.buttonProps=this.colorSwatchProps=null}}Object(r.a)(Ea,"ColorPickerButtonMenuSection",null,[]);class oa{constructor(){this.id=this.label=this.color=null;this.index=
0}}Object(r.a)(oa,"ColorPickerColorProps",null,[]);class ea{constructor(){this.type=0;this.label=null}}Object(r.a)(ea,"ColorPickerSectionButtonProps",null,[]);class aa{constructor(){this.colors=null;this.isThemeColorSection=this.notifyOnColorUsed=!1}}Object(r.a)(aa,"ColorPickerSectionColorSwatchProps",null,[]);class ia{constructor(){this.row=this.index=0}}Object(r.a)(ia,"ThemeColorInfo",null,[]);class ya{constructor(Ba,fa,ta,Oa){this.$=Ba;this.UC=fa;this.moreColorsHelper=ta;this.themesManager=Oa;
this.sJi=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)}getColorPickerButtonMenuProps(Ba){Ba=this.UC.aff(Ba.automaticColor,Ba.clearColor,Ba.highlightWhen,Ba.moreColors);const fa=new V;fa.sections=this.Mci(Ba);return fa}showMoreColorsDialog(Ba,fa){this.moreColorsHelper.UMi(Ba,void 0,fa)}onColorUsed(Ba){Ba=H.a.BG(F.a.TI(F.a.uga(Ba),!1));this.moreColorsHelper.QVd(Ba.r,Ba.g,Ba.b,P.a.MLc)}getThemeColor(Ba){Ba=F.a.uga(Ba);let fa;if(!({themeIndex:Ba,tEa:fa}=this.themesManager.getThemeColor(Ba)).returnValue)return u.ULS.shipAssertTag(538514630,
0,!1,"ColorPickerButtonController: invalid theme color in GetThemeColor."),null;const ta=new ia;ta.index=Ba;ta.row=fa;return ta}Mci(Ba){const fa=[];for(let Oa=0;Oa<Ba.length;Oa++){var ta=Object(M.a)(x.a,Ba[Oa]);const Ma=new Ea;Ma.title=ta.Title;const fb=Object(M.a)(m.a,ta.ControlList[0]);fb?(Ma.type=1,Ma.colorSwatchProps=this.K2h(fb),fa.push(Ma)):(ta=Object(M.a)(w.a,ta.ControlList[0]))&&null!=this.r9e(ta.Id)?(Ma.type=2,Ma.buttonProps=new ea,Ma.buttonProps.type=this.r9e(ta.Id),Ma.buttonProps.label=
ta.LabelText,fa.push(Ma)):u.ULS.shipAssertTag(542200588,0,!1,"ColorPickerButtonController: Unknown color menu control type")}return fa}K2h(Ba){const fa=new aa,ta=Ba.Colors;fa.colors=Array(ta.length);fa.notifyOnColorUsed=this.moreColorsHelper.yhg(Ba.ExternalId);fa.isThemeColorSection=this.sJi&&!!Ba.ExternalId&&Ba.ExternalId.includes(Z.qog);for(Ba=0;Ba<ta.length;Ba++)fa.colors[Ba]=new oa,fa.colors[Ba].id=ta[Ba].DisplayColor,fa.colors[Ba].color=ta[Ba].DisplayColor,fa.colors[Ba].label=ta[Ba].Alt,fa.colors[Ba].index=
Ba;return fa}r9e(Ba){switch(Ba){case Z.eFf:return 1;case Z.bKe:return 2;case Z.iEe:return 3;case Z.Pkf:return 4}return null}}Object(r.a)(ya,"ColorPickerButtonController",null,[398]);class za{constructor(Ba,fa,ta){this.dr=this.Wk=null;this.$=Ba;this.moreColorsHelper=fa;this.D9g();this.C9g();this.themesManager=ta;this.w9b=new Z(Ba,fa,ta)}D9g(){this.Wk={};this.Wk.style0=1535;this.Wk.style1=1536;this.Wk.style2=1537;this.Wk.style3=1538;this.Wk.style4=1539;this.Wk.style5=1540;this.Wk.style6=1541;this.Wk.style7=
1542;this.Wk.style8=1543;this.Wk.style9=1544;this.Wk.style10=1545;this.Wk.style11=1546;this.Wk.style12=1547;this.Wk.style13=1548;this.Wk.style14=1549;this.Wk.style15=1550;this.Wk.style16=1551;this.Wk.style17=1552;this.Wk.style18=1553;this.Wk.style19=1554;this.Wk.style20=1555;this.Wk.style21=1556;this.Wk.style22=1557;this.Wk.style23=1558;this.Wk.style24=1559;this.Wk.style25=1560;this.Wk.style26=1561;this.Wk.style27=1562;this.Wk.style28=1563;this.Wk.style29=1564;this.Wk.style30=1565;this.Wk.style31=
1566;this.Wk.style32=1567;this.Wk.style33=1568;this.Wk.style34=1569;this.Wk.style35=1570;this.Wk.style36=1571;this.Wk.style37=1572;this.Wk.style38=1573;this.Wk.style39=1574;this.Wk.style40=1575;this.Wk.style41=1576}C9g(){this.dr={};this.dr.style0=1507;this.dr.style1=1508;this.dr.style2=1509;this.dr.style3=1510;this.dr.style4=1511;this.dr.style5=1512;this.dr.style6=1513;this.dr.style7=1514;this.dr.style8=1515;this.dr.style9=1516;this.dr.style10=1517;this.dr.style11=1518;this.dr.style12=1519;this.dr.style13=
1520;this.dr.style14=1521;this.dr.style15=1522;this.dr.style16=1523;this.dr.style17=1524;this.dr.style18=1525;this.dr.style19=1526;this.dr.style20=1527;this.dr.style21=1528;this.dr.style22=1529;this.dr.style23=1530;this.dr.style24=1531;this.dr.style25=1532;this.dr.style26=1533;this.dr.style27=1534}s9e(Ba){return R.i(this.w9b.Lbf(Ba,null,null,null,null,null))}Ygc(Ba,fa=null,ta=null,Oa=null,Ma=null,fb=null,pa=null,Ua=null,Sa=null){return Object(h.a)(new l.a,{MenuSectionList:this.w9b.Kbf(Ba,fa,ta,Oa,
Ma,fb,pa,Ua,Sa),UpdateDynamically:!0})}aff(Ba,fa,ta,Oa){return this.w9b.Dfi(Ba,fa,ta,Oa)}L2h(Ba,fa=null,ta=null,Oa=null,Ma=null,fb=null){return this.w9b.Lbf(Ba,fa,ta,Oa,Ma,fb)}Mic(Ba,fa=!1){return fa?this.dr[Ba]:this.Wk[Ba]}bnh(){return new ya(this.$,this,this.moreColorsHelper,this.themesManager)}}Object(r.a)(za,"PopulateDynamicHelper",null,[377]);var la=a(72),xa=a(149),wa=a(35),hb=a(100);class Ja extends b.a{constructor(Ba,fa){super();this.UC=null;this.$=fa;Ba.Ja(111,this);this.uc()}create(){if(d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",
!1)||d.EwaSettings.Um()){const Ba=e.GetServiceTaskFactory.Za(this.$.da,398,397,this.La),fa=Object(la.b)("OfficeVSO:7628240_migrateThemesManagerToNewServiceInfra")?Object(hb.d)(xa.a.resolve(wa.Fb,{Wa:this.La})):e.GetServiceTaskFactory.Za(this.$.da,422,421,this.La);f.TaskExtensions.za(f.TaskExtensions.xe([Ba,fa],this.ka),()=>{this.$b(this.UC||(this.UC=new za(this.$,Ba.result,fa.result)))},this.ka,3)}else f.TaskExtensions.za(e.GetServiceTaskFactory.Za(this.$.da,398,397,this.La),Ba=>{this.$b(this.UC||
(this.UC=new za(this.$,Ba.result,null)))},this.ka,3)}}Object(r.a)(Ja,"PopulateDynamicHelperFactory",b.a,[]);a.d(C,"a",function(){return Fa});const Fa=()=>{c.a.Fa(Ba=>{new Ja(Ba.da,Ba)})}},1235:function(r,C,a){var c=a(10);r=a(0);var b=a(230),e=a(52),f=a(40),d=a(2),h=a(15),l=a(20),k=a(7),u=a(38),v=a(922);class x{constructor(la,xa,wa=null,hb,Ja=null,Fa=null,Ba,fa=null,ta=null){this.mCe=xa;this.hEe=wa;this.aKe=Ja;this.Okf=Fa;this.dFf=fa;this.UC=la;this.menuId=ta}vV(){let la="";const xa=this.UC.L2h(this.mCe,
this.hEe,this.aKe,this.Okf,this.dFf,this.menuId);for(const wa of xa)la+=wa;return la}$F(){return this.UC.Ygc(this.mCe,this.hEe,this.aKe,this.Okf,void 0,void 0,void 0,this.dFf,this.menuId)}}Object(r.a)(x,"RibbonColorPicker",null,[480]);var w=a(579);class m{constructor(la,xa=""){this._id=la;this.JD=xa}get id(){return this._id}get text(){return this.JD}get label(){throw Error.notImplemented("RibbonLabel doesn't have get implementation for the Label property");}set label(la){throw Error.notImplemented("RibbonLabel doesn't have set implementation for the Label property");
}get alt(){throw Error.notImplemented("RibbonLabel doesn't have get implementation for the Alt property");}get disabled(){throw Error.notImplemented("RibbonLabel doesn't have get implementation for the Disabled property");}vV(){return`<Label id="${this._id}" LabelText="${this.JD}" />`}MT(){throw Error.notImplemented("RibbonLabel doesn't have SetImage implementation ");}cRb(){throw Error.notImplemented("RibbonLabel doesn't have SetCustomizedImage implementation ");}JT(){throw Error.notImplemented("RibbonLabel doesn't have SetAlt implementation ");
}X8b(){throw Error.notImplemented("RibbonLabel doesn't have ClearImage implementation ");}bka(){return Object(d.a)(new w.a,{Id:this.id,LabelText:this.text})}}Object(r.a)(m,"RibbonLabel",null,[482,479,480]);var t=a(573),z=a(425),y=a(126),D=a(324);class H{constructor(la){this.$Kg=[];this.id=la}get hd(){return this.$Kg}vV(){return D.q(this.$F())}$F(){const la=Object(d.a)(new t.a,{Id:this.id,UpdateDynamically:!0,MenuSectionList:[]});for(const xa of this.hd)Object(z.a)(x,xa)?la.MenuSectionList.push(...Object(y.a)(x,
xa).$F().MenuSectionList):la.MenuSectionList.push(xa.o7b());return la}}Object(r.a)(H,"RibbonMenu",null,[481,480]);var F=a(570);class G{constructor(){this.title=null;this.kZ=[];this.Nq="Menu16";this.Wog=this.Gjg=this.Hjg=!0}get buttons(){return this.kZ}vV(){return D.r(this.o7b())}o7b(){const la=Object(d.a)(new F.a,{ControlList:[]});if(1===this.buttons.length&&Object(z.a)(478,this.buttons[0]))la.ControlList.push(this.buttons[0].n7b());else{let wa="";for(let hb=0;hb<this.buttons.length;hb++){var xa=
Object(y.a)(479,this.buttons[hb]);xa&&(xa=xa.bka(),la.ControlList.push(xa),wa+=xa.Id)}la.ControlsId=wa+".Controls"}la.Title=this.title;la.DisplayMode=this.Nq;la.ShowMenuSectionTitleIcon=this.Hjg;la.ShowMenuSectionTitleBackground=this.Gjg;la.MenuSectionTitleFocusable=this.Wog;return la}}Object(r.a)(G,"RibbonMenuSection",null,[439,480]);class L{constructor(la,xa,wa,hb,Ja,Fa,Ba,fa,ta,Oa,Ma,fb,pa=null){this.id=la;this.command=wa;this.zWf=hb;this.populateOnlyOnce=Ja;this.ITa=Fa;this.dkj=Ba;this.alt=fa;
this.A5b=ta;this.width=Oa;this.o0g=Ma;this.mA=fb;this.Gta=new H(xa);this.stb=pa;hb&&Ba&&(la=new G,la.Nq="MenuLoading",xa=new m(xa+"LoadingLabel"),la.buttons.push(xa),this.menu.hd.push(la))}vV(){return this.H7g()}get menu(){return this.Gta}H7g(){let la=D.d(this.id,this.command,this.zWf,this.populateOnlyOnce,this.ITa,this.dkj,this.alt,this.A5b,this.width);const xa=la.indexOf(" />");la=la.substring(0,xa);la+=` ${"AllowDefaultContent"}="${this.o0g.toString()}"`;la+=` ${"AutoComplete"}="${this.mA?"true":
"false"}"`;this.stb&&(la+=` ${"ArrowImgId"}="${this.stb}"`);la=la+">"+this.menu.vV();return la+"</ComboBox>"}}Object(r.a)(L,"RibbonComboBox",null,[483,480]);var M=a(1045),O=a(923),B=a(16);class E extends O.a{constructor(la,xa,wa,hb,Ja,Fa,Ba,fa,ta,Oa,Ma,fb=null,pa=null){super(la,xa,wa,Ja,Fa,Ba,fa,Ma,0);this.qnb=null;this.taa=0===ta?null:B.a.instance.ha(ta);this.DVc=Oa;this.vXc=hb;this.iPg=fb;this.Ln=pa}get description(){return this.taa}get mAb(){return this.qnb}get menuItemId(){return this.DVc}get ITa(){return this.vXc}get styles(){return this.iPg}get data(){return this.Ln}vV(){return D.n(this.bka())}ADc(la){this.taa=
la}toString(){this.mAb||(this.qnb=this.vV());return this.mAb}bka(){const la=new M.a;this.afc(la);la.MenuItemId=this.menuItemId;la.QueryCommand=this.ITa;la.Description=this.description;la.Styles=this.styles;la.Data=this.data;return la}}Object(r.a)(E,"RibbonComboBoxItem",O.a,[440,479,480]);var I=a(578);class S extends O.a{constructor(la,xa,wa,hb,Ja,Fa,Ba,fa){super(la,wa,hb,Ja,Fa,Ba,fa,!1,0);this.populateOnlyOnce=!1;this.eHb=this.menuCloseCommand=this.menuOpenCommand=this.ny=null;this.Gta=new H(xa);
this.Vlf=!0}get menu(){return this.Gta}vV(){return D.o(this.bka())}bka(){const la=new I.a;this.afc(la);la.PopulateOnlyOnce=this.populateOnlyOnce;la.MenuCloseCommand=null==this.menuCloseCommand?null:this.menuCloseCommand.toString();la.MenuOpenCommand=null==this.menuOpenCommand?null:this.menuOpenCommand.toString();la.PopulateQueryCommand=this.ny;la.KeyTip=this.eHb;la.Menu=this.menu.$F();la.ImageIsVisible=this.Vlf;return la}}Object(r.a)(S,"RibbonFlyoutAnchor",O.a,[441,479,480]);var J=a(1370),K=a(595),
R=a(54);class Z{constructor(){this.k7a=[];this.id=null;this.width=0;this.title=this.kla=null}vV(){return D.p(this.n7b())}wu(la,xa,wa,hb=0,Ja=null,Fa=null,Ba=null,fa=null,ta=null,Oa=null){this.tnf(this.k7a.length,la,xa,wa,0===hb?ta:B.a.instance.ha(hb),Ja,Fa,Ba,fa,Oa)}tnf(la,xa,wa,hb,Ja,Fa=null,Ba=null,fa=null,ta=null,Oa=null){(la>this.k7a.length||0>la)&&Error.argumentOutOfRange("Invalid Index");this.k7a.splice(la,0,Object(d.a)(new J.a,{Id:xa,Command:wa.toString(),QueryCommand:null!==hb&&void 0!==hb?
hb:null,Alt:Ja,MenuItemId:Fa,Icon:Ba,Image:fa?R.a.yg(fa):null,ImageClass:ta,LabelText:Oa}))}n7b(la=!1){let xa=null,wa=null;switch(this.kla){case "Size120by20":xa=this.mub(120,20,la);wa=this.kub(130,30,la);break;case "Size90by21":xa=this.mub(90,21,la);wa=this.kub(100,33,la);break;case "Size24by24With7Options":xa=this.mub(28,28,la);wa=this.kub(34,38,la);break;case "Size24by24":xa=this.mub(28,28,la);wa=this.kub(38,38,la);break;case "Size112by64":xa=this.mub(24,24,la),wa=this.kub(112,64,la)}for(la=0;la<
this.k7a.length;la++)this.k7a[la].FullIconStyle=xa;return Object(d.a)(new K.a,{Id:this.id,ExternalId:this.id,Type:4,Title:this.title,Width:this.width,ElementDimensions:this.kla,GalleryItems:this.k7a,GalleryStyle:wa})}mub(la,xa,wa){const hb={},Ja={};Ja.width=la;Ja.height=xa;wa&&(Ja.alignSelf="center",Ja.marginBottom="4px");hb.root=Ja;return hb}kub(la,xa,wa){const hb={},Ja={},Fa={};Fa.width=la;Fa.height=xa;Ja.root=Fa;wa&&(Ja.flexContainer={display:"flex",flexDirection:"column",alignItems:"stretch"});
hb.galleryButtonInExpanded=Ja;return hb}}Object(r.a)(Z,"RibbonGallery",null,[478,480]);var P=a(1036),V=a(739);class Ea{constructor(la=null){this.UC=la}Er(la=null){return new H(la)}zd(){return new G}Vb(la){var xa=u.a.Ad(Ea.i3a,la.toString());if(xa)return xa;switch(la){case 236:return this.Vn(la,"ContextMenu.Show.IdeasNLPane",-1336341324,743);case 237:return this.Vn(la,"ContextMenu.Show.IdeasNLPane",-1336341324,744);case 238:return this.Vn(la,"ContextMenu.Show.IdeasNLPane",-1336341324,745);case 249:return this.Jd(la,
"ContextMenu.Show.ChartTaskPane",1221897806,l.a.Y0e,4,983);case 287:return this.Jd(la,"ContextMenu.Show.ChartTaskPaneData",1930653487,null,4,890,void 0,void 0,"ChartSourceData_20");case 141:return this.dj(la,"DataLabels.None.BoxWhisker",374300079,l.a.G0e,929,930,1600);case 0:return this.dj(la,"DataLabels.None.Column",374300079,l.a.F0e,929,930,1600);case 1:return this.dj(la,"DataLabels.None.Line",374300079,l.a.H0e,929,930,1600);case 2:return this.dj(la,"DataLabels.None.Pie",374300079,l.a.I0e,929,930,
1600);case 3:return this.dj(la,"DataLabels.Show.Column",-1809877936,l.a.gec,931,932,1601);case 143:return this.dj(la,"DataLabels.Show.Funnel",-1809877936,l.a.gec,931,934,1601);case 144:return this.dj(la,"DataLabels.Show.Treemap",-1809877936,l.a.ghd,931,938,1601);case 145:return this.dj(la,"DataLabels.Show.Sunburst",-1809877936,l.a.fhd,931,934,1601);case 4:return this.dj(la,"DataLabels.Center.Column",-1996266048,l.a.gec,933,934,1602);case 5:return this.dj(la,"DataLabels.Center.Line",-1996266048,l.a.A0e,
933,934,1602);case 6:return this.dj(la,"DataLabels.Center.Pie",-1996266048,l.a.fhd,933,934,1602);case 7:return this.dj(la,"DataLabels.InsideEnd.Column",493396546,l.a.B0e,935,936,1603);case 8:return this.dj(la,"DataLabels.InsideEnd.Pie",493396546,l.a.C0e,935,936,1603);case 9:return this.dj(la,"DataLabels.InsideBase.Column",1599247052,l.a.ghd,937,938,1604);case 10:return this.dj(la,"DataLabels.OutsideEnd.Column",342855531,l.a.J0e,939,940,1605);case 11:return this.dj(la,"DataLabels.OutsideEnd.Pie",342855531,
l.a.K0e,939,940,1605);case 140:return this.dj(la,"DataLabels.Left.BoxWhisker",-472675112,l.a.E0e,941,942,1606);case 12:return this.dj(la,"DataLabels.Left.Line",-472675112,l.a.D0e,941,942,1606);case 142:return this.dj(la,"DataLabels.Right.BoxWhisker",-1774499423,l.a.M0e,943,944,1607);case 13:return this.dj(la,"DataLabels.Right.Line",-1774499423,l.a.L0e,943,944,1607);case 138:return this.dj(la,"DataLabels.Above.BoxWhisker",-204160914,l.a.w0e,945,946,1608);case 14:return this.dj(la,"DataLabels.Above.Line",
-204160914,l.a.N0e,945,946,1608);case 139:return this.dj(la,"DataLabels.Below.BoxWhisker",-87783054,l.a.x0e,947,948,1609);case 15:return this.dj(la,"DataLabels.Below.Line",-87783054,l.a.z0e,947,948,1609);case 16:return this.dj(la,"DataLabels.BestFit.Pie",1650379138,l.a.y0e,949,950,1610);case 17:return this.dj(la,"Axes.Horizontal.None",895828731,l.a.l0e,929,951,1613);case 18:return this.dj(la,"Axes.Horizontal.ShowLTR",683614408,l.a.dhd,952,953,1614);case 19:return this.dj(la,"Axes.Horizontal.NoLabels",
-1612014670,l.a.k0e,956,957,1615);case 20:return this.dj(la,"Axes.Horizontal.ShowRTL",1259259728,l.a.m0e,958,959,1616);case 21:return this.dj(la,"Axes.Horizontal.Default",683614408,l.a.dhd,954,955,1617);case 22:return this.dj(la,"Axes.Horizontal.Thousands",-220179662,l.a.n0e,960,961,1618);case 23:return this.dj(la,"Axes.Horizontal.Millions",1534680966,l.a.j0e,962,963,1619);case 24:return this.dj(la,"Axes.Horizontal.Billions",-238895611,l.a.h0e,964,965,1620);case 25:return this.dj(la,"Axes.Horizontal.LogScale",
-892714755,l.a.i0e,966,967,1621);case 26:return this.dj(la,"Axes.Vertical.None",2006508979,l.a.s0e,929,951,1613);case 27:return this.dj(la,"Axes.Vertical.Default",252405382,l.a.u0e,954,955,1617);case 28:return this.dj(la,"Axes.Vertical.Thousands",670842692,l.a.v0e,960,961,1618);case 29:return this.dj(la,"Axes.Vertical.Millions",-572426128,l.a.q0e,962,963,1619);case 30:return this.dj(la,"Axes.Vertical.Billions",-806496391,l.a.o0e,964,965,1620);case 31:return this.dj(la,"Axes.Vertical.LogScale",-1700998151,
l.a.p0e,966,967,1621);case 32:return this.dj(la,"Axes.Vertical.NoLabels",2104548628,l.a.r0e,956,957,1615);case 33:return this.dj(la,"Axes.Vertical.ShowRTL",1717508862,l.a.t0e,958,959,1616);case 34:return this.dj(la,"Gridlines.Horizontal.None",80515665,l.a.S0e,929,970,1624);case 35:return this.dj(la,"Gridlines.Horizontal.Major",-306129902,l.a.P0e,972,973,1625);case 36:return this.dj(la,"Gridlines.Horizontal.Minor",2147076534,l.a.Q0e,975,976,1626);case 37:return this.dj(la,"Gridlines.Horizontal.MajorMinor",
-1253752845,l.a.R0e,978,979,1627);case 38:return this.dj(la,"Gridlines.Vertical.None",1711257557,l.a.X0e,929,971,1624);case 39:return this.dj(la,"Gridlines.Vertical.Major",-1772953364,l.a.U0e,972,974,1625);case 40:return this.dj(la,"Gridlines.Vertical.Minor",680253336,l.a.V0e,975,977,1626);case 41:return this.dj(la,"Gridlines.Vertical.MajorMinor",-215161981,l.a.W0e,978,980,1627);case 135:return this.Jd(la,"ContextMenu.NumberFormating",2105621672,l.a.Vgd,1,476,135!==la);case 300:return this.Jd(la,
"ContextMenu.FormatCells",2055979337,null,1,477,300!==la,void 0,"PaintBrushandBucket_20");case 136:return this.Jd(la,"ContextMenu.NumberFormatingApplyToPivotField",-168056295,l.a.Vgd,1,476,136!==la);case 42:return this.Jd(la,"ContextMenu.Cut",-1985798686,l.a.I_e,1,12);case 43:return this.Jd(la,"ContextMenu.Copy",-911352779,l.a.H_e,1,11);case 212:return this.Jd(la,"ContextMenu.InsertCopiedCells",-160032004,l.a.xhd,3,15);case 213:return this.Jd(la,"ContextMenu.InsertCutCells",-1065525230,l.a.xhd,3,
21);case 44:case 57:return this.Jd(la,"ContextMenu.Paste",237279923,l.a.Zgd,1,13,44!==la,"Paste");case 248:return this.Jd(la,"PasteAdvancedOptionsGallery",237279923,l.a.Zgd,1,13,44!==la,"Paste");case 45:case 120:return this.Jd(la,"ContextMenu.EditHyperlink",-1583422759,l.a.mhd,8,1140,45!==la,"EditHyperlink");case 46:case 121:return this.Jd(la,"ContextMenu.InsertHyperlink",-1583422759,l.a.mhd,8,1141,46!==la,"InsertHyperlink");case 47:case 122:return this.Jd(la,"ContextMenu.RemoveHyperlink",-1253126584,
l.a.phd,8,1142,47!==la,"RemoveHyperlink");case 48:case 123:return this.Jd(la,"ContextMenu.RemoveHyperlinks",-1253126584,l.a.phd,8,1143,48!==la,"RemoveHyperlinks");case 250:return this.Vn(la,"ContextMenu.ContextMenuSmartLookup",-983891024,1810);case 187:case 188:case 165:case 173:return this.Jd(la,"ContextMenu.InsertCellsShiftRight",1035996630,l.a.R_e,1,165===la||173===la?341:342,173===la||188===la,"InsertCellsShiftRight");case 166:case 174:return this.Jd(la,"ContextMenu.InsertCellsShiftDown",1035996630,
l.a.Q_e,1,344,166!==la,"InsertCellsShiftDown");case 189:case 190:case 167:case 175:return this.Jd(la,"ContextMenu.DeleteCellsShiftLeft",1035996630,l.a.L_e,1,167===la||175===la?342:341,175===la||190===la,"DeleteCellsShiftLeft");case 168:case 176:return this.Jd(la,"ContextMenu.DeleteCellsShiftUp",1035996630,l.a.M_e,1,343,168!==la,"DeleteCellsShiftUp");case 177:case 181:return this.Jd(la,"ContextMenu.InsertRowsSheet",-1113896058,l.a.Wgd,1,429,177!==la,"InsertRows");case 49:case 116:return this.Jd(la,
"ContextMenu.InsertRows",-1113896058,l.a.Wgd,1,346,49!==la,"InsertRows");case 161:case 169:return this.Jd(la,"ContextMenu.InsertRowsTable",942362098,l.a.T_e,1,421,161!==la,"InsertRowsTable");case 50:case 117:return this.Jd(la,"ContextMenu.InsertColumns",1415868706,l.a.Nyb,1,406,50!==la,"InsertColumns");case 288:case 289:return this.Jd(la,"ContextMenu.InsertColumns",1415868706,l.a.Nyb,1,408,288!==la,"InsertColumns");case 178:case 182:return this.Jd(la,"ContextMenu.InsertColumnsSheet",1415868706,l.a.Nyb,
1,426,178!==la,"InsertColumns");case 290:case 291:return this.Jd(la,"ContextMenu.InsertColumnsSheet",1415868706,l.a.Nyb,1,428,290!==la,"InsertColumns");case 191:case 192:case 162:case 170:return this.Jd(la,"ContextMenu.InsertColumnsTable",622604322,l.a.S_e,1,162===la||170===la?419:420,170===la||192===la,"InsertColumnsTable");case 179:case 183:return this.Jd(la,"ContextMenu.DeleteRowsSheet",1554436520,l.a.cec,1,429,179!==la,"DeleteRows");case 51:case 118:return this.Jd(la,"ContextMenu.DeleteRows",
1554436520,l.a.cec,1,410,51!==la,"DeleteRows");case 163:case 171:return this.Jd(la,"ContextMenu.DeleteRowsTable",1405456548,l.a.cec,1,418,163!==la,"DeleteRowsTable");case 180:case 184:return this.Jd(la,"ContextMenu.DeleteColumnsSheet",674605324,l.a.bec,1,426,180!==la,"DeleteColumns");case 52:case 119:return this.Jd(la,"ContextMenu.DeleteColumns",674605324,l.a.bec,1,411,52!==la,"DeleteColumns");case 164:case 172:return this.Jd(la,"ContextMenu.DeleteColumnsTable",284490184,l.a.bec,1,417,164!==la,"DeleteColumnsTable");
case 53:case 124:return this.Vn(la,"ContextMenu.OpenHyperlink",-1396319072,1144,53!==la,"OpenHyperlink");case 263:return this.Jd(la,"SheetOpsContextMenu.ShowChanges",1834994092,l.a.qhd,8,443,void 0,k.a.zXj);case 264:return this.Jd(la,"GridContextMenu.ZoomFitToScreen",1409187195,null,8,1154,void 0,void 0,"FitToScreen_16");case 265:return this.Jd(la,"GridContextMenu.ZoomFitToScreenUndo",-1836771825,null,8,1155,void 0,void 0,"RevertZoom_16");case 262:return this.Jd(la,"GridContextMenu.ShowChanges",1834994092,
l.a.qhd,8,443,void 0,k.a.iig);case 54:return this.Jd(la,"ContextMenu.InsertSheet",-1935155518,l.a.U_e,1,514);case 56:case 127:return this.Jd(la,"ContextMenu.DeleteSheet",1880294140,l.a.O_e,1,515,56!==la,"DeleteSheet");case 55:return this.Vn(la,"ContextMenu.RenameSheet",817296323,516);case 125:case 126:return this.Vn(la,"ContextMenu.ReorderSheet",-383100692,517,125!==la,"ReorderSheet");case 158:return this.Vn(la,"ContextMenu.DuplicateSheet",-1254662242,441);case 112:case 114:return this.Vn(la,"ContextMenu.HideSheet",
1458540255,519,112!==la,"HideSheet");case 113:case 115:return this.Vn(la,"ContextMenu.UnhideSheet",1129633328,520,113!==la,"UnhideSheet");case 277:return this.Jd(la,"ContextMenu.ManageProtection",1723441034,null,8,1995,void 0,void 0,"ProtectSheet_20");case 278:return this.Jd(la,"ContextMenu.PauseProtection",-278145964,null,8,1996,void 0,void 0,"UnlockVariant_20");case 279:return this.Jd(la,"ContextMenu.ResumeProtection",-278145964,null,8,1998,void 0,void 0,"ProtectForm_20");case 242:return this.Vn(la,
"ContextMenu.PivotExpandCollapse",589118293,1167);case 243:return this.Jd(la,"ContextMenu.PivotExpand",-1687560254,l.a.ahd,9,1168);case 244:return this.Jd(la,"ContextMenu.PivotCollapse",1176256599,l.a.$gd,9,1169);case 245:return this.Jd(la,"ContextMenu.PivotExpandEntireField",-1751201991,l.a.ahd,9,1170);case 246:return this.Jd(la,"ContextMenu.PivotCollapseEntireField",-232434744,l.a.$gd,9,1171);case 247:return this.Jd(la,"ContextMenu.PivotShowDetails",1771091375,null,17,1172,void 0,void 0,"PivotShowDetails_20");
case 301:return this.Jd(la,"ContextMenu.DeletePivotTable",1885005049,null,17,2292,void 0,void 0,V.a.Pij);case 59:return this.Jd(la,"ContextMenu.PivotFieldListShow",2140436015,l.a.bhd,9,1173);case 58:return this.Jd(la,"ContextMenu.PivotFieldListHide",-1006032470,l.a.bhd,9,1174);case 258:return this.Jd(la,"ContextMenu.PivotSettingsPaneShow",1529441790,l.a.Pyb,17,636);case 257:return this.Jd(la,"ContextMenu.PivotSettingsPaneHide",1529441790,l.a.Pyb,17,637);case 259:return this.Vn(la,"ContextMenu.PivotTableNoSubtotal",
-2016405815,638);case 260:return this.Vn(la,"ContextMenu.PivotTableSubtotalOnTop",671485366,639);case 261:return this.Vn(la,"ContextMenu.PivotTableSubtotalOnBottom",772221736,640);case 60:case 64:return xa=60!==la,this.Vn(la,xa?"ContextMenu.FieldWellMoveUpDisabled":"ContextMenu.FieldWellMoveUp",-1170196828,1089,xa,null);case 61:case 65:return xa=61!==la,this.Vn(la,xa?"ContextMenu.FieldWellMoveDownDisabled":"ContextMenu.FieldWellMoveDown",-889576107,1090,xa,null);case 62:case 66:return xa=62!==la,
this.Vn(la,xa?"ContextMenu.FieldWellMoveToBeginningDisabled":"ContextMenu.FieldWellMoveToBeginning",389774337,1091,xa,null);case 63:case 67:return xa=63!==la,this.Vn(la,xa?"ContextMenu.FieldWellMoveToEndDisabled":"ContextMenu.FieldWellMoveToEnd",2033235475,1092,xa,null);case 68:case 72:return xa=68!==la,this.Jd(la,xa?"ContextMenu.FieldWellMoveToReportFilterDisabled":"ContextMenu.FieldWellMoveToReportFilter",-96230454,l.a.Ydc,9,1093,xa,null);case 69:case 73:return xa=69!==la,this.Jd(la,xa?"ContextMenu.FieldWellMoveToRowLabelsDisabled":
"ContextMenu.FieldWellMoveToRowLabels",74086617,l.a.y6a,9,1094,xa,null);case 70:case 74:return xa=70!==la,this.Jd(la,xa?"ContextMenu.FieldWellMoveToColumnLabelsDisabled":"ContextMenu.FieldWellMoveToColumnLabels",1529312473,l.a.x6a,9,1095,xa,null);case 71:case 75:return xa=71!==la,this.Jd(la,xa?"ContextMenu.FieldWellMoveToValuesDisabled":"ContextMenu.FieldWellMoveToValues",563292088,l.a.Zdc,9,1098,xa,null);case 76:return this.Jd(la,"ContextMenu.FieldWellRemoveField",-1092351914,l.a.J_e,9,1099);case 77:return this.Jd(la,
"ContextMenu.FieldWellValueFieldSettings",-2141589616,l.a.g0e,9,1100);case 79:case 83:return this.Jd(la,"ContextMenu.FieldListMoveToReportFilter",359279088,l.a.Ydc,9,1082,79!==la,null);case 80:case 84:return this.Jd(la,"ContextMenu.FieldListMoveToRowLabels",-67292059,l.a.y6a,9,1083,80!==la,null);case 81:case 85:return this.Jd(la,"ContextMenu.FieldListMoveToColumnsLabels",745182485,l.a.x6a,9,1084,81!==la,null);case 82:case 86:return this.Jd(la,"ContextMenu.FieldListMoveToValues",926905850,l.a.Zdc,
9,1087,82!==la,null);case 95:case 97:return xa=95!==la,this.Jd(la,xa?"ContextMenu.FieldWellMoveToRowChartLabelsDisabled":"ContextMenu.FieldWellMoveToRowChartLabels",74086617,l.a.y6a,9,1096,xa,null);case 96:case 98:return xa=96!==la,this.Jd(la,xa?"ContextMenu.FieldWellMoveToColumnChartLabelsDisabled":"ContextMenu.FieldWellMoveToColumnChartLabels",1529312473,l.a.x6a,9,1097,xa,null);case 78:return this.Jd(la,"ContextMenu.FieldListAddAsSlicer",547535945,l.a.Tgd,9,1088);case 91:case 93:return this.Jd(la,
"ContextMenu.FieldListMoveToRowChartLabels",-67292059,l.a.y6a,9,1085,91!==la,null);case 92:case 94:return this.Jd(la,"ContextMenu.FieldListMoveToColumnChartLabels",745182485,l.a.x6a,9,1086,92!==la,null);case 99:return this.Jd(la,"ContextMenu.BIExploreShowCallout",1529658657,l.a.$dc,9,1193);case 100:return this.Jd(la,"ContextMenu.ContextMenuRefresh",2054778433,l.a.a0e,9,1181);case 102:return this.Jd(la,"ContextMenu.EditCell",324156914,l.a.ohd,8,579);case 101:return this.Jd(la,"Contextenu.DeleteChart",
2045211913,l.a.khd,8,578);case 146:return this.Jd(la,"Contextenu.AltText",1804967129,l.a.lhd,8,817);case 302:return this.Jd(la,"ContextMenu.CellImageAltText",1516436924,l.a.lhd,8,817);case 147:return this.Jd(la,"ContextMenu.EditShapeText",-445658892,l.a.g1e,8,818);case 186:return this.Jd(la,"ContextMenu.ExitEditShapeText",1166778132,null,8,819);case 281:return this.Jd(la,"ContextMenu.BringForward",-1024854261,null,8,820,!1,"ContextMenu.BringForward",V.a.bringForward);case 282:return this.Jd(la,"ContextMenu.BringToFront",
-1480025782,null,8,822,!1,"ContextMenu.BringToFront",V.a.bringToFront);case 283:return this.Jd(la,"ContextMenu.SendBackWard",565697619,null,8,821,!1,"ContextMenu.SendBackWard",V.a.sendBackward);case 284:return this.Jd(la,"ContextMenu.SendToBack",-884976206,null,8,823,!1,"ContextMenu.SendToBack",V.a.sendToBack);case 273:return this.Jd(la,"ContextMenu.OfficeScriptsViewScript",-585097204,l.a.C_e,8,2151);case 160:return this.Jd(la,"ContextMenu.InsertComment",-1667294294,l.a.i1e,8,1146);case 221:return this.Jd(la,
"ContextMenu.DeleteComment",467845448,l.a.f1e,8,1162);case 159:return this.Jd(la,"ContextMenu.InsertReply",-1667294294,l.a.j1e,8,1145);case 226:return this.Jd(la,"ContextMenu.NewNote",2041505397,null,8,1156,void 0,void 0,"AddNoteboardNote_20");case 227:return this.Jd(la,"ContextMenu.EditNote",2041505397,null,8,1157,void 0,void 0,"EditNote_20");case 228:return this.Jd(la,"ContextMenu.DeleteNote",-865270283,null,8,1158,void 0,void 0,"DeleteNote_20");case 229:return this.Jd(la,"ContextMenu.ShowOrHideNote",
1627476102,null,8,1159,void 0,void 0,"OLNoteYellow_20");case 230:return this.Vn(la,"ContextMenu.ConvertNote",-1565161385,1161);case 103:return this.BR(la,"Form.InsertForm",1305810481,l.a.Ygd,1,"Image16by16",1267,0,null,!1,1595);case 107:return this.BR(la,"Form.ViewForm",330035228,l.a.Ygd,1,"Image16by16",1269,0,null,!1,1596);case 104:return this.BR(la,"Form.EditForm",1305810481,l.a.P_e,1,"Image16by16",1268,0,null,!1,1597);case 105:return this.BR(la,"Form.DeleteForm",-509039657,l.a.K_e,1,"Image16by16",
1270,0,null,!1,1598);case 106:return this.BR(la,"Form.ShareForm",1334518759,l.a.c0e,1,"Image16by16",1271,0,null,!1,1599);case 148:case 149:return this.Vn(la,"ContextMenu.ClearContent",-848953656,445,148!==la);case 150:case 151:return this.Jd(la,"ContextMenu.RowHeight",2040891415,l.a.k1e,8,434,151===la);case 152:case 153:return this.Jd(la,"ContextMenu.ColumnWidth",957527587,l.a.e1e,8,433,153===la);case 108:case 154:return this.Vn(la,"ContextMenu.HideRows",1051390410,432,154===la);case 110:case 156:return this.Vn(la,
"ContextMenu.UnhideRows",1542466017,439,156===la);case 109:case 155:return this.Vn(la,"ContextMenu.HideColumns",-706918724,438,155===la);case 111:case 157:return this.Vn(la,"ContextMenu.UnhideColumns",369708605,440,157===la);case 216:return this.Vn(la,"ContextMenu.ShowCard",-843616717,1786,216!==la);case 217:return this.Vn(la,"ContextMenu.ShowImageDetails",-843616717,1787);case 303:return this.Jd(la,"ContextMenu.PlaceInCell",-700002548,null,8,2300,void 0,void 0,"PictureInCell_20");case 304:return this.Jd(la,
"ContextMenu.PlaceOverCell",2000316912,null,8,2301,void 0,void 0,"InsertPictureSimple_20");case 305:return this.Jd(la,"ContextMenu.CreateReference",1983877126,null,8,2302,void 0,void 0,"PictureLinked_20");case 215:case 268:return this.Vn(la,"ContextMenu.ConvertLinkedEntityToText",311599363,1784,268===la);case 218:case 269:return this.Vn(la,"ContextMenu.RefreshLinkedEntities",439914789,1788,269===la);case 220:case 271:return this.Vn(la,"ContextMenu.ShowLinkedEntityRefreshPane",-1753056834,1785,271===
la);case 219:case 270:return this.Vn(la,"ContextMenu.ChangeLinkedEntityObject",2127195269,1796,270===la);case 234:return this.Jd(la,"ContextMenu.FilterClear",-1977666927,null,1,220,void 0,void 0,"DeleteFilter_20");case 235:return this.Jd(la,"ContextMenu.FilterReapply",1549396389,null,1,221,void 0,void 0,"XLReapplyFilter_20");case 233:return this.Jd(la,"ContextMenu.FilterByValue",1803952894,null,1,222);case 223:return this.Jd(la,"ContextMenu.SortAscending",-1010737776,l.a.e0e,1,228);case 292:return this.Vn(la,
"ContextMenu.PutSelectedCellColorOnTop",-1032691499,230);case 293:return this.Vn(la,"ContextMenu.PutSelectedFontColorOnTop",-764711886,231);case 294:return this.Vn(la,"ContextMenu.PutSelectedFormattingIconOnTop",-2016161444,232);case 224:return this.Jd(la,"ContextMenu.SortDescending",2123420468,l.a.f0e,1,229);case 225:return this.Jd(la,"ContextMenu.SortCustom",-207540907,l.a.fec,1,233);case 232:return this.Jd(la,"ContextMenu.ConvertToRange",323142015,l.a.G_e,1,740);case 272:return this.Jd(la,"ContextMenu.ShowOpenInAppDialogOnMobile",
213236505,l.a.ohd,8,661);case 239:return this.Jd(la,"ContextMenu.IgnoreError",886009118,l.a.nhd,8,2112,239!==la);case 240:return this.Jd(la,"ContextMenu.IgnoreErrors",886009118,l.a.nhd,8,2113,240!==la);case 241:return this.Vn(la,"ContextMenu.ShowError",-1779556985,2114,241!==la);case 251:return this.Jd(la,"ContextMenu.SlicerRefresh",-231711729,l.a.$_e,0,2177,251!==la);case 252:return this.Jd(la,"ContextMenu.SlicerClearFilter",-1909381757,l.a.N_e,0,2178,252!==la);case 254:return this.Vn(la,"ContextMenu.SlicerDelete",
2045211913,2181,254!==la);case 253:return this.Jd(la,"ContextMenu.SlicerMultiSelect",2108047455,l.a.Xgd,0,2180,253!==la);case 255:return this.Jd(la,"ContextMenu.SlicerSortAscending",-923375148,l.a.hec,8,2183,255!==la);case 256:return this.Jd(la,"ContextMenu.SlicerSortDescending",1164937340,l.a.iec,8,2182,256!==la);case 267:return this.Jd(la,"ContextMenu.SlicerSettingsPaneShow",522377926,l.a.Pyb,17,636);case 266:return this.Jd(la,"ContextMenu.SlicerSettingsPaneHide",522377926,l.a.Pyb,17,637);case 128:return this.jwa(la,
-619033944,1,1438);case 129:return this.jwa(la,-619033944,2,1440);case 130:return this.jwa(la,-619033944,3,1442);case 131:return this.jwa(la,-619033944,4,1443);case 132:return this.W5(la,-1736601456,7,1447);case 133:return this.W5(la,-1736601456,8,1449);case 134:return this.W5(la,-1736601456,0,1450);case 196:return this.jwa(la,-2136556471,1,1438);case 198:return this.jwa(la,-2136556471,2,1440);case 200:return this.jwa(la,-2136556471,3,1442);case 201:return this.jwa(la,-2136556471,4,1443);case 204:return this.W5(la,
1201641489,0,1447);case 205:return this.W5(la,1201641489,1,1448);case 206:return this.W5(la,1201641489,7,1449);case 207:return this.W5(la,1201641489,2,1450);case 208:return this.W5(la,1201641489,4,1451);case 209:return this.W5(la,1201641489,3,1452);case 210:return this.W5(la,1201641489,5,1453);case 211:return this.W5(la,1201641489,6,1454);case 274:return this.Jd(la,"ContextMenu.ShareChart",353606613,null,1,2261,void 0,void 0,"ShareSectionEntry_20");case 275:return this.Jd(la,"ContextMenu.ShareRange",
-1099009678,null,1,2262,void 0,void 0,"ShareSectionEntry_20");case 276:return this.Jd(la,"ContextMenu.ShareTable",192430811,null,1,2263,void 0,void 0,"ShareSectionEntry_20");case 299:return this.Jd(la,"ContextMenu.ShareSheet",783415632,null,1,2264,void 0,void 0,"ShareSectionEntry_20");case 285:return this.Jd(la,"ContextMenu.ToggleTotalRow",2128797448,null,1,741,void 0,void 0,"ToggleTotalRow_20");case 286:return this.Jd(la,"ContextMenu.TableAltText",-723113214,null,1,817,void 0,void 0,"ShowTableAltTextDlg_20")}return null}BR(la,
xa,wa,hb,Ja,Fa,Ba,fa,ta,Oa,Ma,fb=null){xa=new v.a(xa,Ba,wa,null,Ja,hb,Fa,Ba,fa,ta,Oa,Ma,!0,fb);return Ea.i3a[la.toString()]=xa}Jd(la,xa,wa,hb,Ja,Fa,Ba=!1,fa=null,ta=null){return this.BR(la,xa,wa,ta?null:hb,Ja,"Image16by16",Fa,0,fa,Ba,0,ta)}Gbd(la,xa,wa,hb,Ja,Fa=null){return new E(la,0,-1006427574,null,wa,xa,hb,0,0,Ja,!1,null,Fa)}obd(la,xa=""){return new m(la,xa)}fmh(la,xa,wa,hb){return new P.a(la,0,xa,null,8,null,"None",0,0,null,!1,0,wa,hb)}oLa(la,xa,wa,hb,Ja,Fa,Ba,fa=null,ta=!1){let Oa=u.a.Ad(Ea.i3a,
la);if(Oa)return Oa;Oa=new v.a(la,0,wa,null,3,null,"None",0,0,Fa,Ba,0);Oa.JT(xa);Oa.label=xa;Oa.ADc(ta?null:xa);Oa.cRb(Ja,hb,fa);return Ea.i3a[la]=Oa}GRd(la){this.Ovd(la)&&delete Ea.i3a[la]}Ovd(la){return la in Ea.i3a}Jw(la,xa,wa,hb){la=new S(la,xa,0,hb,3,null,"None",0);la.JT(wa);la.label=wa;return la}Oad(la,xa,wa,hb,Ja,Fa){la=new S(la,xa,0,hb,Ja,Fa,"Image16by16",0);la.JT(wa);la.label=wa;return la}zrh(la,xa,wa,hb,Ja=null){return new L(la,xa,"1726517890",!0,!1,null,"PopulateNameBoxMenu",wa,!0,hb,!0,
!1,Ja)}xgf(la){h.ULS.sendTraceTag(537153991,0,50,"RibbonControlsManager.GetXmlForControl: Generating control xml from control props");if(la)return la.vV();h.ULS.sendTraceTag(537153989,0,10,"RibbonControlsManager.GetXmlForControl: control is null");return null}Lad(la,xa=null,wa=null,hb=null,Ja=null){return new x(this.UC,la,null,null,xa,null,wa,hb,Ja)}jE(la,xa,wa=null,hb=null){return Object(d.a)(new Z,{id:la,width:xa,kla:wa,title:hb})}dj(la,xa,wa,hb,Ja,Fa,Ba){return this.BR(la,xa,wa,hb,4,"Image32by32",
Ja,Fa,null,!1,Ba)}Vn(la,xa,wa,hb,Ja=!1,Fa=null){return this.BR(la,xa,wa,null,1,"None",hb,0,Fa,Ja,0)}FOe(la,xa,wa,hb,Ja,Fa){return this.BR(la,xa,wa,hb,4,"Image16by16",Ja,0,Fa.toString(),!1,0)}W5(la,xa,wa,hb){return this.FOe(la,"OutlineDashStylePresent,"+wa,xa,l.a.aec,hb,wa)}jwa(la,xa,wa,hb){return this.FOe(la,"OutlineWidthPresent,"+wa,xa,l.a.eec,hb,wa)}}Ea.i3a={};Object(r.a)(Ea,"RibbonControlsManager",null,[379]);var oa=a(100),ea=a(1),aa=a(149),ia=a(35);class ya extends b.a{constructor(la){super();
this.Ya=null;this.$=la;this.uc()}create(){var la=this.$;const xa=e.GetServiceTaskFactory.create(la.da,111,this.ka,this.La);la=ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateCommonUiStrings",!1)?Object(oa.d)(aa.a.resolve(ia.p,{Wa:this.La})):e.GetServiceTaskFactory.create(la.da,155,this.ka,this.La);f.TaskExtensions.za(f.TaskExtensions.xe([xa,la],this.ka),()=>{this.$b(this.Ya||(this.Ya=new Ea(xa.result)))},this.ka,3)}static la(la){la.da.Ja(102,new ya(la))}}Object(r.a)(ya,"RibbonControlsFactory",
b.a,[]);a.d(C,"a",function(){return za});const za=()=>{c.a.Fa(ya.la)}},1239:function(r,C,a){var c=a(10);r=a(0);var b=a(172),e=a(230),f=a(40),d=a(15),h=a(32),l=a(366),k=a(362),u=a(198),v=a(357),x=a(136),w=a(382),m=a(201),t=a(217),z=a(209),y=a(34),D=a(231),H=a(248),F=a(137);class G{constructor(ia,ya,za,la){this.red=ia;this.green=ya;this.blue=za;this.alpha=la}toString(){return this.red.toString()+this.green.toString()+this.blue.toString()+this.alpha.toString()}}Object(r.a)(G,"ColorObject",null,[]);class L{constructor(ia){this.RZ=
this.eI=null;this.C7c=ia}get head(){return this.eI}get G3d(){return this.RZ}ZSe(ia){this.head&&(ia.pre?ia.next?(ia.pre.next=ia.next,ia.next.pre=ia.pre):(this.RZ=ia.pre,this.G3d.next=null):ia.next?(this.eI=ia.next,this.head.pre=null):this.RZ=this.eI=null,ia.next=null,ia.pre=null)}BVg(ia){this.head?(ia.next=this.head,this.eI=ia,ia.next.pre=this.head):this.RZ=this.eI=ia}Snd(){if(!this.head)return null;const ia=new u.a;let ya=this.head;for(;ya;)if(ia.add(ya.value),ya=ya.next,ia.count>this.C7c){d.ULS.sendTraceTag(537155399,
0,10,"CustomLinkedList.GetItems - Size of Linked List exceeded max capacity.");break}return ia}}Object(r.a)(L,"CustomLinkedList",null,[]);class M{constructor(ia){this.pre=this.next=null;this.value=ia}}Object(r.a)(M,"CustomLinkedListNode",null,[]);class O{constructor(ia){this.C7c=ia;this.atc={};this.Bbb=new L(ia);this.count=0}add(ia,ya){ia&&ya?(ya=new M(ya),this.contains(ia)?this.Bbb.ZSe(this.atc[ia]):this.count<this.C7c?this.count++:(delete this.atc[this.Bbb.G3d.value.toString()],this.Bbb.ZSe(this.Bbb.G3d)),
this.Bbb.BVg(ya),this.atc[ia]=ya):d.ULS.sendTraceTag(537155358,0,15,`MRUCache.Add: Key ${ia} or Value ${ya} is null.`)}Snd(){return this.Bbb.Snd()}contains(ia){return ia?ia in this.atc:!1}}Object(r.a)(O,"MRUCache",null,[]);var B=a(156),E=a(16);class I extends B.a{constructor(ia,ya,za,la=null){super(!1,!1,!0);this.moreColorsHelper=null;this.Dgh=(xa,wa)=>{this.PLe(xa,wa)};this.$=ia;this.zsi=ya;this.Ytd=za;this.QLe=la}sh(){const ia=E.a.instance.ha(1346),ya={};ya[I.kAg]=this.zsi;ya[I.Eyg]=I.fWb;ya[I.dAg]=
I.fWb;ya[I.vBg]=I.fWb;ya[I.kBg]=I.fWb;ya[I.PAg]=E.a.instance.ha(2105);ya[I.Yzg]=E.a.instance.ha(2089);ya[I.Kyg]=E.a.instance.ha(2076);ya[I.bAg]=E.a.instance.ha(1347);ya[I.Fyg]=E.a.instance.ha(1348);this.Ytd!==I.Gyg&&(ya[I.Hyg]=I.ALPHA,ya[I.ALPHA]=this.Ytd,d.ULS.sendTraceTag(537155398,0,50,`More Colors:: Initial Alpha Value : ${this.Ytd}`));this.initializeAndShow(ia,this.Dgh,{[I.Kzg]:I.kzg,[I.Lyg]:ya})}PLe(ia,ya){ya=ya[I.YLc];1===ia&&this.TGf(z.a.uga(ya));this.QLe&&this.QLe(1===ia,1===ia?ya:null)}TGf(ia){this.moreColorsHelper||
(this.moreColorsHelper=this.$.da.Ba(398));ia=t.a.BG(z.a.TI(ia,!1));this.moreColorsHelper.QVd(ia.r,ia.g,ia.b,v.a.MLc)}}I.kAg="initColor";I.Kzg="id";I.kzg="ColorPickerDialog";I.Lyg="bodyControls";I.YLc="selectedColorText";I.dAg="hueAriaLabel";I.vBg="transparencyAriaLabel";I.kBg="svAriaLabel";I.fWb="Use left & right arrows keys to change values in color picker & hue slider";I.ALPHA="alpha";I.LLc="alphaValue";I.Eyg="alphaAriaLabel";I.Hyg="alphaSliderType";I.Gyg=-1;I.BAg=100;I.PAg="redLabel";I.Kyg="blueLabel";
I.Yzg="greenLabel";I.bAg="hexLabel";I.Fyg="alphaLabel";Object(r.a)(I,"MoreColorsDialog",B.a,[]);var S=a(7),J=a(91),K=a(531),R=a(55);class Z extends I{constructor(ia,ya,za,la,xa){super(ia,la,xa);this.commandName=null;this.Gof=!1;this.command=ya;this.je=za;this.qsi=xa}sh(){super.sh();this.commandName=R.b().uk(this.je.command);d.ULS.sendTraceTag(545051016,0,50,`More Colors:: Dialog Opened From Entry Point: ${this.commandName}, Command SourceUILocation: ${this.je.Jf}`)}PLe(ia,ya){if(1===ia)if(ia=this.$.yc.vh("UserAction",
this.commandName),ia.start(),K.a(ia),ya)if(I.YLc in ya){var za=ya[I.YLc];if(ia=z.a.uga(za)){za=new J.a(this.command,this.je.method,this.je.mode,this.je.Jf,this.je.tabName?this.je.tabName:1378078823===this.command||-400966242===this.command?S.a.ECa:S.a.yP);var la={};la.Color=ia;la.UILocation=this.je.Jf;I.LLc in ya&&(this.qsi!==ya[I.LLc]&&(this.Gof=!0),la.Alpha=(ya[I.LLc]/I.BAg).toString(),d.ULS.sendTraceTag(537155359,0,50,`Alpha Value selected from the MoreColors Dialog: ${la.Alpha}`));this.$.Ia.mc(za,
la);this.$.ig();this.TGf(ia);ya={["Command"]:this.commandName,["Location"]:this.je.Jf};ya.AlphaApplied=this.Gof.toString();F.b(this.$).Vd(x.a.dXi,ya,null,!0)}else this.hide(),d.ULS.sendTraceTag(537155360,0,10,`Color picker dialog did not return the color in expected format RRGGBB. Color returned: ${za}, Command: ${this.commandName}`)}else this.hide(),d.ULS.sendTraceTag(537155361,0,10,`Dictionary does not contain color, Command: ${this.commandName}`);else this.hide(),d.ULS.sendTraceTag(537155362,0,
10,`Dictionary is null Command: ${this.commandName}`)}}Object(r.a)(Z,"MoreColorsRibbonDialog",I,[]);var P=a(59);const V=(ia,ya,za,la,xa,wa,hb,Ja,Fa,Ba=null)=>{Ba=ia.Pa(9,Ba);Ba.bRed=ya;Ba.bGreen=za;Ba.bBlue=la;Ba.bAlpha=xa;return P.g(ia,"SaveMRUColor",Ba,wa,hb,Ja,Fa,0)},Ea=(ia,ya,za,la,xa,wa=null)=>{wa=ia.Pa(1,wa);return P.g(ia,"GetMRUColors",wa,ya,za,la,xa,4)};class oa{constructor(ia,ya){this.ppe="00FFFF";this.qpe="0000FF";this.n1f="00FFFF";this.o1f="BF7000";this.STa=null;this.Fbf=!1;this.Xke=null;
this.P6i=za=>{if(!D.a(za)){za=za.Result;this.STa=new O(10);for(let xa=za.length-1;0<=xa;xa--){var la=za[xa];la=new G(la.Red,la.Green,la.Blue,la.Alpha);this.STa.add(la.toString(),la)}this.wWf();d.ULS.sendTraceTag(537155395,0,50,"MoreColorsHelper.OnGetMRUColorsSuccessCallback : Successfully fetched Recent colors ")}};this.O6i=()=>{d.ULS.sendTraceTag(537155394,0,50,"MoreColorsHelper.OnGetMRUColorsFailureCallback - Webservice call failed")};this.WE=()=>{this.Iid()};this.$=ia;this.bIb=ya;this.$.da.Ja(398,
this);this.$.ea.fg?this.Iid():this.$.ea.yk(this.WE)}get YHb(){return this.Xke}get TTa(){return this.ppe}set TTa(ia){this.ppe=ia}get Afb(){return this.qpe}set Afb(ia){this.qpe=ia}get Qyc(){return this.n1f}set Qyc(ia){this.n1f=ia}get Ryc(){return this.o1f}set Ryc(ia){this.o1f=ia}OHb(ia,ya,za,la=-1){return this.bIb?f.TaskExtensions.za(this.bIb,()=>{(new Z(this.$,ia,ya,za,la)).sh()},this.$.ka):null}UMi(ia,ya=-1,za=null){this.bIb&&f.TaskExtensions.za(this.bIb,()=>{(new I(this.$,ia,ya,za)).sh()},this.$.ka)}Tci(ia){let ya=
null;switch(ia){case "QueryRecentFillColor":ya=this.TTa;break;case "QueryRecentFontColor":ya=this.Afb;break;case "QueryRecentShapesFillColor":ya=this.Qyc;break;case "QueryRecentShapesOutlineColor":ya=this.Ryc}return ya?h.a.h8a(ya):null}dispose(){this.bIb=null;this.$&&this.$.ea.en(this.WE)}Iid(){if(this.$.isEditMode)if(this.STa)this.wWf();else{this.Fbf&&d.ULS.sendTraceTag(575939106,0,15,"MoreColorsHelper.FetchMRUColors : Recent Colors not shown since data not available from GetMRUColors operation");
var ia=this.$.qa.va;this.$.userOperationManager.Bd(new m.a(1009,0,(ya,za,la)=>Ea(ia,H.b.call(null,ya,this.P6i),H.a.call(null,za,this.O6i),la,null),80),null);this.Fbf=!0}}wWf(){var ia=this.STa.Snd();if(ia){this.Xke=new u.a;for(let ya of ia)ia=ya,ia=new t.a(ia.red,ia.green,ia.blue),this.YHb.add(z.a.nK(ia))}}QVd(ia,ya,za,la){this.STa||(this.STa=new O(10));const xa=new G(ia,ya,za,la);this.STa.add(xa.toString(),xa);this.saveMRUColor(null,ia,ya,za,la)}Zfa(ia,ya,za){(ia||this.$.isEditMode)&&this.yhg(ia.SqmControlId)&&
(ia=t.a.BG(z.a.TI(ya,!1)))&&(this.QVd(ia.r,ia.g,ia.b,v.a.MLc),za={["Command"]:R.b().uk(za.command),["Location"]:l.a[za.Jf],["InputMethod"]:k.a[za.method]},F.b(this.$).Vd(x.a.Zfa,za,null,!0))}yhg(ia){return!!ia&&ia.startsWith("RecentColorPicker")}saveMRUColor(ia,ya,za,la,xa){return w.a(this.$.userOperationManager,(wa,hb,Ja)=>V(this.$.qa.va,ya,za,la,xa,H.b(wa,oa.pbj()),H.a(hb,oa.obj()),Ja,null),wa=>new m.a(1008,0,wa),ia)}static pbj(){return ia=>{y.a.ng(ia.Errors)?d.ULS.sendTraceTag(537155393,0,10,"MoreColorsHelper.OnSaveMRUColorFailure - Webservice call failed with errors"):
d.ULS.sendTraceTag(537155392,0,50,"MoreColorsHelper.OnSaveMRUColorSuccess - Successfully saved color to workbook")}}static obj(){return()=>{d.ULS.sendTraceTag(537155363,0,10,"MoreColorsHelper.OnSaveMRUColorFailure - Webservice call failed.")}}}Object(r.a)(oa,"MoreColorsHelper",null,[380,2]);class ea extends e.a{constructor(ia){super();this.$=ia;this.uc()}create(){const ia=new b.a;this.$.wz(za=>{za=za.izf();f.TaskExtensions.za(za,()=>{ia.setResult(!0)},this.$.ka)});const ya=ia.task;this.$b(this.$.da.Ba(398)||
new oa(this.$,ya))}static la(ia){ia.da.Ja(397,new ea(ia))}}Object(r.a)(ea,"MoreColorsHelperFactory",e.a,[]);a.d(C,"a",function(){return aa});const aa=()=>{c.a.Fa(ia=>{ea.la(ia)})}},1277:function(r,C,a){r={};a.r(r);a.d(r,"ThemesManager",function(){return F});var c=a(10),b=a(0),e=a(230),f=a(118),d=a(15),h=a(783),l=a(217),k=a(209),u=a(34),v=a(231),x=a(198);class w{constructor(){this.RPg=new x.a;this.SPg=new x.a}get cXa(){return this.RPg}get sog(){return this.SPg}get FH(){return this.o6j}uVg(O,B){this.cXa.add(O);
this.sog.add(B)}vVg(O,B){this.o6j={cGd:O,QEd:B}}}Object(b.a)(w,"ThemeInfoCache",null,[]);var m=a(59);const t=(O,B,E,I,S,J=null)=>{J=O.Pa(1,J);return m.g(O,"GetThemeInfoOld",J,B,E,I,S,4)},z=(O,B,E,I,S,J=null)=>{J=O.Pa(1,J);return m.g(O,"GetThemeInfo",J,B,E,I,S,4)};var y=a(1),D=a(149),H=a(35);let F=class{constructor(O){this.cXa=this.UM=null;this.snc=!1;this.f4d=null;this.Esc=new Set;this.ejb=this.UTc=!1;this.ezb=0;this.UMf=B=>{this.snc=!1;if(!B||v.a(B))d.ULS.sendTraceTag(556656004,0,15,`ThemesManager: The obtained result has errors, [Error: ${B?
u.a.Uc(B.Errors):"(no result)"}]`),this.azd&&this.N8f();else if(this.azd&&(this.ezb=0),B=B.Result){this.Um&&null!==this.UM&&this.$hh(B);this.UM=new w;if(this.OE){this.cXa=B.ThemeColors;this.f4d=[];for(var E=0;10>E;E++)this.f4d.push(h.a.cOa(l.a.BG(this.cXa[E])));for(E=0;6>E;E++)for(let I=0;10>I;I++){const S=k.a.uga(k.a.HH(this.cXa[10*E+I])),J=h.a.k$h(E,I,this.f4d[I],this.cXa[I]);this.UM.uVg(S,J)}}this.Um&&(this.UM.vVg(B.MinorFont,B.MajorFont),this.ejb=!1);this.UTc=!1;this.dga()}else d.ULS.sendTraceTag(556656003,
0,10,"ThemesManager: The obtained ThemeInfo is null")};this.TMf=()=>{this.snc=!1;this.azd&&this.N8f()};this.N8f=()=>{3>this.ezb?(this.ezb++,d.ULS.sendTraceTag(509669709,0,50,`ThemesManager::retryFetchThemeInfo - Retry fetchThemeInfo API count = ${this.ezb}`),this.Tec(null,!0)):(this.ezb=0,d.ULS.sendTraceTag(509669708,0,15,"ThemesManager::retryFetchThemeInfo - Maximum retry count for fetchThemeInfo API has reached."))};this.Evc=()=>{this.UM&&(d.ULS.sendTraceTag(537150473,0,50,"ThemesManager: OnReloadCache"),
this.Um?this.ejb=!0:this.UM=null,this.Tec(null,!0))};this.Md=(B,E)=>{this.UM&&(d.ULS.sendTraceTag(537150472,0,50,"ThemesManager: OnSessionIdChanged"),E.QG&&(this.UTc=!0))};this.Lz=()=>{this.Esc.clear()};this.$=O;this.$.ea.VK(this.Evc);this.$.ea.Mk(this.Md);this.$.Ia.B1a(this.Lz);this.OE=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1);this.Um=y.EwaSettings.Um();this.azd=y.EwaSettings.isChangeGateEnabled("OfficeVSO:7396333_RetryFetchThemeInfoApi")}get fjb(){return!this.UM||
this.ejb?null:this.UM.cXa}get rog(){return!this.UM||this.ejb?null:this.UM.sog}get FH(){return!this.UM||this.ejb?null:this.UM.FH}get $zd(){return this.UTc}Tec(O,B=!1){if(this.$.isEditMode||B)if(!this.UM||this.$zd||this.ejb)O&&""!==O&&this.Esc.add(O),this.snc||(this.snc=!0,y.EwaSettings.isChangeGateEnabled("OfficeVSO:7629234_ChangeGetThemeInfoOperationBehavior")?z(this.$.qa.va,this.UMf,this.TMf,null,null):t(this.$.qa.va,this.UMf,this.TMf,null,null))}getThemeColor(O){let B,E=-1;B=-1;if(!this.fjb)return d.ULS.sendTraceTag(537150475,
0,10,"ThemesManager: ThemeColorsList is null"),{returnValue:!1,themeIndex:-1,tEa:B};for(let I=0;I<this.fjb.count;I++)if(O===this.fjb.ma(I)){E=I;break}if(-1!==E)return B=Math.floor(E/10),{returnValue:!0,themeIndex:E%10,tEa:B};d.ULS.sendTraceTag(537150474,0,10,"ThemesManager: Couldn't find theme color in cache.");return{returnValue:!1,themeIndex:-1,tEa:B}}dga(){for(let O of this.Esc)this.$.frame.Cy(O);this.Esc.clear()}$hh(O){const B=this.UM.FH.QEd;this.UM.FH.cGd===O.MinorFont&&B===O.MajorFont||d.ULS.sendTraceTag(512230155,
0,50,"ThemesManager.compareThemeInfoCache: Theme Fonts are updated")}};F=Object(f.b)([Object(D.d)(H.Fb),Object(f.c)(0,Object(H.E)())],F);Object(b.a)(F,"ThemesManager",null,[363]);class G extends e.a{constructor(O){super();this.$=O;this.uc()}create(){let O=this.$.da.Ba(422);O||(O=new F(this.$),this.$.da.Ja(422,O));this.$b(O)}static la(O){O.da.Ja(421,new G(O))}}Object(b.a)(G,"ThemesManagerFactory",e.a,[]);var L=a(72);a.d(C,"a",function(){return M});const M=()=>{c.a.Fa(O=>{Object(L.b)("OfficeVSO:7628240_migrateThemesManagerToNewServiceInfra")||
G.la(O)})};String(r);window.___1684780595473_closurehack=r},1292:function(r,C,a){r={};a.r(r);a.d(r,"OAuthManagerWrapper",function(){return w});var c={};a.r(c);var b=a(10),e=a(0),f=a(84),d=a(230),h=a(118),l=a(2),k=a(15),u=a(886),v=a(149),x=a(35);let w=class{constructor(D){this.oAuthManager=D}kD(D,H){return this.oAuthManager?this.oAuthManager.kD(D,H).then(F=>{F.IsSuccess||k.ULS.sendTraceTag(51401292,0,15,"Error retrieving auth token. Message: "+F.ErrorMessage+" Error code: "+F.ErrorCode+" App name: "+
D);return Object(l.a)(new u.a,{IsSuccess:F.IsSuccess,Token:F.Token,ErrorCode:F.ErrorCode,ErrorMessage:F.ErrorMessage})}):(k.ULS.sendTraceTag(537154971,0,10,"Oauth manager is null"),Promise.resolve(Object(l.a)(new u.a,{IsSuccess:!1,Token:null,ErrorCode:"FailedToResolve",ErrorMessage:"Failed to resolve IOAuthManager from the container."})))}APa(){return this.oAuthManager?this.oAuthManager.APa():null}};w=Object(h.b)([Object(v.d)(x.ib),Object(h.c)(0,Object(x.hb)())],w);Object(e.a)(w,"OAuthManagerWrapper",
null,[366]);var m=a(727);class t extends d.a{constructor(D){super();this.$=D;this.uc()}create(){this.$b(Object(m.a)(this.$.da,349,()=>new w(f.a.instance.resolve("Common.App.OAuth.IOAuthManager"))))}static la(D){D.da.Ja(350,new t(D))}}Object(e.a)(t,"OAuthManagerWrapperFactory",d.a,[]);var z=a(72);Object(v.b)(x.hb)(()=>f.a.instance.resolve("Common.App.OAuth.IOAuthManager"));a.d(C,"a",function(){return y});const y=()=>{b.a.Fa(D=>{Object(z.b)("OfficeVSO:7624847_MigrateOAuthToNewServiceInfra")||t.la(D)})};
String(r);String(c);window.___1684780588549_closurehack=r;window.___1684780588549_closurehack=c},1293:function(r,C,a){var c=a(10),b=a(118);r=a(0);var e=a(15),f=a(230),d=a(40),h=a(1),l=a(298),k=a(222);class u{}u.z_e="ewa-svg-icon";Object(r.a)(u,"CssClassNames",null,[]);var v=a(13),x=a(325),w=a(149),m=a(35);class t{constructor(H,F){this.Bc=null;this.Tg=()=>{this.ezf();this.$.ea.en(this.Tg)};this.$=H;this.fng={};this.n3d={};this.Bc=F;(F=this.Saf("excelInitialAppSprite"))?(this.pxe(F),this.$.ea.fg?this.ezf():
H.ea.yk(this.Tg),this.$.da.Ja(388,this)):e.ULS.sendTraceTag(537151263,0,15,"window[excelInitialAppSprite].icons returned null.")}dispose(){this.n3d=null;this.$.ea.en(this.Tg)}Ima(H,F,G=null,L=null){let M;(M=this.n3d[H])||(this.n3d[H]=M=this.vhj(this.fng[H]));if(!M)return e.ULS.shipAssertTag(537151262,0,!1,`SvgIconProvider.GetSvgElement: id ${H} was not found in loaded SVG sprites.`),null;const O=M.cloneNode(!0);if(!O.style){const B=x.b(M),E=x.b(O),I={};I.iconId=H;I.isOriginalNodeStyleNull=void 0===
M.style||null===M.style;I.isOriginalNodeCurrentStyleNull=void 0===M.currentStyle||null===M.currentStyle;I.isClonedNodeCurrentStyleNull=void 0===O.currentStyle||null===O.currentStyle;I.originalNode=B.substring(0,B.indexOf(">")+1);I.clonedNode=E.substring(0,E.indexOf(">")+1);e.ULS.sendTraceTag(537151261,0,10,`SvgIconProvider.GetSvgElement: cloned element's style is undefined. data: ${JSON.stringify(I)}`)}O.setAttribute("style",`height: ${F}px; width: ${F}px;`);L&&(H=document.createElement("title"),
this.Bc?this.Bc.Yh(H,L):H.textContent=L,O.insertBefore(H,O.childNodes[0]));if(G)for(const B of G)Sys.UI.DomElement.addCssClass(O,B);return O}dea(H,F,G,L,M=0,O=0,B=null,E=null){M&&O||(O=v.DOMElementExtensions.getBoundingClientRect(L),M=O.height,O=O.width);if(B=this.Ima(H,F,B,E))L.appendChild(B),(L=v.DOMElementExtensions.u0(B,"style",null))?B.setAttribute("style",L+` margin: ${(M-F)/2}px ${(O-G)/2}px;`):e.ULS.sendTraceTag(537151260,0,10,`SvgIconProvider.InsertAndCenterSvgElement: svgElement's GetAttribte("styl") returned null. Icon ID: ${H}`);
return B}ezf(){void w.a.resolve(m.B,{Wa:0}).then(H=>H("excel-uiSlice20-sprite")).then(()=>this.nVg())}nVg(){const H=this.Saf("excelUiSlice20Sprite");H?this.pxe(H):e.ULS.sendTraceTag(537151259,0,15,"window[excelUiSlice20Sprite].icons returned null.")}pxe(H){for(const F of H)F.type===k.a.l3d&&(this.fng[F.id]=F)}vhj(H){if(!H)return null;const F=H.viewBox;H=H.children;const G=document.createElementNS(l.a.o3d,k.a.l3d);Sys.UI.DomElement.addCssClass(G,u.z_e);G.setAttribute("focusable","false");G.setAttribute("viewBox",
F);this.oVg(G,H);return G}oVg(H,F){for(const L of F){const M=document.createElementNS(l.a.o3d,L.type);for(let O in L){F=O;var G=L[O];"className"===F?M.setAttribute("class",G):M.setAttribute(F,G)}H.appendChild(M)}}Saf(H){return(H=window[H])?H.icons:null}}Object(r.a)(t,"SvgIconProvider",null,[382,2]);var z=a(100);class y extends f.a{constructor(H){super();this.$=H;this.uc()}create(){const H=[this.oOi()];let F=null;h.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TooltipSanitizationImprovementWithSvgIconsEnabled",
!1)||(F=Object(z.d)(w.a.resolve(m.W,{Wa:0})),H.push(F));d.TaskExtensions.za(d.TaskExtensions.xe(H,this.$.ka),()=>{window.excelInitialAppSprite?this.$b(this.$.da.Ba(388)||new t(this.$,null===F||void 0===F?void 0:F.result)):e.ULS.sendTraceTag(537151258,0,50,"window.[excelInitialAppSprite] returned null.")},this.ka,3)}oOi(){return Object(z.d)(w.a.resolve(m.B,{Wa:this.La}).then(H=>Object(b.a)(this,void 0,void 0,function*(){return H("excel-app-intl")})))}static la(H){H.da.Ja(387,new y(H))}}Object(r.a)(y,
"SvgIconProviderFactory",f.a,[]);a.d(C,"a",function(){return D});const D=()=>{c.a.Fa(y.la)}},1322:function(r,C,a){function c(){b.a.Fa(()=>{})}r={};a.r(r);a.d(r,"IndexedDB",function(){return y});var b=a(10),e=a(118),f=a(0),d=a(15),h=a(31),l=a(172),k=a(190),u=a(40),v=a(33),x=a(1);class w{constructor(D){this.keyPath=D}}Object(f.a)(w,"KeyPathClass",null,[]);var m=a(63),t=a(149),z=a(35);let y=class extends k.a{constructor(D){super();this.Nib=this.Mcd=null;this.URe=1;this.SZa=null;this.$=D}get indexedDBFactory(){this.SZa||
(window.indexedDB?this.SZa=window.indexedDB:window.webkitIndexedDB?this.SZa=window.webkitIndexedDB:window.mozIndexedDB?this.SZa=window.mozIndexedDB:window.msIndexedDB&&(this.SZa=window.msIndexedDB));return this.SZa}get initialized(){return!!this.Mcd&&!!this.Nib}initialize(D,H,F){this.Mcd=D;this.Nib=H;this.URe=F}Bf(){try{return x.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&h.a.xQa||h.a.Bg&&91===h.a.qzb?!1:!!this.indexedDBFactory&&"undefined"!==typeof this.indexedDBFactory.open}catch(D){return d.ULS.sendTraceTag(537157640,
0,15,`IndexedDB.IsSupported() failed. Exception: ${D.message}`),!1}}Vgb(D){return this.Bf()&&this.initialized?u.TaskExtensions.V5(this.vLd(),H=>{if(void 0===H.result&&x.EwaSettings.isChangeGateEnabled("OfficeVSO:6476652_SuppressCouldntOpenIndexedDbJsCrash"))return!1;H=H.result;this.T$b(H);const F=v.a.Lb.hf.m;this.Dpd(H,!1).put(D);d.ULS.sendTraceTag(537157638,0,50,`IndexedDB.SaveToIndexedDB takes ${v.a.Lb.hf.m-F} Millisecond.`);return!0},this.ka):(d.ULS.sendTraceTag(537157639,0,15,"IndexedDB.SaveToIndexedDB: not supported or wasn't initilized."),
m.Task.Ua(!1))}zdd(D){return this.Bf()&&this.initialized?u.TaskExtensions.V5(this.vLd(),H=>{if(void 0===H.result&&x.EwaSettings.isChangeGateEnabled("OfficeVSO:6476652_SuppressCouldntOpenIndexedDbJsCrash"))return!1;H=H.result;this.T$b(H);const F=v.a.Lb.hf.m;this.Dpd(H,!1)["delete"](D);d.ULS.sendTraceTag(537157636,0,50,`IndexedDB.DeleteFromIndexedDB takes ${v.a.Lb.hf.m-F} Millisecond.`);return!0},this.ka):(d.ULS.sendTraceTag(537157637,0,15,"IndexedDB.DeleteFromIndexedDB: not supported or wasn't initilized."),
m.Task.Ua(!1))}T7a(D){return this.Bf()&&this.initialized?u.TaskExtensions.lkh(this.vLd(),H=>void 0===H.result&&x.EwaSettings.isChangeGateEnabled("OfficeVSO:6476652_SuppressCouldntOpenIndexedDbJsCrash")?m.Task.Ua(""):this.f7h(H.result,D),this.ka):(d.ULS.sendTraceTag(537157635,0,15,"IndexedDB.DeleteFromIndexedDB: not supported or wasn't initilized."),m.Task.Ua(""))}T$b(D){D.objectStoreNames.contains(this.Nib)||D.createObjectStore(this.Nib,new w("key"))}vLd(){const D=new l.a;let H;H=this.indexedDBFactory.open(this.Mcd,
this.URe);H.onsuccess=()=>{const F=H.result;d.ULS.sendTraceTag(537157634,0,50,`OpenIndexedDB ${F.name} success`);D.setResult(F)};H.onupgradeneeded=()=>{const F=H.result;d.ULS.sendTraceTag(520902218,0,50,`OpenIndexedDB ${F.name} upgrade needed`);try{this.T$b(F),d.ULS.sendTraceTag(520902217,0,50,`OpenIndexedDB ${F.name} upgrade done`)}catch(G){d.ULS.sendTraceTag(520902216,0,10,`OpenIndexedDB upgrade failed: ${G}`),x.EwaSettings.isChangeGateEnabled("OfficeVSO:6463223_Bug6241905")?D.setResult(void 0):
D.setException(Error.create("Failed to upgrade IndexedDB"))}};H.onerror=F=>{d.ULS.sendTraceTag(588288084,0,50,`OpenIndexedDB ${F} failed`);D.setResult(void 0)};return D.task}Dpd(D,H){return D.transaction([this.Nib],H?"readonly":"readwrite").objectStore(this.Nib)}f7h(D,H){const F=new l.a;this.T$b(D);const G=v.a.Lb.hf.m,L=this.Dpd(D,!0).get(H);L.onsuccess=M=>{(M=M.target.result)?(F.setResult(M.value),d.ULS.sendTraceTag(537157633,0,50,`IndexedDB.GetFromIndexedDB takes ${v.a.Lb.hf.m-G} Millisecond.`)):
F.setResult("")};L.onerror=()=>{F.setException(Error.create(L.error?L.error.message:"DB error"))};return F.task}};y=Object(e.b)([Object(t.d)(z.Y,{cy:"transient"}),Object(e.c)(0,Object(z.E)())],y);Object(f.a)(y,"IndexedDB",k.a,[251]);a.d(C,"a",function(){return c});String(r);window.___1684780585638_closurehack=r},1340:function(r,C,a){r=a(0);var c=a(15),b=a(889),e=a(980),f=a(6),d=a(103),h=a(428),l=a(261),k=a(43),u=a(41),v=a(31),x=a(115),w=a(84),m=a(184);class t{get name(){return"Common.App.OAuth.OAuthPackage"}Oi(y){y.register(364,
"Common.App.OAuth.IOAuthManager").gd().od(()=>new b.OAuthManager)}init(){const y=w.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.Zak(y)}Zak(y){const D=f.AFrameworkApplication.fa.Va("FileSource");if(f.AFrameworkApplication.fa.ra("IsO365ConsumerHost")||f.AFrameworkApplication.fa.ra("IsO365CommercialHost")||"WopiTest"===D){var H=h.OAuthManagerSettings.A4a;if(H&&H.IsEnabled){var F=H.Application,G=h.OAuthManagerSettings.authority;if(void 0!==F&&null!==F&&F.length&&void 0!==G&&null!==G&&G.length){var L=
e.a[y.$M],M=v.a.yva,O=y.Rw();try{var B=new Map;void 0!==B&&null!==B?(B.set("SupportStatus",L),B.set("Browser",M),B.set("AuthStrategy",O)):B=null}catch(I){B=null}d.Health.instance.recordKpiUsageForAlertableKpi("WacCorePFT","WacOAuthFC",B);var E=u.a.Fe();y.kD("Core",F).then(I=>{const S=Math.floor(u.a.Fe()-E);L=e.a[y.$M];M=v.a.yva;O=y.Rw();c.ULS.sendTraceTag(562943369,3E3,50,'OAuthManager attempted to get a Core token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',
S,I.IsSuccess,L,I.ErrorCode,D,M,O);B&&(B.set("SupportStatus",L),B.set("Browser",M),B.set("AuthStrategy",O));var J=Object.assign(new m.a,{durationMs:S,extendedProperties:B});if(I.IsSuccess){if(d.Health.instance.recordKpiSuccess("WacCorePFT",J),I="Bearer "+I.Token,f.AFrameworkApplication.qe.IVb=I,J=H.Endpoint){var K=u.a.Fe();f.AFrameworkApplication.qe.$rb(J,1,null,{["Authorization"]:I},"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(R=>{var Z=Math.floor(u.a.Fe()-K),P=null;R.ji?R=
"Canceled":R.Jg?R="Faulted":(P=R.result,R=P.succeeded?"Completed":"Failed");Z={["TaskResult"]:R,["BrowserTokenDurationMS"]:S,["BrowserValidationDurationMS"]:Z};P&&(Z.HttpStatus=P.Zh.data.httpStatus,P.succeeded&&(P=k.a(P.Zh.data.Pe),Z.ServerValidationDurationMS=P.ElapsedMilliseconds,Z.ServerValidationResult=P.ValidatedToken,Z.KMSI=P.KMSI,Z.Scopes=P.Scopes,Z.TokenExpirationS=Math.floor(parseInt(P.Expiration)-(new Date).getTime()/1E3)));c.ULS.sendTraceTag(520632322,3E3,"Completed"===R?50:15,x.a.toJSON(Z))})}}else d.Health.instance.recordKpiFailure("WacCorePFT",
I.ErrorCode,!1,!1,J)}).catch(I=>{var S=Math.floor(u.a.Fe()-E);S=Object.assign(new m.a,{durationMs:S,extendedProperties:B});d.Health.instance.recordKpiFailure("WacCorePFT","UNEXPECTED CATCH: "+I.toString(),!1,!1,S)})}}}}dispose(){}static main(){l.a.instance.wj(new t)}static Suj(){l.a.instance.wj(new t,0,!0)}}Object(r.a)(t,"OAuthPackage",null,[4,5]);a.d(C,"a",function(){return z});const z=y=>{Type.registerNamespace("Common.App.OAuth");y?t.Suj():t.main()}},1504:function(r,C,a){a.r(C);r=a(1322);C=a(1340);
var c=a(1292),b=a(1190),e=a(1293),f=a(1191),d=a(1206),h=a(1239),l=a(1277),k=a(1230);a=a(1235);Object(r.a)();Object(C.a)();Object(c.a)();Object(b.a)();Object(e.a)();Object(f.a)();Object(d.a)();Object(h.a)();Object(l.a)();Object(k.a)();Object(a.a)()},889:function(r,C,a){a.r(C);r=a(0);var c=a(15),b=a(1494),e=a(980),f;(function(ea){ea[ea.external=0]="external";ea[ea.msa=1]="msa";ea[ea.aad=2]="aad"})(f||(f={}));Object(r.b)("AuthorityType",f);var d=a(800);class h{constructor(ea){this.cLg=ea}initialize(){return Promise.resolve(0)}Zqc(){return Promise.resolve(0)}kD(){c.ULS.sendTraceTag(574239257,
3E3,50,"Automation flag set.  Returning Mock Token.");return Promise.resolve(Object.assign(new d.a,{IsSuccess:!0,Token:this.cLg}))}JIc(){return Promise.resolve(Object.assign(new d.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}bHc(){return!1}XBb(){return"MockAuthTokenStrategy"}}Object(r.a)(h,"MockAuthTokenStrategy",null,[399]);var l=a(1001);class k{static get(ea,aa,ia){if(!ia)return ea;
let ya=0;return Promise.race([ea,new Promise(za=>{ya=window.setTimeout(()=>{za(aa)},ia)})]).then(za=>{window.clearTimeout(ya);return Promise.resolve(za)}).catch(()=>{window.clearTimeout(ya);return Promise.resolve(aa)})}}Object(r.a)(k,"PromiseWithTimeout",null,[]);var u=a(6),v=a(428);class x{constructor(ea,aa,ia,ya,za){this.scope=this.resource=null;this.silentLogin=!1;this.correlationId=this.options=null;this.resource=ea;this.scope=aa;this.silentLogin=ia;this.options=ya;this.correlationId=za}}Object(r.a)(x,
"TokenRequestParameters",null,[412]);var w=a(31),m=a(84);class t{constructor(){this.uue=null;let ea=u.AFrameworkApplication.fa.Va(u.AFrameworkApplication.P$),aa=u.AFrameworkApplication.fa.Va(u.AFrameworkApplication.Brg);this.B0a=String.format("ParentFrameTokenStrategy uiHost={0} uiHostIntegrationType={1}",ea&&""!==ea?ea:"Unspecified",aa&&""!==aa?aa:"Unspecified")}initialize(){return new Promise(ea=>{m.a.instance.Dc("Common.App.WopiIdentity.IWopiIdentity").execute(aa=>{this.uue=aa;ea(0)})})}rj(ea){const aa=
["HTTPS:","API:"];let ia=!1;const ya=ea.toLocaleUpperCase();for(const za of aa)if(ya.startsWith(za)){ia=!0;break}return ia||this.lDi(ea)?ea+"/.default":ea}lDi(ea){return RegExp("/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i").test(ea)}Zqc(){return Promise.resolve(0)}kD(ea,aa,ia,ya,za,la,xa){if(w.a.gAa){za=v.OAuthManagerSettings.Xkk;if(!za)return aa=Object.assign(new d.a,{IsSuccess:!1,ErrorCode:"TeamsNoAllowListFound",ErrorMessage:"No app list was found."}),Promise.resolve(aa);
if(!Array.contains(za,ea))return aa=Object.assign(new d.a,{IsSuccess:!1,ErrorCode:"TeamsDisallowedApp",ErrorMessage:"Disallowed appName: "+ea}),Promise.resolve(aa)}ea=this.rj(ia);ia=new x(ia,ea,!ya,null,u.AFrameworkApplication.userSessionId);return this.uue.getAccessToken(ia,aa,xa).then(wa=>Object.assign(new d.a,{IsSuccess:!0,Token:wa.accessToken}),wa=>Object.assign(new d.a,{IsSuccess:!1,ErrorCode:wa}))}JIc(){return Promise.resolve(Object.assign(new d.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",
ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}bHc(){return!1}XBb(){return this.B0a}}Object(r.a)(t,"ParentFrameTokenStrategy",null,[399]);var z=a(88),y=a(896),D=a(198);class H{constructor(){this.reject=this.resolve=null;this.startTime=0;this.lZf=this.sEe=null}}Object(r.a)(H,"PromiseWrapper",null,[]);class F{constructor(ea=0){this.vD=0;this.wpb=!1;this.Rn=new D.a;this._timeout=ea}enqueue(ea){return new Promise((aa,ia)=>{this.Rn.add(Object.assign(new H,
{lZf:ea,resolve:aa,reject:ia}));this.process()})}process(){if(this.wpb||this.vD===this.Rn.count)return!1;const ea=this.Rn.ma(this.vD++);try{this.wpb=!0,ea.lZf().then(aa=>{this.wpb=!1;this.n$c(ea,aa,null,!0)}).catch(aa=>{this.wpb=!1;this.n$c(ea,null,aa,!1)})}catch(aa){this.wpb=!1,this.n$c(ea,null,aa,!1)}return!0}n$c(ea,aa,ia,ya){if(ya){const za=()=>{ea.resolve(aa);this.process()};0<this._timeout?window.setTimeout(()=>{za()},this._timeout):za()}else{const za=()=>{ea.reject(ia);this.process()};0<this._timeout?
window.setTimeout(()=>{za()},this._timeout):za()}}}Object(r.a)(F,"PromiseQueue",null,[]);class G{constructor(){this.correlationId=this.resolve=null}}Object(r.a)(G,"ResolveWithCorrelation",null,[]);var L=a(126),M=a(156),O=a(771),B=a(179);class E extends M.a{constructor(ea,aa,ia,ya,za,la){super(!1,!1,!0);this.oee=this.W3=null;this.OZ=ea;this.HMg=ia;this.ux=ya;this.pQg=za;this.cHa=la;this.uu=document.createElement("iframe");this.uu.id="SharedAuthInteractiveFrame";this.uu.setAttribute("name","SharedAuthInteractiveFrame");
this.uu.setAttribute("title","SharedAuthInteractiveFrame");this.uu.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.uu.style.border="0";this.uu.style.height="48px";this.uu.style.width="190px";$addHandler(this.uu,"error",Object(z.a)(this,this.kcj,"onSharedAuthFrameError"));ea=String.format("{0}{1}{2}{3}{4}{5}{6}{7}{8}",this.OZ,aa,"?replyUrl=",window.location.protocol,"//",window.location.host,"&interactive=1","&WacUserType=",u.AFrameworkApplication.userType);
this.uu.src=ea;this.hGg=new Promise(xa=>{this.oee=xa});this.pee=!1}gFc(){this.W3={["id"]:"SharedAuthConsentDialog",["bodyControls"]:{["promptMessage"]:this.HMg,["errorText"]:CommonUIStrings.l_InternalError,["rtl"]:u.AFrameworkApplication.isRtl,["frameLoaded"]:!1,["createFrame"]:Object(z.a)(this,this.woh,"createFrame"),["resolveDialogStyles"]:this.oee}};this.Ac=5;this.initializeAndShow(CommonUIStrings.l_SignIn,Object(z.a)(this,this.VSj,"sharedAuthConsentDialogHandler"),this.W3)}fKc(ea=!1,aa=!1,ia=
5){this.W3&&this.W3.bodyControls&&(ea!==Object(L.a)(Object,this.W3.bodyControls).frameLoaded&&(Object(L.a)(Object,this.W3.bodyControls).frameLoaded=ea),aa!==Object(L.a)(Object,this.W3.bodyControls).frameLoadSuccess&&(Object(L.a)(Object,this.W3.bodyControls).frameLoadSuccess=aa),ia!==this.W3.dialogButtonsOption&&(this.W3.dialogButtonsOption=null,this.Ac=ia),this.update(this.W3))}CZj(ea,aa){const ia=new O.a(B.a.ZSj);ia.Values={["signInLabel"]:CommonUIStrings.l_SignIn,["cancelLabel"]:CommonUIStrings.l_DialogCancel,
["rtl"]:u.AFrameworkApplication.isRtl,["messageCorrelationId"]:ea,["dialogStyles"]:aa};this.ux.k$(ia,this.uu.contentWindow,this.OZ)}V5e(){this.fKc(!0,!1,6)}get dgg(){return this.uu}get Uxh(){return this.hGg.then(ea=>{this.pee=!0;return ea})}get Vxh(){return this.pee}kcj(){this.V5e()}woh(){return this.uu}VSj(ea){0===ea&&(this.pQg.reject(Object.assign(new d.a,{ErrorCode:"UserCancelled",ErrorMessage:"The interactive flow was cancelled by the user"})),this.cHa(null))}}Object(r.a)(E,"SharedAuthConsentDialog",
M.a,[411]);var I=a(894),S=a(103),J=a(148),K=a(41),R=a(173),Z=a(184);class P{constructor(){this.uu=null;this.hZb=0;this.Job=this.S0a=this.mNc=this.cHa=this.uN=this.lte=null;this.ux=new I.a(null,null);this.B0a="SharedAuthTokenStrategy Unloaded";this.OZ=v.OAuthManagerSettings.XSj;this.nre=v.OAuthManagerSettings.WSj;this.hfe=v.OAuthManagerSettings.enableConsoleLogging;this.AGg=u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthPopupFlashEnabled",!1);this.NOg=u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthSkipUpnCheckEnabled",
!1);this.DQg=u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedWebWorkerEnabled",!1);this.Xta={};this.YIg=new F(1500)}XBb(){return this.B0a}initialize(){var {OAuthManager:ea}=a(889);if("loadFrame"in this.Xta)return this.Xta.loadFrame.sEe;if(!this.OZ)return S.Health.instance.recordKpiFailure(ea.kpiName,"SharedAuthFrameOriginNotSet",!1,!1,null),c.ULS.sendTraceTag(562381581,3E3,10,"SharedAuthTokenStrategy Init failed: No Shared Frame Origin Path"),Promise.reject(1);
ea=this.GGc("loadFrame");this.hZb=K.a.Fe();var aa=this.OZ+this.nre+"?replyUrl="+window.location.protocol+"//"+window.location.host+"&usid="+u.AFrameworkApplication.userSessionId+"&WacUserType="+u.AFrameworkApplication.userType;this.DQg&&(aa+="&webworker=1");this.uu=document.createElement("iframe");this.nPa(this.uu);this.uu.style.cssText="height:0;width:0;display:none;";this.uu.id="SharedAuthFrame";this.uu.setAttribute("name","SharedAuthFrame");this.uu.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");
this.uu.setAttribute("title","SharedAuthFrame");this.uu.src=aa;document.body.appendChild(this.uu);aa=K.a.Fe()-this.hZb;c.ULS.sendTraceTag(573112899,3E3,50,"SharedAuthTokenStrategy Create: Frame Appended to Document. E/T:[{0}]. sharedAuthFrame.Src={1}",aa,this.uu.src);return ea}Zqc(ea){this.mNc=ea;const aa=new O.a(B.a.ggg);aa.Values=this.SDe(ea);ea=this.GGc("initFrame");this.ux.k$(aa,this.uu.contentWindow,this.OZ);c.ULS.sendTraceTag(573112900,3E3,50,"SharedAuthTokenStrategy Init: Called package initialize.");
return ea}kD(ea,aa,ia,ya,za,la){const xa=new O.a(B.a.$Sj),wa=this.Pdf();xa.Values=this.Sqg(ea,aa,ia,ya,za,la,wa);ea=this.GGc(wa);ya&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthInteractiveConsentUI",!1)?this.YIg.enqueue(()=>new Promise(hb=>{this.rak(la,xa,hb,wa)})):(this.ux.k$(xa,this.uu.contentWindow,this.OZ),c.ULS.sendTraceTag(573112901,3E3,50,"SharedAuthTokenStrategy TryGetToken: Called TryGetToken for app {0}",aa));return ea}rak(ea,aa,ia,ya){const za=
this.Xta[ya];za&&(this.S0a=aa,this.cHa=Object.assign(new G,{resolve:ia,correlationId:ya}),this.uN=new E(this.OZ,this.nre,ea,this.ux,za,ia),this.uN.gFc())}Pdf(){return R.a.create().toString()}Sqg(ea,aa,ia,ya,za,la,xa){const wa={};wa.appName=ea;wa.appId=aa;wa.target=ia;wa.withPopup=ya;wa.claims=za;wa.promptMessage=la;wa.messageCorrelationId=xa;return wa}nPa(ea){$addHandler(ea,"load",Object(z.a)(this,this.Z7i,"onIFrameLoaded"));$addHandler(ea,"error",Object(z.a)(this,this.Ruc,"onIFrameError"));this.ux.$Q(this.OZ);
this.ux.wn(B.a.jgg);this.ux.ql(B.a.jgg,Object(z.a)(this,this.Abj,"onScriptLoaded"));this.ux.wn(B.a.igg);this.ux.ql(B.a.igg,Object(z.a)(this,this.zbj,"onScriptInitialized"));this.ux.wn(B.a.egg);this.ux.ql(B.a.egg,Object(z.a)(this,this.A7i,"onGetTokenResponse"));this.ux.wn(B.a.kgg);this.ux.ql(B.a.kgg,Object(z.a)(this,this.u9i,"onLoginResponse"));this.ux.wn(B.a.hgg);this.ux.ql(B.a.hgg,Object(z.a)(this,this.v8i,"onInteractiveFlowReady"));this.ux.wn(B.a.fgg);this.ux.ql(B.a.fgg,Object(z.a)(this,this.S7i,
"onHideDialog"));this.ux.wn(B.a.cgg);this.ux.ql(B.a.cgg,Object(z.a)(this,this.P2i,"onCloseDialog"))}GGc(ea){const aa=new H;aa.startTime=K.a.Fe();const ia=new Promise((ya,za)=>{aa.resolve=ya;aa.reject=za});aa.sEe=ia;this.Xta[ea]=aa;return ia}Z7i(){const ea=K.a.Fe()-this.hZb;c.ULS.sendTraceTag(572346566,3E3,50,"WACOAuth.aspx iFrame loaded successfully. E/T:[{0}]",ea)}Ruc(ea){const {OAuthManager:aa}=a(889),ia=K.a.Fe()-this.hZb,ya=Object.assign(new Z.a,{durationMs:ia});S.Health.instance.recordKpiFailure(aa.kpiName,
"SharedAuthWACOAuthAspxFrameError",!1,!0,ya);c.ULS.sendTraceTag(572346567,3E3,10,"WACOAuth.aspx iFrame failed to load after {0} ms: {1}",ia,this.hfe?JSON.stringify(ea):"")}Abj(ea){const {OAuthManager:aa}=a(889),ia=this.Xta.loadFrame;var ya=K.a.Fe()-ia.startTime,za=ea.Values.AuthLibrary.toString();ea=ea.Values.Success.toString();c.ULS.sendTraceTag(573112902,3E3,50,"SharedAuthTokenStrategy OnScriptLoaded. Success={0} AuthLibrary={1} E/T: [{2}]",ea,za,ya);za&&(this.B0a="SharedAuthTokenStrategy "+za);
za=Boolean.parse(ea);za||(ea=J.a.zt(),void 0!==ea&&null!==ea&&(ea.set("AuthLibrary",this.XBb()),ya=Object.assign(new Z.a,{durationMs:ya,extendedProperties:ea}),S.Health.instance.recordKpiFailure(aa.kpiName,"SharedAuthStrategyInitFailed",!1,!0,ya)));ia.resolve(za?0:1)}zbj(ea){if(ea.Values.interactive&&this.S0a&&this.S0a.Values.messageCorrelationId){const ia=this.S0a.Values.messageCorrelationId.toString();if(ea.Values.interactive&&this.uN){this.uN.Uxh.then(ya=>{this.ux.k$(this.S0a,this.uN.dgg.contentWindow,
this.OZ);this.uN.CZj(ia,ya);this.uN.fKc(!0,!0);this.S0a=null});return}}ea=this.Xta.initFrame;const aa=K.a.Fe()-ea.startTime;c.ULS.sendTraceTag(573112903,3E3,50,"SharedAuthTokenStrategy OnScriptInitialized. E/T: [{0}]",aa);ea.resolve(0)}A7i(ea){if(ea.Values.messageCorrelationId&&ea.Values.messageCorrelationId.toString()){var aa=ea.Values.messageCorrelationId.toString(),ia=this.Xta[aa];if(ia){var ya=K.a.Fe()-ia.startTime;c.ULS.sendTraceTag(573112906,3E3,50,"SharedAuthTokenStrategy OnGetTokenResponse. E/T: [{0}]",
ya);ea.Values.isSuccess&&ea.Values.isSuccess?ia.resolve(ea.Values.response):ia.reject(ea.Values.response);this.hrg(aa)}else c.ULS.sendTraceTag(573112905,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called with an unregistered messageCorrelationId")}else c.ULS.sendTraceTag(573112904,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called without valid messageCorrelationId")}v8i(){if(this.uN.Vxh)this.uN.V5e();else if(this.mNc&&this.uN){const ea=new O.a(B.a.ggg);ea.Values=this.SDe(this.mNc,!0);
this.ux.k$(ea,this.uN.dgg.contentWindow,this.OZ)}}S7i(){this.uN&&this.uN.a9a()}P2i(ea){ea.Values.cancelled&&ea.Values.cancelled&&ea.Values.messageCorrelationId&&this.hrg(ea.Values.messageCorrelationId.toString());this.uN&&this.uN.hide()}SDe(ea,aa=!1){const ia={};ia.appIds=this.Y_h();ia.upn=ea.loginHint;ia.authority=ea.authority;ia.authorityType=Object(b.a)(f,ea.authorityType);ia.tenantId=ea.tenantId;ia.correlationId=u.AFrameworkApplication.userSessionId;ia.enableConsoleLogging=this.hfe;ia.enablePopupFlash=
this.AGg;ia.skipUpnCheck=this.NOg;ia.interactive=aa;return ia}Y_h(){const ea=[],aa=v.OAuthManagerSettings.b4c;for(let ya in aa){var ia=aa[ya];Array.contains(ea,ia)||Array.add(ea,ia)}return ea}JIc(ea,aa,ia,ya,za,la){const xa=new O.a(B.a.YSj),wa=this.Pdf();xa.Values=this.Sqg(ea,aa,ia,ya,za,la,wa);this.lte=xa;ea=this.GGc(wa);c.ULS.sendTraceTag(555049437,3E3,50,"SharedAuthTokenStrategy TryLogin: Called TryLogin for app {0}",aa);this.pXj();return ea}bHc(){return!0}pXj(){this.Job||(this.Job=new y.a(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Title,
CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Body,null),this.Job.id=16,this.Job.Vxd=!1,this.Job.addButton(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,()=>{c.ULS.sendTraceTag(527827290,3E3,50,"SharedAuthTokenStrategy TryLogin: User Clicked Login");this.ux.k$(this.lte,this.uu.contentWindow,this.OZ)},CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,!0),c.ULS.sendTraceTag(555049438,3E3,10,"Failed to add entry to business bar. Login message could not be shown to user."))}u9i(ea){if(ea.Values.messageCorrelationId&&
ea.Values.messageCorrelationId.toString()){var aa=this.Xta[ea.Values.messageCorrelationId.toString()];if(aa){var ia=K.a.Fe()-aa.startTime;c.ULS.sendTraceTag(555049441,3E3,50,"SharedAuthTokenStrategy OnLoginResponse. E/T: [{0}]",ia);ea.Values.isSuccess&&ea.Values.isSuccess?aa.resolve(ea.Values.response):aa.reject(ea.Values.response)}else c.ULS.sendTraceTag(555049440,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called with an unregistered messageCorrelationId")}else c.ULS.sendTraceTag(555049439,
3E3,10,"SharedAuthTokenStrategy OnLoginResponse called without valid messageCorrelationId")}hrg(ea){this.cHa&&this.cHa.correlationId===ea&&(this.cHa.resolve(null),this.cHa=null)}}Object(r.a)(P,"SharedAuthTokenStrategy",null,[399]);class V{constructor(ea){this.IXc=ea;this.B0a="UnsupportedAuthTokenStrategy Reason="+e.a[this.IXc]}initialize(){return Promise.resolve(0)}Zqc(){return Promise.resolve(0)}kD(){return Promise.resolve(Object.assign(new d.a,{IsSuccess:!1,ErrorCode:e.a[this.IXc],ErrorMessage:"Unable to get a token. Reason: ["+
e.a[this.IXc]+"]"}))}JIc(){return Promise.resolve(Object.assign(new d.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}bHc(){return!1}XBb(){return this.B0a}}Object(r.a)(V,"UnsupportedAuthTokenStrategy",null,[399]);var Ea=a(745);a.d(C,"OAuthManager",function(){return oa});class oa{constructor(ea=null){this.$M=0;this.aN=null;this.nNg=0;this.ije=!!window.location.search.match(RegExp("wdpa=1",
"gi"));const aa=K.a.Fe();this.NIg=this.gxh(ea).then(ia=>ia?this.vsi():(c.ULS.sendTraceTag(527827277,3E3,15,"DetermineAuthLibrary failed leaving {0} in {1} ms, all future TryGetToken requests will fail.",this.Rw(),Math.floor(K.a.Fe()-aa)),ia=J.a.zt(),void 0!==ia&&null!==ia&&(ia.set("AuthLibrary",this.Rw()),ia=Object.assign(new Z.a,{durationMs:Math.floor(K.a.Fe()-aa),extendedProperties:ia}),S.Health.instance.recordKpiFailure(oa.kpiName,"StrategyPickFailed",!1,!0,ia)),Promise.resolve(1))).then(ia=>0!==
ia?Promise.resolve(ia):this.hOi())}hxh(){if(this.ije)this.$M=5,this.aN=new V(this.$M);else{var ea=v.OAuthManagerSettings.QWi;ea&&0<ea.length?(this.$M=1,this.aN=new h(ea)):u.AFrameworkApplication.fa.ra("IsO365ConsumerHost")||u.AFrameworkApplication.fa.ra("IsO365CommercialHost")?u.AFrameworkApplication.fa.ra("IsAnonymousUser")?(this.$M=2,this.aN=new V(this.$M)):(ea=l.a.getAuthContext().loginHint)&&ea.length?v.OAuthManagerSettings.jDb?(this.$M=1,this.aN=new t):(this.$M=1,this.aN=new P):(this.$M=3,this.aN=
new V(this.$M)):(this.$M=4,this.aN=new V(this.$M))}}Rw(){return this.aN?this.aN.XBb()||"Unknown":"None"}gxh(ea=null){c.ULS.sendTraceTag(562128578,3E3,50,"Creating OAuthManager.");const aa=K.a.Fe();return u.AFrameworkApplication.fa.lnd().then(ia=>{ia?(this.hxh(),ea&&(this.aN=ea),c.ULS.sendTraceTag(42084323,3E3,50,"Creation succeeded OAuthManager successfully in {4} ms with clientVer={0}, appVer={1}, docVer={2}, strategy={3}",v.OAuthManagerSettings.clientVersion,v.OAuthManagerSettings.appVersion,v.OAuthManagerSettings.eAh,
this.Rw(),Math.floor(K.a.Fe()-aa))):c.ULS.sendTraceTag(562128579,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(K.a.Fe()-aa));return Promise.resolve(ia)},()=>{c.ULS.sendTraceTag(562128580,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(K.a.Fe()-aa));return Promise.resolve(!1)})}vsi(){c.ULS.sendTraceTag(573390991,3E3,50,
"Initializing {0}",this.Rw());const ea=K.a.Fe();return k.get(this.aN.initialize(),2,v.OAuthManagerSettings.YOd).then(aa=>{if(0===aa)c.ULS.sendTraceTag(42084353,3E3,50,"Initialization succeeded for {0} in {1} ms.",this.Rw(),Math.floor(K.a.Fe()-ea));else if(1===aa){c.ULS.sendTraceTag(527827291,3E3,15,"Initialization failed for {0} in {1} ms, all future TryGetToken requests will fail.",this.Rw(),Math.floor(K.a.Fe()-ea));var ia=J.a.zt();void 0!==ia&&null!==ia&&(ia.set("AuthLibrary",this.Rw()),ia=Object.assign(new Z.a,
{durationMs:Math.floor(K.a.Fe()-ea),extendedProperties:ia}),S.Health.instance.recordKpiFailure(oa.kpiName,"StrategyInitFailed",!1,!0,ia))}else 2===aa&&(c.ULS.sendTraceTag(42267908,3E3,15,"Initialization timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.Rw(),Math.floor(K.a.Fe()-ea)),ia=J.a.zt(),void 0!==ia&&null!==ia&&(ia.set("AuthLibrary",this.Rw()),ia=Object.assign(new Z.a,{durationMs:Math.floor(K.a.Fe()-ea),extendedProperties:ia}),S.Health.instance.recordKpiFailure(oa.kpiName,
"StrategyInitTimedOut",!1,!0,ia)));return Promise.resolve(aa)},()=>{c.ULS.sendTraceTag(574239256,3E3,15,"Initialization failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.Rw(),Math.floor(K.a.Fe()-ea));return Promise.resolve(1)})}hOi(){c.ULS.sendTraceTag(562128581,3E3,50,"Loading {0}",this.Rw());const ea=K.a.Fe();return k.get(this.aN.Zqc(l.a.getAuthContext()),2,v.OAuthManagerSettings.YOd).then(aa=>{if(0===aa)c.ULS.sendTraceTag(562128582,3E3,50,"Load succeeded for {0} in {1} ms.",
this.Rw(),Math.floor(K.a.Fe()-ea));else if(1===aa){c.ULS.sendTraceTag(562128583,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.Rw(),Math.floor(K.a.Fe()-ea));var ia=J.a.zt();void 0!==ia&&null!==ia&&(ia.set("AuthLibrary",this.Rw()),ia=Object.assign(new Z.a,{durationMs:Math.floor(K.a.Fe()-ea),extendedProperties:ia}),S.Health.instance.recordKpiFailure(oa.kpiName,"StrategyLoadFailed",!1,!0,ia))}else 2===aa&&(c.ULS.sendTraceTag(558469660,3E3,15,"Load timed out for {0} after {1} ms, all future TryGetToken requests will fail.",
this.Rw(),Math.floor(K.a.Fe()-ea)),ia=J.a.zt(),void 0!==ia&&null!==ia&&(ia.set("AuthLibrary",this.Rw()),ia=Object.assign(new Z.a,{durationMs:Math.floor(K.a.Fe()-ea),extendedProperties:ia}),S.Health.instance.recordKpiFailure(oa.kpiName,"StrategyLoadTimedOut",!1,!0,ia)));return Promise.resolve(aa)},()=>{c.ULS.sendTraceTag(562128584,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.Rw(),Math.floor(K.a.Fe()-ea));return Promise.resolve(1)})}kD(ea,aa,ia=null){return this.HIc(ea,
aa,!1,null,"",ia)}Tqg(ea,aa,ia,ya,za=null){return this.HIc(ea,aa,!0,ia,ya,za)}HIc(ea,aa,ia,ya,za,la,xa=0){xa+=1;c.ULS.sendTraceTag(42084352,3E3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called.  Using strategy {2} - attempt {3}",ea,this.WUa(ea,aa),this.Rw(),xa);var wa=J.a.zt();void 0!==wa&&null!==wa&&(wa.set("AuthLibrary",this.Rw()),wa.set("AppName",ea),wa.set("Target",this.WUa(ea,aa)),S.Health.instance.recordKpiUsage(oa.kpiName,0,"WacOAuthFC",wa));if(!v.OAuthManagerSettings.isEnabled||
this.ije){var hb;return this.fDd((hb=new d.a,hb.IsSuccess=!1,hb.Token=null,hb.ErrorCode="NotEnabled",hb.ErrorMessage="OAuthManager is disabled.",hb),ea)}const Ja=v.OAuthManagerSettings.b4c[ea];if(void 0===Ja||null===Ja){c.ULS.sendTraceTag(41961345,3E3,15,"Auth context not found. Ensure that your app [{0}] is listed in the OAuthManagerApplications setting.",ea);var Fa;return this.fDd((Fa=new d.a,Fa.IsSuccess=!1,Fa.Token=null,Fa.ErrorCode="DisallowedApp",Fa.ErrorMessage="Disallowed appName: "+ea,Fa),
ea)}const Ba=K.a.Fe();let fa=Ba;const ta=this;wa=this.NIg.then(pa=>{fa=K.a.Fe();return ta.oyi(ea,Ja,aa,ia,ya,za,la,pa)});hb=ia?0:v.OAuthManagerSettings.YOd;let Oa;Fa=(Oa=new d.a,Oa.IsSuccess=!1,Oa.Token=null,Oa.ErrorCode="authTokenStrategy_timeout",Oa.ErrorMessage="Auth Strategy timed out after ["+hb+"] ms when fetching token",Oa);let Ma=this,fb=this;return k.get(wa,Fa,hb).then(pa=>xa<=oa.yVi&&(pa.ErrorCode===oa.Tog||pa.ErrorCode===oa.p3j)?(c.ULS.sendTraceTag(573175516,3E3,50,"TryGetToken attempt {0} timed out after {1} ms - retrying",
xa,Math.floor(K.a.Fe()-Ba)),Ma.HIc(ea,aa,ia,ya,za,la,xa)):pa.ErrorCode===oa.twf&&!ia&&(c.ULS.sendTraceTag(561517645,3E3,50,"TryGetToken attempt {0} failed with ITP error.  3P Cookies are [{1}]. Retry: [{2]}]",xa,oa.mXe),oa.kDh&&Ma.aN.bHc()&&Ma.aN.JIc(ea,Ja,aa,ia,ya,za).then(Ua=>Promise.resolve(Ma.wrc(Ua,ea,aa,Ja,Ba,fa))).catch(()=>{let Ua;const Sa=(Ua=new d.a,Ua.IsSuccess=!1,Ua.Token=null,Ua.ErrorCode="authTokenStrategy_failure",Ua.ErrorMessage="LoginPopup failed, GetToken could not be called",Ua);
return Promise.resolve(Ma.wrc(Sa,ea,aa,Ja,Ba,fa))}),oa.mXe)?Ma.HIc(ea,aa,!0,ya,za,la,xa):Promise.resolve(Ma.wrc(pa,ea,aa,Ja,Ba,fa))).catch(()=>{let pa;const Ua=(pa=new d.a,pa.IsSuccess=!1,pa.Token=null,pa.ErrorCode="authTokenStrategy_failure",pa.ErrorMessage="Auth Strategy failed with an unknown error",pa);return Promise.resolve(fb.wrc(Ua,ea,aa,Ja,Ba,fa))})}oyi(ea,aa,ia,ya,za,la,xa,wa){return 1===wa||2===wa?this.fDd(Object.assign(new d.a,{IsSuccess:!1,Token:null,ErrorCode:1===wa?"InitFailed":"InitTimedOut",
ErrorMessage:"Auth Strategy Failed to Init or Load"}),ea):this.aN.kD(ea,aa,ia,ya,za,la,xa).then(hb=>Promise.resolve(this.EGf(hb,!0,ea))).catch(hb=>Promise.resolve(this.EGf(hb,!1,ea)))}wrc(ea,aa,ia,ya,za,la){const xa={},wa=K.a.Fe()-la;xa.IsSuccess=ea.IsSuccess;xa.ErrorCode=ea.IsSuccess?"Success":ea.ErrorCode||"";xa.ErrorMessage=ea.IsSuccess?"Success":this.WUa(aa,ea.ErrorMessage||"");xa.Target=this.WUa(aa,ia||"");xa.TimeInMS=Math.floor(wa);xa.LoadTimeInMS=Math.floor(la-za);xa.AuthLibrary=this.Rw();
xa.AppName=aa;xa.AuthorityType=Object(b.a)(f,l.a.Ggc());xa.UserType=this.cii(l.a.getAuthContext());xa.IsAuthSupportedInSession=e.a[this.$M];xa.RequestCount=++this.nNg;xa.AppId=ya;c.ULS.sendTraceTag(593863640,3E3,50,JSON.stringify(xa));ea.IsSuccess||(ia=J.a.zt(),void 0!==ia&&null!==ia&&(ia.set("AppName",aa),ia.set("AuthLibrary",this.Rw()),ia.set("ErrorCode",ea.ErrorCode),ia.set("ErrorMessage",this.WUa(aa,ea.ErrorMessage)),aa=Object.assign(new Z.a,{durationMs:wa,extendedProperties:ia}),S.Health.instance.recordKpiFailure(oa.kpiName,
"TryGetTokenFailure",!1,!0,aa)));return ea}fDd(ea,aa){c.ULS.sendTraceTag(578435090,3E3,15,"OAuthManager failed without invoking GetToken. AppName: '{0}', Reason: '{1}'",aa,this.WUa(aa,ea.ErrorMessage));const ia=J.a.zt();void 0!==ia&&null!==ia&&(ia.set("AppName",aa),ia.set("AuthLibrary",this.Rw()),ia.set("ErrorCode",ea.ErrorCode),ia.set("ErrorMessage",this.WUa(aa,ea.ErrorMessage)),aa=Object.assign(new Z.a,{extendedProperties:ia}),S.Health.instance.recordKpiFailure(oa.kpiName,"FailureBeforeGetToken",
!1,!0,aa));return Promise.resolve(ea)}jrf(ea){return ea===Ea.a.SHc}WUa(ea,aa){return this.jrf(ea)&&aa?"REDACTED":aa}cii(ea){return u.AFrameworkApplication.fa.ra("IsAnonymousUser")?"anonymous":!ea.loginHint||1>ea.loginHint.length?"empty":-1<ea.loginHint.indexOf("guest#")?"guest":-1<ea.loginHint.indexOf("ext#")?"external":0>ea.upn.indexOf("@")?"no-at":"supported"}APa(){return 1===this.$M}EGf(ea,aa,ia){let ya=null,za=null,la=null,xa=null;ea?ea.ErrorCode||ea.ErrorMessage?(za=ea.ErrorCode?ea.ErrorCode:
oa.g2e,la=ea.ErrorMessage?ea.ErrorMessage:"No message"):ea.Token?aa?ya=ea.Token:(za=oa.Mvj,la="A rejected promise returned a token."):(za=oa.g2e,la=JSON.stringify(ea)):(za=oa.gZi,la="No result came from Auth Token Strategy");ea&&ea.Telemetry&&!this.jrf(ia)&&(xa=ea.Telemetry,c.ULS.sendTraceTag(579166408,3E3,50,JSON.stringify(xa)));if(za===oa.$Wi||za===oa.l8j)za=oa.Tog,la="Auth Library Timed Out";za===oa.n4g&&-1<la.indexOf(oa.hRg)&&(za=oa.twf);if(za||la)ya=null;return Object.assign(new d.a,{IsSuccess:!!ya,
Token:ya,ErrorCode:za,ErrorMessage:la,Telemetry:xa})}static get mXe(){return u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthInteractiveFallbackEnabled",!1)}static get kDh(){return u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginFlowEnabled",!1)}}oa.l8j="token_renewal_error";oa.g2e="Exception";oa.gZi="NoResult";oa.Mvj="RejectToken";oa.$Wi="monitor_window_timeout";oa.Tog="Timeout";oa.p3j="authTokenStrategy_timeout";oa.n4g=
"login_required";oa.hRg="AADSTS50058";oa.twf="Cookies Disabled";oa.kpiName="OAuthManager";oa.yVi=2;Object(r.a)(oa,"OAuthManager",null,[364])},980:function(r,C,a){a.d(C,"a",function(){return c});r=a(0);var c;(function(b){b[b.unknown=0]="unknown";b[b.supported=1]="supported";b[b.userUnsupportedAnonymous=2]="userUnsupportedAnonymous";b[b.userUnsupportedNoLoginHint=3]="userUnsupportedNoLoginHint";b[b.hostUnsupported=4]="hostUnsupported";b[b.perfAutomation=5]="perfAutomation"})(c||(c={}));Object(r.b)("SupportStatus",
c)}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSOpt.vrs.js.map/cd56782dd0baaf08581befff15339af5/EwaDSOpt.vrs.js.map