'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[34],{1186:function(r,C,a){a.d(C,"a",function(){return b});var c=a(522);const b=()=>{c.a.sj(".ewa-resizehdr-row-hidden{width:inherit;height:0}.ewa-resizehdr-col-hidden{width:0;height:inherit}")}},1229:function(r,C,a){var c=a(10);r=a(0);var b=a(230),e=a(9),f=a(20),d=a(73),h=a(68),l=a(7),k=a(36);class u{}u.fKh="ewa-resizehdr-row-hidden";u.eKh="ewa-resizehdr-col-hidden";Object(r.a)(u,"CssClassNames",null,[]);var v=a(250),
x=a(14),w=a(170),m=a(651),t=a(31),z=a(232),y=a(6),D=a(235),H=a(15),F=a(75),G=a(136),L=a(47),M=a(25),O=a(54),B=a(13),E=a(76),I=a(1),S=a(101),J=a(12),K=a(16),R=a(264),Z=a(137),P=a(383),V=a(50),Ea=a(37);class oa{constructor(Da,zb,qb,Pa,Nb,Tb,Vb){this.Wya=Da;this.kJb=zb;this.iSa=qb;this.esd=Pa;this.Bgb=Nb;this.Ivf=Tb;this.Zni=Vb}}Object(r.a)(oa,"HeaderEventCachedInfo",null,[]);class ea{constructor(Da){this.Ned=Da}RNe(Da){Da=J.HelperMethods.VMd(Da);return Math.max(0,Math.min(ea.dEf,Da))}GNe(Da){return this.djj(Da)}Egh(Da){return Math.round(this.Ned*
Da+2*this.t$e()+1)}djj(Da){return Math.max(0,Math.min(ea.IDf,(Math.max(0,Math.min(e.a.qsc,Da))-2*this.t$e()-1)/this.Ned))}t$e(){return Math.floor(Math.max((this.Ned+3)/4,2))}dic(Da,zb){return zb?Da?ea.dEf:e.a.nFd:Da?ea.IDf:e.a.qsc}}ea.dEf=409;ea.IDf=255;Object(r.a)(ea,"ResizeHeadersConverter",null,[]);var aa=a(185);class ia extends S.a{constructor(Da,zb){super(zb.domElement);this.BZ=this.h8f=!1;this.$i=this.ebb=this.$Da=null;this.hUd=!0;this.Roc=!1;this.fQb=this.em=this.offset=0;this.rO=this.sT=this.j3=
null;this.fpi="headerResizeTooltip";this.KH=this.ADd=null;this.x5c=this.k4=this.cDa=!1;this.tUf=this.Pdb=e.a.tza;this.LVb=!1;this.iy=qb=>{if(this.grid.rk)return!1;qb=Ea.a(this.grid.$).df(qb);if(3===qb.kc&&!this.Jvf(qb.Da)||!this.xXf(qb,!1))return!1;H.ULS.sendTraceTag(537154058,2,50,"HeaderResizeBehavior.OnMouseDown: About to generate tooltip");const Pa=this.zFc();this.ald(qb.clientPoint,Pa,!0);this.cDa||(v.a.instance.ta(x.a.dl,this.domElement.ownerDocument.body,this.cdb),w.a.instance.ta(x.a.lh,this.domElement.ownerDocument.body,
this.cdb),this.cDa=!0);this.yrf()&&this.BZ&&this.Tlf(qb);return!1};this.EKb=qb=>{qb=Ea.a(this.grid.$).df(qb);this.yrf()&&this.x5c&&this.Tlf(qb);if(!qb.Da.type.includes("touch")&&qb.Da.button!==Sys.UI.MouseButton.leftButton||!this.jGb)return!1;E.g(qb.Da);this.DXe();qb=this.grid.rk?this.Pdb:e.a.tza;var Pa=!1;if(this.grid.rk&&this.$i){var Nb=qb!==this.em;!Nb&&this.LVb&&(this.Se.removeRowColFromModel(this.$i.hrb,this.$i.i3f),Pa=!0,I.EwaSettings.Bn()&&(this.Se.S$(this.grid.ga.pa.selectedRanges),this.Se.kn("HeaderResizeBehavior::onDocumentMouseUp")))}else this.$i&&
(qb=this.k4?this.Bmd():this.$i.b7()),Nb=qb!==this.em;this.$Da&&Nb&&qb!==e.a.tza?(qb=this.grid,Pa=this.Zod(qb),Nb={},Nb.SheetMultiRange=L.r(Pa,qb.$),ia.JYd(Nb,this.isRow,this.em),this.grid.rk&&(Pa=Nb.SheetMultiRange.Ranges[0],H.ULS.sendTraceTag(509694147,2,50,`HeaderResizeBehavior.OnDocumentMouseUp: cellAbsoluteIndex=${this.$i?this.$i.hrb:-1}, isResizingHiddenHeader=${this.k4}, headerViewBlockHashCode=${this.Se.hashCode},
          rangeFirstRow=${Pa.FirstRow}, rangeFirstColumn=${Pa.FirstColumn}, rangeLastRow=${Pa.LastRow}, rangeLastColumn=${Pa.LastColumn},`)),this.NDh(Nb),qb.L4j=!0):(!I.EwaSettings.Bn()&&Pa&&(this.Se.S$(this.grid.ga.pa.selectedRanges),this.Se.kn("HeaderResizeBehavior::onDocumentMouseUp")),this.Uf(null,null),this.nOb());return this.LVb=this.k4=!1};this.ofa=qb=>{if(this.grid.rk)return!1;qb=m.a.create(qb.eventName,qb.Fc,qb.Da,qb.kc);qb=Ea.a(this.grid.$).df(qb);if(!this.xXf(qb,!0))return!1;qb=this.grid;
var Pa=this.Zod(qb);Pa=L.r(Pa,qb.$);qb.pc.Sk([this.isRow?13:14]);qb.pc.hWa();this.nOb();qb.$.Ed(this.isRow?146338636:1391094586,F.a.fc,30,{["autoFitRanges"]:Pa});return!1};this.kNf=qb=>{this.BZ?(this.k4&&!this.LVb&&(this.BTg(),I.EwaSettings.Bn()&&this.Se.kn("HeaderResizeBehavior::onHeaderResizeChanged")),this.Roc||this.dnf(),qb=new Sys.UI.DomEvent(qb),qb=m.a.create(x.a.Zja,this.domElement,qb,2),qb=Ea.a(this.grid.$).df(qb),this.MJd(qb.clientPoint)):H.ULS.sendTraceTag(521480320,2,50,`HeaderResizeBehavior.onHeaderResizeChanged: Reached during no resize mode. cellAbsoluteIndex = ${this.$i?
this.$i.hrb:-1}, isRow = ${this.isRow}`)};this.lNf=qb=>{qb=new Sys.UI.DomEvent(qb);qb=m.a.create(x.a.Zja,this.domElement,qb,2);this.EKb(qb)};this.O7i=qb=>{this.GBa(qb,this.$i,!1)};this.cdb=qb=>{qb=Ea.a(this.grid.$).df(qb);E.g(qb.Da);return this.MJd(qb.clientPoint)};this.LJ=qb=>{if(this.grid.rk)return!1;qb=Ea.a(this.grid.$).df(qb);let Pa;if(!this.grid.isResizeAllowed(this.isRow)||-1!==this.grid.ga.selectionType)return V.a(this.grid.$).Zq()&&(Pa=this.vnd(qb))&&(Pa.Wya.style.cursor=""),!1;if(this.BZ)return this.dnf(),
!1;Pa=this.vnd(qb);if(!Pa)return!1;Pa.Wya.style.cursor=!this.grid.Ob&&this.GAd(Pa)?this.isRow?"row-resize":"col-resize":"";E.g(qb.Da);return!0};this.Ws=()=>{this.nOb()};this.Uf=()=>{if((3===F.a.fc||t.a.rq)&&this.grid.ga.pa.Vh){var qb=this.grid.ga.pa.Sd;if(!(!qb.isRow&&!qb.uh||!this.domElement||qb.isRow&&this.isRow&&!this.Se.Su.includes(qb.top)||qb.uh&&!this.isRow&&!this.Se.Su.includes(qb.left))){var Pa=this.grid.gh(qb,this.Se.jk.paneType);if(Pa){if(this.grid.rk){const Nb=this.isRow?qb.bottom:qb.right;
this.$i=this.Se.Ht(M.Range.xd(qb.bottom,qb.right));if(!this.$i){H.ULS.sendTraceTag(522826880,2,50,`HeaderResizeBehavior.onSelectionEnded: Cell being resized is undefined. Couldn't create touch resizer. Absolute index ${Nb}, is row ${this.isRow}`);return}}this.KH||this.Ish();qb.isRow&&this.isRow?(B.DOMElementExtensions.setVisible(this.KH,!0),this.KH.style.top=Pa.bottomRight.y-this.KH.offsetHeight/2+"px"):qb.isRow||this.isRow||(B.DOMElementExtensions.setVisible(this.KH,!0),R.c(this.KH.style,this.grid.rtl,
Pa.bottomRight.x-this.KH.offsetWidth/2+"px"))}}}};this.iH=(qb,Pa)=>{I.EwaSettings.isChangeGateEnabled("OfficeVSO:6385697_HeaderResize_LogOnPartialInteractivityStatusChanged")&&H.ULS.sendTraceTag(521787422,2,50,`HeaderResizeBehavior.onPartialInteractivityStatusChanged: was called. isActivated ${Pa.xN}`);Pa.xN&&this.Rub()};this.Se=zb;this.isRow=zb.isRow;this.rtl=zb.jk.rtl;this.grid=Da;this.LDf=this.isRow?e.a.nFd:e.a.qsc;this.$oi=K.a.instance.ha(436);this.jpi=K.a.instance.ha(435);this.dpi=K.a.instance.ha(437);
Z.a(this.grid.$,qb=>{this.ADd=qb.DR(G.a.YDj,!1)});this.Xtj();this.grid.ga.ND(this.Uf);this.grid.ga.yba(this.Ws);this.grid.ut(this.Uf);V.a(this.grid.$).Lg.xba(this.iH)}get jGb(){return this.BZ}get $Dj(){this.wEh();return ia.Cgb}GBa(Da,zb,qb){var Pa=new Sys.UI.DomEvent(Da);Pa=m.a.create(x.a.Zja,this.domElement,Pa,2);Pa=Ea.a(this.grid.$).df(Pa);this.wXf(zb,Pa.clientPoint.x,Pa.clientPoint.y,!1,qb,Da);Da=this.zFc();this.ald(this.$Da,Da,!0);this.cDa||(Da=this.domElement.ownerDocument.body,Da.addEventListener(x.a.Zja,
this.kNf),Da.addEventListener(x.a.eKa,this.lNf),this.cDa=!0)}M7i(Da,zb,qb){this.wXf(zb,Da.clientX,Da.clientY,!0,qb,Da);Da=this.grid;zb=this.Zod(Da);zb=L.r(zb,Da.$);Da.pc.Sk([this.isRow?13:14]);Da.pc.hWa();this.nOb();Da.$.Ed(this.isRow?146338636:1391094586,F.a.fc,30,{["autoFitRanges"]:zb})}dispose(){this.S8c();this.grid.ga&&(this.grid.ga.aD(this.Uf),this.grid.ga.mga(this.Ws));this.grid.$v(this.Uf);V.a(this.grid.$)&&V.a(this.grid.$).Lg.lga(this.iH);z.a.instance.Aa(x.a.nl,this.domElement,this.ofa);v.a.instance.Aa(x.a.Zg,
this.domElement.ownerDocument.body,this.EKb);w.a.instance.Aa(x.a.jf,this.domElement.ownerDocument.body,this.EKb);t.a.rq||(v.a.instance.Aa(x.a.pointerDown,this.domElement,this.iy),v.a.instance.Aa(x.a.dl,this.domElement,this.LJ));this.cDa&&(v.a.instance.Aa(x.a.dl,this.domElement.ownerDocument.body,this.cdb),w.a.instance.Aa(x.a.lh,this.domElement.ownerDocument.body,this.cdb),this.cDa=!1);this.KH&&(v.a.instance.Aa(x.a.pointerDown,this.KH,this.iy),z.a.instance.Aa(x.a.nl,this.KH,this.ofa),this.S8c(),this.KH=
null);this.h8f&&(B.DOMElementExtensions.tg(ia.Cgb),ia.Cgb=null);this.Se=null;super.dispose()}Xtj(){z.a.instance.ta(x.a.nl,this.domElement,this.ofa);v.a.instance.ta(x.a.Zg,this.domElement.ownerDocument.body,this.EKb);w.a.instance.ta(x.a.jf,this.domElement.ownerDocument.body,this.EKb);t.a.rq||(v.a.instance.ta(x.a.pointerDown,this.domElement,this.iy),v.a.instance.ta(x.a.dl,this.domElement,this.LJ))}wEh(){if(!ia.Cgb){document.getElementById(ia.g8f);this.h8f=!0;var Da=ia.Cgb=document.createElement("div");
this.grid.$.frame.Cda().appendChild(Da);Da.id=ia.g8f;Da.className=k.a.gKh;B.DOMElementExtensions.setVisible(Da,!1)}}DXe(){if(this.cDa){const Da=this.domElement.ownerDocument.body;this.grid.rk?(Da.removeEventListener(x.a.Zja,this.kNf),Da.removeEventListener(x.a.eKa,this.lNf)):(v.a.instance.Aa(x.a.dl,Da,this.cdb),w.a.instance.Aa(x.a.lh,Da,this.cdb));this.cDa=!1}this.BZ=!1;I.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")?this.d4f():(this.T8f(),this.dSd());P.c(this.grid.$,
!0,"HeaderResizeBehavior:PrepareResizeOperation")}T8f(){this.grid.pc.Sk([this.isRow?13:14]);this.grid.pc.hWa()}BTg(){this.Se.addRowColToModel(this.$i.hrb-1,this.$i.i3f);this.LVb=!0}MJd(Da){if(!this.BZ)return!1;const zb=this.isRow;if(!this.grid.rk&&!this.j3){this.j3=document.createElement("div");this.j3.style.cssText="position: relative; width: inherit; height: inherit;"+(zb?"top: 0px; ":this.rtl?"right: 0px:":"left: 0px:");for(var qb=this.$i.CG();qb.nextSibling;)this.j3.appendChild(qb.nextSibling);
qb.parentNode.appendChild(this.j3)}qb=zb?Da.y-this.ebb.y:(this.rtl?-1:1)*(Da.x-this.ebb.x);const Pa=zb?Da.y-this.$Da.y:(this.rtl?-1:1)*(Da.x-this.$Da.x),Nb=this.grid.rk?this.Pdb:this.$i.b7();if(Nb===e.a.tza)return!1;qb&&(0<this.em||0<Nb+Pa)&&Nb+Pa<=this.LDf&&(this.em=this.zFc(Pa),this.ald(Da,this.em,!1),this.grid.rk?this.em>=ia.Wjf?(this.hUd=!0,this.$i.setCellExtent(this.em)):this.hUd&&(this.hUd=!1,this.$i.setCellExtent(ia.Wjf)):(B.DOMElementExtensions.Kra(this.$i.CG(),!zb,Math.max(this.fQb+Pa,0)),
this.j3.style[zb?"top":this.rtl?"right":"left"]=Math.max(Pa,-this.fQb)+"px"),qb=(this.grid.rk?this.tUf:zb?this.$i.Se.PD:this.$i.Se.RD)+Math.max(Pa,this.grid.rk?-this.Pdb+ia.tjc:-this.fQb),B.DOMElementExtensions.Kra(this.$i.Se.domElement,!zb,qb),this.grid.rk&&this.$i.Se.eMj(qb),this.ebb=new Sys.UI.Point(Da.x,Da.y),B.DOMElementExtensions.setVisible(this.KH,!1));return!0}b7(){return this.$i?this.k4?ia.rpi:this.$i.b7():e.a.tza}ald(Da,zb,qb){this.rO&&qb&&(H.ULS.sendTraceTag(537154051,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement already created, creating a new element instead"),
this.dSd());this.rO||qb||H.ULS.sendTraceTag(537154050,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement is null, creating a new element instead");this.ADd&&this.ADd(()=>({["Location"]:"canvas"}));this.rO?this.t7e(zb):(this.rO=document.createElement("div"),this.rO.id=this.fpi,this.t7e(zb),this.rO.className=k.a.JIh,zb=document.getElementById(this.grid.$.qc+l.a.zFf),zb.insertBefore(this.rO,zb.firstChild),Da=Ea.a(this.grid.$).Fma(Da),this.rO.style.left=(this.rtl?Math.max(Da.x-
this.rO.offsetWidth,0):Da.x-Math.max(Da.x+this.rO.offsetWidth-zb.offsetWidth,0)).toString()+"px",zb=document.getElementById(l.a.kva),this.rO.style.top=(Da.y-(y.AFrameworkApplication.sa&&y.AFrameworkApplication.sa.Qa.$f?0:zb.offsetHeight)-this.rO.offsetHeight).toString()+"px")}dSd(){B.DOMElementExtensions.tg(this.rO);this.rO=null}t7e(Da){var zb=new ea(this.grid.$.workbookContext.DxDigitNormal);zb=this.isRow?zb.RNe(Da).toFixed(2):zb.GNe(Da).toFixed(2);this.rO.innerText=`${this.isRow?this.$oi:this.jpi} ${zb} (${Da.toString()} ${this.dpi})`}xXf(Da,
zb){let qb;const Pa=this.grid.isResizeAllowed(this.isRow);if(-1!==this.grid.ga.selectionType||2===Da.kc&&Da.Da.button!==Sys.UI.MouseButton.leftButton||!this.GAd(qb=this.vnd(Da))||!Pa)return!1;E.g(Da.Da);this.$Da=this.ebb=new Sys.UI.Point(Da.clientPoint.x,Da.clientPoint.y);this.B$g(qb,zb);if(!this.$i)return!1;this.BZ=!0;this.ZGi(this.$i,qb)&&this.mti();this.fQb=this.Bmd();return this.yXf(Da.Da.rawEvent,zb)}wXf(Da,zb,qb,Pa,Nb,Tb){this.BZ=!0;this.k4=Nb;this.$i=Da;this.Roc=!1;this.$Da=this.ebb=new Sys.UI.Point(zb,
qb);Da=this.$i.getRange();this.sT=Nb?this.Rze(Da):Da;this.Pdb=this.b7();this.tUf=this.isRow?this.$i.Se.PD:this.$i.Se.RD;this.yXf(Tb,Pa)}yXf(Da,zb){const qb=this.grid.rk?{["IsResizingHiddenHeader"]:this.k4,["IsAutoFitting"]:zb,["NumberOfSelectedRanges"]:this.grid.ga.pa.UE,["Location"]:"canvas",["ResizeRange"]:this.sT,["ResizedCellAbsoluteIndex"]:this.$i.hrb,["HeaderViewBlockHashCode"]:this.Se.hashCode}:{["IsResizingHiddenHeader"]:this.k4,["IsAutoFitting"]:zb,["NumberOfSelectedRanges"]:this.grid.ga.pa.UE,
["Location"]:"canvas"};Z.b(this.grid.$).Vd(G.a.PDj,qb);this.grid.IWj&&(zb=zb?"header_resize_autofit":"header_resize_start",aa.b(this.grid.$).HEa(Da,zb,void 0));this.offset=this.$i.Jda();this.em=this.grid.rk?this.Pdb:this.$i.b7();if(this.em===e.a.tza)return!1;P.c(this.grid.$,!1,"HeaderResizeBehavior:prepareResizeOperationInternal");return!0}ZGi(Da,zb){var qb=this.$i.CG();if(!qb)return H.ULS.shipAssertTag(537154049,2,!1,"cell being resized element received is null"),!1;qb=qb.nextSibling;if(!qb)return!1;
Da=Da.getRange();qb=this.Se.$xa(qb).getRange();if(!Da||!qb)return H.ULS.shipAssertTag(537154048,2,!1,"IsResizingHidden: range is null"),!1;Da=this.isRow?Da.bottom:Da.right;qb=this.isRow?qb.bottom:qb.right;return Da+1!==qb&&Da!==qb&&this.GAd(zb,!0)}mti(){var Da=this.$i.CG();const zb=this.Se.$xa(Da.nextSibling);ia.$Gi(zb,this.isRow)?(this.$i=zb,this.sT=this.$i.getRange()):(this.CTg(Da),this.$i=zb,Da=this.$i.getRange(),this.sT=this.Rze(Da),this.k4=!0)}Rze(Da){return this.isRow?new M.Range(Da.top-1,Da.left,
Da.top-1,Da.right,!1,!0):new M.Range(Da.top,Da.left-1,Da.bottom,Da.left-1,!1,!0)}CTg(Da){const zb=this.Se.$xa(Da.nextSibling),qb=ia.Moh(zb,this.isRow,this.rtl);qb&&Da.parentNode.insertBefore(qb,zb.CG())}Zod(Da){const zb=this.sT,qb=Da.ga.pa.selectedRanges;if(Da.ga.pa.Uxb(zb))if(this.isRow){if(D.a.all(qb,Pa=>Pa.isRow))return qb}else if(D.a.all(qb,Pa=>Pa.uh))return qb;return[zb]}getCellExtent(){return this.$i.getCellExtent()}Bmd(){const Da=this.$i.CG().style;return Math.max(0,Math.min(this.LDf,0|parseInt(this.isRow?
Da.height:Da.width,10)))}zFc(Da=0){const zb=this.grid;var qb=this.Se.jk.paneType;let Pa;Pa=this.isRow?3===qb?[3,2]:[1,4]:4===qb?[2,4]:[1,3];var Nb=Math.max(this.grid.rk?this.Pdb:this.$i.b7(),0);Da=this.k4&&!this.grid.rk?Math.max(this.Bmd(),0):Math.max(Nb+Da,0);qb=zb.T9h(qb,this.isRow);qb=this.isRow?new h.a(0,this.offset,qb,Da):new h.a(this.offset,0,Da,qb);Nb=[this.isRow?13:14];zb.pc.rl(new M.Range(1,1,e.a.Sg,e.a.Rg,!1,!0),Nb,!1);zb.pc.fs(Nb,qb,Pa);return Da}S8c(){this.sT=this.$Da=this.ebb=null;if(this.j3){const Da=
this.j3.parentNode;if(Da)for(Da.removeChild(this.j3);this.j3.firstChild;)Da.appendChild(this.j3.firstChild);this.j3=null}this.$i=null;this.BZ=!1;I.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")||this.d4f()}d4f(){this.Roc=!1;this.dSd();B.DOMElementExtensions.setVisible(ia.Cgb,!1);B.DOMElementExtensions.setVisible(this.KH,!1);I.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")&&this.T8f()}vnd(Da){if(B.DOMElementExtensions.JA(Da.Fc,"a"))return null;
const zb=this.Jvf(Da.Da);if(zb&&this.grid.ga.pa.Vh){var qb=this.grid.ga.pa.Sd;qb=this.Se.Ht(M.Range.xd(qb.bottom,qb.right))}else qb=this.Se.$xa(Da.Fc);if(!qb)return null;const Pa=qb.CG(),Nb=new Sys.UI.Bounds(Pa.offsetLeft,Pa.offsetTop,Pa.offsetWidth,Pa.offsetHeight);var Tb=B.DOMElementExtensions.getBoundingClientRect(Da.Fc);Tb=new Sys.UI.Point(Da.clientPoint.x-Tb.x,Da.clientPoint.y-Tb.y);this.isRow&&!zb&&(Tb.y+=J.HelperMethods.yE(Da.Fc,Pa,this.rtl).y);return new oa(Pa,Tb,Nb,qb.getRange(),Math.max(ia.wWi,
Math.min(ia.wVi,(this.isRow?Nb.height:Nb.width)*ia.ZDj)),zb,!this.isRow&&0<Pa.getElementsByTagName("input").length)}GAd(Da,zb=!1){if(!Da||this.grid.Ob)return!1;if(Da.Ivf)return!0;var qb=Da.iSa;const Pa=Da.Bgb;var Nb=this.Se.jk.paneType,Tb=this.grid.sg(Nb).sk,Vb=!!Tb&&Tb.top===Da.esd.top,Jb=!!Tb&&Tb.left===Da.esd.left;Nb=!!Tb&&Tb.bottom===Da.esd.bottom&&(3===Nb||2===Nb);this.isRow?(Jb=Da.kJb.y,Da=Jb<=Pa&&!Vb,qb=Jb>=qb.height-Pa-(Nb?ia.SWh:0),zb=zb?Da:qb||Da):(Nb=Da.Zni,Vb=this.rtl,Tb=Da.kJb.x,Da=Tb<=
Pa&&(!Jb||Vb)&&(!Nb||!Vb),qb=Tb>=qb.width-Pa&&(!Vb||!Jb)&&(!Nb||Vb),zb=zb?Vb?qb:Da:Da||qb);return zb}B$g(Da,zb){const qb=this.isRow;if(Da.Ivf)this.$i=this.Se.$xa(Da.Wya);else if(qb&&Da.kJb.y<=Da.Bgb&&Da.iSa.height>Da.Bgb||!qb&&Da.iSa.width>Da.Bgb&&(!this.rtl&&Da.kJb.x<=Da.Bgb||this.rtl&&Da.kJb.x>=Da.iSa.width-Da.Bgb)){if(this.$i=Da.Wya.previousSibling?this.Se.$xa(Da.Wya.previousSibling):this.g9h(),zb&&Da.Wya.classList.contains(qb?k.a.U1e:k.a.T1e)&&(Da=this.Se.$xa(Da.Wya)))Da=Da.getRange(),this.sT=
qb?new M.Range(Da.top-1,Da.left,Da.top-1,Da.right,!1,!0):new M.Range(Da.top,Da.left-1,Da.bottom,Da.left-1,!1,!0)}else this.$i=this.Se.$xa(Da.Wya);!this.sT&&this.$i&&(this.sT=this.$i.getRange())}g9h(){var Da=this.isRow?1:0;return(Da=this.Se.jk.pD(this.Se.jk.Ca.Th(this.grid.$.na,d.a.mL(this.Se.position.X+Da-1,this.Se.position.Y-Da,this.Se.position.PaneType))))?Da.f9h():null}dnf(){this.Roc=!0;const Da=this.$Dj;B.DOMElementExtensions.setVisible(Da,!0);Da.style.cursor=this.isRow?k.a.n_e:k.a.dZe;this.zFc()}NDh(Da){this.grid.$.Ed(this.isRow?
745189930:-445963340,F.a.fc,30,{["resizeRowColumnParameters"]:Da})}Ish(){const Da=document.createElement("div");Da.className=k.a.fLh;const zb=document.createElement("div");zb.className=f.a.aE;Da.appendChild(zb);const qb=document.createElement("img");qb.src=O.a.yg(0);qb.className=this.isRow?f.a.dKh:f.a.ZJh;zb.appendChild(qb);this.Se.Sy.domElement.parentNode.insertBefore(Da,this.Se.Sy.domElement);this.grid.rk?Da.addEventListener(x.a.Yba,this.O7i):(v.a.instance.ta(x.a.pointerDown,Da,this.iy),z.a.instance.ta(x.a.nl,
Da,this.ofa));B.DOMElementExtensions.setVisible(Da,!1);this.KH=Da}nOb(){this.S8c();this.KH&&(this.Se.Sy.domElement.parentNode.removeChild(this.KH),this.KH=null)}Jvf(Da){return B.DOMElementExtensions.zg(this.KH,Da.target)}Rub(){this.BZ&&(I.EwaSettings.isChangeGateEnabled("OfficeVSO:6810003_HandleCancelResize")&&this.grid.rk&&this.MJd(this.$Da),this.DXe(),this.grid.rk||B.DOMElementExtensions.Kra(this.$i.CG(),!this.isRow,this.fQb),this.nOb(),this.LVb=this.k4=!1)}yrf(){return I.EwaSettings.ya(587)}Tlf(Da){(Da=
Da.Da.rawEvent)&&Da.detail===ia.KIj&&(Da.type===x.a.vq?(this.BZ=!1,this.x5c=!0):Da.type===x.a.GJ&&(this.BZ=!0,this.x5c=!1))}static Joh(Da,zb){return new ia(Da,zb)}static JYd(Da,zb,qb){if(zb){Da.ColumnWidth=-1;Da.RowHeight=qb;for(const Pa of Da.SheetMultiRange.Ranges)Pa.FirstColumn=0,Pa.LastColumn=0}else{Da.RowHeight=-1;Da.ColumnWidth=qb;for(const Pa of Da.SheetMultiRange.Ranges)Pa.FirstRow=0,Pa.LastRow=0}}static $Gi(Da,zb){if(!Da||!Da.CG())return H.ULS.shipAssertTag(537154014,2,!1,"header after hidden headers is null"),
!1;const qb=Da.getRange();Da=Da.CG().style;if(!qb||!Da)return H.ULS.shipAssertTag(537154013,2,!1,"header range or style is null"),!1;Da=zb?Da.height:Da.width;return(zb?qb.top:qb.left)===(zb?e.a.Sg:e.a.Rg)&&Da===ia.gyg}static Moh(Da,zb,qb){if(!Da)return H.ULS.shipAssertTag(537154012,2,!1,"header after hidden is null"),null;var Pa=Da.CG();if(!Pa||!Pa.style)return H.ULS.shipAssertTag(537154011,2,!1,"header after hidden element or style is null"),null;Da=document.createElement("div");const Nb=Pa.style;
Da.style.top=zb?Nb.top:ia.gyg;zb||(qb?Da.style.right=Nb.right:Da.style.left=Nb.left);Da.classList.add(zb?u.fKh:u.eKh);Da.classList.add(zb?k.a.Vyb:k.a.Uyb);qb=document.createElement("div");qb.classList.add(zb?k.a.J1e:k.a.yhd);Pa=zb?Number.parseInvariant(Pa.innerText):M.Range.g4a(Pa.innerText);qb.innerText=zb?(Pa-1).toString():M.Range.xR(Pa-1);Da.appendChild(qb);return Da}}ia.wWi=0;ia.wVi=5;ia.tjc=1;ia.Wjf=1;ia.rpi=0;ia.SWh=3;ia.ZDj=.1;ia.g8f="ewa-rszrbg";ia.gyg="0px";ia.KIj=2;ia.Cgb=null;Object(r.a)(ia,
"HeaderResizeBehavior",S.a,[383]);class ya extends b.a{constructor(){super();this.uc()}create(){this.$b(ia.Joh)}static la(Da){Da.da.Ja(136,new ya)}}Object(r.a)(ya,"HeaderResizeBehaviorFactory",b.a,[]);var za=a(63),la=a(724),xa=a(52),wa=a(40),hb=a(173),Ja=a(431),Fa=a(382),Ba=a(201),fa=a(150),ta=a(231),Oa=a(248),Ma=a(67),fb=a(19);class pa{constructor(Da,zb){this.isRow=!1;this.autoFitRange=null;this.isRow=Da;this.autoFitRange=zb}}Object(r.a)(pa,"MacroRecorderSheetRowsColumnsAutoFitPayload",null,[144]);
class Ua{constructor(Da){this.resizeParameters=null;this.resizeParameters=Da}}Object(r.a)(Ua,"MacroRecorderSheetRowsColumnsResizedPayload",null,[144]);var Sa=a(126);b=a(294);var Ia=a(23),X=a(61);class ca extends b.a{constructor(Da,zb){super(Da);this.XNa=qb=>{qb=this.Mnd(qb);return this.Tkd(qb)};this.QDj=(qb,Pa)=>{var Nb=this.Aab=Pa[ca.jBi];1===qb?(qb=Pa[ca.p_j],Nb=this.dgf(qb,Nb),H.ULS.shipAssertTag(537153996,0,Nb!==ca.hea,`ResizeHeadersDialogHandler - invalid size input, size = ${qb}`),qb=Nb!==this.kud,
H.ULS.sendTraceTag(537153995,0,50,"ResizeHeadersDialog OK button pressed, isRow = {0}, isDefaultUnits = {1}, inputPx = {2}, inputChanged = {3}.",this.isRow,this.Aab,Nb,qb),qb&&this.mmh(Nb)):H.ULS.sendTraceTag(537153994,0,50,`ResizeHeadersDialog Cancel button pressed, isRow = ${this.isRow}.`)};this.isRow=2040891415===zb.command;this.gridView=fb.h(this.$);this.jBc=new ea(this.$.workbookContext.DxDigitNormal);this.kud=this.eah();Da=this.Skh(this.kud);zb=this.Ukh(this.kud);this.Bl=K.a.instance.ha(this.isRow?
478:479);Da=this.bJ(Da,zb);this.initializeAndShow(this.Bl,this.QDj,Da);H.ULS.sendTraceTag(537153997,0,50,`ResizeHeaders React Dialog opened, isRow = ${this.isRow}.`)}get dd(){return"ResizeHeadersDialog"}get Aab(){return ca.Aje}set Aab(Da){ca.Aje=Da}bJ(Da,zb){return{[ca.tO]:this.dd,[ca.oHi]:this.isRow,[ca.Kti]:Da,[ca.Jti]:zb,[ca.PDi]:this.Aab,[ca.Lnd]:this.XNa}}eah(){const Da=this.j_h();try{return this.P3h(Da)}finally{Da&&Da.dispose()}}mmh(Da){const zb={};zb.SheetMultiRange=L.r(this.gridView.ga.pa.selectedRanges,
this.$);ca.JYd(zb,this.isRow,Da);this.$.Ed(this.isRow?745189930:-445963340,F.a.fc,8,{["resizeRowColumnParameters"]:zb})}dgf(Da,zb){return Ia.a.V7(Da)?zb?this.Rkh(Da):this.Tkh(Da):ca.hea}Tkh(Da){return Math.floor(parseFloat(Da))}Rkh(Da){Da=parseFloat(Da);return 0>Da?ca.hea:Da?this.isRow?J.HelperMethods.njj(Da):this.jBc.Egh(Da):0}Ukh(Da){return Da===ca.hea?"":this.isRow?this.jBc.RNe(Da).toString():this.jBc.GNe(Da).toFixed(2)}Skh(Da){return Da===ca.hea?"":Da.toString()}P3h(Da){if(!Da||!Da.$$mn()||!Da.Qm)return ca.hea;
var zb=Object(Sa.a)(268,Da.Qm);if(!zb)return ca.hea;for(zb=this.isRow?zb.ODb:zb.iud;Da.$$mn();){const qb=Object(Sa.a)(268,Da.Qm);if(qb&&(this.isRow?qb.ODb:qb.iud)!==zb)return ca.hea}return zb}j_h(){const Da=[];for(const qb of this.gridView.ga.pa.selectedRanges){const Pa=qb.clone();var zb=this.gridView.sg(this.gridView.Mb.Di(Pa));zb=Pa.ff(zb.sk);if(!zb)return null;this.isRow?Pa.right=Pa.left=zb.left:Pa.top=Pa.bottom=zb.top;Da.push(Pa)}return Da.length?this.gridView.Z5("ResizeHeadersDialog.GetActiveRowColumnLoadedRangeEnumerator",
Da):null}Mnd(Da){if(!Ia.a.V7(Da))return 1;Da=this.dgf(Da,this.Aab);if(0===Da)if(I.EwaSettings.isChangeGateEnabled("OfficeVSO:7428186_HideLastRowCol")){const zb=this.gridView.ga.pa.selectedRanges,qb=this.gridView.Xj("ResizeHeaderDialog");if(Object(X.c)(qb)){if(!qb.value.rHe(zb,this.isRow))return 3}else if(this.duf())return 3}else if(this.duf())return 3;return this.lKi(Da)?0:2}duf(){const Da=this.gridView.ga.pa.selectedRanges;return this.isRow&&L.Q(Da)||!this.isRow&&L.P(Da)}Tkd(Da){let zb="";switch(Da){case 0:zb=
"";break;case 1:zb=K.a.instance.ha(767);break;case 2:zb=String.format(K.a.instance.Xb(99),0,this.dic(this.Aab));break;case 3:zb=K.a.instance.ha(768)}return zb}lKi(Da){return 0<=Da&&Da<=this.dic(!1)}dic(Da){return this.jBc.dic(Da,this.isRow)}static JYd(Da,zb,qb){if(zb){Da.ColumnWidth=ca.hea;Da.RowHeight=qb;for(const Pa of Da.SheetMultiRange.Ranges)Pa.FirstColumn=0,Pa.LastColumn=0}else{Da.RowHeight=ca.hea;Da.ColumnWidth=qb;for(const Pa of Da.SheetMultiRange.Ranges)Pa.FirstRow=0,Pa.LastRow=0}}}ca.tO=
"id";ca.oHi="isRow";ca.Kti="initialSizeInPx";ca.Jti="initialSizeInDefaultUnits";ca.PDi="isInitialUnitsDefaultUnits";ca.Lnd="getInputErrorIfInvalid";ca.p_j="size";ca.jBi="isDefaultUnits";ca.hea=-1;ca.Aje=!0;Object(r.a)(ca,"ResizeHeadersDialog",b.a,[]);var U=a(59);const ma=(Da,zb,qb,Pa,Nb,Tb,Vb=null)=>{Vb=Da.Pa(41,Vb);Vb.resizeRowColumnParameters=zb;return U.g(Da,"ResizeRowsColumns",Vb,qb,Pa,Nb,Tb,0)};var ra=a(296),Va=a(151),ob=a(34),ja=a(356);class lb{constructor(Da,zb,qb){this.Raj=(Pa,Nb)=>{if(!ta.a(Pa)&&
Nb){const Tb=!!Pa&&!!Pa.RequestTelemetryData;fb.h(this.$).Mh.yoa(Nb,Pa.StateId,Tb?Pa.RequestTelemetryData.EcsOperationDuration:0,Tb?Pa.RequestTelemetryData.EcsRequestDuration:0,Tb?Pa.RequestTelemetryData.WfeRequestDuration:0)}};this.X2i=(Pa,Nb)=>{wa.TaskExtensions.za(xa.GetServiceTaskFactory.Za(this.$.da,534,535,1),Tb=>{Tb.result.q$j(Nb)},this.$.ka,3)};this.$=Da;this.pg=zb;this.gridInstantaneousAction=qb;this.grid=fb.h(this.$)}yd(Da,zb){Da=!0;switch(zb){case -445963340:case 1391094586:Da=this.He(8);
break;case 745189930:case 146338636:Da=this.He(16)}return!Da}executeCommand(Da,zb,qb){var Pa=fb.h(this.$);const Nb=zb.command;var Tb=hb.a.create().toString();let Vb=wa.TaskExtensions.Ik();switch(Nb){case 1391094586:case 146338636:Da=1391094586===Nb;(Tb=qb.autoFitRanges)&&Tb.Ranges&&Tb.Ranges.length||(Tb=L.r(Pa.ga.pa.selectedRanges,this.$));Vb=this.Hzh(Da?1:0,Tb,zb);break;case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:Da=-445963340===Nb||-706918724===
Nb||369708605===Nb;I.EwaSettings.ZPa()&&-706918724===Nb&&Pa.Mh.e3(18,Tb,Ja.a(Nb));if(-445963340===Nb||745189930===Nb){var Jb=Ja.a(zb.command);Pa.Mh.e3(16,Tb,Jb);Pa=qb.resizeRowColumnParameters}else{qb=Pa.ga.pa.selectedRanges;let Db=0;for(var Qa of qb)if(-706918724===Nb||369708605===Nb){const sa=Qa.right-Qa.left+1;Db+=0<sa?sa:-1*sa}else if(1542466017===Nb||1051390410===Nb)Db+=Qa.bottom-Qa.top+1;369708605===Nb||1542466017===Nb?H.ULS.sendTraceTag(520938758,0,50,`ResizeCommandHandler.doResize: Unhide Rows/Columns NumberOfRanges=${Db}`):
(-706918724===Nb||1051390410===Nb)&&H.ULS.sendTraceTag(520938757,0,50,`ResizeCommandHandler.doResize: hide Rows/Columns NumberOfRanges=${Db}`);if(!I.EwaSettings.isChangeGateEnabled("OfficeVSO:7428186_HideLastRowCol")||!Object(X.c)(Pa.Xj("ResizeCmdHandler"))){if(-706918724===Nb&&6===zb.Jf&&L.P(qb)){H.ULS.sendTraceTag(537154007,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideColumn' was ignored because entire row is selected");break}if(1051390410===Nb&&6===zb.Jf&&L.Q(qb)){H.ULS.sendTraceTag(537154006,
0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideRow' was ignored because entire column is selected");break}}Qa=369708605===Nb||1542466017===Nb?-2:0;Pa={};Pa.SheetMultiRange=L.r(qb,this.$);if(Da)for(Jb of Pa.SheetMultiRange.Ranges)Jb.FirstRow=0,Jb.LastRow=0;else for(const sa of Pa.SheetMultiRange.Ranges)sa.FirstColumn=0,sa.LastColumn=0;Pa.RowHeight=Da?-1:Qa;Pa.ColumnWidth=Da?Qa:-1}Vb=this.bAh(Pa,zb,Tb,Da);break;case 957527587:case 2040891415:new ca(this.$,zb)}return Vb}fd(Da,zb,qb,Pa){if(Da=
!!qb&&!!Pa&&1===Pa.Yy)switch(zb.command){case 1391094586:case 146338636:case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:case 957527587:case 2040891415:break;default:Da=!1}return Da}Cd(){return!1}NQi(Da){H.ULS.sendTraceTag(537154004,0,50,`ResizeCommandHandler.LogInstantaneousResize: Resize operation succeeded: ${Object(ra.c)(Da)}. Reason: ${Object(ra.c)(Da)?void 0:Da.reason}.`)}He(Da){return(new fa.a(this.$.ua)).He(Da)}Hzh(Da,zb,qb){const Pa=this.$.qa.va.Lc(),
Nb=0===Da,Tb=()=>new pa(Nb,zb);return Fa.a(this.$.userOperationManager,(Vb,Jb,Qa)=>{var Db=this.$.qa.va;Vb=Oa.b(Vb,this.X2i);var sa={uAi:!Nb,u5c:zb};const Ha=Db.Pa(41,Pa);Ha.isRow=Nb;Ha.autoFitRanges=zb;return U.g(Db,"AutoFit",Ha,Vb,Jb,Qa,sa,0)},Vb=>new Ba.a(135,0,Vb,void 0,Tb),qb,I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MoveTaskCompletionToQueueItemLevelByOptingIn",!1))}bAh(Da,zb,qb,Pa){const Nb=zb.command,Tb=fb.h(this.$),Vb=L.g(Da.SheetMultiRange.Ranges);if(I.EwaSettings.isChangeGateEnabled("OfficeVSO:7428186_HideLastRowCol")){var Jb=
1051390410===Nb||745189930===Nb&&0===Da.RowHeight;const Ha=-706918724===Nb||-445963340===Nb&&0===Da.ColumnWidth,mb=Tb.Xj("ResizeCmdHandler");if((Jb||Ha)&&Object(X.c)(mb)&&!mb.value.rHe(Vb,!Pa))return this.Ryh(Pa),wa.TaskExtensions.Ik()}let Qa;Jb=I.EwaSettings.ZPa()&&-706918724===Nb;if(745189930===Nb||-445963340===Nb||Jb)H.ULS.shipAssertTag(537154002,0,this.$.activeItemName===Da.SheetMultiRange.SheetName,"ResizeCommandHandler.DoResize: should do CSE for active sheet only!"),Jb?(this.gridInstantaneousAction.Esj(),
Object(Va.c)(()=>{Tb.Mh.QIb();this.gridInstantaneousAction.e4g(Nb)},this.$.ka,0)):(Qa=this.pg.A0d(Tb,Vb,Pa?Da.ColumnWidth:Da.RowHeight,!Pa),this.NQi(Qa),Object(ra.c)(Qa)&&Tb.Mh.$P(qb,Ma.BasicTelemetryCalculator.xO));const Db=this.$.qa.va.Lc({xoa:!0,pna:3});Pa=(Ha,mb,qa)=>{this.$.Sz();L.i(Vb,",",this.$,!1);return ma(this.$.qa.va,Da,Oa.b(Ha,this.Raj),mb,qa,qb,Db)};const sa=()=>new Ua(Da);return Qa&&Object(ra.c)(Qa)?Fa.a(this.$.userOperationManager,Pa,Ha=>new Ba.a(136,0,Ha,64,sa),zb):Fa.a(this.$.userOperationManager,
Pa,Ha=>new Ba.a(136,0,Ha,void 0,sa),zb)}Ryh(Da){Da=ob.a.Wd(1,0,Da?769:771,Da?770:772,0,Da?-2037763134:503471870,Da?"HideAllColumnsError":"HideAllRowsError");new ja.a(this.$,Da)}}Object(r.a)(lb,"ResizeCommandHandler",null,[210]);var wb=a(100),Ab=a(149),nb=a(35);class pb extends la.a{constructor(Da){super(Da)}ue(){let Da;Da=I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatCellsActionNewService",!1)?Object(wb.d)(Ab.a.resolve(nb.L,{Wa:this.La})):xa.GetServiceTaskFactory.create(this.$.da,
18,this.ka,this.La);let zb;zb=I.EwaSettings.ZPa()?xa.GetServiceTaskFactory.Za(this.$.da,528,529,this.La):za.Task.Ua(null);wa.TaskExtensions.za(Da,()=>{this.Zd([new lb(this.$,Da.result,zb.result)])},this.ka,3)}static la(Da){la.a.Ie(113,new pb(Da))}}Object(r.a)(pb,"ResizeCommandHandlerFactory",la.a,[]);a.d(C,"a",function(){return cb});const cb=()=>{c.a.Fa(Da=>{ya.la(Da);pb.la(Da)})}},1321:function(r,C,a){function c(M){const O=f(M);let B=[];if(0===O&&1===M.length)return B.push({destination:M[0],source:null,
Aoc:!1}),B;for(let E=0;E<=O;E++){const I=M.filter(S=>S.ima().topLeft.Y===E);for(let S=0;S+1<I.length;S+=1)B.push({destination:I[S],source:I[S+1],Aoc:!1})}x.ULS.sendTraceTag(509658E3,0,50,`GridInstantaneousAction.getBlockPairsInViewport parameter = blockPairsLength, value=${B.length}`);return B}function b(M,O){let B;const E=u.HelperMethods.aT(()=>{B=gridRenderer.CanvasRendererGlobals.hideRowCols(M,O,!1)});d("HideRowCols",E);return B}function e(M,O,B,E){M=gridRenderer.CanvasRendererGlobals.performModelCascade(M,
O,B,E);M.metric&&d("ModelCascade",M.metric.ipk);return M}function f(M){let O=-1;for(let B=0;B<M.length;B++){const E=M[B].ima().topLeft.Y;E>O&&(O=E)}return O}function d(M,O){x.ULS.sendTraceTag(509723719,0,50,`GridInstantaneousAction: Time taken to complete operation=${M} is time=${O}`)}var h=a(10);r=a(0);var l=a(230),k=a(19),u=a(12),v=a(173),x=a(15),w=a(1),m=a(61),t=a(50),z=a(16),y=a(92);let D=null;class H{constructor(M){this.Kj=()=>{D&&(y.a.Ka(D),D=null)};this.$=M;this.gridView=k.h(this.$);this.Ca=
this.gridView.Ca;this.$Fb=!1;this.gcd=this.$.ea.gf;this.sPb={};this.w7={};this.Ca.Aw(this.Kj)}dispose(){this.gridView=this.$=null;this.w7={};this.$Fb=!1;this.sPb={};this.Ca.gx(this.Kj)}e4g(M){if(this.$Fb)x.ULS.sendTraceTag(509658009,0,15,`GridInstantaneousAction.attemptInstantaneousGridAction command=${M}, parameter = isProcessing, value=true, reason = AttemptInstantaneousGridAction is still processing, isRow=false`),this.gridView.Mh.QIb(!1);else{var O=this.Ca.S0h(),B=c(O);this.w7={};this.WDi(M,O,
B)?(this.$Fb=!0,this.SYf(M,!1,B,O)):this.gridView.Mh.QIb(!1)}}Esj(){this.gcd=this.$.ea.gf}WDi(M,O,B){var E=this.gridView;if(-706918724!==M||E.rtl)return!1;if(E.Mb.VW)return x.ULS.sendTraceTag(508958784,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${M}, parameter = hasPanes, value=true, isRow=false`),!1;var I=E.Xj("GridInstantaneousAction");if(!Object(m.c)(I))return x.ULS.sendTraceTag(509658008,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${M}, parameter = ActiveSheetProcessedData, value=null, isRow=false`),
!1;E=E.ga.pa.selectedRanges;var S=E[0];const J=E.length;if(1<J)return x.ULS.sendTraceTag(509658007,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${M}, parameter = SelectedRanges, value=${J}, reason = Discontinuous selection, isRow=false`),!1;if(I.value.UFb(S))return x.ULS.sendTraceTag(509658006,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${M}, parameter = isPartOfRangeHidden, value=true, isRow=false`),!1;I=S.right-S.left+1;if(I>w.EwaSettings.OUi())return x.ULS.sendTraceTag(509658005,
0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${M}, parameter = ColumnCount, value=${I}, reason = Multiple columns selected, isRow=false`),!1;O=O.length;if(O>w.EwaSettings.NUi())return x.ULS.sendTraceTag(509658004,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${M}, parameter = BlocksInViewport, value=${O}, reason = Blocks in viewport limit exceeded, isRow=false`),!1;a:{for(K of B){if(!K||!K.source||!K.destination){x.ULS.sendTraceTag(509649925,0,
50,"GridInstantaneousAction.canRowColHideOrCascade: blockPair or sourceBlock or destinationBlock is null");var K=!1;break a}O=K.source.Ne.GridBlockModel;if(!gridRenderer.CanvasRendererGlobals.canRowColHideOrCascade(O,O.ColumnNumbers[0],!1)){K=!1;break a}}K=!0}if(!K)return x.ULS.sendTraceTag(509658003,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${M}, parameter = canRowColCascade, value=false, reason = Model has complex cells, isRow=false`),!1;a:{K=S.left;S=this.Ca.DNa(S,
this.$.activeItemName);for(R of S)if(!gridRenderer.CanvasRendererGlobals.canRowColHideOrCascade(R.Ne.GridBlockModel,K,!1)){var R=!1;break a}R=!0}if(!R)return x.ULS.sendTraceTag(509084812,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${M}, parameter = canRowColHideOrCascade, value=false, reason = Selected row or Col has complex cells, isRow=false`),!1;E=E[0];R=0;for(let Z of B)if(Z.destination.mf.Yd(E)||Z.destination.mf.left>E.right)R+=1;B=R;if(B>w.EwaSettings.RUi())return x.ULS.sendTraceTag(509658002,
0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${M}, parameter = TransitionCount, value=${B}, reason = Transition count limit exceeded, isRow=false`),!1;x.ULS.sendTraceTag(509658001,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${M}, parameter = isInstantaneousGridActionPossible, value=true, reason = isInstantaneousGridActionPossible successful, isRow=false`);return!0}SYf(M,O,B,E){try{const I=u.HelperMethods.wc(),S=w.EwaSettings.QUi();let J=B.filter(K=>
!K.Aoc);for(let K of J){if(this.Iue("WebServiceResponseReceivedInProcessGridAction",E,M))return;const R=this.gridView.ga.pa.selectedRanges[0],Z=K.destination.mf.right;if(Z<R.left){K.Aoc=!0;x.ULS.sendTraceTag(509657999,0,50,`GridInstantaneousAction.processGridAction command=${M}, parameter = BlockRangeLessThanSelectedRange, selectedRangeLeftValue=${R.left}, blockRangeRightMostValue=${Z}, hashCode=${K.destination.Xd}, isRow=false`);continue}const P=O?R.topLeft.top:R.topLeft.left,V=this.F8e("SourceModel",
K.source),Ea=this.F8e("DestinationModel",K.destination),oa=K.destination.Xd;if(K.destination.mf.Yd(R)){if(!b(Ea,P)){this.Eua();x.ULS.sendTraceTag(509657998,0,15,`GridInstantaneousAction.processGridAction command=${M}, parameter = isHideColumnSuccessful, value=false, reason = "HideRowColOperation was failure", hashCode=${oa}, isRow=${O}, rowColNumber=${P}`);return}x.ULS.sendTraceTag(509657997,0,50,`GridInstantaneousAction.processGridAction command=${M}, parameter = isHideColumnSuccessful, value=true, reason = "HideRowColOperation was successful", hashCode=${oa}, isRow=${O}, rowColNumber=${P}`)}const ea=
V.ColumnNumbers[0],aa=K.source.Xd;if(e(V,Ea,ea,O).isSuccess)K.Aoc=!0,x.ULS.sendTraceTag(509657996,0,50,`GridInstantaneousAction.processGridAction command=${M}, parameter = cascadeResult.isSuccess, value=true, reason = "CascadeResult was successful", hashCode=${aa}, isRow=${O}, rowColNumber=${ea}`);else{this.Eua();x.ULS.sendTraceTag(509657995,0,15,`GridInstantaneousAction.processGridAction command=${M}, parameter = cascadeResult.isSuccess, value=false, reason = "CascadeResult was failure", hashCode=${aa}, isRow=${O}, rowColNumber=${ea}`);
return}this.l3j(Ea,V,K);if(u.HelperMethods.wc()-I>S){this.THj(M,O,J,E);return}}this.Chh(O,M,E);d("ProcessGridAction",u.HelperMethods.wc()-I)}catch(I){this.Ali(I)}}Chh(M,O,B){if(!this.Iue("CommitGridInstantaneousActionResults",B,O)){var E=u.HelperMethods.wc();if(this.w7&&0!==Object.keys(this.w7).length)if(this.Djj(B),this.DBg(O,B)){var I=v.a.create().toString(),S=this.gridView.Xj("GridInstantaneousAction");Object(m.c)(S)?(S.value.z7d(this.gridView.ga.pa.selectedRanges,0,M),O=Object.keys(this.w7),this.Ca.ZZf(O,
I,M?"row":"column",!0),this.$Fb=!1,D=t.a(this.$).Lg.SIa(6,"GridInstantaneousAction.commitGridInstantaneousActionResults",void 0,z.a.instance.ha(2188)),d("CommitGridInstantaneousActionResults",u.HelperMethods.wc()-E)):(this.v8f(B),this.Eua(),x.ULS.sendTraceTag(509645768,0,50,`GridInstantaneousAction.commitGridInstantaneousActionResults command=${O}, parameter = ActiveSheetProcessedData, value=null, isRow=${M}`))}else this.v8f(B),this.Eua();else this.Eua(),x.ULS.sendTraceTag(509657994,0,50,`GridInstantaneousAction.commitGridInstantaneousActionResults command=${O}, parameter = interimModels, value=false, reason = "InterimModels was null", isRow=${M}`)}}F8e(M,
O){let B=this.w7[O.Xd];if(!B){const E=u.HelperMethods.aT(()=>{B=O.B2h()});d(M,E)}return B}Djj(M){for(let O of M)M=O.Xd,this.sPb[M]||(this.sPb[M]=O.Tdf())}v8f(M){for(let O of M){M=O.Xd;const B=this.sPb[M];if(B&&!O.s6f(B)){x.ULS.sendTraceTag(509653846,0,15,`GridInstantaneousAction.restoreBlockModels parameter = isModelRestored, value=false, hashCode=${M}`);this.Eua();break}}}DBg(M,O){for(let B of O)if(O=B.Xd,this.w7[O]&&!B.s6f(this.w7[O]))return x.ULS.sendTraceTag(509657993,0,15,`GridInstantaneousAction.UpdateModelsInBlockCacheSuccessful command=${M}, parameter = isModelUpdated, value=false, reason = "Response Model not updated", hashCode=${O}, isRow=false`),
!1;return!0}THj(M,O,B,E){window.setTimeout(()=>{this.SYf(M,O,B,E)},0)}OJi(M){for(let O of M)if(O.Ne.Information.Revision>this.gcd)return!0;return!1}Iue(M,O,B){return this.OJi(O)?(this.gcd=this.$.ea.gf,this.Eua(),x.ULS.sendTraceTag(509657992,0,50,`GridInstantaneousAction.abortIfServerResponseReceived command=${B}, parameter = ${M}, value=true, reason = "Server response received before completing client side estimation", isRow=false`),!0):!1}Eua(){this.w7={};this.$Fb=!1;this.sPb={};this.gridView.Mh.QIb(!1)}Ali(M){this.Eua();
x.ULS.sendTraceTag(509723721,0,10,`${"GridInstantaneousAction.ProcessGridAction"} encountered exception ${M}.`)}l3j(M,O,B){this.w7[B.destination.Xd]=M;this.w7[B.source.Xd]=O}}Object(r.a)(H,"GridInstantaneousAction",null,[378]);var F=a(727);class G extends l.a{constructor(M){super();this.$=M;this.uc()}create(){this.$b(Object(F.a)(this.$.da,528,()=>new H(this.$)))}static la(M){M.da.Ja(529,new G(M))}}Object(r.a)(G,"GridInstantaneousActionFactory",l.a,[]);a.d(C,"a",function(){return L});const L=()=>{h.a.Fa(M=>
{G.la(M)})}},1502:function(r,C,a){a.r(C);r=a(1186);C=a(1229);a=a(1321);Object(r.a)();Object(C.a)();Object(a.a)()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSOpt.rsz.js.map/47595010e03e2072596179a237fd60fc/EwaDSOpt.rsz.js.map