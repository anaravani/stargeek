'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[39],{1283:function(r,C,a){a.r(C);r=a(0);var c=a(15);class b{constructor(l,k,u,v,x,w){l&&(this.N=l);k&&(this.S=k);u&&(this.M=u);v&&(this.F=v);null!=x&&(this.L=x);null!=w&&(this.C=w)}}Object(r.a)(b,"SerializableExceptionEntry",null,[]);class e{constructor(l,k,u,v,x){this.T=l;this.L=k;this.S=u;this.I=v;this.V=x}}Object(r.a)(e,"SerializableLogCache",null,[]);class f{constructor(l,k,u,v,x,w,m=!1,t=null,z=null){this.T=
this.G=0;this.C=this.M=null;this.D=0;this.G=w;this.T=v;this.M=l;this.C=k;this.D=1E3*x+u;m&&(this.O=1);t&&(this.A=t);z&&(this.E=z)}Xch(){if(!this.E)return 0;let l=7,k=0;this.E.N&&(l+=6+f.ica(this.E.N),k++);this.E.S&&(l+=6+f.ica(this.E.S),k++);this.E.M&&(l+=6+f.ica(this.E.M),k++);this.E.F&&(l+=6+f.ica(this.E.F),k++);this.E.L&&(l+=6+f.ica(this.E.L),k++);this.E.C&&(l+=6+f.ica(this.E.C),k++);1<k&&(l+=k-1);return l}qih(){let l=a(1283).LogCache.iQi+f.ica(this.G)+f.ica(this.T)+this.M.length+f.ica(this.C)+
f.ica(this.D)+this.Xch();1===this.O&&(l+=6);if(this.A){l+=7;for(let k=0,u=this.A.length;k<u;++k)l+=this.A[k].length+3}return l}static ica(l){return(""+l).length}}Object(r.a)(f,"SerializableLogEntry",null,[]);var d=a(389);a.d(C,"LogCache",function(){return h});class h{constructor(l,k,u){this.A_c=0;this.s_b=null;this.UEa=this.O2b=this.omb=0;this.BZc=l;this.z_a=k;this.TZ=u;this.BZc=262144>l?l:262144;this.TKg=this.BZc-4*(this.z_a+25);this.reset()}reset(){this.s_b=[];this.omb=25;this.A_c=(new Date).getTime()}get count(){return this.s_b.length}get cVb(){return this.O2b}set cVb(l){this.O2b=
l}TTg(l){if(l){l.message=this.pUb(l.message,"message",l.tag);var k=l.Lhd;k&&(k.name=this.pUb(k.name,"Exception.Name",l.tag),k.stack=this.pUb(k.stack,"Exception.Stack",l.tag),k.message=this.pUb(k.message,"Exception.Message",l.tag),k.file=this.pUb(k.file,"Exception.File",l.tag));if(l.Zh)for(var u=0;u<l.Zh.length;u++)l.Zh[u].length>this.z_a&&(l.Zh[u]=l.Zh[u].substr(0,this.z_a-13)+"... [trimmed]",c.ULS.sendTraceTag(3465240,100,50,"Trimmed arg {0} for log {1}",u,d.a(l.tag)));k=k?new b(k.name,k.stack,k.message,
k.file,k.line,k.column):null;l=new f(l.message,l.category,l.level,l.timestamp-this.A_c,l.JDd,l.tag,l.LEi,l.Zh,k);k=l.qih();0<this.O2b&&k+this.omb>this.O2b&&(u=this.count,this.reset(),c.ULS.sendTraceTag(0,100,15,"The log size is too large to be accepted by the server, throwing away {0} logs.",u));Array.add(this.s_b,l);this.omb+=k}}pUb(l,k,u){let v=l;l&&l.length>this.z_a&&(v=l.substr(0,this.z_a-13)+"... [trimmed]",c.ULS.sendTraceTag(3465240,100,50,"Trimmed {0} for log {1}",k,d.a(u)));return v}get eBi(){return this.omb>
this.TKg}serialize(){return c.ULS.nd(new e(this.A_c,this.s_b,this.TZ,this.UEa,1))}get r1d(){return this.BZc}get lDd(){return this.z_a}}h.iQi=31;Object(r.a)(h,"LogCache",null,[81,82])},1527:function(r,C,a){a.r(C);r=a(647);C=a(0);var c=a(15),b=a(88),e=a(64);class f{constructor(){$addHandler(document,"securitypolicyviolation",Object(b.a)(this,this.lRf,"onSecurityPolicyViolationEventHandler"))}lRf(fa){fa=fa.rawEvent;let ta=fa.blockedURI;ta=e.a.s2(ta);const Oa={};Oa.effectiveDirective=fa.effectiveDirective;
Oa.violatedDirective=fa.violatedDirective;Oa.originalPolicy=fa.originalPolicy;Oa.blockedURI=ta;Oa.disposition=fa.disposition;c.ULS.sendTraceTag(588084128,306,15,"{0}",Oa)}dispose(){$removeHandler(document,"securitypolicyviolation",Object(b.a)(this,this.lRf,"onSecurityPolicyViolationEventHandler"))}}Object(C.a)(f,"ContentSecurityPolicyListener",null,[2]);var d=a(261);class h{constructor(){this.Nb=null}get name(){return"Common.App.ContentSecurityPolicy"}init(){this.Nb.resolve("Common.App.ContentSecurityPolicy.ContentSecurityPolicyListener")}dispose(){const fa=
this.Nb.nh("Common.App.ContentSecurityPolicy.ContentSecurityPolicyListener");fa&&fa.dispose()}Oi(fa){this.Nb=fa;this.Nb.register(f,"Common.App.ContentSecurityPolicy.ContentSecurityPolicyListener").gd().od(()=>new f)}static main(){d.a.instance.wj(new h)}}Object(C.a)(h,"ContentSecurityPolicyPackage",null,[4,5]);var l=a(43);class k{constructor(){this.File=this.Message=null;this.Column=this.Line=0;this.ClientAppVersion=this.Stack=null;this.AppMode=this.AppType=0;this.DeobfuscateWithSourceMaps=!1;this.DataPlumber=
this.SessionStartInfoJson=null;this.IsShuttingDown=!1;this.ErrorName=this.Flight=null}hXd(){return l.c(this)}}Object(C.a)(k,"DiagnosticsRequest",null,[]);var u=a(6),v=a(490),x=a(471),w=a(32);class m{constructor(fa,ta,Oa,Ma,fb){this.MIa=fa;this.KFa=ta;this.N3=Oa;this.cNc=Ma;this.uJg=fb}Mbg(fa,ta){try{this.Toh().send(this.lZh(fa,ta))}catch(Oa){c.ULS.sendTraceTag(6161306,201,10,"Could not send error report [{0}]",Oa.toString())}}Toh(){const fa=new XMLHttpRequest;fa.open("POST",this.MIa,!0);fa.setRequestHeader("Content-Type",
"text/json; charset=utf-8");u.AFrameworkApplication.userSessionId&&fa.setRequestHeader(x.a.SXa,w.a.IG(u.AFrameworkApplication.userSessionId));this.KFa&&fa.setRequestHeader(x.a.P1,this.KFa);if(u.AFrameworkApplication.qe){const ta=u.AFrameworkApplication.qe.AQ;ta&&fa.setRequestHeader(x.a.kFa,ta)}return fa}lZh(fa,ta){if(!fa)return null;ta=ta?"<stack>"+ta+"</stack>":"";const Oa=new k;Oa.Message=fa.message;Oa.File=fa.source;Oa.Line=fa.line;Oa.Column=fa.column;Oa.Stack=ta;Oa.ClientAppVersion=this.KFa;Oa.AppType=
this.N3;Oa.AppMode=this.cNc;Oa.DeobfuscateWithSourceMaps=this.uJg;u.AFrameworkApplication.fa.ra("JavaScriptCrashJsonTagEnabled")&&(Oa.SessionStartInfoJson=u.AFrameworkApplication.fa.appSettings.SessionStartInfoJson||"",u.AFrameworkApplication.Mf&&(Oa.DataPlumber=l.c(u.AFrameworkApplication.Mf)),Oa.IsShuttingDown=u.AFrameworkApplication.ih,Oa.Flight=u.AFrameworkApplication.flightId,Oa.ErrorName=v.a.N9e(fa));return Oa.hXd()}}Object(C.a)(m,"JavascriptErrorReporter",null,[656]);class t{build(fa,ta,Oa,
Ma,fb){return new m(fa,ta,Oa,Ma,fb)}}Object(C.a)(t,"JavascriptErrorReporterFactory",null,[641]);class z{Oi(fa){fa.register(t,"Common.App.Diagnostics.JavascriptErrorReporterFactory").as("Common.IJavascriptErrorReporterFactory").gd().od(()=>new t)}get name(){return"Common.App.Diagnostics"}init(){}dispose(){}static main(){d.a.instance.wj(new z)}}Object(C.a)(z,"DiagnosticsPackage",null,[4,5]);var y=a(54),D=a(104),H=a(230),F=a(40),G=a(172),L=a(425),M=a(42),O=a(58),B=a(46),E=a(1283);class I{constructor(fa=
null,ta=null,Oa=null,Ma=null,fb=null,pa=null,Ua=null,Sa=null){this.lDd=3072;this.r1d=65536;this.lvg=6E4;this.Cog=2E3;this.YSe=1E4;this.vDe=5E3;this.sDe=!1;this.cVb=0;null!=fa&&(this.lDd=fa);null!=ta&&(this.r1d=ta);null!=Oa&&(this.lvg=Oa);null!=Ma&&(this.Cog=Ma);null!=fb&&(this.YSe=fb);null!=pa&&(this.vDe=pa);null!=Ua&&(this.sDe=Ua);null!=Sa&&0<Sa&&(this.cVb=Sa)}}Object(C.a)(I,"UlsUploadConfiguration",null,[]);var S=a(389);class J{constructor(fa,ta,Oa=null){this.AYb=0;this.iQc=!1;this.OJb=0;this.xmb=
null;this.Yqb=0;this.Kh=null;this.YYd=this._disposing=!1;this.CD=this.x_c=this.ZWb=this.VXb=0;this.TCc=!1;this.FYa=0;Oa||(Oa=new I);this.YYc=fa;this.uQ=ta;this.uQ.toLowerCase().startsWith("http:")&&document.URL.toLowerCase().startsWith("https:")&&c.ULS.disable();this.wQg=Oa.lvg;this.TPg=Oa.Cog;this.bGg=Oa.YSe;this.xQg=Oa.vDe;this.HDg=Oa.sDe;this.Bta=new E.LogCache(Oa.r1d,Oa.lDd,fa);this.Bta.cVb=Oa.cVb;this.lUd();this.P7f();this.Q7f()}P7f(){this.xmb=[];this.iQc=!1}RW(fa){1<this.Sjb?256>this.xmb.length?
Array.add(this.xmb,fa):this.iQc=!0:(this.Bta.TTg(fa),this.IQi(fa)&&!this.mUe()?(this.s5e("LogIndicatesError in HandleTrace"),c.ULS.sendTraceTag(3731793,100,200,"Flushing error-level log (tag {0}) synchronously",S.a(fa.tag))):this.Bta.eBi&&(this.Hzb(!1,!0),c.ULS.sendTraceTag(3731794,100,200,"Flushing asynchronously due to cache size")))}IQi(fa){return!!fa&&(1===fa.JDd||10===fa.level)}mUe(){return!1}dispose(){this._disposing||(this._disposing=!0,this.bVh(),c.ULS.aZd(null),window.clearTimeout(this.FYa),
window.clearTimeout(this.VXb),window.clearTimeout(this.ZWb),this.ZWb=this.VXb=this.FYa=0)}bVh(){this.mode=2;this.Ahf();this.TCc=!1;this.HXe();this.s5e("FlushForAppClose")}bVb(fa,ta){fa.UEa=this.OJb;return this.mvg(fa.serialize(),ta)?(this.OJb++,!0):!1}mvg(fa,ta){ta=this.HDg||!ta;this.Kh&&ta||(this.Kh=new XMLHttpRequest);if(0===this.Kh.readyState||4===this.Kh.readyState)return this.Kh.open("POST",this.uQ,ta),this.Kh.setRequestHeader("Content-Type","application/json"),this.Kh.setRequestHeader(J.xXd,
this.YYc),ta&&(this.Kh.timeout=this.xQg),this.Kh.send(fa),!0;c.ULS.sendTraceTag(3731796,100,50,"Could not initiate upload {0}",{["UploadId"]:this.OJb,["XhrReadyState"]:this.Kh.readyState});return!1}Zdj(){this.Kh&&this.Kh.abort()}fEc(fa,ta,Oa){try{return window.setTimeout(()=>{c.ULS.sendTraceTag(3731797,100,200,"Timeout ({0} ms) set by {1} is now firing.",ta,Oa);fa()},ta)}catch(Ma){c.ULS.sendTraceTag(0,100,15,"SetTimeoutToLogOriginAndExecute: Calling Window.SetTimeout() failed with exception: {0}",
Ma.toString());if(!this.YYd){this.YYd=!0;try{fa()}finally{this.YYd=!1}}return 0}}Q7f(){try{window.clearTimeout(this.VXb)}catch(fa){c.ULS.sendTraceTag(0,100,15,"ResetDelayedLoggingTimer: Calling Window.ClearTimeout() failed with exception: {0}",fa.toString())}this.VXb=this.fEc(Object(b.a)(this,this.Ahf,"handleDelayedLogs"),this.bGg,"ResetDelayedLoggingTimer")}get Sjb(){return c.ULS.Sjb+this.Yqb}Ahf(){const fa=this.xmb.length;if(fa){var ta=this.xmb,Oa=this.iQc;this.P7f();c.ULS.sendTraceTag(3731798,
100,50,"HandleDelayedLogs {0}",{["Count"]:fa,["Limit"]:256,["ExceededLimit"]:Oa});this.Yqb++;for(Oa=0;Oa<fa;Oa++)this.RW(ta[Oa]);this.Yqb--}this.Q7f()}lUd(){try{window.clearTimeout(this.ZWb)}catch(fa){c.ULS.sendTraceTag(0,100,15,"ResetCadenceTimer: Calling Window.ClearTimeout() failed with exception: {0}",fa.toString())}this.ZWb=this.fEc(Object(b.a)(this,this.Hzb,"flushImpl"),this.wQg,"ResetCadenceTimer")}get mode(){return this.CD}set mode(fa){const ta=this.CD;this.CD=fa;if(0===this.CD&&0!==ta)try{const Oa=
this.x_c;this.x_c=0;window.clearTimeout(Oa)}catch(Oa){c.ULS.sendTraceTag(0,100,15,"set_Mode: Calling Window.ClearTimeout() failed with exception: {0}",Oa.toString())}else 0!==this.CD&&0===ta&&(this.x_c=this.fEc(Object(b.a)(this,this.HXe,"endThrottling"),this.TPg,"ThrottlingMode Setter"))}HXe(){this.mode=0;this.TCc&&(this.TCc=!1,this.Hzb())}dSb(fa){return 2===this.mode||1===this.mode&&!fa}s5e(fa){c.ULS.sendTraceTag(3731800,100,200,"Flushing Synchronous due to {0}",fa);this.Hzb(!0)}Fzb(){this.q5e(0)}q5e(fa){this.FYa||
(this.FYa=this.fEc(Object(b.a)(this,this.Hzb,"flushImpl"),fa,"FlushAsynchronous"))}Hzb(fa,ta){this.Yqb++;try{window.clearTimeout(this.FYa)}catch(Ma){c.ULS.sendTraceTag(0,100,15,"FlushImpl: Calling Window.ClearTimeout() failed with exception: {0}",Ma.toString())}this.FYa=0;if(this.Bta.count)if(!ta&&this.dSb(fa))c.ULS.sendTraceTag(3731801,100,200,"Not flushing ({0}) due to throttling",fa?"sync":"async"),this.TCc=!0;else{this.mode=fa?2:1;this.lUd();c.ULS.sendTraceTag(3731803,100,200,"Flushing ({0}) cached bULS logs ({1} logs)",
fa?"sync":"async",this.Bta.count);try{var Oa=this.bVb(this.Bta,fa)}catch(Ma){this.Zdj(),Oa=!1}Oa?(this.Bta.reset(),this.AYb=0):(this.AYb++,this.AYb<J.fEf?this.q5e(J.tBc):(this.Bta.reset(),this.OJb++,this.AYb=0))}else this.lUd();this.Yqb--}vCb(){}qsb(){}}J.fEf=3;J.tBc=15E3;J.xXd="X-UserSessionId";Object(C.a)(J,"UploadingUlsHost",null,[53,2]);const K=fa=>{let ta=0;u.AFrameworkApplication.fa&&(ta=u.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.WordOnline.bUlsFetchRequestOption",-1),-1===
ta&&(ta=u.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.bUlsFetchRequestOption",0)));return ta===fa};class R{constructor(fa,ta,Oa,Ma){this.UEa=fa;this.h5c=ta;this.sessionId=Oa;this.version=Ma}}Object(C.a)(R,"UploadState",null,[]);class Z{constructor(fa){this.lKg=fa}get wLi(){return this.lKg}}Object(C.a)(Z,"FetchRequestArgs",null,[]);var P=a(84),V=a(543);class Ea extends Sys.EventArgs{constructor(fa){super();this.Zh=fa}}Object(C.a)(Ea,"UlsLoggingEventArgs",Sys.EventArgs,
[]);var oa=a(188);class ea extends J{constructor(fa,ta,Oa,Ma,fb,pa=null){super(u.AFrameworkApplication.userSessionId,ea.PXh(ea.n1h(fa,Ma),ta,Oa,pa),new I(void 0,u.AFrameworkApplication.Tii(),Ma.Ae("BulsUploadFrequencyInMs",6E4),void 0,void 0,void 0,void 0,u.AFrameworkApplication.r7b));this.zee=!1;this.cYc=this.Lqb=this.IWb=this.$H=null;this.Ah=Oa;this.qsa=Ma;(this.Jqb=this.qsa.Va("RemoteUlsETag"))&&ea.bZf(this.qsa.Va("RemoteUlsSuppressions"));fb&&(this.IWb=fb,this.IWb.T2c(Object(b.a)(this,this.JRf,
"onSettingsRefreshed")))}get events(){return this.$H||(this.$H=new Sys.EventHandlerList)}qsb(fa){this.events.addHandler(ea.Erg,fa)}get Ydb(){return null}get VLd(){return null}get B5c(){return this.qsa.ra("BUlsExceptionLoggingIsEnabled")}dispose(){this.zee||(this.zee=!0,super.dispose(),this.IWb&&this.IWb.r5f(Object(b.a)(this,this.JRf,"onSettingsRefreshed")))}JRf(fa,ta){ta.sab(ea.F3d)&&(this.Lqb=this.yff())}N1h(){return Error().stack}yff(){let fa=null;if(this.qsa.Lq(ea.F3d)){fa=new oa.a;const ta=this.qsa.Tw(ea.F3d);
for(let Oa=0;Oa<ta.length;Oa++)fa.ia(ta[Oa],!0)}return fa}RW(fa){this.Lqb||(this.Lqb=this.yff());if(this.Lqb&&this.Lqb.Pb(fa.tag))try{!fa.Lhd&&this.B5c?fa.Lhd=new V.a(Error()):fa.message+=". JsCallStack: "+this.N1h()}catch(Oa){fa.message+=" [Failed to add callstack for this tag. BUlsExceptionLoggingIsEnabled="+this.B5c+" ("+Oa.message+")]"}super.RW(fa);const ta=this.events.getHandler(ea.Erg);fa=new Ea(fa);ta&&ta(null,fa)}bVb(fa,ta){if(this.Ah){if(!this.OWj)return!1;const Oa=fa.serialize();if(0<u.AFrameworkApplication.r7b&&
Oa.length>u.AFrameworkApplication.r7b)return!1;fa.UEa=this.OJb++;if(K(0)){if(this.Bhg())return this.FQb(this.uQ,Oa),!0;this.zxe(this.uQ,Oa,ta&&!this.Ydb?0:3,1,ta&&u.AFrameworkApplication.ih,fa.UEa,this.Ydb,this.VLd)}else{if(this.Bhg()){if(K(1))return this.FQb(this.uQ,Oa),!0;window.console&&window.console.log&&window.console.log("Send shuttingDown buls from common")}this.m2c(this.uQ,Oa,3,1,fa.UEa,this.Ydb,this.VLd)}return!0}return K(0)?super.bVb(fa,ta):(this.zKj(this.uQ,fa.serialize()),!0)}Yvc(fa){try{if(fa&&
fa.data&&fa.data.responseHeaders&&ea.VCb in fa.data.responseHeaders){var ta=fa.data.responseHeaders[ea.VCb];ta!==this.Jqb&&(this.Jqb=ta,ea.bZf(fa.data.responseHeaders[ea.gsd]))}}catch(Oa){c.ULS.sendTraceTag(593847297,100,50,"Failed to process tag suppressions. [Message: {0}] [Stack: {1}]",Oa.message,Oa.stack)}}Cuc(fa){const ta=fa.data;if(!ta)c.ULS.sendTraceTag(5002497,100,15,"Request Item is null! RequestFailedEventArgs = {0}",fa);else if(13===ta.status)c.ULS.sendTraceTag(6399108,100,50,"Request timed out in the ClientRequestManager queue. Falling back to default XHR."),
this.mvg(ta.request.get_body(),!1);else if(!ta.responseHeaders)c.ULS.sendTraceTag(5002498,100,15,"Item.ResponseHeader is null! RequestItem id = {0}, responseXml = {1}, data = {2}, HttpStatusCode = {3}",ta.id,ta.FUa,ta.Pe,ta.httpStatus);else if(!(ea.Gxi in ta.responseHeaders||(fa=ta.httpStatus,400<=fa&&499>=fa))){var Oa=ta.state;Oa.h5c>=J.fEf||(K(0)?window.setTimeout(()=>{this.zxe(ta.request.get_url(),ta.request.get_body(),3,Oa.h5c+1,!1,Oa.UEa,Oa.sessionId,Oa.version)},J.tBc):window.setTimeout(()=>
{this.m2c(ta.request.get_url(),ta.request.get_body(),3,Oa.h5c+1,Oa.UEa,Oa.sessionId,Oa.version)},J.tBc))}}zxe(fa,ta,Oa,Ma,fb,pa,Ua,Sa){K(0)?this.Ah.Sn(fa,2,ta,this.hbd(),!1,Oa,Object(b.a)(this,this.Yvc,"onSuccessfulUpload"),Object(b.a)(this,this.Cuc,"onFailedUpload"),new R(pa,Ma,Ua,Sa),null,fb,this.qsa.Ae("BulsClientRequestManagerQueueTimeInMS",3E4),void 0,"19",Ua,void 0,Sa,[ea.VCb,ea.gsd]):this.m2c(fa,ta,Oa,Ma,pa,Ua,Sa)}m2c(fa,ta,Oa,Ma,fb,pa,Ua){let Sa;Sa=K(2)||K(3)?new Z(!0):new Z(!1);this.Ah.sTg(fa,
ta,this.hbd(),Sa,Oa,Object(b.a)(this,this.Yvc,"onSuccessfulUpload"),Object(b.a)(this,this.Cuc,"onFailedUpload"),new R(fb,Ma,pa,Ua),this.qsa.Ae("BulsClientRequestManagerQueueTimeInMS",3E4),pa,Ua,[ea.VCb,ea.gsd])}zKj(fa,ta){const Oa={};Oa.body=ta;Oa.method="POST";Oa.headers=this.hbd();if(K(2)||K(3))Oa.keepalive=!0;window.fetch(fa,Oa).then(()=>null,()=>{c.ULS.sendTraceTag(509149207,100,50,"exception from buls fetch");return null})}hbd(){let fa=null;this.Jqb&&(fa={},fa[ea.VCb]=this.Jqb);if(this.B5c){const ta=
u.AFrameworkApplication.sa;let Oa=null;ta&&(Oa=ta.Qa);Oa&&(fa||(fa={}),fa[ea.bpi]=Oa.uBa,fa[ea.cpi]=Oa.li,fa[ea.hpi]=u.AFrameworkApplication.pAi?"1":"0",K(0)||(fa[ea.Uoi]="text/plain"))}return fa}FQb(fa,ta){this.Ah.FQb(fa,ta)}Bhg(){return u.AFrameworkApplication.ih||u.AFrameworkApplication.gpc}get QEj(){this.cYc||(this.cYc=this.qsa.Ae("bULSUploadRetryDelayWhenDisconnectedInMilliseconds",6E4));return this.cYc}get OWj(){const fa=this.Ah.S$a;return fa&&(new Date).getTime()-this.Ah.gMi.getTime()>=this.QEj?
!0:!fa}static n1h(fa,ta){ta=ta.Va("BulsEndpointUrl");return ea.Tsf(ta)?ta:fa}static Tsf(fa){return!(void 0===fa||null===fa)&&""!==fa}static PXh(fa,ta,Oa,Ma){fa=ea.ESg(fa,ta);fa=ea.RVg(fa,Oa);fa=ea.hUg(fa,Ma);return fa=ea.OVg(fa)}static ESg(fa,ta){return ta?e.a.Kl(fa,"build",u.AFrameworkApplication.buildVersion):fa}static RVg(fa,ta){if(!ta)return fa;ta=ta.AQ;return ta?fa=e.a.Kl(fa,x.a.GVb,ta):fa}static hUg(fa,ta){return ea.Tsf(ta)?e.a.Kl(fa,"officeserverversion",ta):fa}static OVg(fa){return u.AFrameworkApplication.userSessionId&&
""!==u.AFrameworkApplication.userSessionId?e.a.Kl(fa,u.AFrameworkApplication.Qra,u.AFrameworkApplication.userSessionId):fa}static bZf(fa){c.ULS.a9b();if(fa){fa=fa.split(",");for(const ta of fa)fa=parseInt(ta),!isNaN(fa)&&isFinite(fa)&&c.ULS.p4b(fa)}}}ea.VCb="X-bULS-SuppressionETag";ea.gsd="X-bULS-SuppressedTags";ea.bpi="X-bULS-OfficeAppMode";ea.cpi="X-bULS-OfficeAppType";ea.hpi="X-bULS-UseSourceMaps";ea.Uoi="Content-Type";ea.Erg="CommonUlsTraceEventKey";ea.F3d="TagCallStackInclusionList";ea.Gxi="X-InvalidUlsJson";
Object(C.a)(ea,"CommonUlsHost",J,[]);var aa=a(105);class ia extends ea{constructor(fa,ta){super(fa,!1,u.AFrameworkApplication.qe,P.a.instance.nh("Common.IRefreshableAppSettings")||u.AFrameworkApplication.fa,P.a.instance.nh("Common.IRefreshableAppSettings"),ta);this.rbk="usu";this.obk="ufu";this.Ub=null;this.Ta=new aa.a}get $(){this.Ub||(this.Ub=0<O.a.getRegisteredEwaInstances().length?O.a.kq(document.body):null);return this.Ub}RW(fa){1===fa.JDd&&(fa.message="Assert: "+fa.message);super.RW(fa)}mUe(){return!0}bVb(fa,
ta){if(u.AFrameworkApplication.ih&&u.AFrameworkApplication.V9)return!1;let Oa=null;this.$&&(Oa=this.$.yc.Fd("UserAction","CommonUlsHostOverrides:UploadLogs"));ta=!u.AFrameworkApplication.V9&&ta;fa=super.bVb(fa,ta);Oa&&Oa.stop();return fa}Yvc(fa){super.Yvc(fa);this.Ta.raiseEvent(this.rbk,fa)}Cuc(fa){super.Cuc(fa);this.Ta.raiseEvent(this.obk,fa)}}Object(C.a)(ia,"CommonUlsHostOverrides",ea,[421,53,2]);class ya{fnh(fa,ta){return new ia(fa,ta)}}Object(C.a)(ya,"CommonHostFactory",null,[447]);var za=a(1),
la=a(65);class xa extends M.a{constructor(fa){super();this.E9b=fa;Sys.Application.registerDisposableObject(this)}qsb(fa){this.E9b.qsb(fa)}RW(fa){this.E9b.RW(fa)}vCb(fa){this.E9b.vCb(fa)}Fzb(){this.E9b.Fzb()}static la(fa,ta=null){const Oa=new G.a;Object(L.a)(xa,u.AFrameworkApplication.rEa)||(ta=ta||new ya,B.a.Iui(()=>{var Ma;if(u.AFrameworkApplication.browserUlsIsEnabled){var fb=fa+"/RemoteUls.ashx";xa.$&&(fb=xa.ZUg(fb));const pa=za.EwaSettings.isChangeGateEnabled("OfficeVSO:7636252_BUlsOfficeServerVersion")?
this.Def():null;fb=ta.fnh(fb,pa);za.EwaSettings.isChangeGateEnabled("OfficeVSO:7636258_DisposeCommonUlsHostInExcel")&&(null===(Ma=u.AFrameworkApplication.rEa)||void 0===Ma?void 0:Ma.dispose());u.AFrameworkApplication.rEa=fb;c.ULS.IVa(50);c.ULS.aZd(fb);Oa.setResult(new xa(fb))}else c.ULS.disable()},!u.AFrameworkApplication.zUj()));return Oa.task}static ZUg(fa){const ta=this.Def();return e.a.Kl(fa,"officeserverversion",ta)}static Def(){return xa.$?la.d(xa.$)?xa.$.workbookContext.BuildVersion:xa.$.xa.BuildVersion:
null}static get $(){xa.Ub||(xa.Ub=0<O.a.getRegisteredEwaInstances().length?O.a.kq(document.body):null);return xa.Ub}}xa.Ub=null;Object(C.a)(xa,"EwaUlsHost",M.a,[421,53,2]);class wa extends H.a{constructor(fa){super();this.mqa=fa;this.uc()}create(){F.TaskExtensions.za(xa.la(this.mqa),fa=>{fa=fa.result;D.a.Em.Ja(135,fa);this.$b(fa)},this.ka)}}Object(C.a)(wa,"EwaUlsHostFactory",H.a,[]);var hb=a(162),Ja=a(38);class Fa{constructor(fa){this.Hme=null;this.NKi=fa}get wHd(){return this.Hme||(this.Hme={})}Wmj(fa,
ta,Oa){!fa&&ta.source&&(fa=Ja.a.nr(this.wHd,ta.source)+1,this.wHd[ta.source]=fa,fa-1&fa||c.ULS.sendTraceTag(537155536,0,15,`${fa} errors seen for location=${ta.source}`));ta.source&&1!==Ja.a.nr(this.wHd,ta.source,1)||(c.ULS.sendTraceTag(537155535,0,50,"JavaSctipCrashProcessor.ProcessJavascriptError: Sending request to log JavaScript crash in the server"),this.NKi.Mbg(ta,Oa))}}Object(C.a)(Fa,"JavaScriptCrashProcessor",null,[405]);var Ba=a(79);Type.registerNamespace("_Ewa");Object(r.a)();Type.registerNamespace("Common.App.ContentSecurityPolicy");
h.main();Type.registerNamespace("Common.App.Diagnostics");z.main();Type.registerNamespace("DiagUse");D.a.Em.Ja(43,new wa(y.a.current.sM.ServerUriBase));(()=>{try{hb.a.Igf().continueWith(fa=>{try{if(D.a.Em.Ba(42))c.ULS.sendTraceTag(537155532,0,50,"JavaScriptCrashProcessorBootstrapper: already initialized");else{const ta=fa.result,Oa=P.a.instance.resolve("Common.IJavascriptErrorReporterFactory").build(y.a.current.sM.ServerUriBase+ta.LayoutsRelativeUri+"/diagnostics.ashx",ta.BuildVersion,1,0,!0);D.a.Em.Ja(42,
new Fa(Oa));c.ULS.sendTraceTag(537155533,0,50,"JavaScriptCrashProcessorBootstrapper: initialized and ready to be used")}}catch(ta){c.ULS.sendTraceTag(537155531,0,15,`JavaScriptCrashProcessorBootstrapper: An exception occured while initializing JavascriptErrorProcessor, Message: ${ta.message}, Callstack: ${ta.stack}`)}},3,null,Ba.a.current)}catch(fa){c.ULS.sendTraceTag(537155530,0,15,`JavaScriptCrashProcessorBootstrapper: an exception occured, Message: ${fa.message}, Callstack: ${fa.stack}`)}})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSOpt.tmcore.js.map/9ecb2ac7c109fa3eb97e65fb2388340c/EwaDSOpt.tmcore.js.map