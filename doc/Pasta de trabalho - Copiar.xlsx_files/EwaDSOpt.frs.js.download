/*
 The buffer module from node.js, for the browser.

 @author   Feross Aboukhadijeh <http://feross.org>
 @license  MIT
 ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[16],{1174:function(r,C,a){a.d(C,"a",function(){return c});const c=()=>{Type.registerNamespace("Common.App.InsertFile")}},1175:function(r,C,a){a.d(C,"a",function(){return c});const c=()=>{Type.registerNamespace("Common.App.InsertPicture")}},1176:function(r,C,a){a.d(C,"a",function(){return b});r=a(0);C=a(979);var c=a(34);class b extends C.a{constructor(e=null,f=null){super(c.a.Uc(e,"_"),f)}}Object(r.a)(b,"EwaCCPError",
C.a,[])},1177:function(r,C,a){a.d(C,"a",function(){return b});var c=a(522);const b=()=>{c.a.sj(".insert-media-dialog-old{width:870px;float:left;margin-top:7px}.insert-media-dialog{width:870px;width:clamp(400px,870px,80vw);float:left;margin-top:7px}.app-rtl .insert-media-dialog{float:right}.insert-media-frame{width:100%;height:100%;visibility:visible}.insert-media-panel-old{height:550px}.insert-media-panel{height:550px;height:clamp(300px,550px,90vh)}.keep-focus-start{position:absolute;width:-1000px;top:-1000px}.keep-focus{position:absolute;width:-1000px;top:1000px}.display-none{display:none}.padding-zero{padding:0}")}},
1179:function(r,C,a){a.d(C,"a",function(){return b});var c=a(522);const b=()=>{c.a.sj(".ewr-selection-draghandle,.ewr-selection-draghandle-grab{position:absolute;cursor:move;background-color:#fff;opacity:.01;z-index:15;pointer-events:auto}.ewr-selection-draghandle-grab{cursor:grab}.ewr-selection-draghandle-top-ie,.ewr-selection-draghandle-top-ie-enhanced{top:-2px;left:-2px;right:-2px;height:5px}.ewr-selection-draghandle-top-ie-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-top,.ewr-selection-draghandle-top-enhanced{top:-2px;left:-2px;right:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-top-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom-ie,.ewr-selection-draghandle-bottom-ie-enhanced{right:0;left:-2px;bottom:-2px;height:5px}.ewr-selection-draghandle-bottom-ie-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom,.ewr-selection-draghandle-bottom-enhanced{right:0;left:-2px;bottom:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-bottom-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-left-ie,.ewr-selection-draghandle-left-ie-enhanced{top:0;left:-2px;bottom:0;width:5px}.ewr-selection-draghandle-left-ie-enhanced{border-top:1.5px solid transparent}.ewr-selection-draghandle-left,.ewr-selection-draghandle-left-enhanced{top:0;left:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-left-enhanced{border-left:1.5px solid transparent}.ewr-selection-draghandle-right-ie,.ewr-selection-draghandle-right-ie-enhanced{top:0;right:-2px;bottom:0;width:5px}.ewr-selection-draghandle-right-ie-enhanced{border-right:1.5px solid transparent}.ewr-selection-draghandle-right,.ewr-selection-draghandle-right-enhanced{top:0;right:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-right-enhanced{border-right:1.5px solid transparent}.ewr-selection-dragtooltip{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:18px;font-size:12px;padding-left:2px;padding-right:2px}.ewr-selection-dragtooltip-updated{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:fit-content;width:max-content;font-size:10px;padding-left:2px;padding-right:2px}.ewr_selection_rearrangeleft{border-left:3px solid #217346;position:absolute;height:10px;width:0;left:-2px;top:-4px}.ewr_selection_rearrangeright{border-right:3px solid #217346;position:absolute;height:10px;width:0;right:-5px;top:-4px}.ewr_selection_rearrangetop{border-top:3px solid #217346;position:absolute;width:10px;height:0;top:-2px;left:-4px}.ewr_selection_rearrangebottom{border-bottom:3px solid #217346;position:absolute;width:10px;height:0;bottom:-5px;left:-4px}.ewr-cell-selection-highlight-all.selecting .ewr-selection-draghandle{cursor:unset}.ewr-selection-resizemarqueehandle{position:absolute;width:5px;height:5px;background-color:#217346;border:solid 1px #fff;z-index:16;pointer-events:auto}.ewr-selection-resizemarqueehandle-topleft,.ewr-selection-resizemarqueehandle-topright{top:-4px}.ewr-selection-resizemarqueehandle-bottomleft,.ewr-selection-resizemarqueehandle-bottomright{bottom:-4px}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{cursor:nwse-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{cursor:nesw-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright{cursor:nesw-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright{cursor:nwse-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{left:-4px}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{right:-4px}.ewr-marquee-thick{z-index:calc(10 + 1) !important;border-width:3px !important}.ewr-grdcontarea-ltr .ewr-marquee-thick{margin:-3px 0 0 -3px !important}.ewr-grdcontarea-rtl .ewr-marquee-thick{margin:-3px -3px 0 0 !important}.ewr-resizemarqueehandle-thick{height:6px !important;width:6px !important}")}},
1180:function(r,C,a){a.d(C,"a",function(){return b});var c=a(522);const b=()=>{c.a.sj(".ewa-ttrd-buttonarea{position:absolute;z-index:31}.ewr-table-resize-fillhandle-broader{position:absolute;width:6px;height:3px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-higher{position:absolute;width:3px;height:6px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-grdcontarea-ltr .ewr-table-resize-fillhandle-higher{right:-6px}.ewr-grdcontarea-rtl .ewr-table-resize-fillhandle-higher{left:-6px}.ewr-grdcontarea-ltr .ewr-table-resize-handle{cursor:nwse-resize;right:6px;bottom:0}.ewr-grdcontarea-rtl .ewr-table-resize-handle{cursor:nesw-resize;left:6px;bottom:0}.ewr-grdcontarea-ltr .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-grdcontarea-rtl .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-cell-selection-highlight-all.Selecting .ewr-table-resize-handle{cursor:nesw-resize}@media screen and (-ms-high-contrast:active),(forced-colors:active){.ewr-table-resize-fillhandle-higher{forced-color-adjust:none;position:absolute;width:3px;height:6px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-broader{forced-color-adjust:none;position:absolute;width:6px;height:3px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}}@media screen and (-ms-high-contrast:black-on-white),(forced-colors:active) and (prefers-color-scheme:light){.ewr-table-resize-fillhandle-higher{background-color:#000}.ewr-table-resize-fillhandle-broader{background-color:#000}}")}},
1195:function(r,C,a){var c=a(0),b=a(2),e=a(15),f=a(230),d=a(32),h=a(31),l=a(362),k=a(173),u=a(366),v=a(25),x=a(1),w=a(42),m=a(9),t=a(294),z=a(16);class y extends t.a{constructor($a){super($a);this.Hfh=()=>{e.ULS.sendTraceTag(537167827,0,50,"ClipboardReadPermissionAskDialog OK button pressed")};e.ULS.sendTraceTag(537167828,0,50,"ClipboardReadPermissionAskDialog.ClipboardReadPermissionAskDialog");this.Ac=0;this.Qc(1,z.a.instance.ha(2260));$a=z.a.instance.ha(2258);const Y=this.bJ();this.initializeAndShow($a,
this.Hfh,Y)}get dd(){return"ClipboardReadPermissionAskDialog"}bJ(){const $a={};$a.id=this.dd;const Y=z.a.instance.ha(2259);$a.DialogMessage=Y;return $a}}Object(c.a)(y,"ClipboardReadPermissionAskDialog",t.a,[]);var D=a(55);const H=($a,Y,Ta,Bb,Rb)=>{const jc=$a.Stopwatch,vc={};vc.a=Rb;vc.e=jc.id;vc.c="RearrangeRowColumn";vc.b="mouse";vc.d=$a.OperationId.toString();vc.f=Ta.toString();vc.g=Bb.toString();vc.h=Y.toString();vc.i=$a.DragDropIsShiftKeyDown;vc.j=!0;vc.o=jc.vd;vc.q=!1;vc.r=$a.CopyPasteTargetType.toString();
vc.s=$a.EncounteredDeploymentErrors;return vc};class F{constructor($a,Y){this.TXh=()=>{const Ta={};Ta.SourceItem=this.toString();return Ta};this.sessionStateId=$a;this.sessionId=Y;this.toJSON=this.TXh}Eqf($a){return $a?this.sessionStateId===$a.sessionStateId&&this.sessionId===$a.sessionId:!1}isFromCurrentSession($a){return this.sessionId===$a.xa.UserSessionId}}Object(c.a)(F,"SourceItem",null,[]);class G extends F{constructor($a,Y,Ta,Bb,Rb){super(Ta,Bb);this.activeFloatingObjectControlId=$a;this.sheetName=
Y;this.type=Rb}isEqual($a){return $a&&Object.getType($a)===G?this.Eqf($a)&&this.activeFloatingObjectControlId===$a.activeFloatingObjectControlId&&this.sheetName===$a.sheetName:!1}toString(){return this.type.toString()}}Object(c.a)(G,"ArtSourceItem",F,[]);var L;(function($a){$a[$a.valid=0]="valid";$a[$a.notPairwiseDisjoint=1]="notPairwiseDisjoint";$a[$a.cutNotSupportedInDiscontinuousSelection=2]="cutNotSupportedInDiscontinuousSelection";$a[$a.notValidForm=3]="notValidForm";$a[$a.temporarilyBlockedCopy=
4]="temporarilyBlockedCopy"})(L||(L={}));Object(c.b)("CopySourceValidationOptions",L);var M=a(47);class O extends F{constructor($a,Y,Ta,Bb,Rb){super(Bb,Rb);e.ULS.shipAssertTag(537167645,0,!!Y&&0<Y.length,"RangeSourceItem.ctor: ranges should not be null or empty");this.$=$a;this.ranges=Y;this.sheetName=Ta}isEqual($a){return $a&&Object.getType($a)===O?this.Eqf($a)&&M.R(this.ranges,$a.ranges)&&this.sheetName===$a.sheetName:!1}toString(){return M.i(this.ranges,",",this.$,!1)}}Object(c.a)(O,"RangeSourceItem",
F,[]);const B=$a=>!!$a&&Object.getType($a)===O;class E{}E.kik="PasteError_FailedToReadFromClipboard_UserHashMismatchError";Object(c.a)(E,"ExpectedErrorNames",null,[]);class I{}I.plainText="text/plain";I.html="text/html";I.png="image/png";I.shadowWorkbook="data/shadow-workbook";I.nEi="metadata/is-last-copy-was-external";I.nAi="metadata/is-last-copy-was-external-XLO-source";I.ieh="metadata/chrome-extension-id";I.z4a="copyId";I.l_g="metadata/additional-signature-data-attributes";Object(c.a)(I,"ClipboardDataFormat",
null,[]);const S=$a=>$a.clipboardItems&&($a=$a.clipboardItems.getItem(I.nEi))&&"1"===$a?!0:!1,J=$a=>S($a)&&!(void 0===$a.clipboardItems||null===$a.clipboardItems)&&!!$a.clipboardItems.getItem(I.png)&&!$a.clipboardItems.getItem(I.plainText),K=$a=>$a.clipboardItems&&($a=$a.clipboardItems.getItem(I.nAi))&&"1"===$a?!0:!1,R=$a=>$a&&($a=$a.getCachedMetadata(),null===$a||void 0===$a?0:$a.lastCopy)?$a.lastCopy:null;var Z=a(53),P=a(19),V=a(37);class Ea{constructor($a,Y,Ta,Bb){this.$=$a;this.originalDestinations=
Y;this.yec=Ta;this.XCg=Bb;this.YMg=this.originalDestinations;this.RGg=this.yec;this.tKg="PasteRecoveryUI"}get k_g(){return this.XCg}get Ayf(){return this.tKg}get Wsj(){return this.YMg}get P2e(){return this.RGg}cya(){return Ea.Qhj}R4h(){return this.yec&&1===this.yec.length?this.S4h(this.yec[0]):null}tmd(){return"PasteRecoveryUI-Floatie"}S4h($a){var Y=P.h(this.$);const Ta=Y.Mb.Di($a);var Bb=Y.gh($a,Ta);Y=Y.rtl;if(!Bb)return null;$a=P.h(this.$).sg(Ta);const Rb=$a.nm;if(!Rb.Yd(Bb))return null;Bb=Rb.ff(Bb);
const jc=Bb.topLeft.y;var vc=Bb.bottomRight.y;const bb=Y?Bb.bottomRight.x:Bb.topLeft.x;Bb=Y?Bb.topLeft.x:Bb.bottomRight.x;var Mb=new Z.a(Bb+(Y?-81:81),vc+38+6);if(Rb.Dka(Mb))return this.d8a($a,Rb,Ta,Bb,vc,Y?12:-3,66);Mb=new Z.a(Bb+(Y?-81:81),vc);if(Rb.Dka(Mb))return this.d8a($a,Rb,Ta,Bb,vc,Y?20:3,22);Mb=new Z.a(Bb,vc+38+6);if(Rb.Dka(Mb))return this.d8a($a,Rb,Ta,Bb,vc,-81+(Y?18:0),66);Bb=new Z.a(bb+(Y?81:-81),vc);if(Rb.Dka(Bb))return this.d8a($a,Rb,Ta,bb,vc,-81+(Y?12:-6),22);vc=new Z.a(bb,jc-38-6);
return Rb.Dka(vc)?this.d8a($a,Rb,Ta,bb,jc,Y?15:0,16):this.d8a($a,Rb,Ta,Y?Rb.topLeft.x:Rb.bottomRight.x,Rb.bottomRight.y,-81+(Y?15:-6),22)}d8a($a,Y,Ta,Bb,Rb,jc,vc){var bb=P.h(this.$);const Mb=bb.rtl;$a=Sys.UI.DomElement.getLocation($a.domElement);Bb=new Sys.UI.Point(Bb+(Mb?0:$a.x)-Y.topLeft.x,Rb+$a.y-Y.topLeft.y);Mb&&(bb=bb.view.visibleArea,Bb.x=bb.bottomRight.x-bb.topLeft.x-Bb.x,2===Ta||4===Ta)&&(Bb.x+=Y.bottomRight.x);Bb=V.a(this.$).Fma(Bb);return new Sys.UI.Point(Bb.x+jc,Bb.y+vc)}}Ea.Qhj=["PasteRecoveryUI"];
Object(c.a)(Ea,"PasteRecoveryUI",null,[357]);var oa=a(75),ea=a(278);class aa{}aa.YRg="ActiveSelection";aa.shadowWorkbook="ShadowWorkbook";aa.Zzg="GVML";aa.plainText="PlainText";aa.html="Html";aa.F5g="Bitmap";Object(c.a)(aa,"PayloadType",null,[]);class ia{}ia.O_j="Slice6";Object(c.a)(ia,"SliceName",null,[]);class ya{}ya.uZi="NotCalled";ya.success="Success";ya.failed="Failed";Object(c.a)(ya,"SucceededPopulatingSystemClipboardOptions",null,[]);var za=a(346);const la=($a,Y)=>$a?Y&&Y.xa?$a.sessionId!==
Y.xa.UserSessionId:(e.ULS.shipAssertTag(537166209,0,!1,"ewaControl shouldn't be null"),!1):(e.ULS.shipAssertTag(537166210,0,!1,"copyContext shouldn't be null"),!1),xa=$a=>{switch($a){case 0:return"None";case 2:return"Art";case 1:return"Range";default:return"Unknown"}},wa=$a=>{if(!$a)return"null";const Y=[];for(const Ta of $a.get())Y.push(`${Ta.clipboardDataFormat}(${Ta.data.length})`);Y.sort();return Y.join(",")};var hb;(function($a){$a[$a.valid=0]="valid";$a[$a.destinationRangesIsEmpty=1]="destinationRangesIsEmpty";
$a[$a.discontinuousSelectionNotSupportPasteFromExternal=2]="discontinuousSelectionNotSupportPasteFromExternal";$a[$a.discontinuousSelectionNotSupportPasteCrossSession=3]="discontinuousSelectionNotSupportPasteCrossSession";$a[$a.multipleSourcesAndMultipleDestinationsAreNotSupported=4]="multipleSourcesAndMultipleDestinationsAreNotSupported";$a[$a.multipleDestinationsAreNotMultiplyOfSourceRange=5]="multipleDestinationsAreNotMultiplyOfSourceRange";$a[$a.sourceAndDestinationAreOverlapping=6]="sourceAndDestinationAreOverlapping";
$a[$a.copySourceNotValid=7]="copySourceNotValid";$a[$a.cutNotSupportedInDiscontinuousSelection=8]="cutNotSupportedInDiscontinuousSelection";$a[$a.pasteLinkNotSupportMultipleDestination=9]="pasteLinkNotSupportMultipleDestination";$a[$a.temporarilyBlockedPaste=10]="temporarilyBlockedPaste";$a[$a.unknown=100]="unknown"})(hb||(hb={}));Object(c.b)("PasteValidationOptions",hb);var Ja=a(52),Fa=a(150),Ba=a(40),fa=a(167),ta=a(356),Oa=a(34),Ma=a(327),fb=a(12),pa=a(23),Ua=a(138),Sa=a(120),Ia=a(577),X=a(106),
ca=a(63),U=a(100);class ma extends Sys.EventArgs{constructor($a,Y,Ta){super();this.command=$a;this.destinationRange=Y;this.sourceRange=Ta}}Object(c.a)(ma,"PasteCSERenderedEventArgs",Sys.EventArgs,[]);var ra=a(124),Va=a(72),ob=a(149),ja=a(35);class lb extends Ea{constructor($a,Y,Ta,Bb){super($a,Y,Ta,Bb);this.gNi="DragRecoveryUI"}get Ayf(){return this.gNi}cya(){return lb.MAh}tmd(){return"DragRecoveryUI-Floatie"}}lb.MAh=["DragRecoveryUI"];Object(c.a)(lb,"DragFillRecoveryUI",Ea,[]);var wb;(function($a){$a[$a.source=
0]="source";$a[$a.destination=1]="destination"})(wb||(wb={}));Object(c.b)("RangeType",wb);class Ab extends w.a{constructor($a,Y,Ta,Bb,Rb,jc,vc,bb,Mb=null){super();this.pasteShortcutManager=this.Vwa=null;this.xpf=x.EwaSettings.jc();this.Mza=x.EwaSettings.isChangeGateEnabled("OfficeVSO:7694407_CopyPasteWFEIncreasedLimits");this.vog=null;this.uab=!1;this.Wzd=x.EwaSettings.isChangeGateEnabled("OfficeVSO:6660890_Tag_aoi75RetryLoggingFix3");this.tUe=()=>{var hc,Cc;let Wb=null===(hc=this.Vwa)||void 0===
hc?void 0:hc.$pc;null===(Cc=this.Vwa)||void 0===Cc||!Cc.Stf()||M.R(P.h(this.$).ga.pa.selectedRanges,this.Vwa.rqc)||M.R([P.h(this.$).ga.pa.activeCell],[Wb.activeCell])&&!P.h(this.$).ga.pa.Sd.isSingle||(this.Vwa.cla(),this.Vwa=null)};this.fKd=hc=>{this.WTj(hc)&&(this.wo.ykc(),e.ULS.sendTraceTag(537167777,0,50,"CopyPasteInfrastructure.OnMetadataChanged: found that cut/copy operation was preformed in another session therefore removed the highlight in this session."))};this.dSi=(hc,Cc)=>{e.ULS.sendTraceTag(537167768,
0,50,`CopyPasteInfrastructure.LogShortcutDialogAndRestoreFocus: Got shortcut dialog, user pressed [${hc}]. userPressedExtensionLink=${Cc}`);this.gridView.focus()};this.ee=(hc,Cc)=>{Cc.HO||Cc.Ag||this.Hs("OnWorkbookOpened",!1).catch(()=>{})};this.tk=(hc,Cc)=>{hc=R(this.FJ);const Wb=this.wo.j8a(hc);Wb&&(Cc.na&&Cc.na.sheetName===Wb.sheetName&&Wb.isFromCurrentSession(this.$)?this.wo.Lkf(Wb.ranges,hc.commandParameters.commandType):this.wo.ykc())};this.Xuc=(hc,Cc)=>{hc=R(this.FJ);(hc=this.wo.j8a(hc))&&
Cc.item&&Cc.item.sheetName===hc.sheetName&&hc.isFromCurrentSession(this.$)&&this.Hs("OnItemDeleting",!1).catch(()=>{})};this.TBa=(hc,Cc)=>{this.xpf?this.vog(hc,Cc):this.oSf()};this.dT=(hc,Cc)=>{1===Cc.Yr&&Cc.Cg.operation.flags&2&&this.Hs("OnQueueItemChanged/ItemRemoved",!1).catch(()=>{})};this.$=$a;this.pg=Ta;this.gridView=P.h($a);this.wo=Rb;this.kwi=jc;this.FJ=Y;this.kwb=Bb;this.getStringifiedError=Mb||copyPasteInfra.getStringifiedError;this.Khg=1===bb;this.vj();this.copyPasteShortcutDialogFactory=
this.$.da.Ba(85);e.ULS.shipAssertTag(537167825,0,!!this.copyPasteShortcutDialogFactory,"CopyPasteInfrastructure.ctor: this.copyPasteShortcutDialogFactory shouldn't be null.");vc||(e.ULS.sendTraceTag(537167824,0,50,"CopyPasteInfrastructure.ctor: userId is null, using default userId."),vc=Ab.Dvh);this.userHash=d.a.Av(vc);this.hWi="CultureTag: "+z.a.instance.rbc+" HASH: ";this.FJ.addMetadataChangeListener(Ab.LEf,this.fKd);this.ZUi=ea.a.UIb;this.aBa=this.Mza?x.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.CopyPasteHtmlImportMaxLength",
this.$.xa.CopyPasteMaxPayloadLength):m.a.aBa;(this.Xo=x.EwaSettings.isChangeGateEnabled("OfficeVSO:7568646_PressEnterToPaste"))&&$a.da.Qb(478,hc=>{this.pasteShortcutManager=hc});this.xpf&&(this.vog=Ma.b(()=>{this.oSf()},1,this.$.ka,"CopyPasteInfrastructure.OnStartEditInternal",!0))}Fcc(){var $a=R(this.FJ);return $a?($a=$a.sourceItem)&&!$a.isFromCurrentSession(this.$)?(e.ULS.sendTraceTag(537167778,0,50,"CopyPasteInfrastructure.DoesClipboardHaveCopiedOrCutContent: Last copy/cut operation was from a different session."),
!1):!0:!1}get pasteIndicationManager(){return this.$.da.Ba(373)}DYg($a){this.addHandler(Ab.bLd,$a)}wzj($a){this.removeHandler(Ab.bLd,$a)}copy($a){$a.stopwatch=this.$.yc.Fd("UserAction",D.b().uk($a.ribbonCommandInfo.command)+"ClientSide");if(this.Xo){const jc=Ja.GetServiceTaskFactory.Za(this.$.da,478,479,0);Ba.TaskExtensions.za(jc,()=>{this.pasteShortcutManager=jc.result},this.ka,3)}const Y=!!R(this.FJ);x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!h.a.wC&&
(this.uab=!1);this.Hs("Copy/before/"+l.a[$a.ribbonCommandInfo.method],!1,void 0,!0,$a.copyPasteTargetType).catch(()=>{});var Ta=-1985798686===$a.ribbonCommandInfo.command;if(1===this.gridView.rf&&(Ta=this.wo.Opf(this.gridView.ga.pa.selectedRanges,Ta),0!==Ta)){const jc=Ab.vkh(Ta);this.kCa(jc,L[Ta],!1);return Promise.reject(!1)}$a.userHash=this.userHash;$a.id=k.a.create().toString();let Bb=this,Rb=this;return this.kwb.onCopy($a).then(jc=>{jc.isAsyncCopy||$a.stopwatch.stop();Bb.pasteIndicationManager.EVe();
const vc=za.d($a);e.ULS.sendTraceTag(24150883,0,50,`CopyPasteInfrastructure.OnCopy: Copy operation finished successfully. ${vc}`);Bb.WPi(jc,Y);jc=x.EwaSettings.isChangeGateEnabled("OfficeVSO:6591921_CheckTargetTypeForEnterToPaste")?1===$a.copyPasteTargetType:!0;!$a.isFormatPainter&&Bb.Xo&&jc&&(Bb.pasteShortcutManager?Bb.pasteShortcutManager.lDh():e.ULS.shipAssertTag(537167823,0,!1,"Copy: pasteShortcutManager is null."));return Promise.resolve(!0)},jc=>{let vc=!1,bb="none",Mb=Ab.sxb,hc=!0,Cc=-1,Wb=
Ab.copyErrorName+Ab.AMa,mc=!1,Mc=null;if(jc){Mc=jc.copyContext;Cc=jc.reason;Wb+=Ab.TNa(jc);jc.message&&(Mb=jc.message);var hd=Ab.ukh(jc);if(hd)if(3===hd.copyErrorName)vc=!0,Mb=bb="Async Copy canceled by the user.",hc=!1;else if(Oa.a.Iq(hd.ewaErrors))if(Mb=Rb.whc(hd.ewaErrors),Oa.a.Ph(hd.ewaErrors,Ab.operationSucceededWithAlert))mc=vc=!0;else if(Oa.a.Ph(hd.ewaErrors,Ab.pasteDataLimitHit)||Oa.a.Ph(hd.ewaErrors,Ab.copyThrottlingError))vc=!0;13===jc.reason?(vc=!0,hc=!1):11===jc.reason&&(hc=!1)}hd=jc?
Rb.getStringifiedError(jc):"null";vc?(hd=za.d($a),e.ULS.sendTraceTag(36304157,0,15,`CopyPasteInfrastructure.OnCopy: Copy operation failed with an expected error. clearStateNeeded: ${hc}, Friendly message: ${bb}, Error Message: ${Mb}, CommandParameters: ${hd}`)):e.ULS.sendTraceTag(24150912,0,10,`CopyPasteInfrastructure.OnCopy: Copy operation failed with an unexpected error. clearStateNeeded: ${hc}, Error Message: ${hd}, CommandParameters: ${za.d($a)}`);hc&&Rb.Hs("Copy/fail/"+l.a[$a.ribbonCommandInfo.method],
!0,void 0,void 0,$a.copyPasteTargetType).catch(()=>{});Rb.VPi($a,vc,Mb,Wb,Cc,mc,Mc);return Promise.reject(jc)})}gij($a){if(this.Fcc())return U.a(this.Mlc($a.commandType,$a.ribbonCommandInfo));let Y;Y=M.d(this.gridView.ga.pa.selectedRanges);$a.originalDestinations=Y;$a.expandDestinations=this.M7b($a.originalDestinations,$a.commandType);if(this.W7b($a.commandType,$a.expandDestinations)||this.vHe())$a.userHash=this.userHash,$a.id=k.a.create().toString(),this.kwb.onPaste($a).then(()=>Promise.resolve(!0),
Ta=>Promise.reject(Ta));return Promise.resolve(!0)}g5i($a){if($a.method){var Y={};Y.activeCell=this.gridView.ga.pa.activeCell;var Ta=new lb(this.$,M.d(this.gridView.ga.pa.selectedRanges),M.d(this.gridView.ga.pa.selectedRanges),Y);Y=Rb=>{const jc=Ja.GetServiceTaskFactory.Za(this.$.da,406,405,0);Ba.TaskExtensions.za(jc,()=>{$a.method&&Rb(jc.result)},this.ka,8)};var Bb=Rb=>{Rb.JEe(Ta);Rb.ojg($a.method);this.Vwa=Rb};this.Vwa?Bb(this.Vwa):Y(Bb)}}paste($a){$a.stopwatch=this.$.yc.Fd("UserAction",D.b().uk($a.ribbonCommandInfo.command)+
"ClientSide");x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!h.a.wC&&(e.ULS.sendTraceTag(537167822,0,50,"CopyPasteInfrastructure.OnPaste: Cross-app shadow workbook paste is enabled"),this.uab=!1,$a.clipboardPicklingApiDataFormatsToRead=[I.shadowWorkbook]);P.h(this.$).Mh&&P.h(this.$).Mh.e3(this.tod($a.ribbonCommandInfo.command),$a.stopwatch.id);if($a.isPasteCommandFromRecoveryUI){var Y=this.$.da.Ba(406);var Ta=M.d(Y.rqc);Y=Y.$pc;$a.pasteRecoveryCachedClipboardItems=
Y?Y[Ab.yVf]:null}else Ta=M.d(this.gridView.ga.pa.selectedRanges);$a.originalDestinations=Ta;$a.expandDestinations=this.M7b($a.originalDestinations,$a.commandType);if(this.W7b($a.commandType,$a.expandDestinations)||this.vHe())return $a.userHash=this.userHash,$a.id=k.a.create().toString(),x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PerfImpactExperimentForAsyncApi",!1)&&!h.a.wC&&($a.clipboardReadPermissionPromptShown=!1,$a.clipboardAsyncApiDataFormatsToRead=[I.plainText+"Async"],this.kwb.shouldShowClipboardReadPermissionDialog().then(Bb=>
{Bb&&($a.clipboardReadPermissionPromptShown=!0,new y(this.$));return Promise.resolve(!0)},()=>Promise.resolve(!0))),this.kwb.onPaste($a).then(Bb=>this.xvc(Bb,$a),Bb=>this.jLb($a,Bb));this.$.Ed(927125067,oa.a.fc,30,null);Ta=M.i($a.expandDestinations,",",this.$,!1);e.ULS.sendTraceTag(24150913,0,15,`CopyPasteInfrastructure.OnPaste: paste was triggered but the estimated destination range is not editable, do nothing. ExpandDestinations: ${Ta}, CommandType: ${$a.commandType}, copyPasteTargetType="${$a.copyPasteTargetType}"`);
return Promise.resolve(!0)}tod($a){switch($a){case 1804571062:return 6;case -185374993:return 7;case 1766348718:return 8;case -875588320:return 19;default:return 3}}vHe(){return!!P.h(this.$).ga.Sa.activeFloatingObjectControlId&&this.$.xt(null,!1,470)}lbb(){const $a=R(this.FJ);return $a&&$a.commandParameters?$a.commandParameters.copyPasteTargetType:0}mEi(){return!!R(this.FJ)&&la(R(this.FJ),this.$)}Hs($a,Y,Ta=!1,Bb=!1,Rb=0){try{this.Xo&&this.pasteShortcutManager&&this.pasteShortcutManager.Ybc();let jc=
Rb;const vc=this.ZLi();if(!Bb&&2===vc)return e.ULS.sendTraceTag(537167821,0,50,`CopyPasteInfrastructure.ClearState clipboard won't be cleared as there's art in the clipboard. clearClipboardContent = '${Y}', isExplicit = '${Ta}', isForce = '${Bb}', Current CCP operation copyPasteTargetType = '${Rb}', LastCopyPasteTargetType = '${vc}'`),Promise.reject(null);0===jc&&(jc=vc);const bb=this.$.yc.Fd("UserAction","ClearCopyState"),Mb=bb.id;e.ULS.sendTraceTag(537167820,0,50,`CopyPasteInfrastructure.ClearState clear clipboard state. clearClipboardContent = '${Y}', isExplicit = '${Ta}', isForce = '${Bb}', Current CCP operation copyPasteTargetType = '${Rb}', LastCopyPasteTargetType = '${vc}'`);
this.wo.ykc();this.cqj();return this.kwb.onCancelCopy(Y).then(()=>{Y&&x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!h.a.wC&&(this.uab=!1);bb.stop();this.gAf($a,Mb,!0,Ta,Y,"","",bb.vd,jc);return Promise.resolve(!0)},hc=>{var Cc=hc?this.getStringifiedError(hc):"null";e.ULS.sendTraceTag(24150915,0,15,`CopyPasteInfrastructure.ClearState: error during call to copyPasteFlowManager.OnClear(). error: ${Cc}`);bb.stop();Cc=Ab.ubh+Ab.AMa;let Wb=Ab.sxb;hc&&(Cc+=
Ab.TNa(hc),hc.message&&(Wb=hc.message));this.gAf($a,Mb,!1,Ta,Y,Wb,Cc,bb.vd,jc);return Promise.reject(hc)})}catch(jc){return Promise.reject(null)}}$8c($a,Y,Ta=!1,Bb=!1,Rb=0){return Bb||this.Fcc()?this.Hs($a,Y,Ta,Bb,Rb):(e.ULS.sendTraceTag(537167819,0,50,"CopyPasteInfrastructure.ClearStateOnlyIfClipboardHasContentFromSameSession clipboard won't be cleared as there is no content in the clipboard from the current session"),Promise.reject(null))}kCa($a,Y,Ta){e.ULS.sendTraceTag(590705172,0,50,`CopyPasteInfrastructure.PopupDiscontinuousSelectionErrorDialog: Blocked CCP due to discontinuous selection, reason: ${Y}`);
const Bb=new X.a;Bb.ia("reason",Y);Ia.a(Ua.a.discontinuousSelectionBlocking,[Ta?Sa.a.Ihj:Sa.a.rlh],!0,!0,!1,!1,Bb);$a=Oa.a.Wd(1,1,751,$a,0,371863010,"DiscontinuousSelectionBlocking");x.EwaSettings.Fz()?new ta.a(this.$,$a):($a=new fa.ErrorDialog(this.$,$a),$a.initialize(),$a.ah())}ZLi(){const $a=R(this.FJ);return $a&&$a.sourceItem?Object.getType($a.sourceItem)===G?2:1:0}dragDropCells($a,Y,Ta,Bb,Rb=!1){$a.stopwatch=this.$.yc.Fd("UserAction","DragDropClientSide");$a.isDragDrop=!0;this.Hs("DragDrop/before/"+
l.a[$a.ribbonCommandInfo.method],!1,void 0,void 0,$a.copyPasteTargetType).catch(()=>{});const jc=Rb?2:1;let vc=0;vc=Rb?4:Bb?256:128;const bb={encounteredDeploymentErrors:!1};bb.commandParameters=$a;$a.userHash=this.userHash;$a.id=k.a.create().toString();return this.Wzd?this.wo.pasteRange($a.ribbonCommandInfo,M.q(Y,this.$),M.q(Ta,this.$),jc,vc,[$a.stopwatch],bb,!1,()=>{e.ULS.sendTraceTag(537167818,0,50,`CopyPasteInfrastructure.DragDropCells: success. copyPasteTargetType="${$a.copyPasteTargetType}"`);
this.Gbb($a,jc,Y,Ta,bb)},Mb=>{this.ddb(Mb,$a,jc,Y,Ta,bb)}).then(()=>{this.gridView.ga.selectionType=-1;return Promise.resolve(!0)},Mb=>Promise.reject(Mb)):this.wo.pasteRange($a.ribbonCommandInfo,M.q(Y,this.$),M.q(Ta,this.$),jc,vc,[$a.stopwatch],bb,!1,null,null).then(()=>{e.ULS.sendTraceTag(521410075,0,50,`CopyPasteInfrastructure.DragDropCells: success. copyPasteTargetType="${$a.copyPasteTargetType}"`);this.gridView.ga.selectionType=-1;this.Gbb($a,jc,Y,Ta,bb);return Promise.resolve(!0)},Mb=>{this.ddb(Mb,
$a,jc,Y,Ta,bb);return Promise.reject(Mb)})}LAh($a,Y,Ta,Bb,Rb=!1){$a.stopwatch=this.$.yc.Fd("UserAction","DragDropReplaceClientSide");$a.isDragDrop=!0;this.$8c("DragDropReplace/before/"+l.a[$a.ribbonCommandInfo.method],!1,void 0,void 0,$a.copyPasteTargetType).catch(()=>{});const jc=Rb?2:1;let vc=0;vc=Rb?4:Bb?256:128;const bb={encounteredDeploymentErrors:!1};bb.commandParameters=$a;x.EwaSettings.getBooleanFeatureGate(ea.a.Icc,!1)&&($a.isDragInsert=!1);$a.userHash=this.userHash;$a.id=k.a.create().toString();
return this.Wzd?this.wo.pasteRange($a.ribbonCommandInfo,M.q(Y,this.$),M.q(Ta,this.$),jc,vc,[$a.stopwatch],bb,!1,()=>{e.ULS.sendTraceTag(537167816,0,50,`CopyPasteInfrastructure.DragDropReplaceCells: success. copyPasteTargetType="${$a.copyPasteTargetType}"`);this.Gbb($a,jc,Y,Ta,bb)},Mb=>this.ddb(Mb,$a,jc,Y,Ta,bb)).then(()=>{this.gridView.ga.selectionType=-1;return Promise.resolve(!0)},Mb=>Promise.reject(Mb)):this.wo.pasteRange($a.ribbonCommandInfo,M.q(Y,this.$),M.q(Ta,this.$),jc,vc,[$a.stopwatch],bb,
!1,null,null).then(()=>{e.ULS.sendTraceTag(521410073,0,50,`CopyPasteInfrastructure.DragDropReplaceCells: success. copyPasteTargetType="${$a.copyPasteTargetType}"`);this.gridView.ga.selectionType=-1;this.Gbb($a,jc,Y,Ta,bb);return Promise.resolve(!0)},Mb=>{this.ddb(Mb,$a,jc,Y,Ta,bb);return Promise.reject(Mb)})}KAh($a,Y,Ta,Bb,Rb=!1){$a.stopwatch=this.$.yc.Fd("UserAction","DragDropInsertClientSide");this.$8c("DragDropInsert/before/"+l.a[$a.ribbonCommandInfo.method],!1,void 0,void 0,$a.copyPasteTargetType).catch(()=>
{});const jc=Rb?2:1,vc=M.L(this.M7b([Ta],jc));var bb=this.$.ea.na.sheetName;const Mb=this.$.ea.na.sheetName,hc=M.v(Y,this.$);hc.SheetName=bb;bb=M.v(vc,this.$);bb.SheetName=Mb;Bb=vc.isRow||Y.isRow||Bb?1:0;const Cc={encounteredDeploymentErrors:!1};$a.isDragInsert=!0;Cc.commandParameters=$a;$a.userHash=this.userHash;$a.id=k.a.create().toString();if(this.Wzd)return Rb=this.wo.NVe(Cc,hc,bb,Rb,Bb,$a.ribbonCommandInfo,()=>{e.ULS.sendTraceTag(537167814,0,50,`CopyPasteInfrastructure.DragDropInsertCells: success. copyPasteTargetType="${$a.copyPasteTargetType}"`);
this.Gbb($a,jc,Y,Ta,Cc)},mc=>{this.ddb(mc,$a,jc,Y,Ta,Cc)}),U.d(Rb.then(()=>{this.gridView.ga.selectionType=-1;return Promise.resolve(!0)},mc=>Promise.reject(mc))).Mq(()=>!0);Rb=this.wo.NVe(Cc,hc,bb,Rb,Bb,$a.ribbonCommandInfo,null,null);let Wb=this;return U.d(Rb.then(()=>{e.ULS.sendTraceTag(521410071,0,50,`CopyPasteInfrastructure.DragDropInsertCells: success. copyPasteTargetType="${$a.copyPasteTargetType}"`);this.gridView.ga.selectionType=-1;this.Gbb($a,jc,Y,Ta,Cc);return Promise.resolve(!0)},mc=>
{Wb.ddb(mc,$a,jc,Y,Ta,Cc);return Promise.reject(mc)})).Mq(()=>!0)}Mlc($a,Y,Ta,Bb,Rb,jc){var vc=R(this.FJ);if(!vc)return e.ULS.sendTraceTag(537167812,0,50,"InsertCopiedCutCells: CopyContext must not be null or undefined"),ca.Task.Ua(!1);if(!B(vc.sourceItem))return e.ULS.sendTraceTag(537167811,0,50,"InsertCopiedCutCells: CopyContext must be a Range"),ca.Task.Ua(!1);var bb=vc.sourceItem;if(!bb)return e.ULS.shipAssertTag(537167810,0,!!bb,"InsertCopiedCutCells: rangeSourceItem must not be null or undefined"),
ca.Task.Ua(!1);if(!bb.isFromCurrentSession(this.$)&&!ea.a.cQa)return e.ULS.sendTraceTag(537167809,0,50,"InsertCopiedCutCells: rangeSourceItem is from a different session"),ca.Task.Ua(!1);if(1<bb.ranges.length)return e.ULS.sendTraceTag(537167808,0,50,"InsertCopiedCutCells: multiple source ranges are not supported"),this.kCa(2192,"InsertCopiedCutCells",!0),ca.Task.Ua(!1);vc=M.L(bb.ranges);var Mb=this.gridView.ga.pa.Sd.clone();$a=M.L(this.M7b([Mb],$a));const hc=this.Nxf();bb=bb.sheetName;Mb=this.$.ea.na.sheetName;
const Cc=M.v(vc,this.$);Cc.SheetName=bb;const Wb=M.v($a,this.$);Wb.SheetName=Mb;bb=this.gridView.ga.pa.activeRange;const mc=()=>{e.ULS.sendTraceTag(508929747,0,50,"InsertCopiedCutCellsCrossSession Succeeded")},Mc=()=>{e.ULS.sendTraceTag(508929746,0,50,"InsertCopiedCutCellsCrossSession Failed")};return($a.uh||vc.uh||x.EwaSettings.isChangeGateEnabled("OfficeVSO:7578311_InsertCopiedCutCellsDefaultShiftInTable")&&this.wo.PVj(this.$,vc,bb)?ca.Task.Ua(0):$a.isRow||vc.isRow||x.EwaSettings.isChangeGateEnabled("OfficeVSO:7578311_InsertCopiedCutCellsDefaultShiftInTable")&&
this.wo.QVj(this.$,vc,bb)?ca.Task.Ua(1):this.kwi.M$b(this.$,P.h(this.$).rtl)).Mq(hd=>!this.Fcc()&&ea.a.cQa?this.wo.executeInsertCopiedCutCellsAcrossSession(Cc,Wb,hc,hd.result,Y,mc,Mc,Ta,Bb,Rb,jc):this.wo.executeInsertCopiedCutCellsOperation(Cc,Wb,hc,hd.result,Y,null,null)).continueWith(()=>{!x.EwaSettings.isChangeGateEnabled("OfficeVSO:7646005_InsertCopiedCutCellsClearState")&&hc?this.wo.ykc():this.Hs("InsertCopiedCutCells/success/"+l.a[Y.method],!0)})}wFb(){const $a=R(this.FJ),Y=this.gridView.ga.pa.Vh;
return!!$a&&B($a.sourceItem)&&Y&&1===$a.sourceItem.ranges.length}Nxf(){return this.Oxf(-911352779)}wzd(){var $a,Y;const Ta=R(this.FJ);return Ta?(null===($a=Ta.asyncClipboardItemsKeys)||void 0===$a?void 0:$a.includes(I.shadowWorkbook))||(null===(Y=Ta.syncClipboardItemsKeys)||void 0===Y?void 0:Y.includes(I.shadowWorkbook))||3!==Ta.copyStatus:!1}qqc(){return this.Oxf(-1985798686)}W7b($a,Y){var Ta=new Fa.a(this.$.ua),Bb=36===$a;const Rb=Ta.He(4);$a=2===this.lbb()&&Ta.He(1);Bb=Bb&&Rb;Ta=!Ta.ki||!this.qqc()||
!Fa.a.vcc(Y,P.h(this.$));return Bb||$a||this.$.xt(Y,!0)&&Ta}kFb($a,Y){return this.wo.kFb($a,Y)}dispose(){super.dispose();this.xj();this.FJ.removeMetadataChangeListener(Ab.LEf)}oed($a,Y,Ta,Bb,Rb,jc){if(!this.pfh($a.commandParameters.ribbonCommandInfo.command))return $a.cseStatus=2,!1;if(jc&&Y.Yd(Bb))return $a.cseStatus=4,!1;if(Ta!==Rb)return $a.cseStatus=6,!1;if(x.EwaSettings.isChangeGateEnabled("OfficeVSO:5593878_PasteCSE_CCPErrorTests")&&(Bb.width%Y.width||Bb.height%Y.height))return $a.cseStatus=
16,!1;if(x.EwaSettings.getBooleanFeatureGate(ea.a.hRe,!1)){if(Ta=Y,Bb=Bb.ff(this.gridView.sk),Y=null===Y.ff(this.gridView.sk),Rb=$a.commandParameters.ribbonCommandInfo.command,Y&&1804571062!==Rb&&-185374993!==Rb||!Bb)return $a.cseStatus=7,!1}else if(Ta=Y.ff(this.gridView.sk),Bb=Bb.ff(this.gridView.sk),!Ta||!Bb)return $a.cseStatus=7,!1;if(ea.a.REe){Y=this.QEe(this.gridView,$a.commandParameters.ribbonCommandInfo.command,Ta,wb.source);if(0!==Y)return $a.cseStatus=Y,!1;Y=this.QEe(this.gridView,$a.commandParameters.ribbonCommandInfo.command,
Bb,wb.destination);if(0!==Y)return $a.cseStatus=Y,!1}Y=M.v(Ta,this.$);Y=this.pg.Nhj(this.gridView,Y,M.v(Bb,this.$),$a.commandParameters.ribbonCommandInfo.command,$a.commandParameters.stopwatch);1===Y&&(jc&&(this.pg.R8c(Ta,!1),this.pg.R8c(Ta,!0)),jc=new ma($a.commandParameters.ribbonCommandInfo.command,Bb,Ta),P.h(this.$).y_f(jc),this.pasteIndicationManager.Akc($a.commandParameters.id),this.sQb($a.commandParameters.expandDestinations,$a.commandParameters.isPasteCommandFromRecoveryUI),this.Z8c("DoPasteClientEstimation/"+
l.a[$a.commandParameters.ribbonCommandInfo.method],$a));$a.cseStatus=Y;return 1===Y}QEe($a,Y,Ta,Bb){const Rb=new ra.a("CopyPasteInfrastructure.blockCseForPaste",$a,Ta);try{for(;Rb.moveNext();){let jc=Rb.get_current().cell;if(jc.LA)return 8;if(237279923===Y||-185374993===Y){if(jc.iU&&x.EwaSettings.isChangeGateEnabled("OfficeVSO:7148128_BlockWrapTextCseForPaste"))return 18;if(jc.pO&&x.EwaSettings.isChangeGateEnabled("OfficeVSO:7327017_BlockCondFormattingForPaste"))return 19}if(Bb===wb.source){if(jc.uea)return 23;
if(jc.Kzd)return 24;if(jc.hasIgnorableError)return 25;if((237279923===Y||1804571062===Y)&&this.AGi($a,Ta))return 20;if(237279923===Y){if(jc.Xma)return 22;if(jc.hasHyperlink||jc.Kna)return 21}}}}finally{Rb&&Rb.dispose()}return 0}OWf(){this.copyPasteShortcutDialogFactory.create(this.$).showDialog(!0,!1,!1,this.dSi)}IRi($a,Y,Ta,Bb){$a=H($a,Y,Ta,Bb,this.$.xa.UserSessionId);$a.k=!0;D.b().Of(45,$a,!0)}xaj($a,Y,Ta,Bb,Rb){var jc=!1,vc=!1,bb=Ab.sxb,Mb=Ab.GVe+Ab.AMa;$a&&(Mb+=Ab.TNa($a),Oa.a.Iq($a.ewaErrors)?
(bb=this.whc($a.ewaErrors),Oa.a.Ph($a.ewaErrors,[-103190598])&&(jc=!0)):$a.message&&(bb=$a.message));vc||(vc=this.Uwd($a));Y=H(Y,Ta,Bb,Rb,this.$.xa.UserSessionId);Y.k=!1;Y.l=vc;Y.n=bb;Y.p=Mb;Y.q=jc;D.b().Of(45,Y,!0);return Promise.reject($a)}AGi($a,Y){const Ta=$a.Bj("CopyPasteInfrastructure.isRangeWithBottomOrRightBorder",new v.Range(Y.top,Y.right,Y.bottom,Y.right,!0,!0));for(;Ta.$$mn();){let Bb=Ta.$$cu();if(Bb&&Bb.Uya())return e.ULS.sendTraceTag(509436432,0,50,"CopyPasteInfrastructure.ShowInstantaneousFormattingFromRange: no instantaneous."),
!0}for($a=$a.Bj("CopyPasteInfrastructure.isRangeWithBottomOrRightBorder",new v.Range(Y.bottom,Y.left,Y.bottom,Y.right,!0,!0));$a.$$mn();)if((Y=$a.$$cu())&&Y.Qya())return e.ULS.sendTraceTag(509436431,0,50,"CopyPasteInfrastructure.ShowInstantaneousFormattingFromRange: no instantaneous."),!0;return!1}d4g($a,Y,Ta){$a.cseStatus=0;$a.cseStatus=this.$Bi($a.commandParameters.ribbonCommandInfo.command,Ta,this.gridView,Y);if(0!==$a.cseStatus)return!1;$a.cseStatus=this.pg.Ohj(this.gridView,Y,Ta,$a.commandParameters.stopwatch);
Y=new ma($a.commandParameters.ribbonCommandInfo.command,Ta,null);1===$a.cseStatus&&(P.h(this.$).y_f(Y),this.pasteIndicationManager.Akc($a.commandParameters.id),this.sQb($a.commandParameters.expandDestinations,$a.commandParameters.isPasteCommandFromRecoveryUI),this.Z8c("AttemptExternalPlainTextPasteClientEstimation/"+l.a[$a.commandParameters.ribbonCommandInfo.method],$a));return 1===$a.cseStatus}$Bi($a,Y,Ta,Bb){if(-875588320!==$a&&-185374993!==$a&&237279923!==$a)return 2;if(Ta.Wb.fQa(Y))return 8;if(Ta.Wb.JAd(Y))return 18;
if(Ta.Wb.jX(Y))return 11;if(this.pg.nVe(Y))return 12;$a=this.U$g(Y,Bb);return P.j(this.gridView,$a)?0:7}U$g($a,Y){var Ta=Y.indexOf("\r");Ta=-1!==Ta?"\n"===Y[Ta+1]?Y.split("\r\n"):Y.split("\r"):Y.split("\n");Y=Ta.length;Ta=Ta[0].split("\t").length;return new v.Range($a.top,$a.left,$a.top+Y-1,$a.left+Ta-1,!0,!0)}pfh($a){switch($a){case 237279923:case 808159687:return x.EwaSettings.isChangeGateEnabled("OfficeVSO:7317055_PasteCse");case -185374993:return!0;case 1804571062:return!0;default:return!1}}Oxf($a){const Y=
R(this.FJ);if(!Y)return!1;const Ta=Y.sourceItem;return ea.a.cQa||!Ta||Ta.isFromCurrentSession(this.$)?Y.commandParameters.ribbonCommandInfo.command===$a:(e.ULS.sendTraceTag(537167779,0,50,"CopyPasteInfrastructure.LastOperationWasCopyCut: Last copy operation was from a different session."),!1)}WTj($a){return $a&&$a.lastCopy?la($a.lastCopy,this.$):!0}p$e($a,Y,Ta,Bb,Rb){const jc={};jc.a=this.$.xa.UserSessionId;jc.e=$a.stopwatch.id;jc.c=D.b().uk($a.ribbonCommandInfo.command);jc.b=l.a[$a.ribbonCommandInfo.method];
jc.d=$a.id;jc.f=Ta.toString();jc.g=Bb.toString();jc.h=Y.toString();jc.o=$a.stopwatch.vd;jc.q=!1;jc.r=$a.copyPasteTargetType.toString();jc.s=Rb.encounteredDeploymentErrors;x.EwaSettings.getBooleanFeatureGate(ea.a.Icc,!1)&&(jc.i=Rb.commandParameters.dragDropIsShiftKeyDown,jc.j=Rb.commandParameters.isDragInsert);return jc}Gbb($a,Y,Ta,Bb,Rb){$a=this.p$e($a,Y,Ta,Bb,Rb);$a.k=!0;D.b().Of(45,$a,!0)}dQi($a,Y,Ta,Bb,Rb,jc,vc,bb,Mb){$a=this.p$e($a,Y,Ta,Bb,Mb);$a.k=!1;$a.l=Rb;$a.n=jc;$a.p=vc;$a.q=bb;D.b().Of(45,
$a,!0)}gAf($a,Y,Ta,Bb,Rb,jc,vc,bb,Mb){const hc={};hc.a=this.$.xa.UserSessionId;hc.b=Y;hc.c=$a;hc.f=Ta;hc.e=Bb;hc.d=Rb;hc.g=jc;hc.h=vc;hc.i=bb;hc.j=Mb.toString();D.b().Of(46,hc,!0)}WPi($a,Y){$a=this.M9e($a.commandParameters,$a);$a.l=!0;$a.j=Y;D.b().Of(43,$a,!0)}VPi($a,Y,Ta,Bb,Rb,jc,vc){$a=this.M9e($a,vc);$a.l=!1;$a.m=Y;$a.o=Ta;$a.y=Bb;$a.x=Rb;$a.z=jc;D.b().Of(43,$a,!0);e.ULS.sendTraceTag(537167776,0,15,`CopyPasteInfrastructure.LogCopyFailedTelemetry: ErrorName=${$a.y},ErrorReason=${$a.x},IsExpectedError=${$a.m},IsSucceededWithAlert=${$a.z},ErrorMessage=${$a.o}`)}M9e($a,
Y){const Ta={};Ta.a=this.$.xa.UserSessionId;Ta.f=$a.stopwatch.id;Ta.g=$a.id;Ta.c=D.b().uk($a.ribbonCommandInfo.command);Ta.b=l.a[$a.ribbonCommandInfo.method];Ta.q=$a.stopwatch.vd;Ta.bd=Ab.Jgc();Ta.bg=$a.copyPasteHandlerName;Ta.bj=void 0===$a.ribbonCommandInfo.Jf||null===$a.ribbonCommandInfo.Jf?null:u.a[$a.ribbonCommandInfo.Jf];Ta.bq=$a.uploadToClipService;Ta.br=$a.floatingObjectType;Ta.s=$a.copyPasteTargetType.toString();Ta.bc=xa($a.copyPasteTargetType);Ta.z=!1;if(Y){Ta.bk=Y.id;Ta.bl=Y.serverRequestTimeInMs;
Y.requestTelemetryData&&(Ta.bm=Y.requestTelemetryData.EcsOperationDuration,Ta.bn=Y.requestTelemetryData.EcsRequestDuration,Ta.bo=Y.requestTelemetryData.WfeRequestDuration);Ta.d=Y.sourceItem?Y.sourceItem.toString():null;Ta.e=-1;if(B(Y.sourceItem)){Ta.e=0;$a=Y.sourceItem.ranges;for(const Bb of $a)Ta.e+=Bb.Bw}Ta.h=Y.isAsyncCopy;Ta.i=Y.isFromCache;Ta.k=Y.isSelectionAllowed;Ta.r=Y.plainTextPayloadSize;Ta.u=Y.htmlPayloadSize;Ta.v=Y.htmlSizeExceedsLimit;Ta.w=Y.copyTotalSizeExceedsLimit;Ta.t=Y.shadowWorkbookPayloadSize;
Ta.p=Y.clientSideCopyTime;Ta.ba=Y.encounteredDeploymentErrors;Ta.bb=Y.shadowWorkbookSizeExceedsLimit;Ta.be=Y.syncClipboardItemsKeys;Ta.bf=Y.asyncClipboardItemsKeys;Ta.bh=this.WNe(Y.succeededPopulatingSystemClipboardSync);Ta.bi=this.WNe(Y.succeededPopulatingSystemClipboardAsync)}return Ta}sQb($a,Y=!1){if(!this.gridView.Ob&&!this.gridView.hj){var Ta=this.gridView.ga.pa,Bb=!Y&&1===$a.length&&M.R($a,Ta.selectedRanges),Rb=Bb?Ta.activeCell:$a[0].topLeft;$a[0].contains(Rb)||(e.ULS.shipAssertTag(537167775,
0,!1,`CopyPasteInfrastructure.SelectPastedRange: SelectedRanges ${Ta.selectedRanges}, IndexOfActiveRange ${Ta.Qr}, ActiveCell ${Ta.activeCell}, calculatedDestinationRanges ${$a}, keepThePreviousActiveCell ${Bb}, newActiveCell ${Rb}, isPasteCommandFromRecoveryUI ${Y}`),Rb=$a[0].topLeft);this.gridView.ga.wH($a,0,Rb,0,void 0,"CopyPasteInfrastructure.SelectPastedRange")}}Ucf($a,Y){const Ta={};Ta.a=this.$.xa.UserSessionId;Ta.g=$a.stopwatch.id;Ta.t=$a.stopwatch.vd;Ta.bz=!1;Y&&(Ta.bv=Y.id,Ta.bw=Y.serverRequestTimeInMs,
Ta.n=Y.commandParameters.clipboardFormatReadTimes,Ta.o=Y.commandParameters.clipboardFormatReadStatus,Ta.p=Y.commandParameters.clipboardReadPermissionPromptShown,Ta.q=Y.commandParameters.asyncApiReadTimedOut,Y.requestTelemetryData&&(Ta.cb=Y.requestTelemetryData.EcsOperationDuration,Ta.cc=Y.requestTelemetryData.EcsRequestDuration,Ta.cd=Y.requestTelemetryData.WfeRequestDuration));Ta.x=$a.copyPasteTargetType.toString();Ta.bl=xa($a.copyPasteTargetType);Ta.br=$a.copyPasteHandlerName;Ta.i=M.i($a.expandDestinations,
",",this.$,!1);Ta.h=M.i($a.originalDestinations,",",this.$,!1);Ta.e=$a.id;Ta.d=$a.commandType;Ta.c=D.b().uk($a.ribbonCommandInfo.command);Ta.b=l.a[$a.ribbonCommandInfo.method];Ta.bf=!1;Ta.bg=!1;Ta.bp=Ab.Jgc();Ta.bt=void 0===$a.ribbonCommandInfo.Jf||null===$a.ribbonCommandInfo.Jf?null:u.a[$a.ribbonCommandInfo.Jf];Ta.cj=$a.isPasteCommandFromEnterShortcut;if(Ta.ca=$a.isPasteCommandFromRecoveryUI)Ta.cf=$a.pasteRecoveryUndoStopwatch.id,Ta.cg=$a.pasteRecoveryUndoStopwatch.vd;if(Y){if(($a=Y.copyContextSnapshot)&&
!Y.wasLastCopyExternal){Ta.f=$a.commandParameters.id;Ta.j=$a.sourceItem.toString();Ta.k=-1;if(B($a.sourceItem)){Ta.k=0;const Bb=$a.sourceItem.ranges;for(const Rb of Bb)Ta.k+=Rb.Bw}Ta.bg=1===$a.commandParameters.commandType}else Y.clipboardItems?Ta.f=Y.clipboardItems.getItem(I.z4a):e.ULS.sendTraceTag(537167774,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext.ClipboardItems is null");Ta.bz=Y.pasteRecoveryUIDisplayed;Ta.ci=Y.cseStatus}else e.ULS.sendTraceTag(537167773,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext is null");
return Ta}pRi($a,Y,Ta,Bb,Rb,jc,vc,bb,Mb){$a=this.Ucf($a,bb);$a.l=!1;$a.m=Y;$a.s=Ta;$a.bc=Bb;$a.be=Rb;$a.bd=jc;$a.bf=vc;bb?($a.y=S(bb)||!bb.copyContextSnapshot,$a.bi=!$a.y&&la(bb.copyContextSnapshot,this.$),$a.bj=bb.shadowWorkbookSizeExceedsLimit,$a.v=bb.shadowWorkbookPayloadSize,$a.w=bb.htmlPayloadSize,$a.bq=wa(bb.clipboardItems),$a.bb=bb.activeSelectionType,$a.bs=bb.isSameSession,$a.bn=bb.payloadOrigin,$a.bo=bb.payloadType,$a.bu=bb.externalAppSource,$a.bx=bb.indicationDisplayScheduled,$a.by=bb.pasteIndicationDisplayStatus,
$a.ck=bb.pasteDestinationHasMergedCells):$a.bi=la(Mb,this.$);D.b().Of(44,$a,!0);e.ULS.sendTraceTag(537167772,0,15,`CopyPasteInfrastructure.LogPasteFailedTelemetry: ErrorName=${$a.be},ErrorReason=${$a.bd},IsExpectedError=${$a.m},IsSucceededWithAlert=${$a.bf},ErrorMessage=${$a.s}`)}qRi($a){const Y=this.Ucf($a.commandParameters,$a);Y.y=$a.wasLastCopyExternal;Y.l=!0;Y.u=$a.plainTextPayloadSize;Y.v=$a.shadowWorkbookPayloadSize;Y.w=$a.htmlPayloadSize;Y.z=$a.isClipboardDataContainShadowWorkbook;Y.ba=$a.isShadowWorkbookParsedSuccessfully;
Y.bb=$a.activeSelectionType;Y.bc=$a.pasteResult;Y.bh=$a.encounteredDeploymentErrors;Y.bj=$a.shadowWorkbookSizeExceedsLimit;Y.bk=K($a);Y.bq=wa($a.clipboardItems);Y.bs=$a.isSameSession;Y.bn=$a.payloadOrigin;Y.bo=$a.payloadType;Y.bu=$a.externalAppSource;Y.bx=$a.indicationDisplayScheduled;Y.by=$a.pasteIndicationDisplayStatus;Y.ck=$a.pasteDestinationHasMergedCells;Y.bm=$a.clipboardItems?$a.clipboardItems.getItem(I.ieh):null;Y.bi=!$a.isSameSession&&!$a.wasLastCopyExternal;Y.ci=$a.cseStatus;D.b().Of(44,
Y,!0)}vj(){ea.a.Zxb&&this.gridView.ga.WK(this.tUe);this.$.ua.Vg(this.tk);this.$.ua.KXg(this.Xuc);this.$.userOperationManager.zs(this.dT);this.$.$l(this.ee);P.h(this.$).Gc.ro(this.TBa)}xj(){this.$&&this.$.ua&&(ea.a.Zxb&&this.gridView.ga.GP(this.tUe),this.$.ua.xh(this.tk),this.$.ua.Oyj(this.Xuc));this.$&&this.$.userOperationManager&&this.$.userOperationManager.fp(this.dT);this.gridView&&this.gridView.Gc&&this.gridView.Gc.io(this.TBa)}jLb($a,Y){var Ta=null;let Bb=!1;var Rb=null;let jc="UnknownFailure",
vc=-1,bb=Ab.sxb,Mb=Ab.pasteErrorName+Ab.AMa,hc=!1;this.pasteIndicationManager.Akc($a.id);this.pasteDestinationHasMergedCells($a.expandDestinations)&&(Y.pasteContext.pasteDestinationHasMergedCells=!0);const Cc=R(this.FJ);($a.clearStateOnFinish||$a.clearSystemClipboard)&&this.Hs("Paste/fail/"+l.a[$a.ribbonCommandInfo.method],!0,void 0,void 0,$a.copyPasteTargetType).catch(()=>{});if(Y){vc=Y.reason;Mb+=Ab.TNa(Y);Y.message&&(bb=Y.message);if(Ta=Ab.Ikh(Y))if(1===Ta.pasteErrorName)Bb=!0,jc="CopyPasteLengthTooLongPopup",
bb=Rb="The pasted content is too long. Popup a dialog to the user.",e.ULS.sendTraceTag(25216992,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Rb}, copyPasteTargetType="${$a.copyPasteTargetType}"`),Ta=Oa.a.Wd(1,0,26,690,0,1306609195,"CopyPasteOversizeError"),x.EwaSettings.Fz()?new ta.a(this.$,Ta):(Ta=new fa.ErrorDialog(this.$,Ta),Ta.initialize(),Ta.ah());else if(7===Ta.pasteErrorName)Bb=!0,jc="No-Op",bb=Rb="The shadow workbook is not ready yet and an async copy failed to populate the clipboard. Do nothing (by the spec)",
e.ULS.sendTraceTag(33948251,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Rb}, copyPasteTargetType="${$a.copyPasteTargetType}"`);else if(8===Ta.pasteErrorName)Bb=!0,jc="UseShortcutsPopup",bb=Rb="Unable to paste content from the system clipboard. Popup dialog to the user.",e.ULS.sendTraceTag(25216994,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Rb}, copyPasteTargetType="${$a.copyPasteTargetType}"`),this.OWf();else if(18===Ta.pasteErrorName){Bb=!0;jc="PasteExternalNotSupportMultipleSelectionPopup";
bb="Paste external not support multiple selection.";Rb="Unknown";var Wb=2192;100!==Ta.validationFailureReason&&(Rb=hb[Ta.validationFailureReason],Wb=Ab.ONe(Ta.validationFailureReason));this.kCa(Wb,Rb,!0)}else 20===Ta.pasteErrorName||19===Ta.pasteErrorName?(Bb=!0,20===Ta.pasteErrorName?(jc="PasteAcrossSessionNotSupportMultipleSelectionPopup",bb="Paste across session does not support multiple selection."):(jc="PasteInSameSessionNotSupportMultipleSelectionPopup",bb="This kind of multiple selection is not supported for same session paste."),
Rb="Unknown",Wb=2192,100!==Ta.validationFailureReason&&(Rb=hb[Ta.validationFailureReason],Wb=Ab.ONe(Ta.validationFailureReason)),Ta=6===Ta.validationFailureReason,this.W7b($a.commandType,$a.expandDestinations)&&Ta&&this.sQb($a.expandDestinations),this.kCa(Wb,Rb,!0)):6===Ta.pasteErrorName?(Bb=!0,jc="No-Op",bb=Rb="Paste Formatting/Transpose is not yet a supported operation on System Clipboard based content",e.ULS.sendTraceTag(36263241,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Rb}, copyPasteTargetType="${$a.copyPasteTargetType}"`)):
17===Ta.pasteErrorName?(Bb=!0,jc="No-Op",bb=Rb="Paste text on Art is not yet a supported operation",e.ULS.sendTraceTag(0,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Rb}, copyPasteTargetType="${$a.copyPasteTargetType}"`)):16===Ta.pasteErrorName?(Bb=!0,jc="No-Op",bb=Rb="Paste has failed because the previous copy has failed",Ta=this.getStringifiedError(Ta),e.ULS.sendTraceTag(537167771,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Rb}, copyPasteTargetType="${$a.copyPasteTargetType}", error=${Ta}`)):
Oa.a.Iq(Ta.ewaErrors)?(Oa.a.Oba(Ta.ewaErrors)||Oa.a.Ph(Ta.ewaErrors,Oa.a.kjc())?(Bb=!0,jc="CommunicationError",Rb=Oa.a.Uc(Ta.ewaErrors),e.ULS.sendTraceTag(36304159,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${bb} copyPasteTargetType="${$a.copyPasteTargetType}"`)):Oa.a.Ph(Ta.ewaErrors,Ab.sHj)?(Bb=!0,jc="SavingWorkbookError",Rb=Oa.a.Uc(Ta.ewaErrors),e.ULS.sendTraceTag(36304160,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${bb} copyPasteTargetType="${$a.copyPasteTargetType}"`)):Oa.a.Ph(Ta.ewaErrors,
Ab.operationSucceededWithAlert)&&(hc=Bb=!0,jc="OperationSucceededWithAlert",Rb=Oa.a.Uc(Ta.ewaErrors),e.ULS.sendTraceTag(36304161,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${bb} copyPasteTargetType="${$a.copyPasteTargetType}"`)),Bb||(bb=this.whc(Ta.ewaErrors),Bb=this.Uwd(Y))):11===Ta.pasteErrorName&&(Bb=!0,jc="No-Op",bb="Paste has failed because user try copy cross-session oart object");15===Y.reason&&(Bb=!0,jc="No-Op",bb="Rejecting deferred paste there is metadata update without copy context. Usually it means that copy canceled before finished.");
pa.a.equals(Mb,E.kik,!1)&&(Bb=!0,jc="No-Op",bb="User hash of the copy is different then the user hash of the paste during cross-session copy-paste. Do nothing.")}Bb||(Ta=Y?this.getStringifiedError(Y):"null",e.ULS.sendTraceTag(24150916,0,10,`CopyPasteInfrastructure.OnPasteFailed: ${Ta}, copyPasteTargetType="${$a.copyPasteTargetType}"`));this.pRi($a,Bb,bb,jc,Mb,vc,hc,Y.pasteContext,Cc);return Promise.reject(Y)}xvc($a,Y){var Ta;e.ULS.sendTraceTag(24150917,0,50,`CopyPasteInfrastructure.OnPasteSuccess: paste succeed. copyPasteTargetType="${Y.copyPasteTargetType}"`);
this.pasteIndicationManager.Akc(Y.id);if(this.Thj(Y.copyPasteTargetType,$a)){x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!h.a.wC&&$a.wasLastCopyExternal&&$a.payloadType===aa.shadowWorkbook&&(this.uab=!0);let Bb=null;(null===(Ta=$a.pastedRange)||void 0===Ta?0:Ta.Ranges)&&0<$a.pastedRange.Ranges.length?Bb=M.g($a.pastedRange.Ranges):$a.wasLastCopyExternal||(Bb=Y.expandDestinations);this.jJj($a,Bb);if(this.lWj($a,Bb)){let Rb;Ta=M.d(Y.originalDestinations);
Rb=1028===Y.commandType?M.d(Y.expandDestinations):M.d(Bb);let jc=null;$a.wasLastCopyExternal&&(Y.isKeyboardEvent||Y.isPasteCommandFromRecoveryUI)&&(jc={[Ab.yVf]:$a.clipboardItems});this.pasteDestinationHasMergedCells(Y.expandDestinations)&&($a.pasteDestinationHasMergedCells=!0);$a.pasteRecoveryUIDisplayed=!0;const vc=new Ea(this.$,Ta,Rb,jc),bb=Ja.GetServiceTaskFactory.Za(this.$.da,406,405,0);Ba.TaskExtensions.za(bb,()=>{const Mb=bb.result;Mb.JEe(vc);Mb.ojg(Y.ribbonCommandInfo.method)},this.ka,8)}this.R3i($a,
Bb)}this.Z8c("Paste/success/"+l.a[Y.ribbonCommandInfo.method],$a);this.qRi($a);this.Khg&&(!Y.isKeyboardEvent||K($a))&&this.$.ea.Dh.get(66)&&(e.ULS.sendTraceTag(537167770,0,15,"CopyPasteInfrastructure.OnPasteSuccess: show localStorage disable notification"),this.Khg=!1,this.qmh());return Promise.resolve(!0)}R3i($a,Y){Ba.TaskExtensions.za(Ja.GetServiceTaskFactory.Za(this.$.da,534,535,1),Ta=>{Ta.result.r$j($a,Y)},this.$.ka,3)}lWj($a,Y){return!Y||1!==Y.length||$a.commandParameters.clearSystemClipboard||
$a.commandParameters.clearStateOnFinish||$a.commandParameters.skipClipboardAccess?!1:S($a)&&(Y=$a.clipboardItems.getItem(I.plainText),$a=$a.clipboardItems.getItem(I.html),void 0===Y||null===Y||Y.length>this.ZUi||void 0===$a||null===$a||$a.length>this.aBa)?(e.ULS.sendTraceTag(537167769,0,50,"CopyPasteInfrastructure.ShouldShowPasteRecoveryUI: Not showing PasteRecoveryUI for external copy."),!1):!0}Thj($a,Y){return 1===$a||Y.payloadType===aa.plainText||x.EwaSettings.ya(151)&&Y.payloadType===aa.html||
x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!h.a.wC&&Y.payloadType===aa.shadowWorkbook}pasteDestinationHasMergedCells($a){const Y=P.h(this.$).Ca.uz();if(!Y||!Y.length)return!1;for(const Ta of Y)if(Ta.Mv($a[0]))return!0;return!1}Z8c($a,Y){let Ta;({JKa:Ta}=this.kAi(Y)).returnValue&&this.Hs($a,Ta,void 0,void 0,Y.commandParameters.copyPasteTargetType).catch(()=>{})}ddb($a,Y,Ta,Bb,Rb,jc){const vc=$a?this.getStringifiedError($a):"null";let bb=!1,Mb=!1,hc=
!1,Cc=Ab.sxb,Wb=Ab.GVe+Ab.AMa;$a&&(Wb+=Ab.TNa($a),Oa.a.Iq($a.ewaErrors)?(Cc=this.whc($a.ewaErrors),Oa.a.Ph($a.ewaErrors,Ab.operationSucceededWithAlert)&&(bb=!0),Oa.a.Ph($a.ewaErrors,Ab.dragDropNonEmptyRange)&&(Mb=hc=!0)):$a.message&&(Cc=$a.message));hc||(hc=this.Uwd($a));Mb?this.gridView.ga.selectionType=-1:this.wo.$sj(Rb);hc||e.ULS.sendTraceTag(24150918,0,10,`CopyPasteInfrastructure.OnDragAndDropCellsFailed: ${vc}, copyPasteTargetType="${Y.copyPasteTargetType}`);this.dQi(Y,Ta,Bb,Rb,hc,Cc,Wb,bb,jc)}M7b($a,
Y){let Ta=$a;const Bb=this.j9h();if(null===Bb||void 0===Bb?0:Bb.ranges)Ta=this.wo.kah(Y,Bb.ranges,$a);return Ta}j9h(){const $a=R(this.FJ);return $a&&B($a.sourceItem)?$a.sourceItem:null}cqj(){this.raiseEvent(Ab.bLd,null)}jJj($a,Y){const Ta=$a.commandParameters.originalDestinations;Y&&(M.R(this.gridView.ga.pa.selectedRanges,Ta)?(this.sQb(Y),$a=fb.HelperMethods.rtb(Y),e.ULS.sendTraceTag(537167767,0,50,`CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range, range: ${$a}`)):$a.commandParameters.isPasteCommandFromRecoveryUI?
(this.sQb(Y,!0),e.ULS.sendTraceTag(537167766,0,50,`CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range for IsPasteCommandFromRecoveryUI, range: ${Y}, active cell: ${Y[0].topLeft}`)):($a=fb.HelperMethods.rtb(Ta),e.ULS.sendTraceTag(537167765,0,50,`CopyPasteInfrastructure.SelectPastedRangeIfNeeded: user change his selection during paste operation. don't change selection. originalPasteDestinations: ${$a}`)))}kAi($a){if($a.isPlainTextPaste||$a.isHtmlPaste||J($a)||$a.commandParameters.isPasteCommandFromEnterShortcut)return{returnValue:!0,
JKa:!1};var Y=$a.copyContextSnapshot;if($a.commandParameters.clearStateOnFinish)return{returnValue:!0,JKa:!0};if(Y&&B(Y.sourceItem)){var Ta=Y.sourceItem;if(!Ta.isFromCurrentSession(this.$))return{returnValue:!1,JKa:!0};Y=-1985798686===Y.commandParameters.ribbonCommandInfo.command;if(!(1<Ta.ranges.length||1<$a.commandParameters.expandDestinations.length)){const Bb=M.L(Ta.ranges);$a=M.L($a.commandParameters.expandDestinations);const Rb=this.$.ea.na.sheetName;Ta=Ta.sheetName;if(Ta===Rb&&$a.equals(Bb))return{returnValue:!1,
JKa:!0};if(Ta===Rb&&$a.ff(Bb))return{returnValue:!0,JKa:!1}}return{returnValue:Y,JKa:!0}}return{returnValue:!1,JKa:!0}}oSf(){var $a=R(this.FJ);($a=this.wo.j8a($a))&&$a.isFromCurrentSession(this.$)&&this.Hs("OnStartEdit",!1).catch(()=>{})}whc($a){$a=Oa.a.G5h($a,Ab.AMa);return this.hWi+d.a.Av($a).toString()}Uwd($a){$a=Ab.TNa($a);return!!$a&&pa.a.b6a($a,Ab.gWi)}qmh(){const $a=Oa.a.Wd(1,2,327,328,h.a.Wo?329:h.a.TG?330:331,530046625,"ActivateLocalStorage"),Y=Object(Va.b)("OfficeVSO:7811663_ConvertBusinessBarManagerService2")?
Object(U.d)(ob.a.resolve(ja.h,{Wa:0})):Ja.GetServiceTaskFactory.Za(this.$.da,5,4,0);Ba.TaskExtensions.za(Y,()=>{Y.result.oh(43,$a)},this.ka,3)}WNe($a){return void 0===$a||null===$a?ya.uZi:$a?ya.success:ya.failed}static Ikh($a){const Y=$a.innerError;return Y&&0!==Y.pasteErrorName?$a.innerError:null}static ukh($a){const Y=$a.innerError;return Y&&0!==Y.copyErrorName?$a.innerError:null}static TNa($a){let Y="";if(!$a)return Ab.rSe;$a.errorName&&(Y=$a.errorName,$a.innerError&&(Y+=Ab.AMa+Ab.TNa($a.innerError)));
Y||(Y=$a&&$a.name?$a.name:Ab.rSe);return Y}static Jgc(){Ab.Tb||(Ab.Tb=ia.O_j);return Ab.Tb}static ONe($a){switch($a){case 7:case 1:return 2199;case 5:return 2196;case 6:return 2195;case 8:case 3:case 2:case 4:case 9:case 10:return 2192;default:return e.ULS.shipAssertTag(537167764,0,!1,`CopyPasteInfrastructure.ConvertPasteValidationOptionToJsStringId: no case for validationOptions = ${$a}`),2199}}static vkh($a){switch($a){case 3:return 2193;case 1:return 2194;case 2:case 4:return 2192;default:return e.ULS.shipAssertTag(537167763,
0,!1,`CopyPasteInfrastructure.ConvertCopySourceValidationOptionToJsStringId: no case for validationOptions = ${$a}`),2199}}}Ab.LEf="EwaJsMetadataChangeListenerId";Ab.bLd="cpiOSC";Ab.Dvh="cpiDID";Ab.sxb="Unknown";Ab.rSe="UnknownError";Ab.AMa="_";Ab.GVe="DragAndDropError";Ab.pasteErrorName="PasteError";Ab.ubh="CancelError";Ab.copyErrorName="CopyError";Ab.gWi="MergedCellOverlap";Ab.yVf="PasteRecoveryCachedClipboardItems";Ab.sHj=[1352631530,1679665408];Ab.operationSucceededWithAlert=[-103190598];Ab.pasteDataLimitHit=
[1306609195];Ab.copyThrottlingError=[-386183710];Ab.dragDropNonEmptyRange=[563945982];Ab.Tb=null;Object(c.a)(Ab,"CopyPasteInfrastructure",w.a,[347,348,2]);class nb{constructor(){this.Y3a=this.HKe=null}}Object(c.a)(nb,"ClipboardPlatformInitializationResult",null,[]);var pb=a(198),cb=a(662),Da=a(564),zb=a(235),qb=a(134),Pa=a(7),Nb=a(59);const Tb=($a,Y,Ta,Bb,Rb,jc,vc,bb,Mb,hc=null)=>{Mb=$a.Pa(9,Mb);Mb.sourceRanges=Y;Mb.destinationRanges=Ta;Mb.flags=Bb;return Nb.g($a,"PasteRange",Mb,Rb,jc,vc,bb,64,hc)},
Vb=($a,Y,Ta,Bb,Rb,jc,vc,bb=null)=>{vc=$a.Pa(1,vc);vc.pasteHtmlParameters=Y;return Nb.g($a,"PasteHtmlContent",vc,Ta,Bb,Rb,jc,64,bb)},Jb=($a,Y,Ta,Bb,Rb,jc,vc,bb,Mb=null)=>{bb=$a.Pa(9,bb);bb.destinationRange=Y;bb.source=Ta;return Nb.g($a,"PasteString",bb,Bb,Rb,jc,vc,64,Mb)},Qa=($a,Y,Ta,Bb,Rb,jc,vc=null,bb=null)=>{vc=$a.Pa(1,vc);vc.copyParameters=Y;return Nb.g($a,"Copy",vc,Ta,Bb,Rb,jc,0,bb)},Db=($a,Y,Ta,Bb,Rb,jc,vc=null,bb=null)=>{vc=$a.Pa(1,vc);vc.copyParameters=Y;return Nb.g($a,"Cut",vc,Ta,Bb,Rb,jc,
0,bb)},sa=($a,Y,Ta,Bb,Rb,jc,vc=null,bb=null)=>{vc=$a.Pa(1,vc);vc.pasteParameters=Y;return Nb.g($a,"Paste",vc,Ta,Bb,Rb,jc,64,bb)};class Ha{constructor($a,Y,Ta){this.destinationRange=this.sourceRange=null;this.pasteFlags=0;this.sourceRange=$a;this.destinationRange=Y;this.pasteFlags=Ta}}Object(c.a)(Ha,"MacroRecorderPasteRangePayload",null,[144]);class mb{constructor($a,Y){this.content=this.destinationRange=null;this.destinationRange=$a;this.content=Y}getContent(){return this.content}}Object(c.a)(mb,
"MacroRecorderPasteStringPayload",null,[144]);var qa=a(74);class Xa{constructor($a){this.pasteParameters=null;this.pasteParameters=$a}}Object(c.a)(Xa,"MacroRecorderPastePayload",null,[144]);var Ca=a(600),va=a(797),na=a(201),Ka=a(30),ib=a(216),Ra=a(119),ka=a(248),da=a(354);const kb=($a,Y,Ta,Bb,Rb,jc,vc=null)=>{vc=$a.Pa(41,vc);vc.insertCopiedCutCellsParameters=Y;return Nb.g($a,"InsertCopiedCutCells",vc,Ta,Bb,Rb,jc,4)},Ob=($a,Y,Ta,Bb,Rb,jc,vc=null)=>{vc=$a.Pa(41,vc);vc.insertCopiedCutCellsParameters=
Y;return Nb.g($a,"InsertCopiedCutCellsV2",vc,Ta,Bb,Rb,jc,0)},lc=($a,Y,Ta,Bb,Rb,jc,vc=null)=>{vc=$a.Pa(41,vc);vc.insertCopiedCutCellsParameters=Y;return Nb.g($a,"InsertCopiedCutCellsCrossSession",vc,Ta,Bb,Rb,jc,0)};class tc{constructor($a){this.parameters=null;this.parameters=$a}getParameters(){return this.parameters}}Object(c.a)(tc,"MacroRecorderRangeCopyCutCellsInsertedPayload",null,[144]);var Pb=a(382);class tb{constructor($a,Y,Ta,Bb,Rb,jc,vc,bb,Mb){this.destinationRange=$a;this.z4a=Ta;this.Lhj=
Bb;this.je=Rb;this.hVb=jc;this.pasteContext=vc;this.N8b=bb;this.Epg=Mb}}Object(c.a)(tb,"PasteHtmlRequestParams",null,[]);class gc{constructor($a,Y){this.dqc=this.YQa=null;this.eTa=ea.a.eTa;this.tMd=ea.a.tMd;this.UIb=ea.a.UIb;this.Omc=x.EwaSettings.getBooleanFeatureGate(ea.a.Swb,!1);this.UDi=x.EwaSettings.isChangeGateEnabled("OfficeVSO:7316963_InsertCopiedCutCellsV2Enabled");this.qvd=!1;this.Mza=x.EwaSettings.isChangeGateEnabled("OfficeVSO:7694407_CopyPasteWFEIncreasedLimits");this.ODi=x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CopyPasteWFEIncreasedLimitsForPasteString",
!1);this.aB=(Ta,Bb)=>{if(2===Bb.Yr)this.dx.clear(),this.YQa=null;else if(1===Bb.Yr&&this.dx&&this.dx.contains(Bb.Cg)){Ta=qb.a(Bb.Cg.operation.operationName);const Rb=Bb.Cg.dequeueUtcTime.getTime()-Bb.Cg.enqueueUtcTime.getTime();e.ULS.sendTraceTag(526758673,0,50,`CopyPasteUtils.OnQueueChanged: web method ${Ta} returned, it took ${Rb} milliseconds to complete.`);this.dx.remove(Bb.Cg);this.YQa=null}};this.$=$a;this.gridView=Y;this.qvd&&(this.$.userOperationManager.zs(this.aB),this.dx=new pb.a)}get aBa(){return this.Mza?
x.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.CopyPasteHtmlImportMaxLength",this.$.xa.CopyPasteMaxPayloadLength):m.a.aBa}copy($a,Y,Ta,Bb=null,Rb=null){const jc=this.$.qa.va.Lc();this.qvd&&this.UZ();this.dqc=jc.ClientRequestId;var vc=new na.a(505,0,(bb,Mb,hc)=>{const Cc={CopyPasteTargetType:1};Cc.SourceRanges=$a;Cc.CopyOperationId=Y.id;e.ULS.sendTraceTag(537167756,0,50,`CopyPasteInfrastructure.Copy served from CopyPasteProxy : ${this.Mza}, CopyOperationId : ${Cc.CopyOperationId}`);return this.YQa=
this.Mza?Qa(this.$.qa.Iw,Cc,ka.b(bb,Ta),Bb?ka.a(Mb,Bb):Mb,hc,Y.ribbonCommandInfo,jc,Rb):Qa(this.$.qa.va,Cc,ka.b(bb,Ta),Bb?ka.a(Mb,Bb):Mb,hc,Y.ribbonCommandInfo,jc,Rb)},80);vc=this.$.userOperationManager.Bd(vc,Y.ribbonCommandInfo);this.qvd&&this.dx.add(vc)}xVf($a,Y,Ta,Bb,Rb,jc){return new Promise((vc,bb)=>{var Mb;const hc=jc.commandParameters.stopwatch.vd;let Cc=2;20===jc.commandParameters.commandType&&(Cc=16);36===jc.commandParameters.commandType&&(Cc=32);68===jc.commandParameters.commandType&&(Cc=
64);Ka.a.EAd(this.$)&&1028===jc.commandParameters.commandType&&(Cc=1024);let Wb=null;if(null===(Mb=jc.copyContextSnapshot)||void 0===Mb?0:Mb.commandParameters)Wb=jc.copyContextSnapshot.commandParameters.id;gc.$Wd(this.$,$a,Bb,Y,Ta,null,mc=>{gc.Njc(mc,jc,vc,bb,hc,this.$,null,!0,null,null)},mc=>{jc.serverRequestTimeInMs=jc.commandParameters.stopwatch.vd-hc;mc=Ra.a.vf(mc.data);bb(new va.a(5,mc))},Rb,Cc,Wb,jc.commandParameters.id)})}pasteRange($a,Y,Ta,Bb,Rb,jc,vc,bb,Mb,hc){return new Promise((Cc,Wb)=>
{const mc=vc.commandParameters.stopwatch.vd;gc.uKj(this.$,$a,Y,Ta,Bb|-5&Rb,Mc=>{gc.Njc(Mc,vc,Cc,Wb,mc,this.$,null,!0,Mb,hc)},Mc=>{vc.serverRequestTimeInMs=vc.commandParameters.stopwatch.vd-mc;Mc=Ra.a.vf(Mc.data);Mc=new va.a(5,Mc);null===hc||void 0===hc?void 0:hc(Mc);Wb(Mc)},jc,bb)})}enj($a,Y,Ta,Bb,Rb,jc,vc){return(new Promise((bb,Mb)=>{if(Y)if(Y.length>this.aBa){var hc=vc.clipboardItems.getItem(I.plainText);let Cc=-1;void 0!==hc&&null!==hc&&(Cc=hc.length);ea.a.Pqf&&Y.length<this.tMd&&Y.length>this.eTa&&
(this.GWf(Y),this.QX=new tb($a,Y,Ta,Bb,Rb,jc,vc,0,this.Xwc.length),window.requestIdleCallback&&window.requestIdleCallback(()=>this.JMd()));e.ULS.sendTraceTag(42071712,0,15,`CopyPasteInfrastructure.ProcessPasteHtml copy paste length too long. clipboardHtml.Length: ${Y.length}, MaxHtmlImportLength: ${this.aBa}, PlainTextLength: ${Cc}`);Mb(new va.a(1))}else hc=new na.a(204,0,(Cc,Wb,mc)=>{this.$.Sz();const Mc=vc.commandParameters.stopwatch.vd;Cc=ka.b(Cc,Xd=>{gc.Njc(Xd,vc,bb,Mb,Mc,this.$,Y,!1,null,null)});
Wb=ka.a(Wb,Xd=>{vc.serverRequestTimeInMs=vc.commandParameters.stopwatch.vd-Mc;Xd=Ra.a.vf(Xd.data);Mb(new va.a(3,Xd))});const hd=this.$.qa.va.Lc(),pd=M.v($a,this.$),Nd={};Nd.SourceHtml=Y;Nd.DestinationRanges=pd?M.s(pd):null;Nd.CopyOperationId=Ta;Nd.PasteId=Bb;e.ULS.sendTraceTag(537167755,0,50,`CopyPasteInfrastructure.ProcessPasteHtml served from CopyPasteProxy : ${this.Mza}. PasteId : ${Nd.PasteId}`);return this.Mza?Vb(this.$.qa.Iw,Nd,Cc,Wb,mc,null,hd,jc):Vb(this.$.qa.va,Nd,Cc,Wb,mc,null,hd,jc)},65),
this.$.userOperationManager.Bd(hc,Rb);else bb("")})).then(()=>{ea.a.Pqf&&Y.length>this.eTa&&(this.GWf(Y),this.QX=new tb($a,Y,Ta,Bb,Rb,jc,vc,0,this.Xwc.length),window.requestIdleCallback&&window.requestIdleCallback(()=>this.JMd()))})}GWf($a){const Y=this.$.yc.Fd("Task","pasteHtmlChunkOperation"),Ta=Math.floor($a.length/this.eTa)+1;this.Xwc=Array(Ta);let Bb=0;for(;Bb<Ta;)this.Xwc[Bb]=$a.substring(Bb*this.eTa,(Bb+1)*this.eTa),Bb++;e.ULS.sendTraceTag(523257954,0,50,`CopyPasteUtils.populatePasteChunks Time taken for chunking: ${Y.vd}`)}JMd(){this.Khj(this.QX.destinationRange,
this.Xwc[this.QX.N8b],this.QX.z4a,this.QX.Lhj,this.QX.je,this.QX.hVb,this.QX.pasteContext,this.QX.N8b,this.QX.Epg);this.QX.N8b++;this.QX.N8b<this.QX.Epg&&window.requestIdleCallback(()=>this.JMd())}Khj($a,Y,Ta,Bb,Rb,jc,vc,bb,Mb){const hc=new na.a(204,0,(Cc,Wb,mc)=>{const Mc=vc.commandParameters.stopwatch.vd;Cc=ka.b(Cc,()=>{e.ULS.sendTraceTag(512313415,0,15,`CopyPasteUtils.pasteHtmlServerCall succeeded serverRequestTimeInMs:${vc.commandParameters.stopwatch.vd-Mc},
             pasteid:${Bb},
             chunkIndex:${bb},
             totalChunks:${Mb}`)});Wb=ka.a(Wb,()=>{vc.serverRequestTimeInMs=vc.commandParameters.stopwatch.vd-Mc;e.ULS.sendTraceTag(512313414,0,15,`CopyPasteUtils.pasteHtmlServerCall failed serverRequestTimeInMs:${vc.serverRequestTimeInMs},
               pasteid:${Bb},
               chunkIndex:${bb},
               totalChunks:${Mb}`)});const hd=this.$.qa.va.Lc();var pd=M.v($a,this.$);pd={SourceHtml:Y,DestinationRanges:pd?M.s(pd):null,CopyOperationId:Ta,PasteId:`${Bb}_chunk_${bb}`,ChunkIndex:bb,TotalChunks:Mb};e.ULS.sendTraceTag(523257952,0,50,`CopyPasteInfrastructure.ProcessPasteHtml served from CopyPasteProxy : ${this.Mza}. PasteId : ${pd.PasteId}`);return Vb(this.$.qa.Iw,pd,Cc,Wb,mc,null,hd,jc)},65);this.$.userOperationManager.Bd(hc,Rb)}fnj($a,Y,Ta,Bb,Rb){return new Promise((jc,vc)=>{e.ULS.sendTraceTag(537167754,
0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: method start. pasteContext.Id=${Rb.id}`);Y&&(Y=pa.a.trimEnd(Y,"\n","\r"));e.ULS.sendTraceTag(537167753,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: after clipboardText.TrimEnd. pasteContext.Id=${Rb.id}`);if(Y)if(Y.length>this.UIb)e.ULS.sendTraceTag(24150921,0,15,"CopyPasteInfrastructure.ProcessPasteText copy paste length too long. clipboardText.Length: {0}, MaxCopyPasteLength: {1}",Y.length,this.UIb),vc(new va.a(1));
else{let Mb,hc;const Cc=M.v($a,this.$);e.ULS.sendTraceTag(537167752,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before treatAsLink calculation. pasteContext.Id=${Rb.id}`);var bb=!this.$.ea.isNamedObjectViewMode&&!Y.includes("\n")&&!Y.includes("\t");e.ULS.sendTraceTag(537167751,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before isLink check. pasteContext.Id=${Rb.id}. treatAsLink=${bb}`);bb=bb&&pa.a.ssf(Y);e.ULS.sendTraceTag(537167750,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: after treatAsLink calculation. pasteContext.Id=${Rb.id}. treatAsLink=${bb}`);
const Wb=this.$.qa.va.Lc();if(bb){hc=526;e.ULS.sendTraceTag(537167749,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before FixUpUrl. pasteContext.Id=${Rb.id}`);const mc=ib.a.yjd(Y);e.ULS.sendTraceTag(537167748,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: after FixUpUrl. pasteContext.Id=${Rb.id}`);const Mc=M.s(Cc);bb=(hd,pd,Nd)=>{const Xd=Rb.commandParameters.stopwatch.vd;hd=ka.b(hd,ae=>{e.ULS.sendTraceTag(537167747,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: on ApplyHyperlink successCallback. pasteContext.Id=${Rb.id}`);
Rb.requestTelemetryData=ae.RequestTelemetryData;Rb.serverRequestTimeInMs=Rb.commandParameters.stopwatch.vd-Xd;ae.Errors&&0<ae.Errors.length?vc(new va.a(2,ae.Errors)):jc(Y)});pd=ka.a(pd,ae=>{Rb.serverRequestTimeInMs=Rb.commandParameters.stopwatch.vd-Xd;ae=Ra.a.vf(ae.data);vc(new va.a(2,ae))});this.$.Sz();e.ULS.sendTraceTag(537167746,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before ApplyHyperlink. pasteContext.Id=${Rb.id}`);return Nb.b(this.$.qa.va,Mc,Y,mc,!1,!1,63,hd,pd,Nd,$a,
Wb,Bb)};Mb=()=>new Ca.a(Mc,Y,mc)}else hc=180,bb=(mc,Mc,hd)=>{this.$.Sz();const pd=Rb.commandParameters.stopwatch.vd;mc=ka.b(mc,Nd=>{e.ULS.sendTraceTag(537167745,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: on PasteString successCallback. pasteContext.Id=${Rb.id}`);gc.Njc(Nd,Rb,jc,vc,pd,this.$,Y,!1,null,null)});Mc=ka.a(Mc,Nd=>{Rb.serverRequestTimeInMs=Rb.commandParameters.stopwatch.vd-pd;Nd=Ra.a.vf(Nd.data);vc(new va.a(4,Nd))});e.ULS.sendTraceTag(537167744,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before PasteString. pasteContext.Id=${Rb.id}`);
return Jb(this.ODi?this.$.qa.Iw:this.$.qa.va,Cc,Y,mc,Mc,hd,null,Wb,Bb)},Mb=()=>new mb(Cc,Y);e.ULS.sendTraceTag(537167715,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before UserWebMethodOperation. pasteContext.Id=${Rb.id}`);bb=new na.a(hc,0,bb,65,Mb);e.ULS.sendTraceTag(537167714,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: returning. pasteContext.Id=${Rb.id}`);this.$.userOperationManager.Bd(bb,Ta)}else jc("")})}Lkf($a,Y){Y=[1===Y?4:5];this.gridView.pc.oB(da.a.xEa(qa.d(this.$.na),
$a),Y,!0);this.gridView.pc.fs(Y);this.gridView.pc.update(!0)}ykc(){const $a=[4,5];this.gridView.pc.Sk($a,!1,!1);this.gridView.pc.rl(null,$a,!1);1===this.gridView.ga.rf&&this.gridView.fs(!1,!1);this.gridView.pc.update(!1,!1)}kah($a,Y,Ta){const Bb=[];for(const Rb of Ta)Bb.push(this.qah($a,Y,Rb));return Bb}UZ(){if(this.dx)for(let $a of this.dx)if(this.$&&this.$.userOperationManager){if($a.operation){const Y=qb.a($a.operation.operationName);e.ULS.sendTraceTag(526758675,0,50,`CopyPasteUtils.AbortOutstandingUserOperation: Trying to abort pending operation ${Y}.`)}this.sbh();
this.$.userOperationManager.Iwa($a)}}sbh(){if(this.YQa){const $a=this.YQa.yv;e.ULS.sendTraceTag(526758674,0,15,`Cancelling pending copy request with Id=${$a}`);Ra.a.lw($a);!x.EwaSettings.isChangeGateEnabled("OfficeVSO:6151555_DisableCancelCopyRequest")&&this.dqc&&Nb.h(this.$.qa.va,this.dqc,null,null,null);this.dqc=this.YQa=null}}qah($a,Y,Ta){e.ULS.shipAssertTag(537167713,0,!!Y,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray shouldn't be null");e.ULS.shipAssertTag(537167712,0,0<Y.length,
"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray length shouldn't be zero");let Bb=0,Rb=0;var jc=new Set;const vc=new Set;for(const bb of Y){Y=`${bb.left}_${bb.right}`;const Mb=`${bb.top}_${bb.bottom}`;vc.has(Y)||(vc.add(Y),Rb+=bb.width);jc.has(Mb)||(jc.add(Mb),Bb+=bb.height)}if(36===$a)return Ta.isSingle?gc.M2e(Rb,Bb,Ta):Ta.clone();516===$a&&($a=Bb,Bb=Rb,Rb=$a);$a=!(Ta.width%Rb)&&!(Ta.height%Bb);jc=Ta.sX&&!(Ta.height%Bb);Ta.d8&&!(Ta.width%Rb)||jc?Ta=gc.M2e(Rb,Bb,Ta):$a?Ta=Ta.clone():(Ta=
Ta.clone(),Ta.bottom=Math.min(m.a.Sg,Ta.top+Bb-1),Ta.right=Math.min(m.a.Rg,Ta.left+Rb-1));return Ta}J2g($a,Y,Ta,Bb,Rb,jc,vc,bb,Mb,hc,Cc){if(!Bb||!Bb.length)return 1;if(1<Bb.length){if(!this.Omc&&jc)return 3;if(hc)return 0;if(bb)return 9;if(Mb)return 8;if(Cc)return 2;if(1<Y.length)return 4;const Wb=Y[0];if(!vc&&!zb.a.all(Bb,mc=>mc.isSingle||!(mc.width%Wb.width)&&!(mc.height%Wb.height)))return 5;if((!this.Omc||!jc)&&pa.a.equals($a,Ta,!0))for(const mc of Rb)if(mc.Yd(Wb)&&!mc.equals(Wb))return 6}else if(Y&&
0<Y.length){if(0!==this.Opf(Y,Mb))return 7;if(1<Y.length){if(!this.Omc&&jc)return 3;if((!this.Omc||!jc)&&pa.a.equals($a,Ta,!0))for(const Wb of Y)if($a=Rb[0],Wb.Yd($a)&&!Wb.equals($a))return 6}}return 0}Opf($a,Y){if(!$a||1>=$a.length)return 0;if(Y)return 2;if(!M.T($a))return 1;Y=new cb.a(Da.a.hh());for(const Ta of $a)for(const Bb of $a){const Rb=Ta.top===Bb.top&&Ta.bottom===Bb.bottom,jc=Ta.left===Bb.left&&Ta.right===Bb.right,vc=Math.max(Ta.left,Bb.left)<Math.min(Ta.right,Bb.right);if(Math.max(Ta.top,
Bb.top)<Math.min(Ta.bottom,Bb.bottom)&&!Rb||vc&&!jc)return 3;Y.add(`${Ta.top}-${Ta.bottom}-${Bb.left}-${Bb.right}`);Y.add(`${Bb.top}-${Bb.bottom}-${Ta.left}-${Ta.right}`)}for(const Ta of $a)Y.remove(`${Ta.top}-${Ta.bottom}-${Ta.left}-${Ta.right}`);return 0<Y.count?3:0}$sj($a){const Y=this.gridView.ga;Y.updateSelection($a,$a.topLeft,0);Y.selectionType=-1}j8a($a){if(null===$a||void 0===$a?0:$a.sourceItem){if(!B($a.sourceItem))return null;if(($a=$a.sourceItem)&&M.db($a.ranges,!0))return $a}return null}kFb($a,
Y){e.ULS.shipAssertTag(537167711,0,!!$a,"CopyPasteUtils.IsFromKeyboardShortcut: commandInfo shouldn't be null");return Y&&Pa.a.lF in Y||$a.tabName?!1:1===$a.method}static uKj($a,Y,Ta,Bb,Rb,jc,vc,bb,Mb){const hc=$a.qa.va.Lc(Mb?{xoa:!0,pna:1}:{xoa:!1,pna:0});Mb=new na.a(506,0,(Cc,Wb,mc)=>{$a.Sz();return Tb($a.qa.va,Ta,Bb,Rb,ka.b(Cc,jc),ka.a(Wb,vc),mc,null,hc,bb)},65,()=>new Ha(Ta,Bb,Rb));$a.userOperationManager.Bd(Mb,Y)}static Njc($a,Y,Ta,Bb,Rb,jc,vc=null,bb,Mb,hc){e.ULS.sendTraceTag(537167710,0,50,
`CopyPasteInfrastructure.HandlePasteResult profiling trace: on HandlePasteResult start. pasteContext.Id=${Y.id}`);Y.requestTelemetryData=$a.RequestTelemetryData;Y.serverRequestTimeInMs=Y.commandParameters.stopwatch.vd-Rb;Oa.a.ng($a.Errors)?Oa.a.Ija($a.Errors)?(Y&&(Y.encounteredDeploymentErrors=!0),$a=Oa.a.Uc($a.Errors),e.ULS.sendTraceTag(537167707,0,15,`CopyPasteUtils.HandlePasteServerResponse: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${$a}`)):($a=
new va.a(5,$a.Errors),null===hc||void 0===hc?void 0:hc($a),Bb($a)):$a.Result?(Bb=!!$a&&!!$a.RequestTelemetryData,P.h(jc).Mh.yoa(Y.commandParameters.stopwatch.id,$a.StateId,Bb?$a.RequestTelemetryData.EcsOperationDuration:0,Bb?$a.RequestTelemetryData.EcsRequestDuration:0,Bb?$a.RequestTelemetryData.WfeRequestDuration:0),Y.pastedRange=$a.Result.SheetMultiRange,e.ULS.sendTraceTag(537167708,0,50,`CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise ewaResult.Result is not null. pasteContext.Id=${Y.id}`),
null===Mb||void 0===Mb?void 0:Mb(),Ta(!0),x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!1)&&bb&&!Y.commandParameters.isDragDrop&&(Y=jc.da.Ba(465))&&Y.M$(6,$a)):(e.ULS.sendTraceTag(537167709,0,50,`CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise when ewaResult.Result is null. pasteContext.Id=${Y.id}`),Ta(vc||!0))}static $Wd($a,Y,Ta,Bb,Rb,jc,vc,bb,Mb,hc,Cc,Wb){const mc=$a.qa.va.Lc(),Mc=gc.mQe(Ta,Bb,Rb,
hc,Cc,Wb);Ta=new na.a(503,0,(hd,pd,Nd)=>{$a.Sz();return sa($a.qa.va,Mc,ka.b(hd,vc),ka.a(pd,bb),Nd,jc,mc,Mb)},65,()=>new Xa(Mc));$a.userOperationManager.Bd(Ta,Y)}static mQe($a,Y,Ta,Bb,Rb,jc){const vc={};vc.ShadowWorkbookBase64=$a.shadowWorkbookBase64;vc.SourceRanges={};vc.SourceRanges.Ranges=Array(1);vc.SourceRanges.Ranges[0]={};vc.SourceRanges.Ranges[0].FirstRow=$a.rangeRowStart;vc.SourceRanges.Ranges[0].LastRow=$a.rangeRowEnd;vc.SourceRanges.Ranges[0].FirstColumn=$a.rangeColumnStart;vc.SourceRanges.Ranges[0].LastColumn=
$a.rangeColumnEnd;x.EwaSettings.getBooleanFeatureGate(ea.a.Swb,!1)?Ta?vc.DestinationRanges=M.u(Ta.SheetName,Ta.NamedObjectName,M.g(Ta.Ranges)):(e.ULS.sendTraceTag(537167706,0,15,"CopyPasteInfrastructure.CreatePasteParameters: multiRangeDestination is null"),vc.DestinationRanges=null):vc.DestinationRanges=Y?M.s(Y):null;vc.CopyPasteTargetType=1;vc.PasteType=Bb;vc.CopyOperationId=Rb;vc.PasteId=jc;vc.SourceClientPath=$a.sourceClientPath;vc.SourceSheetName=$a.sourceSheetName;vc.SourceWorkbookName=$a.sourceWorkbookName;
if(!$a.originalSourceRangesCountExceedsLimit&&$a.originalSourceRanges&&0<$a.originalSourceRanges.length&&1024===Bb){vc.OriginalSourceMultiRange={};Y=Array($a.originalSourceRanges.length);for(Ta=0;Ta<Y.length;++Ta)Y[Ta]={},Y[Ta].FirstRow=$a.originalSourceRanges[Ta][0],Y[Ta].FirstColumn=$a.originalSourceRanges[Ta][1],Y[Ta].LastRow=$a.originalSourceRanges[Ta][2],Y[Ta].LastColumn=$a.originalSourceRanges[Ta][3];vc.OriginalSourceMultiRange.Ranges=Y}return vc}static M2e($a,Y,Ta){Ta=Ta.clone();Ta.height<
Y&&(Ta.bottom=Math.min(m.a.Sg,Ta.top+Y-1));Ta.width<$a&&(Ta.right=Math.min(m.a.Rg,Ta.left+$a-1));return Ta}QVj($a,Y,Ta){return($a=P.h($a).Wb.rh(Ta))?Y.width===$a.usedRange.width&&Ta.left===$a.usedRange.left||Ta.left===$a.usedRange.left&&Ta.right===$a.usedRange.right&&0===Ta.width%Y.width:!1}PVj($a,Y,Ta){return($a=P.h($a).Wb.rh(Ta))?Y.height===$a.usedRange.height&&Ta.top===$a.usedRange.top||Ta.top===$a.usedRange.top&&Ta.bottom===$a.usedRange.bottom&&0===Ta.height%Y.height:!1}executeInsertCopiedCutCellsOperation($a,
Y,Ta,Bb,Rb,jc=null,vc=null){const bb={};bb.InsertDirection=Bb;bb.SourceRange=$a;bb.DestRange=Y;bb.CopyCutOperation=Ta?0:1;const Mb=this.$.qa.va,hc=this.$.qa.va.Lc(),Cc=()=>new tc(bb);return Pb.a(this.$.userOperationManager,(Wb,mc,Mc)=>this.UDi?Ob(Mb,bb,jc?ka.b(Wb,jc):Wb,vc?ka.a(mc,vc):mc,Mc,hc):kb(Mb,bb,jc?ka.b(Wb,jc):Wb,vc?ka.a(mc,vc):mc,Mc,null),Wb=>new na.a(104,0,Wb,void 0,Cc),Rb,x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MoveTaskCompletionToQueueItemLevelByOptingIn",!1))}NVe($a,
Y,Ta,Bb,Rb,jc,vc,bb){return new Promise((Mb,hc)=>{this.executeInsertCopiedCutCellsOperation(Y,Ta,Bb,Rb,jc,Cc=>{$a.requestTelemetryData=Cc.RequestTelemetryData;if(Cc.Errors&&0<Cc.Errors.length){const Wb=new va.a(21,Cc.Errors);null===bb||void 0===bb?void 0:bb(Wb);hc(new va.a(21,Cc.Errors))}else null===vc||void 0===vc?void 0:vc(),Mb(!0)},Cc=>{Cc=Ra.a.vf(Cc.data);Cc=new va.a(21,Cc);null===bb||void 0===bb?void 0:bb(Cc);hc(Cc)})})}executeInsertCopiedCutCellsAcrossSession($a,Y,Ta,Bb,Rb,jc=null,vc=null,bb,
Mb,hc,Cc){let Wb={};Wb.PasteParameters=gc.mQe(hc,bb,Mb,2,Cc.copyContextSnapshot.commandParameters.id,Cc.commandParameters.id);Wb.InsertDirection=Bb;Wb.SourceRange=$a;Wb.DestRange=Y;Wb.CopyCutOperation=Ta?0:1;const mc=this.$.qa.va,Mc=this.$.qa.va.Lc(),hd=()=>new tc(Wb);return Pb.a(this.$.userOperationManager,(pd,Nd,Xd)=>lc(mc,Wb,jc?ka.b(pd,jc):pd,vc?ka.a(Nd,vc):Nd,Xd,Mc),pd=>new na.a(106,0,pd,void 0,hd),Rb)}}Object(c.a)(gc,"CopyPasteUtils",null,[346]);var Xb=a(504),Ga;(function($a){$a[$a.range=0]=
"range";$a[$a.art=1]="art"})(Ga||(Ga={}));Object(c.b)("SourceItemType",Ga);var Za=a(91);class Sb{constructor($a){this.jmg={["SourceItemType.Range"]:0,["SourceItemType.Art"]:1};this.RSb={};this.fmg={["FloatingObjectType.Unknown"]:99,["FloatingObjectType.CardView"]:6,["FloatingObjectType.Chart"]:0,["FloatingObjectType.Group"]:7,["FloatingObjectType.Image"]:1,["FloatingObjectType.Ink"]:8,["FloatingObjectType.InteractiveReport"]:4,["FloatingObjectType.ModernOfficeExtension"]:3,["FloatingObjectType.Shape"]:5,
["FloatingObjectType.Slicer"]:2,["FloatingObjectType.Unsupported"]:100};this.O4c={["99"]:"FloatingObjectType.Unknown",["6"]:"FloatingObjectType.CardView",["0"]:"FloatingObjectType.Chart",["7"]:"FloatingObjectType.Group",["1"]:"FloatingObjectType.Image",["8"]:"FloatingObjectType.Ink",["4"]:"FloatingObjectType.InteractiveReport",["3"]:"FloatingObjectType.ModernOfficeExtension",["5"]:"FloatingObjectType.Shape",["2"]:"FloatingObjectType.Slicer",["100"]:"FloatingObjectType.Unsupported"};this.img={["RibbonCommand.Copy"]:-911352779,
["RibbonCommand.Cut"]:-1985798686};this.iVd={["-911352779"]:"RibbonCommand.Copy",["-1985798686"]:"RibbonCommand.Cut"};this.hmg={["InputManager.InputMethod.NotDefined"]:-1,["InputManager.InputMethod.Unknown"]:0,["InputManager.InputMethod.Keyboard"]:1,["InputManager.InputMethod.Mouse"]:2,["InputManager.InputMethod.Touch"]:3,["InputManager.InputMethod.CrossSlide"]:9};this.mna={};this.gmg={["FrameMode.None"]:0,["FrameMode.Reading"]:1,["FrameMode.Edit"]:2};this.e7a={};this.kmg={["UILocation.Unknown"]:0,
["UILocation.UpperRibbon"]:1,["UILocation.Ribbon"]:2,["UILocation.QAT"]:3,["UILocation.Jewel"]:4,["UILocation.NavigationPane"]:5,["UILocation.KeyboardShortcut"]:6,["UILocation.StatusBar"]:7,["UILocation.Dialog"]:8,["UILocation.Floatie"]:9,["UILocation.NotificationBar"]:10,["UILocation.StandaloneCuiRoot"]:11,["UILocation.TaskPane"]:12,["UILocation.HeroDock"]:13,["UILocation.SingleLineRibbon"]:14,["UILocation.MultilineRibbon"]:15,["UILocation.Overflow"]:16,["UILocation.TellMe"]:17,["UILocation.FarPeripheralControls"]:18,
["UILocation.ContextMenu"]:19,["UILocation.DialogMenu"]:20,["UILocation.Header"]:21,["UILocation.FileMenu"]:22,["UILocation.Toolbar"]:26,["UILocation.Canvas"]:30};this.mt={};this.$=$a;this.mna.notDefined="InputManager.InputMethod.NotDefined";this.mna.unknown="InputManager.InputMethod.Unknown";this.mna.keyboard="InputManager.InputMethod.Keyboard";this.mna.mouse="InputManager.InputMethod.Mouse";this.mna.touch="InputManager.InputMethod.Touch";this.mna.crossSlide="InputManager.InputMethod.CrossSlide";
this.e7a.none="FrameMode.None";this.e7a.reading="FrameMode.Reading";this.e7a.edit="FrameMode.Edit";this.mt.unknown="UILocation.Unknown";this.mt.upperRibbon="UILocation.UpperRibbon";this.mt.ribbon="UILocation.Ribbon";this.mt.QAT="UILocation.QAT";this.mt.jewel="UILocation.Jewel";this.mt.navigationPane="UILocation.NavigationPane";this.mt.keyboardShortcut="UILocation.KeyboardShortcut";this.mt.statusBar="UILocation.StatusBar";this.mt.dialog="UILocation.Dialog";this.mt.floatie="UILocation.Floatie";this.mt.notificationBar=
"UILocation.NotificationBar";this.mt.standaloneCuiRoot="UILocation.StandaloneCuiRoot";this.mt.taskPane="UILocation.TaskPane";this.mt.heroDock="UILocation.HeroDock";this.mt.singleLineRibbon="UILocation.SingleLineRibbon";this.mt.multilineRibbon="UILocation.MultilineRibbon";this.mt.overflow="UILocation.Overflow";this.mt.tellMe="UILocation.TellMe";this.mt.farPeripheralControls="UILocation.FarPeripheralControls";this.mt.header="UILocation.Header";this.mt.fileMenu="UILocation.FileMenu";this.mt.contextMenu=
"UILocation.ContextMenu";this.mt.dialogMenu="UILocation.DialogMenu";this.mt.toolbar="UILocation.Toolbar";this.mt.canvas="UILocation.Canvas";this.RSb.range="SourceItemType.Range";this.RSb.art="SourceItemType.Art"}serializeSourceItem($a){const Y={};if($a&&Object.getType($a)===O)Y.sheetName=$a.sheetName,Y.topArray=zb.a.map($a.ranges,Ta=>Ta.top),Y.leftArray=zb.a.map($a.ranges,Ta=>Ta.left),Y.bottomArray=zb.a.map($a.ranges,Ta=>Ta.bottom),Y.rightArray=zb.a.map($a.ranges,Ta=>Ta.right),Y.sessionStateId=$a.sessionStateId,
Y.sessionId=$a.sessionId,Y.sourceItemType=this.Tbg(0);else if($a&&Object.getType($a)===G)Y.activeFloatingObjectControlId=$a.activeFloatingObjectControlId,Y.sheetName=$a.sheetName,Y.sessionStateId=$a.sessionStateId,Y.sessionId=$a.sessionId,Y.floatingObjectType=this.WKj($a.type),Y.sourceItemType=this.Tbg(1);else return e.ULS.shipAssertTag(537167705,0,!1,"EnvironmentSerializationHelper.SerializeSourceItem: sourceItem shouldn't be null."),null;return JSON.stringify(Y)}serializeCommandParameters($a){if(!$a)return e.ULS.shipAssertTag(537167704,
0,!1,"EnvironmentSerializationHelper.Serialize: commandParameters shouldn't be null."),null;const Y={};Y.id=$a.id;Y.commandType=$a.commandType;Y.copyPasteTargetType=$a.copyPasteTargetType;$a.ribbonCommandInfo&&(Y.ribbonCommandName=this.fLj($a.ribbonCommandInfo.command),Y.inputMethodName=this.$Kj($a.ribbonCommandInfo.method),Y.frameModeName=this.YKj($a.ribbonCommandInfo.mode),Y.uiLocationName=this.jLj($a.ribbonCommandInfo.Jf),Y.tabName=$a.ribbonCommandInfo.tabName);return JSON.stringify(Y)}deserializeSourceItem($a){if(!$a)return null;
try{const Y=JSON.parse($a);if(!Y)return e.ULS.shipAssertTag(537167703,0,!1,"EnvironmentSerializationHelper.Deserialize: Json.Parse return null result."),null;let Ta=null;switch(this.Jwh(Y.sourceItemType)){case 0:Ta=new O(this.$,this.Gwh(Y),Y.sheetName,Y.sessionStateId,Y.sessionId);break;case 1:Ta=new G(Y.activeFloatingObjectControlId,Y.sheetName,Y.sessionStateId,Y.sessionId,this.Dwh(Y.floatingObjectType))}return Ta}catch(Y){return e.ULS.sendTraceTag(537167702,0,10,`EnvironmentSerializationHelper.DeserializeSourceItem: got exception while try to JSON.Parse string length: ${$a?
$a.length:0}, errror: ${Y}`),null}}deserializeCommandParameters($a){if(!$a)return null;try{const Y=JSON.parse($a);if(!Y)return e.ULS.shipAssertTag(537167701,0,!1,"EnvironmentSerializationHelper.DeserializeCommandParameters: Json.Parse return null result."),null;const Ta=za.a();Ta.id=Y.id;Ta.ribbonCommandInfo=this.Iwh(Y);Ta.commandType=Y.commandType;Ta.copyPasteTargetType=Y.copyPasteTargetType;return Ta}catch(Y){return e.ULS.sendTraceTag(537167700,0,10,`EnvironmentSerializationHelper.DeserializeCommandParameters: got exception while try to JSON.Parse string length: ${$a?
$a.length:0}, errror: ${Y}`),null}}Gwh($a){const Y=[];e.ULS.shipAssertTag(537167699,0,!!$a.topArray&&0<$a.topArray.length,`EnvironmentSerializationHelper.DeserializeRanges: TopArray shouldn't be ${$a.topArray?"empty":"null"}.`);e.ULS.shipAssertTag(537167698,0,!!$a.leftArray&&0<$a.leftArray.length,`EnvironmentSerializationHelper.DeserializeRanges: LeftArray shouldn't be ${$a.leftArray?"empty":"null"}.`);e.ULS.shipAssertTag(537167697,0,!!$a.bottomArray&&0<$a.bottomArray.length,`EnvironmentSerializationHelper.DeserializeRanges: BottomArray shouldn't be ${$a.bottomArray?
"empty":"null"}.`);e.ULS.shipAssertTag(537167696,0,!!$a.rightArray&&0<$a.rightArray.length,`EnvironmentSerializationHelper.DeserializeRanges: RightArray shouldn't be ${$a.rightArray?"empty":"null"}.`);if(!($a.topArray&&$a.leftArray&&$a.bottomArray&&$a.rightArray))return Y;e.ULS.shipAssertTag(537167695,0,$a.topArray.length===$a.bottomArray.length&&$a.topArray.length===$a.leftArray.length&&$a.topArray.length===$a.rightArray.length,`EnvironmentSerializationHelper.DeserializeRanges: The length of TopArray(${$a.topArray.length}), BottomArray(${$a.bottomArray.length}), LeftArray(${$a.leftArray.length}), RightArray(${$a.rightArray.length}) should be the same.`);
const Ta=Math.min($a.topArray.length,$a.bottomArray.length,$a.leftArray.length,$a.rightArray.length);for(let Bb=0;Bb<Ta;Bb++)Y.push(new v.Range($a.topArray[Bb],$a.leftArray[Bb],$a.bottomArray[Bb],$a.rightArray[Bb],!1,!1));return Y}Iwh($a){return new Za.a(this.Hwh($a.ribbonCommandName),this.Fwh($a.inputMethodName),this.Ewh($a.frameModeName),this.Lwh($a.uiLocationName),$a.tabName)}fLj($a){return void 0!==$a&&null!==$a&&$a.toString()in this.iVd?this.iVd[$a.toString()]:(e.ULS.shipAssertTag(537167694,
0,!1,`EnvironmentSerializationHelper.SerializeRibbonCommand expected to get RibbonCommand.Copy(${-911352779}) or RibbonCommand.Cut(${-1985798686}) but got ${$a}`),this.iVd["-911352779"])}Hwh($a){return $a&&$a in this.img?this.img[$a]:(e.ULS.shipAssertTag(537167693,0,!1,`EnvironmentSerializationHelper.DeserializeRibbonCommand: expected to get RibbonCommand.Copy(${-911352779}) or RibbonCommand.Cut(${-1985798686}) but got ${$a}`),-911352779)}$Kj($a){return void 0!==$a&&null!==$a&&l.a[$a]in this.mna?
this.mna[l.a[$a]]:(e.ULS.shipAssertTag(537167692,0,!1,`EnvironmentSerializationHelper.SerializeInputMethod: got unexpected value ${$a}`),this.mna.unknown)}Fwh($a){return $a&&$a in this.hmg?this.hmg[$a]:(e.ULS.shipAssertTag(537167691,0,!1,`EnvironmentSerializationHelper.DeserializeInputMethod: got unexpected value ${$a}`),0)}YKj($a){return void 0!==$a&&null!==$a&&Xb.a[$a]in this.e7a?this.e7a[Xb.a[$a]]:(e.ULS.shipAssertTag(537167690,0,!1,`EnvironmentSerializationHelper.SerializeFrameMode: got unexpected value ${$a}`),
this.e7a.edit)}Ewh($a){return $a&&$a in this.gmg?this.gmg[$a]:(e.ULS.shipAssertTag(537167689,0,!1,`EnvironmentSerializationHelper.DeserializeFrameMode: got unexpected value ${$a}`),2)}Tbg($a){return void 0!==$a&&null!==$a&&Ga[$a]in this.RSb?this.RSb[Ga[$a]]:(e.ULS.shipAssertTag(537167688,0,!1,`EnvironmentSerializationHelper.SerializeSourceItemType: got unexpected value ${$a}`),this.RSb.range)}Jwh($a){return $a&&$a in this.jmg?this.jmg[$a]:(e.ULS.shipAssertTag(537167687,0,!1,`EnvironmentSerializationHelper.DeserializeSourceItemType: got unexpected value ${$a}`),
0)}WKj($a){return void 0!==$a&&null!==$a&&$a.toString()in this.O4c?this.O4c[$a.toString()]:(e.ULS.shipAssertTag(537167686,0,!1,`EnvironmentSerializationHelper.SerializeArtSourceItemType: got unexpected value ${$a}`),this.O4c["99"])}Dwh($a){return $a&&$a in this.fmg?this.fmg[$a]:(e.ULS.shipAssertTag(537167685,0,!1,`EnvironmentSerializationHelper.DeserializeArtSourceItemType: got unexpected value ${$a}`),99)}jLj($a){return void 0!==$a&&null!==$a&&u.a[$a]in this.mt?this.mt[u.a[$a]]:(e.ULS.shipAssertTag(36229129,
0,!1,`EnvironmentSerializationHelper.SerializeUILocation: got unexpected value ${$a}`),this.mt.ribbon)}Lwh($a){return $a&&$a in this.kmg?this.kmg[$a]:(e.ULS.shipAssertTag(537167684,0,!1,`EnvironmentSerializationHelper.DeserializeUILocation: got unexpected value ${$a}`),2)}}Object(c.a)(Sb,"EnvironmentSerializationHelper",null,[]);var sb=a(6);class bc{}bc.n$f="SameSession";bc.$bd="CrossSession";bc.Cyf="LegacyCrossSession";bc.external="External";Object(c.a)(bc,"PayloadOrigin",null,[]);const kc=$a=>$a?
$a.shadowWorkbookSizeExceedsLimit&&void 0!==$a.shadowWorkbookBlockedSize&&null!==$a.shadowWorkbookBlockedSize?$a.shadowWorkbookBlockedSize:$a.shadowWorkbookBase64?$a.shadowWorkbookBase64.length:0:0,vb=$a=>$a.shadowWorkbookSizeExceedsLimit?!0:kc($a)>m.a.ssc;var ub=a(67),Ub=a(178),Rd=a(128);class Cd{constructor($a,Y,Ta=null){this.uJa=!1;this._name=Y;this.$=$a;this.qn=z.a.instance;this.wo=new gc($a,P.h($a));this.w$b=Ta}get name(){return this._name}get R4c(){return this.qn.Ha(5)}shouldWaitForCopyToComplete(){return!1}onDeferredPasteStarted(){}onDeferredPasteCompleted(){}beforePaste(){}Eak($a){let Y;
Y=null;try{const Ta=$a.getItem(I.shadowWorkbook);if(!Ta)return{returnValue:!1,IY:Y};Y=JSON.parse(Ta);return{returnValue:this.hKi(Y),IY:Y}}catch(Ta){return e.ULS.sendTraceTag(537167835,0,50,"BaseCopyPasteHandler.TryParseRangeShadowWorkbookPayload: Exception caught: "+Ta),{returnValue:!1,IY:Y}}}hKi($a){return!!$a&&(!!$a.shadowWorkbookBase64||$a.shadowWorkbookSizeExceedsLimit)&&void 0!==$a.rangeRowStart&&void 0!==$a.rangeRowEnd&&void 0!==$a.rangeColumnStart&&void 0!==$a.rangeColumnEnd}Vwc($a){$a.wasLastCopyExternal=
!0;x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SetDefaultPaste",!1)&&$a.commandParameters.isPasteDefault&&this.$.shortcutKeyManager&&($a.commandParameters.commandType=-185374993===this.$.shortcutKeyManager.obc?20:4);if(x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!h.a.wC&&516!==$a.commandParameters.commandType&&1028!==$a.commandParameters.commandType){var Y=null;if(({IY:Y}=this.Eak($a.clipboardItems)).returnValue)return $a.isShadowWorkbookParsedSuccessfully=
!0,this.Jhj($a,Y)}if(516!==$a.commandParameters.commandType&&36!==$a.commandParameters.commandType){if(x.EwaSettings.ya(151)&&20!==$a.commandParameters.commandType){Y=$a.clipboardItems.getItem(I.html);var Ta=!(void 0===Y||null===Y)&&!!Y&&Y.trim()!==this.R4c&&(Y.startsWith("<")||h.a.Bg&&Y.startsWith("\n<"));if(x.EwaSettings.isChangeGateEnabled("OfficeVSO:7698173_FormulaPasteAsText")){const Bb=$a.clipboardItems.getItem(I.z4a),Rb=Ub.f($a.clipboardItems.getItem(I.plainText));return!Ta||!Bb&&Rb?(Rb&&e.ULS.sendTraceTag(508863578,
0,50,"BaseCopyPasteHandler.pasteFromExternal: Pasting a formula as plaintext"),this.sMd($a)):this.tVf($a,Y,void 0===Bb?null:Bb)}if(Ta)return Ta=$a.clipboardItems.getItem(I.z4a),this.tVf($a,Y,void 0===Ta?null:Ta)}return this.sMd($a)}return Promise.reject(new va.a(6))}Jhj($a,Y){e.ULS.sendTraceTag(537167834,0,50,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: Pasting shadow workbook from system clipboard");$a.pasteResult="SystemClipboardShadowWorkbookPaste";$a.payloadType=aa.shadowWorkbook;
$a.payloadOrigin=bc.external;$a.shadowWorkbookPayloadSize=kc(Y);$a.shadowWorkbookSizeExceedsLimit=vb(Y);let Ta=null,Bb=null;const Rb=$a.commandParameters.originalDestinations;x.EwaSettings.getBooleanFeatureGate(ea.a.Swb,!1)?Ta=M.r(Rb,this.$):Bb=M.v(M.L(Rb),this.$);Y.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&($a.originalSourceRangesCountExceedsLimit=Y.originalSourceRangesCountExceedsLimit);if($a.shadowWorkbookSizeExceedsLimit)return e.ULS.sendTraceTag(537167833,0,15,`BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: shadow workbook length(${$a.shadowWorkbookPayloadSize}) is over the limit(${m.a.ssc}). reject the paste request. ShadowWorkbookSizeExceedsLimit: ${Y.shadowWorkbookSizeExceedsLimit}`),
Promise.reject(new va.a(1));e.ULS.sendTraceTag(537167832,0,50,`BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: trigger Paste request. PasteOperationId=${$a.commandParameters.id}`);return this.wo.xVf($a.commandParameters.ribbonCommandInfo,Bb,Ta,Y,[$a.commandParameters.stopwatch],$a)}sMd($a){var Y=$a.clipboardItems.getItem(I.plainText);if(void 0!==Y&&null!==Y&&Y.trim()===this.R4c)return Promise.reject(new va.a(7));void 0!==Y&&null!==Y&&($a.plainTextPayloadSize=Y.length);let Ta=!1;ea.a.PQh&&
null!==this.w$b&&(Ta=this.w$b.d4g($a,pa.a.trimEnd(Y,"\n","\r"),M.L($a.commandParameters.originalDestinations)));Ta&&P.h(this.$).Mh.$P($a.commandParameters.stopwatch.id,ub.BasicTelemetryCalculator.xO);this.uJa||(this.uJa=!0,Rd.b("AutoAdjustedColumnWidth"));$a.isPlainTextPaste=!0;$a.pasteResult="SystemClipboardPaste";$a.payloadOrigin=K($a)?bc.Cyf:bc.external;$a.payloadType=aa.plainText;e.ULS.sendTraceTag(537167831,0,50,`BaseRangeCopyPasteHandler.PasteByPlainText: trigger ProcessPasteText request. pasteContext.Id=${$a.id}, PasteOperationId=${$a.commandParameters.id}`);
Y=this.wo.fnj(M.L($a.commandParameters.originalDestinations),Y,$a.commandParameters.ribbonCommandInfo,[$a.commandParameters.stopwatch],$a);e.ULS.sendTraceTag(537167830,0,50,`BaseRangeCopyPasteHandler.PasteByPlainText: returned from ProcessPasteText. pasteContext.Id=${$a.id}`);return Y}tVf($a,Y,Ta){this.uJa||(this.uJa=!0,Rd.b("AutoAdjustedColumnWidth"));$a.htmlPayloadSize=Y.length;$a.isHtmlPaste=!0;$a.pasteResult="SystemClipboardHtmlPaste";$a.payloadType=aa.html;$a.payloadOrigin=K($a)?bc.Cyf:bc.external;
e.ULS.sendTraceTag(42071711,0,50,`BaseRangeCopyPasteHandler.PasteByHtml: trigger ProcessPasteHtml request. PasteOperationId=${$a.commandParameters.id}`);return this.wo.enj(M.L($a.commandParameters.originalDestinations),Y,Ta,$a.commandParameters.id,$a.commandParameters.ribbonCommandInfo,[$a.commandParameters.stopwatch],$a)}GQe($a){const Y={};$a&&(Y.shadowWorkbookBase64=$a.ShadowWorkbookBase64,Y.shadowWorkbookSizeExceedsLimit=$a.ShadowWorkbookSizeExceedsLimit,Y.originalSourceRangesCountExceedsLimit=
$a.OriginalSourceRangesCountExceedsLimit,Y.originalSourceRangesCount=$a.OriginalSourceRangesCount,Y.shadowWorkbookBlockedSize=$a.ShadowWorkbookBlockedSize);return Y}kwg($a,Y){const Ta=S($a),Bb=32===($a.commandParameters.commandType&32),Rb=1024===($a.commandParameters.commandType&1024);let jc=!1,vc=null,bb=null,Mb=!1;if(!Ta){jc=-1985798686===$a.commandParameters.ribbonCommandInfo.command;var hc=$a.copyContextSnapshot;if(Y)Mb=!hc.sourceItem.isFromCurrentSession(this.$);else if(hc=this.wo.j8a(hc))vc=
hc.ranges,bb=hc.sheetName,Mb=!$a.isSameSession}return this.wo.J2g(bb,vc,this.$.na.sheetName,$a.commandParameters.originalDestinations,$a.commandParameters.expandDestinations,Mb,Bb,Rb,jc,Y,Ta)}}Object(c.a)(Cd,"BaseCopyPasteHandler",null,[394,395,396]);class Yc{constructor($a){this.clipboardItems=this.key=null;this.oca=$a}Gya($a){return this.key&&this.key.isEqual($a)?this.createClipboardItems(this.clipboardItems):null}setValue($a,Y){this.key=$a;this.clipboardItems=this.createClipboardItems(Y)}createClipboardItems($a){const Y=
this.oca.create();var Ta=$a.getItem(I.plainText);Ta&&Y.setItem(I.plainText,Ta);(Ta=$a.getItem(I.shadowWorkbook))&&Y.setItem(I.shadowWorkbook,Ta);($a=$a.getItem(I.html))&&Y.setItem(I.html,$a);return Y}}Object(c.a)(Yc,"CopyCache",null,[]);class Kd extends Cd{constructor($a,Y,Ta,Bb,Rb=null){super($a,Bb,Y);this.w$b=Y;this.oca=Ta;this.mad=Rb||new Yc(this.oca);this.gridView=P.h($a);this.ga=this.gridView.ga;this.clipboardRangeFactory=$a.da.Ba(169)}getSourceItem(){const $a=M.d(this.gridView.ga.pa.selectedRanges);
return new O(this.$,$a,this.$.ea.na.sheetName,this.$.ea.gf,this.$.xa.UserSessionId)}beforeSerialize($a){$a.isSelectionAllowed=!1;$a.isAsyncCopy=!1;$a.isFromCache=!1;$a.encounteredDeploymentErrors=!1;$a.plainTextPayloadSize=0;$a.shadowWorkbookPayloadSize=0;$a.htmlPayloadSize=0;$a.clientSideCopyTime=0;const Y=new Fa.a(this.$.ua),Ta=$a.sourceItem;$a.isSelectionAllowed=zb.a.all(Ta.ranges,Bb=>this.isSelectionAllowed(Y,Bb));$a.isSelectionAllowed&&this.wo.Lkf(Ta.ranges,$a.commandParameters.commandType)}oQa($a){return this.gridView.Ca.z7()&&
P.j(this.gridView,$a)}jij($a,Y,Ta,Bb){let Rb=!1,jc=1===Y.commandParameters.commandType,vc=Bb[0].Bw;1===Ta.ranges.length&&1===Bb.length?x.EwaSettings.isChangeGateEnabled("OfficeVSO:5593878_PasteCSE_CCPErrorTests1")&&jc&&1!==vc&&vc!==Ta.ranges[0].Bw?$a.cseStatus=17:Rb=this.w$b.oed($a,M.L(Ta.ranges),Ta.sheetName,M.L($a.commandParameters.expandDestinations),this.$.ea.na.sheetName,jc):$a.cseStatus=5;Rb&&P.h(this.$).Mh.$P($a.commandParameters.stopwatch.id,ub.BasicTelemetryCalculator.xO);return this.Rhj($a,
Ta,M.u(this.$.na.sheetName,null,Bb),Y.commandParameters.commandType,Rb)}isSelectionAllowed($a,Y){return $a.uGb(Y,this.gridView)}Rhj($a,Y,Ta,Bb,Rb){Y=M.u(Y.sheetName,null,Y.ranges);$a.pasteResult="SameSessionPaste";$a.payloadOrigin=bc.n$f;$a.payloadType=aa.YRg;e.ULS.sendTraceTag(537167829,0,50,`BaseRangeCopyPasteHandler.PasteSameSession: trigger PasteRange request. PasteOperationId=${$a.commandParameters.id}`);return this.wo.pasteRange($a.commandParameters.ribbonCommandInfo,Y,Ta,Bb,$a.commandParameters.commandType,
[$a.commandParameters.stopwatch],$a,Rb,null,null)}}Object(c.a)(Kd,"BaseRangeCopyPasteHandler",Cd,[]);var oc=a(38);class eb{constructor($a){this.WV=new oc.a(!0);this.$=$a}onDeferredPasteStarted($a){this.WV.Pb($a.id)||this.WV.add($a.id,!0);if(0<this.WV.count){const Y=Object(Va.b)("OfficeVSO:7811663_ConvertBusinessBarManagerService2")?Object(U.d)(ob.a.resolve(ja.h,{Wa:0})):Ja.GetServiceTaskFactory.Za(this.$.da,5,4,0);Ba.TaskExtensions.za(Y,()=>{Y.result.oh(28,null)},this.$.ka,3)}}onDeferredPasteCompleted($a){const Y=
0<this.WV.count;this.WV.Pb($a.id)&&this.WV.remove($a.id);if(Y&&!this.WV.count){const Ta=Object(Va.b)("OfficeVSO:7811663_ConvertBusinessBarManagerService2")?Object(U.d)(ob.a.resolve(ja.h,{Wa:0})):Ja.GetServiceTaskFactory.Za(this.$.da,5,4,0);Ba.TaskExtensions.za(Ta,()=>{Ta.result.removeEntry(28)},this.$.ka,3)}}}Object(c.a)(eb,"DeferredPasteTracker",null,[]);var yb;(function($a){$a[$a.none=0]="none";$a[$a.loadClipboardFromServerFailed=1]="loadClipboardFromServerFailed";$a[$a.loadCopiedDataFromServerFailed=
2]="loadCopiedDataFromServerFailed";$a[$a.asyncCopyCanceled=3]="asyncCopyCanceled";$a[$a.loadCopiedArtDataFromServerFailed=4]="loadCopiedArtDataFromServerFailed"})(yb||(yb={}));Object(c.b)("CopyErrorType",yb);var zc=a(979),dd=a(1176);class od extends zc.a{constructor($a,Y=null){super(yb[$a]);this.copyErrorName=0;this.ewaErrors=null;this.copyErrorName=$a;this.ewaErrors=Y;if(null===Y||void 0===Y?0:Y.length)this.innerError=new dd.a(Y,null)}}Object(c.a)(od,"CopyInnerError",zc.a,[]);var Ed=a(129);class ce extends Kd{constructor($a,
Y,Ta,Bb=null){super($a,Y,Ta,"AcrossSessionRangeCopyPasteHandler",Bb);this.WV=new eb($a)}serialize($a){const Y=$a.sourceItem,Ta={};let Bb=this.mad.Gya(Y);if(Bb)Ta.synchronousResult=Bb,$a.isFromCache=!0,$a.clientSideCopyTime=$a.commandParameters.stopwatch.vd;else{let jc=null;var Rb=M.G(Y.ranges);if(!Ka.a.Lrf()&&this.oQa(Rb)){e.ULS.sendTraceTag(537167936,0,50,"AcrossSessionRangeCopyPasteHandler.Serialize: All data is loaded prepare the data in the client side.");Rb=this.clipboardRangeFactory.create(Rb);
try{jc=Rb.toString(),Bb=this.oca.create(),Bb.setItem(I.plainText,jc),this.mad.setValue(Y,Bb),Ta.synchronousResult=Bb,$a.clientSideCopyTime=$a.commandParameters.stopwatch.vd}finally{Rb&&Rb.dispose()}}else $a.isAsyncCopy=!0,Ta.synchronousResult=this.oca.create(),Ta.synchronousResult.setItem(I.plainText,this.R4c);Ta.asynchronousResult=this.gmd($a,Y,jc)}$a.syncClipboardItemsKeys=wa(Ta.synchronousResult);return Ta}shouldWaitForCopyToComplete($a){if(!$a||!$a.copyContextSnapshot)return e.ULS.sendTraceTag(537167907,
0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: pasteContext or pasteContext.CopyContextSnapshot is not define, return false."),!1;e.ULS.shipAssertTag(537167906,0,!!this.$.xa,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: this.EwaControl.BootstrapContext shouldn't be null");if($a.copyContextSnapshot.sessionId===this.$.xa.UserSessionId)return e.ULS.sendTraceTag(537167905,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: Same session copy scenario, return false."),
!1;e.ULS.sendTraceTag(537167904,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0}onDeferredPasteStarted($a){this.WV.onDeferredPasteStarted($a)}onDeferredPasteCompleted($a){this.WV.onDeferredPasteCompleted($a)}deserialize($a){$a.isClipboardDataContainShadowWorkbook=!(void 0===$a.clipboardItems.getItem(I.shadowWorkbook)||null===$a.clipboardItems.getItem(I.shadowWorkbook));if(P.h(this.$).ga.rf&326)return S($a)&&($a.wasLastCopyExternal=!0),Promise.reject(new va.a(17));
var Y=this.kwg($a,!1);if(0!==Y)return Promise.reject(new va.a(S($a)?18:$a.isSameSession?19:20,void 0,void 0,void 0,Y));var Ta=$a.copyContextSnapshot,Bb=this.wo.j8a(Ta);if(S($a))return this.Vwc($a);Y=$a.commandParameters.originalDestinations;if(Bb&&$a.isSameSession)return this.jij($a,Ta,Bb,Y);if(516!==$a.commandParameters.commandType){if(({IY:Ta}=this.drg($a.clipboardItems)).returnValue){$a.isShadowWorkbookParsedSuccessfully=!0;let Rb=Bb=null;x.EwaSettings.getBooleanFeatureGate(ea.a.Swb,!1)?Bb=M.r(Y,
this.$):Rb=M.v(M.L(Y),this.$);return this.Ghj($a,Rb,Bb,Ta)}if($a.isClipboardInaccessible)return Promise.reject(new va.a(8));if(36!==$a.commandParameters.commandType)return this.sMd($a)}return Promise.reject(new va.a(6))}beforePaste($a){this.$.da.Ba(373).NHj($a);$a.indicationDisplayScheduled=!0}Y$j($a){let Y;if(!($a&&$a.SourceRanges&&$a.SourceRanges.Ranges&&$a.SourceRanges.Ranges.length&&($a.OriginalSourceRangesCountExceedsLimit||$a.OriginalSourceMultiRange&&$a.OriginalSourceMultiRange.Ranges&&$a.OriginalSourceMultiRange.Ranges.length)))return{returnValue:!1,
IY:null};var Ta=$a.SourceRanges.Ranges[0];if(!$a.ShadowWorkbookBase64&&!$a.ShadowWorkbookSizeExceedsLimit)return{returnValue:!1,IY:null};Y=this.GQe($a);Y.rangeRowStart=Ta.FirstRow;Y.rangeRowEnd=Ta.LastRow;Y.rangeColumnStart=Ta.FirstColumn;Y.rangeColumnEnd=Ta.LastColumn;Y.sourceClientPath=$a.SourceClientPath;Y.sourceSheetName=$a.SourceSheetName;Y.sourceWorkbookName=$a.SourceWorkbookName;if(!$a.OriginalSourceRangesCountExceedsLimit)for($a=$a.OriginalSourceMultiRange.Ranges,Y.originalSourceRanges=Array($a.length),
Ta=0;Ta<$a.length;++Ta)Y.originalSourceRanges[Ta]=[$a[Ta].FirstRow,$a[Ta].FirstColumn,$a[Ta].LastRow,$a[Ta].LastColumn];return{returnValue:!0,IY:Y}}drg($a){let Y;Y=null;$a=$a.getItem(I.shadowWorkbook);if(!$a)return{returnValue:!1,IY:Y};Y=JSON.parse($a);return{returnValue:this.gKi(Y),IY:Y}}gKi($a){return!!$a&&(!!$a.shadowWorkbookBase64||$a.shadowWorkbookSizeExceedsLimit)&&void 0!==$a.rangeRowStart&&void 0!==$a.rangeRowEnd&&void 0!==$a.rangeColumnStart&&void 0!==$a.rangeColumnEnd}Ghj($a,Y,Ta,Bb){e.ULS.shipAssertTag(537167903,
0,!!Bb,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadowWorkbookPayload shouldn't be null");sb.AFrameworkApplication.WS("Microsoft.Office.Excel.Server.Flighting.IDenyListNewCopyPasteExperienceAcrossSessions");$a.pasteResult="CrossSessionPaste";$a.payloadOrigin=bc.$bd;$a.payloadType=aa.shadowWorkbook;$a.shadowWorkbookPayloadSize=kc(Bb);$a.shadowWorkbookSizeExceedsLimit=vb(Bb);Bb.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&($a.originalSourceRangesCountExceedsLimit=Bb.originalSourceRangesCountExceedsLimit);
if($a.shadowWorkbookSizeExceedsLimit)return e.ULS.sendTraceTag(34415003,0,15,`AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadow workbook length(${$a.shadowWorkbookPayloadSize}) is over the limit(${m.a.ssc}). reject the paste request. ShadowWorkbookSizeExceedsLimit: ${Bb.shadowWorkbookSizeExceedsLimit}`),Promise.reject(new va.a(1));if(1028===$a.commandParameters.commandType&&$a.originalSourceRangesCountExceedsLimit)return e.ULS.sendTraceTag(572617859,0,15,`AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: Original source ranges count(${Bb.originalSourceRangesCount}) is over the limit(${m.a.$Ui}). Reject the paste request. OriginalSourceRangesCountExceedsLimit: ${Bb.originalSourceRangesCountExceedsLimit}`),
Promise.reject(new va.a(1));e.ULS.sendTraceTag(537167902,0,50,`AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: trigger Paste request. PasteOperationId=${$a.commandParameters.id}`);return this.wo.xVf($a.commandParameters.ribbonCommandInfo,Y,Ta,Bb,[$a.commandParameters.stopwatch],$a)}gmd($a,Y,Ta){e.ULS.shipAssertTag(537167901,0,!!$a,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: copyContext shouldn't be null");const Bb=$a.commandParameters.stopwatch.vd,Rb=M.u(Y.sheetName,null,
Y.ranges);return new Promise((jc,vc)=>{e.ULS.sendTraceTag(26035421,0,50,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data for copy Id: ${$a.id}`);this.wo.copy(Rb,$a.commandParameters,bb=>{$a.requestTelemetryData=bb.RequestTelemetryData;$a.serverRequestTimeInMs=$a.commandParameters.stopwatch.vd-Bb;if(Oa.a.ng(bb.Errors))if(Oa.a.Ija(bb.Errors))$a.encounteredDeploymentErrors=!0,bb=Oa.a.Uc(bb.Errors),e.ULS.sendTraceTag(537167898,0,15,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${bb}. copy Id: ${$a.id}`);
else{var Mb=Oa.a.Uc(bb.Errors),hc=[-591377245];if(ea.a.ulh&&Oa.a.Ph(bb.Errors,hc)&&(hc=this.vz(Rb))){hc=String.format(this.qn.Xb(218),hc.toLocaleUpperCase());var Cc=Ed.d(bb.Errors,mc=>-591377245===mc.MessageId);bb.Errors[Cc].Description=hc;e.ULS.sendTraceTag(509125507,0,10,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: Added range string to CopyMaxCellCountExceededError. copy Id: ${$a.id}`)}e.ULS.sendTraceTag(26035419,0,10,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${Mb}. copy Id: ${$a.id}`);
vc(new od(2,bb.Errors))}else if(e.ULS.sendTraceTag(537167900,0,50,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeed for copy Id: ${$a.id}`),$a.markForCancellation)vc(new od(3,bb.Errors));else{Mb=bb.Result;Cc=Mb.PlainTextResult;void 0!==Ta&&null!==Ta&&(Cc=Ta);void 0!==Cc&&null!==Cc&&($a.plainTextPayloadSize=Cc.length);hc=this.oca.create();if(({IY:Wb}=this.Y$j(Mb)).returnValue){$a.shadowWorkbookPayloadSize=kc(Wb);$a.shadowWorkbookSizeExceedsLimit=vb(Wb);$a.originalSourceRangesCountExceedsLimit=
Mb.OriginalSourceRangesCountExceedsLimit;var Wb=JSON.stringify(Wb);hc.setItem(I.shadowWorkbook,Wb)}hc.setItem(I.plainText,Cc);Ka.a.Lrf()&&(Cc=Mb.HtmlResult,$a.htmlSizeExceedsLimit=Mb.HtmlSizeExceedsLimit,void 0!==Cc&&null!==Cc&&($a.htmlPayloadSize=Cc.length),hc.setItem(I.html,Cc));$a.copyTotalSizeExceedsLimit=Mb.CopyTotalSizeExceedsLimit;hc.setItem(I.z4a,$a.commandParameters.id);this.mad.setValue(Y,hc);$a.asyncClipboardItemsKeys=wa(hc);jc(hc);x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",
!1)&&(Mb=1===$a.commandParameters.commandType?8:7,(hc=this.$.da.Ba(465))&&hc.M$(Mb,bb))}},bb=>{$a.serverRequestTimeInMs=$a.commandParameters.stopwatch.vd-Bb;bb=Ra.a.vf(bb.data);const Mb=Oa.a.Uc(bb);e.ULS.sendTraceTag(537167897,0,10,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${Mb}. copy Id: ${$a.id}`);vc(new od(2,bb))},[$a.commandParameters.stopwatch])})}vz($a){return null==$a||null==$a.Ranges||0===$a.Ranges.length?(e.ULS.sendTraceTag(509125506,
0,15,"AcrossSessionRangeCopyPasteHandler.GetRangeString sourceRange is null"),null):(1===$a.Ranges.length?M.C($a.Ranges[0]):M.G(M.g($a.Ranges))).toString()}}Object(c.a)(ce,"AcrossSessionRangeCopyPasteHandler",Kd,[]);class wc{constructor($a,Y,Ta,Bb,Rb,jc=null,vc=null){this.floatingObjectId=$a;this.commandParameters=Y;this.DH=Ta;this.Qth=Bb;this.Ala=jc;this.hVb=vc;this.jlh=Rb}}Object(c.a)(wc,"CopyArtRequest",null,[]);class ed{constructor($a,Y,Ta,Bb,Rb,jc,vc,bb,Mb){this.promise=null;this.ribbonCommandInfo=
$a;this.destination=Y;this.nTe=Ta;this.hVb=Rb;this.IY=jc;this.item=vc;this.pasteContext=bb;this.ARa=Ta||Y.FirstRow+"_"+Y.FirstColumn;this.jsf=!0;this.EKe=Mb}}Object(c.a)(ed,"PasteArtRequest",null,[]);class md{constructor($a,Y){this.iPb=new X.a;this.u2a=$a;this.$=Y;this.Gnj=Ta=>Promise.resolve(Ta);this.jLb=Ta=>Promise.reject(Ta)}Qmi($a){if(this.IFi($a.ARa)){e.ULS.sendTraceTag(537167681,5,50,`PasteArtRequestManager.HandleRequest: Enqueued paste request as a result of rapid paste on same destination: ${$a.ARa}`);
const Y=this.iPb.ma($a.ARa);this.iPb.ia($a.ARa,$a);const Ta=Y.promise;Y.jsf=!1;return this.MDh($a,Ta)}this.iPb.ia($a.ARa,$a);return this.$Mi($a)}IFi($a){return this.iPb.Pb($a)}$Mi($a){return new Promise((Y,Ta)=>{$a.promise=this.u2a.sVf($a).then(Bb=>{Y(null);return this.xvc($a,Bb)},Bb=>{Ta(null);return this.jLb(Bb)})})}MDh($a,Y){return new Promise((Ta,Bb)=>{$a.promise=Y.then(Rb=>{this.dgk($a,Rb);return this.u2a.sVf($a).then(jc=>{Ta(null);return this.xvc($a,jc)},jc=>{Bb(null);return this.jLb(jc)})},
Rb=>this.jLb(Rb))})}xvc($a,Y){$a.jsf&&(this.Oeh($a.ARa),this.DWd($a,Y));return this.Gnj(Y)}Oeh($a){this.iPb.remove($a)}DWd($a,Y){const Ta=this.rei();$a.ARa===Ta&&this.u2a.DWd($a.destination,Y,$a.item.type)}rei(){var $a=P.h(this.$).ga.Sa.activeFloatingObjectControlId;$a||($a=M.v(P.h(this.$).ga.pa.activeCell,this.$),$a=$a.FirstRow+"_"+$a.FirstColumn);return $a}dgk($a,Y){$a.destination=null;$a.nTe=Y}}Object(c.a)(md,"PasteArtRequestManager",null,[]);var Yd=a(210),$d=a(135),bd=a(109);class Vd extends Cd{constructor($a,
Y,Ta,Bb,Rb=null){super($a,"ArtCopyPasteHandler");this.Ifh="XLO";this.Jfh="3";this.WV=new eb($a);this.oca=Y;this.u2a=Ta;this.ga=P.h($a).ga;this.lad=Rb||new Yc(this.oca);this.Hhj=new md(Ta,$a);this.ttb=Bb}getSourceItem(){e.ULS.shipAssertTag(537167896,0,!!this.ga.Sa.activeFloatingObjectControlId,"Expecting a floating object to be currently selected for copy");e.ULS.sendTraceTag(537167895,0,50,`ArtCopyPasteHandler.GetSourceItem: Creating ArtSourceItem with FloatingObjectId=[${this.ga.Sa.activeFloatingObjectControlId}]`);
return new G(this.ga.Sa.activeFloatingObjectControlId,this.$.ea.na.sheetName,this.$.ea.gf,this.$.xa.UserSessionId,this.ga.Sa.Pc.floatingObject.type)}beforeSerialize($a){$a&&$a.commandParameters?($a?($a.isAsyncCopy=!1,$a.isSelectionAllowed=!1,$a.isFromCache=!1,$a.plainTextPayloadSize=0,$a.shadowWorkbookPayloadSize=0,$a.htmlPayloadSize=0,$a.htmlSizeExceedsLimit=!1,$a.clientSideCopyTime=0,$a.encounteredDeploymentErrors=!1,$a.shadowWorkbookSizeExceedsLimit=!1,$a.originalSourceRangesCountExceedsLimit=
!1,$a.copyTotalSizeExceedsLimit=!1):e.ULS.sendTraceTag(537167826,0,10,"CommonCopyPasteUtils.InitializeCopyContext: copyContext is null."),$a.commandParameters.copyPasteTargetType=2):e.ULS.sendTraceTag(537167894,0,10,"ArtCopyPasteHandler.BeforeSerialize: copyContext or copyContext.CommandParameters is null.")}serialize($a){const Y=$a.sourceItem,Ta={};if(!Y)return e.ULS.sendTraceTag(537167893,0,10,"ArtCopyPasteHandler.Serialize: artSourceItem should not be null"),Ta;if(!this.UIi())return e.ULS.sendTraceTag(36824456,
0,50,"ArtCopyPasteHandler.Serialize: Unsupported floating object type. This will clear the clipboard"),Ta;e.ULS.sendTraceTag(537167892,0,50,`ArtCopyPasteHandler.Serialize: Serializing ArtSourceItem with FloatingObjectId=[${Y.activeFloatingObjectControlId}]`);this.INd();let Bb=this.lad.Gya(Y);if(Bb)Ta.synchronousResult=Bb,$a.isFromCache=!0,$a.isAsyncCopy=!1,$a.clientSideCopyTime=$a.commandParameters.stopwatch.vd,1===$a.commandParameters.commandType&&this.$.Ed(2045211913,$a.commandParameters.ribbonCommandInfo.method,
$a.commandParameters.ribbonCommandInfo.Jf,null);else{$a.isFromCache=!1;$a.isAsyncCopy=!0;Bb=this.oca.create();if($a.commandParameters.uploadToClipService){const Rb={};Rb["data-clipservice-ccpid"]=$a.commandParameters.id;Rb["data-pkey"]=$a.commandParameters.pKey;Rb["data-clipservice-type"]=$a.commandParameters.clipServiceDataType;Rb["data-clipservice-count"]=$a.commandParameters.objectCount.toString();Rb["data-clipservice-dc"]=$a.commandParameters.clipServiceDataCenter;Rb["data-clipservice-client"]=
this.Ifh;Rb["data-TimeStamp"]=(new Date).toUTCString();Rb["data-clipservice-version"]=this.Jfh;Bb.setItem(I.l_g,JSON.stringify(Rb))}Ta.synchronousResult=this.HTg(Bb);Ta.asynchronousResult=this.gmd($a,Y,Bb)}$a.syncClipboardItemsKeys=wa(Ta.synchronousResult);return Ta}HTg($a){e.ULS.shipAssertTag(537167891,0,!!this.ga.Sa.Pc,"Expecting a floating object to be currently selected for copy");$a||($a=this.oca.create());const Y=this.ga.Sa.Pc.jAb();Y&&$a.setItem(I.html,`<img src='${Y}'>`);return $a}INd(){const $a=
this.ga.Sa.Pc;this.ttb.INd($d.a.xvb($a.floatingObject),$d.a.Lfh($a.Jr))}shouldWaitForCopyToComplete(){e.ULS.sendTraceTag(537167890,0,50,"ArtCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0}onDeferredPasteStarted($a){this.WV.onDeferredPasteStarted($a)}onDeferredPasteCompleted($a){this.WV.onDeferredPasteCompleted($a)}deserialize($a){var Y=S($a),Ta=null;let Bb=null;var Rb=!1;if(!Y){Ta=$a.copyContextSnapshot;Bb=Ta.sourceItem;if(!Bb)return Promise.reject(new va.a(10));Rb=Bb.isFromCurrentSession(this.$)}var jc=
this.kwg($a,!0);if(0!==jc)return Promise.reject(new va.a(Y?18:Rb?19:20,void 0,void 0,void 0,jc));if(Y)return this.Vwc($a);if(!Rb&&!Vd.SAi(Bb))return $a=`User attempted to paste art of type [${Bb.type}] between sessions.`,e.ULS.sendTraceTag(537167889,0,50,$a),Promise.reject(new va.a(11,void 0,void 0,$a));if(Ta.isAsyncSerializeFailed)return Promise.reject(new va.a(16,void 0,void 0,"Last async serialize failed, therefore no current shadow workbook payload to paste"));let vc;try{const bb=$a.clipboardItems.getItem(I.shadowWorkbook);
vc=JSON.parse(bb)}catch(bb){return $a=copyPasteInfra.getStringifiedError(bb),e.ULS.sendTraceTag(537167888,0,10,`ArtCopyPasteHandler.Deserialize: Failed to parse shadow workbook JSON with exception: ${$a}`),Promise.reject(new va.a(12,void 0,bb))}vc.floatingObjectId!==Bb.activeFloatingObjectControlId?e.ULS.sendTraceTag(537167887,0,10,`ArtCopyPasteHandler.Deserialize: FloatingObjectId mismatch! Deserializing with artSourceItem.ActiveFloatingObjectControlId=[${Bb.activeFloatingObjectControlId}], shadowWorkbookPayload.FloatingObjectId=[${vc.floatingObjectId}]`):
e.ULS.sendTraceTag(537167886,0,50,`ArtCopyPasteHandler.Deserialize: Deserializing with artSourceItem.ActiveFloatingObjectControlId=[${Bb.activeFloatingObjectControlId}], shadowWorkbookPayload.FloatingObjectId=[${vc.floatingObjectId}]`);if(!vc||!vc.shadowWorkbookBase64)return Promise.reject(new va.a(13,void 0,void 0,`shadowWorkbookPayload is null = ${!vc}`));$a.isShadowWorkbookParsedSuccessfully=!0;$a.shadowWorkbookPayloadSize=kc(vc);$a.shadowWorkbookSizeExceedsLimit=vb(vc);$a.payloadOrigin=Rb?bc.n$f:
bc.$bd;$a.payloadType=aa.Zzg;if(vb(vc))return $a=`Shadow workbook size [${$a.shadowWorkbookPayloadSize}] is over the limit [${m.a.ssc}]. ShadowWorkbookSizeExceedsLimit: ${vc.shadowWorkbookSizeExceedsLimit}`,e.ULS.sendTraceTag(36304156,0,15,`ArtCopyPasteHandler.Deserialize: ${$a}`),Promise.reject(new va.a(1,void 0,void 0,$a));Ta=Y=null;P.h(this.$).ga.rf&326?Ta=P.h(this.$).ga.Sa.activeFloatingObjectControlId:Y=this.$.na&&this.$.na.activeCell?M.v(this.$.na.activeCell,this.$):M.v(M.L($a.commandParameters.originalDestinations),
this.$);Rb=null;if(this.ttb.ihg(Bb))try{Rb=this.ttb.oed()}catch(bb){jc=copyPasteInfra.getStringifiedError(bb),e.ULS.sendTraceTag(537167885,0,10,`ArtCopyPasteHandler.Deserialize: Exception encountered while performing client-side estimation. Exception: ${jc}`)}return this.Hhj.Qmi(new ed($a.commandParameters.ribbonCommandInfo,Y,Ta,$a.commandParameters.commandType,[$a.commandParameters.stopwatch],vc,Bb,$a,Rb))}Vwc($a){$a.wasLastCopyExternal=!0;if($a.clipboardItems.getItem("image/png")){const Y=$a.commandParameters.stopwatch.vd;
$a.payloadType=aa.F5g;return U.c(this.$.Ed(1403967063,$a.commandParameters.ribbonCommandInfo.method,$a.commandParameters.ribbonCommandInfo.Jf,{["dataUrl"]:$a.clipboardItems.getItem("image/png")})).then(Ta=>{$a.serverRequestTimeInMs=$a.commandParameters.stopwatch.vd-Y;return Ta?Promise.resolve(null):Promise.reject(new va.a(15))},()=>{$a.serverRequestTimeInMs=$a.commandParameters.stopwatch.vd-Y;return Promise.reject(new va.a(15))})}e.ULS.shipAssertTag(537167884,0,!1,"Should not paste external content that is not image via ArtCopyPasteHandler");
return super.Vwc($a)}UIi(){const $a=P.h(this.$).ga;return $a.Sa.activeFloatingObjectControlId&&$a.Sa.Pc&&$a.Sa.Pc.floatingObject?$a.Sa.Pc.floatingObject.b3d():!1}gmd($a,Y,Ta){return new Promise((Bb,Rb)=>{const jc=$a.commandParameters.stopwatch.vd;e.ULS.sendTraceTag(41562516,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data...");this.u2a.nlh(new wc(Y.activeFloatingObjectControlId,$a.commandParameters,vc=>{$a.requestTelemetryData=vc.RequestTelemetryData;
$a.serverRequestTimeInMs=$a.commandParameters.stopwatch.vd-jc;if(Oa.a.ng(vc.Errors))if(Oa.a.Ija(vc.Errors))$a.encounteredDeploymentErrors=!0,vc=Oa.a.Uc(vc.Errors),e.ULS.sendTraceTag(537167879,0,15,`ArtCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${vc}`);else{var bb=Oa.a.Uc(vc.Errors);e.ULS.sendTraceTag(36229122,0,10,`ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${bb}`);Rb(new od(4,
vc.Errors))}else if(e.ULS.sendTraceTag(537167883,0,50,`ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeeded for FloatingObjectId=[${Y.activeFloatingObjectControlId}].`),$a.markForCancellation)Rb(new od(3,vc.Errors));else{if(Oa.a.Iq(vc.Errors)){var Mb=Oa.a.Uc(vc.Errors);e.ULS.sendTraceTag(537167882,0,50,`ArtCopyPasteHandler.GetCopiedDataFromServer: Server messages present. Errors: ${Mb}`)}if(Mb=vc.Result){Mb=this.GQe(Mb);Mb.floatingObjectId=Y.activeFloatingObjectControlId;
$a.shadowWorkbookPayloadSize=kc(Mb);$a.shadowWorkbookSizeExceedsLimit=vb(Mb);try{bb=JSON.stringify(Mb)}catch(hc){Rb(new va.a(14,void 0,hc,`Failed to stringify shadow workbook: copyContext.ShadowWorkbookPayloadSize: [${$a.shadowWorkbookPayloadSize}], shadowWorkbookPayload.FloatingObjectId: [${Mb.floatingObjectId}]`));return}e.ULS.shipAssertTag(537167881,0,!!Ta,"Expecting syncClipboardItems to be defined");Ta.setItem(I.shadowWorkbook,bb);1===$a.commandParameters.commandType&&(this.slj(Y.type,Y.activeFloatingObjectControlId,
vc.StateId),this.deleteFloatingObject(Y.activeFloatingObjectControlId,Y.type));this.lad.setValue(Y,Ta);$a.asyncClipboardItemsKeys=wa(Ta);Bb(Ta)}else e.ULS.sendTraceTag(537167880,0,50,`ArtCopyPasteHandler.GetCopiedDataFromServer: Result form server returned null, copied item id: ${Y.activeFloatingObjectControlId}`),Bb(this.lad.Gya(Y))}},$a.commandParameters.commandType,Y.type,vc=>{$a.serverRequestTimeInMs=$a.commandParameters.stopwatch.vd-jc;vc=Ra.a.vf(vc.data);1===$a.commandParameters.commandType&&
this.u2a.Ebk(Y.type,Y.activeFloatingObjectControlId);const bb=Oa.a.Uc(vc);e.ULS.sendTraceTag(537167878,0,10,`ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${bb}`);Rb(new od(4,vc))},[$a.commandParameters.stopwatch]))})}deleteFloatingObject($a,Y){$a=Yd.a.vA(Y,$a);if($a=bd.a(this.$).Ns($a))bd.a(this.$).deleteFloatingObject($a,14,!0),P.h(this.$).ga.Sa.eC=null}slj($a,Y,Ta){const Bb=this.$.da.Ba(277);if(Bb){let jc=null;$a=Yd.a.vA($a,Y);$a=bd.a(this.$).Ns($a);if(null===
$a||void 0===$a?0:$a.Uj)jc=$a.Uj.block;if(jc){var Rb=$a.floatingObject.Th();Bb.c4b(()=>!jc.qj.Pb(Rb),Ta,"CutArt")}}}static SAi($a){return 1===$a.type||5===$a.type||x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionChartAndInkPasteEnabled",!1)&&(0===$a.type||8===$a.type)}}Object(c.a)(Vd,"ArtCopyPasteHandler",Cd,[]);var De=a(62);class Pe extends Xa{constructor($a,Y,Ta,Bb){super($a);this.isFromCurrentSession=!1;this.left=this.top=0;this.isFromCurrentSession=Y;this.top=Ta;this.left=
Bb}}Object(c.a)(Pe,"MacroRecorderPasteArtPayload",Xa,[]);class Zb{constructor($a,Y){this.$=$a;this.ttb=Y}Bsi($a,Y,Ta,Bb,Rb,jc=null,vc=null){const bb=this.$.qa.va.Lc();let Mb=null;const hc={CopyPasteTargetType:2};hc.FloatingObjectId=$a;hc.CopyOperationId=Ta.id;Ta.floatingObjectType=Y;hc.UploadToClipService=Ta.uploadToClipService;hc.PKey=Ta.pKey;hc.ClipServiceDataCenter=Ta.clipServiceDataCenter;let Cc=0;2===Rb?(Rb=505,Cc=16,Mb=(Wb,mc,Mc)=>Qa(this.$.qa.va,hc,ka.b(Wb,Bb),jc?ka.a(mc,jc):mc,Mc,Ta.ribbonCommandInfo,
bb,vc)):(Rb=179,Mb=(Wb,mc,Mc)=>{this.Lzh(Y,$a);this.$.Sz();return Db(this.$.qa.va,hc,ka.b(Wb,Bb),jc?ka.a(mc,jc):mc,Mc,Ta.ribbonCommandInfo,bb,vc)});this.$.userOperationManager.Bd(new na.a(Rb,0,Mb,Cc|64),Ta.ribbonCommandInfo)}Lzh($a,Y){var Ta=Yd.a.vA($a,Y);(Ta=bd.a(this.$).Ns(Ta))?(P.h(this.$).ga.Sa.LI(Ta),Ta.isVisible=!1):e.ULS.sendTraceTag(537167876,0,50,`ArtCopyPasteUtils.DoCutClientEstimation: floatingObjectcontrol is null. FloatingObjectType : ${$a}, FloatingObjectId: ${Y}`)}Ebk($a,Y){$a=Yd.a.vA($a,
Y);if($a=bd.a(this.$).Ns($a))$a.isVisible=!0}nlh($a){this.Bsi($a.floatingObjectId,$a.jlh,$a.commandParameters,$a.DH,$a.Qth,$a.Ala,$a.hVb)}eti($a,Y,Ta,Bb,Rb,jc,vc,bb=null,Mb=!0){return new Promise((hc,Cc)=>{const Wb=jc.commandParameters.stopwatch.vd;this.$Wd($a,Rb,Y,Ta,mc=>{jc.requestTelemetryData=mc.RequestTelemetryData;jc.serverRequestTimeInMs=jc.commandParameters.stopwatch.vd-Wb;if(Oa.a.Ija(mc.Errors))jc&&(jc.encounteredDeploymentErrors=!0),mc=Oa.a.Uc(mc.Errors),e.ULS.sendTraceTag(537167875,0,15,
`ArtCopyPasteUtils.PasteArt: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${mc}`);else if(Oa.a.ng(mc.Errors)){var Mc=Oa.a.Uc(mc.Errors);e.ULS.sendTraceTag(36459652,0,10,`ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: ${Mc}`);Cc(new va.a(9,mc.Errors))}else mc.Result?(Mc=mc.Result,e.ULS.sendTraceTag(537167874,0,50,"ArtCopyPasteUtils.PasteArt: PasteArt succeeded."),this.Elj(vc,Mc.FloatingObjectId,mc.StateId),hc(Zb.Etd(Mc.FloatingObjectId))):(e.ULS.sendTraceTag(537167873,
0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed, result returned from server is null."),Cc(new va.a(9,mc.Errors)))},mc=>{jc.serverRequestTimeInMs=jc.commandParameters.stopwatch.vd-Wb;mc=Ra.a.vf(mc.data);e.ULS.sendTraceTag(537167872,0,10,`ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: ${Oa.a.Uc(mc)}`);Cc(new va.a(9,mc))},Bb,bb,Mb)})}Elj($a,Y,Ta){const Bb=this.$.da.Ba(277);if(Bb){const Rb=Yd.a.vA($a,Zb.Etd(Y));Bb.c4b(()=>!!bd.a(this.$).Ns(Rb),Ta,"PasteArt")}}l6d($a,Y){Y&&this.ttb.l6d($a,Yd.a.vA($a.type,
Y))}sVf($a){return this.eti($a.ribbonCommandInfo,$a.destination,$a.nTe,$a.hVb,$a.IY,$a.pasteContext,$a.item.type,$a.EKe,$a.item.isFromCurrentSession(this.$)).then(Y=>Y,Y=>{this.l6d($a.item,$a.EKe);return Promise.reject(Y)})}DWd($a,Y,Ta){$a||($a=M.v(P.h(this.$).ga.pa.activeCell,this.$));P.h(this.$).Eoc(M.E($a),1)?bd.a(this.$).d$(Ta,Y,!0):P.h(this.$).ga.Sa.FKa($a,Y,Ta).continueWith(Bb=>{Bb.result?e.ULS.sendTraceTag(537167843,5,50,`ArtCopyPasteUtils.SelectPastedObject: Selection succeeded in async manner for object ID [${Y}]`):
e.ULS.sendTraceTag(537167842,5,10,`ArtCopyPasteUtils.SelectPastedObject: Selection failed in async manner for object ID [${Y}]`)})}$Wd($a,Y,Ta,Bb,Rb,jc,vc,bb,Mb=!0){const hc=this.$.qa.va.Lc(),Cc={};Cc.ShadowWorkbookBase64=Y.shadowWorkbookBase64;Cc.FloatingObjectId=Bb;Cc.DestinationRanges=Ta?M.s(Ta):null;Cc.CopyPasteTargetType=2;Cc.ClientEstimationFloatingObjectId=bb;Ta=new na.a(503,0,(Wb,mc,Mc)=>{bb||this.$.Sz();return sa(this.$.qa.va,Cc,ka.b(Wb,Rb),ka.a(mc,jc),Mc,null,hc,vc)},void 0,()=>{if(Mb){let Wb;
Wb=De.a.ij(De.a.nd(Cc));Wb.FloatingObjectId=Y.floatingObjectId;Cc.DestinationRanges||(Wb.DestinationRanges=M.p(this.$.ua.na.sheetName,"",0,0,0,0));return new Pe(Wb,Mb,0,0)}return new Pe(Cc,Mb,0,0)});Ta.flags=65;this.$.userOperationManager.Bd(Ta,$a)}static Etd($a){return`${$a.length+2}.{${$a.toUpperCase()}}`}}Object(c.a)(Zb,"ArtCopyPasteUtils",null,[360]);var Vc=a(205);class Nc{constructor($a){this.jad=this.hwa=null;this.eeb=15;this.$=$a}INd($a,Y){this.hwa=$a;this.jad=Y}oed(){if(!this.hwa||!this.jad)return e.ULS.sendTraceTag(537167841,
0,15,"ArtPasteClientEstimation.DoPasteClientEstimation: copiedFloatingObjectControl and/or copiedEffectsExtents is null, aborting client side estimation."),"";const $a=$d.a.xvb(new Yd.a(this.hwa));$a.Id=Zb.Etd(k.a.create().toString());$a.Version=-1;$a.Name="";$a.IsClientEstimation=!0;var Y=this.sui($a);if(!Y)return null;const Ta=new Yd.a($a);Y.block.qj.add(Ta);Ta.mPb();const Bb=bd.a(this.$);Bb.K$b(Ta,Y);Y=Bb.Ns(Yd.a.I7h($a));!Y||Y.floatingObject.XPa||Y.floatingObject.yQa||Y.vVa(this.jad);Bb.d$($a.Type,
$a.Id,!0);return $a.Id}ihg($a){return x.EwaSettings.ya(205)&&$a.isFromCurrentSession(this.$)&&!P.h(this.$).rtl&&!P.h(this.$).Mb.tj}l6d($a,Y){this.ihg($a)&&($a=bd.a(this.$).Ns(Y))&&(e.ULS.sendTraceTag(537167840,5,50,`ArtPasteClientEstimation.UndoPasteClientEstimation: undoing client-side estimation. Removing floating object with ID: [${Y}] of type [${$a.floatingObject.type}]`),bd.a(this.$).deleteFloatingObject($a,15,!0),$a.Uj&&$a.Pfb($a.Uj,!1))}sui($a){if(!$a)return e.ULS.sendTraceTag(537167839,0,
15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: Called with null FloatingObjectData."),null;if(P.h(this.$).ga.Sa.activeFloatingObjectControlId){var Y=P.h(this.$).ga.Sa.eC.floatingObject;$a.OriginDeltaX=Y.offsetX+this.eeb;$a.OriginDeltaY=Y.offsetY+this.eeb;$a.AbsoluteLeft+=this.eeb;$a.AbsoluteTop+=this.eeb;$a.AbsoluteRight+=this.eeb;$a.AbsoluteBottom+=this.eeb;$a.ZOrder=Y.rD+1;return P.h(this.$).ga.Sa.eC.Uj}if(!this.$.na||!this.$.na.activeCell)return e.ULS.sendTraceTag(537167838,0,15,
"ArtPasteClientEstimation.InitializeFloatingObjectLocation: ActiveItem/ActiveCell is null - cannot perform estimation for grid paste."),null;var Ta=this.$.na.activeCell;Y=P.h(this.$).$Y(Ta);if(!Y)return e.ULS.sendTraceTag(537167837,0,15,`ArtPasteClientEstimation.InitializeFloatingObjectLocation: gridViewBlock for range ${Ta.toString()} is null.`),null;const Bb=fb.HelperMethods.BBb(Y.domElement,Y.jk.domElement);Ta=Y.gridView.gh(Ta,2);if(!Bb||!Ta)return e.ULS.sendTraceTag(537167836,0,15,`ArtPasteClientEstimation.InitializeFloatingObjectLocation: blockPositionRelativeToGridOrigin is null: ${!Bb}. cellPositionRelativeToGridOrigin is null: ${!Ta} .`),
null;$a.OriginDeltaX=Ta.topLeft.x-Bb.x;$a.OriginDeltaY=Ta.topLeft.y-Bb.y;$a.AbsoluteLeft=Ta.topLeft.x;$a.AbsoluteTop=Ta.topLeft.y;$a.AbsoluteRight=$a.AbsoluteLeft+Math.abs(this.hwa.AbsoluteRight-this.hwa.AbsoluteLeft);$a.AbsoluteBottom=$a.AbsoluteTop+Math.abs(this.hwa.AbsoluteBottom-this.hwa.AbsoluteTop);$a.ZOrder=this.hwa.ZOrder+100;return new Vc.a(Y.gridView.Ca.Am(Y.hashCode),Y.hashCode)}}Object(c.a)(Nc,"ArtPasteClientEstimation",null,[361]);class ld{create(){const $a=window.clipboardPlatform;return $a?
$a.createClipboardItems():null}}Object(c.a)(ld,"ClipboardItemsFactory",null,[359]);class yd{}yd.undefined="Undefined";Object(c.a)(yd,"CCPTelemetryConsts",null,[]);class sd{}sd.cells="Cells";sd.floatingObject="FloatingObject";sd.unknown="Unknown";Object(c.a)(sd,"ActiveSelection",null,[]);class ic{}ic.Xyh="DisplayNotInvoked";ic.hed="Displayed";ic.Olj="PrerequisitesNotReady";Object(c.a)(ic,"PasteIndicationDisplayStatus",null,[]);class Ic extends ce{constructor($a,Y,Ta,Bb=null){super($a,Y,Ta,Bb);this.iwa=
null}beforePaste(){e.ULS.sendTraceTag(509162378,0,50,"AcrossSessionInsertCopiedCutCellsHandler is called")}deserialize($a){$a.isClipboardDataContainShadowWorkbook=!(void 0===$a.clipboardItems.getItem(I.shadowWorkbook)||null===$a.clipboardItems.getItem(I.shadowWorkbook));this.wo.j8a($a.copyContextSnapshot);const Y=$a.commandParameters.originalDestinations;if(!$a.isClipboardDataContainShadowWorkbook)return Promise.resolve(!0);let Ta;if(({IY:Ta}=this.drg($a.clipboardItems)).returnValue){$a.isShadowWorkbookParsedSuccessfully=
!0;let Bb=null,Rb=null;x.EwaSettings.getBooleanFeatureGate(ea.a.Swb,!1)?Bb=M.r(Y,this.$):Rb=M.v(M.L(Y),this.$);return this.eij($a,Rb,Bb,Ta)}return $a.isClipboardInaccessible?Promise.reject(new va.a(8)):Promise.reject(new va.a(6))}get copyPasteInfrastructure(){var $a;null!==($a=this.iwa)&&void 0!==$a?$a:this.iwa=this.$.da.Ba(254,!0);return this.iwa}jwi($a,Y,Ta,Bb){return this.copyPasteInfrastructure?U.a(this.copyPasteInfrastructure.Mlc(null,Bb.commandParameters.ribbonCommandInfo,$a,Y,Ta,Bb)):Promise.reject(new va.a(0))}eij($a,
Y,Ta,Bb){$a.pasteResult="CrossSessionPaste";$a.payloadOrigin=bc.$bd;$a.payloadType=aa.shadowWorkbook;$a.shadowWorkbookPayloadSize=kc(Bb);$a.shadowWorkbookSizeExceedsLimit=vb(Bb);Bb.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&($a.originalSourceRangesCountExceedsLimit=Bb.originalSourceRangesCountExceedsLimit);return $a.shadowWorkbookSizeExceedsLimit?Promise.reject(new va.a(1)):1028===$a.commandParameters.commandType&&$a.originalSourceRangesCountExceedsLimit?Promise.reject(new va.a(1)):
this.jwi(Y,Ta,Bb,$a)}}Object(c.a)(Ic,"AcrossSessionInsertCopiedCutCellsHandler",ce,[]);class kd{constructor($a){this.FSc=this.kNc=this.zXc=null;this.$=$a}get KPd(){if(!this.zXc){const $a=this.$.da.Ba(254,!0);$a&&(this.zXc=new ce(this.$,$a,new ld))}return this.zXc}get mwi(){if(!this.FSc){const $a=this.$.da.Ba(254,!0);$a&&(this.FSc=new Ic(this.$,$a,new ld))}return this.FSc}get N4c(){if(!this.kNc&&this.$.da.Ba(254,!0)){const $a=new Nc(this.$);this.kNc=new Vd(this.$,new ld,new Zb(this.$,$a),$a)}return this.kNc}getCopyFlowHandler($a){const Y=
this.y3h(P.h(this.$).rf);$a.commandParameters.copyPasteHandlerName=Y.name;return Y}getPasteFlowHandler($a){var Y=$a.copyContextSnapshot;switch($a.commandParameters.ribbonCommandInfo.command){case -160032004:case -1065525230:return $a=this.mwi;default:return Y=J($a)?this.N4c:S($a)?this.KPd:(null===Y||void 0===Y?0:Y.sourceItem)&&Object.getType(Y.sourceItem)===G?this.N4c:this.KPd,$a.commandParameters.copyPasteHandlerName=Y.name,Y}}initializePasteContext($a){if($a&&($a.isSameSession=!1,$a.isShadowWorkbookParsedSuccessfully=
!1,$a.pasteResult=yd.undefined,$a.payloadOrigin=yd.undefined,$a.payloadType=yd.undefined,$a.encounteredDeploymentErrors=!1,$a.shadowWorkbookSizeExceedsLimit=!1,$a.originalSourceRangesCountExceedsLimit=!1,$a.activeSelectionType=this.k_h(),$a.indicationDisplayScheduled=!1,$a.pasteDestinationHasMergedCells=!1,$a.cseStatus=0,$a.pasteIndicationDisplayStatus=ic.Xyh,$a.copyContextSnapshot)){var Y=$a.copyContextSnapshot;const vc=B(Y.sourceItem);var Ta=Y.sourceItem;var Bb=!!Ta&&Object.getType(Ta)===G;Ta=0;
var Rb=!1;vc?(Rb=Y.sourceItem,$a.isSameSession=Rb.isFromCurrentSession(this.$),Ta=1,Rb=this.KFi(Rb,$a)):Bb&&($a.isSameSession=Y.sourceItem.isFromCurrentSession(this.$),Ta=2);if($a.copyContextSnapshot.commandParameters){const bb=-1985798686===Y.commandParameters.ribbonCommandInfo.command;Bb=$a.commandParameters;var jc=this.$;Y?jc&&jc.xa?Y=Y.sessionId===jc.xa.UserSessionId:(e.ULS.shipAssertTag(537166211,0,!1,"ewaControl shouldn't be null"),Y=!1):(e.ULS.shipAssertTag(537166212,0,!1,"copyContext shouldn't be null"),
Y=!1);Bb.clearSystemClipboard=Y&&bb&&vc&&!Rb;$a.commandParameters.copyPasteTargetType=Ta}}}getSessionId(){return this.$.xa.UserSessionId}KFi($a,Y){const Ta=Ed.b($a.ranges,Bb=>Bb.uh)&&Ed.b(Y.commandParameters.originalDestinations,Bb=>1!==Bb.top);return Ed.b($a.ranges,Bb=>Bb.isRow)&&Ed.b(Y.commandParameters.originalDestinations,Bb=>1!==Bb.left)||Ta}y3h($a){switch($a){case 1:return this.KPd;case 64:case 4:case 2:case 256:return this.N4c;default:throw Error.invalidOperation("Unsupported selection");}}k_h(){return P.h(this.$).ga.rf&
470?sd.floatingObject:1===P.h(this.$).ga.rf?sd.cells:sd.unknown}getDialogResponse(){}}Object(c.a)(kd,"ExcelCopyPasteApplicationHost",null,[345]);var Hd=a(172);class Ud extends t.a{constructor($a,Y){super($a);this.Lu=null;this.lwi=(Ta,Bb)=>{1===Ta?(Ta=Ud.hyh[Bb[Ud.gyh]],e.ULS.sendTraceTag(537167683,0,50,`InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler OK button pressed with valid input, shift direction = ${0===Ta?"Horizontal":"Vertical"}`),this.Lu.setResult(Ta)):(e.ULS.sendTraceTag(537167682,
0,50,"InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler cancel button pressed"),this.Lu.Zt())};this.sh(Y)}get dd(){return"InsertCopiedCutCellsDialog"}sh($a){this.Lu=new Hd.a;const Y=z.a.instance.ha(16);$a=this.bJ($a);this.initializeAndShow(Y,this.lwi,$a)}bJ($a){return{[Ud.Ku]:this.dd,[Ud.tHi]:$a}}}Ud.gyh="direction";Ud.tHi="isRtl";Ud.hyh={["Vertical"]:1,["Horizontal"]:0};Object(c.a)(Ud,"InsertCopiedCutCellsDialog",t.a,[]);class de{M$b($a,Y){return(new Ud($a,Y)).Lu.task}}Object(c.a)(de,
"InsertCopiedCutCellsDialogFactory",null,[343]);var qe=a(92),fe=a(51),Ke=a(48);class Te{constructor($a){this.Kac="";this.S4=this.Du=null;this.Mxc=!1;this.qkf=(Y=null,Ta=null)=>{this.hide(Y,Ta)};this.gridView=P.h($a);this.gridView.ga.yp(this.qkf)}EVe(){this.Mxc||(e.ULS.sendTraceTag(537167680,0,50,"PasteIndicationManager.DownloadPrerequisitesIfNeeded: Trying to get appChrome"),this.gridView.$.wz($a=>{$a.t0(0).then(()=>{this.Mxc=!0})}))}NHj($a){var Y=$a.commandParameters.id;e.ULS.sendTraceTag(537167651,
0,50,`PasteIndicationManager.ScheduleDisplay: pasteCommandId = ${Y}, cancelCtx is null = ${!this.Du}, PrerequisitesDownloaded = ${this.Mxc}`);this.EVe();this.Kac=Y;Y=!this.nGf();if(!this.Du||Y)this.OHe(),this.Du=fe.a.instance.create(()=>{this.Wyh($a)},void 0===$a.timeoutToShowSpinnerInMs||null===$a.timeoutToShowSpinnerInMs?100:$a.timeoutToShowSpinnerInMs,Ke.a.Mhj);this.S4=$a.commandParameters.originalDestinations}Wyh($a){this.Mxc?(this.display($a.commandParameters.originalDestinations),$a.pasteIndicationDisplayStatus=
ic.hed):(e.ULS.sendTraceTag(537167650,0,50,"PasteIndicationManager.DisplayIfPossible: Prerequisites were not ready, skipping display"),this.hide(),$a.pasteIndicationDisplayStatus=ic.Olj)}display($a){e.ULS.sendTraceTag(537167649,0,50,"PasteIndicationManager.Display: started");this.gridView.pc.oB(da.a.xEa(qa.d(this.gridView.$.na),$a),Te.Wwc,!0);this.gridView.pc.fs(Te.Wwc)}Akc($a){e.ULS.sendTraceTag(537167648,0,50,`PasteIndicationManager.HideForPasteId: pasteCommandId = ${$a}, currentPasteCommandId = ${this.Kac}`);
$a&&pa.a.equals($a,this.Kac,!1)&&this.hide()}hide($a=null){this.S4&&$a&&this.nGf()&&e.ULS.sendTraceTag(537167647,0,15,"PasteIndicationManager.Hide: Triggered by a SelectionChanged event while indication is (or will be) active but active range did not change");this.Kac="";this.OHe();this.S4=null;x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AvoidHighlightUpdate",!1)&&0===this.gridView.pc.rld([30]).length||(this.gridView.pc.Sk(Te.Wwc),this.gridView.pc.rl(null,Te.Wwc))}nGf(){return M.R(this.gridView.ga.pa.selectedRanges,
this.S4)}OHe(){this.Du&&(qe.a.Ka(this.Du),this.Du=null)}dispose(){this.hide();this.gridView.ga.Rp(this.qkf)}}Te.Wwc=[30];Object(c.a)(Te,"PasteIndicationManager",null,[344,2]);var Se=a(1111),df=a(54),te=a(727);class gf extends f.a{constructor($a){super();this.$=$a;this.qn=z.a.instance;this.uc()}create(){const $a=df.a.AX([76,77],4,this.La,void 0,void 0,void 0,gf.oqa);let Y;Y=x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatCellsActionNewService",!1)?Object(U.d)(ob.a.resolve(ja.L,{Wa:this.La})):
Ja.GetServiceTaskFactory.create(this.$.da,18,this.$.ka,this.La);Ba.TaskExtensions.za(Ba.TaskExtensions.xe([Y,$a],this.ka),()=>{const Ta=new Se.a;let Bb=null;this.Gih(Ta).then(Rb=>{Bb=Rb.HKe;const jc=copyPasteInfra.createCopyPasteInfra(Bb,new kd(this.$),Ta,{isChangeGateEnabled:x.EwaSettings.isChangeGateEnabled});e.ULS.shipAssertTag(537167762,0,!!this.$.xa,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext should not be null");e.ULS.shipAssertTag(537167761,0,!!this.$.xa&&!!this.$.xa.DocumentHostInfo,
"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext.DocumentHostInfo should not be null");const vc=Bb.getMetadataManager();var bb=Object(te.a)(this.$.da,254,()=>new Ab(this.$,vc,Y.result,jc,new gc(this.$,P.h(this.$)),new de,this.$.xa.DocumentHostInfo.UserId,Bb.getInitializationError()));this.$b(bb);if(Rb.Y3a){bb=Ab.Jgc();const Mb=JSON.stringify(Rb.Y3a.dataClipboardCapabilities),hc=Rb.Y3a.clipboardStrategiesToInitialize[0].clipboardStrategyType===Rb.Y3a.dataClipboardStrategyType,
Cc=void 0===window.bsqmXLSPageLoadStartTime||null===window.bsqmXLSPageLoadStartTime?"-1":(Date.now()-window.bsqmXLSPageLoadStartTime.getTime()).toString();e.ULS.sendTraceTag(41731933,0,50,`CopyPasteInfrastructureFactory.Create: Initialize CCP infra succeed. SliceName=${bb}, StrategyType=${Rb.Y3a.dataClipboardStrategyType}, StrategyCapabilities=${Mb}, IsBestStrategyTypeInitialized=${hc}, InfraLoadTimeMS=${Cc}`)}else e.ULS.shipAssertTag(537167760,0,!1,"CopyPasteInfrastructureFactory.Create: initResult.ClipboardPlatformEnvironmentInitializationInfo should not be null")},
Rb=>{const jc=Ab.Jgc();Rb=Rb?copyPasteInfra.getStringifiedError(Rb):"null";e.ULS.shipAssertTag(38847436,0,!1,`CopyPasteInfrastructureFactory.Create: error during call to clipboardPlatformEnvironment.Init(). Copy Paste operations will not be available in this session. SliceName: ${jc} error: ${Rb}`)})},this.ka,3)}dispose(){super.dispose()}Gih($a){let Y=null;var Ta=window.clipboardPlatform;Ta&&(Y=Ta.getClipboardPlatformEnvironment());if(!Y)return e.ULS.shipAssertTag(537167759,0,!1,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: getClipboardPlatformEnvironment should have returned a valid object"),
Promise.reject(null);Ta=this.$.xa;const Bb=[Ta.OfficeOnlineChromeExtensionId,Ta.ChromeClipboardAccessExtensionId],Rb=this.qn.Ha(5);var jc=this.$.Xe.get(57);let vc=!jc&&this.$.Xe.get(5);const bb=this.$.ea.Rc;bb&&(bb.inWebPart||bb.inViewerFromWebPart||bb.isDivSyndicated)&&(vc=!1);jc=this.z2h(vc,!jc);e.ULS.shipAssertTag(537167758,0,!!Ta.DocumentHostInfo,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: bootstrapContext.DocumentHostInfo should not be null");return Y.init({isChangeGateEnabled:x.EwaSettings.isChangeGateEnabled},
$a,Bb,Ta.SharedClipboardHostingApp,Ta.SharedClipboardHostingApps,Ta.SharedClipboardHostingEnvironments,Ta.SharedClipboardOverrideOrigin,Ta.SharedClipboardSchemaVersion,Ta.SharedClipboardExpirationInMinutes,Ta.ClipboardPromiseTimeoutInMinutes,Rb,Ta.MachineCluster,new Sb(this.$),jc,Ta.DocumentHostInfo.UserId,Ta.ClipboardTtlInMS,x.EwaSettings.ya(273),Ta.UserSessionId,Ta.BulsEndpointUrl).then(Mb=>Object(b.a)(new nb,{HKe:Y,Y3a:Mb}),Mb=>Promise.reject(Mb))}z2h($a,Y){const Ta=[];$a&&Y&&Ta.push(this.qsh());
Y&&(Ta.push(this.Tbd(7)),Ta.push(this.Tbd(0)));$a&&Ta.push(this.MPe());Ta.push({clipboardStrategyType:4});const Bb=Ta?Ta.map(Rb=>JSON.stringify(Rb)).join(","):"[]";e.ULS.sendTraceTag(39978242,0,50,`CopyPasteInfrastructureFactory.GetClipboardStrategiesInitList: create clipboard stratgy initialization list: isBrowserStorageAllowed=${$a}, isSystemClipboardAllowed=${Y}, result = ${Bb}`);return Ta}MPe(){const $a=this.$.xa,Y={clipboardStrategyType:5};Y.sessionId=$a.UserSessionId;Y.useSharedClipboardIframe=
!0;Y.sharedClipboardHostingApp=$a.SharedClipboardHostingApp;Y.sharedClipboardHostingApps=$a.SharedClipboardHostingApps;Y.sharedClipboardHostingEnvironments=$a.SharedClipboardHostingEnvironments;Y.sharedClipboardOverrideOrigin=$a.SharedClipboardOverrideOrigin;Y.sharedClipboardSchemaVersion=$a.SharedClipboardSchemaVersion;Y.sharedClipboardExpirationInMinutes=$a.SharedClipboardExpirationInMinutes;Y.wacCluster=$a.MachineCluster;return Y}qsh(){const $a={clipboardStrategyType:6};$a.localStorageStrategyParameters=
this.MPe();$a.systemClipboardStrategyParameters=this.Tbd(0);return $a}Tbd($a){const Y={};Y.clipboardStrategyType=$a;Y.skipFilesIfPlainTextExists=!0;return Y}static la($a){$a.da.Ja(373,new Te($a));$a.da.Ja(gf.oqa,new gf($a))}}gf.oqa=255;Object(c.a)(gf,"CopyPasteInfrastructureFactory",f.a,[]);var cf=a(10);a.d(C,"a",function(){return bf});const bf=()=>{cf.a.Fa($a=>{gf.la($a)})}},1199:function(r,C,a){var c=a(10),b=a(0),e=a(230),f=a(42);class d extends f.a{constructor(Pb){super();Pb.da.Ja(376,this)}AZg(Pb){this.addHandler("TAF",
Pb)}nAj(Pb){this.removeHandler("TAF",Pb)}mpj(){this.raiseEvent("TAF")}}Object(b.a)(d,"GridHighlightBehaviorEventManager",f.a,[293,2]);class h extends e.a{constructor(Pb){super();this.$=Pb;this.uc()}create(){this.$b(this.$.da.Ba(376)||new d(this.$))}static la(Pb){Pb.da.Ja(377,new h(Pb))}}Object(b.a)(h,"GridHighlightBehaviorEventManagerFactory",e.a,[]);var l=a(52),k=a(40),u=a(31),v=a(86),x=a(15),w=a(250),m=a(14),t=a(170),z=a(7),y=a(121),D=a(13);class H extends Sys.EventArgs{constructor(Pb,tb){super();
this.start=Pb;this.y9a=tb}}Object(b.a)(H,"MarqueeResizeStartedOrEndedEventArgs",Sys.EventArgs,[]);var F=a(30);class G extends f.a{constructor(Pb){super();this.nsc=[3];this.fta=void 0;this.gridView=Pb;this.qrg=F.a.JE(this.gridView.$);this.DO=F.a.JE(this.gridView.$)}get coloredReferencesManager(){const Pb=this.gridView.$.da.Ba(281);Pb||x.ULS.sendTraceTag(537159395,0,50,"BehaviorHelperMethods.ColoredReferencesManager: coloredReferencesManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");
return Pb}get oC(){if(this.fta)return this.fta;const Pb=this.gridView.$.da.Ba(464);Pb||x.ULS.sendTraceTag(510255179,0,50,"BehaviorHelperMethods.formulaAssistanceManager: formulaAssistanceManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");Pb.oC||x.ULS.sendTraceTag(510255178,0,50,"BehaviorHelperMethods.formulaAssistanceManager: formulaHighlightsControl is null.");return this.fta=Pb.oC}dYg(Pb){this.addHandler("mrek",
Pb)}AP(Pb,tb,gc){for(const Xb of this.gridView.Ho)w.a.instance.ta(m.a.dl,Xb.domElement,Pb);w.a.instance.ta(m.a.Zg,document.documentElement,tb);this.gridView.cellTextEditBox.mdc(!0);gc&&w.a.instance.ta(m.a.TC,this.gridView.zk,tb)}x6d(Pb,tb,gc){for(const Xb of this.gridView.Ho)w.a.instance.Aa(m.a.dl,Xb.domElement,Pb);w.a.instance.Aa(m.a.Zg,document.documentElement,tb);this.gridView.cellTextEditBox.mdc(!1);gc&&w.a.instance.Aa(m.a.TC,this.gridView.zk,tb)}nuj(Pb,tb){for(const gc of this.gridView.Ho)t.a.instance.ta(m.a.lh,
gc.domElement,Pb);t.a.instance.ta(m.a.jf,document.documentElement,tb)}nck(Pb,tb){for(const gc of this.gridView.Ho)t.a.instance.Aa(m.a.lh,gc.domElement,Pb);t.a.instance.Aa(m.a.jf,document.documentElement,tb)}Qad(Pb,tb,gc,Xb){const Ga=document.createElement("div");Ga.className=tb;for(const Za of gc)Ga.classList.add(Za);Pb.appendChild(Ga);w.a.instance.ta(m.a.pointerDown,Ga,Xb);return Ga}uef(Pb){Pb=Pb.Fc.parentNode;if(!Pb)return x.ULS.shipAssertTag(537159394,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: selectedHighlightElement is null."),
null;Pb=parseInt(Pb.getAttribute(z.a.y9a),10);return isNaN(Pb)?(x.ULS.shipAssertTag(537159393,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: indexInMarqueeCollection is not a valid number."),null):this.gridView.pc.xE(3,1,Pb)}qRb(Pb,tb,gc=!0){Pb=gc&&(this.DO?!!this.oC&&this.oC.CEi(Pb):!!this.coloredReferencesManager&&this.coloredReferencesManager.BEi(Pb));for(const Xb of tb)D.DOMElementExtensions.setVisible(Xb,Pb)}vgc(){return this.gridView.Gm?y.a(this.gridView.$):this.gridView.Gc}j1f(){if(this.DO){var Pb=
this.vgc();Pb&&this.oC?this.qrg?Pb.rF(null):this.oC.Pjb(Pb,null):(x.ULS.sendTraceTag(510255177,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),this.gridView.pc.Sk(this.nsc),this.gridView.pc.rl(null,this.nsc))}else this.Zrj()}Zrj(){const Pb=this.vgc();Pb&&this.coloredReferencesManager?this.qrg?Pb.rF(null):this.coloredReferencesManager.rF(Pb,null):(x.ULS.sendTraceTag(537159392,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),
this.gridView.pc.Sk(this.nsc),this.gridView.pc.rl(null,this.nsc))}p_f(Pb,tb){this.raiseEvent("mrek",new H(Pb,tb))}}Object(b.a)(G,"BehaviorHelperMethods",f.a,[]);var L=a(92),M=a(41),O=a(101);class B extends O.a{constructor(Pb,tb=null){super(Pb,tb)}S1a(){}}Object(b.a)(B,"HighlightFlyweightBehavior",O.a,[]);var E=a(20),I=a(470),S=a(75),J=a(12),K=a(122),R=a(232),Z=a(49),P=a(249),V=a(9),Ea=a(78),oa=a(1),ea=a(37);class aa extends P.a{constructor(Pb,tb,gc){super(document.createElement("div"));this.Lac=null;
this.JVb=!1;this.onPointerDown=Xb=>{Xb=ea.a(this.$)?ea.a(this.$).df(Xb):Xb;this.JVb=!1;if(3===(S.a.fc=Xb.kc)){const Ga=Xb.Da.rawEvent,Za=Ga.srcElement||Ga.target;D.DOMElementExtensions.zg(this.domElement,Za)&&D.DOMElementExtensions.zg(Ga.currentTarget,Za)&&(this.JVb=!0,this.Lac=Xb.clientPoint)}return!1};this.Wh=Xb=>{Xb=ea.a(this.$)?ea.a(this.$).df(Xb):Xb;this.raiseEvent("GrPointerUp",Xb);return this.JVb=!1};this.$j=Xb=>{Xb=ea.a(this.$)?ea.a(this.$).df(Xb):Xb;3===Xb.kc&&this.JVb&&this.toi(Xb.clientPoint)&&
(this.raiseEvent("GrDrag"),this.JVb=!1);return!1};this.Ud=Xb=>{ea.a(this.$)&&ea.a(this.$).df(Xb);return!0};this.$=gc;gc=!oa.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");this.domElement.classList.add(gc?Ea.a.C1e:Ea.a.B1e);this.domElement.classList.add(Ea.a.nec);Pb.appendChild(this.domElement);D.DOMElementExtensions.setVisible(this.domElement,!1);this.DOa=document.createElement("div");this.DOa.classList.add(Ea.a.mec);this.DOa.style.borderColor=tb;this.domElement.appendChild(this.DOa);
w.a.instance.ta(m.a.pointerDown,this.domElement,this.onPointerDown);w.a.instance.ta(m.a.Zg,this.domElement,this.Wh);t.a.instance.ta(m.a.jf,this.domElement,this.Wh);w.a.instance.ta(m.a.dl,this.domElement,this.$j);t.a.instance.ta(m.a.lh,this.domElement,this.$j);R.a.instance.ta(m.a.click,this.domElement,this.Ud)}rye(Pb){this.addHandler("GrDrag",Pb)}a5f(Pb){this.removeHandler("GrDrag",Pb)}qye(Pb){this.addHandler("GrContxt",Pb)}$4f(Pb){this.removeHandler("GrContxt",Pb)}sye(Pb){this.addHandler("GrPointerUp",
Pb)}b5f(Pb){this.removeHandler("GrPointerUp",Pb)}dispose(){Z.a.Mpa(this.domElement);super.dispose()}xcg(){this.domElement.classList.remove(Ea.a.nec);this.DOa.classList.remove(Ea.a.mec);this.DOa.classList.add(Ea.a.D1e)}xsg(){this.DOa.classList.remove(Ea.a.D1e);this.DOa.classList.add(Ea.a.mec);this.domElement.classList.add(Ea.a.nec)}toi(Pb){return!!this.Lac&&(3<Math.abs(Pb.x-this.Lac.x)||3<Math.abs(Pb.y-this.Lac.y))}static DAb(Pb){return oa.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")?
(Pb=ea.a(Pb.$)?ea.a(Pb.$).zoom:V.a.O1,Math.round(9/Math.max(Pb,1))):9}}aa.$Ed=0;Object(b.a)(aa,"TouchGrippie",P.a,[]);class ia extends B{constructor(Pb,tb,gc,Xb){super(tb);this.iAd=this.gtb=!1;this.E7b=null;this.mea=this.dAd=!1;this.ly=()=>{this.gtb&&this.dAd?this.Qqa():this.o7()};this.fNf=Za=>{3===Za.kc&&(this.dAd=!0,this.Qqa());return!1};this.gNf=Za=>{if(3===Za.kc){if(!Za.Fc||this.WBi(Za))return!1;this.dAd=!1;this.o7()}return!1};this.Uf=()=>{this.mea&&this.B6d();this.Qqa();this.iAd=!1};this.Ws=
()=>{this.o7();this.iAd=!0};this.PBa=(Za,Sb)=>{Sb.r7===this.r7&&(Sb.visible?this.iAd||this.Qqa():this.o7())};this.PSf=()=>{this.hNf(this.ZT.domElement,!1)};this.fJf=()=>{this.hNf(this.mR.domElement,!0)};this.Puc=(Za,Sb)=>{this.ga.BCa(Sb)};this.Quc=(Za,Sb)=>{this.ga.BCa(I.b(Sb))};this.UKb=()=>{3===S.a.fc?this.Qqa():this.o7();this.mea&&1===S.a.fc&&this.B6d()};this.QSf=()=>{this.$Lj()};this.mWe=()=>{this.o7()};this.Go=()=>{this.ga.Sa.Pc&&this.o7()};this.UIf=()=>{this.o7()};this.ZMf=(Za,Sb)=>{this.B6d();
3===Sb.kc?this.Qqa():this.o7()};this.Eyc=()=>{this.gtb&&(this.o7(),this.Qqa())};const Ga=gc.$;this.su=gc;this.ga=gc.ga;this.Vda=Pb;this.xJj=tb;this.paneType=Xb;Pb=this.domElement.currentStyle;tb="#000000";Pb&&(tb=Pb.borderTopColor);this.ZT=new aa(this.q4e(),tb,Ga);this.mR=new aa(this.q4e(),tb,Ga);this.ZT.rye(this.PSf);this.ZT.qye(this.Puc);this.ZT.sye(this.Quc);this.mR.rye(this.fJf);this.mR.qye(this.Puc);this.mR.sye(this.Quc);for(const Za of this.gridView.Ho)t.a.instance.ta(m.a.mg,Za.domElement,this.gNf),
t.a.instance.ta(m.a.jf,Za.domElement,this.fNf);gc.view.As(this.ly);gc.Gc.ro(this.mWe);gc.pc.usb(this.PBa);gc.s2c(this.UIf);Ga.kA(this.Eyc);gc.ut(this.Eyc);this.ga.f5(this.Uf);this.ga.yba(this.Ws);gc.TF(this.Go);this.ga.u4b(this.ZMf);S.a.zye(this.UKb);k.TaskExtensions.za(l.GetServiceTaskFactory.Za(Ga.da,376,377,0),Za=>{Za.result.AZg(this.QSf)},Ga.ka,3)}get gridView(){return this.su}dispose(){L.a.ed([this.ZT,this.mR]);this.ZT.a5f(this.PSf);this.ZT.$4f(this.Puc);this.ZT.b5f(this.Quc);this.mR.a5f(this.fJf);
this.mR.$4f(this.Puc);this.mR.b5f(this.Quc);for(var Pb of this.gridView.Ho)t.a.instance.Aa(m.a.mg,Pb.domElement,this.gNf),t.a.instance.Aa(m.a.jf,Pb.domElement,this.fNf);this.gridView.view.wq(this.ly);this.gridView.Gc.io(this.mWe);this.gridView.pc.LOb(this.PBa);this.gridView.kSd(this.UIf);this.gridView.$.$C(this.Eyc);this.gridView.$v(this.Eyc);this.ga.v2(this.Uf);this.ga.mga(this.Ws);this.gridView.qH(this.Go);this.ga.Wzc(this.ZMf);S.a.h5f(this.UKb);this.mea&&x.ULS.sendTraceTag(537159314,0,15,"SelectionTouchGrippiesBehaviorBase.Dispose during autofill mode");
(Pb=this.gridView.$.da.Ba(376))&&Pb.nAj(this.QSf);super.dispose()}WVa(){if(!this.Vda.range||!this.Vda.range.equals(this.bhb))return!1;const Pb=!this.gridView.lQa();return this.gridView.Ob&&Pb&&(this.bhb.isRow||this.bhb.uh)?!1:this.mea?!0:3===S.a.fc}o7(){this.gtb&&(this.ZT.set_visible(!1),this.mR.set_visible(!1),this.gtb=!1)}Qqa(){if(this.WVa()){var Pb=D.DOMElementExtensions.getBoundingClientRect(this.E7b);Pb||x.ULS.shipAssertTag(537159313,0,!1,"grippiesParentBounds is null. GridView.ContainerElement: {0}, Freezepanes: {1}",
this.gridView.zk,this.gridView.Mb.tj);var tb=D.DOMElementExtensions.getBoundingClientRect(this.xJj),gc=new Sys.UI.Bounds(tb.x-Pb.x,tb.y-Pb.y,tb.width,tb.height),Xb=this.bhb,Ga=Xb.topLeft,Za=Xb.bottomRight,Sb=Xb.isRow||Xb.uh;if(Xb.uh){var sb=this.tTh();Xb=gc.x-2*aa.DAb(this.gridView);var bc=sb;var kc=gc.x+tb.width}else Xb.isRow?(Xb=kc=this.sTh(),bc=gc.y-2*aa.DAb(this.gridView),sb=gc.y+tb.height):(bc=gc.y,sb=gc.y+tb.height,this.gridView.rtl?(Xb=gc.x+tb.width,kc=gc.x):(Xb=gc.x,kc=gc.x+tb.width));tb=
aa.$Ed+(Sb?0:aa.DAb(this.gridView));this.ZT.style.left=J.HelperMethods.ud(Xb-tb);this.ZT.style.top=J.HelperMethods.ud(bc-tb);this.mR.style.left=J.HelperMethods.ud(kc-tb);this.mR.style.top=J.HelperMethods.ud(sb-tb);this.ZT.set_visible(this.urf(bc,Xb,Ga,Sb,Pb));this.mR.set_visible(this.urf(sb,kc,Za,Sb,Pb));this.gtb=!0}}urf(Pb,tb,gc,Xb,Ga){const Za=D.DOMElementExtensions.getBoundingClientRect(this.gridView.sg(this.paneType).domElement);Ga=new Sys.UI.Bounds(Za.x-Ga.x-3,Za.y-Ga.y-3,Za.width+6,Za.height+
6);return(this.gridView.Mb.Di(gc)===this.paneType||Xb)&&M.a.FS(Ga,new Sys.UI.Point(tb,Pb))}tTh(){return(this.gridView.view.visibleArea.height+this.gridView.Mb.height+aa.$Ed-aa.DAb(this.gridView))/2}sTh(){return(this.gridView.view.visibleArea.width+this.gridView.Mb.width+aa.$Ed-aa.DAb(this.gridView))/2}aRf(){this.Qqa()}WBi(Pb){return D.DOMElementExtensions.dqa(Pb.Fc,E.a.Kv)&&(this.iDi(Pb)||this.jDi(Pb))}jDi(Pb){if(this.gridView.rtl)Pb=Pb.clientPoint.x;else{const tb=D.DOMElementExtensions.getBoundingClientRect(Pb.Fc);
Pb=Pb.clientPoint.x-(tb.x+tb.width-K.a.dw)}return 0<Pb&&Pb<=K.a.dw}iDi(Pb){const tb=D.DOMElementExtensions.getBoundingClientRect(Pb.Fc);Pb=Pb.clientPoint.y-(tb.y+tb.height-K.a.dw);return 0<Pb&&Pb<=K.a.dw}hNf(Pb,tb){this.mea&&x.ULS.sendTraceTag(537159312,0,50,"SelectionTouchGrippiesBehaviorBase: Performing Touch Autofill");this.ga.D7c(Pb,tb,this.mea);this.o7()}$Lj(){this.mea||(x.ULS.sendTraceTag(537159311,0,50,"SelectionTouchGrippiesBehaviorBase.SetAutoFillMode"),this.mea=!0,this.ZT.xcg(),this.mR.xcg(),
this.gridView.ga.sourceRange=this.gridView.ga.pa.Sd,this.Qqa())}B6d(){this.mea&&(x.ULS.sendTraceTag(537159310,0,50,"SelectionTouchGrippiesBehaviorBase.UnsetAutoFillMode"),this.mea=!1,this.ZT.xsg(),this.mR.xsg())}q4e(){this.E7b||(this.E7b=this.gridView.zk);return this.E7b}}Object(b.a)(ia,"SelectionTouchGrippiesBehaviorBase",B,[]);class ya extends ia{constructor(Pb,tb,gc,Xb){super(Pb,tb,gc,Xb)}get r7(){return 19}get bhb(){return this.gridView.ga.pa.activeRange}WVa(){const Pb=this.gridView.hj||this.gridView.Ob;
return!this.gridView.ga.pa.Vh&&!Pb&&super.WVa()}}Object(b.a)(ya,"DiscontinuousSelectionTouchGrippiesBehavior",ia,[]);var za=a(278);class la extends B{constructor(Pb){super(Pb);const tb=document.createElement("div");tb.className=Ea.a.vOh;Pb.appendChild(tb)}}Object(b.a)(la,"SelectionBorderBehavior",B,[]);class xa{}xa.Ehd="ewr-selection-draghandle";xa.Fhd="ewr-selection-draghandle-grab";xa.oOh="ewr-selection-draghandle-top-ie";xa.pOh="ewr-selection-draghandle-top-ie-enhanced";xa.mOh="ewr-selection-draghandle-top";
xa.nOh="ewr-selection-draghandle-top-enhanced";xa.cOh="ewr-selection-draghandle-bottom-ie";xa.dOh="ewr-selection-draghandle-bottom-ie-enhanced";xa.aOh="ewr-selection-draghandle-bottom";xa.bOh="ewr-selection-draghandle-bottom-enhanced";xa.gOh="ewr-selection-draghandle-left-ie";xa.hOh="ewr-selection-draghandle-left-ie-enhanced";xa.eOh="ewr-selection-draghandle-left";xa.fOh="ewr-selection-draghandle-left-enhanced";xa.kOh="ewr-selection-draghandle-right-ie";xa.lOh="ewr-selection-draghandle-right-ie-enhanced";
xa.iOh="ewr-selection-draghandle-right";xa.jOh="ewr-selection-draghandle-right-enhanced";xa.qOh="ewr-selection-dragtooltip";xa.rOh="ewr-selection-dragtooltip-updated";xa.COh="ewr_selection_rearrangeleft";xa.DOh="ewr_selection_rearrangeright";xa.EOh="ewr_selection_rearrangetop";xa.BOh="ewr_selection_rearrangebottom";xa.selecting="selecting";xa.FOh="ewr-selection-resizemarqueehandle";xa.IOh="ewr-selection-resizemarqueehandle-topleft";xa.JOh="ewr-selection-resizemarqueehandle-topright";xa.GOh="ewr-selection-resizemarqueehandle-bottomleft";
xa.HOh="ewr-selection-resizemarqueehandle-bottomright";xa.RNh="ewr-marquee-thick";xa.VNh="ewr-resizemarqueehandle-thick";Object(b.a)(xa,"CssClassNames",null,[]);var wa=a(262),hb=a(19);class Ja extends la{constructor(Pb,tb,gc,Xb){super(Pb);this.GWa=!1;this.lve=this.mve=null;this.oba=0;this.Yq=oa.EwaSettings.getBooleanFeatureGate(za.a.Icc,!1);this.uBi=oa.EwaSettings.getBooleanFeatureGate(za.a.IAh,!1);this.P8d=this.Ksd=this.D_=0;this.WX=this.rc=this.sourceRange=this.zpa=null;this.Wh=Ga=>{Ga=ea.a(this.$).df(Ga);
return this.MPf(Ga)};this.onPointerDown=Ga=>{Ga=ea.a(this.$).df(Ga);if(oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",!1)&&!this.gib())return!1;if(2===Ga.kc&&Ga.ap===Sys.UI.MouseButton.leftButton&&!this.GWa){var Za=this.jpd(Ga);if(!Za)return x.ULS.shipAssertTag(537159379,0,!1,"DragSelectionClickBehaviorBase.OnPointerDown: GetSelectedRange failed"),!1;this.rc=Za.clone();this.sourceRange=this.rc.clone();this.zpa=this.rc;if(Za=this.t$h(Ga))if(this.Wn=5,this.P8d=
Za.top-this.sourceRange.top,this.Ksd=Za.left-this.sourceRange.left,hb.h(this.$).Nh.zq(this.Yq?Ja.cyb:Ja.HVe),this.zKd(Ga),this.GWa=!0,wa.b(this.$,!0),oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",!1))return!0}return!1};this.$j=Ga=>{Ga=ea.a(this.$).df(Ga);if(this.Yq&&this.AKd(Ga))return!0;if(Ga=this.ga.hr(Ga.clientPoint,Ga.Fc,5,void 0,void 0,!0)){Ga=this.Kub(Ga);if(this.rc.equals(Ga))return!0;this.rc=Ga;if(!this.aU())return x.ULS.shipAssertTag(537159378,0,!1,
"DragSelectionClickBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.Jec(!0),!1}return!0};this.ee=(Ga,Za)=>{Za.HO||(oa.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")&&!oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",!1)?this.uVa(this.$.isEditMode&&this.gib()):this.uVa(this.$.isEditMode))};this.wA=[];this.$=tb;this.ga=hb.h(this.$).ga;this.paneType=gc;this.Ap=Xb;tb=oa.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");
this.NWd=this.uBi?tb?[xa.nOh,xa.bOh,xa.fOh,xa.jOh]:[xa.pOh,xa.dOh,xa.hOh,xa.lOh]:tb?[xa.mOh,xa.aOh,xa.eOh,xa.iOh]:[xa.oOh,xa.cOh,xa.gOh,xa.kOh];if(!oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",!1))for(const Ga of this.NWd)tb=this.Ap.Qad(Pb,Ga,this.Yq?[xa.Fhd]:[xa.Ehd],this.onPointerDown),this.wA.push(tb);this.$.$l(this.ee);oa.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")||this.uVa(this.$.isEditMode)}get pc(){return hb.h(this.$).pc}get Wn(){return this.ga.selectionType}set Wn(Pb){this.ga.selectionType=
Pb}dispose(){this.wA.forEach(Pb=>{w.a.instance.Aa(m.a.pointerDown,Pb,this.onPointerDown)});this.wA.length=0;this.zpa=this.sourceRange=this.rc=null;x.ULS.sendTraceTag(537159381,0,50,`DragSelectionClickBehaviorBase.Dispose: ActiveRegistrationCount = ${this.oba}, EwaControl is null : ${!this.$}`);this.$&&(this.$.hn(this.ee),1===this.oba&&(x.ULS.sendTraceTag(537159380,0,15,"DragSelectionClickBehaviorBase.Dispose: Some handlers are still registered"),this.dL(this.lve,this.mve,!1)));super.dispose()}MPf(Pb){if(5!==
this.Wn)return!1;(Pb=this.ASa(Pb))||this.Jec(!1);wa.b(this.$,!1);return Pb}AP(Pb,tb){x.ULS.shipAssertTag(537159377,0,!this.oba,`DragSelectionClickBehaviorBase.RegisterHandlersForMouse: More than one active registration is not expected but got ${this.oba}`);this.oba+=1;this.lve=Pb;this.mve=tb;this.Ap.AP(Pb,tb,this.r5d())}Kub(Pb){if(!Pb||!this.rc)return x.ULS.shipAssertTag(537159376,0,!!Pb,"DragSelectionClickBehaviorBase.CalculateDragRange: mouseSelectionRange is null"),x.ULS.shipAssertTag(537159375,
0,!!this.rc,"DragSelectionClickBehaviorBase.CalculateDragRange: CurrentRange is null"),null;const tb=this.rc.clone();1!==this.D_&&(tb.left=Math.max(Pb.left-this.Ksd,1),tb.right=tb.left+this.sourceRange.width-1);2!==this.D_&&(tb.top=Math.max(Pb.top-this.P8d,1),tb.bottom=tb.top+this.sourceRange.height-1);return this.Fsb(tb)}dL(Pb,tb,gc=!0,Xb=!0){x.ULS.shipAssertTag(537159374,0,1===this.oba,`DragSelectionClickBehaviorBase.CleanUp: Expected exactly one active registration but got ${this.oba}`);--this.oba;
this.Yq||hb.h(this.$).Nh.zq(z.a.LW);this.Ap.x6d(Pb,tb,this.r5d());gc&&this.RJe(Xb);this.D_=0;this.GWa=!1}Fsb(Pb){var tb=hb.h(this.$);let gc=Pb;if(tb.Mb.VW){if(!tb.tc(Pb.topLeft)){tb=tb.Bj("DragSelectionClickBehaviorBase.AdjustHiddenRowColumns",tb.dS,this.zpa.top!==Pb.top?1:2);try{tb.Cl=this.zpa.top<Pb.top||this.zpa.left<Pb.left,tb.cx(Pb.topLeft),gc=tb.$$cu().range}finally{tb&&tb.dispose()}}oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",!1)?(gc.right=Math.min(gc.left+
Pb.width-1,V.a.Rg),gc.bottom=Math.min(gc.top+Pb.height-1,V.a.Sg)):(gc.right=gc.left+Pb.width-1,gc.bottom=gc.top+Pb.height-1)}return this.zpa=gc}uVa(Pb){this.wA.forEach(tb=>{D.DOMElementExtensions.setVisible(tb,Pb)})}t$h(Pb){const tb=Pb.Fc;Pb=Pb.clientPoint;if(!tb||!Pb)return x.ULS.shipAssertTag(537159373,0,!!tb,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: source is null"),x.ULS.shipAssertTag(537159372,0,!!Pb,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: point is null"),null;Pb.y+=
tb===this.wA[Ja.Lcc]?2:tb===this.wA[Ja.KVe]?-2:0;Pb.x+=tb===this.wA[Ja.MVe]?2:tb===this.wA[Ja.Kcc]?-2:0;return this.ga.hr(Pb,tb,5,void 0,void 0,!0)}}Ja.HVe="move";Ja.nad="copy";Ja.cyb="grabbing";Ja.Lcc=0;Ja.KVe=1;Ja.MVe=2;Ja.Kcc=3;Object(b.a)(Ja,"DragSelectionClickBehaviorBase",la,[]);class Fa extends Ja{constructor(Pb,tb,gc,Xb,Ga,Za){super(Pb,tb,gc,Ga);this.lc=this.tH=null;this.gif=()=>{this.Jec(!0)};if(oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",!1))for(const Sb of this.NWd)tb=
this.Ap.Qad(Pb,Sb,this.Yq?[xa.Fhd]:[xa.Ehd],this.onPointerDown),this.wA.push(tb);oa.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")&&this.uVa(this.$.isEditMode);this.gridView=hb.h(this.$);this.aH=Xb;this.coloredReferencesManager=this.$.da.Ba(281);x.ULS.shipAssertTag(537159391,0,!!this.coloredReferencesManager,"DragMarqueeClickBehavior Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");if(this.DO=F.a.JE(this.$))Pb=this.$.da.Ba(464),
x.ULS.shipAssertTag(512312961,0,!!Pb,"DragMarqueeClickBehavior Ctor: formulaAssistanceManager is null. We already have marquee highlights so it shouldn't happen."),this.oC=Pb.oC;for(const Sb of this.wA)w.a.instance.ta(m.a.XX,Sb,this.aH.plf),w.a.instance.ta(m.a.TC,Sb,this.aH.qlf);this.S1a(Za)}S1a(Pb){this.Ap.qRb(Pb,this.wA);this.aH.z2()}zKd(Pb){x.ULS.sendTraceTag(537159390,0,50,"DragMarqueeClickBehavior.OnPointerDownInternal: Starting drag marquee operation.");this.gridView.iPa=!0;this.lc.aG(!1);this.Wn=
5;this.aH.OVe(Pb.Fc);this.lc.textBox.removeSelection();this.lc.E4b(this.gif);this.AP(this.$j,this.Wh);this.D_=this.sourceRange.isRow?1:this.sourceRange.uh?2:0}ASa(){const Pb=this.GY();this.Wn=-1;this.dL(this.$j,this.Wh);return Pb}RJe(){this.gridView.iPa=!1;this.aH.PVe(this.wA[0]);this.lc.textBox.setCaretPositionToEnd();this.lc.eAc(this.gif);this.Ap.j1f()}Jec(Pb){x.ULS.sendTraceTag(537159389,0,10,"DragMarqueeClickBehavior.FailureFallback: Operation failed, will try to recalculate colored references as a fallback in CleanUp.");
Pb&&this.dL(this.$j,this.Wh)}jpd(Pb){this.lc=this.Ap.vgc();this.tH=this.Ap.uef(Pb);return this.lc&&this.tH&&this.tH.range?this.tH.range:(x.ULS.shipAssertTag(537159388,0,!!this.lc,"DragMarqueeClickBehavior.GetSelectedRange: cellContentEditor is null"),x.ULS.shipAssertTag(537159387,0,!!this.tH,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState is null"),x.ULS.shipAssertTag(537159386,0,!!this.tH.range,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState.Range is null"),
null)}GY(){return this.tH?this.DO?this.oC.oJb(this.lc,this.tH,this.rc):this.coloredReferencesManager.oJb(this.lc,this.tH,this.rc):(x.ULS.shipAssertTag(537159385,0,!1,"DragMarqueeClickBehavior.SetSelectedRange called when selectedHighlightState is null. It shouldn't be null while dragging a marquee highlight."),!1)}aU(){return this.GY()}r5d(){return!0}AKd(){return!1}gib(){return!0}}Object(b.a)(Fa,"DragMarqueeClickBehavior",Ja,[]);var Ba=a(90),fa=a(113),ta=a(173),Oa=a(84),Ma=a(425),fb=a(740),pa=a(233),
Ua=a(34),Sa=a(50);class Ia extends Ja{constructor(Pb,tb,gc,Xb,Ga){super(Pb,tb,gc,Ga);this.$h=null;this.uh=this.isRow=!1;this.Uf=()=>{this.domElement.classList.remove(xa.selecting)};this.Ws=()=>{this.domElement.classList.add(xa.selecting)};this.Od=()=>{if(this.$.isEditMode){const Za=this.gib();this.uVa(Za)}};this.tableManager=Xb;if(oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",!1)){if(0===Ia.occ[gc].length)for(const Za of this.NWd)tb=document.createElement("div"),
tb.className=Za,tb.classList.add(this.Yq?xa.Fhd:xa.Ehd),Ia.occ[gc].push(tb);for(const Za of Ia.occ[gc])Pb.appendChild(Za),w.a.instance.ta(m.a.pointerDown,Za,this.onPointerDown),this.wA.push(Za)}oa.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")&&!oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",!1)?this.uVa(this.gib()&&this.$.isEditMode):this.uVa(this.$.isEditMode);this.sm={};this.HA=!1;this.ga.yba(this.Ws);this.ga.f5(this.Uf);oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",
!1)||this.ga.WK(this.Od);this.x8d=oa.EwaSettings.isChangeGateEnabled("OfficeVSO:7148113_FixShowToolTipBug7144260")}dispose(){this.ga&&(this.ga.mga(this.Ws),this.ga.v2(this.Uf),oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",!1)||this.ga.GP(this.Od),oa.EwaSettings.isChangeGateEnabled("OfficeVSO:7117157_ChangesInDragDropRefactoredCode")||this.ga.sAc(this.Adb));if(this.sm)for(var Pb=1;4>=Pb;Pb++)D.DOMElementExtensions.tg(this.sm[Pb.toString()]);if(oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",
!1))for(Pb=1;4>=Pb;Pb++)Ia.occ[Pb].length=0;this.sm=this.$h=null;super.dispose()}RJe(Pb){Pb&&(this.Yq&&hb.h(this.$).Nh.zq(z.a.LW),fa.KeyInputManager.instance.Aa(m.a.Ic,this.domElement.ownerDocument.body,this.onKeyDown),this.HA=!1);for(Pb=1;4>=Pb;Pb++){const tb=this.sm[Pb.toString()];tb&&tb.parentNode.removeChild(tb);this.sm[Pb.toString()]=null}this.$h=null}jpd(){return this.ga.pa.Sd}GY(){this.ga.updateSelection(this.rc,this.rc.topLeft,0);return!0}aU(Pb=!1){this.pc.rl(this.rc,this.gm());this.pc.fs(this.gm());
this.zH(Pb);return!0}Jra(Pb=!1){this.pc.rl(this.rc,this.$h);this.pc.fs(this.$h);this.zH(Pb)}Jec(){x.ULS.sendTraceTag(508908561,0,15,"DragSelectionClickBehavior.FailureFallback: this function was not implemented for dragging selection")}r5d(){return!1}q$(Pb,tb,gc,Xb,Ga=!1){var Za=D.DOMElementExtensions.getBoundingClientRect(tb);let Sb=tb===this.wA[Ja.Lcc]||tb===this.wA[Ja.KVe];if(this.Yq){var sb=tb===this.wA[Ja.MVe]||tb===this.wA[Ja.Kcc];this.isRow&&sb||this.uh&&Sb?sb="100px":(Sb=this.isRow||Sb,sb=
(Sb?Ga?Ia.w8j:Ia.B8j:Ga?Ia.v8j:Ia.y8j)+"px");tb=Sb?tb===this.wA[Ja.Lcc]?"top":"bottom":tb===this.wA[Ja.Kcc]?"right":"left";Pb=100*(Sb?Pb.x-Za.x:Pb.y-Za.y)/(Sb?Za.width:Za.height);for(Za=1;4>=Za;Za++){Xb=document.createElement("div");var bc=document.createElement("div");const kc=document.createElement("div");Xb.appendChild(bc);Xb.appendChild(kc);Ga&&(bc=document.createElement("div"),Xb.appendChild(bc),kc.style.fontWeight="bold");Xb.className=xa.rOh;this.sm[Za.toString()]=Xb;this.pc.xE(gc,Za).kg.appendChild(Xb);
Xb=this.sm[Za.toString()];Xb.style[tb]=sb;Xb.style[Sb?"left":"top"]=Pb+"%"}}else for(Ga=(Sb?-Ia.A8j:-Ia.x8j)+"px",sb=Sb?tb===this.wA[Ja.Lcc]?"top":"bottom":tb===this.wA[Ja.Kcc]||Xb?"right":"left",tb=100*(Sb?Xb?0:Pb.x-Za.x:Pb.y-Za.y)/(Sb?Za.width:Za.height),Pb=1;4>=Pb;Pb++)Za=document.createElement("div"),Za.className=xa.qOh,this.sm[Pb.toString()]=Za,this.pc.xE(gc,Pb).kg.appendChild(Za),Za=this.sm[Pb.toString()],Za.style[sb]=Ga,Za.style[Sb?"left":"top"]=tb+"%"}hug(Pb,tb,gc){const Xb=hb.h(this.$),Ga=
Xb.gh(Pb);var Za=Xb.sg(this.paneType);gc=fb.a.kw(Za.view.kj,this.domElement.parentNode,gc,Xb.rtl);Za=!1;let Sb=2;tb&&gc.y-Ga.topLeft.y>Ga.height/2?(Za=!0,Sb=1):!tb&&gc.x-Ga.topLeft.x>Ga.width/2&&(Za=!0);if(Za){tb=Xb.Bj("DragSelectionClickBehavior.updateMouseSelectionRange",Xb.dS,Sb);try{tb.cx(Pb),tb.$$mn(),tb.$$cu()}finally{tb&&tb.dispose()}}}ivb(Pb){this.pc.Sk(this.$h);this.dL(this.cpa,this.dpa,void 0,Pb)}AV(Pb){this.pc.Sk(this.gm());this.dL(this.$j,this.Wh,void 0,Pb)}PAb(){return this.Yq?48:6}gm(){return this.Yq?
Ia.JAh:Ia.NAh}c$a(Pb){return Pb.Da.keyCode===Ba.a.Sra||u.a.isMac&&Pb.Da.keyCode===Ba.a.VXa}cEb(Pb){Pb=hb.h(this.$).getRangeInformation(Pb);for(let tb=0,gc=Pb.length;tb<gc;++tb)if(Object(Ma.a)(pa.PivotTableRange,Pb[tb]))return Pb=Ua.a.Wd(1,0,902,901,0,2105176604,"InsDelCellsPivotTable"),Sa.a(this.$).hv([Pb]),!0;return!1}}Ia.x8j=50;Ia.A8j=25;Ia.y8j=-85;Ia.B8j=-40;Ia.v8j=-120;Ia.w8j=-50;Ia.NAh=[6];Ia.JAh=[48];Ia.occ=[[],[],[],[],[],[]];Object(b.a)(Ia,"DragSelectionClickBehavior",Ja,[]);var X=a(25),ca=
a(797),U=a(47),ma=a(201),ra=a(119),Va=a(248),ob=a(59);const ja=(Pb,tb,gc,Xb,Ga,Za,Sb,sb=null)=>{sb=Pb.Pa(41,sb);sb.sourceRange=tb;sb.destinationRange=gc;return ob.g(Pb,"RearrangeRowColumn",sb,Xb,Ga,Za,Sb,0)},lb=(Pb,tb,gc,Xb,Ga,Za,Sb=null)=>{Sb=Pb.Pa(1,Sb);Sb.moveRange=tb;return ob.g(Pb,"MoveLineItems",Sb,gc,Xb,Ga,Za,0)};class wb{constructor(Pb,tb){this.destinationRange=this.sourceRange=null;this.sourceRange=Pb;this.destinationRange=tb}}Object(b.a)(wb,"MacroRecorderTableRowColumnRearrangedPayload",
null,[144]);var Ab=a(16);class nb extends Ia{constructor(Pb,tb,gc,Xb,Ga){super(Pb,tb,gc,Xb,Ga);this.Tga=null;this.NS=this.PS=!1;this.gxf=0;this.NDa=this.Twa=null;this.qL=0;this.Mcc=Ab.a.instance.ha(2269);this.QVe=Ab.a.instance.ha(2270);this.AEc=Ab.a.instance.ha(2271);this.vgg=Ab.a.instance.ha(2272);this.onKeyDown=Za=>{if(this.Yq){if(this.c$a(Za)||Za.Da.keyCode===Ba.a.WXa)return this.dQa||(fa.KeyInputManager.instance.ta(m.a.De,this.domElement.ownerDocument.body,this.onKeyUp),this.dQa=!0),!this.b1&&
this.c$a(Za)&&(hb.h(this.$).Nh.zq(Ja.nad),this.b1=!0),this.c1||Za.Da.keyCode!==Ba.a.WXa||(hb.h(this.$).Nh.zq(Ja.cyb),this.c1=!0,2===this.qL?(x.ULS.shipAssertTag(509159443,0,!!this.gm(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),x.ULS.sendTraceTag(509150300,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.AV(!1),this.D_=0,this.$h=this.NS?[11]:[12],this.PS=this.NS,this.dRd(),x.ULS.shipAssertTag(509159442,0,!!this.$h,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),
this.Jra()):3===this.qL?(x.ULS.shipAssertTag(509159441,0,!!this.$h,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),x.ULS.sendTraceTag(509150299,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.hvb(!1),this.D_=this.isRow?1:2,this.Jpa(),x.ULS.shipAssertTag(509159440,0,!!this.gm(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.aU()):1===this.qL&&(x.ULS.shipAssertTag(509159439,0,!!this.$h,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),
x.ULS.sendTraceTag(509150298,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.ivb(!1),this.Jpa(),x.ULS.shipAssertTag(509159438,0,!!this.gm(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.aU())),!0}else if(!this.b1&&(Za.Da.keyCode===Ba.a.Sra||u.a.isMac&&Za.Da.keyCode===Ba.a.VXa))return fa.KeyInputManager.instance.ta(m.a.De,this.domElement.ownerDocument.body,this.onKeyUp),hb.h(this.$).Nh.zq(Ja.nad),this.b1=!0;return!1};this.onKeyUp=
Za=>{if(this.Yq){if(this.c$a(Za)||Za.Da.keyCode===Ba.a.WXa)return this.gxf=this.c$a(Za)?0:1,this.HA&&hb.h(this.$).Nh.zq(Ja.cyb),Za.Da.keyCode===Ba.a.WXa&&(2===this.qL?(x.ULS.shipAssertTag(509159437,0,!!this.$h,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),x.ULS.sendTraceTag(509150297,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.hvb(!1),this.D_=0,this.Jpa(!0),x.ULS.shipAssertTag(509159436,0,!!this.gm(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),
this.aU(!0)):3===this.qL?(x.ULS.shipAssertTag(509159435,0,!!this.gm(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),x.ULS.sendTraceTag(509150296,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.AV(!1),this.D_=this.isRow?1:2,this.$h=this.isRow?[11]:[12],this.dRd(!0),x.ULS.shipAssertTag(509159434,0,!!this.$h,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.Jra(!0)):1===this.qL&&(x.ULS.shipAssertTag(509159433,
0,!!this.gm(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),x.ULS.sendTraceTag(509150295,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.AV(!1),this.$h=this.NS?[11]:[12],this.UNb(!0),x.ULS.shipAssertTag(509159432,0,!!this.$h,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.Jra(!0))),this.$Ic(this.gxf),!0}else if(Za.Da.keyCode===Ba.a.Sra||u.a.isMac&&Za.Da.keyCode===Ba.a.VXa)return this.$Ic(),this.HA&&hb.h(this.$).Nh.zq(Ja.HVe),
!0;return!1};this.dpa=Za=>{Za=ea.a(this.$).df(Za);5===this.Wn?this.MPf(Za):(this.HA=!1,x.ULS.shipAssertTag(509159430,0,!!this.$h,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.pc.Sk(this.$h),!this.$.xt([this.rc],!1)||this.Wrj()||this.Vsf()||(this.ga.sourceRange=this.sourceRange.clone(),this.Yq?this.hnj():this.y2e(),this.vea()?this.rc.top>this.sourceRange.top&&(Za=this.rc.height,this.rc.top-=Za,this.rc.bottom-=Za):this.rc.left>this.sourceRange.left&&(Za=this.rc.width,
this.rc.left-=Za,this.rc.right-=Za),this.GY()),this.bDd());x.ULS.sendTraceTag(509150292,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler");this.dL(this.cpa,this.dpa);this.tableRange=null;this.Wn=-1;this.Yq&&(this.Tga=null,this.qL=0);return!0};this.lLb=()=>{this.HA=!1;this.qL=0;x.ULS.shipAssertTag(509159429,0,!!this.$h,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null");this.pc.Sk(this.$h);if(!this.$.xt([this.rc],!1))return x.ULS.sendTraceTag(509150291,
0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.dL(this.kLb,this.lLb),this.Wn=-1,!0;if(!(this.ga.pa.Sd.equals(this.rc)||this.cEb(this.rc)||this.cEb(this.sourceRange)||this.Vsf()||(this.GY(),this.ga.sourceRange=this.sourceRange.clone(),this.$.Ed(-694765314,2,30,{[z.a.iMa]:this.b1,[z.a.Eed]:!0,[z.a.Fed]:this.PS,[z.a.ada]:this.ga.sourceRange,[z.a.$ca]:this.ga.pa.Sd,[z.a.$xb]:this.c1}),this.b1))){if(this.rc.top>this.sourceRange.top&&(this.isRow||this.rc.left===this.sourceRange.left&&
this.PS)){var Za=this.rc.height;this.rc.top-=Za;this.rc.bottom-=Za}else this.rc.left>this.sourceRange.left&&(this.uh||this.rc.top===this.sourceRange.top&&!this.PS)&&(Za=this.rc.width,this.rc.left-=Za,this.rc.right-=Za);this.GY()}x.ULS.sendTraceTag(509150290,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler");this.dL(this.kLb,this.lLb);this.Tga=this.tableRange=null;this.Wn=-1;this.PS=!1;this.bDd();return!0};this.cpa=Za=>{const Sb=oa.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");
Sb&&(Za=ea.a(this.$).df(Za));var sb=Za.clientPoint;Sb||(Za=ea.a(this.$).df(Za));this.Yq&&(this.WX=Za);if(Za=this.ga.hr(sb,Za.Fc,5,void 0,void 0,!0)){if(this.tableRange.contains(Za.topLeft)){if(this.hug(Za,this.vea(),sb),this.rc=this.qKa(Za),this.ga.sourceRange=this.rc,this.pc.rl(this.rc,this.$h),x.ULS.shipAssertTag(509159428,0,!!this.$h,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.pc.fs(this.$h),x.ULS.shipAssertTag(509159427,0,!!this.gm(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),
this.pc.Sk(this.gm()),6!==this.Wn){for(sb=1;4>=sb;sb++)Za=this.sm[sb.toString()],Za.parentNode.removeChild(Za),this.pc.xE(this.vea()?11:12,sb).kg.appendChild(Za);this.Wn=6}}else if(this.rc=this.Kub(Za),this.Yq)this.Fhf(!1);else if(this.pc.rl(this.rc,this.gm()),x.ULS.shipAssertTag(509159426,0,!!this.gm(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.pc.fs(this.gm()),x.ULS.shipAssertTag(509159425,0,!!this.$h,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),
this.pc.Sk(this.$h),5!==this.Wn){for(sb=1;4>=sb;sb++)Za=this.sm[sb.toString()],Za.parentNode.removeChild(Za),this.pc.xE(this.PAb(),sb).kg.appendChild(Za);this.Wn=5}this.zH()}return!0};this.kLb=Za=>{var Sb=oa.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");Sb&&(Za=ea.a(this.$).df(Za));var sb=Za.clientPoint;Sb||(Za=ea.a(this.$).df(Za));this.WX=Za;if(Sb=this.ga.hr(sb,Za.Fc,5,void 0,void 0,!0)){if(this.kjf(Sb))return this.rc=this.Kub(Sb),this.Ehf(!1),!0;var bc=hb.h(this.$),
kc=bc.gh(Sb),vb=bc.sg(this.paneType);sb=fb.a.kw(vb.view.kj,this.domElement.parentNode,sb,bc.rtl);vb=!1;let ub=2;this.PS=!1;if(this.isRow||this.uh){this.isRow&&sb.y-kc.topLeft.y>kc.height/2?(vb=!0,ub=1):this.uh&&sb.x-kc.topLeft.x>kc.width/2&&(vb=!0);if(vb){Za=bc.Bj("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",bc.dS,ub);try{Za.cx(Sb),Za.$$mn(),Sb=Za.$$cu().range}finally{Za&&Za.dispose()}}this.rc=this.Kub(Sb)}else{sb.x-kc.topLeft.x===kc.width?(this.PS=!1,vb=!0):sb.y-kc.topLeft.y>
kc.height/2&&(this.PS=vb=!0,ub=1);this.Tga&&(this.PS=this.NS);if(vb){bc=bc.Bj("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",bc.dS,ub);try{bc.cx(Sb),bc.$$mn(),Sb=bc.$$cu().range}finally{bc&&bc.dispose()}}x.ULS.shipAssertTag(509159424,0,!!this.$h,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null");this.pc.Sk(this.$h);this.$h=this.PS?[11]:[12];for(bc=1;4>=bc;bc++)(kc=this.sm[bc.toString()])&&kc.parentNode.removeChild(kc),this.sm[bc.toString()]=null;this.q$(Za.clientPoint,
Za.Fc,this.PS?11:12,!0);this.rc=this.qKa(Sb)}this.ga.sourceRange=this.rc;this.pc.rl(this.rc,this.$h);x.ULS.shipAssertTag(509159395,0,!!this.$h,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null");this.pc.fs(this.$h);x.ULS.shipAssertTag(509159394,0,!!this.gm(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null");this.pc.Sk(this.gm());if(6!==this.Wn){for(Za=1;4>=Za;Za++)Sb=this.sm[Za.toString()],Sb.parentNode.removeChild(Sb),this.pc.xE(this.isRow||this.PS?11:
12,Za).kg.appendChild(Sb);this.Wn=6}this.zH()}return!0};this.Adb=()=>{this.Yq?this.HA&&5<=this.Wn&&(this.tableRange?this.c1?(x.ULS.shipAssertTag(509159381,0,!!this.gm(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),x.ULS.sendTraceTag(509150281,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.AV(!0)):(x.ULS.shipAssertTag(509159380,0,!!this.$h,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),x.ULS.sendTraceTag(509150280,
0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.ivb(!0)):this.c1?this.isRow||this.uh?(x.ULS.shipAssertTag(509159385,0,!!this.gm(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),x.ULS.sendTraceTag(509150285,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.AV(!0)):(x.ULS.shipAssertTag(509159384,0,!!this.$h,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),x.ULS.sendTraceTag(509150284,
0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.hvb(!0)):this.isRow||this.uh?(x.ULS.shipAssertTag(509159383,0,!!this.$h,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),x.ULS.sendTraceTag(509150283,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.hvb(!0)):(x.ULS.shipAssertTag(509159382,0,!!this.gm(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),x.ULS.sendTraceTag(509150282,0,50,
"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.AV(!0))):this.HA&&5<=this.Wn&&(this.tableRange?(x.ULS.shipAssertTag(509159378,0,!!this.$h,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.pc.Sk(this.$h),x.ULS.sendTraceTag(509150278,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.dL(this.cpa,this.dpa)):(x.ULS.shipAssertTag(509159379,0,!!this.gm(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),
this.pc.Sk(this.gm()),x.ULS.sendTraceTag(509150279,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.dL(this.$j,this.Wh)))};this.tableRange=null;this.dQa=this.b1=this.c1=!1;this.ga.c3c(this.Adb)}dispose(){oa.EwaSettings.isChangeGateEnabled("OfficeVSO:7117157_ChangesInDragDropRefactoredCode")&&this.ga&&this.ga.sAc(this.Adb);this.b1&&this.$Ic();this.Yq&&this.c1&&this.$Ic(1);super.dispose()}zKd(Pb){this.Yq&&(this.WX=Pb,this.Tga=null,this.NS=this.isRow=this.uh=this.PS=
!1,fa.KeyInputManager.instance.ta(m.a.Ic,this.domElement.ownerDocument.body,this.onKeyDown));this.HA=!0;this.tableRange=this.rah(this.tableManager.Uq(this.sourceRange.topLeft));hb.h(this.$);this.tableRange&&!this.tableRange.equals(this.sourceRange)?this.Yq?(this.Tga=this.tableRange,this.qL=1,this.$h=(this.NS=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.Wn=6,x.ULS.sendTraceTag(509150305,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler"),
this.AP(this.cpa,this.dpa),this.Twa=this.Mcc,this.NDa=this.AEc,this.q$(Pb.clientPoint,Pb.Fc,this.NS?11:12,!0,!0),x.ULS.shipAssertTag(509159447,0,!!this.$h,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.Jra(!0)):(this.$h=(this.isRow=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.Wn=6,x.ULS.sendTraceTag(509150304,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler"),this.AP(this.cpa,
this.dpa),this.q$(Pb.clientPoint,Pb.Fc,this.isRow?11:12,!0)):(this.tableRange=null,this.Yq?(this.isRow=this.sourceRange.isRow,this.uh=this.sourceRange.uh,this.isRow||this.uh?(this.qL=3,this.D_=this.isRow?1:2,this.Wn=6,this.$h=this.isRow?[11]:[12],x.ULS.sendTraceTag(509150303,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler"),this.AP(this.kLb,this.lLb),this.Twa=this.Mcc,this.NDa=this.AEc,this.q$(Pb.clientPoint,Pb.Fc,this.isRow?11:12,!0,!0),x.ULS.shipAssertTag(509159446,
0,!!this.$h,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.Jra(!0)):(this.qL=2,this.D_=0,x.ULS.sendTraceTag(509150302,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler"),this.AP(this.$j,this.Wh),this.Twa=this.QVe,this.NDa=this.vgg,this.q$(Pb.clientPoint,Pb.Fc,this.PAb(),!1,!0),x.ULS.shipAssertTag(509159445,0,!!this.gm(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.aU(!0))):(x.ULS.sendTraceTag(509150301,0,50,
"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler"),this.AP(this.$j,this.Wh),fa.KeyInputManager.instance.ta(m.a.Ic,this.domElement.ownerDocument.body,this.onKeyDown),this.D_=this.sourceRange.isRow?1:this.sourceRange.uh?2:0,this.q$(Pb.clientPoint,Pb.Fc,this.PAb(),!1),x.ULS.shipAssertTag(509159444,0,!!this.gm(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.aU()))}ASa(){this.HA=!1;this.Yq&&(this.qL=0);x.ULS.shipAssertTag(509159431,0,!!this.gm(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null");
this.pc.Sk(this.gm());if(!this.$.xt([this.rc],!1))return x.ULS.sendTraceTag(509150294,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.dL(this.$j,this.Wh),this.Wn=-1,!0;if(this.ga.pa.Sd.equals(this.rc)||this.cEb(this.rc)||this.cEb(this.sourceRange))this.Wn=-1;else{this.GY();this.ga.sourceRange=this.sourceRange.clone();const Pb=this.ga.sourceRange,tb=this.ga.pa.Sd;this.Yq?this.$.Ed(-694765314,2,30,{[z.a.iMa]:this.b1,[z.a.ada]:Pb,[z.a.$ca]:tb,[z.a.$xb]:this.c1}):this.$.Ed(-694765314,
2,30,{[z.a.iMa]:this.b1,[z.a.ada]:Pb,[z.a.$ca]:tb})}if(this.Yq||!this.tableRange)x.ULS.sendTraceTag(509150293,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.dL(this.$j,this.Wh);this.bDd();return!0}AKd(Pb){const tb=this.ga.hr(Pb.clientPoint,Pb.Fc,5,void 0,void 0,!0);this.WX=Pb;return this.kjf(tb)?(this.rc=this.qKa(tb),this.Ehf(!0),!0):this.Yni(tb)?(this.rc=this.Kub(tb),this.Fhf(!0),!0):!1}zH(Pb=!1){const tb=this.rc.toString();if(this.Yq)for(var gc=1;4>=gc;gc++)if(this.x8d){const Xb=
this.sm[gc.toString()];Xb&&Xb.childNodes&&0<Xb.childNodes.length&&(Xb.childNodes[0].innerText=tb,Xb.childNodes[1].innerText=this.Twa,Pb&&(Xb.childNodes[2].innerText=this.NDa))}else this.sm[gc.toString()].childNodes[0].innerText=tb,this.sm[gc.toString()].childNodes[1].innerText=this.Twa,Pb&&(this.sm[gc.toString()].childNodes[2].innerText=this.NDa);else for(Pb=1;4>=Pb;Pb++)if(this.x8d){if(gc=this.sm[Pb.toString()])gc.innerText=tb}else this.sm[Pb.toString()].innerText=tb}kjf(Pb){return!!this.Tga&&1!==
this.qL&&!!Pb&&this.Tga.contains(Pb.topLeft)}Yni(Pb){return!!this.Tga&&1===this.qL&&!!Pb&&!this.Tga.contains(Pb.topLeft)}Ehf(Pb){this.tableRange=this.Tga;this.qL=1;const tb=!this.c1;Pb?(x.ULS.shipAssertTag(509159393,0,!!this.gm(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),x.ULS.sendTraceTag(509150289,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.AV(!1),this.$h=this.NS?[11]:[12],this.UNb(tb),x.ULS.shipAssertTag(509159392,0,!!this.$h,
"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.Jra(tb)):(x.ULS.shipAssertTag(509159391,0,!!this.$h,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),x.ULS.sendTraceTag(509150288,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.hvb(!1),this.Jpa(tb),x.ULS.shipAssertTag(509159390,0,!!this.gm(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.aU(tb))}Fhf(Pb){this.tableRange=null;this.qL=
2;const tb=!this.c1;Pb?(x.ULS.shipAssertTag(509159389,0,!!this.gm(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),x.ULS.sendTraceTag(509150287,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.AV(!1),this.$h=this.NS?[11]:[12],this.PS=this.NS,this.dRd(tb),x.ULS.shipAssertTag(509159388,0,!!this.$h,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.Jra(tb)):(x.ULS.shipAssertTag(509159387,0,!!this.$h,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),
x.ULS.sendTraceTag(509150286,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.ivb(!1),this.Jpa(tb),x.ULS.shipAssertTag(509159386,0,!!this.gm(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.aU(tb))}gib(){if(!hb.h(this.$).ga.pa.Vh)return!1;const Pb=hb.h(this.$).getRangeInformation(this.ga.pa.Sd);for(const tb of Pb)if(Object(Ma.a)(pa.PivotTableRange,tb))return!1;return!0}rah(Pb){if(Pb&&Pb.contains(this.sourceRange)&&!Pb.equals(this.sourceRange)){if(Pb.Zma&&
this.sourceRange.bottom===this.sourceRange.top&&this.sourceRange.top===Pb.top){const tb=new X.Range(this.sourceRange.top,this.sourceRange.left,Pb.bottom,this.sourceRange.right,!1,!1);if(!tb.equals(Pb))return this.sourceRange=tb,this.ga.updateSelection(this.sourceRange,this.sourceRange.topLeft,0),Pb}this.Yq?this.NS=Pb.left===this.sourceRange.left&&Pb.right===this.sourceRange.right:this.isRow=Pb.left===this.sourceRange.left&&Pb.right===this.sourceRange.right;if(Pb.top===this.sourceRange.top&&Pb.bottom===
this.sourceRange.bottom||this.vea())return Pb}return null}qKa(Pb){const tb=Pb.clone();this.vea()?tb.left=Math.max(Pb.left-this.Ksd,1):tb.top=Math.max(Pb.top-this.P8d,1);tb.right=tb.left+this.sourceRange.width-1;tb.bottom=tb.top+this.sourceRange.height-1;return this.Fsb(tb)}Vsf(){const Pb=this.rc.topLeft.Yd(this.sourceRange);return Pb||this.Yq&&!this.tableRange?Pb:this.vea()?this.rc.top===this.sourceRange.bottom+1:this.rc.left===this.sourceRange.right+1}Wrj(){if(this.vea()&&this.rc.left!==this.tableRange.left||
!this.vea()&&this.rc.top!==this.tableRange.top){const Pb=Ua.a.Wd(1,1,0,918,0,2065438552,"RearrangeInvalidDest");Sa.a(this.$).hv([Pb]);return!0}return!1}hnj(){const Pb=this.$.yc.Fd("UserAction","RearrangeRowColumnClientSide"),tb={["CopyPasteTargetType"]:1,["OperationId"]:ta.a.create().toString(),["Stopwatch"]:Pb,["DragDropIsShiftKeyDown"]:this.c1,["EncounteredDeploymentErrors"]:!1},gc=this.b1?2:1,Xb=this.$.da.Ba(254);(new Promise((Ga,Za)=>{this.y2e(Sb=>{Sb.Errors&&0<Sb.Errors.length?Za(new ca.a(22,
Sb.Errors)):Ga(!0)},Sb=>{Sb=ra.a.vf(Sb.data);Za(new ca.a(22,Sb))})})).then(()=>{x.ULS.sendTraceTag(520747156,0,50,'DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: success. copyPasteTargetType="1"');Xb&&Xb.IRi(tb,gc,this.sourceRange,this.rc);return Promise.resolve(!0)},Ga=>{x.ULS.sendTraceTag(520747155,0,10,`DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: ${Ga?copyPasteInfra.getStringifiedError(Ga):"null"}, copyPasteTargetType="${1}"`);return Xb?Xb.xaj(Ga,tb,gc,this.sourceRange,
this.rc):Promise.reject(Ga)})}y2e(Pb=null,tb=null){const gc={};this.vea()?(gc.FirstRow=this.rc.top-1,gc.FirstColumn=0,gc.DeltaColumn=0,gc.DeltaRow=this.rc.bottom-this.rc.top+1):(gc.FirstRow=0,gc.FirstColumn=this.rc.left-1,gc.DeltaColumn=this.rc.right-this.rc.left+1,gc.DeltaRow=0);gc.LastRow=V.a.Hz;gc.LastColumn=V.a.ey;gc.SheetName=this.$.ua.na?this.$.ua.na.name:this.$.oc.getItemByName(this.$.oc.na.name).sheetName;const Xb=U.v(this.sourceRange,this.$);this.$.userOperationManager.Bd(new ma.a(514,0,
(Ga,Za,Sb)=>ja(this.$.qa.va,Xb,gc,Pb?Va.b(Ga,Pb):Ga,tb?Va.a(Za,tb):Za,Sb,null),64,()=>new wb(Xb,gc)),null)}$Ic(Pb=0){0===Pb?this.b1=!1:1===Pb&&(this.c1=!1);this.Yq&&(this.b1||this.c1)||(fa.KeyInputManager.instance.Aa(m.a.De,this.domElement.ownerDocument.body,this.onKeyUp),this.dQa=!1)}Jpa(Pb=!1){this.Wn=5;x.ULS.sendTraceTag(509150277,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler");this.AP(this.$j,this.Wh);this.Twa=this.QVe;this.NDa=this.vgg;this.q$(this.WX.clientPoint,
this.WX.Fc,this.PAb(),!1,Pb)}dRd(Pb=!1){this.Wn=6;x.ULS.sendTraceTag(509150276,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler");this.AP(this.kLb,this.lLb);this.Twa=this.Mcc;this.NDa=this.AEc;this.q$(this.WX.clientPoint,this.WX.Fc,this.isRow||this.NS?11:12,!0,Pb)}UNb(Pb=!1){this.Wn=6;x.ULS.sendTraceTag(509150275,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler");this.AP(this.cpa,this.dpa);this.Twa=this.Mcc;this.NDa=this.AEc;this.q$(this.WX.clientPoint,
this.WX.Fc,this.vea()?11:12,!0,Pb)}vea(){return!this.Yq&&this.isRow||this.Yq&&this.NS}hvb(Pb){this.pc.Sk(this.$h);this.dL(this.kLb,this.lLb,void 0,Pb)}bDd(){const Pb=Oa.a.instance.Dc("Common.ISystemInitiatedFeedback");Pb&&Pb.execute(tb=>{tb.logActivity("DragDrop",null)})}}Object(b.a)(nb,"DragSelectionClickBehaviorCellRangeAndTable",Ia,[]);var pb=a(329),cb=a(150);class Da extends Ia{constructor(Pb,tb,gc,Xb,Ga){super(Pb,tb,gc,Xb,Ga);this.Adb=()=>{this.HA&&(x.ULS.shipAssertTag(509159371,0,!!this.$h,
"DragSelectionClickBehaviorPivotTableRange: currentHighlight is null"),x.ULS.sendTraceTag(509150340,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler"),this.ivb(!0));5===this.Wn&&(x.ULS.shipAssertTag(509159370,0,!!this.gm(),"DragSelectionClickBehaviorPivotTableRange: getDragHighlight is null"),x.ULS.sendTraceTag(509150339,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler"),this.AV(!0))};this.dpa=Za=>{ea.a(this.$).df(Za);this.HA=!1;x.ULS.shipAssertTag(509159369,
0,!!this.$h,"DragSelectionClickBehaviorPivotTableRange: currentHighlight is null");this.pc.Sk(this.$h);this.ga.sourceRange=this.sourceRange.clone();this.Ruf?this.$.Ed(927125067,S.a.fc,30,null):this.Dza?(this.GY(),this.ga.sourceRange=this.sourceRange.clone(),this.$.Ed(-694765314,2,30,{[z.a.iMa]:!0,[z.a.ada]:this.ga.sourceRange,[z.a.$ca]:this.ga.pa.Sd,[z.a.$xb]:!1}),x.ULS.sendTraceTag(509617280,0,50,"DragSelectionClickBehaviorPivotTableRange.onPointerUpRearrange: dragDropCells"),hb.h(this.$).Nh.zq(z.a.LW),
this.Dza=!1):this.Zmj();x.ULS.sendTraceTag(509150338,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler");this.dL(this.cpa,this.dpa);this.Wn=-1;return!0};this.cpa=Za=>{Za=ea.a(this.$).df(Za);const Sb=Za.clientPoint;this.WX=Za;let sb=this.ga.hr(Sb,Za.Fc,5,void 0,void 0,!0);if(sb){if(!this.Kyd(sb))return this.Xki(Za),!0;this.hug(sb,this.isRow,Sb);if(this.isRow||this.uh)this.rc=this.qKa(sb);this.ga.sourceRange=this.rc;this.pc.rl(this.rc,this.$h);x.ULS.shipAssertTag(509159368,
0,!!this.$h,"DragSelectionClickBehaviorPivotTableRange: currentHighlight is null");this.pc.fs(this.$h);x.ULS.shipAssertTag(509159367,0,!!this.gm(),"DragSelectionClickBehaviorPivotTableRange: getDragHighlight is null");this.pc.Sk(this.gm());this.zH()}return!0};this.onKeyDown=Za=>this.c$a(Za)?(this.dQa||(fa.KeyInputManager.instance.ta(m.a.De,this.domElement.ownerDocument.body,this.onKeyUp),this.dQa=!0),this.Dza||(hb.h(this.$).Nh.zq(Ja.nad),this.Dza=!0),!0):!1;this.onKeyUp=Za=>{this.c$a(Za)&&(fa.KeyInputManager.instance.Aa(m.a.De,
this.domElement.ownerDocument.body,this.onKeyUp),this.dQa=!1,this.HA?hb.h(this.$).Nh.zq(Ja.cyb):hb.h(this.$).Nh.zq(z.a.LW),this.Dza=!1);return!0};this.QOf=Za=>{Za.Errors&&0<Za.Errors.length?(x.ULS.sendTraceTag(521410185,0,10,`DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsSuccess: Errors: [${Ua.a.Uc(Za.Errors)}]`),this.rc.left=this.sourceRange.left,this.rc.right=this.sourceRange.right,this.rc.top=this.sourceRange.top,this.rc.bottom=this.sourceRange.bottom):this.isRow?this.sourceRange.top<=
this.rc.top&&this.sourceRange.bottom>=this.rc.top-1?(this.rc.top=this.sourceRange.top,this.rc.bottom=this.sourceRange.bottom):(this.sourceRange.top>this.rc.top||(this.rc.top-=this.sourceRange.height),this.rc.bottom=this.rc.top+this.sourceRange.height-1):this.sourceRange.left<=this.rc.left&&this.sourceRange.right>=this.rc.left-1?(this.rc.left=this.sourceRange.left,this.rc.right=this.sourceRange.right):(this.sourceRange.left>this.rc.left||(this.rc.left-=this.sourceRange.width),this.rc.right=this.rc.left+
this.sourceRange.width-1);this.GY();this.Wn=-1};this.POf=Za=>{Za=ra.a.vf(Za.data);x.ULS.sendTraceTag(521410184,0,10,`DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsFail: Errors: [${Ua.a.Uc(Za)}]`)};this.ga.c3c(this.Adb);this.Dza=this.dQa=!1}dispose(){oa.EwaSettings.isChangeGateEnabled("OfficeVSO:7117157_ChangesInDragDropRefactoredCode")&&this.ga&&this.ga.sAc(this.Adb);super.dispose()}zKd(Pb){this.WX=Pb;this.isRow=this.uh=!1;oa.EwaSettings.isChangeGateEnabled("OfficeVSO:7642616_DraggingEntireColumnsBug")&&
(this.D_=null!=this.rc?this.rc.isRow?1:this.rc.uh?2:0:0);this.HA=!0;fa.KeyInputManager.instance.ta(m.a.Ic,this.domElement.ownerDocument.body,this.onKeyDown);this.Cc=this.tableManager.Dma(this.sourceRange);this.Fpf=this.xGi(this.rc);this.Cc||x.ULS.sendTraceTag(512341332,0,50,"DragSelectionClickBehaviorPivotTableRange.onPointerDownInternal: pivotTableRange null for range {0}",this.sourceRange);this.Ruf=(new cb.a(this.$.ua)).ki;hb.h(this.$);hb.h(this.$).Nh.zq(Ja.cyb);this.Kyd(this.rc)?(this.isRow=this.pHi(),
this.uh=this.wAi(),this.isRow||this.uh?(this.V$a=!1,this.UNb(Pb),this.rc=this.qKa(this.rc),x.ULS.shipAssertTag(509159377,0,!!this.$h,"DragSelectionClickBehaviorPivotTableRange: currentHighlight is null"),this.Jra()):(this.V$a=!0,this.Jpa(Pb),x.ULS.shipAssertTag(509159376,0,!!this.gm(),"DragSelectionClickBehaviorPivotTableRange: getDragHighlight is null"),this.aU())):(this.V$a=!0,this.Jpa(Pb),x.ULS.shipAssertTag(509159375,0,!!this.gm(),"DragSelectionClickBehaviorPivotTableRange: getDragHighlight is null"),
this.aU())}ASa(){oa.EwaSettings.isChangeGateEnabled("OfficeVSO:7657099_CleaningUpIsDragging")&&(this.HA=!1);return this.Ruf?(this.$.Ed(927125067,S.a.fc,30,null),x.ULS.shipAssertTag(509159374,0,!!this.gm(),"DragSelectionClickBehaviorPivotTableRange: getDragHighlight is null"),x.ULS.sendTraceTag(509150343,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler"),this.AV(!0),this.V$a=!1,this.Wn=-1,!0):this.Dza||oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MovePivotTables",
!1)&&oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",!1)&&this.Fpf?(this.GY(),this.ga.sourceRange=this.sourceRange.clone(),this.$.Ed(-694765314,2,30,{[z.a.iMa]:this.Dza,[z.a.ada]:this.ga.sourceRange,[z.a.$ca]:this.ga.pa.Sd,[z.a.$xb]:!1}),x.ULS.sendTraceTag(509617281,0,50,`DragSelectionClickBehaviorPivotTableRange.onPointerUpInternal: dragDropCells with isCopyOperation="${this.Dza}"`),hb.h(this.$).Nh.zq(z.a.LW),x.ULS.shipAssertTag(509159373,0,!!this.gm(),"DragSelectionClickBehaviorPivotTableRange: getDragHighlight is null"),
x.ULS.sendTraceTag(509150342,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler"),this.AV(!0),this.V$a=!1,this.Wn=-1,this.Fpf=!1,!0):5===this.Wn?(x.ULS.shipAssertTag(509159372,0,!!this.gm(),"DragSelectionClickBehaviorPivotTableRange: getDragHighlight is null"),x.ULS.sendTraceTag(509150341,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler"),this.AV(!0),this.V$a=!1,this.PXj(),this.Wn=-1,!0):!1}AKd(Pb){const tb=this.ga.hr(Pb.clientPoint,Pb.Fc,5,void 0,
void 0,!0);this.WX=Pb;return this.V$a?!1:this.Kyd(tb)?(this.Yki(Pb),!0):!1}zH(){let Pb=new X.Range(this.rc.top,this.rc.left,this.rc.bottom,this.rc.right,!1,!0);6===this.Wn&&(this.isRow?(--Pb.top,Pb.bottom=Pb.top+this.rc.height-1):(--Pb.left,Pb.right=Pb.left+this.rc.width-1));for(let tb=1;4>=tb;tb++)if(this.x8d){const gc=this.sm[tb.toString()];gc&&gc.childNodes&&0<gc.childNodes.length&&(gc.childNodes[0].innerText=Pb.toString())}else this.sm[tb.toString()].childNodes[0].innerText=Pb.toString()}gib(){if(!hb.h(this.$).ga.pa.Vh)return!1;
var Pb=hb.h(this.$).getRangeInformation(this.ga.pa.Sd);for(var tb of Pb)if(Object(Ma.a)(pa.PivotTableRange,tb)&&(Pb=this.tableManager.Dma(tb)))return tb=!Pb.isOlap||!Pb.MQa(!0),x.ULS.sendTraceTag(512341331,0,50,"DragSelectionClickBehaviorPivotTableRange.shouldShowHandlesOnSelectionChanged: enabling for range {0}",Pb),Pb.isActionable&&tb;return!1}qKa(Pb){Pb=Pb.clone();this.isRow?(Pb.left=this.sourceRange.left,Pb.right=this.Cc.right,Pb.bottom=Pb.top+this.sourceRange.height-1):this.uh?(Pb.top=this.sourceRange.top,
oa.EwaSettings.isChangeGateEnabled("OfficeVSO:7696997_ManualSortIssueFix")&&!this.Cc.Xt?Pb.bottom=this.Cc.bottom:Pb.bottom=this.Cc.Xt.bottom,Pb.right=Pb.left+this.sourceRange.width-1):x.ULS.sendTraceTag(520176346,0,10,"DragSelectionClickBehaviorPivotTableRange.calculateRearrangeRange: no row/column rearrange");return this.Fsb(Pb)}Zmj(){const Pb={},tb=U.v(this.sourceRange,this.$);hb.h(this.$).getRangeInformation(this.rc);if(this.isRow){tb.FirstColumn=Pb.FirstColumn=this.rc.left-1;tb.LastColumn=Pb.LastColumn=
this.rc.right-1;if(this.sourceRange.top<=this.rc.top&&this.sourceRange.bottom>=this.rc.top-1){x.ULS.sendTraceTag(520176345,0,50,"DragSelectionClickBehaviorPivotTableRange.processMoveLineItems: no-op");return}this.sourceRange.top>this.rc.top?Pb.LastRow=Pb.FirstRow=this.rc.top-1:(Pb.FirstRow=this.rc.top-this.sourceRange.height-1,Pb.LastRow=Pb.FirstRow+this.sourceRange.height-1)}else{oa.EwaSettings.isChangeGateEnabled("OfficeVSO:7696997_ManualSortIssueFix")?Pb.FirstRow=Math.min(this.rc.top,this.rc.bottom-
1):Pb.FirstRow=this.rc.top;Pb.LastRow=this.rc.bottom-1;if(this.sourceRange.left<=this.rc.left&&this.sourceRange.right>=this.rc.left-1){x.ULS.sendTraceTag(520176344,0,50,"DragSelectionClickBehaviorPivotTableRange.processMoveLineItems: no-op");return}Pb.LastColumn=this.sourceRange.left>this.rc.left?Pb.FirstColumn=this.rc.left-1:Pb.FirstColumn=this.rc.left-this.sourceRange.width-1}const gc={};gc.SheetName=this.$.ua.na?this.$.ua.na.name:this.$.oc.getItemByName(this.$.oc.na.name).sheetName;gc.Ranges=Array(2);
gc.Ranges[0]=tb;gc.Ranges[1]=Pb;this.YPh(gc)}YPh(Pb){this.$.userOperationManager.Bd(new ma.a(265,0,(tb,gc,Xb)=>lb(this.$.qa.va,Pb,this.QOf?Va.b(tb,this.QOf):tb,this.POf?Va.a(gc,this.POf):gc,Xb,null),64),null)}Kyd(Pb){return null!==this.Cc&&this.pEi(Pb)&&this.iHi(Pb)&&this.CJi(Pb)&&this.Czi(Pb)}pEi(Pb){return oa.EwaSettings.isChangeGateEnabled("OfficeVSO:7696997_ManualSortIssueFix")?this.Cc.Xt?Pb.left>=this.Cc.Xt.left:this.Cc.Fw?Pb.left>=this.Cc.Fw.left:Pb.left>=this.Cc.left:null===this.Cc.Xt||Pb.left>=
this.Cc.Xt.left}iHi(Pb){return oa.EwaSettings.isChangeGateEnabled("OfficeVSO:7696997_ManualSortIssueFix")?this.Cc.Fw?Pb.right<=this.Cc.Fw.right:this.Cc.Xt?Pb.right<=this.Cc.Xt.right:Pb.right<=this.Cc.right:null===this.Cc.Fw||Pb.right<=this.Cc.Fw.right}CJi(Pb){return oa.EwaSettings.isChangeGateEnabled("OfficeVSO:7666231_CannotSortColumnsInPivotTable")?this.isRow?null!==this.Cc.Xt&&Pb.top>=this.Cc.Xt.top:this.uh?null!==this.Cc.Fw&&Pb.top>=this.Cc.Fw.top:null===this.Cc.top||Pb.top>=this.Cc.top:null===
this.Cc.Xt||Pb.top>=this.Cc.Xt.top}Czi(Pb){return oa.EwaSettings.isChangeGateEnabled("OfficeVSO:7696997_ManualSortIssueFix")?this.Cc.Xt?Pb.bottom<=this.Cc.Xt.bottom:this.Cc.Fw?Pb.bottom<=this.Cc.Fw.bottom:Pb.bottom<=this.Cc.bottom:null===this.Cc.Xt||Pb.bottom<=this.Cc.Xt.bottom}xGi(Pb){return null!==this.Cc&&this.Cc.left>=Pb.left&&this.Cc.right<=Pb.right&&this.Cc.top>=Pb.top&&this.Cc.bottom<=Pb.bottom}pHi(){return null!==this.Cc&&null!==this.Cc.Xt&&this.Cc.Xt.top<=this.rc.top&&this.Cc.Xt.left<=this.rc.left&&
this.Cc.Xt.right>=this.rc.left}wAi(){return null!==this.Cc&&null!==this.Cc.Fw&&this.Cc.Fw.top===this.rc.top&&this.Cc.Fw.left<=this.rc.left&&this.Cc.Fw.right>=this.rc.right}UNb(Pb){this.Wn=6;this.$h=this.isRow?[11]:[12];x.ULS.sendTraceTag(509150337,0,50,"DragSelectionClickBehaviorPivotTableRange: Registering mouse handler");this.AP(this.cpa,this.dpa);this.q$(Pb.clientPoint,Pb.Fc,this.isRow?11:12,!0,!1)}Jpa(Pb){this.Wn=5;x.ULS.sendTraceTag(509150336,0,50,"DragSelectionClickBehaviorPivotTableRange: Registering mouse handler");
this.AP(this.$j,this.Wh);this.q$(Pb.clientPoint,Pb.Fc,this.PAb(),!1,!1)}Yki(Pb){x.ULS.shipAssertTag(509159366,0,!!this.gm(),"DragSelectionClickBehaviorPivotTableRange.handleDragWithinPivotTable: getDragHighlight is null");x.ULS.sendTraceTag(509150307,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler");this.AV(!1);this.UNb(Pb);this.rc=this.qKa(this.rc);x.ULS.shipAssertTag(509159365,0,!!this.$h,"DragSelectionClickBehaviorPivotTableRange: currentHighlight is null");this.Jra()}Xki(Pb){x.ULS.shipAssertTag(509159364,
0,!!this.$h,"DragSelectionClickBehaviorPivotTableRange: currentHighlight is null");x.ULS.sendTraceTag(509150306,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler");this.ivb(!1);this.Jpa(Pb);x.ULS.shipAssertTag(509159363,0,!!this.gm(),"DragSelectionClickBehaviorPivotTableRange.handleDragOutsidePivotTable: getDragHighlight is null");this.aU()}PXj(){if(!(oa.EwaSettings.isChangeGateEnabled("OfficeVSO:7563140_ClickingEdgeOfCellFix")&&null!=this.sourceRange&&null!=this.rc&&this.sourceRange.vz(!1)===
this.rc.vz(!1)||this.cEb(this.rc))){var Pb=Ua.a.Wd(1,0,904,903,0,2069074184,"PivotTableInvalidMove");Pb.HelpTopicId=pb.a.D0j;Pb.HelpDescription=Ab.a.instance.ha(913);Sa.a(this.$).hv([Pb])}}}Object(b.a)(Da,"DragSelectionClickBehaviorPivotTableRange",Ia,[]);var zb=a(383);class qb extends la{constructor(Pb,tb){super(Pb);this.Uf=()=>{this.domElement.classList.remove(xa.selecting);zb.c(this.gridView.$,!0,"FillHandleClickBehavior:OnSelectionEnded")};this.Ws=()=>{this.domElement.classList.add(xa.selecting)};
this.onPointerDown=gc=>{2===gc.kc&&gc.ap===Sys.UI.MouseButton.leftButton&&(this.gridView.ga.selectionType=4,this.gridView.ga.sourceRange=this.gridView.ga.pa.Sd,zb.c(this.gridView.$,!1,"FillHandleClickBehavior:OnSelectionStarted"));return!1};this.ofa=()=>{this.gridView.$.Ed(1983983164,2,30,null);return!0};this.ee=()=>{D.DOMElementExtensions.setVisible(this.pda,this.gridView.$.isEditMode)};this.j9=()=>{D.DOMElementExtensions.setVisible(this.pda,!1)};this.i9=()=>{D.DOMElementExtensions.setVisible(this.pda,
!0)};this.aNf=()=>{D.DOMElementExtensions.setVisible(this.pda,!1)};this.$Mf=()=>{D.DOMElementExtensions.setVisible(this.pda,!0)};this.DKb=(gc,Xb)=>{D.DOMElementExtensions.setVisible(this.pda,!Xb.ove)};this.gridView=tb;tb=document.createElement("div");tb.className=Ea.a.uOh;this.pda=tb;this.ee(null,null);Pb.appendChild(tb);w.a.instance.ta(m.a.pointerDown,this.pda,this.onPointerDown);R.a.instance.ta(m.a.nl,this.pda,this.ofa);oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DetachSelectionFillHandleListener",
!1)||(this.gridView.ga.yba(this.Ws),this.gridView.ga.f5(this.Uf));this.gridView.$.$l(this.ee);this.gridView.$.Zb.$4b(this.j9);this.gridView.$.Zb.Z4b(this.i9);this.gridView.Rxe(this.DKb);this.gridView.cellTextEditBox.ro(this.aNf);this.gridView.cellTextEditBox.Pm(this.$Mf)}dispose(){w.a.instance.Aa(m.a.pointerDown,this.pda,this.onPointerDown);R.a.instance.Aa(m.a.nl,this.pda,this.ofa);this.gridView.$&&(oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DetachSelectionFillHandleListener",!1)||
(this.gridView.ga.mga(this.Ws),this.gridView.ga.v2(this.Uf)),this.gridView.$.hn(this.ee),this.gridView.$.Zb.xAc(this.j9),this.gridView.$.Zb.wAc(this.i9),this.gridView.F4f(this.DKb),this.gridView.cellTextEditBox.io(this.aNf),this.gridView.cellTextEditBox.fn(this.$Mf));super.dispose()}}Object(b.a)(qb,"FillHandleClickBehavior",la,[]);class Pa extends B{constructor(Pb,tb){super(Pb);this.Pbj=gc=>{const Xb=J.HelperMethods.Fp(gc);var Ga=this.Lya.V8d(gc.clientPoint);if(!Ga)return!1;var Za=Ga.Se,Sb=this.Lya.Ca.cBb(Za.hashCode).aya(Ga.wK);
if(!Sb)return!1;gc=Za.jk.domElement;Ga=J.HelperMethods.Uwe(J.HelperMethods.BBb(Za.domElement,gc),Ga.wK);Za=0;Sb=this.Lya.tc(Sb.getRange());for(let bc=0,kc=Pa.GIe.length;bc<kc;++bc){const vb=Pa.GIe[bc];if((128===vb||64===vb)&&this.Lya.$.isEditMode)continue;var sb=Sb.YNa(vb);if(!sb||!sb.J9a||"none"===sb.J9a.style.display)continue;sb=sb.J9a;const ub=J.HelperMethods.BBb(sb,gc);sb=new Sys.UI.Bounds(ub.x,ub.y,sb.offsetWidth,sb.offsetHeight);if(M.a.FS(sb,Ga)){Za=vb;break}}return 0!==Za?(Sb.invoke(Za,Xb),
!0):!1};this.$Hg=tb;R.a.instance.ta(m.a.click,Pb,this.Pbj)}get Lya(){return this.$Hg}}Pa.GIe=[1,2,32,256,128,64];Object(b.a)(Pa,"IPadSelectionClickThroughBehavior",B,[]);var Nb=a(23);class Tb{constructor(Pb){this.plf=tb=>{this.CJc(tb.Fc,1);return!0};this.qlf=tb=>{this.CJc(tb.Fc,-1);return!0};this.Uf=()=>{this.yxd=!1};this.Ws=()=>{this.yxd=!0};this.gridView=Pb;this.h9a=0;this.yxd=this.Anc=!1;this.n8=Number.NaN;this.gridView.ga.yba(this.Ws);this.gridView.ga.f5(this.Uf);this.gridView.ga.c3c(this.Uf)}dispose(){this.gridView.ga.mga(this.Ws);
this.gridView.ga.v2(this.Uf);this.gridView.ga.sAc(this.Uf)}z2(){this.h9a=0;this.Anc=!1;this.n8=Number.NaN}OVe(Pb){this.Anc=!0;this.CJc(Pb,1)}PVe(Pb){this.Anc=!1;this.CJc(Pb,-1)}CJc(Pb,tb){if(Pb)if(Pb.parentNode)if(this.yxd)isNaN(this.n8)||(this.UJc(this.n8,!1),this.n8=Number.NaN);else if(Pb=parseInt(Pb.parentNode.getAttribute(z.a.y9a),10),isNaN(Pb))x.ULS.shipAssertTag(537159366,0,!1,"MarqueeHoveringManager.UpdateMarqueeStyle: indexInMarqueeCollection is not a valid number.");else{if(!isNaN(this.n8)&&
Pb!==this.n8){if(this.Anc)return;this.UJc(this.n8,!1)}if(isNaN(this.n8)||Pb!==this.n8)this.n8=Pb,this.h9a=0;!this.h9a&&0<tb&&this.UJc(Pb,!0);this.h9a=Math.max(this.h9a+tb,0);!this.h9a&&0>tb&&(this.UJc(Pb,!1),this.n8=Number.NaN)}else x.ULS.shipAssertTag(537159367,0,!!Pb.parentNode,"MarqueeHoveringManager.UpdateMarqueeStyle: handle.ParentNode is null.");else x.ULS.shipAssertTag(537159368,0,!!Pb,"MarqueeHoveringManager.UpdateMarqueeStyle: handle is null.")}UJc(Pb,tb){var gc=oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UpdateHighlightOnRelevantPanes",
!1)&&oa.EwaSettings.isChangeGateEnabled("OfficeVSO:7903302_avoidGettingIrrelevantHighlights")?this.gridView.Mb.hLc:[1,3,2,4];for(const Xb of gc)for(gc=this.gridView.pc.xE(3,Xb,Pb).kg,D.DOMElementExtensions.toggleCssClass(gc,xa.RNh,tb),gc=gc.firstChild;gc;gc=gc.nextSibling)Nb.a.contains(gc.className,"resizemarqueehandle",!0)&&D.DOMElementExtensions.toggleCssClass(gc,xa.VNh,tb)}}Object(b.a)(Tb,"MarqueeHoveringManager",null,[]);var Vb=a(180),Jb=a(126),Qa=a(863),Db=a(1300);class sa extends B{constructor(Pb,
tb){super(Pb);this.Avc=()=>{if(!this.Xw)return x.ULS.shipAssertTag(537159364,0,!1,"RangeCatchUpActivityHighlightBehavior.OnPointerEnter: highlightController is null"),!1;this.Xw.bqj(this.Tda);this.Xw.FDh(this.Uda);if(3===this.Xw.model.state)return!0;this.Xw.atd(!0);return!0};this.xfa=()=>{if(!this.Xw)return!1;this.Xw.c_f(!1);this.Xw.uUd(this.Uda,!1);if(3===this.Xw.model.state)return!0;this.Xw.atd(!1);return!0};this.onPointerDown=gc=>this.Xw?2===gc.kc&&gc.ap===Sys.UI.MouseButton.leftButton?!0:!1:!1;
this.aLb=()=>{if(!this.Xw)return!1;this.Xw.uUd(this.Uda,!0);this.Xw.atd(!1);this.Xw.aMa();return!0};this.onDoubleClick=gc=>{if(gc.Da)return gc.Da.stopPropagation(),!0;x.ULS.sendTraceTag(537159363,0,50,"CatchUpActivityHighlightBehavior::OnDoubleClick Double click event handled on Pill.");return!0};this.Xw=Object(Jb.a)(Db.a,tb.metadata);this.Uda=document.createElement("div");this.Uda.id=`${Pb.id}-${z.a.wIe}`;this.Uda.className=Qa.a.Zbh;this.Tda=document.createElement("div");this.Tda.id=`${Pb.id}-${z.a.P7c}`;
this.Tda.className=Qa.a.P7c;this.sS=document.createElement("div");this.sS.appendChild(this.Tda);this.sS.className=Qa.a.Ybh;this.Uda.appendChild(this.sS);Pb.appendChild(this.Uda);x.ULS.sendTraceTag(537159365,0,50,"RangeCatchUpActivityHighlightBehavior::RangeCatchUpActivityHighlightBehavior: An activity indicator has been created.");w.a.instance.ta(m.a.XX,this.sS,this.Avc);w.a.instance.ta(m.a.TC,this.sS,this.xfa);w.a.instance.ta(m.a.pointerDown,this.sS,this.onPointerDown);Vb.a.instance.ta(m.a.click,
this.sS,this.aLb);Vb.a.instance.ta(m.a.nl,this.sS,this.onDoubleClick);D.DOMElementExtensions.setVisible(this.sS,tb.isVisible)}dispose(){w.a.instance.Aa(m.a.XX,this.sS,this.Avc);w.a.instance.Aa(m.a.TC,this.sS,this.xfa);w.a.instance.Aa(m.a.pointerDown,this.sS,this.onPointerDown);Vb.a.instance.Aa(m.a.click,this.sS,this.aLb);Vb.a.instance.Aa(m.a.nl,this.sS,this.onDoubleClick);D.DOMElementExtensions.tg(this.Tda);this.Tda=null;D.DOMElementExtensions.tg(this.Uda);this.Xw=this.Uda=null;super.dispose()}S1a(Pb){this.Xw=
Object(Jb.a)(Db.a,Pb.metadata);oa.EwaSettings.isChangeGateEnabled("OfficeVSO:7800556_DisableRangeHighlightAdjustBehaivor")||Pb.isVisible===Pb.wAa||(this.Xw.wRj(Pb.isVisible?1:0),D.DOMElementExtensions.setVisible(this.Uda,Pb.isVisible))}}Object(b.a)(sa,"RangeCatchUpActivityHighlightBehavior",B,[]);class Ha extends ia{constructor(Pb,tb,gc,Xb){super(Pb,tb,gc,Xb)}get r7(){return 16}get bhb(){return this.gridView.ga.rangePicker.lld(!1)}WVa(){return(this.gridView.inRangePicker||this.gridView.hj)&&super.WVa()}}
Object(b.a)(Ha,"RangePickerTouchGrippiesBehavior",ia,[]);class mb extends B{constructor(Pb,tb){super(Pb);const gc=document.createElement("div"),Xb=document.createElement("div");gc.className=tb?xa.COh:xa.EOh;Xb.className=tb?xa.DOh:xa.BOh;Pb.appendChild(gc);Pb.appendChild(Xb)}}Object(b.a)(mb,"RearrangeHighlightBehavior",B,[]);var qa;(function(Pb){Pb[Pb.topLeft=0]="topLeft";Pb[Pb.topRight=1]="topRight";Pb[Pb.bottomLeft=2]="bottomLeft";Pb[Pb.bottomRight=3]="bottomRight";Pb[Pb.error=4]="error"})(qa||(qa=
{}));Object(b.b)("Corner",qa);class Xa extends B{constructor(Pb,tb,gc,Xb,Ga){super(Pb);this.lc=this.tH=null;this.e6=0;this.rc=this.sourceRange=null;this.GWa=!1;this.onPointerDown=Za=>{Za=ea.a(this.$).df(Za);if(this.Wgg(Za)&&!this.GWa){this.cBf();this.lc=this.Ap.vgc();this.tH=this.Ap.uef(Za);if(!this.lc||!this.tH||!this.tH.range)return x.ULS.shipAssertTag(537159361,0,!!this.lc,"ResizeMarqueeBehaviorBase.OnPointerDown: cellContentEditor is null"),x.ULS.shipAssertTag(537159360,0,!!this.tH,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState is null"),
x.ULS.shipAssertTag(537159331,0,!!this.tH.range,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState.Range is null"),!1;this.rc=this.tH.range.clone();this.sourceRange=this.rc.clone();this.e6=this.U$e(Za);if(4===this.e6)return x.ULS.shipAssertTag(537159330,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;const Sb=this.Vbf(Za,!0);if(!Sb)return x.ULS.shipAssertTag(537159329,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: mouseSelection is null. Not expect when clicking on handler."),
!1;if(!this.XPe(Sb))return x.ULS.shipAssertTag(537159328,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;this.gridView.iPa=!0;this.lc.aG(!1);this.aH.OVe(Za.Fc);this.Ap.p_f(!0,this.Vda.BV);this.lc.textBox.removeSelection();this.lc.E4b(this.hif);this.P2f();this.GWa=!0;wa.b(this.$,!0)}return!0};this.$j=Za=>{Za=ea.a(this.$).df(Za);Za=this.Vbf(Za,!1);if(!Za)return!0;Za=this.XPe(Za);if(!Za)return x.ULS.shipAssertTag(537159327,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: newMarqueeRange is null"),
this.qfc(!0),!1;if(this.rc.equals(Za))return!0;this.rc=Za;Za=this.aU();Za||(x.ULS.shipAssertTag(537159326,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.qfc(!0));return Za};this.Wh=Za=>{ea.a(this.$).df(Za);Za=this.GY();x.ULS.shipAssertTag(537159325,0,Za,"ResizeMarqueeBehaviorBase.OnPointerUp: SetSelectedRange failed");this.qfc(!Za);return Za};this.hif=()=>{this.qfc(!0)};this.gridView=tb;this.$=tb.$;this.DM=[];this.ga=this.gridView.ga;this.aH=gc;this.Ap=Xb;this.Vda=
Ga;this.coloredReferencesManager=this.$.da.Ba(281);x.ULS.shipAssertTag(537159362,0,!!this.coloredReferencesManager,"ResizeMarqueeBehaviorBase Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");if(this.DO=F.a.JE(this.$))tb=this.$.da.Ba(464),x.ULS.shipAssertTag(510255176,0,!!tb,"ResizeMarqueeBehaviorBase Ctor: formulaAssistanceManager is null. We already have marquee highlights so it shouldn't happen."),this.oC=tb.oC;for(const Za of this.d8f())tb=this.Ap.Qad(Pb,
Za,this.Bze(),this.onPointerDown),this.DM.push(tb);for(const Za of this.DM)w.a.instance.ta(m.a.XX,Za,this.aH.plf),w.a.instance.ta(m.a.TC,Za,this.aH.qlf);this.S1a(Ga)}dispose(){this.DM.forEach(Pb=>{w.a.instance.Aa(m.a.pointerDown,Pb,this.onPointerDown)});this.DM.length=0;super.dispose()}S1a(Pb){this.Vda=Pb;this.Kze(Pb);this.Ap.qRb(Pb,this.DM,this.N_d());this.aH.z2()}Vbf(Pb,tb){const gc=Pb.Fc;Pb=Pb.clientPoint;if(!gc||!Pb)return x.ULS.shipAssertTag(537159324,0,!!gc,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: source is null"),
x.ULS.shipAssertTag(537159323,0,!!Pb,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: point is null"),null;tb&&(Pb=this.mFf(Pb));tb=this.ga.hr(Pb,gc,0,!0,!1,!0);tb||(Pb=this.mFf(Pb),tb=this.ga.hr(Pb,gc,0,!0,!1,!0));return tb}mFf(Pb){Pb.y+=0===this.e6||1===this.e6?2:-2;Pb.x+=0===this.e6||2===this.e6?2:-2;return Pb}XPe(Pb){if(!Pb||!this.sourceRange)return x.ULS.shipAssertTag(537159322,0,!!Pb,"ResizeMarqueeBehaviorBase.CreateNewRange: newCorner is null"),x.ULS.shipAssertTag(537159321,0,!!this.sourceRange,
"ResizeMarqueeBehaviorBase.CreateNewRange: sourceRange is null"),null;if(0===this.e6)return new X.Range(Pb.top,Pb.left,this.sourceRange.bottom,this.sourceRange.right,!0,!1);if(1===this.e6)return new X.Range(Pb.top,this.sourceRange.left,this.sourceRange.bottom,Pb.right,!0,!1);if(2===this.e6)return new X.Range(this.sourceRange.top,Pb.left,Pb.bottom,this.sourceRange.right,!0,!1);if(3===this.e6)return new X.Range(this.sourceRange.top,this.sourceRange.left,Pb.bottom,Pb.right,!0,!1);x.ULS.shipAssertTag(537159320,
0,!1,`ResizeMarqueeBehaviorBase.CreateNewRange: currentFixedCorner is not valid: ${qa[this.e6]}`);return null}GY(){return this.DO?this.oC.oJb(this.lc,this.tH,this.rc):this.coloredReferencesManager.oJb(this.lc,this.tH,this.rc)}aU(){return this.GY()}qfc(Pb){Pb&&x.ULS.sendTraceTag(537159319,0,10,"ResizeMarqueeBehaviorBase.FinishOrAbortOperation: Aborting operation, will try to recalculate colored references as a fallback.");this.aH.PVe(this.DM[0]);this.Ap.p_f(!1,this.Vda.BV);this.lc.textBox.setCaretPositionToEnd();
this.lc.eAc(this.hif);this.qsg();this.GWa=this.gridView.iPa=!1;wa.b(this.$,!1);this.Ap.j1f()}}Object(b.a)(Xa,"ResizeMarqueeBehaviorBase",B,[]);class Ca extends Xa{constructor(Pb,tb,gc,Xb,Ga){super(Pb,tb,gc,Xb,Ga)}d8f(){return[xa.IOh,xa.JOh,xa.GOh,xa.HOh]}Bze(){return[xa.FOh]}U$e(Pb){Pb=Pb.Fc;if(Pb===this.DM[0])return 0;if(Pb===this.DM[1])return 1;if(Pb===this.DM[2])return 2;if(Pb===this.DM[3])return 3;x.ULS.shipAssertTag(537159318,0,!1,"ResizeMarqueeMouseBehavior.GetFixedCorner: source doesn't match any resize handle.");
return 4}P2f(){this.Ap.AP(this.$j,this.Wh,!0)}qsg(){this.Ap.x6d(this.$j,this.Wh,!0)}Wgg(Pb){return 2===(S.a.fc=Pb.kc)&&Pb.ap===Sys.UI.MouseButton.leftButton}N_d(){return!0}cBf(){x.ULS.sendTraceTag(537159317,0,50,"ResizeMarqueeMouseBehavior.LogStartOperation: Starting resize marquee operation with mouse.")}Kze(Pb){for(const tb of this.DM)tb.style.backgroundColor=Pb.kg.style.borderColor}}Object(b.a)(Ca,"ResizeMarqueeMouseBehavior",Xa,[]);class va extends Xa{constructor(Pb,tb,gc,Xb,Ga){super(Pb,tb,gc,
Xb,Ga);this.UKb=()=>{const Za=3===S.a.fc;this.tBd&&!Za?this.Ap.qRb(this.Vda,this.DM,!1):!this.tBd&&Za&&this.Ap.qRb(this.Vda,this.DM,!0);this.tBd=Za};this.Taj=(Za,Sb)=>{Sb.y9a===this.Vda.BV&&this.Ap.qRb(this.Vda,this.DM,!Sb.start&&this.N_d())};S.a.zye(this.UKb);this.tBd=3===S.a.fc;this.Ap.dYg(this.Taj)}dispose(){S.a.h5f(this.UKb);super.dispose()}d8f(){return[Ea.a.KNh,Ea.a.JNh]}Bze(){const Pb=!oa.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");return[Pb?Ea.a.C1e:Ea.a.B1e,Ea.a.nec,
Pb?Ea.a.INh:Ea.a.mec]}U$e(Pb){Pb=Pb.Fc;if(Pb===this.DM[0])return 0;if(Pb===this.DM[1])return 3;x.ULS.shipAssertTag(537159316,0,!1,"ResizeMarqueeTouchBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4}P2f(){u.a.Dz?this.Ap.AP(this.$j,this.Wh,!1):this.Ap.nuj(this.$j,this.Wh)}qsg(){u.a.Dz?this.Ap.x6d(this.$j,this.Wh,!1):this.Ap.nck(this.$j,this.Wh)}Wgg(Pb){return 3===(S.a.fc=Pb.kc)}N_d(){return 3===S.a.fc}cBf(){x.ULS.sendTraceTag(537159315,0,50,"ResizeMarqueeTouchBehavior.LogStartOperation: Starting resize marquee operation with touch.")}Kze(){}}
Object(b.a)(va,"ResizeMarqueeTouchBehavior",Xa,[]);class na extends B{constructor(Pb,tb){super(Pb);na.uwb(Pb,E.a.$Nh+" "+Ea.a.qxa,null===tb||void 0===tb?void 0:tb.horizontal);na.uwb(Pb,E.a.ZNh+" "+Ea.a.qxa,null===tb||void 0===tb?void 0:tb.vertical);na.uwb(Pb,E.a.WNh+" "+Ea.a.qxa,null===tb||void 0===tb?void 0:tb.horizontal);na.uwb(Pb,E.a.YNh+" "+Ea.a.qxa,null===tb||void 0===tb?void 0:tb.vertical);na.uwb(Pb,Ea.a.XNh)}static uwb(Pb,tb,gc){const Xb=document.createElement("div");Xb.className=tb;gc&&(Xb.style.backgroundImage=
`url("${gc}")`);Pb.appendChild(Xb)}}Object(b.a)(na,"SelectionCutCopyBehavior",B,[]);class Ka extends B{constructor(Pb){super(Pb);appChrome.renderSpinner(Pb)}}Object(b.a)(Ka,"SelectionPasteBehavior",B,[]);class ib extends B{constructor(Pb,tb){super(Pb);ib.Lwb(Pb,E.a.AOh+" "+Ea.a.qxa,null===tb||void 0===tb?void 0:tb.horizontal);ib.Lwb(Pb,E.a.zOh+" "+Ea.a.qxa,null===tb||void 0===tb?void 0:tb.vertical);ib.Lwb(Pb,E.a.wOh+" "+Ea.a.qxa,null===tb||void 0===tb?void 0:tb.horizontal);ib.Lwb(Pb,E.a.yOh+" "+Ea.a.qxa,
null===tb||void 0===tb?void 0:tb.vertical);ib.Lwb(Pb,Ea.a.xOh)}static Lwb(Pb,tb,gc){const Xb=document.createElement("div");Xb.className=tb;gc&&(Xb.style.backgroundImage=`url("${gc}")`);Pb.appendChild(Xb)}}Object(b.a)(ib,"SelectionRangePickerBehavior",B,[]);class Ra extends ia{constructor(Pb,tb,gc,Xb){super(Pb,tb,gc,Xb)}get r7(){return 0}get bhb(){return this.gridView.ga.pa.Sd}WVa(){const Pb=this.gridView.hj||this.gridView.Ob;return this.gridView.ga.pa.Vh&&!Pb&&super.WVa()}}Object(b.a)(Ra,"SelectionTouchGrippiesBehavior",
ia,[]);var ka=a(54);class da extends v.a{constructor(Pb,tb){super();this.y2a=(gc,Xb)=>{gc=Xb.r7;const Ga=this.gridView;Xb=Xb.kqi;const Za=Xb.kg,Sb=Xb.l_;u.a.Fh&&Sb.push(new Pa(Za,Ga));switch(gc){case 24:Xb.l_.push(new sa(Za,Xb));break;case 0:Xb.l_.push(new qb(Za,Ga));u.a.rq||(Sb.push(new nb(Za,this.gridView.$,Xb.paneType,this.tableManager,this.Ap)),oa.EwaSettings.isChangeGateEnabled("OfficeVSO:7824744_ManualDragDropInPivotTables")&&Sb.push(new Da(Za,this.gridView.$,Xb.paneType,this.tableManager,this.Ap)));
Sb.push(new Ra(Xb,Za,Ga,Xb.paneType));break;case 3:Sb.push(new la(Za));u.a.rq||(Sb.push(new Fa(Za,this.gridView.$,Xb.paneType,this.aH,this.Ap,Xb)),Sb.push(new Ca(Za,this.gridView,this.aH,this.Ap,Xb)),Sb.push(new va(Za,this.gridView,this.aH,this.Ap,Xb)));break;case 4:case 5:Sb.push(new na(Za,this.YAe));break;case 30:Sb.push(new Ka(Za));break;case 16:Sb.push(new ib(Za,this.YAe));Sb.push(new Ha(Xb,Za,Ga,Xb.paneType));break;case 11:case 12:Sb.push(new mb(Za,11===gc));break;case 17:Sb.push(new la(Za));
break;case 19:Sb.push(new la(Za)),Sb.push(new ya(Xb,Za,Ga,Xb.paneType))}Xb.O6b=!0};this.$=Pb;this.gridView=hb.h(Pb);this.tableManager=tb;this.aH=new Tb(this.gridView);this.Ap=new G(this.gridView);this.gridView.pc&&(this.gridView.pc.xXg(this.y2a),this.gridView.pc.update(!1));Pb.da.Ja(64,this)}get YAe(){oa.EwaSettings.isChangeGateEnabled("OfficeVSO:6809974_DancingAnts1Cdn")&&!this.XAe&&(this.XAe={vertical:ka.a.current.Uo(106),horizontal:ka.a.current.Uo(107)});return this.XAe}dispose(){this.gridView.pc.Gyj(this.y2a);
this.aH&&(this.aH.dispose(),this.aH=null);super.dispose()}}Object(b.a)(da,"GridHighlightsBehaviorManager",v.a,[]);var kb=a(35),Ob=a(149);class lc extends e.a{constructor(Pb){super();this.$=Pb;this.uc()}create(){const Pb=tb=>{this.$b(this.$.da.Ba(64)||new da(this.$,tb))};oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateTableManager",!1)?void Ob.a.resolve(kb.Db,{Wa:this.La}).then(Pb):k.TaskExtensions.za(l.GetServiceTaskFactory.create(this.$.da,134,this.ka,this.La),tb=>Pb(tb.result),
this.ka,3)}static la(Pb){Pb.da.Ja(149,new lc(Pb))}}Object(b.a)(lc,"GridHighlightsBehaviorManagerFactory",e.a,[]);a.d(C,"a",function(){return tc});const tc=()=>{c.a.Fa(lc.la);c.a.Fa(h.la)}},1212:function(r,C,a){r=a(0);var c=a(15),b=a(714),e=a(564),f=a(88),d=a(126),h;(function(Ja){Ja[Ja.applicationFeatureHelperHandler=0]="applicationFeatureHelperHandler";Ja[Ja.cloudPolicySettings=1]="cloudPolicySettings";Ja[Ja.alternateAuthToken=2]="alternateAuthToken"})(h||(h={}));Object(r.b)("ApplicationFeatureHelperRequestType",
h);class l{constructor(){this.message=null;this.gza=0}}Object(r.a)(l,"HttpRequstToPromiseRejectData",null,[]);var k=a(103),u=a(64),v=a(251),x=a(586);class w{constructor(Ja,Fa){this.Ra=Ja;this.Ah=Fa}Awb(Ja,Fa,Ba,fa=null,ta=null,Oa=null,Ma=null,fb=null){const pa=h[Ba],Ua=pa+"RequestFailure";k.Health.instance.recordKpiUsage(Ua,0,"jpittsdirects",null);return new Promise((Sa,Ia)=>{c.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",
pa);const X=null!=Ma?Ma:this.Ra.Ae("ApplicationFeatureHelperRequestQueueTimeout",15E3),ca=null!=fb?fb:this.Ra.Ae("ApplicationFeatureHelperRequestSentTimeout",3E4);this.Ah.tba(Ja,1,null,this.xnd(Ba,fa),Oa,!1,1,U=>{c.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",pa);try{if(void 0===U||null===U||void 0===U.data||null===U.data||void 0===U.data.Pe||null===U.data.Pe){k.Health.instance.recordKpiFailure(Ua,"Invalid RequestSucceededEventArgs",
!1,!0,null);let ra=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",pa);Ia(this.e7(ra,U))}else if(U.data.httpStatus!==v.a.xK){k.Health.instance.recordKpiFailure(Ua,"HttpStatusCode_"+U.data.httpStatus.toString(),!1,!0,null);let ra=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",
U.data.httpStatus,pa);Ia(this.e7(ra,U))}else{void 0!==ta&&null!==ta&&void 0!==U.data.responseHeaders&&null!==U.data.responseHeaders&&ta(U.data.responseHeaders);var ma=Fa(U.data.Pe);if(ma)c.ULS.sendTraceTag(50622690,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",pa),Sa(ma);else{k.Health.instance.recordKpiFailure(Ua,"Parse Failure",!1,!0,null);let ra=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",
pa);Ia(this.e7(ra,U))}}}catch(ra){k.Health.instance.recordKpiFailure(Ua,"Unexpected Failure",!1,!0,null),ma=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",ra,pa),Ia(this.e7(ma,U))}},U=>{if(U.data){k.Health.instance.recordKpiFailure(Ua,"HttpStatusCode_"+U.data.httpStatus.toString(),!1,!0,null);var ma=x.a.n8a(U.data.Pe||"No Data");ma=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",
U.data.httpStatus,ma,pa)}else k.Health.instance.recordKpiFailure(Ua,"Invalid RequestFailedEventArgs",!1,!0,null),ma=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",pa);Ia(this.e7(ma,U))},null,void 0,void 0,X,ca)})}e7(Ja,Fa){const Ba=new l;Ba.message=Ja;Ba.gza=Fa&&Fa.data?Fa.data.httpStatus:-1;return Ba}xnd(Ja,Fa){const Ba={};Ba["x-UserDataSignature"]=this.Ra.Va("UserDataSignature");Ba["x-LicensingIsEnabled"]=this.Ra.ra("LicensingIsEnabled").toString();
Ba["x-CacheIsEnabled"]=this.Ra.ra("LicensingRedisIsEnabled").toString();Ba["x-OcpsIsEnabled"]=this.Ra.ra("OcpsIsEnabled").toString();Ba["x-LicensingAADIdIsEnabled"]=this.Ra.ra("LicensingAadIdIsEnabled").toString();0===Ja&&(Ba["x-LicenseCheckOnTenantEnabled"]="true",Ba["x-SupportUserConsentDependentFeatures"]="true",Ba["x-AFHUserConsentGroupValue"]="0",Ba["x-UseShellServiceForUserConsentGroup"]="true",Ba["x-SMBUserLicensingEnabled"]="true",Ba["x-AFHPIPLComplianceEnabled"]=u.a.Uw(window.location.href,
"wd_afhpipl")||"false",Ba["x-ConsumerLicensingSNICertIsEnabled"]=this.Ra.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ConsumerLicensingSNICertIsEnabled",!1).toString());if(Fa)for(let fa of Fa.keys)Ba[fa]=Fa.ma(fa);return Ba}}Object(r.a)(w,"HttpRequestToPromiseUtility",null,[]);var m=a(6),t;(function(Ja){Ja[Ja.loki=0]="loki";Ja[Ja.augloopACLP=1]="augloopACLP"})(t||(t={}));Object(r.b)("AlternateAuthSupportApp",t);var z=a(428),y=a(43);class D{constructor(){this.Token=null;this.ExpirationTime=
0}}Object(r.a)(D,"WacAlternateAuthToken",null,[]);class H{constructor(Ja,Fa){this.k8j=3E5;if(void 0===Ja||null===Ja||void 0===Fa||null===Fa)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.Ra=Ja;this.CWb=new b.a(e.a.hh());this.Fnb=new w(Ja,Fa);void 0!==z.OAuthManagerSettings.VDd&&null!==z.OAuthManagerSettings.VDd&&void 0!==z.OAuthManagerSettings.Erc&&null!==z.OAuthManagerSettings.Erc&&0<z.OAuthManagerSettings.Erc&&(Ja=new D,Ja.Token=z.OAuthManagerSettings.VDd,Ja.ExpirationTime=
z.OAuthManagerSettings.Erc,this.CWb.ia("loki",Ja))}S_h(){let Ja=null;this.CWb.Pb(t[0])&&(Ja=this.CWb.ma(t[0]));return void 0===Ja||null===Ja||this.cAd(Ja)?this.DRh():Promise.resolve(Ja.Token)}cAd(Ja){return Ja.ExpirationTime-Date.now()<this.k8j}DRh(){const Ja=new b.a(e.a.hh());Ja.ia("X-AlternateAuthApp",t[0]);return this.Fnb.Awb(this.fya("/afhs/AlternateAuthHelperHandler.ashx"),Object(f.a)(this,this.Xgj,"parseAlternateAuthTokenResponse"),2,Ja).then(Fa=>{c.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",
t[0]);this.CWb.ia(t[0],Fa);return Fa.Token},Fa=>{Fa=Object(d.a)(l,Fa);c.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",Fa.message,Fa.gza);return null})}Xgj(Ja){let Fa=null;({Bt:Fa}=y.d(Ja));c.ULS.sendTraceTag(545821457,3004,Fa?50:10,"ParseAlternateAuthTokenResponse: fetched WacAlternateAuthToken from {0}",Ja);return Fa}fya(Ja){const Fa=this.Ra.ra("SuiteOriginForAFHSIsEnabled")?this.Ra.Va("SuiteOrigin"):this.Ra.Va("WebServiceBase");
return String.format("{0}{1}?{2}",Fa,Ja,m.AFrameworkApplication.oj)}}Object(r.a)(H,"AlternateAuthHelper",null,[260]);var F=a(464);class G{constructor(Ja,Fa,Ba){this.featureName=null;this.isEnabled=!1;this.tierName=0;this.featureName=Ja;this.isEnabled=Fa;this.tierName=Ba}}Object(r.a)(G,"FeatureStateChangeArgs",null,[]);var L=a(148),M=a(265),O=a(31),B=a(115),E=a(173),I;(function(Ja){Ja[Ja.Enabled=0]="Enabled";Ja[Ja.Disabled=1]="Disabled"})(I||(I={}));Object(r.b)("FeatureState",I);var S=a(84),J=a(27),
K=a(184);class R{constructor(Ja,Fa,Ba=null,fa=null,ta=null){this.vxa=this.d1b=this.Epe=this.yta=this.f2b=null;this.Fnb=new w(Ja,Fa);this.Ra=Ja;this.xKg=Ja.Ae("LicensingMaxRetryAttempts",0);this.LZb=Ja.ra("IsO365ConsumerHost");this.yTc=Ja.ra("IsO365CommercialHost");this.jTc=Ja.ra("PremiumUpsellIsEnabled");this.$Za=!1;this.GUc=0;this.Kce=Ba;this.Vte=fa;this.Na=ta;this.xta=Ja.ra("LicensingIsEnabled");this.JHa=Ja.ra("OcpsIsEnabled")&&this.yTc;this.c0c=Ja.ra("ShowPrivacyDialog")&&!!fa;this.LSc=Ja.ra("IsAnonymousUser");
this.Mec=new Promise(Oa=>{Oa(!1)});this.KEa=new Promise(Oa=>{Oa(!0)});this.uxa=new b.a(e.a.hh());this.V2b=!0;this.Qke=this.x9h();this.byd()&&!this.LSc?(void 0!==m.AFrameworkApplication.sa&&null!==m.AFrameworkApplication.sa&&(this.f2b=m.AFrameworkApplication.sa.qF,void 0!==this.f2b&&null!==this.f2b&&(this.yta=this.f2b.vh("WebServiceCall","ApplicationFeatureHelperService"))),this.vxa=this.U5d()):this.vxa=new Promise(Oa=>{Oa({})});this.vxa.catch(Oa=>{Oa=Object(d.a)(l,Oa);c.ULS.sendTraceTag(42513088,
3004,10,"ApplicationFeatureHelper initialization failed, HttpStatus={0}",Oa?Oa.gza.toString():"Unknown")});this.V2b&&this.isFeatureEnabled("FreemiumUpsell",!0).then(Oa=>{this.$Za=Oa;return null})}x9h(){const Ja=this.Ra.Lq("AllLicensedFeatures")?this.Ra.Tw("AllLicensedFeatures"):[],Fa=new F.a;for(let Ba=0;Ba<Ja.length;Ba++)Fa.add(Ja[Ba]);return Fa}byd(){return this.yTc||this.LZb}U5d(Ja=0,Fa=!1){c.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",
Fa);const Ba=L.a.zt();Ba&&(Ba.set("retryAttempt",Ja.toString()),Ba.set("forceRefresh",Fa.toString()),Ba.set("isO365ConsumerHost",this.LZb.toString()),Ba.set("isO365CommercialHost",this.yTc.toString()),Ba.set("isFreemiumUpsellSettingEnabled",this.jTc.toString()));k.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest","waclicensing",Ba);k.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",Ba);void 0!==this.yta&&null!==this.yta&&this.yta.start();let fa=
null;Fa&&(fa=new b.a(e.a.hh()),fa.ia("x-LicensingForceRefresh","true"));this.Epe=new Date;return(this.xta?this.Fnb.Awb(this.fya("/afhs/ApplicationFeatureHelperHandler.ashx"),Object(f.a)(this,this.$gj,"parseApplicationFeatureHelperResponse"),0,fa,Object(f.a)(this,this.Imj,"processApplicationFeatureHelperResponseHeaders"),["Date"]):Promise.resolve({})).then(ta=>{const Oa=Object.assign(new K.a,{durationMs:this.Jlg()});Oa.extendedProperties=Ba;Oa.extendedProperties&&ta&&(Oa.extendedProperties.set("featureCount",
B.a.count(ta).toString()),Oa.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in ta).toString()),Oa.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in ta).toString()),"FreemiumUpsell"in ta&&Oa.extendedProperties.set("isFreemiumUpsellEnabled",ta.FreemiumUpsell.toString()),this.d1b&&Oa.extendedProperties.set("fromCache",(this.d1b<this.Epe).toString()));k.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",Oa);return ta},ta=>{const Oa=Object.assign(new K.a,
{durationMs:this.Jlg()}),Ma=Object(d.a)(l,ta);if(!Ma)return c.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),k.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",!1,!0,Oa),new Promise((fb,pa)=>{pa(ta)});Oa.extendedProperties=Ba;Oa.extendedProperties&&Oa.extendedProperties.set("status",Ma.gza.toString());k.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest",
"RequestFailed",!1,!0,Oa);return 408===Ma.gza&&++Ja<=this.xKg?this.U5d(Ja):new Promise((fb,pa)=>{pa(Ma)})})}$gj(Ja){(Ja=y.b(Ja))?(c.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),c.ULS.sendTraceTag(50938594,3004,50,"{0}",Ja)):c.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");return Ja.Features}fya(Ja){var Fa=this.Ra.ra("SuiteOriginForAFHSIsEnabled")?this.Ra.Va("SuiteOrigin"):
this.Ra.Va("WebServiceBase");Fa=String.format("{0}{1}",Fa,Ja);this.Ra.Lq("ApplicationFeatureHelperHttpCachingEnabled")&&this.Ra.ra("ApplicationFeatureHelperHttpCachingEnabled")&&(Ja=R.Xhc(this.Ra))&&0<Ja.length&&(this.V2b&&(Ja+="ucbf"),Fa=new M.QueryStringBuilder(Fa),Fa.Tj("afhskey",Ja),Fa=Fa.toString());return Fa}isFeatureEnabled(Ja,Fa){if(!this.JHa&&!this.c0c&&!this.xta)return this.KEa;c.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",
Ja);if("ConnectedServices"===Ja){var Ba=this.JHa?this.Kce.jO("ControllerConnectedServicesEnabled"):this.KEa;const Oa=this.c0c?this.Vte.getSettings().then(Ma=>2!==Ma.Dv,()=>Fa):this.KEa;return Ba.then(Ma=>Ma?Oa:this.Mec)}if("FreemiumUpsell"===Ja&&(!this.jTc||!this.LZb||this.LSc))return this.Mec;Ba=null;Ba=this.JHa?this.Kce.isFeatureEnabled(Ja):this.KEa;let fa=null;fa=this.xta?this.cCi(Ja,Fa):this.KEa;let ta=null;ta=this.c0c?this.Vte.isFeatureEnabled(Ja):this.KEa;return Ba.then(Oa=>Oa?ta.then(Ma=>Ma?
fa:this.Mec):this.Mec).then(Oa=>{this.pAf(Ja,Oa,!0);return Oa},()=>{this.pAf(Ja,Fa,!1);return Fa})}pAf(Ja,Fa,Ba){c.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",Ja,Fa,Ba)}getFeatureTier(Ja,Fa){if(!this.xta)return new Promise(Ba=>{Ba(2)});c.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",Ja);return this.vxa.then(Ba=>this.Uic(Ja,Ba,Fa),()=>Fa)}isFreemiumUpsellEnabled(){if(this.jTc&&this.LZb&&!this.LSc){if(this.$Za&&
2!==this.GUc||!this.$Za&&1!==this.GUc)c.ULS.sendTraceTag(509728161,3004,20,"ApplicationFeatureHelper_IsFreemiumUpsellEnabled: isFreemiumUpsellFeatureEnabled={0}",this.$Za.toString()),this.GUc=this.$Za?2:1;return this.$Za}return!1}launchUpsellExperience(Ja,Fa=null){c.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",Ja));var Ba=L.a.zt();Ba&&(Ba.set("experienceId",Ja),Fa&&Ba.set("campaignId",Fa));k.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",
1,"waclicensing",Ba);if(Ba=S.a.instance.nh("Common.IInProductMessagingUIManager")){const fa=Object(f.a)(this,this.Tki,"handleDimeTaskComplete");Ba.oyf(Ja,fa,Fa)}else c.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),k.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),this.Na.Le(J.a.cgc,2,{["experience"]:Ja})}aUa(Ja,Fa){if(!this.xta)return null;if(!Ja||!Fa)return c.ULS.sendTraceTag(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),
null;const Ba=E.a.create().toString();this.uxa.Pb(Ja)||this.uxa.ia(Ja,new b.a(e.a.hh()));this.uxa.ma(Ja).add(Ba,Fa);c.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",Ba,Ja));return Ba}JRd(Ja,Fa){this.xta&&(Ja&&this.uxa.Pb(Ja)?Fa&&E.a.isValid(Fa)?this.uxa.ma(Ja).Pb(Fa)?(c.ULS.sendTraceTag(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",
Fa,Ja)),this.uxa.ma(Ja).remove(Fa)):c.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",Fa,Ja)):c.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",Fa,Ja)):c.ULS.sendTraceTag(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",
Ja)))}Uic(Ja,Fa,Ba){return this.V2b?Ja in Fa?Fa[Ja].LicenseTier:Ba:Ja in Fa?this.xhj(Fa[Ja],Ba):Ba}xhj(Ja,Fa){switch(Ja.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return Fa}}Tki(){c.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");this.vxa.then(Ja=>{this.c2f(Ja)}).catch(()=>{this.c2f({})})}c2f(Ja){c.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");const Fa=
this.U5d(0,!0);Fa.then(Ba=>{this.vxa=Fa;B.a.count(Ba)>B.a.count(Ja)?k.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):k.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",!1,!0,null);for(let fa of this.uxa.keys)if(fa in Ba){const ta=this.Uic(fa,Ba,0);fa in Ja?this.Uic(fa,Ja,0)!==ta&&this.MHd(fa,!0,ta):this.MHd(fa,!0,ta)}else fa in Ja&&this.MHd(fa,!1,this.Uic(fa,Ja,0))}).catch(Ba=>{k.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",
!1,!0,null);c.ULS.sendTraceTag(594051086,3004,10,JSON.stringify(Ba))})}MHd(Ja,Fa,Ba){c.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",Ja,Fa,Ba);Fa=new G(Ja,Fa,Ba);Ba=this.uxa.ma(Ja);for(let fa of Ba)try{fa.value(Fa)}catch(ta){c.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",
Ja,fa.key,ta.message))}}He(Ja,Fa){if(this.xta){const Ba=this.Qke.contains(Ja);let fa=!0,ta="",Oa=!1;return this.vxa.then(Ma=>{Ja in Ma?(Ma=Ma[Ja],ta=I[Ma.FeatureState],fa=1!==Ma.FeatureState):fa=!Ba;this.zAf(Ja,Ba,ta,Oa,Fa,fa);return fa},()=>{Oa=!0;Ba&&(fa=Fa);this.zAf(Ja,Ba,ta,Oa,Fa,fa);return fa})}return this.KEa}zAf(Ja,Fa,Ba,fa,ta,Oa){c.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",
Ja,Fa,fa,Ba,ta,Oa)}cCi(Ja,Fa){if(this.V2b)return this.He(Ja,Fa);if(this.xta){if(this.Qke.contains(Ja))return this.vxa.then(Ba=>Ja in Ba,()=>Fa);c.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",Ja)}return this.KEa}Imj(Ja){try{Ja&&"Date"in Ja&&(this.d1b=new Date(Ja.Date),c.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.d1b.toString()))}catch(Fa){c.ULS.sendTraceTag(578863818,
3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",Fa)}}Jlg(){if(void 0!==this.yta&&null!==this.yta){const Ja=this.yta.vd;this.yta.stop();return Ja}return null}static Xhc(Ja){try{if(O.a.p4j){const Fa=Ja.Va("UserDataSignature").split(".");if(1<Fa.length){const Ba=window.self.atob(Fa[1]),fa=JSON.parse(Ba).LocalStorageKey;if(void 0!==fa&&null!==fa&&0<fa.length)return fa}}}catch(Fa){c.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",Fa.toString())}return null}}
Object(r.a)(R,"ApplicationFeatureHelper",null,[261]);var Z=a(198);class P{constructor(Ja,Fa){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=Ja.PolicySettings;Ja=new Date;Ja.setMinutes(Ja.getMinutes()+Fa);this.ExpirationTime=Ja.getTime()}}Object(r.a)(P,"CloudPolicySettingsCacheData",null,[]);var V=a(823),Ea=a(468),oa=a(268);class ea{static Ojg(){return m.AFrameworkApplication.fa.ra("SideCarIsEnabled")?ea.uCc&&ea.Bwd?new Promise(Ja=>{Ja(!0)}):new Promise((Ja,Fa)=>{ea.uCc=oa.a.create(m.AFrameworkApplication.fa.Va("SideCarUrl"));
Ea.a.gxa(ea.uCc);ea.uCc.zja((Ba,fa)=>{(ea.Bwd=fa.succeeded)?Ja(fa.succeeded):Fa(fa.succeeded)})}):new Promise(Ja=>{Ja(!1)})}}ea.Bwd=!1;ea.uCc=null;Object(r.a)(ea,"SideCarLoader",null,[]);class aa{constructor(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=null}}Object(r.a)(aa,"CloudPolicySettingsData",null,[]);class ia{constructor(Ja,Fa){this.oOc=0;this.p9b=null;this.Fnb=new w(Ja,Fa);this.Ra=Ja;Fa=Ja.Va("HostAuthType");this.JHa=Ja.ra("OcpsIsEnabled")&&Ja.ra("IsO365CommercialHost")&&
!(void 0===Fa||null===Fa)&&"aad"===Fa.toLowerCase();this.$me=y.b(Ja.Va("OcpsDefaultSettings")||"{}");this.Bob=this.Xhc();Fa=this.Ra.Lq("ServicesControlsMicrosoftControllerServicesList")?this.Ra.Tw("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.DXb=new F.a;for(let Ba=0;Ba<Fa.length;Ba++)this.DXb.add(Fa[Ba]);this.JHa&&!Ja.ra("IsAnonymousUser")&&Ja.ra("SideCarIsEnabled")?this.p9b=this.vak():this.p9b=this.Dra(this.JHa,this.fya("/afhs/CloudPolicySettings.ashx"),Object(f.a)(this,this.ahj,
"parseCloudPolicySettingsResponse"));this.p9b.then(()=>null).catch(Ba=>{Ba=Object(d.a)(l,Ba);c.ULS.sendTraceTag(50622685,3004,10,"CloudPolicySettingsHelper initialization failed, HttpStatus={0}",Ba?Ba.gza.toString():"Unknown")})}jO(Ja,Fa=!0){if(!this.JHa){const Oa=this;return new Promise(Ma=>{Ma(Oa.ABb(Ja))})}let Ba=this,fa=this;const ta=this.p9b.then(Oa=>{try{let Ma=null;Oa.PolicySettings&&"unknown"in Oa.PolicySettings&&(Ma=Oa.PolicySettings.unknown);if(Ma){if(Ja in Ma&&void 0!==Ma[Ja]&&null!==Ma[Ja])return new Promise(pa=>
{pa("0"!==Ma[Ja])});const fb=Ja.toLowerCase();if(fb in Ma&&void 0!==Ma[fb]&&null!==Ma[fb])return new Promise(pa=>{pa("0"!==Ma[fb])});c.ULS.sendTraceTag(51512667,3004,50,"Policy"+Ja+" not found, using default");return new Promise(pa=>{pa(Ba.ABb(Ja))})}return new Promise(fb=>{fb(Ba.ABb(Ja))})}catch(Ma){return c.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+Ja+" policy value. Error Message: {0}",Ma.message),Ba.handleError(Ma.toString(),Fa,Ba.ABb(Ja))}},Oa=>fa.handleError(Oa,Fa,fa.ABb(Ja)));ta.then(Oa=>
{c.ULS.sendTraceTag(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",Ja,Oa);return null});return ta}isFeatureEnabled(Ja,Fa=!0){if(this.Ra.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))return this.eCi(Ja,Fa);let Ba=new Promise(ta=>{ta(!0)}),fa="";this.DXb.contains(Ja)&&(fa="ControllerConnectedServicesEnabled",Ba=this.jO(fa,Fa));Ba.then(ta=>{c.ULS.sendTraceTag(50651668,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",
Ja,ta,fa);return null});return Ba}eCi(Ja,Fa=!0){let Ba=new Promise(ta=>{ta(!0)}),fa="";"mso_sendASmile"===Ja?fa="Enabled":"Survey"===Ja||"FloodgateSurvey"===Ja?fa="SurveyEnabled":this.DXb.contains(Ja)&&(fa="ControllerConnectedServicesEnabled");""!==fa&&(Ba=this.jO(fa,Fa));Ba.then(ta=>{c.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",Ja,ta,fa);return null});return Ba}handleError(Ja,Fa,Ba){return Fa?new Promise(fa=>
{fa(Ba)}):new Promise((fa,ta)=>{ta(Ja)})}Dra(Ja,Fa,Ba){if(!Ja)return Promise.resolve(new aa);let fa=!1,ta=null;k.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);let Oa=this.Fad("GetCloudPolicySettings");return(new Promise((Ma,fb)=>{if(void 0!==this.Bob&&null!==this.Bob&&0<this.Bob.length){const pa=this.gak();if(void 0!==pa&&null!==pa){fa=!0;Ma(pa);return}}this.Fnb.Awb(Fa,Ba,1,null,Object(f.a)(this,this.Nmj,"processCloudPolicySettingsResponseHeaders"),["CheckIn-Interval"],
this.Ra.Ae("CloudPolicySettingsRequestQueueTimeout",15E3),this.Ra.Ae("CloudPolicySettingsRequestSentTimeout",3E4)).then(pa=>{c.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");this.Uak(pa);Ma(pa);return pa},pa=>{fb(pa);return null})})).then(Ma=>{({stopwatch:Oa,returnValue:ta}=this.wGc(Oa));var fb=L.a.zt();fb&&fb.set("FromCache",fa.toString());fb=Object.assign(new K.a,{durationMs:ta,extendedProperties:fb});k.Health.instance.recordKpiSuccess("GetCloudPolicySettings",
fb);return Ma})}vak(){return ea.Ojg().then(()=>{c.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");return sidecar.cloudPolicy.GetCloudPolicySettingsData()})}fya(Ja){const Fa=this.Ra.ra("SuiteOriginForAFHSIsEnabled")?this.Ra.Va("SuiteOrigin"):this.Ra.Va("WebServiceBase");return String.format("{0}{1}",Fa,Ja)}ahj(Ja){let Fa=null;({Bt:Fa}=y.d(Ja));Ja=!!Fa;c.ULS.sendTraceTag(50622687,3004,Ja?50:10,"ParseCloudPolicySettingsResponse: Success={0}",
Ja);return Fa}Nmj(Ja){try{if(void 0!==Ja&&null!==Ja&&"CheckIn-Interval"in Ja){const Fa=parseInt(Ja["CheckIn-Interval"]);void 0!==Fa&&null!==Fa&&0<Fa&&(this.oOc=Fa)}}catch(Fa){c.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",Fa)}}ABb(Ja){return Ja in this.$me?"0"!==this.$me[Ja]:!0}gak(){try{const Ja=V.a.instance.getItem(this.Bob);if(void 0===Ja||null===Ja)return c.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),
null;c.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",Ja);const Fa=JSON.parse(Ja);if(void 0===Fa||null===Fa)return c.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(void 0===Fa.ExpirationTime||null===Fa.ExpirationTime)return c.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),
null;if((new Date(Fa.ExpirationTime)).getTime()<Date.now())return c.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;const Ba=new aa;Ba.PolicySettings=Fa.PolicySettings;Ba.ControllerConnectedServicesFeatureNames=new Z.a;this.Ra.Lq("ServicesControlsMicrosoftControllerServicesList")&&this.Ra.Tw("ServicesControlsMicrosoftControllerServicesList");for(let fa of this.DXb)Ba.ControllerConnectedServicesFeatureNames.add(fa);c.ULS.sendTraceTag(51662941,3004,
50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");return Ba}catch(Ja){return c.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",Ja.toString()),null}}Uak(Ja){try{if(void 0===Ja||null===Ja||void 0===Ja.PolicySettings||null===Ja.PolicySettings)c.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.oOc)c.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");
else{const Fa=new P(Ja,this.oOc),Ba=JSON.stringify(Fa);c.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",Ba);V.a.instance.setItem(this.Bob,Ba);c.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(Fa){c.ULS.sendTraceTag(51662976,3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",Fa.toString())}}Xhc(){const Ja=R.Xhc(this.Ra);return Ja&&0<Ja.length?"OCPS"+Ja:null}Fad(Ja){const Fa=S.a.instance.nh("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");
return void 0!==Fa&&null!==Fa?Fa.Fd("WebServiceCall",Ja):null}wGc(Ja){if(void 0!==Ja&&null!==Ja){const Fa=Ja.vd;Ja.stop();return{returnValue:Fa,stopwatch:null}}return{returnValue:null,stopwatch:Ja}}}Object(r.a)(ia,"CloudPolicySettingsHelper",null,[258]);class ya{constructor(){this.yVe=this.Gvg=this.Dv=0;this.zVe=this.Hvg=this.kLa="";this.JZc=this.xha=2}clone(){const Ja=new ya;Ja.Dv=this.Dv;Ja.Gvg=this.Gvg;Ja.yVe=this.yVe;Ja.kLa=this.kLa;Ja.Hvg=this.Hvg;Ja.zVe=this.zVe;Ja.xha=this.xha;Ja.JZc=this.src;
return Ja}get src(){return this.JZc}serialize(Ja=null){const Fa={};if(!Ja||Ja.contains(ya.fSa))Fa[ya.fSa]=this.Dv;if(!Ja||Ja.contains(ya.hKb))Fa[ya.hKb]=this.kLa;if(!Ja||Ja.contains(ya.iKb))Fa[ya.iKb]=this.xha;return JSON.stringify(Fa)}static create(Ja,Fa=null){const Ba=new ya;Ba.JZc=Ja;void 0!==Fa&&null!==Fa&&(ya.fSa in Fa&&(Ba.Dv=Fa[ya.fSa]),ya.hKb in Fa&&(Ba.kLa=Fa[ya.hKb]),ya.iKb in Fa&&(Ba.xha=Fa[ya.iKb]));return Ba}static deserialize(Ja,Fa){try{const Ba=JSON.parse(Ja);if(void 0!==Ba&&null!==
Ba)return ya.create(Fa,Ba);c.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",Ja);throw Error.argument("settingsData");}catch(Ba){throw c.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",Ba.toString()),Ba;}}}ya.fSa="CCS";ya.hKb="CCSTime";ya.iKb="OfficePrivacyRoamedNoticeShown";Object(r.a)(ya,"UserPrivacySettings",null,[]);var za=a(145);class la{constructor(Ja,Fa){if(void 0===Ja||null===Ja||void 0===Fa||null===Fa)throw Error.argumentNull("appSettingsManager/clientRequestManager");
this.Ra=Ja;this.Ah=Fa;this.aZc=this.af=null}fya(Ja){var Fa=String.format("{0}RoamingServiceHandler.ashx?action=",this.Ra.appSettings.RoamingServiceHandlerWebServiceBase||"");Fa=new Sys.StringBuilder(Fa);Fa.append(Ja);Fa.append("&");Fa.append(m.AFrameworkApplication.oj);return Fa.toString()}executeRequest(Ja,Fa,Ba,fa=null){return this.Ah.$rb(Ja,Fa,fa,null,Ba,"33",!1,null,6E4)}saveSettings(Ja){return new Promise((Fa,Ba)=>{try{if(void 0===this.af||null===this.af||void 0===Ja||null===Ja)c.ULS.sendTraceTag(51258443,
3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),Ba("Can't determine setting changes to save");else{var fa=this.af.Dv!==Ja.Dv;if(2===this.af.src&&fa)this.fHj(Ja),Fa(!0);else{var ta=this.gLj(Ja);if(void 0===ta||null===ta||!ta.length)c.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),Ba("No changes to save");else if(1===this.af.src)Fa(this.irg(ta));else if(0===this.af.src){c.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",
ta);const Oa=this.executeRequest(this.fya("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",ta);Oa.continueWith(()=>{if(Oa.ji||Oa.Jg)c.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),Fa(!1);else{var Ma=Oa.result;void 0!==Ma.Zh&&null!==Ma.Zh&&void 0!==Ma.Zh.data&&null!==Ma.Zh.data&&Ma.Zh.data.httpStatus===v.a.xK?(c.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),Fa(!0)):(c.ULS.sendTraceTag(51258446,3004,
10,"SaveUserPrivacySettings: Roaming Request Failed"),Fa(!1))}})}}}}catch(Oa){c.ULS.sendTraceTag(50860930,3004,10,"SaveUserPrivacySettings: Exception = {0}",Oa.toString()),Fa(!1)}})}gLj(Ja){if(void 0===this.af||null===this.af||void 0===Ja||null===Ja)throw Error.invalidOperation("User Privacy settings have not been initialized");const Fa=new Z.a;0===Ja.src?(this.af.Dv!==Ja.Dv&&(Fa.add(ya.fSa),Fa.add(ya.hKb)),this.af.xha!==Ja.xha&&Fa.add(ya.iKb)):1===Ja.src&&this.af.Dv!==Ja.Dv&&Fa.add(ya.fSa);return Fa.count?
Ja.serialize(Fa):(c.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),null)}getSettings(){if(!this.aZc){const Ja=this;this.aZc=new Promise(Fa=>{try{Ja.af?Fa(Ja.af.clone()):Ja.oak().then(Ba=>{Ja.af=Ba;Fa(Ja.af.clone());return null},()=>{Ja.mak().then(Ba=>{Ja.af=Ba;Fa(Ja.af.clone());return null},()=>{Ja.nak().then(Ba=>{Ja.af=Ba;Fa(Ja.af.clone());return null},()=>{c.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");
Ja.af=new ya;Fa(Ja.af.clone());return null});return null});return null})}catch(Ba){c.ULS.sendTraceTag(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",Ba.toString()),Ja.af=new ya,Fa(Ja.af.clone())}})}return this.aZc}oak(){return new Promise((Ja,Fa)=>{try{const fa=-1!==window.location.href.indexOf("&wd_pn=2");if(this.Ra.ra("PrivacyDialogShouldCheckRoaming")||fa){var Ba=this.executeRequest(this.fya("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");Ba.continueWith(()=>{try{if(Ba.ji||
Ba.Jg)c.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{const ta=Ba.result;if(ta&&ta.Zh&&ta.Zh.data)if(ta.Zh.data.httpStatus!==v.a.xK)c.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",ta.Zh.data.httpStatus);else{if(ta.Zh.data.Pe){Ja(la.parse(ta.Zh.data.Pe,0));c.ULS.sendTraceTag(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",ta.Zh.data.Pe);
return}c.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else c.ULS.sendTraceTag(50860935,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");Fa("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(ta){c.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",ta.toString()),Fa("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else c.ULS.sendTraceTag(50860933,
3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),Fa("Roaming should not be used")}catch(fa){c.ULS.sendTraceTag(50860939,3004,10,"TryGetSettingsFromRoaming Exception = {0}",fa.toString()),Fa("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})}mak(){return new Promise((Ja,Fa)=>{try{const Ba=za.a.get("WacUPToggleState");let fa=null;void 0!==Ba&&null!==Ba&&0<Ba.length&&(fa=decodeURIComponent(Ba));if(void 0!==fa&&null!==fa&&0<fa.length){const ta=la.parse(fa,
1);c.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",ta.toString());Ja(ta)}else{const ta=ya.create(1),Oa=new Z.a;Oa.add(ya.fSa);const Ma=ta.serialize(Oa);this.irg(Ma)?(c.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",Ma),Ja(ta)):(c.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",Ma),Fa("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(Ba){c.ULS.sendTraceTag(50860941,
3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",Ba.toString()),Fa("UserPrivacySettings TryGetSettingsFromCookie Eception")}})}nak(){return new Promise(Ja=>{try{var Fa=-1!==window.location.href.indexOf("&wdccsoff=1");let Ba=ya.create(2);Fa?(Ba.Dv=2,m.AFrameworkApplication.cUe(),c.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",Ba.toString())):(Ba.Dv=1,c.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",
Ba.toString()));Ja(Ba)}catch(Ba){c.ULS.sendTraceTag(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",Ba.toString()),Fa=ya.create(2),Fa.Dv=1,Ja(Fa)}})}fHj(Ja){c.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===Ja.Dv?m.AFrameworkApplication.cUe():m.AFrameworkApplication.gDh();c.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",Ja)}irg(Ja){try{c.ULS.sendTraceTag(51258455,3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",
Ja);const Fa=this.Ra.Va("PrivacyCookieDomain")||"";if(!Fa||!Fa.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");c.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",Ja);return za.a.eZd("WacUPToggleState",Ja,za.a.D1,"/",Fa)}catch(Fa){return c.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",Fa.toString()),!1}}isFeatureEnabled(Ja){return this.getSettings().then(Fa=>{const Ba=this.Ra.Lq("ServicesControlsMicrosoftControllerServicesList")?
this.Ra.Tw("ServicesControlsMicrosoftControllerServicesList"):[],fa=new F.a;for(let ta=0;ta<Ba.length;ta++)fa.add(Ba[ta]);return fa.contains(Ja)?2!==Fa.Dv:!0},()=>{c.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",Ja);return!0})}static parse(Ja,Fa){try{return c.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",Ja,Fa),ya.deserialize(Ja,Fa)}catch(Ba){throw c.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",Ba.toString()),
Ba;}}}Object(r.a)(la,"UserPrivacySettingsHelper",null,[259]);var xa=a(261);class wa{constructor(){this.Nb=null}get name(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}Oi(Ja){this.Nb=Ja;this.Nb.register(258,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").gd().od(()=>new ia(m.AFrameworkApplication.fa,m.AFrameworkApplication.qe));this.Nb.register(259,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").gd().od(()=>new la(m.AFrameworkApplication.fa,
m.AFrameworkApplication.qe));this.Nb.register(260,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").gd().od(()=>new H(m.AFrameworkApplication.fa,m.AFrameworkApplication.qe));this.Nb.register(261,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").gd().od(()=>new R(m.AFrameworkApplication.fa,m.AFrameworkApplication.qe,this.Nb.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),this.Nb.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),
m.AFrameworkApplication.dc))}init(){m.AFrameworkApplication.fa.Rv(()=>{const Ja=this.Nb.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");m.AFrameworkApplication.fa.ra("LicensingIsEnabled")&&(Ja.isFeatureEnabled("LicensingTestFeature",!1).then(Fa=>{c.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",Fa,m.AFrameworkApplication.fa.Va("IsAnonymousUser"));return null}),Ja.getFeatureTier("LicensingTestFeature",
0).then(Fa=>{c.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",Fa,m.AFrameworkApplication.fa.Va("IsAnonymousUser"));return null}));this.Nb.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");this.O5j()})}dispose(){}O5j(){try{m.AFrameworkApplication.fa.ra("SideCarIsEnabled")&&ea.Ojg().then(Ja=>{c.ULS.sendTraceTag(594057429,3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",
Ja);return Ja})}catch(Ja){}}static main(){xa.a.instance.wj(new wa)}}Object(r.a)(wa,"ApplicationFeatureHelperPackage",null,[4,5]);a.d(C,"a",function(){return hb});const hb=()=>{Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");wa.main()}},1213:function(r,C,a){r={};a.r(r);a.d(r,"EmbeddedWorkbookReadoutHandler",function(){return Sa});var c={};a.r(c);a.d(c,"WorkbookReadoutHandler",function(){return Ia});var b=a(10),e=a(1),f=a(0),d=a(230),h=a(15),l=a(36),k=
a(7),u=a(13),v=a(23),x=a(16),w=a(269),m=a(19),t=a(32);class z{constructor(U){this.YBc=U||""}static get gXe(){return z.gfe||(z.gfe=new z(""))}static get WDd(){return z.ule||(z.ule=z.yW(2).YBc)}static oNa(U){U=t.a.xi(U||"");return new z(U)}static bma(U){return z.oNa(x.a.instance.ha(U))}static yW(U){return new z(x.a.instance.Ha(U))}static ykd(U,...ma){return z.VWh(x.a.instance.Xb(U),...ma)}static VWh(U,...ma){const ra=ma.length,Va=Array(ra);for(let ob=0;ob<ra;ob++)Va[ob]=(ma[ob]||z.gXe).YBc;return new z(String.format(U,
Va))}}z.gfe=null;z.ule=null;Object(f.a)(z,"SafeHtml",null,[315]);const y=(U,ma)=>{ma&&(U.append(ma),U.append(z.WDd))};var D=a(175),H=a(114),F=a(2),G=a(355),L=a(178),M=a(109),O=a(772),B=a(31),E=a(222);class I{constructor(U,ma){this.p2=this.nT=this.wM=null;this.Vla=ma;this.irh(U);this.tlj();e.EwaSettings.jc()&&U.da.Ja(244,this)}get isActive(){return!!this.Vla&&document.activeElement===this.Vla}readText(U){U=e.EwaSettings.isChangeGateEnabled("OfficeVSO:7663175_RemoveGridBeingReadoutInFocusBasedReadout")?
U:String.format(x.a.instance.Xb(30),U);this.wM.setAttribute(k.a.xv,U);this.nT.setAttribute(k.a.xv,U);this.F4j()}dispose(){this.p2&&this.p2.parentNode&&this.p2.parentNode.removeChild(this.p2);this.nT=this.wM=this.p2=this.Vla=null}irh(U){var ma=U.qc+"readoutElementWrapper";const ra=U.qc+"readoutElement1",Va=U.qc+"readoutElement2";this.p2=document.getElementById(ma);this.p2||(this.p2=document.createElement(E.a.div),this.p2.id=ma,this.wM=document.createElement(E.a.label),this.wM.id=ra,this.wM.setAttribute(k.a.te,
k.a.s2a),this.wM.setAttribute("aria-roledescription",""),this.wM.setAttribute("aria-multiline",!1),this.nT=document.createElement(E.a.label),this.nT.id=Va,this.nT.setAttribute(k.a.te,k.a.s2a),this.nT.setAttribute("aria-roledescription",""),this.nT.setAttribute("aria-multiline",!1),this.wM.style.width="0px",this.wM.style.height="0px",this.nT.style.width="0px",this.nT.style.height="0px",this.wM.tabIndex=-1,this.nT.tabIndex=-1,this.p2.appendChild(this.wM),this.p2.appendChild(this.nT),U=U.qc+k.a.h$b,
ma=document.getElementById(U),h.ULS.shipAssertTag(537153942,3,!!ma,`FocusBasedReadout.CreateReadoutElementsIfNeeded: expected to find contentAreaDiv with id: ${U}`),ma&&ma.appendChild(this.p2))}tlj(){this.Vla&&this.wM&&this.nT&&(this.Vla.setAttribute(k.a.j5,this.wM.id),this.Vla.setAttribute(k.a.k6b,`${this.wM.id} ${this.nT.id}`))}F4j(){if(this.isActive){let U="";u.DOMElementExtensions.hasAttribute(this.Vla,k.a.j5)&&(U=this.Vla.getAttribute(k.a.j5).toString());this.Vla.setAttribute(k.a.j5,U===this.wM.id?
this.nT.id:this.wM.id)}else h.ULS.shipAssertTag(537153941,0,!1,"FocusBasedReadout.SwitchVirtualFocus: called when is not active.")}static Jza(){if(null==I.Lzb)if(e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ActiveDescendantGridReadout",!1)&&!B.a.xQa)I.Lzb=!0,h.ULS.sendTraceTag(537153940,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: ActiveDescendantGridReadout Flight is enabled");else if(I.Lzb=!1,B.a.TG||B.a.Bg)I.Lzb=!0,h.ULS.sendTraceTag(537153939,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: The FocusBasedCellReadout BRS is on");
return I.Lzb}static la(U){I.Jza()&&U.da.Ja(244,new I(U,m.h(U).cellTextEditBox.textBox.Gf))}}I.Lzb=null;Object(f.a)(I,"FocusBasedReadout",null,[262,2]);class S{constructor(U,ma,ra,Va=null){this.$Jf=(ob,ja)=>{this.C0f(ja.je.command)};this.rbg=()=>{if(e.EwaSettings.isChangeGateEnabled("OfficeVSO:7590512_SendAriaLiveNotifierTelemetry")&&!this.$.ea.Oc){var ob={["AriaLiveOffCount"]:this.gbe,["AriaLivePoliteCount"]:this.hbe,["AriaLiveAssertiveCount"]:this.fbe,["AriaLiveRudeCount"]:this.ibe,["ScreenReaderDivCount"]:this.Cqe,
["AlertScreenReaderDivCount"]:this.Lae,["AuxScreenReaderDivCount"]:this.rbe,["AriaAlertCount"]:this.dbe,["ReadCommandOnCompletionCount"]:this.lpe,["TotalAriaLiveRegionUpdates"]:this.ite};D.a.sendTelemetryEvent(Object(F.a)(new G.a,{name:"Office.Excel.Online.Accessibility.AriaLiveNotifier",dataFields:H.a.Wj(ob)}))}};this.$=U;this.Bc=Va;this.daa=document.createElement("div");this.daa.setAttribute(k.a.k5,k.a.kl);this.daa.className=l.a.Lgd;ma.insertBefore(this.daa,ra);this.cba=document.createElement("div");
this.cba.setAttribute(k.a.k5,k.a.kl);this.cba.className=l.a.Lgd;ma.insertBefore(this.cba,this.daa);this.MKg=x.a.instance.Ha(2);this.m5=document.createElement("div");this.m5.setAttribute(k.a.te,k.a.Lja);this.m5.setAttribute(k.a.Mja,k.a.r2a);this.m5.className=l.a.Lgd;ma.insertBefore(this.m5,this.cba);this.ite=this.lpe=this.dbe=this.rbe=this.Lae=this.Cqe=this.ibe=this.fbe=this.hbe=this.gbe=0;this.register();this.$.da.Ja(211,this)}get JAa(){return this.MKg}get isActive(){return!0}get Z_g(){return this.daa}get ZHj(){return this.cba}get activeCell(){return m.h(this.$).tc(null)}get zEb(){return e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConfirmationForFreewayScenarios",
!1)}dispose(){this.$&&this.unregister();u.DOMElementExtensions.tg(this.m5);u.DOMElementExtensions.tg(this.daa);u.DOMElementExtensions.tg(this.cba);this.cba=this.daa=this.m5=this.$=null}setEnabled(U){this.odg(this.cba,U)}nNj(){this.odg(this.daa,!0)}readText(U){this.sfb(z.oNa(U),!0)}Gpa(U){this.sfb(z.oNa(U),!1)}F0f(U,ma){if(1>ma||!U)h.ULS.shipAssertTag(537153954,0,!1,"Skiping listbox description readout");else{var ra=new Sys.StringBuilder;U=String.format(x.a.instance.Xb(34),ma,U);y(ra,U);y(ra,x.a.instance.ha(857));
this.sfb(z.oNa(ra.toString()),!1)}}Frj(U,ma,ra){if(1>ra||1>ma||ma>ra||!U)h.ULS.shipAssertTag(537153952,0,!1,"Skipping listbox item readout");else{var Va=new Sys.StringBuilder;y(Va,U);Va.append(String.format(x.a.instance.Xb(55),ma,ra));this.sfb(z.oNa(Va.toString()),!1)}}C0f(U){this.zEb||(U=this.Hdi(U),this.sfb(U,!1))}Drj(U){this.zEb&&(U=this.Gdi(U),this.sfb(U,!1,!0))}sfb(U,ma,ra=!1){if(U=U?U.YBc:null)ma=ma?this.cba:this.daa,v.a.equals(ma.innerHTML,U,!1)&&(U+=z.WDd),this.Spg(ma,ra),this.Bc.Yh(ma,U)}rfb(U,
ma){this.m5.getAttribute(k.a.Mja)!==ma&&this.m5.setAttribute(k.a.Mja,ma);U=U?z.oNa(U).YBc:"";this.Spg(this.m5);this.Bc.Yh(this.m5,U)}Grj(U,ma,ra,Va){const ob=x.a.instance.Xb(54);h.ULS.shipAssertTag(537153949,0,!(void 0===U||null===U));h.ULS.shipAssertTag(537153948,0,!(void 0===ma||null===ma));h.ULS.shipAssertTag(537153947,0,!(void 0===ra||null===ra));h.ULS.shipAssertTag(537153946,0,!(void 0===Va||null===Va));h.ULS.shipAssertTag(537153945,0,!(void 0===ob||null===ob));U=String.format(ob,U||"",ma||"",
ra||"",Va||"");this.rfb(U,k.a.pva)}rdk(U){var ma=this.cba.style;U?(U=w.a.q7b(U.cell,ma),ma=U.jD,ma.top=ma.left=ma.bottom=ma.right=null,U.h5()):ma.cssText=""}Hdi(U){if(this.zEb)return null;switch(U){case -1985798686:return z.bma(12);case -911352779:return z.bma(11);case 237279923:return z.bma(13);case -1502853784:return z.yW(81);case -111689794:return z.yW(78);case -287251124:return this.apd(1333,ma=>ma.bold);case -1925065947:return this.apd(1334,ma=>ma.italic);case 1764140053:return this.apd(1335,
ma=>ma.underline)}return null}Gdi(U){if(!this.zEb||6!==U.Jf)return null;switch(U.command){case -1985798686:return z.bma(12);case -911352779:return z.bma(11);case 237279923:return z.bma(13);case -1502853784:return z.yW(81);case -111689794:return z.yW(78);case 368460465:U=m.h(this.$).Wb.rh(this.activeCell.range,!0);if(null!==U)return this.lOa(2291,!U.hasAutoFilter,!1);U=this.$.ua.getItemByName(this.$.ea.na.sheetName);return this.lOa(2291,null===U.OT,!1);case -1522760979:return this.lOa(1150,m.h(this.$).isFormulaView,
!1);case 1941920197:return z.bma(836);case 1051390410:return z.yW(589);case 1542466017:return z.yW(591);case -706918724:return z.yW(590);case 369708605:return z.yW(592);case -1215659745:return z.yW(523);case 1783960667:return z.yW(521);case -1355155015:return z.yW(554);case -1158102843:return z.yW(522);case -287251124:return this.lOa(1333,this.knc(U.command));case -1925065947:return this.lOa(1334,this.knc(U.command));case 1764140053:return this.lOa(1335,this.knc(U.command));case -1590502662:return this.lOa(1336,
this.knc(U.command));case 862890474:case 963349338:if(U=z.oNa(String(this.iya())),null!==U)return z.ykd(214,U)}return null}register(){h.ULS.shipAssertTag(537153944,0,!!this.$,"Can't register to ewaControl's events");this.$&&(h.ULS.shipAssertTag(537153943,0,!!this.$.Ia,"Can't register to CommandHandlerManager's event"),this.$.Ia&&this.$.Ia.xja(this.$Jf),this.$.ea&&e.EwaSettings.isChangeGateEnabled("OfficeVSO:7590512_SendAriaLiveNotifierTelemetry")&&this.$.ea.MD(this.rbg))}unregister(){this.$&&(this.$.Ia.iga(this.$Jf),
e.EwaSettings.isChangeGateEnabled("OfficeVSO:7590512_SendAriaLiveNotifierTelemetry")&&this.$.ea.gF(this.rbg))}odg(U,ma){const ra=U===this.daa;ma?(ra&&I.Jza()||U.setAttribute(k.a.Mja,k.a.pva),ra&&U.setAttribute(k.a.te,k.a.Lja),U.setAttribute(k.a.k5,k.a.Cs),U.removeAttribute(k.a.k5),this.Bc.Yh(U,U.innerHTML+" ")):(U.removeAttribute(k.a.Mja),ra&&U.removeAttribute(k.a.te),U.setAttribute(k.a.k5,k.a.kl))}apd(U,ma){const ra=this.activeCell;if(!ra)return null;const Va=e.EwaSettings.isChangeGateEnabled("OfficeVSO:7150857_FlipRibbonCommandStateAriaDescription"),
ob=[7,8];ma=ma(ra)?!0:!1;return z.ykd(Va?ob[+ma]:ob[+!ma],z.bma(U))}Spg(U,ma=!1){if(e.EwaSettings.isChangeGateEnabled("OfficeVSO:7590512_SendAriaLiveNotifierTelemetry")){switch(U.getAttribute(k.a.Mja)){case k.a.UCe:++this.gbe;break;case k.a.pva:++this.hbe;break;case k.a.r2a:++this.fbe;break;case k.a.a3g:++this.ibe}switch(U){case this.ZHj:++this.Cqe;break;case this.Z_g:++this.Lae;break;case this.m5:++this.rbe}U.getAttribute(k.a.te)===k.a.Lja&&++this.dbe;ma&&++this.lpe;this.ite++}}lOa(U,ma,ra=!0){return this.zEb&&
this.activeCell?z.ykd(ma?ra?7:216:ra?8:217,z.bma(U)):null}knc(U){return m.h(this.$).ga.Sa.DS?this.BCi(U):this.CCi(U)}BCi(U){const ma={};switch(U){case -287251124:U="QueryBold";break;case -1925065947:U="QueryItalics";break;case 1764140053:U="QueryUnderline";break;case -1590502662:U="QueryStrikethrough";break;default:return!1}const ra=M.a(this.$);return ra?(ra.GOa(U,ma),ma[O.a.On]):!1}CCi(U){var ma=m.h(this.$);const ra=L.a(ma.tc(null));e.EwaSettings.jc()&&ma.Ob&&(ra.Font=ma.ai.jya(ra.Font));ma=ra.Font;
switch(U){case -287251124:return ma.Bold;case -1925065947:return ma.Italic;case 1764140053:return ma.Underline;case -1590502662:return ma.Strikethrough}return!1}iya(){let U=m.h(this.$);if(U.ga.Sa.DS)return null;const ma=L.a(U.tc(null));e.EwaSettings.jc()&&U.Ob&&(ma.Font=U.ai.jya(ma.Font));return ma.Font.FontSize}}Object(f.a)(S,"AriaLiveNotifier",null,[292,262,2]);var J=a(40),K=a(100),R=a(149),Z=a(35);class P extends d.a{constructor(U){super();this.$=U;this.uc()}create(){const U=Object(K.d)(R.a.resolve(Z.W,
{Wa:this.La}));J.TaskExtensions.za(J.TaskExtensions.xe([U],this.$.ka),()=>{this.$b(this.$.da.Ba(211)||new S(this.$,this.$.Hw,this.$.og,U.result))},this.ka,3)}static la(U){U.da.Ja(212,new P(U))}}Object(f.a)(P,"AriaLiveNotifierFactory",d.a,[]);class V extends d.a{constructor(U){super();this.$=U;this.uc()}create(){I.Jza()?m.h(this.$).cellTextEditBox.textBox.qR(()=>{const U=this.$.da.Ba(244)||new I(this.$,m.h(this.$).cellTextEditBox.textBox.Gf);this.$b(U)}):this.$b(null)}static la(U){U.da.Ja(315,new V(U))}}
Object(f.a)(V,"FocusBasedReadoutFactory",d.a,[]);var Ea=a(52),oa=a(92),ea=a(126);const aa=U=>{switch(U){case 1:return 1457;case 2:return 1458;case 3:return 1459;case 4:return 1460;case 5:return 1461;case 6:return 1462;case 7:return 1463;case 8:return 1464;case 9:return 1465;case 10:return 1466;case 11:return 1467;case 12:return 1468;case 13:return 1469;case 14:return 1470;case 15:return 1471;case 16:return 1472;case 17:return 1473;case 18:return 1474;case 19:return 1475;case 20:return 1476;case 21:return 1477;
case 22:return 1480;case 23:return 1478;case 24:return 1479;case 25:return 1481;case 26:return 1482;case 27:return 1483;case 28:return 1484;default:return 1485}};var ia=a(25),ya=a(47),za=a(219),la=a(51),xa=a(48),wa=a(135);class hb{static get qqj(){return hb.dpe||(hb.dpe=RegExp("([A-Z]+)","g"))}static get pqj(){return hb.cpe||(hb.cpe=RegExp("([A-Z])","g"))}static get Jdh(){return hb.wce||(hb.wce=RegExp("^\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+\\$?[0-9]+:\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+:\\$?[A-Z]+$|^\\$?[0-9]+:\\$?[0-9]+$"))}static Qod(U){return hb.wdf(U.toString())}static wdf(U){return hb.Jdh.test(U)?
U.replace(hb.qqj,"$1 ").replace(hb.pqj,' "$1"').trim():U}static jBj(U){const ma=U.lastIndexOf("!");return U.substring(0,-1<ma?ma+1:0)+hb.wdf(U.substring(-1<ma?ma+1:0,U.length))}}hb.dpe=null;hb.cpe=null;hb.wce=null;Object(f.a)(hb,"RangeAriaExtensions",null,[]);class Ja{constructor(){this.activeItemName=null;this.Buf=!1;this.tableName=null;this.f4a=0;this.mHc=!1}}Object(f.a)(Ja,"SelectionReadoutState",null,[]);a(74);var Fa=a(75);class Ba{constructor(U,ma,ra,Va,ob){this.gridReadoutNotifier=null;this.lfb=
!1;this.Fva=this.xtb=null;this.Xfa=()=>{e.EwaSettings.isChangeGateEnabled("OfficeVSO:5963256_DoNotReadActiveItemIfDisposed")&&!this.$?h.ULS.sendTraceTag(526235470,0,15,"calling readActiveItemDescription after dispose, ignoring."):m.h(this.$).Ob||this.q6b.ir()};this.F0i=()=>{if(!m.h(this.$).ga.Sa.kyd){var ja,lb=({activeCell:ja}=this.h_h()).returnValue;this.readText(lb,ja)}};this.JC=()=>{const ja=this.activeCell;this.readText("Editing",ja);e.EwaSettings.isChangeGateEnabled("OfficeVSO:5190952_removePhoneticErrorDialog2")||
ja&&ja.fkc&&!m.h(this.$).$if||this.q6b.cancel()};this.Od=()=>{e.EwaSettings.isChangeGateEnabled("OfficeVSO:6053639_DoNotHandleSelectionChangedIfDisposed")&&!this.$?h.ULS.sendTraceTag(525366409,0,15,"calling onSelectionChanged after dispose, ignoring."):(this.Xfa(),this.lfb&&m.h(this.$).inRangePicker&&1===Fa.a.fc&&(null===this.xtb?this.xtb=la.a.instance.create(this.kQd,Ba.Z0c,"readSelectedRanges"):this.xtb.ir()))};this.$=ma;this.ariaLiveNotifier=U;this.sparklineManager=Va;this.tableManager=ra;this.fF=
new Ja;this.Jza=I.Jza();this.lfb=e.EwaSettings.isChangeGateEnabled("OfficeVSO:5888244_FixCellReadoutInRangePicking");this.Jza&&(e.EwaSettings.jc()?this.gridReadoutNotifier=ob:this.gridReadoutNotifier=ma.da.Ba(244),h.ULS.shipAssertTag(537153937,0,!!this.gridReadoutNotifier,"SelectionReadoutHandler.ctor: gridReadoutNotifier shouldn't be null"),Ba.Z0c=700);this.q6b=la.a.instance.create(this.F0i,Ba.Z0c,xa.a.HJj,!1);this.vj()}get activeCell(){return m.h(this.$).tc(null)}dispose(){this.$&&this.xj();oa.a.Ka(this.q6b);
this.sparklineManager=this.$=this.q6b=null}Q8e(U,ma,ra=!0){if(e.EwaSettings.isChangeGateEnabled("OfficeVSO:7449834_NoReadoutWhenFindAndReplaceDialogOpen")&&null!==this.$.Zb.ii&&"FindAndReplaceDialog"===this.$.Zb.ii.dd||!U)return"";var Va=this.$.da;const ob=new Sys.StringBuilder;this.K1g(ob,U,ma);if(e.EwaSettings.isChangeGateEnabled("OfficeVSO:4124702_ColumnHeaderReadout")){var ja=this.tableManager.Dma(U.range);(null===ja||void 0===ja?0:ja.l0d)&&this.tBe(ob,ja);ja=this.tableManager.Uq(U.range);(null===
ja||void 0===ja?0:ja.Zma)&&this.tBe(ob,ja)}ja=U.l7?this.Qaf(U):U.text;y(ob,ja);ja=this.$.activeItemName;this.fF.activeItemName!==ja&&(y(ob,ja),this.fF.activeItemName=ja);ja=1===ma.length?ya.L(ma).isSingle?"":x.a.instance.ha(853):String.format(x.a.instance.Xb(31),ma.length);y(ob,ja);for(var lb of ma)ja=this.Jza?lb.toString():hb.Qod(lb),y(ob,ja),1===ma.length&&Ba.DJi(lb)&&(ja=m.h(this.$).Ca.Or(lb.bottomRight),void 0!==ja&&null!==ja&&ja.text&&(ja=ja.l7?this.Paf(ja,ja.text):ja.text,y(ob,ja)));lb=U.cell;
lb=this.Tai(lb.SFj,lb.Jgh);y(ob,lb);this.t1g(ob,U);ra&&(U.$$a?y(ob,x.a.instance.ha(841)):U.Vza&&y(ob,x.a.instance.ha(842)));if(U.hasAutoFilter||U.k7)this.L1g(ob,U.hasAutoFilter?U.cell.autoFilterType:U.cell.Lij),ra&&y(ob,x.a.instance.ha(844));za.c(this.$,U.range)&&y(ob,x.a.instance.ha(848));this.q1g(ob,U);ra=(ra=Va.Ba(14))?ra.g0h():"";y(ob,ra);U.yz&&(ra=m.h(this.$).Ca.Or(U.range),ra=!!ra&&ra.hasIgnorableError,Ba.FTj(U)?Ba.r1g(ob,U):e.EwaSettings.isChangeGateEnabled("OfficeVSO:3286994_NarratorForFormulaErrors")&&
ra?y(ob,x.a.instance.ha(846)):y(ob,x.a.instance.ha(845)));U.pO&&(y(ob,x.a.instance.ha(847)),U.ACb&&y(ob,String.format(x.a.instance.Xb(16),U.luh)),y(ob,U.iconName));U.hasRichValueIcon&&(lb=this.$.da.Ba(271),ra="",lb&&U.cell.Syf&&(lb=lb.aW(U.cell.Syf))&&lb.DomainId.Id!==Ba.Alk&&(ra=lb.Name),U.cell.$yi?(y(ob,String.format(x.a.instance.Xb(187),ra)),y(ob,x.a.instance.ha(1812))):(y(ob,String.format(x.a.instance.Xb(185),ra)),y(ob,x.a.instance.ha(1811))));this.hoi(U)&&y(ob,Ba.d7h(U));(Va=Va.Ba(231))&&y(ob,
Va.ebf(ma,!0));1===ma.length&&ma[0].isSingle&&Ba.ETj(U,ma[0],this.$)&&(ma=this.$.da.Ba(271))&&y(ob,ma.s0h());U.eUb&&U.fUb&&y(ob,U.fUb);(ma=U.cell.Y7c)&&y(ob,ma);U.kQa&&U.zMb&&(U=U.OMd)&&(y(ob,x.a.instance.ha(1985)),y(ob,U));return ob.toString()}GGe(U){this.Fva=this.fF;this.fF=Object(F.a)(new Ja,{activeItemName:this.Fva.activeItemName,mHc:U?this.Fva.mHc:!1,tableName:U?this.Fva.tableName:"",f4a:U?this.Fva.f4a:-1})}x8f(){this.Fva&&(this.fF=this.Fva,this.Fva=null)}Tai(U,ma){return 2===U||2===ma?x.a.instance.ha(875):
1===U||1===ma?x.a.instance.ha(876):""}Qaf(U){return this.Paf(U.cell,U.text)}K1g(U,ma,ra){if(ra&&1===ra.length&&ra[0].isSingle){ra="";var Va=this.tableManager.Dma(ma.range);if(Va){ra=Va.pivotTableName;this.f4c(U,ra);var ob=Va.$mc?x.a.instance.ha(835):"";e.EwaSettings.isChangeGateEnabled("OfficeVSO:6154754_NarratorReadoutForPivotTableAltText")&&(ob+=(Va.altText?Va.altText+" . ":"")+(Va.altTextSummary?Va.altTextSummary:""));this.vBe(U,!0,ra,ob);y(U,this.tableManager.nHi(Va,ma.range)?x.a.instance.ha(838):
"");y(U,this.tableManager.vAi(Va,ma.range)?x.a.instance.ha(837):"")}else if(Va=this.tableManager.Uq(ma.range)){ra=(ob=m.h(this.$).Wb.rh(ma.range))?ob.name:"";this.f4c(U,ra);let ja="";ob&&(ja=(ob.VWa?ob.VWa+" . ":"")+(ob.WWa?ob.WWa:""));this.vBe(U,!1,ra,ja);y(U,this.tableManager.wrf(Va,ma.range)?x.a.instance.ha(837):"")}else this.f4c(U,ra),this.fF.tableName="",this.fF.f4a=-1}}f4c(U,ma){ma!==this.fF.tableName&&this.fF.tableName&&(U.append(x.a.instance.ha(this.fF.mHc?834:833)),y(U," "+this.fF.tableName))}vBe(U,
ma,ra,Va){ra!==this.fF.tableName&&(U.append(x.a.instance.ha(ma?832:831)),y(U," "+ra),y(U,Va),this.fF.tableName=ra,this.fF.mHc=ma,this.fF.f4a=-1)}tBe(U,ma){const ra=m.h(this.$).ga.pa.activeCell;if(ra.top!==ma.top&&ra.left!==this.fF.f4a){U.append(x.a.instance.ha(837));ma=new ia.Range(ma.top,ra.left,ma.top,ra.left,!0,!0);y(U,hb.Qod(ma));if(ma=m.h(this.$).tc(ma))ma=ma.l7?this.Qaf(ma):ma.text,y(U,ma);this.fF.f4a=ra.left}}Paf(U,ma){const ra=U.k9a;return U.Rya?String.format(x.a.instance.Xb(14),ma,ra):String.format(x.a.instance.Xb(13),
ma,hb.jBj(ra))}vj(){h.ULS.shipAssertTag(537153930,0,!!this.$,"Can't register to ewaControl's events");if(this.$){var U=m.h(this.$);h.ULS.shipAssertTag(537153929,0,!!U,"Can't register to grid's events");U&&(U.Gc.ro(this.JC),U.Ca.Aw(this.Xfa),U.TF(this.Xfa),this.lfb&&U.Gc.Pm(this.Ug.bind(this)),U=U.ga,h.ULS.shipAssertTag(537153928,0,!!U,"Can't register to selectionManager's events"),U&&(U.yp(this.Od),U.add_activeCellChanged(this.Xfa),U.Sa.bR(this.Xfa),this.lfb&&(this.kQd=this.kQd.bind(this))))}}xj(){if(this.$){var U=
m.h(this.$);U&&(U.Gc.io(this.JC),U.Ca.gx(this.Xfa),U.qH(this.Xfa),this.lfb&&U.Gc.fn(this.Ug),U=U.ga)&&(U.Rp(this.Xfa),U.remove_activeCellChanged(this.Xfa),U.Sa.u2(this.Xfa))}}readText(U,ma){this.Jza&&this.gridReadoutNotifier&&this.gridReadoutNotifier.isActive?this.gridReadoutNotifier.readText(U):(e.EwaSettings.isChangeGateEnabled("OfficeVSO:5033038_Embed_Mode_Grid_Narrator_Fix")&&this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(U),this.lfb&&!ma||this.ariaLiveNotifier.rdk(ma))}Ug(){this.xtb&&
this.xtb.cancel()}kQd(){this.readText(this.uei())}uei(){let U="";m.h(this.$).ga.rangePicker.sP.forEach(()=>{U+=void 0});return U+=" selected"}h_h(){let U;U=null;var ma=m.h(this.$).ga;if(1!==ma.rf&&!ma.Sa.Pc)return h.ULS.sendTraceTag(537153927,0,15,`selectionManager.CommandSelectionMode=${ma.rf} and selectionManager.SelectedFloatingObjectControl is null`),{returnValue:"",activeCell:U};switch(ma.rf){case 2:return{returnValue:this.l2h(ma),activeCell:U};case 64:var ra=ma.Sa.Pc.floatingObject,Va="";if(ma=
ma.Sa.Pc.iu||ma.Sa.Pc.ye)Va=(Va=ma.firstChild)?u.DOMElementExtensions.getTextContent(Va):"";return{returnValue:String.format(x.a.instance.Xb(53),Ba.tgc(ra.altText,ra.altTextDescription,ra.name),Va,ra.altTextDescription),activeCell:U};case 4:return{returnValue:Ba.z0g(ma.Sa.Pc.floatingObject),activeCell:U};case 512:return{returnValue:wa.a.u$e(ma.Sa.Pc.floatingObject.Ved),activeCell:U};case 8:return ra=ma.Sa.Pc.floatingObject,{returnValue:String.format(x.a.instance.Xb(51),ra?ra.name:""),activeCell:U};
case 1:return U=this.activeCell,{returnValue:this.Q8e(U,ma.pa.selectedRanges),activeCell:U}}return{returnValue:"",activeCell:U}}l2h(U){const ma=new Sys.StringBuilder;ma.append(Ba.$ch(U));const ra=this.$.da.Ba(231);ra&&y(ma,ra.ebf(U.Sa.Pc.floatingObject,!1));return ma.toString()}hoi(U){U=U.mpf();let ma=!1;this.fF.Buf!==U&&(this.fF.Buf=U,ma=!0);return ma}t1g(U,ma){if(ma.KCb)if(ma=this.sparklineManager.wfi(ma)){var ra=x.a.instance,Va=ra.ha;a:switch(ma.type){case 0:var ob=828;break a;case 1:ob=829;break a;
default:ob=830}ra=Va.call(ra,ob);y(U,String.format(x.a.instance.Xb(25),ra));ma=String.format(x.a.instance.Xb(24),hb.Qod(ma.U0j));y(U,ma)}else h.ULS.sendTraceTag(537153925,0,15,"No sparkline range was found on a cell with sparkline."),y(U,String.format(x.a.instance.Xb(25),""))}L1g(U,ma){switch(ma){case 1:case 11:y(U,x.a.instance.ha(849));break;case 6:y(U,x.a.instance.ha(849));y(U,x.a.instance.ha(851));break;case 7:y(U,x.a.instance.ha(849));y(U,x.a.instance.ha(852));break;case 2:y(U,x.a.instance.ha(850));
y(U,x.a.instance.ha(851));break;case 3:y(U,x.a.instance.ha(850));y(U,x.a.instance.ha(852));break;default:y(U,x.a.instance.ha(850))}}q1g(U,ma){var ra;const Va=this.$.da.Ba(65);ma=Va?Va.HNa(ma.range):null;let ob="";const ja=Object(ea.a)(286,ma);if(ma)ob=!ma.G$a&&ja&&ja.cJi?String.format(x.a.instance.Xb(29),ja.w5j):String.format(x.a.instance.Xb(23),ma.author);else if(null===(ra=null===Va||void 0===Va?void 0:Va.eo)||void 0===ra?0:ra.GG)ob=String.format(x.a.instance.Xb(28),Va.eo.ZO.author);y(U,ob)}static z0g(U){return String.format(x.a.instance.Xb(52),
Ba.tgc(U.altText,U.altTextDescription,U.name),U.altTextDescription)}static d7h(U){return x.a.instance.ha(U.mpf()?839:840)}static tgc(U,ma,ra){return U||ma?U:ra}static $ch(U){var ma=U.Sa.Pc;U=ma.floatingObject;const ra=U.Pd,Va=ra.ChartTitle,ob=U.altText,ja=U.altTextDescription,lb=!!(ra.Attributes&4);return(ma=ma.getSelectionDescription())?ma:ra.DataRangeForDisplay?String.format(x.a.instance.Xb(lb?49:47),Ba.tgc(ob,ja,U.name),ja,Va,x.a.instance.ha(aa(ra.ChartCategory)),ra.DataRangeForDisplay):String.format(x.a.instance.Xb(lb?
50:48),Ba.tgc(ob,ja,U.name),ja,Va,x.a.instance.ha(aa(ra.ChartCategory)))}static FTj(U){return e.EwaSettings.ya(101)&&(U.OEb||U.Zmc)}static r1g(U,ma){ma.ara?ma.OEb?y(U,String.format(x.a.instance.Xb(26),ma.ara.topLeft.toString())):ma.Zmc&&(ma=ma.ara.pQ(),y(U,String.format(x.a.instance.Xb(27),(ma.LastColumn-ma.FirstColumn+1).toString(),(ma.LastRow-ma.FirstRow+1).toString()))):h.ULS.shipAssertTag(537153924,0,!1,"SelectionReadoutHandler.AppendAriaDynamicArrayFormulaDescription: This method should only be called with a valid dynamic array range.")}static ETj(U,
ma,ra){return U.yz||!e.EwaSettings.ya(131)?!1:(U=ra.da.Ba(271))?U.Fmc(ma):!1}static DJi(U){return U.top===U.bottom&&U.left+1===U.right||U.top+1===U.bottom&&U.left===U.right}}Ba.Alk=268435712;Ba.Z0c=500;Object(f.a)(Ba,"SelectionReadoutHandler",null,[287,2]);var fa=a(63),ta=a(727),Oa=a(72);class Ma extends d.a{constructor(U){super();this.$=U;this.uc()}create(){const U=this.$.da,ma=Ea.GetServiceTaskFactory.Za(U,211,212,this.La),ra=e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateTableManager",
!1)?Object(K.d)(R.a.resolve(Z.Db,{Wa:this.La})):Ea.GetServiceTaskFactory.Za(U,66,134,this.La),Va=Object(Oa.b)("OfficeVSO:7624512_MigrateSparklineManagerService")?Object(K.d)(R.a.resolve(Z.Bb,{Wa:this.La})):Ea.GetServiceTaskFactory.Za(U,240,239,this.La);let ob=fa.Task.Ua(null);e.EwaSettings.jc()&&(ob=Ea.GetServiceTaskFactory.Za(U,244,315,this.La));J.TaskExtensions.za(J.TaskExtensions.xe([ma,ra,Va,ob],this.ka),()=>{const ja=Object(ta.a)(this.$.da,226,()=>new Ba(ma.result,this.$,ra.result,Va.result,
ob.result));this.$b(ja)},this.$.ka,3)}static la(U){U.da.Ja(227,new Ma(U))}}Object(f.a)(Ma,"SelectionReadoutHandlerFactory",d.a,[]);var fb=a(118);class pa{constructor(U,ma){this.$=ma;this.ariaLiveNotifier=U}N0f(){const U=this.i0h();this.ariaLiveNotifier.rfb(U,k.a.r2a)}i0h(){const U=new Sys.StringBuilder;this.$.workbookContext&&y(U,this.$.workbookContext.WorkbookFileName);y(U,x.a.instance.ha(855));y(U,this.k0h());y(U,this.j0h());y(U,x.a.instance.ha(856));return U.toString()}k0h(){return this.$.isEditMode?
x.a.instance.ha(860):x.a.instance.ha(861)}j0h(){var U=this.Nkk();const ma=this.$.ua.na;U=1!==U?String.format(x.a.instance.Xb(32),U):x.a.instance.ha(854);U=new Sys.StringBuilder(U);ma&&ma.sheetName&&(U.append(z.WDd),U.append(String.format(x.a.instance.Xb(33),ma.sheetName)));return U.toString()}Nkk(){let U=0;for(const ma of this.$.ua.items)ma.visible&&U++;return U}}Object(f.a)(pa,"WorkbookReadout",null,[]);var Ua=a(477);let Sa=class{constructor(U,ma,ra){this.WNf=()=>{this.I9d.N0f();this.ariaLiveNotifier.setEnabled(!0)};
this.$=ma;this.ariaLiveNotifier=U;this.I9d=new pa(U,ma);this.Kfc=ra.wod(this.$);this.Kfc.RXg(this.WNf)}dispose(){this.Kfc&&this.Kfc.Vyj(this.WNf);this.Kfc=this.ariaLiveNotifier=this.$=null}};Sa=Object(fb.b)([Object(R.d)(Z.D),Object(fb.c)(0,Object(Ua.AriaLiveNotifierService)()),Object(fb.c)(1,Object(Z.E)()),Object(fb.c)(2,Object(Z.tb)())],Sa);Object(f.a)(Sa,"EmbeddedWorkbookReadoutHandler",null,[2]);let Ia=class{constructor(U,ma){this.MX=()=>{this.Be||this.UAe()};this.Be=!1;this.R_=ma.N_;this.ariaLiveNotifier=
U;this.I9d=new pa(U,ma);this.R_&&this.R_.zS?this.UAe():this.vj()}dispose(){this.xj();this.ariaLiveNotifier=this.R_=null;this.Be=!0}vj(){if(this.R_){this.R_.ut(this.MX);this.R_.Ca.Aw(this.MX);this.R_.TF(this.MX);var U=Object(ea.a)(240,this.R_);U&&(U.Gc.ro(this.MX),U.ga.yp(this.MX),U.ga.add_activeCellChanged(this.MX),U.ga.Sa.bR(this.MX))}else h.ULS.sendTraceTag(537153923,0,15,"WorkbookReadoutHandler.RegisterEvents: Can't register to view events")}xj(){if(this.R_){this.R_.Ca.gx(this.MX);this.R_.qH(this.MX);
const U=Object(ea.a)(240,this.R_);U&&(U.Gc.io(this.MX),U.ga.Rp(this.MX),U.ga.remove_activeCellChanged(this.MX),U.ga.Sa.u2(this.MX))}}UAe(){this.I9d.N0f();this.ariaLiveNotifier.setEnabled(!0);this.ariaLiveNotifier.nNj();this.dispose()}};Ia=Object(fb.b)([Object(R.d)(Z.Kb),Object(fb.c)(0,Object(Ua.AriaLiveNotifierService)()),Object(fb.c)(1,Object(Z.E)())],Ia);Object(f.a)(Ia,"WorkbookReadoutHandler",null,[2]);class X extends d.a{constructor(U){super();this.$=U;this.uc()}create(){const U=Ea.GetServiceTaskFactory.Za(this.$.da,
211,212,this.La);if(this.$.VG){const ma=Object(Oa.b)("OfficeVSO:7629428_MigrateSharedUIControlsFactoryService")?Object(K.d)(R.a.resolve(Z.tb,{Wa:this.La})):Ea.GetServiceTaskFactory.Za(this.$.da,12,477,this.La);J.TaskExtensions.za(J.TaskExtensions.xe([U,ma],this.$.ka),()=>{const ra=Object(ta.a)(this.$.da,228,()=>new Sa(U.result,this.$,ma.result));this.$b(ra)},this.$.ka,3)}else J.TaskExtensions.za(U,ma=>{const ra=Object(ta.a)(this.$.da,228,()=>new Ia(ma.result,this.$));this.$b(ra)},this.$.ka,3)}static la(U){U.da.Ja(229,
new X(U))}}Object(f.a)(X,"WorkbookReadoutHandlerFactory",d.a,[]);a.d(C,"a",function(){return ca});const ca=()=>{b.a.Fa(U=>{P.la(U);e.EwaSettings.jc()?V.la(U):I.la(U);Ma.la(U);Object(Oa.b)("OfficeVSO:7641163_MigratingWorkbookReadoutHandlerService")||X.la(U)})};String(c);String(r);window.___1684780592236_closurehack=c;window.___1684780592236_closurehack=r},1217:function(r,C,a){var c=a(10);r=a(0);var b=a(230),e=a(118),f=a(15),d=a(1433),h=a(655),l=a(560),k=a(31),u=a(92),v=a(32),x=a(172),w=a(9),m=a(62),
t=a(167),z=a(356),y=a(51),D=a(48),H=a(34),F=a(1),G=a(23),L=a(16),M=a(109),O=a(126),B=a(88),E=a(156),I=a(6),S=a(14),J=a(102),K=a(49),R=a(1178);class Z extends E.a{constructor(nb,pb=!0){super(!1,!1,Z.ow);this.W_a=null;this.Lfe=!1;this.oo=[];this.Gk=null;this.P2b=nb;this.bOg=pb;this.Gy=this.Dse=!1;this.gja=null;this.xQc=!1;this.Qg=this.Lxh;this.ef="InsertFileDialog";this.Qc(1,this.n3b);Z.ow?(this.W_a={["id"]:this.ef,["bodyControls"]:{["uploadButtonProps"]:{["label"]:CommonUIStrings.l_DialogChooseFile,
["onExecute"]:Object(B.a)(this,this.Ydj,"onUploadButtonClick")}},["uploadStatusLabel"]:CommonUIStrings.l_DialogNoFileChosen,["onFrameReady"]:Object(B.a)(this,this.K5i,"onFrameReady")},this.initializeAndShow(this.titleText,Object(B.a)(this,this.Nlc,"insertDialogHandler"),this.W_a),this.eYb=!0):(this.showDialog(this.titleText,Object(B.a)(this,this.Nlc,"insertDialogHandler")),pb&&this.tfg(),(nb=this.HL(1))&&this.oo.push(nb),(nb=this.HL(0))&&this.oo.push(nb),this.cug(),this.eYb=!1)}get Khk(){return this.P2b}validate(){this.Gk.wG||
f.ULS.sendTraceTag(25798091,322,10,"UploadFrame.FileInputElement is null");return this.Gk.wG.value?!0:(Z.rB(CommonUIStrings.l_FileUploadNoFileSpecified),!1)}K5i(nb){this.bOg&&(this.Gk=this.sfg(nb,this.P2b))}Ydj(){this.Gk&&this.Gk.wG&&(this.Lfe||(this.Gk.Nuj(Object(B.a)(this,this.zJd,"onFileChosen")),this.Lfe=!0),this.Gk.B3e())}zJd(nb){this.W_a.uploadStatusLabel=nb;this.CXa(this.titleText,Object(B.a)(this,this.Nlc,"insertDialogHandler"),this.W_a)}Nlc(nb){1===nb&&this.isEnabled()?Z.ow&&this.Gk.wG&&
!this.Gk.wG.value?(this.W_a.uploadStatusLabel=CommonUIStrings.l_FileUploadNoFileSpecified,this.CXa(this.titleText,Object(B.a)(this,this.Nlc,"insertDialogHandler"),this.W_a)):(this.a9a(),this.P2b.finalizeUpload(this.Gk,Object(B.a)(this,this.dispose,"dispose"))):0===nb&&this.hide()}tfg(){this.xQc=!1;this.Gk=this.sfg(document.getElementById("uploadFrameContainer"),this.P2b);I.AFrameworkApplication.fa.ra("InsertPictureDialogFocusLoopFixIsEnabled")&&(this.gja=Object(B.a)(this,this.hLd,"onUploadFrameLoad"),
K.a.addHandler(this.Gk.iFrame,"load",this.gja));this.Gk.wG||f.ULS.sendTraceTag(25798092,322,15,"UploadFrame.FileInputElement is null");this.QYf()}hLd(){this.QYf()}QYf(){if(this.Gk&&!this.xQc){var nb=this.Gk.wG;nb&&(K.a.addHandler(nb,S.a.Ic,Object(B.a)(this,this.onKeyDown,"onKeyDown")),nb=[nb],this.oo=nb.concat.apply(nb,this.oo),this.cug(),this.xQc=!0)}}dispose(){if(this.Gk&&!Z.ow){const nb=this.Gk.wG;nb&&K.a.removeHandler(nb,S.a.Ic,Object(B.a)(this,this.onKeyDown,"onKeyDown"));this.gja&&K.a.removeHandler(this.Gk.iFrame,
"load",this.gja)}this.Gk=null;super.dispose()}cug(){if(0<this.oo.length){const nb=new R.a(this.oo),pb=J.FocusManager.instance().hS();pb&&(this.oo[0].focus(),pb.ag=nb,pb.y1=!0)}}onKeyDown(nb){4!==J.FocusManager.instance().TYf(nb)&&nb.preventDefault()}static get ow(){return I.AFrameworkApplication.sa.Qa.$w&&I.AFrameworkApplication.sa.Qa.Ntf}static rB(nb){const pb=document.getElementById("errorText");pb.innerText=nb;pb.style.display="inline-block"}}Object(r.a)(Z,"InsertFileDialog",E.a,[]);class P{static get Qg(){return E.a.lq(P.cm,
CommonUIStrings.l_ImageUploadDialogText,CommonUIStrings.l_ImageUploadNoFileSpecified)}}P.cm="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";Object(r.a)(P,"InsertImageDialogHtml",null,[]);class V extends Z{constructor(nb,pb=!0){super(nb,pb)}get n3b(){return CommonUIStrings.l_ImageUploadButtonText}get titleText(){return CommonUIStrings.l_ImageUploadingTitle}get Lxh(){return P.Qg}validate(){this.Gk.wG||
f.ULS.sendTraceTag(25798095,322,10,"UploadFrame.FileInputElement is null");const nb=Object(O.a)(d.a,this.Khk),pb=nb.iwg(this.Gk.wG.value);return 0!==pb?(Z.rB(nb.D$e(pb)),!1):!0}}Object(r.a)(V,"InsertImageDialog",Z,[]);var Ea=a(565);const oa=(nb,pb,cb)=>{if(nb){var Da=0;do{try{nb();break}catch(zb){if(f.ULS.sendTraceTag(50946190,306,10,"RetryOnException: [Retries: {0}] [Caller: {1}] [Exception: {2}] [Callstack: {3}].",Da,cb,zb.message,zb.stack),Da>=pb)break}Da++}while(1)}};var ea=a(112),aa=a(93),ia=
a(43),ya=a(265),za=a(161),la=a(64),xa=a(471),wa=a(173);class hb{constructor(nb,pb,cb,Da,zb,qb,Pa,Nb,Tb=!0,Vb=null,Jb=!1){this.I3e="FileUpload.ashx";this.pp=null;this._initialized=!1;this.Kh=this.cnb=this.wQc=this.gja=this.EYb=this.ls=this.ru=null;this.Nn=!1;this.zF=this.FYb=this.Z_c=null;this._parent=nb;this.QIg=pb;this.uNg=cb;this.qge=zb;this.YYc=Pa;this.jae=Nb;this.nce=Vb;this.Y_c=!1;this.nJg=Da.ra("CanaryRenewalForFileUploadIsEnabled");this.vvg=!1;(this.Mta=Jb)||this.jmh(qb);Tb&&this.hnf()}get r8f(){return this.uNg}get sessionId(){return this.YYc}get iFrame(){return this.pp}get wG(){return this.ls}get ucb(){return I.AFrameworkApplication.fa?
I.AFrameworkApplication.fa.ra("NativeFileOpenDialogIsEnabled"):!1}get C3e(){return I.AFrameworkApplication.fa?I.AFrameworkApplication.fa.ra("FileInputDescriptionAccessibilityIsEnabled"):!1}get tEi(){return this.Mta?!1:za.b(this.pp.contentWindow.location.pathname,this.I3e,0)}get t0g(){return!k.a.Oza&&I.AFrameworkApplication.fa.ra("AllowMultipleImageInsertFromLocalDevice")}hnf(){this.zF=wa.a.create().toString();this.Mta?this.Ofd():this.A1g()}jmh(nb){this.pp=document.createElement("iframe");this.pp.className=
nb;this.pp.id=nb;this.qge&&(this.pp.style.visibility="visible",this.pp.style.height="30px",this.pp.setAttribute("frameborder","0"));this.gja=Object(B.a)(this,this.hLd,"onUploadFrameLoad");K.a.addHandler(this.pp,"load",this.gja)}tcc(nb=null){I.AFrameworkApplication.sa.Jxc();if(!this.ls)return f.ULS.sendTraceTag(25798093,322,50,"_fileInput is null"),"";K.a.addHandler(this.ls,"change",()=>{this.WRh(nb)});oa(Object(B.a)(this,this.B3e,"fileInputClick"),1,"DoFileOpenDialog");return this.ls.value}WRh(nb){nb&&
nb(this.ls.value)}XRh(){this.EYb&&(this.EYb.innerText=this.$af())}Nuj(nb){K.a.addHandler(this.ls,"change",()=>{nb(this.$af())})}$af(){let nb=null;if(this.ls.value){const pb=this.ls.value,cb=pb.lastIndexOf("\\");0<cb&&(nb=pb.substring(cb+1,pb.length))}return nb?nb:""}B3e(){try{f.ULS.sendTraceTag(35939520,322,50,"UploadFrame.FileInputClick - Clicking on File input element."),this.ls.click()}catch(nb){throw f.ULS.sendTraceTag(36783331,322,10,"UploadFrame.FileInputClick Exception: {0}",nb.message),nb;
}}D3j(){this.THi()?this.wmg():(this.N7d(),this.ru.submit())}THi(){return(this.nJg||this.Mta)&&!(void 0===window.self.FormData||null===window.self.FormData)}Jbg(nb){if(nb){const pb=this.wOe();this.Kh=new XMLHttpRequest;this.Kh.open("POST",pb);this.Kh.setRequestHeader("X-CorrelationId",this.zF);this.uQi(nb);this.Kh.onreadystatechange=Object(B.a)(this,this.Pra,"uploadResponseReceived");this.Kh.send(nb)}}uQi(nb){if(!k.a.Oza&&nb.get){var pb=nb.get("ImageId");nb=window.self.navigator;pb={["CorrelationId"]:this.zF,
["Canary"]:I.AFrameworkApplication.canary,["ImageNodeId"]:pb};nb&&(nb=nb.connection?nb.connection:nb.mozConnection?nb.mozConnection:nb.webkitConnection?nb.webkitConnection:null)&&(pb.effectiveType=nb.effectiveType,pb.downlink=nb.downlink,pb.type=nb.type,pb.rtt=nb.rtt);f.ULS.sendTraceTag(573345858,322,50,"LogFileUploadStatistics: FileUpload {0}",pb)}}wmg(){try{this.N7d();f.ULS.sendTraceTag(594888409,322,50,"SubmitFormWithRequest is preparing to send an upload request");const nb=new (Type.parse("FormData"))(this.ru);
this.Jbg(nb)}catch(nb){f.ULS.sendTraceTag(594888407,322,10,"SubmitFormWithRequest failed to send the request with exception "+nb.message),this.Fdb(null)}}vmg(nb){try{if(this.N7d(),f.ULS.sendTraceTag(594888406,322,50,"SubmitFormWithBlob is preparing to send an upload request"),this.Gjk(nb)){this.FYb=nb;this.ru.contains(this.ls)&&this.ru.removeChild(this.ls);var pb=new (Type.parse("FormData"))(this.ru);pb.append("applicationfileInput",nb.blob,nb.filename);this.Jbg(pb)}else this.Fdb(null)}catch(cb){f.ULS.sendTraceTag(591267743,
322,10,"SubmitFormWithBlob failed to send the request with exception "+cb.message),this.Fdb(null)}}Gjk(nb){return nb&&void 0!==nb.blob&&null!==nb.blob&&void 0!==nb.filename&&null!==nb.filename&&""!==nb.filename?void 0===window.self.FormData||null===window.self.FormData?(f.ULS.sendTraceTag(578380442,322,10,"FormData isn't supported"),!1):!0:(nb=nb?String.format("[isNull: false] [blobIsNullorEmpty: {0}] [filenameIsNullOrEmpty: {1}]",void 0===nb.blob||null===nb.blob,void 0===nb.filename||null===nb.filename||
""===nb.filename):"[isNull: true] [blobIsNullorEmpty: false] [filenameIsNullOrEmpty: false]",f.ULS.sendTraceTag(578380441,322,10,String.format("Content of the blob is empty {0}",nb)),!1)}Pra(){if(4===this.Kh.readyState)if(200===this.Kh.status){f.ULS.sendTraceTag(594888405,322,50,"UploadResponseReceived received a successful response. CorrelationId: {0}",this.zF);const nb=this.Kh.getResponseHeader("X-NewKey"),pb=this.Szi(this.Kh);let cb=!1;if(void 0!==nb&&null!==nb&&pb&&(cb=this.tjk(nb),!this.Y_c&&
cb)){f.ULS.sendTraceTag(594888404,322,50,"UploadResponseReceived resubmitting the upload request with a fresh canary. correlationId: {0}",this.zF);this.Y_c=!0;void 0!==this.FYb&&null!==this.FYb?this.vmg(this.FYb):this.wmg();return}f.ULS.sendTraceTag(594888403,322,50,"UploadResponseReceived processing the response [retried: {0}] [canaryInvalid: {1}] [gotNewCanary: {2}] [canaryRenewed: {3}] [CorrelationId: {4}]",this.Y_c,pb,!(void 0===nb||null===nb),cb,this.zF);this.Fdb(this.Kh.responseText)}else f.ULS.sendTraceTag(42874946,
322,15,"Upload request failed with status: {0} [isResponseNull: {1}] [correlationId: {2}]",this.Kh.status,this.Kh.responseText?!1:!0,this.zF),this.Fdb(null)}Szi(nb){try{const pb=ia.a(nb.responseText).Responses;if(void 0!==pb&&null!==pb&&1===pb.length){const cb=pb[0];if(void 0!==cb&&null!==cb&&2===cb.length&&28===cb[1].StatusCode)return!0}}catch(pb){}return!1}tjk(nb){xa.a.Vsg(nb);return I.AFrameworkApplication.canary!==nb?!1:!0}N7d(){this.Z_c||(this.Z_c=new Date)}dispose(){this.Nn||(this.Mta?this._parent.removeChild(this.ru):
(this._parent.removeChild(this.pp),K.a.removeHandler(this.pp,"load",this.gja),this.gja=null),this.wQc&&(K.a.removeHandler(this.ls,"change",this.wQc),this.wQc=null),this.C3e&&(this.cnb&&(K.a.removeHandler(this.ls,"change",this.cnb),this.cnb=null),this.EYb=null),this.ls=this.ru=this._parent=this.pp=null,this.Nn=!0,this.Z_c=null,f.ULS.sendTraceTag(25798094,322,50,"UploadFrame disposed"))}delayedDispose(){this.dispose()}Ooh(nb){if(this.ru){var pb;(pb=this.ru.querySelector("input[name=__REQUESTDIGEST]"))?
pb.value=nb:(pb=this.lbd(),pb.type="hidden",pb.id="__REQUESTDIGEST",pb.name="__REQUESTDIGEST",pb.value=nb,this.ru.appendChild(pb))}}lbd(){return this.Mta?document.createElement("input"):this.pp.contentWindow.document.createElement("input")}hLd(){try{if(!this.pp.contentWindow.document.body)return}catch(pb){this.Fni();return}if(!(this._initialized||this.ucb&&k.a.WG))this.Ofd();else if(!this.ucb||!k.a.WG||this.tEi){let pb;pb=k.a.Zw?this.pp.contentWindow.document.body.innerText:this.vvg?this.pp.contentWindow.document.body.firstChild.innerText:
this.pp.contentWindow.document.body.firstChild.innerHTML;var nb=this.pp.contentWindow.document.body.innerText.toLowerCase();const cb=0<=nb.indexOf("responses")||0<=nb.indexOf("wopisrc");nb=0<=nb.indexOf("http error");!cb&&nb&&f.ULS.sendTraceTag(42551183,322,15,"Couldn't obtain a valid response but the frame contains: "+this.pp.contentWindow.document.body.innerText);this.Fdb(pb)}}Ofd(){if(!this._initialized){var nb=this.ha("uploadForm");const pb=this.ha("fileInput"),cb=this.wOe();this.uoh();this.ru.id=
nb;this.ru.method="post";this.ru.encoding="multipart/form-data";this.ru.action=cb;this.ls.type="file";this.jae&&(this.ls.accept=this.jae,this.nce&&(this.ls.capture=this.nce));this.ls.id=pb;this.ls.name=pb;this.t0g&&(this.ls.multiple=!0);!this.C3e||k.a.Zw||k.a.TG||(this.cnb=Object(B.a)(this,this.XRh,"fileInputChangedHandleAccessibility"),K.a.addHandler(this.ls,"change",this.cnb),this.EYb=aa.a.xBe(this.ru,this.ls,"InputFileDescription"));this.qge&&(this.Mta||(nb=this.pp.contentWindow.document.body,
nb.style.margin="0",nb.style.overflow="hidden"),nb=I.AFrameworkApplication.sa,this.ls.style.fontFamily=nb.r3,this.ls.style.fontSize=nb.PIc,this.ls.style.margin="0");(nb=document.getElementById("__REQUESTDIGEST"))&&this.Ooh(nb.value);this.ru.appendChild(this.ls);this._initialized=!0;this.QIg(this)}}uoh(){if(this.Mta)this.ru=document.createElement("form"),this._parent.appendChild(this.ru),this.ls=document.createElement("input");else{this.ru=this.pp.contentWindow.document.createElement("form");const nb=
this.pp.contentWindow.document;nb.body.appendChild(this.ru);this.ls=nb.createElement("input")}}A1g(){this._parent.appendChild(this.pp);this.ucb&&k.a.WG&&this.Ofd()}wOe(){var nb=new ya.QueryStringBuilder(this.I3e);I.AFrameworkApplication.o1a(nb);this.VLj(nb);nb=nb.toString();if(k.a.Bg||k.a.WG||k.a.TG)nb=la.a.sgc(nb);return nb}lwe(){const nb=new ea.a(2,1,0,Object(B.a)(this,this.delayedDispose,"delayedDispose"),4);I.AFrameworkApplication.Xi.wg(nb)}}Object(r.a)(hb,"UploadFrame",null,[2]);var Ja=a(47),
Fa=a(119),Ba=a(19);class fa extends hb{constructor(nb,pb,cb,Da,zb,qb,Pa=!1,Nb=!1){super(nb,pb,cb,Da,zb,"UploadFrame",qb.ea.sessionId,"image/*",!1,null,Pa);this.$=qb;this.vvg=!0;this.Yzi=Nb;this.hnf()}ha(nb){return nb}VLj(nb){f.ULS.shipAssertTag(526399105,0,!!this.sessionId,"SessionId shouldn't be null.");Fa.a.h4c(nb,this.$.xa);nb.a5(w.a.sessionId,this.sessionId);var pb=Ba.h(this.$).ga;pb=Ja.o(pb.pa.U6,this.$);nb.a5(w.a.Ynj,this.$.ua.na.name);nb.a5(w.a.Xnj,pb.FirstRow.toString());nb.a5(w.a.Wnj,pb.FirstColumn.toString());
nb.a5(w.a.xwi,this.Yzi.toString())}Fni(){this.r8f("ServerUploadError")}Fdb(nb){this.r8f(nb)}static aCi(nb){return!nb||G.a.equals(nb,"ServerUploadError",!1)}}Object(r.a)(fa,"UploadFrameWrapper",hb,[]);class ta extends V{constructor(nb,pb,cb,Da){super(nb,!1);this.lW=null;this.fEa=!1;this.Bc=null;this.tuc=()=>{this.X6d("");this.dJc();return!1};this.$=pb;this.rKc=nb;this.vS=Ea.a.instance;this.fa=cb;this.Bc=Da;this.tfg();this.rud();this.$.Zb.Gz=!0}sfg(nb,pb){return new fa(nb,Object(B.a)(pb,pb.HLb,"onUploadFrameInitialized"),
Object(B.a)(pb,pb.Pra,"uploadResponseReceived"),this.fa,!0,this.$)}dispose(){this.dJc();this.vS=this.rKc=null;super.dispose()}hide(){super.hide();this.$.Zb.Gz=!1}validate(){var nb=this.rKc.v8d(this.Gk.wG.value,this.rKc.Mqg(this.Gk));return 0!==nb?(nb=this.rKc.Imd(nb).Description,this.X6d(nb),this.Q2d(),!1):!0}isEnabled(){return!0}X6d(nb){var pb;null===(pb=this.Bc)||void 0===pb?void 0:pb.sdg(this.lW,nb)}rud(){this.lW=document.getElementById("errorText");this.lW.style.display="inline-block";this.fEa=
!1;this.X6d("");this.TLa.style.maxWidth=this.TLa.currentStyle.minWidth}Q2d(){this.vS.ta(S.a.click,this.Gk.wG,this.tuc);this.vS.ta(S.a.Ic,this.Gk.wG,this.tuc);this.fEa=!0}dJc(){this.fEa&&(this.vS.Aa(S.a.click,this.Gk.wG,this.tuc),this.vS.Aa(S.a.Ic,this.Gk.wG,this.tuc),this.fEa=!1)}}Object(r.a)(ta,"InsertImageDialogWrapper",V,[]);var Oa=a(55),Ma=a(63),fb=a(40),pa=a(100),Ua=a(149),Sa=a(35);class Ia extends d.a{constructor(nb,pb,cb,Da,zb=!0){super(null,pb,cb);this.zla=this.DH=null;this.Wvd=this.Hab=!1;
this.QMd=null;this.Pra=qb=>{this.t9d.stop();this.u6b.cancel();if(fa.aCi(qb))this.aIc?this.Ihf(4):(qb=new h.a(0,2,null,null,!1,null,null,null),qb.status=8,this.v5d(new l.a(qb),null,"InsertPictureWebMethod")),f.ULS.sendTraceTag(526399121,0,50,`Http Error occurred, isTimeoutError: ${this.aIc}`);else{const Pa=Ia.Njk(qb);0!==Pa?(f.ULS.sendTraceTag(526399122,0,50,`Server returned error, response: ${qb}`),this.Ihf(Pa)):this.rni(qb)}this.gwc();this.dispose()};this.c5i=qb=>{this.dFa(qb,this.Gk)&&this.finalizeUpload(this.Gk,
null)};this.HLb=qb=>{f.ULS.sendTraceTag(526399120,0,50,"Upload frame initialized");this.Gk=qb;if(!this.y5a){if(this.V7d){if(this.uHe()||this.ucb&&k.a.WG){qb.tcc(this.c5i);return}const Pa=qb.tcc(null);if(!this.dFa(Pa,qb))return}this.finalizeUpload(qb,null)}};this.vdj=()=>{this.aIc=!0};this.Ub=nb;this.t9d=nb.yc.vh("WebServiceCall","InsertPictureOperation");this.u6b=y.a.instance.create(this.vdj,1E5,D.a.f5g,!1);this.aIc=!1;this.osc=this.$.xa.InsertPictureMaxFileSizeBytes;Da&&(this.Hab="TestOnly"in Da);
Da&&(this.Wvd="IsCellPicture"in Da);zb&&this.showDialog()}get $(){return this.Ub}get PUi(){return this.osc/1024/1024}dispose(){u.a.Ka(this.u6b);this.Gk&&this.Gk.lwe();this.Gk=this.u6b=this.Ub=null}Mrj(nb){if(!this.$)return f.ULS.sendTraceTag(526399119,0,50,"ReadPictureAsDataURLTask: EwaControl is null"),Ma.Task.Ua(!0);if(!this.$.oea)return Ma.Task.Ua(!0);const pb=new x.a,cb=new FileReader;nb=nb.wG.files[0];const Da=()=>{pb.ox(!0)};cb.onload=()=>{this.QMd=cb.result;pb.ox(!0)};cb.onerror=Da;cb.onabort=
Da;cb.readAsDataURL(nb);return pb.task}Mqg(nb){let pb=-1;nb=nb.wG;(null===nb||void 0===nb?0:nb.files)&&0<nb.files.length&&(pb=nb.files[0].size);return pb}v8d(nb,pb){let cb=Ia.clh(d.a.dFa(nb));0===cb?-1!==pb&&(f.ULS.sendTraceTag(526399118,0,50,`Validating picture, pictureSize: ${pb}, maxAllowedSize: ${this.osc}, remainingWorkbookSize: ${this.$.ea.Txf}`),pb>this.osc?cb=3:pb>this.$.ea.Txf&&(cb=7)):6===cb&&this.BSi(nb);f.ULS.sendTraceTag(526399117,0,50,`Validated file on client, validation result: ${cb}`);
return cb}dFa(nb,pb){nb=this.v8d(nb,this.Mqg(pb));return 0!==nb?(this.y5a||1===nb||this.B0d(nb),!1):!0}gqg(nb){nb.D3j()}Imd(nb){let pb=0,cb=1,Da=-1100324317,zb="InsertPictureUnknownError",qb=null;switch(nb){case 1:pb=1758;cb=0;Da=940870981;zb="InsertPictureNoFileSelected";break;case 3:cb=0;Da=1250467391;zb="InsertPicturePictureTooBig";qb=String.format(L.a.instance.Xb(181),this.PUi.toLocaleString());break;case 6:pb=1762;cb=0;Da=1380041209;zb="InsertPictureUnsupportedFormat";break;case 7:pb=1759;cb=
0;Da=-903115058;zb="InsertPictureExceedWorkbookSize";break;case 4:pb=1760;cb=0;Da=1218352119;zb="InsertPictureUploadTimeout";break;case 5:pb=1761,cb=0,Da=1979899005,zb="InsertPictureServiceNonDeterministicError"}nb=Ia.Wd(pb,cb,Da,zb);qb&&(nb.Description=qb);return nb}showDialog(){if(this.uHe())this.y5a=!1,this.Gk=new fa(this.$.domElement,this.HLb,this.Pra,this.fa,!1,this.$,!0,this.Wvd);else if(f.ULS.sendTraceTag(526399115,0,50,"Showing Insert Picture dialog"),!this.Hab&&(k.a.Dz||k.a.WG&&72>k.a.JJe))this.y5a=
!1,this.Gk=new fa(this.$.domElement,this.HLb,this.Pra,this.fa,!1,this.$);else{this.y5a=!0;const nb=Object(pa.d)(Ua.a.resolve(Sa.W,{Wa:0}));fb.TaskExtensions.za(nb,()=>{this.Gk=(new ta(this,this.$,this.fa,nb.result)).Gk},this.$.ka,3)}}rni(nb){let pb={};try{if(pb=m.a.ij(nb),Oa.b().VB(this.t9d.id,pb.ServerCorrelationId,"actions","ServerActions"),!H.a.ng(pb.Errors)&&pb.Result&&(this.$.ea.WY(pb.StateId,"BasePictureUploaderWrapper.UploadResponseReceived"),!this.Wvd)){const cb=pb.Result;M.a(this.$).d$(1,
cb);const Da=this.$.da.Ba(277);Da&&Da.Q1c(this.$,1,pb.Result,pb,"InsertPicture");f.ULS.sendTraceTag(526399114,0,50,"Insert picture completed successfully :)")}}catch(cb){f.ULS.sendTraceTag(526399113,0,50,`BasePictureUploaderWrapper.HandleSuccessCallback: got exception while try to JSON.Parse string length: ${nb?nb.length:-1}, errror: ${cb}`)}this.DIc(pb,null,"InsertPictureWebMethod")}Ihf(nb){nb=this.Imd(nb);const pb={};pb.Errors=[nb];this.DIc(pb,null,"InsertPictureWebMethod")}DIc(nb,pb,cb){this.DH(nb,
pb,cb)}v5d(nb,pb,cb){this.zla(nb,pb,cb)}B0d(nb){nb=this.Imd(nb);F.EwaSettings.Fz()?new z.a(this.$,nb):(new t.ErrorDialog(this.$,nb)).ah()}BSi(nb){const pb=this.$.xa.InsertPicturUnsupportedExtensionsForLogging;nb=v.a.Hl(nb);for(let cb=0;cb<pb.length;++cb)if(nb.endsWith(pb[cb])){f.ULS.sendTraceTag(526399112,0,50,`Insert picture blocked invalid extension: ${pb[cb]}`);break}}static Njk(nb){return!nb||G.a.equals(nb,w.a.insertPictureUnknownError,!0)?2:G.a.equals(nb,w.a.insertPictureNoFileSelectedError,
!0)?1:G.a.equals(nb,w.a.wwi,!0)?3:G.a.equals(nb,w.a.zwi,!0)?5:0}static Wd(nb,pb,cb,Da){return H.a.Wd(1,0,0,nb,pb,cb,Da)}static clh(nb){switch(nb){case 1:return 1;case 2:return 6}return 0}uHe(){return this.Hab||void 0===window.self.FormData||null===window.self.FormData?!1:!0}}Object(r.a)(Ia,"BasePictureUploaderWrapper",d.a,[2]);class X extends Ia{constructor(nb,pb,cb,Da,zb,qb=!0){super(nb,pb,cb,Da,!1);this.bSh=zb;this.$ec=nb.yc.vh("LoadResource","FileReaderUploaderLoadResource");qb&&this.showDialog()}ZXj(){this.osc=
28E5;this.B0d(3)}Tid(nb){f.ULS.sendTraceTag(526399111,0,50,"FileReaderUploaderWrapper.finalizeUploadImpl - Start function.");const pb=new FileReader;nb=nb.wG.files;if(0==nb.length)f.ULS.sendTraceTag(526399110,0,15,"FileReaderUploaderWrapper.finalizeUploadImpl - No image file found.");else{var cb=nb[0];pb.onload=()=>{this.$ec.stop();this.bSh.Scj(pb.result,this);f.ULS.sendTraceTag(526399109,0,50,`FileReaderUploaderWrapper.finalizeUploadImpl - End function. Type:${cb.type}, Size:${cb.size.toString()}`)};
pb.onerror=()=>{this.$ec.stop();f.ULS.sendTraceTag(526399108,0,10,`FileReaderUploaderWrapper.finalizeUploadImpl - Can't read image. Type:${cb.type}, Size:${cb.size.toString()}`)};pb.onabort=()=>{this.$ec.stop();f.ULS.sendTraceTag(526399107,0,10,`FileReaderUploaderWrapper.finalizeUploadImpl - Aborted read image. Type:${cb.type}, Size:${cb.size.toString()}`)};this.$ec.start();pb.readAsDataURL(cb)}}finalizeUpload(nb,pb){this.Tid(nb,pb)}}Object(r.a)(X,"FileReaderUploaderWrapper",Ia,[329]);var ca=a(382),
U=a(201);class ma{constructor(nb,pb){this.dataUri=this.sheetName=null;this.sheetName=nb;this.dataUri=pb}getSheetName(){return this.sheetName}}Object(r.a)(ma,"MacroRecorderPictureInsertedPayload",null,[144]);class ra extends Ia{constructor(nb,pb,cb,Da,zb,qb=!0){super(nb,cb,Da,zb,!1);this.je=pb;qb&&this.showDialog()}Tid(nb,pb){super.finalizeUpload(nb,pb);ca.a(this.$.userOperationManager,(cb,Da)=>{this.DH=cb;this.zla=Da;this.t9d.start();this.u6b.ir();this.aIc=!1;this.gqg(nb);return this.Mrj(nb)},cb=>
{const Da={};this.$.Qk(Da);const zb=Da.SheetName;cb=new U.a(510,0,cb,72,()=>new ma(zb,this.QMd?this.QMd:""));cb.EDa(()=>!0);cb.je=this.je;return cb},this.je)}finalizeUpload(nb,pb){this.Tid(nb,pb)}}Object(r.a)(ra,"PictureUploaderWrapper",Ia,[]);class Va{constructor(nb,pb){this.filename=nb;this.blob=pb}}Object(r.a)(Va,"UploadBlobParameters",null,[]);class ob extends ra{constructor(nb,pb,cb,Da,zb,qb,Pa){super(nb,pb,cb,Da,zb,!1);this.V7d=!1;this.mK=Pa;this.glc=ob.fYh(qb);nb=this.v8d(this.glc.name,this.glc.size);
0!==nb?(this.B0d(nb),this.mK.setException(Error.create("DataUrlUploaderWrapper: Invlid data url")),this.dispose()):this.Gk=new fa(this.$.domElement,this.HLb,this.Pra,Da,!1,this.$)}v5d(nb,pb,cb){super.v5d(nb,pb,cb);this.mK.setException(Error.create("DataUrlUploaderWrapper.TriggerFailedCallback: File upload request failed"))}DIc(nb,pb,cb){super.DIc(nb,pb,cb);H.a.ng(nb.Errors)?this.mK.setException(Error.create(`DataUrlUploaderWrapper.TriggerSuccessCallback: File upload request returned with errors: ${H.a.Uc(nb.Errors)}`)):
this.mK.setResult(!0)}gqg(nb){const pb=new Va(this.glc.name,this.glc);nb.vmg(pb)}static fYh(nb){var pb=nb.split(",");nb=pb[0].includes("base64")?window.self.atob(pb[1]):window.self.decodeURI(pb[1]);pb=pb[0].split(":")[1].split(";")[0];const cb=new Uint8Array(nb.length);for(let Da=0;Da<nb.length;Da++)cb[Da]=nb.charCodeAt(Da);nb=new Blob([cb],{type:pb});nb.name="Image.png";return nb}}Object(r.a)(ob,"DataUrlUploaderWrapper",ra,[]);let ja=class{constructor(){}fvi(nb,pb,cb,Da,zb){-2060689045===pb.command&&
(zb.IsCellPicture=!0);new ra(nb,pb,cb,Da,zb,!0)}eui(nb,pb,cb,Da,zb,qb){new ob(nb,null,pb,cb,Da,zb,qb)}pui(nb,pb,cb,Da,zb){new X(nb,pb,cb,Da,zb,!0)}};ja=Object(e.b)([Object(Ua.d)(Sa.Ib)],ja);Object(r.a)(ja,"UploaderCreator",null,[284]);class lb extends b.a{constructor(nb){super();this.$=nb;this.uc()}static la(nb){nb.da.Ja(485,new lb(nb))}create(){var nb;this.$b(null!==(nb=this.$.da.Ba(484))&&void 0!==nb?nb:this.$.da.Ja(484,new ja))}}Object(r.a)(lb,"UploaderCreatorFactory",b.a,[]);var wb=a(72);a.d(C,
"a",function(){return Ab});const Ab=()=>{c.a.Fa(nb=>{Object(wb.b)("OfficeVSO:7625189_MoveUploaderCreatorToNewServiceInfra")||lb.la(nb)})}},1220:function(r,C,a){r=a(0);var c=a(88),b=a(563),e=a(15);class f{constructor(){this.sMc={}}KRg(xa){this.sMc[xa.id.toString()]=xa}FZi(xa){const wa=this.sMc;for(let hb in wa)wa[hb].notify(xa,!1);this.sMc={}}eoj(xa,wa){wa&&this.KRg(wa);return this.DQf(xa,wa)}sfd(xa){this.FZi(xa)}cXe(xa,wa){xa.notify(wa,!0)}}Object(r.a)(f,"AEventEmitter",null,[282]);var d;(function(xa){xa[xa.notStarted=
0]="notStarted";xa[xa.waiting=1]="waiting";xa[xa.shouldRetry=2]="shouldRetry";xa[xa.complete=3]="complete"})(d||(d={}));Object(r.b)("EventResultState",d);class h{constructor(){this._state=0}get state(){return this._state}set state(xa){e.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",{["OldState"]:d[this._state],["NewState"]:d[xa]},"ResultType",this.Udf());this._state=xa}}Object(r.a)(h,"AEventResult",null,[327]);class l extends h{constructor(){super();this.UZc=this.zpb=null;this.state=
0;this.ISc=this.Vhe=!1}get kT(){return this.zpb}get bra(){return this.UZc}get Swi(){return this.Vhe}Udf(){return"GetMoreInfo Result"}}Object(r.a)(l,"GetMoreInfoResult",h,[328,327]);var k=a(6),u=a(64),v=a(41),x=a(716),w=a(384),m=a(179),t=a(666),z=a(588),y=a(111),D=a(27);class H{constructor(xa,wa,hb,Ja,Fa,Ba,fa,ta){this.Na=xa;this.Ah=wa;this.rDg=hb;this.N3=Ja;this.Me=Fa;this.kRc=Ba;this.eIg=fa;this.m2b=ta}Ktj(){this.Acb.Hc(D.a.openUrlInNewTab,y.a.frame,Object(c.a)(this,this.openUrlInNewTab,"openUrlInNewTab"));
this.Acb.Hc(D.a.QSa,y.a.frame,Object(c.a)(this,this.QSa,"openDocumentUrl"));k.AFrameworkApplication.ZN?this.EAf():this.Acb.pf(D.a.Dcc,y.a.frame,Object(c.a)(this,this.Dcc,"documentLoaded"),96)}openUrlInNewTab(xa,wa,hb,Ja,Fa){Fa&&Fa.MenuItemId&&(e.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{["Id"]:Fa.SourceControlId,["AppType"]:z.a[this.VO]}),v.a.Vf(Fa.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32}QSa(xa,wa,hb,Ja,Fa){if(Fa&&Fa.MenuItemId){const Ba=
k.AFrameworkApplication.fa.ra("WacInTabOpenMRUIsEnabledForUiHost"),fa=k.AFrameworkApplication.fa.ra("UiHostSupportsDocRebootFeatures");e.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",Ba,fa);if(Ba&&fa){e.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:Fa.SourceControlId,["AppType"]:z.a[this.VO]});xa=Fa.MenuItemId.toString();const ta={};ta[w.a.RTa]="1";ta[w.a.documentUrl]=xa;ta[w.a.reason]=t.a.open;e.ULS.sendTraceTag(592237460,
202,50,"Send PostMessage to the Ui host to reboot a document");k.AFrameworkApplication.oS().execute(Oa=>{Oa.sendMessage(m.a.$_,ta)})}else this.openUrlInNewTab(xa,wa,hb,Ja,Fa)}return 32}Dcc(){this.EAf();return 32}vRa(xa,wa,hb=""){if(wa&&wa.NG){const Ja=x.a[wa.status];wa=wa.NG.getTime();const Fa=this.Sx()-wa;e.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",{["Caller"]:xa,["RequestStatus"]:Ja,["ElapsedMs"]:Fa,["StartTime"]:wa,["Notes"]:hb})}else e.ULS.sendTraceTag(5849680,202,
50,"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:xa})}EAf(){var xa=k.AFrameworkApplication.fa.ra("QPGVCI"),wa=u.a.Uw(document.URL,"wdNewAndOpenCt",xa);if(wa){wa=parseInt(wa);var hb=u.a.Uw(document.URL,"wdPreviousSession",xa);xa=u.a.Uw(document.URL,"wdPreviousCorrelation",xa);var Ja=k.AFrameworkApplication.fa.ra("NAOPLP");if(k.AFrameworkApplication.ZN){var Fa=k.AFrameworkApplication.ZN.getTime();!wa||wa>Fa?e.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",
{["ClickTimestamp"]:wa,["DocumentLoadedTime"]:Fa,["SessionId"]:hb,["Correlation"]:xa}):e.ULS.sendTraceTag(5849683,202,Ja?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{["ClickToLoadTime"]:Fa-wa,["ClickTimestamp"]:wa,["SessionId"]:hb,["Correlation"]:xa})}else e.ULS.sendTraceTag(5849681,202,Ja?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",{["ClickTimestamp"]:wa,["SessionId"]:hb,["Correlation"]:xa})}}get Acb(){return this.Na.value}get GJb(){return this.Ah.value}get eGf(){return this.rDg.value}get VO(){return this.N3.value}get ptc(){return this.Me.value}get Sx(){return this.kRc}get L1(){return this.eIg.value}get supportsGetMoreInfoForPersonalStorage(){return this.m2b.value}static get instance(){return H.Oa||
(H.Oa=H.iO())}static iO(){return new H(new b.a(()=>k.AFrameworkApplication.dc),new b.a(()=>k.AFrameworkApplication.qe),new b.a(()=>k.AFrameworkApplication.sa),new b.a(()=>k.AFrameworkApplication.sa.Qa.li),new b.a(()=>k.AFrameworkApplication.Xi),()=>(new Date).getTime(),new b.a(()=>k.AFrameworkApplication.sa.Qa.L1),new b.a(()=>k.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage))}}H.Oa=null;Object(r.a)(H,"NewAndOpenCommonHelpers",null,[281]);var F=a(112);class G{constructor(xa,wa,hb){this.w1b=
this.Sj=null;this.dYc=0;this.XNg=xa;this.Me=wa;this.gee=hb}H_g(){this.dYc=this.Ggb+1}yUd(xa){this.Sj&&(this.Me.jq(this.Sj),this.Sj=null);xa&&(this.dYc=0)}b2j(xa){const wa=this.u7j;0<=wa?(this.H_g(),this.yUd(!1),this.Sj=new F.a(4,1,wa,xa,107),this.Me.wg(this.Sj)):(this.yUd(!0),e.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.gee}))}get Ggb(){return this.dYc}get u7j(){return this.Ggb>=this.$bg.length?-1:this.$bg[this.Ggb]}get $bg(){if(!this.w1b){const xa=(this.XNg.value||"0").split(",");
this.w1b=[];for(let wa=0;wa<xa.length;wa++){const hb=parseInt(xa[wa]);isNaN(hb)?e.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",{["Action"]:this.gee,["Entry"]:xa[wa]}):Array.add(this.w1b,hb)}}return this.w1b}}Object(r.a)(G,"RetryHelper",null,[]);var L=a(43),M=a(32);class O extends f{constructor(xa,wa){super();this.t4=xa;this.Ypb=new G(wa,this.jJb.ptc,"GetMoreInfo");this.Zp=new l}PTi(){this.TEd("Document opened")}vph(xa){return()=>{this.TEd(xa,!0)}}DQf(xa,wa=
null){e.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{["Trigger"]:xa});3===this.Zp.state?(wa&&this.cXe(wa,this.Zp),e.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:xa})):this.TEd(xa);return this.Zp}TEd(xa,wa=!1){this.Ypb.yUd(!wa);1===this.Zp.state?e.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:xa,["RetryIndex"]:this.Ypb.Ggb}):(e.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",
{["Trigger"]:xa,["RetryIndex"]:this.Ypb.Ggb}),this.Zp.state=1,wa=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.jJb.L1,k.AFrameworkApplication.oj),this.jJb.GJb.tba(wa,1,null,null,[O.noe,O.lse],!1,5,this.Boh(),this.Aoh(xa),null))}Boh(){return xa=>{var wa=!1;let hb=!1;var Ja=!1,Fa;k.AFrameworkApplication.fa.ra("GetMoreInfoDataFromResponseBody")&&(xa.data.Pe?({Bt:Fa}=L.d(xa.data.Pe)).returnValue?Fa?(Ja=!0,this.Zp.UZc=Fa.StorageServiceDisplayName,this.Zp.zpb=O.$vf(Fa.PersonalFileStorageUrl)?Fa.PersonalFileStorageUrl:
"",""===this.Zp.kT&&"SharePointOnlineConsumer"===k.AFrameworkApplication.fa.Va("FileSource")&&(this.Zp.zpb=u.a.s2(k.AFrameworkApplication.breadcrumbFolderUrl)),wa=""===this.Zp.kT&&""!==this.Zp.bra):e.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):e.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers"):e.ULS.sendTraceTag(25298083,
202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers"));Ja||((Fa=xa.data.responseHeaders)?(this.Zp.UZc=(Fa[O.lse]||"").toString(),wa=(Fa[O.noe]||"").toString(),this.Zp.zpb=O.$vf(wa)?wa:"",""===this.Zp.kT&&"SharePointOnlineConsumer"===k.AFrameworkApplication.fa.Va("FileSource")?(this.Zp.zpb=u.a.s2(k.AFrameworkApplication.breadcrumbFolderUrl),wa=""===this.Zp.kT&&""!==this.Zp.bra):wa=""===wa&&""!==this.Zp.bra):(e.ULS.sendTraceTag(5849622,202,
50,"Null response headers received."),hb=!0));Ja=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",this.Ypb.Ggb,hb,wa,Ja);this.jJb.vRa("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",xa.data,Ja);this.qcg(3,wa,hb)}}Aoh(xa){return wa=>{this.jJb.vRa("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",wa.data,"Failure");this.qcg(2);this.Ypb.b2j(this.vph(xa))}}qcg(xa,wa=!1,hb=!1){this.Zp.state=xa;this.Zp.Vhe=
wa;this.Zp.ISc=hb;this.sfd(this.Zp)}get jJb(){return this.t4.value}static get instance(){return O.Oa||(O.Oa=O.iO())}static iO(){return new O(new b.a(()=>H.instance),new b.a(()=>k.AFrameworkApplication.r$h))}static $vf(xa){if(!xa)return e.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(M.a.Hl(xa).startsWith("https://"))return!0;e.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1}}O.noe="PersonalFileStorageUrl";O.lse=
"StorageServiceDisplayName";O.Oa=null;Object(r.a)(O,"GetMoreInfoActor",f,[]);var B=a(108),E=a(105);class I{constructor(xa,wa,hb,Ja,Fa){this.KIg=6E4;this.dmf="inactive";this.fve="active";this.DU=!0;this.Me=xa;this.LHg=wa;this.kRc=hb;this.D2b=Ja;this.$a=new E.a;Fa&&this.U1j();this.$je=this.qbf()}Vve(xa){this.$a.addHandler(this.fve,xa)}iUg(xa){this.$a.addHandler(this.dmf,xa)}U1j(){const xa=new F.a(5,2,this.KIg,Object(c.a)(this,this.Ori,"inactiveLoop"),108);this.Pri.wg(xa)}Ori(){const xa=this.qbf(),wa=
this.Sx()-xa;wa>this.YHc&&this.DU&&(e.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:wa}),this.DU=!1,this.$a.raiseEvent(this.dmf));xa-this.$je>this.YHc&&(this.DU=!0,this.$a.raiseEvent(this.fve));this.$je=xa}get Pri(){return this.Me.value}get qbf(){return this.LHg}get Sx(){return this.kRc}get YHc(){return this.D2b.value}static get instance(){return I.Oa||(I.Oa=I.iO())}static iO(){return new I(new b.a(()=>B.a.instance),()=>k.AFrameworkApplication.OBd.getTime(),()=>
(new Date).getTime(),new b.a(()=>k.AFrameworkApplication.YHc),!0)}}I.Oa=null;Object(r.a)(I,"InactivityManager",null,[]);var S=a(126),J=a(960);class K extends h{constructor(){super();this.lme=this.nme=this.mme=null;this.state=this.ete=0;this.ISc=!1}get rGd(){return this.mme}get qFf(){return this.nme}get qGd(){return this.lme}get A7j(){return this.ete}Udf(){return"MruActor Result"}}Object(r.a)(K,"MruResult",h,[326,327]);var R=a(251);class Z{constructor(xa,wa,hb){this.task=null;this.Alc=xa;this.xVi=
wa;this.taskManager=hb;this.retryCount=this.bEb=0;this.qXc=this.tHb=null}NFi(xa,wa){return xa===R.a.$jd||20===wa||18===wa||3===wa}eHi(xa){return 3===xa||5===xa||6===xa||7===xa||9===xa||10===xa||11===xa||12===xa||13===xa||14===xa||15===xa||16===xa||23===xa||26===xa||27===xa||28===xa}get Zxc(){return this.qXc}reset(){this.bEb=this.retryCount=0;this.qXc=this.tHb=null;this.task&&(this.taskManager.jq(this.task),this.task=null)}Xvi(xa,wa,hb,Ja){this.qXc=String.format("{0}_{1}",hb,Ja);if(this.retryCount>=
this.xVi)return e.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.NFi(hb,Ja))return e.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.eHi(Ja)&&1<=this.bEb)return this.tHb=hb,!1;wa=Math.max(wa,this.Alc*Math.pow(2,this.bEb));if(26===Ja)wa=Math.max(wa,3E4);else if(27===Ja||28===Ja)wa=Math.max(wa,6E4);9===Ja||412===hb&&(null==this.tHb||412!==this.tHb)?wa=500:this.bEb+=1;this.tHb=hb;this.retryCount+=1;this.task&&this.taskManager.jq(this.task);
e.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",wa);this.task=new F.a(2,1,wa,xa,107);this.taskManager.wg(this.task);return!0}}Object(r.a)(Z,"RetryManager",null,[]);var P=a(103),V=a(148),Ea=a(140);class oa{constructor(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}}Object(r.a)(oa,"WriteOptions",null,[]);var ea=a(569),aa=a(184);class ia extends f{constructor(xa,wa,hb,Ja,Fa,Ba,fa){super();this.t4=xa;this.FKg=wa;this.$ta=new Z(k.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",
5E3),k.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),this.$E.ptc);this.Dua=new Z(k.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),k.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.$E.ptc);this.XMg=hb;this.Bue=Ja;this.fRg={};this.GU=new K;this.HHg=Fa;this.I_b="";this.vx=Ba;this.jfe=fa}get zLc(){return this.fRg}Hvj(){this.$E.Acb.Hc(D.a.renameMostRecentlyUsedFileEntry,
y.a.frame,Object(c.a)(this,this.CAj,"renameMruEntry"))}CAj(){return this.P9d("Rename")}ZTi(){this.qDf("File Opened")}$Ti(){this.qDf("IntervalUpdate")}qDf(xa){e.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",{["Trigger"]:xa});this.P9d(xa)}Z6(xa){(xa=M.a.Z6(xa))&&xa.startsWith(".")&&(xa=xa.substring(1,xa.length));return xa}c8e(){switch(this.$E.VO){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}}fii(xa){var wa=
this.HHg();if(!wa)return null;const hb=new oa;hb.documentUrl=this.jfe.value?encodeURI(wa):wa;hb.mruItemId=this.I_b;hb.app=this.c8e();if(wa=this.vx())hb.folderName=wa.breadcrumbFolderName,wa=wa.so,hb.documentName=M.a.Sq(wa),hb.documentExt=this.Z6(wa);xa&&(hb.documentName?hb.documentName.length?255<=hb.documentName.length?xa.set("DocumentNameLength","Long"):2084<=hb.documentName.length&&xa.set("DocumentNameLength","VeryLong"):xa.set("DocumentNameLength","0"):xa.set("DocumentNameLength","Null"));return JSON.stringify(hb)}P9d(xa,
wa=!1){if(4===this.$E.VO&&!k.AFrameworkApplication.Pwa)return 2;var hb=V.a.zt();hb&&(hb.set("Trigger",xa),hb.set("IsRetry",wa?"true":"false"),hb.set("MruIdSent",this.I_b?"true":"false"),hb.set("URLEncoded",this.jfe.value?"true":"false"));P.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",hb);xa=this.fii(hb);if(!xa)return wa=!k.AFrameworkApplication.webEditingEnabled,hb&&(hb.set("WebEditingIsEnabled",k.AFrameworkApplication.webEditingEnabled?"true":"false"),hb.set("ProtectedFile",k.AFrameworkApplication.kyc?
"true":"false")),P.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",wa,!1,Object.assign(new aa.a,{extendedProperties:hb})),2;this.Dua&&!wa&&this.Dua.reset();hb=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.$E.L1,this.localeName);this.Bue?this.zLc["X-FileId"]=k.AFrameworkApplication.oj:hb+=String.format("&{0}",k.AFrameworkApplication.oj);k.AFrameworkApplication.Yc&&(this.zLc["X-Office-AudienceGroup"]=Object(S.a)(String,k.AFrameworkApplication.Yc.AudienceGroup)||"");this.zLc["X-Timeout"]=
15E3;return this.$E.GJb.Sn(hb,2,xa,this.zLc,!0,5,Object(c.a)(this,this.lmk,"writeMruV2EntryOnServerSuccessCallback"),Object(c.a)(this,this.gth,"createWriteMruV2EntryOnServerFailureCallback"),null,void 0,void 0,void 0,void 0,"4")}lmk(xa){this.nif(xa.data)}nif(xa){const wa=V.a.zt();this.Dua&&(wa&&this.Dua.Zxc&&(wa.set("LastError",this.Dua.Zxc),wa.set("NumRetries",this.Dua.retryCount.toString())),this.Dua.reset());const hb=J.c(xa.Pe);hb&&hb.diagnostics_data&&(this.I_b=hb.diagnostics_data.mru_id);xa=
+xa.R5-+xa.NG;wa&&wa.set("RequestDuration",xa.toString());P.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new aa.a,{extendedProperties:wa}))}gth(xa){if(xa.data.httpStatus===R.a.Qwb)this.nif(xa.data);else{var wa=xa.data.httpStatus===R.a.OMb,hb=V.a.zt();this.zif(this.Dua,xa,this.Tsh(),hb);hb&&(hb.set("StatusCode",xa.data.httpStatus.toString()),wa||this.H1c(xa.data,hb));P.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",xa.data.httpStatus),wa,!1,Object.assign(new aa.a,
{extendedProperties:hb}))}}Tsh(){return()=>{this.P9d("Retry",!0)}}x$h(){this.fsc("Polling")}w$h(){this.fsc("Retry",!0)}RTi(){this.fsc("Open")}QTi(){this.fsc("Activity")}fsc(xa,wa=!1){e.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:xa});const hb=V.a.zt();hb&&(hb.set("Trigger",xa),hb.set("IsRetry",wa?"true":"false"));P.Health.instance.recordKpiUsage("GetMru",0,"smartfio",hb);this.$ta&&!wa&&this.$ta.reset();this.Coh(Object(c.a)(this,this.z$h,"getMruV2FromServerSuccessCallback"),
Object(c.a)(this,this.v$h,"getMruFromServerFailureCallback"))}H1c(xa,wa){xa&&xa.responseHeaders&&(xa=xa.responseHeaders["X-CorrelationId"])&&wa.set("ServerCorrelationId",xa)}EQi(xa,wa){xa&&(wa&&wa.set("RequestDuration",(+xa.R5-+xa.NG).toString()),P.Health.instance.recordKpiSuccess("GetMru",Object.assign(new aa.a,{extendedProperties:wa})))}z$h(xa){this.A$h(xa)}A$h(xa){var wa="";let hb=null,Ja=null,Fa=null;const Ba=J.c(xa.data.Pe);Ba&&(hb=Ba.places?Ba.places.items:[],Ja=Ba.documents?Ba.documents.items:
[],(Fa=J.a(Ba,!1))&&(wa=L.c(Fa)));k.AFrameworkApplication.sa&&k.AFrameworkApplication.sa.Qa.k1&&Ea.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(wa,!0));wa=V.a.zt();this.$ta&&(wa&&this.$ta.Zxc&&(wa.set("LastError",this.$ta.Zxc),wa.set("NumRetries",this.$ta.retryCount.toString())),this.$ta.reset());Fa||hb||Ja?(this.$E.vRa("MruActor.GetMruV2FromServerSuccessCallback",xa.data,"Success"),this.$Jc(3,Fa,hb,Ja),this.EQi(xa.data,wa)):(this.$E.vRa("MruActor.GetMruV2FromServerSuccessCallback",
xa.data,"Failure: Invalid JSON"),wa&&this.H1c(xa.data,wa),P.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new aa.a,{extendedProperties:wa})),this.$Jc(3,null,null,null,!0));this.sfd(this.GU)}zif(xa,wa,hb,Ja){let Fa=0,Ba=0;const fa=J.c(wa.data.Pe);fa&&(null!=fa.response_code&&(Fa=fa.response_code,Ja&&Ja.set("MruResponseCode",Fa.toString()),9===Fa&&(this.I_b="")),fa.error_data&&null!=fa.error_data.retry_after_ms&&(Ba=fa.error_data.retry_after_ms,Ja&&Ja.set("ExpectedRetryAfter",
Ba.toString())));xa&&(wa=xa.Xvi(hb,Ba,wa.data.httpStatus,Fa),Ja&&(Ja.set("CurrentRetryCount",xa.retryCount.toString()),Ja.set("RetryScheduled",wa?"true":"false")))}v$h(xa){this.y$h(xa)}y$h(xa){const wa=xa.data.httpStatus===R.a.OMb,hb=V.a.zt();hb&&(hb.set("StatusCode",xa.data.httpStatus.toString()),wa||this.H1c(xa.data,hb));this.$E.vRa("MruActor.GetMruFromServerFailureCallback",xa.data,"Failure");this.$Jc(2);this.zif(this.$ta,xa,Object(c.a)(this,this.w$h,"getMruFromServerRetryTask"),hb);P.Health.instance.recordKpiFailure("GetMru",
String.format("RequestFailed_{0}",xa.data.httpStatus),wa,!1,Object.assign(new aa.a,{extendedProperties:hb}));this.sfd(this.GU);k.AFrameworkApplication.sa&&k.AFrameworkApplication.sa.Qa.k1&&Ea.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)))}$Jc(xa,wa=null,hb=null,Ja=null,Fa=!1){if(3!==this.GU.state||3===xa)this.GU.mme=wa,this.GU.nme=hb,this.GU.lme=Ja,this.GU.state=xa,this.GU.ISc=Fa,this.GU.ete=this.$E.Sx()}DQf(xa,
wa){e.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{["Trigger"]:xa,["ResultState"]:this.GU.state});wa&&3===this.GU.state&&this.cXe(wa,this.GU);return this.GU}Coh(xa,wa){this.$Jc(1);let hb;const Ja={};hb=String.format(this.$E.L1+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.c8e(),this.localeName);this.XMg.value||(hb+="&entity=docs");k.AFrameworkApplication.Yc&&(Ja["X-Office-AudienceGroup"]=Object(S.a)(String,k.AFrameworkApplication.Yc.AudienceGroup)||"");this.Bue?
Ja["X-FileId"]=k.AFrameworkApplication.oj:hb+=String.format("&{0}",k.AFrameworkApplication.oj);this.$E.GJb.Sn(hb,1,null,Ja,!0,5,xa,wa,null)}get $E(){return this.t4.value}get localeName(){return this.FKg.value}static get instance(){return ia.Oa||(ia.Oa=ia.iO())}static iO(){return new ia(new b.a(()=>H.instance),new b.a(()=>ea.a.KL(k.AFrameworkApplication.lcid).name),new b.a(()=>k.AFrameworkApplication.sa.Qa.$w),k.AFrameworkApplication.fa.ra("MruWriteFileIdInHeader"),()=>k.AFrameworkApplication.sa.Qa.Is,
()=>k.AFrameworkApplication.zn,new b.a(()=>k.AFrameworkApplication.fa.ra("OICEncodeUrlIsEnabled")))}}ia.Oa=null;Object(r.a)(ia,"MruActor",f,[]);class ya{constructor(){this.$qb=this.npe=this.Nb=null;this.Nn=!1}get name(){return"Common.App.NewAndOpen.Core"}Oi(xa){this.Nb=xa;xa.register(281,"Common.INewAndOpenCommonHelpers").gd().od(()=>H.instance);xa.register(282,"Common.IEventEmitter<Common.IGetMoreInfoResult>").gd().od(()=>O.instance);xa.register(282,"Common.IEventEmitter<Common.IMruResult>").gd().od(()=>
ia.instance)}init(){k.AFrameworkApplication.fa.Rv(()=>{this.MDb()})}MDb(){this.Nb.resolve("Common.INewAndOpenCommonHelpers");this.Nb.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.Nb.resolve("Common.IEventEmitter<Common.IMruResult>");var xa=!1;H.instance.Ktj();k.AFrameworkApplication.Goa&&(xa=!0);k.AFrameworkApplication.E0f&&(ia.instance.RTi(),0<k.AFrameworkApplication.rFf&&this.zwe(),this.wSj(),xa=!0);k.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage&&xa&&O.instance.PTi();
k.AFrameworkApplication.Jfk&&(xa=ia.instance,xa.Hvj(),xa.ZTi(),B.a.instance.wg(this.Kfk))}wSj(){I.instance.Vve(Object(c.a)(ia.instance,ia.instance.QTi,"makeGetMruRequestActivityTrigger"));I.instance.Vve(Object(c.a)(this,this.zwe,"addGetMruFromServerTask"));I.instance.iUg(Object(c.a)(this,this.dwh,"deleteGetMruFromServerTask"))}dwh(){B.a.instance.jq(this.sFf)}zwe(){B.a.instance.wg(this.sFf)}get sFf(){return this.npe||(this.npe=new F.a(5,2,k.AFrameworkApplication.rFf,Object(c.a)(ia.instance,ia.instance.x$h,
"getMruFromServerTask"),109))}get Kfk(){return this.$qb||(this.$qb=new F.a(2,2,6E4*k.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(c.a)(ia.instance,ia.instance.$Ti,"makeUpdateMruTask"),197))}dispose(){this.Nn||(this.Nn=!0,this.$qb&&(B.a.instance.jq(this.$qb),this.$qb=null))}}Object(r.a)(ya,"CorePackageManager",null,[4,5,2]);var za=a(261);a.d(C,"a",function(){return la});const la=()=>{Type.registerNamespace("Common.App.NewAndOpen.Core");
za.a.instance.wj(new ya)}},1237:function(r,C,a){var c=a(10);r=a(0);var b=a(724),e=a(172),f=a(108),d=a(6),h=a(30),l=a(199),k=a(15),u=a(1433),v=a(32),x=a(103),w=a(84),m=a(569),t=a(173),z=a(47),y=a(382),D=a(201),H=a(323),F=a(34),G=a(231),L=a(12),M=a(16),O=a(248),B=a(109),E=a(19),I=a(156),S=a(175),J=a(93),K=a(102),R=a(179),Z=a(193),P;(function(ra){ra[ra.unknown=0]="unknown";ra[ra.bing=1]="bing";ra[ra.M365=2]="M365"})(P||(P={}));Object(r.b)("InsertMediaProviders",P);var V=a(95),Ea=a(167),oa=a(356),ea=
a(1),aa=a(894),ia=a(64);class ya extends aa.a{constructor(ra,Va){super(ra,ia.a.ML(Va))}TNb(ra,Va){this.isEnabled()&&this.$Q(this.targetOrigin)&&(this.wn(ra),this.ql(ra,Va))}}Object(r.a)(ya,"InsertMediaCrossDocumentMessenger",aa.a,[336,250,2]);var za=a(2);class la{}Object(r.a)(la,"OnlineMediaSearchResult",null,[]);var xa=a(325),wa=a(860),hb=a(355),Ja;(function(ra){ra[ra.OK=0]="OK";ra[ra.cancel=1]="cancel";ra[ra.error=2]="error";ra[ra.open=3]="open"})(Ja||(Ja={}));Object(r.b)("HubbleAction",Ja);var Fa=
a(70);class Ba extends I.a{constructor(ra,Va,ob,ja,lb,wb){super();this.Cnc=!1;this.correlationId=this.mCd=this.VC=this.mza=null;this.U1i=()=>{this.txa(this.$2a);this.WCc(1)};this.dBd=Ab=>{Ab.keyCode===Sys.UI.Key.tab&&("KeepFocusDiv"!==Ab.target.id||Ab.shiftKey?"KeepFocusStartDiv"===Ab.target.id&&Ab.shiftKey&&(Ab.preventDefault(),document.getElementById("KeepFocusDiv").focus()):(Ab.preventDefault(),document.getElementById("KeepFocusStartDiv").focus()))};this.d9i=()=>{this.Usb&&(this.Usb.launchUpsellExperience("stockimages"),
k.ULS.sendTraceTag(537155807,0,50,"OnLaunchM365Upsell: Launched Dime Upsell flow"))};this.B$i=Ab=>{Ab&&Ab.Values&&(Ab=Ab.Values,delete Ab.m_Origin,delete Ab.m_Source,delete Ab.m_ReceivedTime,k.ULS.sendTraceTag(508953229,0,50,"Received OTel event: "+Ab.eventName||!1),S.a.sendOtelEvent(Object.assign(new wa.a,{otelEvent:Ab})))};this.Bl=wb;this.$=ra;this.unf=Va;this.Usb=ob;this.f$=[];this.gcb=ja;this.Mxh=lb;this.vAe=this.$.xa.InsertOnlinePictureMaxCountOfImagesToInsert;this.Qg=this.aph()}xYj(ra){this.Cnc=
!1;this.showDialog(this.Bl,null);this.mza=document.getElementById(this.Hi("InsertMediaFrame"));if(!this.mza)throw this.txa(this.$2a),Error.invalidOperation("Couldn't get InsertMediaIframe.");var Va=document.getElementById(this.Hi("WACDialogPanel"));Va&&Va.setAttribute(J.a.te,J.a.ptb);Va=document.createElement("div");Va.id="KeepFocusStartDiv";Va.tabIndex=0;Va.className="keep-focus-start";this.mza.parentNode.insertBefore(Va,this.mza.parentNode.firstChild);Va=document.createElement("div");Va.id="KeepFocusDiv";
Va.tabIndex=0;Va.className="keep-focus";this.correlationId=t.a.create();this.mza.parentNode.appendChild(Va);$addHandler(this.TLa,"keydown",this.dBd);this.mza.src=this.unf;this.mza.frameBorder="0";Va=document.getElementById(this.Hi("WACDialogButtonPanel"));if(!Va)throw Error.invalidOperation("Couldn't get WACDialogButtonPanel.");Va.className="display-none";Va=document.getElementById(this.Hi("WACDialogTitleText"));if(!Va)throw Error.invalidOperation("Couldn't get WACDialogTitleText.");Va.className=
"display-none";2===this.gcb&&(document.getElementById(this.Hi("WACDialogTitlePanel")).className="display-none",document.getElementById(this.Hi("WACDialogBodyPanel")).className="padding-zero");K.FocusManager.instance().hS().scope.LO=!0;this.VC=new ya(this.mza.contentWindow,this.unf);this.VC.$Q("https://osiziwuspersimmon002.blob.core.windows.net");this.VC.$Q("https://osizewuspersimmon001.blob.core.windows.net");this.VC.$Q("https://osizpscuspersimmon000.blob.core.windows.net");this.VC.$Q("https://cdn.hubblecontent.msit.osi.office.net");
this.VC.$Q("https://cdn.hubblecontent.osi.office.net");this.VC.TNb(R.a.NTg,ob=>{this.J0i(ob,ra.Pra)});this.VC.TNb(R.a.insert,()=>{this.p8i(ra.Pra)});this.VC.TNb(R.a.t7c,this.U1i);this.VC.TNb(R.a.nUg,ob=>{this.B$i(ob)});2===this.gcb&&0===this.Mxh&&(this.VC.TNb(R.a.PMi,this.d9i),this.mCd=this.Usb.aUa("MsoPremiumStockImages",ob=>{k.ULS.sendTraceTag(537155811,0,50,"OnCompleteM365Upsell: Upsell completed from stock images");ob.isEnabled?this.VC.sendMessage(R.a.Ehk,{["LicenseTier"]:ob.toString()}):k.ULS.sendTraceTag(537155810,
0,10,"OnCompleteM365Upsell: Upsell completed but license tier didn't upgrade.")}));this.WCc(3)}dispose(){this.f$=null;this.Usb&&this.mCd&&this.Usb.JRd("MsoPremiumStockImages",this.mCd);this.VC&&(this.VC.dispose(),this.VC=null);super.dispose()}hide(){super.hide();V.a.IDc(this.$)}get V6(){return Z.a.Kbc+"/InsertMediaDialog"}get s_(){return!1}J0i(ra,Va){ra=ra&&ra.Values?(ra=ra.Values)?Object(za.a)(new la,{Action:ra.action||"",Caption:ra.caption||"",ContentType:ra.contentType||"",FileExtension:ra.extension||
"",PageUrl:ra.pageUrl||"",SourceUrl:ra.sourceUrl||"",ThumbnailUrl:ra.thumbnailUrl||"",LicenseUrl:ra.licenseUrl||"",LicenseDisplayName:ra.licenseDisplayName||"",Height:ra.height||0,Width:ra.width||0}):null:null;ra&&(this.f$.push(ra),this.Cnc&&(k.ULS.sendTraceTag(537155809,0,50,"InsertMediaDialog.OnAddItem: Insert Message handling was pending"),Va(this.f$),this.Cnc=!1,this.txa(this.$2a)))}p8i(ra){this.f$&&0<this.f$.length?this.f$.length<=this.vAe?(ra(this.f$),this.WCc(0),this.txa(this.$2a)):(this.rB(),
k.ULS.sendTraceTag(537155808,0,10,"OnInsert : Tried to insert more than allowed limit of items."),this.f$.length=0,this.WCc(2)):this.Cnc=!0}aph(){const ra=document.createElement("div");ra.id="InsertMediaDialog";ra.className=ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixHorizonalScroll",!0)?"insert-media-dialog":"insert-media-dialog-old";const Va=document.createElement("div");Va.id="InsertMediaPanel";Va.className=ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixCancelButton",
!0)?"insert-media-panel":"insert-media-panel-old";const ob=document.createElement("iframe");ob.id="InsertMediaFrame";ob.className="insert-media-frame";ra.appendChild(Va);Va.appendChild(ob);return xa.b(ra)}rB(){const ra=F.a.Wd(1,0,0,0,0,466721363,"InsertPictureExceededAllowedCount");ra.Description=String.format(M.a.instance.Xb(206),this.vAe.toLocaleString());ea.EwaSettings.Fz()?new oa.a(this.$,ra):(new Ea.ErrorDialog(this.$,ra)).ah()}X9h(){return 2===this.gcb?"M365":"bing"}WCc(ra){var Va,ob;if(2===
this.gcb||1===this.gcb){const lb=d.AFrameworkApplication.fa.Va("InsertMediaDialogAriaTenantNameSpace");if(lb&&""!==lb){var ja=[];Array.add(ja,Object.assign(new Fa.a,{name:"DialogMode",string:this.X9h()}));Array.add(ja,Object.assign(new Fa.a,{name:"Provider",string:P[this.gcb]}));Array.add(ja,Object.assign(new Fa.a,{name:"InsertedFiles",int64:null===(Va=this.f$)||void 0===Va?void 0:Va.length}));ja.push(Object.assign(new Fa.a,{name:"MediaDetails",string:this.f$?JSON.stringify(this.f$.map(wb=>wb.SourceUrl)):
null}));Array.add(ja,Object.assign(new Fa.a,{name:"DialogResult",string:Ja[ra]}));Array.add(ja,Object.assign(new Fa.a,{name:"CorrelationId",string:null===(ob=this.correlationId)||void 0===ob?void 0:ob.toString()}));S.a.sendTelemetryEvent(Object.assign(new hb.a,{name:String.format("{0}.{1}",lb,"InsertOnlineImages"),dataFields:ja}))}}}}Object(r.a)(Ba,"InsertMediaDialog",I.a,[]);var fa=a(387),ta=a(300);class Oa extends u.a{constructor(ra,Va,ob,ja,lb,wb){super(null,ob,ja);this.JBf=0;this.Pra=Ab=>{if(Ab){var nb=
Array(Ab.length);for(var pb=0;pb<Ab.length;pb++){const zb=Ab[pb];nb[pb]={};nb[pb].SourceUrl=zb.SourceUrl;v.a.Lna(zb.LicenseUrl)&&v.a.Lna(zb.PageUrl)&&(nb[pb].LicenseUrl=zb.LicenseUrl,nb[pb].LicenseDisplayName=zb.LicenseDisplayName,nb[pb].PageUrl=zb.PageUrl);nb[pb].AltText=-2053056795===this.je.command?zb.Caption:"";nb[pb].IsCellPicture=15735758===this.je.command||570484235===this.je.command}var cb=-2009825598===this.je.command?"bing":"M365";pb=E.h(this.$);var Da=z.o(pb.ga.pa.activeCell,this.$);y.a(this.$.userOperationManager,
(zb,qb,Pa)=>H.t(this.$.qa.va,Da,nb,cb,O.b(zb,this.R$i),O.a(qb,this.Q$i),Pa,null),zb=>new D.a(595,0,zb),this.je);L.HelperMethods.e1?(pb=new Map,pb.set("MediaProvider",cb),pb.set("ImagesCount",Ab.length.toString()),pb.set("TimeTakenToOpenDialog",this.JBf.toString()),x.Health.instance.recordKpiUsage(ta.a.twi,1,fa.a.Ung,pb)):k.ULS.sendTraceTag(537155805,0,15,"OnlinePictureUploaderWrapper.UploadResponseReceived: KPI Usage not supported.");this.gwc()}else k.ULS.sendTraceTag(537155806,0,10,"OnlinePictureUploaderWrapper.UploadResponseReceived: Response is null")};
this.R$i=Ab=>{if(G.a(Ab))k.ULS.sendTraceTag(537155799,0,10,`OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded with errors. Errors: ${F.a.Uc(Ab.Errors)}`);else{k.ULS.sendTraceTag(537155801,0,50,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded.");const nb=this.je.command;15735758!==nb&&570484235!==nb&&(Ab.Result?B.a(this.$).d$(1,Ab.Result):k.ULS.sendTraceTag(537155800,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess:Result.result is null"))}};
this.Q$i=()=>{k.ULS.sendTraceTag(537155798,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadFailed: Operation failed")};this.$=ra;this.je=Va;this.mK=wb;this.eBe=w.a.instance.Dc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.showDialog()}dispose(){this.$=null}showDialog(){let ra=null;ra=this.$.yc.Fd("UserAction","showOnlineImagesDialogTimeStopwatch");switch(this.je.command){case -2009825598:case 15735758:this.JXj();break;case -2053056795:case 570484235:this.eBe.execute(Va=>
{Va.isFeatureEnabled("MsoPremiumStockImages",!1).catch(ob=>k.ULS.sendTraceTag(557200643,0,10,`OnlinePictureUploaderWrapper::ShowDialog - Failed to load the premium state from application feature helper: ${ob}`)).then(ob=>{this.KXj(ob);return null})})}ra.stop();this.JBf=ra.vd}JXj(){let ra=this.$.xa.BingPictureEndpoint;const Va=m.a.KL(d.AFrameworkApplication.lcid),ob=t.a.create();ra?(ra=0<ra.search(RegExp("insertmedia.bing.office.net","gi"))?String.format(ra,1,1):String.format(ra,1,d.AFrameworkApplication.lcid,
Va?Va.name:"en-us",d.AFrameworkApplication.buildVersion,ob.toString(),1,this.$.xa.DocumentHostInfo.LoggableUserId),this.M$b(ra,1,-1,M.a.instance.ha(1764))):(k.ULS.sendTraceTag(537155804,0,10,"OnlinePictureUploaderWrapper::ShowDialogForBingPictures - Can't access the Bing service endpoint"),this.mK.setException(Error.create("Failed to access the Bing service endpoint")))}KXj(ra){var Va=this.$.xa.M365PictureEndpoint,ob=t.a.create();if(Va){var ja=this.$.xa.DocumentHostInfo.UserId;ja=ja?v.a.Av(ja).toString():
"0";var lb=this.eBe.instance.isFreemiumUpsellEnabled();ra=ra?1:lb?0:-1;ob=ob.toString();lb=m.a.KL(d.AFrameworkApplication.lcid).name;Va=String.format(Va,d.AFrameworkApplication.lcid,lb,d.AFrameworkApplication.buildVersion,ob,1,ja,ra,1);this.M$b(Va,2,ra,M.a.instance.ha(1763))}else k.ULS.sendTraceTag(537155803,0,10,"OnlinePictureUploaderWrapper::ShowDialogForStockImages - Can't access the M365 service endpoint"),this.mK.setException(Error.create("Failed to access the M365 service endpoint"))}M$b(ra,
Va,ob,ja){try{(new Ba(this.$,ra,w.a.instance.nh("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Va,ob,ja)).xYj(this),this.mK.setResult(!0)}catch(lb){k.ULS.sendTraceTag(537155802,0,10,`OnlinePictureUploaderWrapper::CreateAndShowDialog failed [Exception : ${lb}] [MediaProvider : ${Va}] [DialogLicenseTier : ${ob}]`),this.mK.setException(lb)}}}Object(r.a)(Oa,"OnlinePictureUploaderWrapper",u.a,[2]);var Ma=a(63);class fb{constructor(ra,Va){this.$=ra;this.uploaderCreator=Va}executeCommand(ra,
Va,ob){ra=Va.command;switch(ra){case 1403967063:case -2060689045:if(ob&&"dataUrl"in ob)return Va=new e.a,this.uploaderCreator&&this.uploaderCreator.eui(this.$,f.a.instance,d.AFrameworkApplication.fa,ob,ob.dataUrl,Va),Va.task;this.uploaderCreator&&this.uploaderCreator.fvi(this.$,Va,f.a.instance,d.AFrameworkApplication.fa,ob);return Ma.Task.Ua(!0);case -2053056795:case -2009825598:case 570484235:case 15735758:return ra=new e.a,new Oa(this.$,Va,f.a.instance,d.AFrameworkApplication.fa,ob,ra),ra.task;
default:return l.a(ra)}}fd(ra,Va){let ob=this.$.isEditMode;if(ob)switch(Va.command){case 1403967063:ob=!0;break;case -2053056795:ob=!0;break;case -2009825598:ob=!0;break;case -2060689045:case 15735758:case 570484235:ob=h.a.xFb()&&1===ra;break;default:ob=!1}return ob}Cd(){return!1}yd(){return!1}}Object(r.a)(fb,"PictureCommandHandler",null,[210]);var pa=a(40),Ua=a(52),Sa=a(100),Ia=a(149),X=a(35),ca=a(72);class U extends b.a{constructor(ra){super(ra)}ue(){pa.TaskExtensions.za(Object(ca.b)("OfficeVSO:7625189_MoveUploaderCreatorToNewServiceInfra")?
Object(Sa.d)(Ia.a.resolve(X.Ib,{Wa:this.La})):Ua.GetServiceTaskFactory.Za(this.$.da,484,485,1),ra=>{this.Zd([new fb(this.$,ra.result)])},this.$.ka,3)}static la(ra){b.a.Ie(90,new U(ra))}}Object(r.a)(U,"PictureCommandHandlerFactory",b.a,[]);a.d(C,"a",function(){return ma});const ma=()=>{c.a.Fa(ra=>{U.la(ra)})}},1238:function(r,C,a){r=a(0);var c=a(15),b=a(198),e=a(88),f=a(126),d=a(393),h=a(106),l=a(49);class k{constructor(){this.$fa=this.z7e=null}}Object(r.a)(k,"GestureAdapterInfo",null,[]);var u=a(6),
v=a(468),x=a(268);class w{constructor(){this.CPc=null}qOi(){if(!this.CPc){var K="hammer.min.js";u.AFrameworkApplication.fa.Lq("IsServerFlavorDebug")&&(K=u.AFrameworkApplication.fa.ra("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");K=u.AFrameworkApplication.zT(String.format("{0}",K),5);K=x.a.create(K,null,null);v.a.gxa(K);this.CPc=K.Cbb}return this.CPc}static get instance(){w.Oa||(w.Oa=new w);return w.Oa}}w.Oa=null;Object(r.a)(w,"HammerJsDependencyLoader",null,[323]);var m=a(14);const t=(K,R,Z=
null)=>{if(void 0===R||null===R)throw c.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");let P=null;switch(K){case m.a.pinch:P=new Hammer.Pinch(Z);break;case m.a.pan:P=new Hammer.Pan(Z)}P&&(P.manager=R);return P};var z;(function(K){K[K.none=-1]="none";K[K.pinch=0]="pinch";K[K.pan=1]="pan";K[K.swipe=2]="swipe"})(z||(z={}));Object(r.b)("GestureEvent",z);var y=a(82);class D extends y.a{constructor(K,R,Z,P,V,Ea,oa,ea){super(K,Z,P,Ea);this.Olb=R;
this.Uia=oa;this.oZ=ea;this.EHg=V}get shiftKey(){return this.Uia}get ctrlKey(){return this.oZ}get clientPoint(){return this.Olb}get Pxa(){return this.EHg}static create(K,R,Z,P,V,Ea){if(Z.rawEvent)if(Ea){var oa=Z.rawEvent;oa=new Sys.UI.Point(oa.clientX,oa.clientY)}else oa=y.a.EAb(Z);else oa=new Sys.UI.Point(Z.clientX,Z.clientY);return new D(K,oa,R,Z,P,V,Z.shiftKey,Z.ctrlKey,Ea)}}Object(r.a)(D,"GestureEventArgs",y.a,[]);class H{constructor(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=
null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}}Object(r.a)(H,"GestureManagerData",null,[]);class F{}F.fBg=2;F.gBg=4;F.hBg=8;F.iBg=8;Object(r.a)(F,"HammerConstants",null,[]);var G=a(99),L=a(213),M=a(32),O=a(85);class B extends l.a{constructor(K,
R){super();this.lta=d.a.SZh;this.jXc=!!window.PointerEvent;this.jte=window.hasOwnProperty("ontouchstart");this.JZa=this.hpb=null;this.Gaa=!1;this.IU=new h.a;this.Bpb=new h.a;this.FHg=new b.a;this.Ksa=null;this.LYa=this.uRc=this.vce=this.nOc=this.bVc=this.Gpe=this.Bce=this.arb=!1;this.Mob=-1;this.curRecognizer=this.element=this.handlers=this.session=this.TZc=null;this.Ee=G.EventHandlerManager.instance;this.jXc?(c.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),this.hpb=Object(e.a)(this,this.zSa,
"onPointerEvent"),this.JZa=m.a.UZh):this.jte?(c.ULS.sendTraceTag(593893140,310,50,"Using touch events"),this.hpb=Object(e.a)(this,this.UBa,"onTouchEvent"),this.JZa=m.a.touchEvents):(c.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),this.hpb=Object(e.a)(this,this.mvc,"onMouseEvent"),this.JZa=m.a.TZh);this.ti=R;this.Wha=K;u.AFrameworkApplication.fa&&(this.arb=u.AFrameworkApplication.fa.ra("UsePointerCaptureIsEnabled"),this.Bce=u.AFrameworkApplication.fa.ra("ClearCacheOnPrimaryPointerIsEnabled"),
this.Gpe=u.AFrameworkApplication.fa.ra("ResetHandledBeforeInputHandlerIsEnabled"),this.bVc=u.AFrameworkApplication.fa.ra("LogCoalescedEventsIsEnabled"),this.nOc=u.AFrameworkApplication.fa.ra("CheckExistenceOfGetCoalescedEventsIsEnabled"),this.vce=u.AFrameworkApplication.fa.ra("CheckIfHammerExistsAfterDownloadIsEnabled"),this.uRc=u.AFrameworkApplication.fa.ra("HammerJsPerformanceTimersIsEnabled"),this.LYa=this.arb&&u.AFrameworkApplication.fa.ra("CancelDragFromGestureInputManagerIsEnabled")&&u.AFrameworkApplication.fa.ra("UseGestureInputManagerPointerCacheIsEnabled"))}r7h(){return this.jXc?
0:this.jte?1:2}zo(K){super.zo(K);this.Ee.kna(this.JZa,K,0,this.hpb)}yn(K){super.yn(K);this.Ee.NLa(K,this.JZa)}huj(K,R,Z=null){u.AFrameworkApplication.Vnc()?w.instance.qOi().continueWith(P=>{this.l2j();if(P.Jg||P.ji)c.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",P.status);else{c.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",P.status);if(this.vce){P=window.Hammer;if("undefined"===typeof P){c.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");this.DGc();
return}if("undefined"===typeof P.inputHandler){c.ULS.sendTraceTag(590901390,310,10,"Hammer.inputHandler does not exist");this.DGc();return}}if(!K)throw this.DGc(),Error.argumentNull("source element can not be null");P=L.a.sya(K,this.lta);if(void 0===P||null===P)P=new h.a,L.a.Ahb(K,this.lta,P),this.iuj(K);var V=null;P.Pb(z[0])||(V=Object.assign(new k,{$fa:t(z[0],this,null),z7e:R}),P.add(z[0],V));if(void 0!==Z&&null!==Z)for(let Ea=0;Ea<Z.length;Ea++)if(P.Pb(z[Z[Ea]])){const oa=P.ma(z[Z[Ea]]);V.$fa.recognizeWith(oa.$fa)}}this.DGc()}):
c.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")}l2j(){this.uRc&&(this.ti?this.TZc=this.ti.Fd("Task","RegisterGestureAdapterAfterLoad"):c.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))}DGc(){this.uRc&&(this.TZc?this.TZc.stop():c.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))}iuj(K){this.FHg.add(K);this.Ee.kna(this.JZa,K,0,this.hpb)}recognize(K){var R=Array(K.pointers.length);for(var Z=
0;Z<K.pointers.length;Z++)R[Z]=K.pointers[Z].target;Z=null;for(this.Ksa=this.P9h(R);void 0!==this.Ksa&&null!==this.Ksa&&(Z=L.a.sya(this.Ksa,this.lta),void 0===Z||null===Z);this.Ksa=this.Ksa.parentNode);if(void 0!==Z&&null!==Z){this.curRecognizer&&this.curRecognizer.state===F.iBg&&(this.curRecognizer=null);R=Z.keys;for(let P of R){R=Z.ma(P);void 0!==R&&null!==R&&void 0!==R.$fa&&null!==R.$fa&&(void 0===this.curRecognizer||null===this.curRecognizer||R.$fa===this.curRecognizer||R.$fa.canRecognizeWith(this.curRecognizer))&&
R.$fa.recognize(K);const V=R.$fa.state;this.curRecognizer||F.fBg!==V&&F.gBg!==V&&F.hBg!==V||(this.curRecognizer=R.$fa)}}}emit(K,R){if("hammer.input"!==K){this.Gaa=!1;R=D.create(K,this.Ksa,R.srcEvent,R,3,this.jXc);var Z=L.a.sya(this.Ksa,this.lta);if(this.QFi(K))var P=0;else if(this.FFi(K))P=1;else if(this.ZIi(K))P=2;else{c.ULS.sendTraceTag(42256256,310,15,"Event can not be recognized by current manager");return}({value:Z}=Z.Ad(z[P]));void 0!==Z&&null!==Z&&((Z=Z.z7e,Z.$Ci())?K.endsWith("start")?this.Gaa=
Z.U5i(R):K.endsWith("end")?(Z.S5i(R),this.Gaa=!0):K.endsWith("cancel")?(Z.R5i(R),this.Gaa=!0):K.endsWith("move")&&(this.Gaa=Z.T5i(R)):c.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",K))}}get(K){return Object(f.a)(Hammer.Recognizer,K)}P9h(K){if(1>K.length)return null;if(1===K.length)return K[0];var R=K[0],Z=!0;for(let P=1;P<K.length;P++){if(!K[P])return null;if(R!==K[P]){Z=!1;break}}if(Z)return R;R=this.V7e(K[0]);Z=0;for(const P of K){K=this.V7e(P);if(R.ma(R.count-1)!==
K.ma(K.count-1))return null;for(let V=R.count-2,Ea=K.count-2;V>=Z&&0<=Ea;V--,Ea--)if(R.ma(V)!==K.ma(Ea)){Z=V+1;break}}return R.ma(Z)}V7e(K){const R=new b.a;for(;void 0!==K&&null!==K;K=K.parentNode)R.add(K);return R}abf(K){switch(K){case m.a.mg:case m.a.Yba:return 1;case m.a.lh:case m.a.Zja:return 2;case m.a.jf:case m.a.eKa:return 4;case m.a.sIc:case m.a.l6c:return 8}return 0}UBa(K,R,Z){K=this.abf(K);R=this.t8h(Z);Hammer.inputHandler(this,K,R);this.Gaa&&Z.preventDefault();return this.Gaa}Qif(){return 1<
this.IU.count}b8b(){c.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.arb)for(let K of this.IU)this.$3f(K.key);else this.IU=new h.a;this.session=null}jUg(K,R,Z){c.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",K);if(!this.Bpb.Pb(K)){try{R.setPointerCapture(K)}catch(P){c.ULS.sendTraceTag(594055958,310,10,"Exception: {0}",P)}this.Bpb.add(K,R)}this.IU.ia(K,Z);this.LYa&&1<this.IU.count&&this.Wha&&!this.Wha.Pub&&(this.Wha.Pub=!0)}$3f(K){c.ULS.sendTraceTag(594055957,
310,50,"RemovePointerFromCaches: pointerId: {0}",K);if(this.Bpb.Pb(K)){try{this.Bpb.ma(K).releasePointerCapture(K)}catch(R){c.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",R)}this.Bpb.remove(K)}else c.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",K);this.IU.remove(K);this.LYa&&1>=this.IU.count&&this.Wha&&this.Wha.Pub&&(this.Wha.Pub=!1)}zSa(K,R,Z){var P=Z.rawEvent.pointerType.toString();const V=Z.rawEvent.pointerId.toString();if("touch"!==P)return!1;
K=this.abf(K);if(1!==K&&!this.IU.Pb(V))return!1;this.Bce&&1===K&&Z.rawEvent.isPrimary&&this.IU.count&&(c.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.b8b());this.arb?this.jUg(V,R,Z):this.IU.ia(V,Z);this.bVc&&2===K&&(!this.nOc||this.nOc&&"function"===typeof Z.rawEvent.getCoalescedEvents)&&(R=Z.rawEvent.getCoalescedEvents())&&this.Qif()&&(this.Mob=Math.max(this.Mob,R.length));this.Gpe&&(this.Gaa=!1);P=this.s8h(this.IU,Z,P);Hammer.inputHandler(this,K,P);if(4===K||8===K)this.arb?
this.$3f(V):this.IU.remove(V),this.IU.count||(this.session=null,this.bVc&&-1!==this.Mob&&(c.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.Mob),this.Mob=-1));this.Gaa&&Z.preventDefault();return this.Gaa}mvc(){return!1}t8h(K){const R=new H;var Z=K.rawEvent;const P=Z.touches;Z=Z.changedTouches;R.pointers=Array.clone(P);R.pointers=Array.clone(0<P.length?P:Z);R.changedPointers=Array.clone(Z);R.srcEvent=K;R.pointerType="touch";return R}s8h(K,R,Z){const P=new H;P.pointers=
O.toArray(K.values);P.changedPointers=[R];P.pointerType=Z;P.srcEvent=R;return P}QFi(K){return M.a.startsWith(K,m.a.pinch)}FFi(K){return M.a.startsWith(K,m.a.pan)}ZIi(K){return M.a.startsWith(K,m.a.swipe)}}Object(r.a)(B,"GestureInputManager",l.a,[297,298]);var E=a(291),I=a(261);class S{constructor(){this.Nb=null;this.Iy=!1}get name(){return"Common.App.GestureInputManager"}Oi(K){K.register(B,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").gd().od(()=>new B(E.a.instance,
u.AFrameworkApplication.sa.qF));this.Nb=K}init(){this.Iy||(this.Nb.resolve("Common.App.GestureManager.GestureInputManager"),this.Iy=!0)}dispose(){}static main(){I.a.instance.wj(new S)}}Object(r.a)(S,"GestureInputManagerPackage",null,[4,5]);a.d(C,"a",function(){return J});const J=()=>{Type.registerNamespace("Common.App.GestureManager");S.main()}},1262:function(r,C,a){r=a(0);var c=a(88),b=a(156),e=a(6);class f extends b.a{constructor(D){super(!1,!1,!0);this.rYa=D}start(){var D={["tooltipPersistenceEnabled"]:this.rYa.dtd};
e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectionHighlightChangeEnabled",!1)&&(D.textSelectionChangeEnabled=this.rYa.e4d);D={["id"]:"AccessibilitySettingsDialog",["bodyControls"]:D};this.initializeAndShow("",Object(c.a)(this,this.GEj,"resultHandler"),D)}GEj(D,H){1===D&&(this.rYa.dtd=H.tooltipPersistenceEnabled,e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectionHighlightChangeEnabled",!1)&&(this.rYa.e4d=H.textSelectionChangeEnabled))}}
Object(r.a)(f,"AccessibilitySettingsDialog",b.a,[]);var d=a(111),h=a(27);class l{constructor(D,H){this.Na=D;this.rYa=H}Ih(){this.Na.Hc(h.a.aXj,d.a.frame,Object(c.a)(this,this.bXj,"showAccessibilitySettingsDialogHandler"))}bXj(){(new f(this.rYa)).start();return 32}}Object(r.a)(l,"AccessibilitySettingsDialogActor",null,[300]);var k=a(172);const u=D=>{const H=new k.a;e.AFrameworkApplication.qe.Sn(v(D),1,null,null,!0,2,F=>{200===F.data.httpStatus?H.setResult("true"===F.data.Pe.toLowerCase()):H.setResult(!1)},
()=>{H.setResult(!1)},null,void 0,void 0,void 0,void 0,"7");return H.task},v=D=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",e.AFrameworkApplication.fa.appSettings.RoamingServiceHandlerWebServiceBase||"",D,e.AFrameworkApplication.oj);var x=a(140);class w{constructor(){this.r_c=this.QZa=null}get dtd(){return!!this.QZa}set dtd(D){D!==this.QZa&&(this.QZa=D,x.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(D),this.luf()&&e.AFrameworkApplication.qe.Sn(v("saveHoverableRibbonTooltipIsEnabled"),
2,D.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}get e4d(){return!!this.r_c}set e4d(D){D!==this.r_c&&(this.r_c=D)}wOi(){const D=new k.a;if(this.QZa)D.setResult(this.QZa);else if(this.luf()){const H=u("getHoverableRibbonTooltipIsEnabled");H.continueWith(()=>{this.QZa=H.result;x.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(H.result);D.setResult(H.result)},8)}else D.setResult(!1)}luf(){const D=e.AFrameworkApplication.fa.ra("IsRoamingServiceEnabled"),
H=e.AFrameworkApplication.fa.ra("IsAnonymousUser");return D&&!H}}Object(r.a)(w,"AccessibilitySettingsInfo",null,[299]);var m=a(261),t=a(144);class z{constructor(){this.Nb=null}get name(){return"Common.App.AccessibilitySettings"}Oi(D){this.Nb=D;this.Nb.register(w,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").od(()=>new w).gd();this.Nb.register(l,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").od(()=>
new l(e.AFrameworkApplication.dc,this.Nb.nh("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).gd()}init(){const D=this.Nb.nh("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),H=this.Nb.nh("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");D&&H?(H.Ih(),D.wOi()):t.a(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){m.a.instance.wj(new z)}}Object(r.a)(z,
"AccessibilitySettingsPackage",null,[4,5]);a.d(C,"a",function(){return y});const y=()=>{Type.registerNamespace("Common.App.AccessibilitySettings");z.main()}},1263:function(r,C,a){r={};a.r(r);a.d(r,"TableManager",function(){return Oa});var c=a(10),b=a(0),e=a(230),f=a(118),d=a(15),h=a(92),l=a(31),k=a(425),u=a(488),v=a(533),x=a(181),w=a(233),m=a(25),t=a(74),z=a(47),y=a(186),D=a(219),H=a(51),F=a(48),G=a(13),L=a(76),M=a(141),O=a(1),B=a(12),E=a(19),I=a(354),S=a(250),J=a(14),K=a(170),R=a(101),Z=a(7),P=a(262),
V=a(75),Ea=a(50),oa=a(37);class ea extends R.a{constructor(pa,Ua,Sa,Ia){super(pa);this.yng=[6];this.tng=[26];this.Br=null;this.KFb=this.tpc=!1;this.Nt=this.Oda=null;this.onPointerDown=X=>{if(1!==this.$.Ia.XI())return!0;X=oa.a(this.$).df(X);if(this.zC)return!0;var ca=Ea.a(this.$).vxd||Ea.a(this.$).Zq();if(this.uzd||ca)return this.sgb(),!0;this.Nt=this.ko;this.IRd();this.Csd();ca=2===X.kc&&X.ap===Sys.UI.MouseButton.leftButton;const U=3===X.kc;if(ca||U)X=this.ga.hr(X.clientPoint,X.Fc,5,void 0,void 0,
!0),X||(X=this.Nt),this.KFb=ca,this.tpc=U,this.Nt=this.bgf(X),this.Csd(),ca?this.Huj():U&&this.yvj(),P.b(this.$,!0);return!0};this.$j=X=>{X=oa.a(this.$).df(X);if(!this.zC)return!1;let ca=this.KFb?this.ga.hr(X.clientPoint,X.Fc,5,void 0,void 0,!0):this.ga.hr(X.clientPoint,X.Fc,5,!0,!1,!0);ca||(ca=this.ga.dtb(X.clientPoint,X.Fc,5));ca&&(X=this.bgf(this.Fsb(ca)),this.i7b(X.bottomRight),this.Nt.equals(X)||(this.Nt=X,this.kOb(!1),this.IRd(!1),this.Csd(!1),this.eqi(),this.pc.update(!1)),this.jek(this.Nt));
return!0};this.Wh=X=>{oa.a(this.$).df(X);if(!this.zC)return!1;this.resizeTable();this.sgb();return!0};this.ELb=X=>{oa.a(this.$).df(X);if(!this.zC)return d.ULS.shipAssertTag(537151233,0,!0,"TableResizeBehavior.OnTouchUp - OnTouchUp Called without Operation in Progress"),!1;this.resizeTable();this.sgb();return!0};this.xfa=X=>{oa.a(this.$).df(X);this.sgb();return!0};this.pJf=()=>{this.zC&&this.sgb()};this.gridView=Ua;this.$=Ua.$;this.tableManager=Ia;this.ga=Ua.ga;this.pc=Ua.pc;this.parentElement=pa;
this.n9g();l.a.rq||l.a.f1||S.a.instance.ta(J.a.pointerDown,this.Oda,this.onPointerDown);this.ko=Sa;this.STc=this.uzd=!1;this.tableManager.sWg(this.pJf)}get zC(){return this.KFb||this.tpc}get lvf(){return this.STc}dispose(){this.sgb();this.tableManager.Kxj(this.pJf);this.lvf||l.a.rq||l.a.f1||S.a.instance.Aa(J.a.pointerDown,this.Oda,this.onPointerDown);if(this.zC){P.b(this.$,!1);try{this.px()}catch(pa){d.ULS.sendTraceTag(537151236,0,10,`TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception ${pa}`)}}this.parentElement&&
this.parentElement.contains(this.Oda)&&this.parentElement.removeChild(this.Oda);this.Oda=this.parentElement=null;super.dispose()}bgf(pa){const Ua=pa.bottom-this.ko.topLeft.bottom-1;return 0<=pa.right-this.ko.topLeft.right+1&&0<=Ua&&pa.bottom>=this.ko.top&&pa.right>=this.ko.left?new m.Range(this.ko.top,this.ko.left,pa.bottom,pa.right,!1,!1):this.Nt}Csd(pa=!0){this.LDc([this.Nt],6,pa);this.pc.fs(this.yng)}kOb(pa=!0){this.pc.Sk(this.yng);this.LDc([null],6,pa)}IRd(pa=!0){this.pc.Sk(this.tng);this.LDc([null],
26,pa)}eqi(){const pa=this.j5j();0<pa.length&&(this.LDc(pa,26,!1),this.pc.fs(this.tng))}j5j(){const pa=[];this.ko.contains(this.Nt)&&(this.ko.right!==this.Nt.right&&pa.push(new m.Range(this.ko.top,this.Nt.right+1,this.Nt.bottom,this.ko.right,!1,!1)),this.ko.bottom!==this.Nt.bottom&&pa.push(new m.Range(this.Nt.bottom+1,this.ko.left,this.ko.bottom,this.ko.right,!1,!1)));return pa}resizeTable(){if(!this.Nt.equals(this.ko)){const pa=new m.Range(this.ko.top,this.ko.left,this.Nt.bottom,this.Nt.right,!1,
!1);this.o$j(pa);this.uzd=!0}}onKeyDown(pa){oa.a(this.$).df(pa);return!0}vJd(){this.lvf&&(l.a.rq||l.a.f1||(S.a.instance.ta(J.a.pointerDown,this.Oda,this.onPointerDown),this.Oda.classList.remove("ewr-table-resize-default-cursor"),this.STc=this.Oda.disabled=!1),this.STc=!1)}n9g(){const pa=document.createElement("div");pa.className="ewr-table-resize-handle";const Ua=document.createElement("div");Ua.className="ewr-table-resize-fillhandle-higher";const Sa=document.createElement("div");Sa.className="ewr-table-resize-fillhandle-broader";
pa.appendChild(Ua);pa.appendChild(Sa);this.Oda=pa;this.parentElement.appendChild(this.Oda)}i7b(pa){let Ua=60;const Sa=this.Nt.contains(pa);let Ia=pa.top,X=pa.bottom,ca=pa.left,U=pa.right,ma=null;if(Sa){if(this.gridView.ZL(this.ko.topLeft)&&!this.ko.XDa)return;pa.bottom<this.Nt.bottom?(Ia=Math.max(1,X-2,this.ko.top),Ua=16):(ca=Math.max(1,U-2,this.ko.left),Ua=4);X=Ia;U=ca;ma=new m.Range(Ia,ca,Ia,ca,!1,!1)}else pa.right>=this.ko.right?(U+=2,Ua=8):pa.bottom>=this.ko.bottom&&(X+=2,Ua=32),Ia=X,ca=U,ma=
new m.Range(X,U,X,U,!1,!1),Ua=16;this.gridView.ZL(ma)||(this.Br?this.Br.Zo||(this.Br=H.a.instance.create(()=>{this.gridView.Vw(ma,Ua,"TableResizeBehavior.BringRangeIntoView")},40,F.a.wng)):this.Br=H.a.instance.create(()=>{this.gridView.Vw(ma,Ua,"TableResizeBehavior.BringRangeIntoView")},40,F.a.wng))}Fsb(pa){let Ua=pa;if(this.gridView.Mb.VW){if(!this.gridView.tc(pa.topLeft)){const Sa=this.gridView.Bj("TableResizeBehavior.AdjustHiddenRowColumns",this.gridView.dS,this.Nt.top!==pa.top?1:2);try{Sa.Cl=
this.Nt.top<pa.top||this.Nt.left<pa.left,Sa.cx(pa.topLeft),Ua=Sa.$$cu().range}finally{Sa&&Sa.dispose()}}Ua.right=Ua.left+pa.width-1;Ua.bottom=Ua.top+pa.height-1}return Ua}LDc(pa,Ua,Sa=!0){const Ia=[];for(const X of pa)Ia.push(new I.a(X,t.d(this.$.na)));this.pc.oB(Ia,[Ua],!0,void 0,Sa)}Huj(){S.a.instance.ta(J.a.dl,document.documentElement,this.$j);for(const pa of this.gridView.Ho)S.a.instance.ta(J.a.dl,pa.domElement,this.$j);S.a.instance.ta(J.a.Zg,document.documentElement,this.Wh);this.hUe()}yvj(){K.a.instance.ta(J.a.lh,
document.documentElement,this.$j);for(const pa of this.gridView.Ho)K.a.instance.ta(J.a.lh,pa.domElement,this.$j);K.a.instance.ta(J.a.jf,document.documentElement,this.ELb);this.hUe()}px(){this.KFb&&this.sck();this.tpc&&this.Fck()}sck(){S.a.instance.Aa(J.a.dl,document.documentElement,this.$j);for(const pa of this.gridView.Ho)S.a.instance.Aa(J.a.dl,pa.domElement,this.$j);S.a.instance.Aa(J.a.Zg,document.documentElement,this.Wh);this.R1f()}Fck(){K.a.instance.Aa(J.a.lh,document.documentElement,this.$j);
for(const pa of this.gridView.Ho)K.a.instance.Aa(J.a.lh,pa.domElement,this.$j);K.a.instance.Aa(J.a.jf,document.documentElement,this.ELb);this.R1f()}hUe(){this.gridView.cellTextEditBox.mdc(!0)}R1f(){this.gridView.cellTextEditBox.mdc(!1)}o$j(pa){this.$.Ed(-1400250766,V.a.fc,30,{["ResizeTableRange"]:pa,["OriginalTableRange"]:this.ko})}jek(pa){if(!this.ko.contains(pa)){pa=this.i5j();for(const Ua of pa)if(this.tableManager.Uzd(Ua)){this.gridView.Nh.zq(Z.a.tZi);return}}this.gridView.rtl?this.gridView.Nh.zq(Z.a.DYi):
this.gridView.Nh.zq(Z.a.P_i)}sgb(){if(this.zC){P.b(this.$,!1);try{this.px()}catch(pa){d.ULS.sendTraceTag(537151232,0,10,`TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception ${pa}`)}}this.Br&&(this.Br.cancel(),this.Br.dispose());this.tpc=this.KFb=!1;this.kOb();this.IRd();P.b(this.$,!1);this.gridView.Nh.zq(Z.a.LW)}i5j(){const pa=[];this.ko.right!==this.Nt.right&&pa.push(new m.Range(this.ko.top,this.ko.right+1,this.Nt.bottom,this.Nt.right,!1,!1));this.ko.bottom!==this.Nt.bottom&&
pa.push(new m.Range(this.ko.bottom+1,this.ko.left,this.Nt.bottom,this.ko.right,!1,!1));return pa}static createInstance(pa,Ua,Sa,Ia){if(!Ua)return null;const X=pa.pc;X.oB(Sa,[27],!0);X.fs(ea.b5j);Sa=X.xE(27,pa.Mb.Di(Ua.bottomRight),ea.T4h(Ua,Sa)).kg;return new ea(Sa,pa,Ua,Ia)}static T4h(pa,Ua){var Sa;for(let Ia=0;Ia<Ua.length;Ia++)if((null===(Sa=Ua[Ia])||void 0===Sa?0:Sa.range)&&Ua[Ia].range.equals(pa))return Ia;return 0}}ea.b5j=[27];Object(b.a)(ea,"TableResizeBehavior",R.a,[]);var aa=a(2);R=a(249);
class ia{}ia.gLh="ewa-ttrd-buttonarea";Object(b.a)(ia,"CssClassNames",null,[]);var ya=a(53),za=a(136),la=a(91),xa=a(23),wa=a(16),hb=a(269),Ja=a(137),Fa=a(277),Ba=a(149),fa=a(35);class ta extends R.a{constructor(pa){super(document.createElement("div"));this.b1c=this.Dwd=this.dVf=this.qS=!1;this.uQb=null;this.Ff=()=>{D.c(this.$,this.gridView.ga.pa.activeCell)?(this.wPa=!0,this.qwb(!1)):(this.d1=this.wPa=!1,this.Csg())};this.Np=()=>{this.wPa?this.qwb(!0):this.d1=!1};this.zBa=()=>{this.b1c=!0;this.wPa&&
(this.d1=!1)};this.onContentReady=()=>{this.$.isEditMode?D.c(this.$,this.gridView.ga.pa.activeCell)&&(this.wPa=!0,this.qwb(!1)):this.d1=!1};this.S8=()=>{this.b1c=!1;this.wPa?this.qwb(!1):this.d1=!1};this.gg=(Ua,Sa)=>{this.wPa&&(Ua=this.gridView.aeb(Sa.Td.block.Ue.BlockCachePosition.PaneType).pD(Sa.Td.hash))&&(Ua.bTd(this.Sjf),Ua.m3c(this.Sjf))};this.Sjf=()=>{this.b6f()};this.$=pa;this.gridView=E.h(this.$);this.parentElement=this.domElement;this.parentElement.className=ia.gLh;this.xOa=this.gridView.zk;
this.xjd=O.EwaSettings.isChangeGateEnabled("OfficeVSO:7603637_LocalizeSubtotalOfTotalRow");this.wPa=!0;this.Cui();this.xjd&&this.xsi();this.F3g();this.qwb(!1);d.ULS.sendTraceTag(537151201,0,50,"TableTotalRowOptions - React Component Created ")}get d1(){return this.Dwd}set d1(pa){this.Dwd!==pa&&(this.Dwd=this.isVisible=pa)}get KGb(){return!!(this.$.oe&16)}get lEi(){const pa=this.gridView.ga.pa.activeCell;return pa.right===pa.maxColumns}get wrb(){const pa=this.gridView.tc(null);return pa&&this.gridView.sea(pa.range)?
this.tya(pa):(pa&&d.ULS.sendTraceTag(537151200,0,50,"TableTotalRowOptions.ActiveCellOffsetBounds - Active Cell not in viewport area"),null)}dispose(){this.$&&this.Uwh();this.$=this.gridView=this.parentElement=this.xOa=null;super.dispose()}N2h(pa){const Ua=this.phi(this.gridView.tc(null).range);return Ua?this.xjd?`=${this.qff()}(${pa}${this.$.listSeparator}${Ua})`:`=SUBTOTAL(${pa},${Ua})`:null}qff(){var pa,Ua,Sa;return null!==(Sa=null===(Ua=null===(pa=this.calcManager)||void 0===pa?void 0:pa.localeInfo)||
void 0===Ua?void 0:Ua.getWorksheetFuncName(344))&&void 0!==Sa?Sa:"SUBTOTAL"}phi(pa){var Ua=E.h(this.$).Wb.rh(pa);if(!Ua)return null;Ua=y.a(Ua,!1);Ua.right=Ua.left=pa.left;return Ua.toString()}Cui(){ta.YK={};ta.YK["100"]=wa.a.instance.ha(1105);ta.YK["101"]=wa.a.instance.ha(1108);ta.YK["102"]=wa.a.instance.ha(1107);ta.YK["103"]=wa.a.instance.ha(1112);ta.YK["104"]=wa.a.instance.ha(1109);ta.YK["105"]=wa.a.instance.ha(1110);ta.YK["109"]=wa.a.instance.ha(1106);ta.YK["107"]=wa.a.instance.ha(1113);ta.YK["110"]=
wa.a.instance.ha(1115);ta.YK["111"]=wa.a.instance.ha(1166)}xsi(){(O.EwaSettings.xC()?pa=>Ba.a.resolve(fa.i).then(Ua=>setTimeout(()=>pa(Ua),0)):pa=>this.$.da.Qb(266,pa))(pa=>{this.calcManager=pa})}Vgj(){var pa=this.gridView.tc(null);if(pa&&(pa=pa.yz?pa.formulaBarText:null))if(this.xjd){const Ua="="+this.qff()+"(",Sa=Ua.length;if(pa.toUpperCase().startsWith(Ua)){if(pa=pa.substring(Sa,Sa+3),pa in ta.YK)return pa}else return"111"}else if("=SUBTOTAL("===pa.substring(0,10)){if(pa=pa.substring(10,13),pa in
ta.YK)return pa}else return"111";return"100"}F3g(){this.gridView.Ca.vv(this.gg);this.gridView.ga.add_activeCellChanged(this.Ff);this.gridView.ut(this.onContentReady);this.gridView.cellTextEditBox.ro(this.zBa);this.gridView.cellTextEditBox.Pm(this.S8)}Uwh(){this.gridView&&(this.gridView.ga&&(this.gridView.ga.remove_activeCellChanged(this.Ff),this.gridView.Ca.Vt(this.gg)),this.gridView.$v(this.onContentReady),this.gridView.cellTextEditBox&&(this.gridView.cellTextEditBox.io(this.zBa),this.gridView.cellTextEditBox.fn(this.S8)),
this.Csg())}qwb(pa){this.vek(pa);this.KGb&&(this.G3j(),this.wrb?(this.dVf||this.Q3g(),this.b1c?this.d1=!1:(this.d1=!0,this.b6f())):(d.ULS.sendTraceTag(537151199,0,15,"TableTotalRowOptions.CreateAndShowDropdownInUpdatedPosition : Offset bounds could not be determined"),this.d1=!1))}b6f(){appChrome.renderTableTotalRowOptions(this.parentElement,ta.YK,ta.YK[this.Vgj()].toString(),Math.round(oa.a(this.$).Bi(17)),pa=>{d.ULS.sendTraceTag(537151198,0,50,`TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option : ${pa}`);
let Ua={["SelectedOption"]:ta.YK[pa],["FunctionKeyCode"]:pa,["Location"]:"canvas"};Ja.b(this.$).Vd(za.a.n5j,Ua,null,!0);if("111"===pa)return this.$xi(),!0;if("100"!==pa){this.uQb=this.N2h(pa);if(!this.uQb)return d.ULS.sendTraceTag(537151197,0,50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option was null"),!0;this.qVa(this.uQb)}else this.qVa("");G.DOMElementExtensions.setFocus(this.gridView.Gc.textBox.domElement);return!0})}$xi(){d.ULS.sendTraceTag(537151196,0,50,"TableTotalRowOptions.InvokeMoreFunctionsDialog - More Functions dialog invoked");
const pa=new la.a(753860909,0,this.$.isEditMode?2:1,19,null);this.$.Ia.mc(pa)}tya(pa){if(!pa)return null;var Ua=this.gridView.cellTextEditBox.textBox.domElement;var Sa=0<G.DOMElementExtensions.getHeight(Ua)&&0<G.DOMElementExtensions.getWidth(Ua)&&0<=Ua.offsetTop&&0<=Ua.offsetLeft;if(Sa)Ua=G.DOMElementExtensions.tya(Ua,this.gridView.zk);else{Ua=this.gridView.getCellBounds(pa.cell);var Ia=G.DOMElementExtensions.getBoundingClientRect(this.gridView.zk);Ua=new Sys.UI.Bounds(Ua.x-Ia.x,Ua.y-Ia.y,Ua.width,
Ua.height)}if(Ua)if(Sa)2<Ua.height&&2<Ua.height&&(Ua.x+=1,Ua.y+=1,Ua.height-=2,Ua.width-=2);else if(Sa=E.h(this.$).IL(pa.cell))Sa=Sa.width,Ia=xa.a.equals(hb.a.JAb(pa.cell,this.gridView.rtl),"right",!0),this.gridView.rtl&&Ia&&(Ua.x=Ua.x+Ua.width-Sa),pa.uea&&this.gridView.rtl===Ia&&(Ua.width=Sa);else return null;return Ua}vek(pa){var Ua=this.wrb;if(Ua){var Sa=17>=Ua.height?Ua.y:Ua.y+Ua.height-17-2;Ua=this.lEi?this.gridView.rtl?Ua.x:Ua.x+Ua.width-(17<Ua.height?17:Ua.height):this.gridView.rtl?Ua.x-(17<
Ua.height?17:Ua.height):Ua.x+Ua.width;var Ia=oa.a(this.$).Fma(new Sys.UI.Point(Ua,Sa));this.parentElement.style.top=B.HelperMethods.ud(Ia.y);this.parentElement.style.left=B.HelperMethods.ud(Ia.x);oa.a(this.$).rPj(this.parentElement);pa&&(this.d1=this.gridView.Epc(new ya.a(Ua,Sa)))}else this.d1=!1}Q3g(){this.xOa.insertBefore(this.parentElement,this.xOa.firstChild);this.dVf=!0}G3j(){this.qS||(this.gridView.view.As(this.Np),this.qS=!0)}Csg(){this.qS&&this.gridView.view&&(this.gridView.view.wq(this.Np),
this.qS=!1)}qVa(pa){const Ua=this.gridView.Gc,Sa=this.gridView.tc(null);Sa&&(pa=Object(aa.a)(new Fa.a,{Text:pa}),this.gridView.setCell(pa,Sa.range,0,127,null),Ua.endEdit(!0,"TableTotalRowOptions.SetCellContent",0))}}ta.m5j="TableTotalRowDropDownIconButtonId";ta.YK=null;Object(b.a)(ta,"TableTotalRowOptions",R.a,[2]);let Oa=class extends u.a{constructor(pa){super(E.h(pa));this.Jub=this.l3=this.qHc=this.Hub=null;this.bBe=!1;this.Zje=null;this.MXb=0;this.Sac=null;this.A6b=()=>{const Ua={},Sa=this.Uod();
for(let X in Sa){const ca=Sa[X];if(!ca)continue;const U=this.rgi(ca);if(U){if(U in this.VIa){var Ia=this.VIa[U];if(Ia.zC){Ia.ko.equals(ca)||(Ia.ko=ca);delete this.VIa[U];Ua[U]=Ia;continue}}(Ia=ea.createInstance(E.h(this.$),ca,this.H_h(),this))?Ua[U]=Ia:d.ULS.sendTraceTag(537151239,0,15,`TableManager.AttachTableResizeBehavior - Attaching Grippie Failed for Range ${ca.vz(!1)}`)}}this.Q8b(null,null);this.sWb=Ua};this.Q8b=()=>{const Ua=this.VIa;for(let X in Ua){var Sa=X,Ia=Ua[X];Ia&&(Ia.dispose(),delete this.VIa[Sa])}this.sWb=
{}};this.$_f=()=>{this.Q8b(null,null);this.A6b(null,null)};this.onFocus=()=>{this.Zje=E.h(this.$).ga.pa.activeCell};this.P8=()=>{this.$.isEditMode&&this.Ff(null,null)};this.Ff=()=>{!this.bBe&&D.c(this.$,this.gridView.ga.pa.activeCell)&&this.HOi()};this.WE=()=>{this.QDb(1);this.$.ea.en(this.WE)};this.JMb=()=>{this.bBe=!0;this.qHc=new ta(this.$)};this.$=pa;this.gridView=E.h(this.$);O.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateTableManager",!1)||this.$.da.Ja(66,this);this.sWb={};
this.A6b(null,null);this.$.ua&&this.$.ua.Vg(this.$_f);this.X2c(this.A6b);this.$.ea.c5(this.P8);this.gridView.ga.add_activeCellChanged(this.Ff);this.$.isEditMode&&this.Ff(null,null)}X2c(pa){this.addHandler(u.a.ifb,pa)}QSd(pa){this.removeHandler(u.a.ifb,pa)}sWg(pa){this.addHandler("tce",pa)}Kxj(pa){this.removeHandler("tce",pa)}get VIa(){return this.sWb}get lBd(){return this.Zje}get HLa(){return this.MXb}get Vj(){const pa=E.h(this.$);return pa.Wb.rh(pa.ga.pa.activeCell,!1)}get tOd(){return this.lBd?
E.h(this.$).Wb.rh(this.lBd,!1):null}Uzd(pa){return!!this.Pcf(pa)}Uq(pa){return this.Hci(this.zdf(pa))}tAb(pa){return this.zdf(pa)}vvj(pa){pa?(this.Jub?this.Jub!==pa&&(h.a.Ka(this.l3),this.l3=null,this.Jub=pa):this.Jub=pa,this.l3||(this.l3=M.a.instance.Re(this.Jub)),this.l3.Ij("focusin")||this.l3.la("focusin",this.onFocus)):d.ULS.sendTraceTag(537151245,0,15,"TableManager.RegisterToTextboxFocusEvent empty textBoxDomElement recieved")}wrf(pa,Ua){return pa?pa.Zma&&pa.top===Ua.top:(d.ULS.shipAssertTag(537151244,
0,!!pa,"autofilterRange can't be null"),!1)}Dma(pa){pa=this.Hub?z.J(pa,this.Hub):this.view.getRangeInformation(pa);return 0<pa.length&&Object(k.a)(w.PivotTableRange,pa[0])?pa[0]:null}vAi(pa,Ua){return pa?!pa.$mc&&!!pa.Fw&&pa.Fw.Yd(Ua):(d.ULS.shipAssertTag(537151243,0,!!pa,"Pivot table can't be null"),!1)}nHi(pa,Ua){return pa?!pa.$mc&&!!pa.Xt&&pa.Xt.Yd(Ua):(d.ULS.shipAssertTag(537151242,0,!!pa,"Pivot table can't be null"),!1)}k4b(pa){super.k4b(pa);if((pa=B.HelperMethods.adf(pa))&&0<pa.length){this.Hub=
Array(pa.length);for(let Ua=0;Ua<pa.length;Ua++)this.Hub[Ua]=x.a.cS(pa[Ua])}}dOb(){super.dOb();this.Hub=null}Dlh(pa,Ua){return this.pOe(pa,Ua).returnValue}pOe(pa,Ua){var Sa=!1;if(!pa||!Ua)return{returnValue:!1,m_:Sa};pa=pa.clone();pa.right+=1;pa.left=pa.right;return!pa.OA||pa.top<Ua.Mb.Hj&&(Sa=pa.clone(),Sa.bottom>=Ua.Mb.Hj&&(Sa.bottom=Ua.Mb.Hj-1),!({m_:Sa}=this.oOe(Sa,Ua)).returnValue)||pa.bottom>=Ua.Mb.Hj&&(Sa=pa.clone(),Sa.top<=Ua.Mb.Hj&&(Sa.top=Ua.Mb.Hj),!({m_:Sa}=this.oOe(Sa,Ua)).returnValue)?
{returnValue:!1,m_:Sa}:{returnValue:!0,m_:Sa}}xng(pa){(pa=this.Uq(pa.topLeft))&&pa.toString()in this.VIa&&(this.VIa[pa.toString()].uzd=!1)}Zoj(){this.raiseEvent("tce")}wi(pa,Ua){if(!this.qHc)return!1;switch(Ua){case -569786022:case 541421805:if(this.qHc.d1){const Sa=document.getElementById(ta.m5j);Sa&&H.a.instance.create(()=>{G.DOMElementExtensions.$lc(Sa,null)},0,F.a.f5j,!0,!0)}return!0;default:return!1}}dispose(){this.Q8b(null,null);this.QSd(this.A6b);this.$.ua.xh(this.$_f);this.$.Wl(this.Q8b);
this.sWb=null;this.$.ea&&this.$.ea.O9(this.P8);this.gridView.ga.remove_activeCellChanged(this.Ff);this.qHc=null;this.l3&&(h.a.Ka(this.l3),this.l3=null);super.dispose()}wni(pa,Ua,Sa,Ia){var X=this.gridView.Wb.rh(new m.Range(Ua,Sa,Ua,Sa,!1,!1));if(this.Sac=X){var ca=X.usedRange,U=pa.ctrlKey||l.a.isMac&&L.b(pa);X=!pa.shiftKey&&U;pa=pa.shiftKey&&!U;E.h(this.$).ga.selectionType=3;switch(Ia){case 0:this.MXb=0;Ua=this.Vbd(pa,ca.top,Sa,ca.bottom,Sa);this.VYd(Ua,X,pa);break;case 1:this.MXb=1;Ua=this.Vbd(pa,
Ua,ca.left,Ua,ca.right);this.VYd(Ua,X,pa);break;case 2:this.MXb=2;Ua=this.Vbd(pa,ca.top,ca.left,ca.bottom,ca.right);this.VYd(Ua,X,pa);break;default:d.ULS.shipAssertTag(537151240,0,!1,`TableManager.HandleTableSelectorsSelection: Table Selector can not be of type: ${Ia.toString()}`);return}E.h(this.$).ga.selectionType=3;d.ULS.sendTraceTag(527212953,0,50,"TableManager.handleTableSelectorsSelection: A table selector was clicked using hover arrows")}else d.ULS.shipAssertTag(537151241,0,!1,"TableManager.HandleTableSelectorsSelection: Table for table selector selection can't be null")}eUj(pa){const Ua=
this.Sac.usedRange;return this.Itf(pa)||1!==this.HLa&&this.Itf(new m.Range(Ua.top,pa.left,Ua.bottom,pa.right,!1,!1))?!0:!1}LPd(pa){return pa.Autofilters}oOe(pa,Ua){let Sa;Sa=!1;const Ia=Ua.Mb.Di(pa),X=Ua.sg(Ia).sk;if(!X)return d.ULS.sendTraceTag(537151238,0,15,`TableManager.CouldExpandImpl - loadedRange is null. PaneType=${Ia}`),{returnValue:!1,m_:Sa};if(!X.ff(pa))return{returnValue:!0,m_:Sa};pa=Ua.Bj("TableManager.CouldExpandImpl",pa,2);try{for(;pa.$$mn();){if(pa.$$cu().text||pa.Qm.dkc)return Sa=
!0,{returnValue:!1,m_:Sa};if(pa.$$cu().UG)return{returnValue:!1,m_:Sa}}}finally{pa&&pa.dispose()}return{returnValue:!0,m_:Sa}}Hci(pa){if(!pa)return null;const Ua=new v.AutofilterRange(pa.top,pa.left,pa.bottom,pa.right,null,null,null,pa.id,pa.Zma);Ua.XDa=pa.XDa;const Sa=this.gridView.Wb.rh(pa,!0);if(!Sa)return null;for(let Ia=0,X=this.rangeList.length;Ia<X;Ia++){const ca=this.rangeList[Ia],U=this.gridView.Wb.rh(ca,!0);U&&U.name===Sa.name&&ca!==pa&&this.pGi(ca)&&(Ua.union(ca),ca.XDa&&(Ua.XDa=!0))}return Ua}pGi(pa){return!!E.h(this.$).Wb.rh(pa)}H_h(){const pa=
[];for(const Ua of this.rangeList){const Sa=new I.a(this.Uq(Ua.topLeft),t.d(this.$.na));pa.push(Sa)}return pa}Uod(){const pa={};for(const Ua of this.rangeList){if(!Ua)continue;const Sa=this.Uq(Ua.topLeft);Sa&&(pa[Sa.toString()]=this.Uq(Ua.topLeft))}return pa}HOi(){this.$.ea.fg?this.QDb(0):this.$.ea.yk(this.WE)}QDb(pa){this.$.wz(Ua=>{Ua.t0(pa).then(this.JMb)})}rgi(pa){const Ua=this.gridView.Wb.rh(pa);return Ua?Ua.name:pa.toString()}VYd(pa,Ua,Sa){pa&&(Sa=Sa?E.h(this.$).ga.pa.activeCell:pa.topLeft,Ua?
this.gridView.ga.updateSelection(pa,Sa,0,1):this.gridView.ga.wH([pa],0,Sa,0))}Vbd(pa,Ua,Sa,Ia,X){const ca=y.d(this.Sac),U=y.g(this.Sac),ma=Ua+(1!==this.HLa&&ca?1:0),ra=Ia-(1!==this.HLa&&U?1:0),Va=this.gridView.inRangePicker||this.gridView.hj;if(pa){var ob=Va&&!I.a.iac(this.gridView.ga.rangePicker.sP).length?new m.Range(ma,Sa,ra,X,!1,!1):Va?this.gridView.ga.rangePicker.activeCell:this.gridView.ga.pa.activeCell;ob=new m.Range(ob.top<ma?ob.top:ma,ob.left<Sa?ob.left:Sa,ob.bottom>ra?ob.bottom:ra,ob.right>
X?ob.right:X,!1,!1)}else ob=new m.Range(ma,Sa,ra,X,!1,!1);if(1!==this.HLa&&(ca||U)&&(!pa||pa&&this.k$c(ob,ma,Sa,ra,X))){pa=Va?I.a.iac(this.gridView.ga.rangePicker.sP):this.gridView.ga.pa.selectedRanges;for(const ja of pa)if(this.k$c(ja,ma,Sa,ra,X)){ob.top=Ua;ob.bottom=Ia;break}}return ob}Itf(pa){const Ua=this.gridView.inRangePicker||this.gridView.hj?I.a.iac(this.gridView.ga.rangePicker.sP):this.gridView.ga.pa.selectedRanges;for(const Sa of Ua)if(this.k$c(Sa,pa.top,pa.left,pa.bottom,pa.right))return!0;
return!1}k$c(pa,Ua,Sa,Ia,X){return!!pa&&pa.top===Ua&&pa.bottom===Ia&&pa.left===Sa&&pa.right===X}};Oa=Object(f.b)([Object(Ba.d)(fa.Db),Object(f.c)(0,Object(fa.E)())],Oa);Object(b.a)(Oa,"TableManager",u.a,[257,2]);class Ma extends e.a{constructor(pa){super();this.tableManager=null;this.$=pa;this.uc()}create(){this.$b(this.tableManager||(this.tableManager=new Oa(this.$)))}}Object(b.a)(Ma,"TableManagerFactory",e.a,[]);a.d(C,"a",function(){return fb});const fb=()=>{c.a.Fa(pa=>{O.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateTableManager",
!1)||pa.da.Ja(134,new Ma(pa))})};String(r);window.___1684780594421_closurehack=r},1273:function(r,C,a){var c=a(10);r=a(0);var b=a(230),e=a(15),f=a(126),d=a(123),h=a(34),l=a(39);class k extends d.a{constructor(B,E){super(B,E)}execute(B){const E=Object(f.a)(8,B.wf);e.ULS.shipAssertTag(537153921,0,h.a.htb(B.errors),"SessionReloadActivity.Execute: Only recoverable errors should reach this activity.");E.PJ(!0,!0);B.activityState[l.a.O3b]=E.ea.sessionId;B.activityState[l.a.Erb]=!0;B.activityState[l.a.U3b]=
!0;e.ULS.sendTraceTag(537153920,0,50,"SessionReloadActivity.Execute: session is going to reopen from cached state");return 3}}Object(r.a)(k,"SessionReloadActivity",d.a,[]);var u=a(8);class v extends b.a{constructor(){super();this.uc()}create(){this.$b(new k(u.a.lhb,u.a.rA))}static la(B){B.da.Ja(142,new v)}}Object(r.a)(v,"SessionReloadActivityFactory",b.a,[]);var x=a(62),w=a(280),m=a(129),t=a(51),z=a(48),y=a(38),D=a(1),H=a(44),F=a(259),G=a(125);class L extends d.a{constructor(B,E,I,S,J){super(B,E);
L.JEd=[-1468309555,611268539,-2087635043,2100961153,810218235,1112506702];L.IEd=[-1468309555,-315732528,-399065540,810218235,1531005923,1593924569,1112506702,1220851643];L.bDf=[-1468309555,611268539,-1750576502,61029505];L.aDf=[-1468309555,-315732528,1112506702,-238814601,-1750576502,61029505,-1337545025];this.FFc=I;this.j_j=S;this.L8j=J}execute(B){var E=Object(f.a)(8,B.wf);B.activityState[l.a.Lua]=!0;var I=L.mfi(B);if(L.TTj(B,I))return L.DUi(B),I=50,0<B.errors.length&&(I=15),e.ULS.sendTraceTag(537153891,
0,I,`SessionReloadSilentActivity.ShouldCancelReload: ignore session reload, remaining errors : ${h.a.Uc(B.errors)}`),B.activityState[l.a.Lua]=!1,this.hi(u.a.idle),3;switch(I){case 1:case 3:this.Zvi(B,I);break;case 2:this.Yvi(B);break;case 0:B.activityState[l.a.l1a]=null}e.ULS.sendTraceTag(21837003,0,50,`SessionReloadSilentActivity.Execute: silentReloadType:${I}. activityName:${this.activityName}. NextActivityName:${this.N1}. TimeFromLastStatefulResponse:${E.ea.SY}.`);var S=y.a.mh(B.activityState,
G.a.Hjb);e.ULS.shipAssertTag(40502925,0,!S||S&&(1===I||3===I),`triggerSilentReloadAfterTokenRefresh: ${S}, silentReloadType: ${I}`);E=E.Vl.reloadCount;return 0!==I&&0<E?(S=w.a.kOa(E,200),e.ULS.sendTraceTag(537153890,0,50,`SessionReloadSilentActivity.Execute: schedule Silent-Type [${I}] retryNum [${E}] delayInMs [${S}] activityName [${this.activityName}]`),t.a.instance.create(()=>{L.SN(B)},S,z.a.BLj),1):3}Zvi(B,E){e.ULS.sendTraceTag(8438495,0,50,"SessionReloadSilentActivity.InitiateSilentReopen: Silent reopen triggered");
const I=Object(f.a)(8,B.wf);B.activityState[l.a.Erb]=!0;I.nmc||H.PageLoadTrackingInfo.instance.Lk("ReopenOnLoad");!L.isEditMode(B)&&h.a.htb(B.errors)&&(e.ULS.sendTraceTag(537153889,0,50,"SessionReloadSilentActivity.ShouldAttemptViewSilentReopen: session is going to reopen from cached state"),B.activityState[l.a.O3b]=I.ea.sessionId,B.activityState[l.a.U3b]=!0);B.aFd();3===E?(I.ea.Ag()||I.ea.b_i(),I.PJ(!0,!0),this.hi(this.L8j),B.activityState[l.a.Eve]=I.workbookContext.CalcMode):(D.EwaSettings.isChangeGateEnabled("OfficeVSO:5678588_FixSilentReopenAfterTokenRefresh")&&
1===E&&I.PJ(!0,!0),B.activityState[l.a.r1c]=!1,this.hi(this.FFc))}Yvi(B){e.ULS.sendTraceTag(537153888,0,15,"SessionReloadSilentActivity.InitiateSilentRefresh: Silent refresh triggered");B.activityState[l.a.l1a]=null;B.aFd();this.hi(this.j_j);B=Object(f.a)(8,B.wf);B.nmc||(H.PageLoadTrackingInfo.instance.Lk("RefreshOnLoad"),B.ZOb())}static SN(B){B.SN()}static mfi(B){const E=Object(f.a)(8,B.wf),I=E.ea,S=L.isEditMode(B);var J=h.a.Ph(B.errors,S?L.IEd:L.JEd);const K=h.a.Ph(B.errors,S?L.aDf:L.bDf),R=E.yS,
Z=E.Vl.reloadCount,P=E.xa.MaxConsecutiveSilentReloadAllowed,V=E.Vl.tjf(),Ea=h.a.Uc(B.errors),oa=h.a.Uc(B.uCa),ea=0<h.a.eO(za=>!za.triggerSilentReopenOnly,B.errors).length;let aa=J;const ia=y.a.mh(B.activityState,G.a.Hjb);ia&&(aa=!0);const ya={name:"SessionReloadSilentActivity.GetSilentReloadType"};ya.editMode=S;ya.isSilentReopenError=J;ya.isSilentRefreshError=K;ya.reloadSequenceCount=E.Vl.fUa;ya.reloadCount=Z;ya.maxReloads=P;ya.stopSilentReloads=V;ya.errorNames=Ea;ya.processedErrorNames=oa;ya.isClientDirty=
R;ya.errorsForSilentReopenOnly=ea;ya.triggerSilentReloadAfterTokenRefresh=ia;ya.IsReopenDisabled=E.tQa;J=x.a.nd(ya);e.ULS.sendTraceTag(21837004,0,50,J);if(!V){if(aa&&(S?L.JTj(B):L.MTj(B)))return F.a.Fgg(B,E)?3:E.tQa?2:1;if(K&&(S||!I.wfb))return 2}return 0}static TTj(B,E){for(const I of B.errors)if(-1337545025===I.MessageId||-238814601===I.MessageId)return!1;return h.a.eO(I=>!I.triggerSilentReopenOnly,B.errors).length?3!==E:!1}static DUi(B){const E=h.a.eO(I=>!I.triggerSilentReopenOnly,B.errors);for(const I of E)B.Xea(I)}static isEditMode(B){const E=
Object(f.a)(8,B.wf);return E.ea.Oc?E.Ts&&!!(E.oe&64):y.a.mh(B.activityState,l.a.qt)}static MTj(B){const E=Object(f.a)(8,B.wf),I=h.a.K6(B.errors,L.JEd);if(m.b(I,S=>S.ForceVersionUpgrade))return!1;B=h.a.htb(B.errors);return!E.ea.wfb||B?!0:!1}static JTj(B){B=h.a.K6(B.errors,L.IEd);return!m.b(B,E=>E.ForceVersionUpgrade)}}L.JEd=null;L.IEd=null;L.bDf=null;L.aDf=null;Object(r.a)(L,"SessionReloadSilentActivity",d.a,[]);class M extends b.a{constructor(B,E){super();this.activityName=B;this.uL=E;this.uc()}create(){this.$b(new L(this.activityName,
this.uL,u.a.rA,u.a.Mj,u.a.iUb))}static la(B){B.da.Ja(143,new M(u.a.rqa,u.a.H6b));B.da.Ja(144,new M(u.a.lDc,u.a.RSa));B.da.Ja(145,new M(u.a.mDc,u.a.uLd));B.da.Ja(154,new M(u.a.mhb,u.a.xQ))}}Object(r.a)(M,"SessionReloadSilentActivityFactory",b.a,[]);a.d(C,"a",function(){return O});const O=()=>{c.a.Fa(B=>{v.la(B);M.la(B)})}},1291:function(r,C,a){r=a(0);var c=a(230),b=a(15),e=a(179),f=a(260),d=a(384),h=a(6),l=a(667),k=a(93),u=a(101),v=a(273),x=a(177),w=a(83),m=a(429),t=a(52),z=a(40),y=a(91),D=a(76),H=
a(1),F=a(587),G=a(19),L=a(30);class M extends u.a{constructor(R,Z){super(R);this.FU=[];this.Uje=null;this.wPb=P=>{let V="forward";P.Values[d.a.direction]?V=P.Values[d.a.direction].toLowerCase():b.ULS.sendTraceTag(537166664,0,15,"Didn't find direction in message values");P=0;let Ea=!0;"backward"===V?(P=this.gBd.length-1,Ea=!1):"forward"===V?(P=0,Ea=!0):b.ULS.sendTraceTag(537166663,0,15,`Received unknown direction to resume focus: ${V}`);this.kFf(Ea,P,!1)};this.UNf=()=>{this.FU=[]};this.wSa=P=>{-411645385===
this.$.shortcutKeyManager.Ms(P,!0)&&this.hsf()&&(this.$.Ia.mc(new y.a(-411645385,1,this.$.Tc,6,null),{["event"]:P},P),P.stopPropagation())};this.S8i=P=>{this.Zoa(P)};this.Ub=Z;this.su=G.h(this.Ub);this.Dd.la("keydown",this.S8i);this.Dd.la("keyup",this.wSa);v.a(Z).kZg(this.UNf);w.a(Z.xa,27)&&z.TaskExtensions.za(t.GetServiceTaskFactory.Za(Z.da,21,137,1),P=>{P=P.result;P.wn(e.a.Wkf);P.ql(e.a.Wkf,this.wPb)},Z.ka)}get $(){return this.Ub}get gBd(){this.FU.length||(this.FU=this.mbf());return this.FU}get goa(){return this.Uje}set goa(R){this.Uje=
R;this.FU=this.mbf()}dispose(){this.$&&v.a(this.$).aAj(this.UNf);this.Ub=null;this.FU.length=0;super.dispose()}Smj(R){this.Zoa(R)}kFf(R,Z,P=!0,V=null){var Ea=this.A4j(R,Z,P,V);if(!Ea){P=Z;var oa=R?1:-1,ea=this.gBd;do{Ea=!1;if(w.a(this.$.xa,27)){if(P+=oa,P>=ea.length||0>P)Ea=!0}else P=(P+oa+ea.length)%ea.length;if(Ea){this.QSi(R,Z,V);break}else if(Ea=this.gng(R,Z,P,!1,V))break}while(P!==Z)}}A4j(R,Z,P=!0,V=null){let Ea=null;0<=Z&&(Ea=this.FU[Z]);return(null===Ea||void 0===Ea?0:Ea.Fg)&&Ea.$g(R,P)?(V&&
D.g(V),b.ULS.sendTraceTag(537166669,0,50,`Switched focus inside current section ${Ea.Qe} into a sub region`),Ea.pk(),!0):!1}gng(R,Z,P,V,Ea=null){P=this.FU[P];if(H.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",!1)){const oa=v.a(this.Ub).Ux(f.a.Dxa),ea=v.a(this.Ub).Ux(f.a.iCb),aa=this.su.ga.Sa.DS;if(P===ea&&aa||P===oa&&!V&&!aa)return!1}if((null===P||void 0===P?0:P.Fg)&&P.$g(R,!1)){Ea&&D.g(Ea);P.pk();if(R=this.FU[Z])R.Rk(),b.ULS.sendTraceTag(537166668,0,50,`Switched focus from section ${R.Qe} to ${P.Qe}`);
return!0}return!1}QSi(R,Z,P=null){P&&D.g(P);if(Z=this.FU[Z])Z.Rk(),b.ULS.sendTraceTag(537166666,0,50,`Lost focus from section ${Z.Qe}`);z.TaskExtensions.za(t.GetServiceTaskFactory.Za(this.$.da,21,137,0),V=>{V.result.sendMessage(e.a.krb,{[d.a.direction]:R?"forward":"backward"})},this.$.ka)}Zoa(R){var Z=this.$.isEditMode?x.a(this.$):null;if(!this.$.Zb.Sza||M.LDi(Z))if(117===R.keyCode&&(R.ctrlKey||D.b(R))){Z=this.pef(R.target);var P=!R.shiftKey;b.ULS.sendTraceTag(537166662,0,50,`AccessibilityManager.OnKeyDownHandler: Ctrl+F6 loop. The root index section is: ${Z}`);
if(H.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",!1)){var V=v.a(this.Ub).Ux(f.a.CPb);V=this.FU.indexOf(V);h.AFrameworkApplication.sa.Qa.$x&&this.$.m1&&-1!==V&&Z===V&&l.ShyRibbon.bL(this.$.tib,0)}else h.AFrameworkApplication.sa.Qa.$x&&this.$.m1&&1===Z&&l.ShyRibbon.bL(this.$.tib,0);this.kFf(P,Z,!0,R)}else 117!==R.keyCode||M.d3e?-411645385===this.$.shortcutKeyManager.Ms(R)?this.hsf()&&(this.$.Ia.mc(new y.a(-411645385,1,this.$.Tc,6,null),{["event"]:R},R),R.stopPropagation()):
1588554917===this.$.shortcutKeyManager.Ms(R)?0===this.mode?(F.a(this.$)||this.$.Ia.mc(new y.a(1588554917,1,this.$.Tc,6,null),{["event"]:R},R),R.preventDefault(),R.stopPropagation()):3===this.mode&&(R.preventDefault(),R.stopPropagation()):-1966746939===this.$.shortcutKeyManager.Ms(R)?(R.preventDefault(),R.stopPropagation()):H.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",!1)&&1058684758===this.$.shortcutKeyManager.Ms(R)?(Z=this.pef(R.target),V=v.a(this.Ub).Ux(f.a.CPb),
P=v.a(this.Ub).Ux(f.a.Dxa),V=this.FU.indexOf(V),P=this.FU.indexOf(P),h.AFrameworkApplication.sa.Qa.$x&&this.$.m1&&-1!==V&&Z===V&&1===this.$.tib&&l.ShyRibbon.bL(1,0),-1!==P&&Z!==P&&this.gng(!0,Z,P,!0,R)):this.qli(R):(R=m.a.PF.notificationBar.Y5(k.a.N5h(),!1),L.a.cGb()?R.image=3:R.image=0,m.a.PF.notificationBar.LD(R),M.d3e=!0)}pef(R){const Z=this.gBd;for(let P=0,V=Z.length;P<V;++P){const Ea=Z[P];if(Ea&&Ea.ui(R))return P}return-1}mbf(){const R=[];for(let Z=0,P=this.goa.length;Z<P;Z++){const V=v.a(this.$).Ux(this.goa[Z]);
V&&R.push(V)}return R}hsf(){return 0===this.mode||4===this.mode}static LDi(R){return R?R.inKeytipMode:!1}}M.d3e=!1;Object(r.a)(M,"AccessibilityManager",u.a,[314,2]);var O=a(163),B=a(23),E=a(16);class I extends M{constructor(R){super(document.documentElement,R);this.CD=0;this.e5g=[f.a.aOe,f.a.HHd,f.a.rkc,f.a.R4d,f.a.CPb,f.a.H6c,f.a.mkd,f.a.bhf,f.a.R5c,f.a.vHc,f.a.K_j,f.a.iCb,f.a.L7c,f.a.Dxa,f.a.VZd,f.a.R7c,f.a.Clg,f.a.$yf,f.a.j6c];this.qkk=[f.a.rkc,f.a.Hwg,f.a.Gwg,f.a.Iwg];this.umj=[f.a.rkc,f.a.oYf,
f.a.pYf,f.a.sYf];this.nch=[f.a.h6e,f.a.ahf,f.a.lkd,f.a.kkd,f.a.WRe];this.Wlj=[f.a.aOe,f.a.HHd,f.a.H6c,f.a.mkd,f.a.R5c,f.a.vHc,f.a.iCb,f.a.L7c,f.a.Dxa,f.a.VZd,f.a.LXf,f.a.R7c,f.a.j6c];this.jmj=[f.a.iCb,f.a.n6e];const Z=E.a.instance.Ha(253);this.TNj=this.$.shortcutKeyManager.fBb(Z);this.mode=0;R.da.Ja(15,this);z.TaskExtensions.za(t.GetServiceTaskFactory.Za(R.da,21,137,1),P=>{P=P.result;P.wn(e.a.krb);P.ql(e.a.krb,this.wPb)},R.ka)}get mode(){return this.CD}set mode(R){this.CD=R;switch(R){case 0:this.goa=
this.e5g;break;case 2:this.goa=this.qkk;break;case 3:this.goa=this.umj;break;case 4:this.goa=this.nch;break;case 5:this.goa=this.Wlj;break;case 6:this.goa=this.jmj;break;default:b.ULS.shipAssertTag(537170759,0,!0,"Accessibility Mode value is not in allowed values")}}Zoa(R){this.$.oe&65536&&super.Zoa(R)}qli(R){if(B.a.equals(this.TNj,this.$.shortcutKeyManager.snd(R),!1)){const Z=O.b(this.$);if(null===Z||void 0===Z?0:Z.Fg)D.g(R),Z.$g(!0,!1)}}}Object(r.a)(I,"EwaAccessibilityManager",M,[]);class S extends c.a{constructor(R){super();
this.$=R;this.uc()}create(){this.$b(this.$.da.Ba(15)||new I(this.$))}static la(R){R.da.Ja(157,new S(R))}}Object(r.a)(S,"AccessibilityManagerFactory",c.a,[]);var J=a(10);a.d(C,"a",function(){return K});const K=()=>{J.a.Fa(S.la)}},1316:function(r,C,a){r=a(0);var c=a(113),b=a(230),e=a(15),f=a(14),d=a(42),h=a(91),l=a(1),k=a(19),u=a(7);class v extends d.a{constructor(z,y,D){super();this.statusBarManager=null;this.jUe=()=>{this.Ybc()};this.pyh=()=>{this.Ybc()};this.iUe=H=>{10===H&&this.Ybc()};this.onKeyDown=
H=>13===H.Da.keyCode?(H=new h.a(237279923,1,2,6,null),this.$.Ia.mc(H,{[u.a.skipClipboardAccess]:!0,[u.a.nYe]:!0}),!0):!1;this.$=z;this.Ip=y;this.Jn=D;this.agd=!1;(this.Lhg=l.EwaSettings.isChangeGateEnabled("OfficeVSO:7568646_PressEnterToPaste"))&&this.$.da.Qb(29,H=>{this.statusBarManager=H;H.TK(this)})}dispose(){this.xj();this.Jn=this.Ip=this.$=null;this.statusBarManager&&(this.statusBarManager.pH(this),this.statusBarManager=null)}Co(){return this.Lhg}Gt(z,y){if("QueryPasteShortcutEnabledLabel"!==
z&&!v.L2j.includes(z))return!1;const D=this.Xo();"QueryPasteShortcutEnabledLabel"===z?(y.Visible=D,e.ULS.sendTraceTag(537167636,0,100,`PasteShortcutManager.ExecuteRootCommand: Setting visible to ${D} for commandId ${z}`)):(y.Visible=!D,e.ULS.sendTraceTag(537167635,0,100,`PasteShortcutManager.ExecuteRootCommand: Setting visible to ${!D} for commandId ${z}`));return!0}lDh(){this.vj();this.raiseEvent("pasteShortcutStatusChanged")}Ybc(){this.xj();this.raiseEvent("pasteShortcutStatusChanged")}Xo(){return this.agd}Ar(z){this.addHandler("pasteShortcutStatusChanged",
z)}$r(z){this.removeHandler("pasteShortcutStatusChanged",z)}vj(){if(!this.Xo()){this.agd=!0;k.h(this.$).ai.ro(this.jUe);this.Jn.la("blur",this.pyh);const z=this.$.da.Ba(65);z&&z.P5&&z.P5.registerForCommentEvents(this.iUe);this.Ip.Tt(f.a.Ic,this.$.Hw,this.onKeyDown,!0)}}xj(){if(this.Xo()){this.agd=!1;k.h(this.$).ai.io(this.jUe);this.Jn.detach("blur");const z=this.$.da.Ba(65);z&&z.P5&&z.P5.unregisterForCommentEvents(this.iUe);this.Ip.fu(f.a.Ic,this.$.Hw,this.onKeyDown,!0)}}}v.L2j=["QuerySheetNumberButton",
"QueryWorkbookStatisticsButton"];Object(r.a)(v,"PasteShortcutManager",d.a,[307,204,205,2]);var x=a(141);class w extends b.a{constructor(z){super();this.$=z;this.uc()}create(){const z=this.$;this.$b(z.da.Ba(478)||this.$.da.Ja(478,new v(z,c.KeyInputManager.instance,x.a.instance.JI())))}static la(z){z.da.Ja(479,new w(z))}}Object(r.a)(w,"PasteShortcutManagerFactory",b.a,[]);var m=a(10);a.d(C,"a",function(){return t});const t=()=>{m.a.Fa(z=>{w.la(z)})}},1317:function(r,C,a){var c=a(10);r=a(0);var b=a(724),
e=a(15),f=a(108),d=a(6),h=a(1414),l=a(1),k=a(199),u=a(63);class v{constructor(F,G,L){this.kxb=null;this.$=F;G?(e.ULS.sendTraceTag(537163346,0,50,"DataFromPictureCommandHandler.constructor - AugmentationLoopManager and UploaderCreator instantiated."),this.kxb=new h.a(F,G,L)):e.ULS.sendTraceTag(537163347,0,10,"DataFromPictureCommandHandler.constructor - Failed to instantiate AugmentationLoopManager.")}yd(){return!1}executeCommand(F,G,L){F=!1;switch(G.command){case 73979048:this.kxb&&this.kxb.zlj(G,
f.a.instance,d.AFrameworkApplication.fa,L),F=!0}return F?u.Task.Ua(!0):k.a(G.command)}fd(F,G){return 73979048===G.command&&l.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",!1)}Cd(){return!1}dispose(){this.kxb&&this.kxb.dispose()}}Object(r.a)(v,"DataFromPictureCommandHandler",null,[210,2]);var x=a(40),w=a(52),m=a(100),t=a(149),z=a(35),y=a(72);class D extends b.a{constructor(F){super(F)}ue(){const F=l.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateAugmentationLoopToNewServiceInfra",
!1)?Object(m.d)(t.a.resolve(z.f,{Wa:1})):w.GetServiceTaskFactory.Za(this.$.da,328,327,1),G=Object(y.b)("OfficeVSO:7625189_MoveUploaderCreatorToNewServiceInfra")?Object(m.d)(t.a.resolve(z.Ib,{Wa:this.La})):w.GetServiceTaskFactory.Za(this.$.da,484,485,1);x.TaskExtensions.za(x.TaskExtensions.xe([F,G],this.$.ka),()=>{this.Zd([new v(this.$,F.result,G.result)])},this.$.ka,3)}static la(F){b.a.Ie(452,new D(F))}}Object(r.a)(D,"DataFromPictureCommandHandlerFactory",b.a,[]);a.d(C,"a",function(){return H});const H=
()=>{c.a.Fa(F=>{D.la(F)})}},1318:function(r,C,a){r={};a.r(r);a.d(r,"SparklineManager",function(){return v});var c=a(10),b=a(72),e=a(0),f=a(230),d=a(118),h=a(488),l=a(19),k=a(149),u=a(35);let v=class extends h.a{constructor(m){super(Object(l.h)(m));Object(b.b)("OfficeVSO:7624512_MigrateSparklineManagerService")||m.da.Ja(240,this)}wfi(m){for(const t of this.rangeList)if(m.range.contains(t))return t;return null}LPd(m){return m.GridBlockModel&&(m=gridRenderer.CanvasRendererFactoryGlobal.getModelAccessor(m.GridBlockModel))?
m.getSparklineRanges():null}};v=Object(d.b)([Object(k.d)(u.Bb),Object(d.c)(0,Object(u.E)())],v);Object(e.a)(v,"SparklineManager",h.a,[256]);class x extends f.a{constructor(m){super();this.sparklineManager=null;this.$=m;this.uc()}create(){this.$b(this.sparklineManager||(this.sparklineManager=new v(this.$)))}static la(m){m.da.Ja(239,new x(m))}}Object(e.a)(x,"SparklineManagerFactory",f.a,[]);a.d(C,"a",function(){return w});const w=()=>{c.a.Fa(m=>{Object(b.b)("OfficeVSO:7624512_MigrateSparklineManagerService")||
x.la(m)})};String(r);window.___1684780593945_closurehack=r},1319:function(r,C,a){r=a(0);var c=a(563),b=a(88),e=a(15),f=a(172),d=a(6),h=a(43),l=a(64),k=a(801);class u{constructor(m,t){this.jZc=this.iZc=null;this.y0a=new f.a;this.Ah=m;this.LIa=t.appSettings[u.mlk]||""}get vTj(){return this.y0a.task}get K5(){return this.Ah.value}PCj(){const m={};m[u.Nni]=d.AFrameworkApplication.oj;m["Content-Type"]="application/json; charset=utf-8";e.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");
const t=l.a.Kl(this.LIa+u.wTj,u.b0i,d.AFrameworkApplication.sa.Qa.li.toString());this.K5.Sn(t,1,"",m,!0,2,Object(b.a)(this,this.zLb,"onSuccessCallback"),Object(b.a)(this,this.JKb,"onFailureCallback"),null,void 0,void 0,void 0,void 0,"20")}fRi(m){try{const t={};t.FlightName=m.FlightName;t.SessionID=m.SessionID;e.ULS.sendTraceTag(594883776,215,50,h.c(t))}catch(t){e.ULS.sendTraceTag(594883747,215,10,"Unable to log NavBarData")}}zLb(m){if((m=m.data.Pe)&&m.length)try{const t=h.a(m);this.iZc=t.NavBarDataJson;
e.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.");this.iZc?({Bt:this.jZc}=h.d(t.NavBarDataJson)).returnValue?(this.fRi(this.jZc),this.y0a.setResult(this.jZc)):(e.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",{["ShellData"]:k.a.Mjb(this.iZc)}),this.y0a.Zt()):(e.ULS.sendTraceTag(9000737,215,15,"ShellData is null"),this.y0a.Zt())}catch(t){e.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),this.y0a.Zt()}else e.ULS.sendTraceTag(6362369,
215,10,"Response from O365ShellServiceProxy is null.")}JKb(){this.y0a.Zt();e.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")}static get instance(){return u.Oa||(u.Oa=u.hma())}static hma(){return new u(new c.a(()=>d.AFrameworkApplication.qe),d.AFrameworkApplication.fa,d.AFrameworkApplication.sa.Qa.li)}}u.Nni="X-qs";u.b0i="at";u.wTj="O365ShellServiceProxy.ashx";u.Oa=null;u.mlk="ShellWebServiceBase";Object(r.a)(u,"O365ShellActor",null,[290]);var v=a(261);class x{constructor(){this.Nb=
null}get name(){return"Common.App.O365Shell"}Oi(m){this.Nb=m;this.Nb.register(u,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").gd().od(()=>new u(new c.a(()=>d.AFrameworkApplication.qe),d.AFrameworkApplication.fa,d.AFrameworkApplication.sa.Qa.li))}init(){d.AFrameworkApplication.fa.Rv(Object(b.a)(this,this.KC,"onFullAppSettingsReady"))}KC(){d.AFrameworkApplication.useO365ShellService&&d.AFrameworkApplication.sa.Qa.Uv&&this.Nb.resolve("Common.App.O365Shell.O365ShellActor").PCj()}dispose(){}static main(){v.a.instance.wj(new x)}}
Object(r.a)(x,"PackageManager",null,[4,5]);a.d(C,"a",function(){return w});const w=()=>{Type.registerNamespace("Common.App.O365Shell");x.main()}},1414:function(r,C,a){(function(c){a.d(C,"a",function(){return F});var b=a(0),e=a(15),f=a(173),d=a(126),h=a(1420),l=a(42),k=a(262),u=a(47),v=a(382),x=a(201),w=a(59),m=a(91),t=a(16),z=a(19),y=a(43),D=a(1421),H=a(1);class F extends l.a{constructor(G,L,M){super();this.Cri=h.a.getTypeName();this.vDb=this.DV=this.je=null;this.imageHeight=this.imageWidth=0;this.hPa=
this.errorMessage=this.tableData=null;this.gtd=0;this.K0c=!1;this.NRe=O=>{if(O){var B={};if(({Bt:B}=y.d(this.Puh(O.data))).returnValue&&(O=Object(d.a)(Object,B),"."===O.DataFromPictureWildcard))if(O.SessionId!==this.hPa)e.ULS.sendTraceTag(523805139,0,10,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");else switch(e.ULS.sendTraceTag(523805138,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - Message Received from SDX pane"),
O.CmdType){case "ACK":this.K0c=!0;this.Mng.stop();e.ULS.sendTraceTag(523805137,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - SDX pane launched.");this.kKj();0<this.errorMessage.length?this.wbg():0<this.tableData.length&&this.Pbg();break;case "insert_html":const I=this.$.qa.va;B={};var E=z.h(this.$).ga.pa.Sd.clone();B.PasteId=f.a.create().toString();B.DestinationRanges=u.s(u.v(E,this.$));E=O.Parameters.split("|",3);H.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveCCforDataFromPictureXLO",
!1)||e.ULS.sendTraceTag(523805136,0,50,`DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - LCC:${E[0]}|${E[1]}|${E[2]}.`);E=O.Parameters.indexOf("|");E=O.Parameters.indexOf("|",E+1);E=O.Parameters.indexOf("|",E+1);B.SourceHtml=O.Parameters.substring(E+1);B.CopyOperationId=null;const S=I.Pa(1,I.Lc());S.pasteHtmlParameters=B;v.a(this.$.userOperationManager,(J,K,R)=>w.g(I,"pasteHtmlContent",S,J,K,R,null,64),J=>new x.a(204,0,J,1),null);this.gtd++;e.ULS.sendTraceTag(523805135,0,50,`DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - Number of pastes to workbook per Session ID:${this.gtd.toString()}`)}}};
this.Bri=(O,B)=>{if(O=B.YB)if(!B.parentPath||1>=B.parentPath.length||B.parentPath[1]!==this.hPa)e.ULS.sendTraceTag(523805124,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - SessionID of received annotation does not match current Session ID.");else{e.ULS.sendTraceTag(523805123,0,50,"DataFromPictureManager.ImageToTableAnnotationHandler() - Annotation Received.");B=O.errorCode;switch(B){case null:case -1:this.errorMessage=t.a.instance.ha(2273);break;case 1:this.errorMessage=t.a.instance.ha(2274);
break;case 2:this.errorMessage=t.a.instance.ha(2275)}0<this.errorMessage.length&&e.ULS.sendTraceTag(523805122,0,10,`DataFromPictureManager.ImageToTableAnnotationHandler() - ErrorCode:${B?B.toString():"null"}.`);this.SAe.stop();this.tableData=O.html;this.K0c&&(0<this.errorMessage.length?this.wbg():0<this.tableData.length&&this.Pbg())}else e.ULS.sendTraceTag(523805125,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - Received annotation is null.")};this.$=G;this.augmentationLoopManager=
L;this.uploaderCreator=M;this.initialize()}dispose(){window.removeEventListener("message",this.NRe,!1);this.augmentationLoopManager.unregister("DataFromPicture");super.dispose()}Scj(G,L){e.ULS.sendTraceTag(523805146,0,50,"DataFromPictureManager.onSuccessfulFileLoad - Start function.");let M=new Image;M.onload=()=>{var O=document.createElement("canvas");O.width=M.width;O.height=M.height;const B=O.getContext("2d");try{B.drawImage(M,0,0,M.width,M.height)}catch(S){e.ULS.sendTraceTag(523805145,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't draw to canvas. ex.Message: ${S.message}`);
return}let E;try{E=O.toDataURL("image/jpeg")}catch(S){e.ULS.sendTraceTag(523805144,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg. ex.Message: ${S.message}`);return}O=E.split(",");if(2>O.length)e.ULS.sendTraceTag(523805143,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg.");else{O=O[1];try{var I=window.self.atob(O)}catch(S){e.ULS.sendTraceTag(523805142,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't convert image to byte string. ex.Message: ${S.message}`);
return}28E5<I.length?(e.ULS.sendTraceTag(523805141,0,15,"DataFromPictureManager.onSuccessfulFileLoad - Image exceeds max size limit."),L.ZXj()):(this.nGj(this.je,this.DV,O,M.width,M.height),URL.revokeObjectURL(M.src),M=null,e.ULS.sendTraceTag(523805140,0,50,"DataFromPictureManager.onSuccessfulFileLoad - End function."))}};M.src=G}zlj(G,L,M,O){this.je=G;this.DV=O;this.uploaderCreator.pui(this.$,L,M,O,this)}nGj(G,L,M,O,B){this.hPa=f.a.create().toString();this.gtd=0;this.vDb=M;this.imageWidth=O;this.imageHeight=
B;this.errorMessage=this.tableData="";this.K0c=!1;this.Mng=this.$.yc.vh("LoadResource","DataFromPictureTaskpaneLaunch");this.Mng.start();this.xfj(G,L);this.SAe=this.$.yc.vh("LoadResource","DataFromPictureAnnotation");this.SAe.start();this.Hhk()}Hhk(){if(this.vDb.length){var G=window.self.atob(this.vDb);var L=new Uint8Array(G.length);for(let M=0;M<G.length;M++)L[M]=G.charCodeAt(M);this.augmentationLoopManager.Ghk(L,this.hPa,this.imageWidth,this.imageHeight)}else e.ULS.sendTraceTag(523805134,0,10,"DataFromPictureManager.UploadImageToAugmentationLoop - imageDataBase64 is empty")}xfj(G,
L){L.SessionID=this.hPa;L.DataFromPictureAssetId="FA000000050";L.LoadDataFromPictureTaskpane=!0;G=new m.a(-859308420,G.method,G.mode,G.Jf,G.tabName);this.$.Ia.mc(G,L)}xfd(G){try{const L=c.from(G,"utf16le").toString("base64");return D.a.lLa(this.hPa,L)}catch(L){return e.ULS.sendTraceTag(523805133,0,10,"DataFromPictureManager.encodeAndEncrypt - Buffer can't encode message."),""}}Puh(G){try{const L=D.a.lLa(this.hPa,G);return c.from(L,"base64").toString("utf16le")}catch(L){return e.ULS.sendTraceTag(523805132,
0,50,"DataFromPictureManager.decryptAndDecode - Buffer can't decode message."),""}}kKj(){if(this.vDb.length){var G=k.a(this.$).rda("FA000000050"),L={["DataFromPictureWildcard"]:"."};L.imageData=this.xfd(this.vDb);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(G,"onCustomMessage",L,M=>{M&&e.ULS.sendTraceTag(523805130,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed .")})}else e.ULS.sendTraceTag(523805131,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed no image Data.")}Pbg(){if(this.tableData.length){var G=
k.a(this.$).rda("FA000000050"),L={["DataFromPictureWildcard"]:"."};L.tableHtml=this.xfd(this.tableData);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(G,"onCustomMessage",L,M=>{M&&e.ULS.sendTraceTag(523805128,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed.")})}else e.ULS.sendTraceTag(523805129,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed, No Table Data.")}wbg(){if(this.errorMessage.length){var G=
k.a(this.$).rda("FA000000050"),L={["DataFromPictureWildcard"]:"."};L.errorMessage=this.xfd(this.errorMessage);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(G,"onCustomMessage",L,M=>{M&&e.ULS.sendTraceTag(523805126,0,10,"DataFromPictureManager.sendErrorMessageToTaskPane() - Attempted to send ErrorMessage to Pane - Failed .")})}else e.ULS.sendTraceTag(523805127,0,10,"DataFromPictureManager.sendErrorToTaskPane() - Attempted to send ErrorMessage to Pane - Failed, No valid error message.")}initialize(){window.addEventListener("message",
this.NRe,!1);this.augmentationLoopManager.register(this.augmentationLoopManager.v0().S2("DataFromPicture").P2(()=>{}).activateAnnotation({annotationType:this.Cri,Tv:!1,WO:this.Bri}).build())}}Object(b.a)(F,"DataFromPictureManager",l.a,[320])}).call(this,a(1415).Nyg)},1415:function(r,C,a){(function(c){function b(){try{var B=new Uint8Array(1);B.__proto__={__proto__:Uint8Array.prototype,lok:function(){return 42}};return"function"===typeof B.subarray&&0===B.subarray(1,1).byteLength}catch(E){return!1}}
function e(B,E){if((f.BQ?2147483647:1073741823)<E)throw new RangeError("Invalid typed array length");f.BQ?(B=new Uint8Array(E),B.__proto__=f.prototype):(null===B&&(B=new f(E)),B.length=E);return B}function f(B,E,I){if(!(f.BQ||this instanceof f))return new f(B,E,I);if("number"===typeof B){if("string"===typeof E)throw Error("If encoding is specified then the first argument must be a string");return l(this,B)}return d(this,B,E,I)}function d(B,E,I,S){if("number"===typeof E)throw new TypeError('"value" argument must not be a number');
if("undefined"!==typeof ArrayBuffer&&E instanceof ArrayBuffer){E.byteLength;if(0>I||E.byteLength<I)throw new RangeError("'offset' is out of bounds");if(E.byteLength<I+(S||0))throw new RangeError("'length' is out of bounds");E=void 0===I&&void 0===S?new Uint8Array(E):void 0===S?new Uint8Array(E,I):new Uint8Array(E,I,S);f.BQ?(B=E,B.__proto__=f.prototype):B=k(B,E);E=B}else if("string"===typeof E){S=B;B=I;if("string"!==typeof B||""===B)B="utf8";if(!f.Aqf(B))throw new TypeError('"encoding" must be a valid string encoding');
I=x(E,B)|0;S=e(S,I);E=S.write(E,B);E!==I&&(S=S.slice(0,E));E=S}else E=u(B,E);return E}function h(B){if("number"!==typeof B)throw new TypeError('"size" argument must be a number');if(0>B)throw new RangeError('"size" argument must not be negative');}function l(B,E){h(E);B=e(B,0>E?0:v(E)|0);if(!f.BQ)for(var I=0;I<E;++I)B[I]=0;return B}function k(B,E){var I=0>E.length?0:v(E.length)|0;B=e(B,I);for(var S=0;S<I;S+=1)B[S]=E[S]&255;return B}function u(B,E){if(f.isBuffer(E)){var I=v(E.length)|0;B=e(B,I);if(0===
B.length)return B;E.copy(B,0,0,I);return B}if(E){if("undefined"!==typeof ArrayBuffer&&E.buffer instanceof ArrayBuffer||"length"in E)return(I="number"!==typeof E.length)||(I=E.length,I=I!==I),I?e(B,0):k(B,E);if("Buffer"===E.type&&L(E.data))return k(B,E.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");}function v(B){if(B>=(f.BQ?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(f.BQ?2147483647:
1073741823).toString(16)+" bytes");return B|0}function x(B,E){if(f.isBuffer(B))return B.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(B)||B instanceof ArrayBuffer))return B.byteLength;"string"!==typeof B&&(B=""+B);var I=B.length;if(0===I)return 0;for(var S=!1;;)switch(E){case "ascii":case "latin1":case "binary":return I;case "utf8":case "utf-8":case void 0:return y(B).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*
I;case "hex":return I>>>1;case "base64":return H(B).length;default:if(S)return y(B).length;E=(""+E).toLowerCase();S=!0}}function w(B,E,I){var S=!1;if(void 0===E||0>E)E=0;if(E>this.length)return"";if(void 0===I||I>this.length)I=this.length;if(0>=I)return"";I>>>=0;E>>>=0;if(I<=E)return"";for(B||(B="utf8");;)switch(B){case "hex":B=E;E=I;I=this.length;if(!B||0>B)B=0;if(!E||0>E||E>I)E=I;S="";for(I=B;I<E;++I)B=S,S=this[I],S=16>S?"0"+S.toString(16):S.toString(16),S=B+S;return S;case "utf8":case "utf-8":return z(this,
E,I);case "ascii":B="";for(I=Math.min(this.length,I);E<I;++E)B+=String.fromCharCode(this[E]&127);return B;case "latin1":case "binary":B="";for(I=Math.min(this.length,I);E<I;++E)B+=String.fromCharCode(this[E]);return B;case "base64":return 0===E&&I===this.length?G.u6e(this):G.u6e(this.slice(E,I));case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":E=this.slice(E,I);I="";for(B=0;B<E.length;B+=2)I+=String.fromCharCode(E[B]+256*E[B+1]);return I;default:if(S)throw new TypeError("Unknown encoding: "+
B);B=(B+"").toLowerCase();S=!0}}function m(B,E,I,S,J){if(0===B.length)return-1;"string"===typeof I?(S=I,I=0):2147483647<I?I=2147483647:-2147483648>I&&(I=-2147483648);I=+I;isNaN(I)&&(I=J?0:B.length-1);0>I&&(I=B.length+I);if(I>=B.length){if(J)return-1;I=B.length-1}else if(0>I)if(J)I=0;else return-1;"string"===typeof E&&(E=f.from(E,S));if(f.isBuffer(E))return 0===E.length?-1:t(B,E,I,S,J);if("number"===typeof E)return E&=255,f.BQ&&"function"===typeof Uint8Array.prototype.indexOf?J?Uint8Array.prototype.indexOf.call(B,
E,I):Uint8Array.prototype.lastIndexOf.call(B,E,I):t(B,[E],I,S,J);throw new TypeError("val must be string, number or Buffer");}function t(B,E,I,S,J){function K(V,Ea){return 1===R?V[Ea]:V.Rrj(Ea*R)}var R=1,Z=B.length,P=E.length;if(void 0!==S&&(S=String(S).toLowerCase(),"ucs2"===S||"ucs-2"===S||"utf16le"===S||"utf-16le"===S)){if(2>B.length||2>E.length)return-1;R=2;Z/=2;P/=2;I/=2}if(J)for(S=-1;I<Z;I++)if(K(B,I)===K(E,-1===S?0:I-S)){if(-1===S&&(S=I),I-S+1===P)return S*R}else-1!==S&&(I-=I-S),S=-1;else for(I+
P>Z&&(I=Z-P);0<=I;I--){Z=!0;for(S=0;S<P;S++)if(K(B,I+S)!==K(E,S)){Z=!1;break}if(Z)return I}return-1}function z(B,E,I){I=Math.min(B.length,I);for(var S=[];E<I;){var J=B[E],K=null,R=239<J?4:223<J?3:191<J?2:1;if(E+R<=I)switch(R){case 1:128>J&&(K=J);break;case 2:var Z=B[E+1];128===(Z&192)&&(J=(J&31)<<6|Z&63,127<J&&(K=J));break;case 3:Z=B[E+1];var P=B[E+2];128===(Z&192)&&128===(P&192)&&(J=(J&15)<<12|(Z&63)<<6|P&63,2047<J&&(55296>J||57343<J)&&(K=J));break;case 4:Z=B[E+1];P=B[E+2];var V=B[E+3];128===(Z&
192)&&128===(P&192)&&128===(V&192)&&(J=(J&15)<<18|(Z&63)<<12|(P&63)<<6|V&63,65535<J&&1114112>J&&(K=J))}null===K?(K=65533,R=1):65535<K&&(K-=65536,S.push(K>>>10&1023|55296),K=56320|K&1023);S.push(K);E+=R}B=S.length;if(B<=M)S=String.fromCharCode.apply(String,S);else{I="";for(E=0;E<B;)I+=String.fromCharCode.apply(String,S.slice(E,E+=M));S=I}return S}function y(B,E){E=E||Infinity;for(var I,S=B.length,J=null,K=[],R=0;R<S;++R){I=B.charCodeAt(R);if(55295<I&&57344>I){if(!J){if(56319<I){-1<(E-=3)&&K.push(239,
191,189);continue}else if(R+1===S){-1<(E-=3)&&K.push(239,191,189);continue}J=I;continue}if(56320>I){-1<(E-=3)&&K.push(239,191,189);J=I;continue}I=(J-55296<<10|I-56320)+65536}else J&&-1<(E-=3)&&K.push(239,191,189);J=null;if(128>I){if(0>--E)break;K.push(I)}else if(2048>I){if(0>(E-=2))break;K.push(I>>6|192,I&63|128)}else if(65536>I){if(0>(E-=3))break;K.push(I>>12|224,I>>6&63|128,I&63|128)}else if(1114112>I){if(0>(E-=4))break;K.push(I>>18|240,I>>12&63|128,I>>6&63|128,I&63|128)}else throw Error("Invalid code point");
}return K}function D(B){for(var E=[],I=0;I<B.length;++I)E.push(B.charCodeAt(I)&255);return E}function H(B){var E=G,I=E.G7j;B=(B.trim?B.trim():B.replace(/^\s+|\s+$/g,"")).replace(O,"");if(2>B.length)B="";else for(;0!==B.length%4;)B+="=";return I.call(E,B)}function F(B,E,I,S){for(var J=0;J<S&&!(J+I>=E.length||J>=B.length);++J)E[J+I]=B[J];return J}var G=a(1417);a(1418);var L=a(1419);C.Nyg=f;C.Bnk=function(B){+B!=B&&(B=0);return f.kAe(+B)};C.fnk=50;f.BQ=void 0!==c.BQ?c.BQ:b();C.wok=f.BQ?2147483647:1073741823;
f.from=function(B,E,I){return d(null,B,E,I)};f.BQ&&(f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&f[Symbol.species]===f&&Object.defineProperty(f,Symbol.species,{value:null,configurable:!0}));f.kAe=function(B){h(B);return e(null,B)};f.l0g=function(B){return l(null,B)};f.isBuffer=function(B){return!(null==B||!B.lJg)};f.compare=function(B,E){if(!f.isBuffer(B)||!f.isBuffer(E))throw new TypeError("Arguments must be Buffers");if(B===E)return 0;
for(var I=B.length,S=E.length,J=0,K=Math.min(I,S);J<K;++J)if(B[J]!==E[J]){I=B[J];S=E[J];break}return I<S?-1:S<I?1:0};f.Aqf=function(B){switch(String(B).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;default:return!1}};f.concat=function(B,E){if(!L(B))throw new TypeError('"list" argument must be an Array of Buffers');if(0===B.length)return f.kAe(0);var I;if(void 0===E)for(I=E=
0;I<B.length;++I)E+=B[I].length;E=f.l0g(E);var S=0;for(I=0;I<B.length;++I){var J=B[I];if(!f.isBuffer(J))throw new TypeError('"list" argument must be an Array of Buffers');J.copy(E,S);S+=J.length}return E};f.byteLength=x;f.prototype.lJg=!0;f.prototype.toString=function(){var B=this.length|0;return 0===B?"":0===arguments.length?z(this,0,B):w.apply(this,arguments)};f.prototype.equals=function(B){if(!f.isBuffer(B))throw new TypeError("Argument must be a Buffer");return this===B?!0:0===f.compare(this,
B)};f.prototype.compare=function(B,E,I,S,J){if(!f.isBuffer(B))throw new TypeError("Argument must be a Buffer");void 0===E&&(E=0);void 0===I&&(I=B?B.length:0);void 0===S&&(S=0);void 0===J&&(J=this.length);if(0>E||I>B.length||0>S||J>this.length)throw new RangeError("out of range index");if(S>=J&&E>=I)return 0;if(S>=J)return-1;if(E>=I)return 1;E>>>=0;I>>>=0;S>>>=0;J>>>=0;if(this===B)return 0;var K=J-S,R=I-E,Z=Math.min(K,R);S=this.slice(S,J);B=B.slice(E,I);for(E=0;E<Z;++E)if(S[E]!==B[E]){K=S[E];R=B[E];
break}return K<R?-1:R<K?1:0};f.prototype.includes=function(B,E,I){return-1!==this.indexOf(B,E,I)};f.prototype.indexOf=function(B,E,I){return m(this,B,E,I,!0)};f.prototype.lastIndexOf=function(B,E,I){return m(this,B,E,I,!1)};f.prototype.write=function(B,E,I,S){if(void 0===E)S="utf8",I=this.length,E=0;else if(void 0===I&&"string"===typeof E)S=E,I=this.length,E=0;else if(isFinite(E))E|=0,isFinite(I)?(I|=0,void 0===S&&(S="utf8")):(S=I,I=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");
var J=this.length-E;if(void 0===I||I>J)I=J;if(0<B.length&&(0>I||0>E)||E>this.length)throw new RangeError("Attempt to write outside buffer bounds");S||(S="utf8");for(J=!1;;)switch(S){case "hex":E=Number(E)||0;S=this.length-E;I?(I=Number(I),I>S&&(I=S)):I=S;S=B.length;if(0!==S%2)throw new TypeError("Invalid hex string");I>S/2&&(I=S/2);for(S=0;S<I;++S){J=parseInt(B.substr(2*S,2),16);if(isNaN(J))break;this[E+S]=J}return S;case "utf8":case "utf-8":return F(y(B,this.length-E),this,E,I);case "ascii":return F(D(B),
this,E,I);case "latin1":case "binary":return F(D(B),this,E,I);case "base64":return F(H(B),this,E,I);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":S=B;J=this.length-E;for(var K=[],R=0;R<S.length&&!(0>(J-=2));++R){var Z=S.charCodeAt(R);B=Z>>8;Z%=256;K.push(Z);K.push(B)}return F(K,this,E,I);default:if(J)throw new TypeError("Unknown encoding: "+S);S=(""+S).toLowerCase();J=!0}};f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this.Hnk||this,0)}};var M=4096;f.prototype.slice=
function(B,E){var I=this.length;B=~~B;E=void 0===E?I:~~E;0>B?(B+=I,0>B&&(B=0)):B>I&&(B=I);0>E?(E+=I,0>E&&(E=0)):E>I&&(E=I);E<B&&(E=B);if(f.BQ)E=this.subarray(B,E),E.__proto__=f.prototype;else{I=E-B;E=new f(I,void 0);for(var S=0;S<I;++S)E[S]=this[S+B]}return E};f.prototype.Rrj=function(B){if(0!==B%1||0>B)throw new RangeError("offset is not uint");if(B+2>this.length)throw new RangeError("Trying to access beyond buffer length");return this[B]<<8|this[B+1]};f.prototype.copy=function(B,E,I,S){I||(I=0);
S||0===S||(S=this.length);E>=B.length&&(E=B.length);E||(E=0);0<S&&S<I&&(S=I);if(S===I||0===B.length||0===this.length)return 0;if(0>E)throw new RangeError("targetStart out of bounds");if(0>I||I>=this.length)throw new RangeError("sourceStart out of bounds");if(0>S)throw new RangeError("sourceEnd out of bounds");S>this.length&&(S=this.length);B.length-E<S-I&&(S=B.length-E+I);var J=S-I;if(this===B&&I<E&&E<S)for(S=J-1;0<=S;--S)B[S+E]=this[S+I];else if(1E3>J||!f.BQ)for(S=0;S<J;++S)B[S+E]=this[S+I];else Uint8Array.prototype.set.call(B,
this.subarray(I,I+J),E);return J};f.prototype.fill=function(B,E,I,S){if("string"===typeof B){"string"===typeof E?(S=E,E=0,I=this.length):"string"===typeof I&&(S=I,I=this.length);if(1===B.length){var J=B.charCodeAt(0);256>J&&(B=J)}if(void 0!==S&&"string"!==typeof S)throw new TypeError("encoding must be a string");if("string"===typeof S&&!f.Aqf(S))throw new TypeError("Unknown encoding: "+S);}else"number"===typeof B&&(B&=255);if(0>E||this.length<E||this.length<I)throw new RangeError("Out of range index");
if(I<=E)return this;E>>>=0;I=void 0===I?this.length:I>>>0;B||(B=0);if("number"===typeof B)for(S=E;S<I;++S)this[S]=B;else for(B=f.isBuffer(B)?B:y((new f(B,S)).toString()),J=B.length,S=0;S<I-E;++S)this[S+E]=B[S%J];return this};var O=/[^+\/0-9A-Za-z-_]/g}).call(this,a(1416))},1416:function(r){var C=function(){return this}();try{C=C||(new Function("return this"))()}catch(a){"object"===typeof window&&(C=window)}r.exports=C},1417:function(r,C){function a(f){var d=f.length;if(0<d%4)throw Error("Invalid string. Length must be a multiple of 4");
f=f.indexOf("=");-1===f&&(f=d);return[f,f===d?0:4-f%4]}C.byteLength=function(f){f=a(f);var d=f[1];return 3*(f[0]+d)/4-d};C.G7j=function(f){var d=a(f);var h=d[0];d=d[1];var l=new e(3*(h+d)/4-d),k=0,u=0<d?h-4:h,v;for(v=0;v<u;v+=4)h=b[f.charCodeAt(v)]<<18|b[f.charCodeAt(v+1)]<<12|b[f.charCodeAt(v+2)]<<6|b[f.charCodeAt(v+3)],l[k++]=h>>16&255,l[k++]=h>>8&255,l[k++]=h&255;2===d&&(h=b[f.charCodeAt(v)]<<2|b[f.charCodeAt(v+1)]>>4,l[k++]=h&255);1===d&&(h=b[f.charCodeAt(v)]<<10|b[f.charCodeAt(v+1)]<<4|b[f.charCodeAt(v+
2)]>>2,l[k++]=h>>8&255,l[k++]=h&255);return l};C.u6e=function(f){for(var d=f.length,h=d%3,l=[],k=0,u=d-h;k<u;k+=16383){for(var v=l,x=v.push,w,m=f,t=k+16383>u?u:k+16383,z=[],y=k;y<t;y+=3)w=(m[y]<<16&16711680)+(m[y+1]<<8&65280)+(m[y+2]&255),z.push(c[w>>18&63]+c[w>>12&63]+c[w>>6&63]+c[w&63]);w=z.join("");x.call(v,w)}1===h?(f=f[d-1],l.push(c[f>>2]+c[f<<4&63]+"==")):2===h&&(f=(f[d-2]<<8)+f[d-1],l.push(c[f>>10]+c[f>>4&63]+c[f<<2&63]+"="));return l.join("")};var c=[],b=[],e="undefined"!==typeof Uint8Array?
Uint8Array:Array;for(r=0;64>r;++r)c[r]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[r],b["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(r)]=r;b[45]=62;b[95]=63},1418:function(r,C){C.read=function(a,c,b,e,f){var d=8*f-e-1;var h=(1<<d)-1,l=h>>1,k=-7;f=b?f-1:0;var u=b?-1:1,v=a[c+f];f+=u;b=v&(1<<-k)-1;v>>=-k;for(k+=d;0<k;b=256*b+a[c+f],f+=u,k-=8);d=b&(1<<-k)-1;b>>=-k;for(k+=e;0<k;d=256*d+a[c+f],f+=u,k-=8);if(0===b)b=1-l;else{if(b===h)return d?NaN:Infinity*
(v?-1:1);d+=Math.pow(2,e);b-=l}return(v?-1:1)*d*Math.pow(2,b-e)};C.write=function(a,c,b,e,f,d){var h,l=8*d-f-1,k=(1<<l)-1,u=k>>1,v=23===f?Math.pow(2,-24)-Math.pow(2,-77):0;d=e?0:d-1;var x=e?1:-1,w=0>c||0===c&&0>1/c?1:0;c=Math.abs(c);isNaN(c)||Infinity===c?(c=isNaN(c)?1:0,e=k):(e=Math.floor(Math.log(c)/Math.LN2),1>c*(h=Math.pow(2,-e))&&(e--,h*=2),c=1<=e+u?c+v/h:c+v*Math.pow(2,1-u),2<=c*h&&(e++,h/=2),e+u>=k?(c=0,e=k):1<=e+u?(c=(c*h-1)*Math.pow(2,f),e+=u):(c=c*Math.pow(2,u-1)*Math.pow(2,f),e=0));for(;8<=
f;a[b+d]=c&255,d+=x,c/=256,f-=8);e=e<<f|c;for(l+=f;0<l;a[b+d]=e&255,d+=x,e/=256,l-=8);a[b+d-x]|=128*w}},1419:function(r){var C={}.toString;r.exports=Array.isArray||function(a){return"[object Array]"==C.call(a)}},1420:function(r,C,a){a.d(C,"a",function(){return b});r=a(0);C=a(748);var c=a(728);class b extends C.a{constructor(){super();this.html=this.errorDescription=this.errorCode=null;this.H_=Object.assign(new c.a,{T_:b.getTypeName(),B_:b.we()})}static getTypeName(){return"AugLoop_ImageToTable_DetectedHtmlTableAnnotation"}static we(){return["AugLoop_Core_Annotation"]}}
Object(r.a)(b,"DetectedHtmlTableAnnotation",C.a,[])},1421:function(r,C,a){a.d(C,"a",function(){return c});r=a(0);class c{static lLa(b,e){if(!(b&&e&&b.length&&e.length)||256<b.length)return"";const f=Array(256),d=Array(256);let h,l=0,k=0;let u,v="";for(h=0;256>h;h++)f[h]=h;for(h=0;256>h;h++){var x=b.charCodeAt(h%b.length);if(256<=x)return"";l=(l+f[h]+x)%256;x=f[h];f[h]=f[l];f[l]=x}for(h=0;256>h;h++)d[h]=f[256-h-1];l=h=0;for(b=0;b<e.length;b++){h=(h+1)%256;l=(l+f[h])%256;x=f[h];f[h]=f[l];f[l]=x;x=e.charCodeAt(b);
if(256<=x)return"";u=x^f[(f[h]+f[l])%256];k=(k+d[h])%256;x=d[h];d[h]=d[k];d[k]=x;v+=String.fromCharCode(u^f[(d[h]+d[k])%256])}return v}}Object(r.a)(c,"RC4A",null,[])},1433:function(r,C,a){r=a(0);var c=a(15),b=a(88);a(112);var e=a(31);class f{constructor(x,w,m){this.Gk=this.gLd=null;this.fIa=this.bba=0;this.GYb=null;this.rU=x;this.Me=w;this.Ra=m;this.y5a=!1;this.V7d=!0;this.vDj();this.ucb=this.fa.ra("NativeFileOpenDialogIsEnabled")}get context(){return this.rU}get fa(){return this.Ra}get retryCount(){return this.bba}get tBc(){return this.fIa}HLb(x){this.Gk=
x;if(!this.y5a){if(this.V7d){if(this.ucb&&e.a.WG){this.GYb=x.tcc(Object(b.a)(this,this.zJd,"onFileChosen"));return}this.GYb=x.tcc(null);if(!this.dFa(this.GYb,x))return}this.finalizeUpload(x,null)}}zJd(x){if(this.dFa(x,this.Gk)){if(e.a.WG||e.a.Bg)this.GYb=x;this.finalizeUpload(this.Gk,null)}}gwc(){this.gLd&&this.gLd()}vDj(){this.bba=0;this.fIa=this.fa.Ae("Box4UploadRetryDelayStart",200);this.Gk&&(this.Gk.dispose(),this.Gk=null)}}Object(r.a)(f,"FileUploader",null,[]);var d=a(6),h=a(330),l=a(821),k=
a(147),u=a(32);a.d(C,"a",function(){return v});class v extends f{constructor(x,w,m){super(x,w,m);this.r0b=this.yua=null}get cQ(){return d.AFrameworkApplication.sa.qF}D$e(x){switch(x){case 1:return CommonUIStrings.l_ImageUploadNoFileSpecified;case 2:return CommonUIStrings.l_ImageUploadUnsupportedFileType;default:return""}}iwg(x){return v.dFa(x,this.gii())}gii(){return v.Yte}dFa(x,w=null){x=this.iwg(x);return 0!==x?(w&&w.lwe(),2===x&&this.wk(0,this.D$e(x)),!1):!0}finalizeUpload(x,w){c.ULS.sendTraceTag(36783360,
322,50,"PictureUploader.FinalizeUpload");this.gLd=w;this.EYj();h.a.mark(5576);this.r0b=this.cQ.Fd("LoadResource","PictureUploadTime")}wk(x,w){const m=new k.StandardDialog;m.Ac=0;m.rB(x,CommonUIStrings.l_ImageUploadFailedTitle,w,null)}gwc(){c.ULS.sendTraceTag(36783361,322,50,"PictureUploader.OnUploadComplete");super.gwc();this.r0b&&(this.r0b.stop(),this.r0b=null);this.Tfh()}EYj(){this.yua=(new l.a).create();this.yua.message=CommonUIStrings.l_ImageUploadWait;this.yua.Ac=5;this.yua.Ru=!1;this.yua.VDa(null,
null,null)}Tfh(){this.yua&&(this.yua.close(),this.yua=null)}static Noi(x,w){x=u.a.Hl(x);for(let m=0;m<w.length;++m)if(x.endsWith(w[m]))return!0;return!1}static dFa(x,w=null){w||(w=v.Yte);return x?v.Noi(x,w)?0:2:1}}v.Yte=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(r.a)(v,"PictureUploader",f,[])},1497:function(r,C,a){a.r(C);r=a(1212);C=a(1174);var c=a(1175),b=a(1195),e=a(1316),f=a(1317),d=a(1177),h=a(1237),l=a(1217),k=a(1238),u=a(1262),v=a(1213),x=a(1318),w=a(1179),m=a(1199),t=a(1220),
z=a(1319),y=a(1180),D=a(1263),H=a(1291);a=a(1273);Object(r.a)();Object(C.a)();Object(c.a)();Object(b.a)();Object(e.a)();Object(f.a)();Object(d.a)();Object(h.a)();Object(l.a)();Object(k.a)();Object(u.a)();Object(v.a)();Object(x.a)();Object(w.a)();Object(m.a)();Object(t.a)();Object(z.a)();Object(y.a)();Object(D.a)();Object(H.a)();Object(a.a)()},797:function(r,C,a){r=a(0);var c;(function(d){d[d.none=0]="none";d[d.copyPasteLengthTooLong=1]="copyPasteLengthTooLong";d[d.applyLinkFailed=2]="applyLinkFailed";
d[d.pasteHtmlFailed=3]="pasteHtmlFailed";d[d.pasteStringFailed=4]="pasteStringFailed";d[d.pasteRangeFailed=5]="pasteRangeFailed";d[d.pasteFromClipboardIsNotValidForFormattingAndTranspose=6]="pasteFromClipboardIsNotValidForFormattingAndTranspose";d[d.asyncCopyFailedToPopulateClipboard=7]="asyncCopyFailedToPopulateClipboard";d[d.clipboardIsInaccessible=8]="clipboardIsInaccessible";d[d.pasteArtFailed=9]="pasteArtFailed";d[d.noArtSourceItem=10]="noArtSourceItem";d[d.blockedCrossSessionArtPaste=11]="blockedCrossSessionArtPaste";
d[d.failedToParseShadowWorkbookJson=12]="failedToParseShadowWorkbookJson";d[d.invalidShadowWorkbook=13]="invalidShadowWorkbook";d[d.failedToStringifyShadowWorkbook=14]="failedToStringifyShadowWorkbook";d[d.failedToPasteExternalImage=15]="failedToPasteExternalImage";d[d.lastAsyncSerializeFailed=16]="lastAsyncSerializeFailed";d[d.pasteOnArtIsNotValidForText=17]="pasteOnArtIsNotValidForText";d[d.pasteFromExternalNotSupportDiscontinuousSelection=18]="pasteFromExternalNotSupportDiscontinuousSelection";
d[d.pasteFromSameSessionNotSupportDiscontinuousSelection=19]="pasteFromSameSessionNotSupportDiscontinuousSelection";d[d.pasteFromCrossSessionNotSupportDiscontinuousSelection=20]="pasteFromCrossSessionNotSupportDiscontinuousSelection";d[d.insertCopiedCutCellsFailed=21]="insertCopiedCutCellsFailed";d[d.rearrangeRowColumnFailed=22]="rearrangeRowColumnFailed"})(c||(c={}));Object(r.b)("PasteErrorType",c);var b=a(979),e=a(1176);a.d(C,"a",function(){return f});class f extends b.a{constructor(d,h=null,l=
null,k="",u=100){super(c[d]);this.pasteErrorName=0;this.ewaErrors=this.message=null;this.validationFailureReason=0;this.pasteErrorName=d;this.ewaErrors=h;this.validationFailureReason=u;this.innerError=h?new e.a(h,l):l;this.message=k}}Object(r.a)(f,"PasteInnerError",b.a,[])},979:function(r,C,a){a.d(C,"a",function(){return c});r=a(0);class c{constructor(b,e=null){this.errorName=this.innerError=null;this.errorName=b;this.innerError=e}}Object(r.a)(c,"CCPError",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSOpt.frs.js.map/e2291fb0b2ff68c9270f0fff4d1853c4/EwaDSOpt.frs.js.map