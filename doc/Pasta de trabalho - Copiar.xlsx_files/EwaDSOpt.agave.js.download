'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[11],{1E3:function(r,C,a){a.r(C);r=a(0);var c=a(15),b=a(1548),e=a(175),f=a(114),d=a(745),h=a(764),l=a(355);class k{constructor(m,t,z,y){this.kp=!1;this._id=m;this.My=t;this.Z3=z;this.he=y}get enabled(){return this.kp}set enabled(m){const {DynamicRibbon:t}=a(1E3);var z=this.he.OwnerAddinStoreType?this.he.OwnerAddinStoreType:this.he.PrimaryMarketplace.MarketplaceType;const y=this.he.PrimaryMarketplace.MarketplaceRef,
D=this.he.AssetMarketplace?this.he.AssetMarketplace.SolutionId:null,H=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.My,z,null,null,null,y);z={["addinSolutionId"]:H,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.he.OwnerAddinSolutionId,z,D,null,null,y),["ownerAddinStoreType"]:z,["ribbonControlType"]:"Button",["toggle"]:m};e.a.sendTelemetryEvent(Object.assign(new l.a,{name:t.EHc+"ControlUpdate",dataFields:f.a.Wj(z)}));this.kp=m;this.Z3.RL(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:1,
["SolutionId"]:this.My,["PrivacyCompliantSolutionId"]:H,["SourceControlId"]:this.id,["MethodData"]:this.kp})}get id(){return this._id}get label(){return null}setEnabled(){}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonButton"}invokePropertyGet(m){switch(m){case 3:return this.enabled;case 2:return this.id;case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);}invokePropertyGetAsync(m){m=this.invokePropertyGet(m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(m)}invokePropertySet(m,
t){switch(m){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);}invokePropertySetAsync(m,t){this.invokePropertySet(m,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(m,t){switch(m){case 5:return this.pNj(t);case 1:return this.CFa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);}invokeMethodAsync(m,t){m=this.invokeMethod(m,
t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(m)}pNj(m){m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"boolean");this.setEnabled(m);return null}CFa(){this._OnAccess();return null}}Object(r.a)(k,"RibbonButton",null,[]);class u{constructor(m,t,z,y){this._id=m;this.My=t;this.Z3=z;this.he=y}get id(){return this._id}setVisibility(m){const {DynamicRibbon:t}=a(1E3),z=this.he.OwnerAddinStoreType?this.he.OwnerAddinStoreType:this.he.PrimaryMarketplace.MarketplaceType;
var y=this.he.PrimaryMarketplace.MarketplaceRef;const D=this.he.AssetMarketplace?this.he.AssetMarketplace.SolutionId:null,H=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.My,z,D,null,null,y);y={["addinSolutionId"]:H,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.he.OwnerAddinSolutionId,z,D,null,null,y),["ownerAddinStoreType"]:z,["ribbonControlType"]:"Tab",["toggle"]:m};e.a.sendTelemetryEvent(Object.assign(new l.a,{name:t.EHc+"ControlUpdate",dataFields:f.a.Wj(y)}));this.Z3.RL(-1014260128,
{["DynamicAddinCommandsMethodDispatchId"]:2,["SolutionId"]:this.My,["PrivacyCompliantSolutionId"]:H,["StoreType"]:z,["SourceControlId"]:this.id,["MethodData"]:m})}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonTab"}invokePropertyGet(m){switch(m){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);}invokePropertyGetAsync(m){m=this.invokePropertyGet(m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(m)}invokePropertySet(m){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);
}invokePropertySetAsync(m,t){this.invokePropertySet(m,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(m,t){switch(m){case 3:return this.vRj(t);case 1:return this.CFa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);}invokeMethodAsync(m,t){m=this.invokeMethod(m,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(m)}vRj(m){m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"boolean");this.setVisibility(m);
return null}CFa(){this._OnAccess();return null}}Object(r.a)(u,"RibbonTab",null,[]);var v=a(1020),x=a(200);a.d(C,"DynamicRibbon",function(){return w});class w{constructor(m,t,z,y,D){this.My=m;this.XH=z;this.Z3=y;this.he=D;this.cmb=this.XH.Xf;this.eA=this.cmb.getOsfControl(t);this.RKg=this.eA.getManifest()}get buttons(){return null}executeRequestCreate(m){try{var t=this.he.OwnerAddinStoreType?this.he.OwnerAddinStoreType:this.he.PrimaryMarketplace.MarketplaceType;const y=this.he.PrimaryMarketplace.MarketplaceRef,
D=this.he.AssetMarketplace?this.he.AssetMarketplace.SolutionId:null;var z=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.My,t,D,null,null,y);const H={["addinSolutionId"]:z,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.he.OwnerAddinSolutionId,t,D,null,null,y),["ownerAddinStoreType"]:this.he.OwnerAddinStoreType,["ribbonControlType"]:"Ribbon"};e.a.sendTelemetryEvent(Object.assign(new l.a,{name:w.EHc+"ExecuteRequestCreate",dataFields:f.a.Wj(H)}));const F=x.a.ij(m);m={};
t={};t[d.a.jMa]=this.eA;t[d.a.kMa]=F;t[d.a.Ped]=this.he;m[d.a.iyb]=3;m[d.a.v6]=this.My;m[d.a.Vcc]=z;m[d.a.u6]=t;this.Z3.RL(-1014260128,m);let G=w.rgc("ExecuteRequestCreate",!0,"");c.ULS.sendTraceTag(538572826,0,50,G)}catch(y){z=w.rgc("ExecuteRequestCreate",!1,y.toString()),c.ULS.sendTraceTag(538572825,0,50,z)}return null}executeRequestUpdate(m){try{var t=this.he.OwnerAddinStoreType?this.he.OwnerAddinStoreType:this.he.PrimaryMarketplace.MarketplaceType;const y=this.he.PrimaryMarketplace.MarketplaceRef,
D=this.he.AssetMarketplace?this.he.AssetMarketplace.SolutionId:null;var z=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.My,t,D,null,null,y);const H={["addinSolutionId"]:z,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.he.OwnerAddinSolutionId,t,D,null,null,y),["ownerAddinStoreType"]:this.he.OwnerAddinStoreType,["ribbonControlType"]:"Ribbon"};e.a.sendTelemetryEvent(Object.assign(new l.a,{name:w.EHc+"ExecuteRequestUpdate",dataFields:f.a.Wj(H)}));const F=x.a.ij(m);m={};
t={};t[d.a.jMa]=this.eA;t[d.a.kMa]=F;t[d.a.Ped]=this.he;m[d.a.iyb]=3;m[d.a.v6]=this.My;m[d.a.Vcc]=z;m[d.a.u6]=t;this.Z3.RL(-1014260128,m);let G=w.rgc("ExecuteRequestUpdate",!0,"");c.ULS.sendTraceTag(538572824,0,50,G)}catch(y){z=w.rgc("ExecuteRequestUpdate",!1,y.toString()),c.ULS.sendTraceTag(538572823,0,50,z)}return null}getButton(m){let t=null;if(!this.uqf())return this.KOe();if(m&&0<m.length){if(!this.BJe(m))return this.bPe(m);t=new k(m,this.My,this.Z3,this.he)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)}getTab(m){let t=
null;if(!this.uqf())return this.KOe();if(this.eA.getOwnerAddinControlRecreated())return this.Roh();if(m&&0<m.length){if(!this.BJe(m))return this.bPe(m);t=new u(m,this.My,this.Z3,this.he)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.DynamicRibbon"}invokePropertyGet(m){switch(m){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);}invokePropertyGetAsync(m){m=this.invokePropertyGet(m);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(m)}invokePropertySet(m){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);}invokePropertySetAsync(m,t){this.invokePropertySet(m,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(m){switch(m){case 1:return this.CFa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);}invokeMethodAsync(m,t){switch(m){case 7:return this.dQh(t);case 6:return this.eQh(t);case 3:return this.r1h(t);
case 5:return this.kgi(t)}m=this.invokeMethod(m,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(m)}dQh(m){m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return this.executeRequestCreate(m)}eQh(m){m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return this.executeRequestUpdate(m)}r1h(m){m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return this.getButton(m)}kgi(m){m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,
0,"string");return this.getTab(m)}CFa(){this._OnAccess();return null}bPe(m){return v.a(h.a.okh,x.a.ha(1771)+m)}KOe(){return v.a(h.a.XEj,x.a.ha(1767))}Roh(){return v.a(h.a.hostRestartNeeded,x.a.ha(1772))}uqf(){var m=this.eA.getSharedRuntimeId();m=!!m&&0<m.length;c.ULS.sendTraceTag(538572822,0,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",m));return m}BJe(m){const t=this.RKg.getRibbonExtensionControlMap();return m in t||this.vdh(m)}vdh(m){var t=this.KTh();if(t){t=t.gWe;
for(const z of t.tabs){if(z.id===m)return!0;for(const y of z.groups)for(const D of y.controls){if(D.id===m)return!0;if("Menu"===D.type){t=D;for(const H of t.items)if(H.id===m)return!0}}}}return!1}KTh(){return b.a.getInstance().Gla(this.he.PrimaryMarketplace.MarketplaceType,this.he.PrimaryMarketplace.SolutionId,1)}static rgc(m,t,z){const y={};y.methodName="DynamicRibbon."+m;y.result=t?"Succeeded":"Failed";y.message=z;return x.a.nd(y)}}w.EHc="Office.Online.Extensibility.Ribbon.";Object(r.a)(w,"DynamicRibbon",
null,[])},1016:function(r,C,a){a.d(C,"a",function(){return c});const c=(b,e)=>{let f=!1;b&&(b=e.osfControl,(e=b.getManifest())&&e.getSharedRuntimeForCustomFunctions("Workbook")&&!b.getIsUpgrading()&&(f=!0));return f}},1017:function(r,C,a){a.d(C,"a",function(){return c});r=a(0);class c{constructor(){this.token=null;this.errorCode=0;this.expiresOn=this.Pja=this.lXa=this.Dnd=this.Xpd=this.ZBb=this.T3d=null}}Object(r.a)(c,"AppsForOfficeOauthResult",null,[])},1020:function(r,C,a){a.d(C,"a",function(){return c});
const c=(b,e)=>OfficeExtension.WacRuntime.Utility.createPromise((f,d)=>{d(OfficeExtension.WacRuntime.Utility.createRichApiException(b,e))})},1251:function(r,C,a){a.r(C);r=a(0);var c=a(2),b=a(15),e=a(6),f=a(172),d=a(198),h=a(126),l=a(201),k=a(59),u=a(52),v=a(40),x=a(236),w=a(119),m=a(540);class t{constructor(hb){hb=hb.split("|");this.My=hb[1];this.FZc=hb[2];this.J2d=hb[3]}get solutionId(){return this.My}get solutionVersion(){return this.FZc}get needToRestoreManifest(){return this.J2d===OSF.StoreTypeEnum.Registry.toString()}}
Object(r.a)(t,"AddinStoreInfo",null,[]);class z{}Object(r.a)(z,"CustomFunctionRegistrationInfos",null,[]);var y=a(206),D=a(79);const H=(hb,Ja,Fa)=>F(hb,Ja,y.a.none,D.a.current,Fa),F=(hb,Ja,Fa,Ba,fa)=>{Fa=hb.continueWith(()=>{Ja(hb)},3,Fa,Ba);Fa.continueWith(()=>{b.ULS.sendTraceTag(537163463,0,10,fa)},4);return Fa},G=(hb,Ja,Fa)=>L(hb,Ja,y.a.none,D.a.current,Fa),L=(hb,Ja,Fa,Ba,fa)=>{Fa=hb.Mq(()=>Ja(hb),3,Fa,Ba);Fa.continueWith(()=>{b.ULS.sendTraceTag(537163462,0,10,fa)},4);return v.TaskExtensions.jJc(Fa)},
M=(hb,Ja,Fa)=>O(hb,Ja,y.a.none,D.a.current,Fa),O=(hb,Ja,Fa,Ba,fa)=>{Fa=hb.Mq(()=>Ja(hb),3,Fa,Ba);Fa.continueWith(()=>{b.ULS.sendTraceTag(537163461,0,10,fa)},4);return Fa},B=(hb,Ja,Fa)=>E(hb,Ja,y.a.none,D.a.current,Fa),E=(hb,Ja,Fa,Ba,fa)=>{Fa=hb.Mq(()=>Ja(hb),3,Fa,Ba);Fa.continueWith(()=>{b.ULS.sendTraceTag(537163460,0,10,fa)},4);return v.TaskExtensions.jJc(Fa)},I=(hb,Ja,Fa)=>S(hb,Ja,y.a.none,D.a.current,Fa),S=(hb,Ja,Fa,Ba,fa)=>{Fa=hb.continueWith(()=>{Ja(hb)},3,Fa,Ba);Fa.continueWith(()=>{b.ULS.sendTraceTag(537163459,
0,10,fa)},4);return Fa},J=(hb,Ja)=>{M(a(1251).CustomFunctionsInstaller.Abf("CustomFunctionsRuntimeLogging"),Fa=>{if(Fa.result&&window.console)switch(Fa=K(hb.severity)+" "+hb.message+Ja,hb.severity){case 2:window.console.log&&window.console.log(Fa);break;case 0:window.console.info&&window.console.info(Fa);break;case 1:window.console.error&&window.console.error(Fa)}return!0},"CustomFunctionsInstaller::LogEvent failed due to GetLocalCacheItemSafeFromLocalStorage failed")},K=hb=>{switch(hb){case 0:return"Medium";
case 1:return"Unexpected";case 2:return"Verbose";default:return""}};var R=a(1016);class Z{}Object(r.a)(Z,"InstallationInfo",null,[]);class P{}Object(r.a)(P,"UninstallationInfo",null,[]);var V=a(33),Ea=a(91),oa=a(38),ea=a(34),aa=a(1),ia=a(23),ya=a(248),za=a(824),la=a(63);class xa{constructor(hb,Ja){this.cZc=hb;this._message=Ja}get severity(){return this.cZc}get message(){return this._message}}Object(r.a)(xa,"CustomFunctionLog",null,[]);a.d(C,"CustomFunctionsInstaller",function(){return wa});class wa{constructor(hb,
Ja,Fa){this.Nza=!1;this.MG={};this.$=hb;this.xk=Ja;this.Rud().cqa();this.indexedDB=Fa;this.indexedDB.Bf()&&(this.Nza=!0,this.indexedDB.initialize(wa.JDb,wa.KDb))}get ZW(){return this.xk.ZW}Cnf(hb,Ja,Fa,Ba){if(Ba.invariantNamespace)for(let fa=0;fa<Ba.invariantNamespace.length;++fa){const ta=Ba.invariantNamespace.charAt(fa);if("."!==ta&&"_"!==ta&&"a">ta&&"z"<ta&&"A">ta&&"Z"<ta&&"0">ta&&"9"<ta)throw b.ULS.sendTraceTag(537163552,0,10,`CustomFunctionsInstaller::InstallAsync: InvariantNamespace validation failed. Character='${ta}', Position=${fa}.`),
Error.create("InvariantNamespace validation failed");}return G(this.F$g(Fa,Ba.manifest),()=>G(this.gQd(hb),fa=>{let ta=fa.result;return(null===ta||void 0===ta?0:ta.isDynamicMetadata)?this.fRd(hb,Ja,ta,!1,!1,!1):G(this.qmk(hb,Ja,Ba),Oa=>{ta=new Z;ta.addinId=Fa;ta.locale=Ba.locale;ta.addinInvariantNamespace=Ba.invariantNamespace;ta.addinNamespace=Ba.namespace;ta.addinTitle=Ba.title;ta.isXllCompatible=Ba.isXllCompatible;ta.metadataContent=JSON.stringify(JSON.parse(Oa.result));return this.fRd(hb,Ja,ta,
!1,wa.fRh(Ba.osfControl.getStoreType()),R.a(this.$,Ba))},"CustomFunctionsInstaller::InstallAsync failed due to XhrGetMetadataAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to ReadInstallationInfoAsync failed"),"CustomFunctionsInstaller::InstallAsync failed due to CacheManifestAsync failed")}Enf(hb,Ja,Fa,Ba){if(!wa.rAd(Fa))throw b.ULS.sendTraceTag(537163551,0,10,"CustomFunctionsInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),Error.create("Invalid Metadata JSON");
return G(this.gQd(hb),fa=>{fa=fa.result;if(!fa&&(fa=oa.a.Ad(this.ZW,hb),!fa))throw b.ULS.sendTraceTag(537163550,0,10,`CustomFunctionsInstaller::InstallDynamicFunctionsAsync: Unexpected error, the addin with solutionId ${Telemetry.PrivacyRules.GetPrivacyCompliantId(hb,Ja,null)} hasn't been installed yet.`),Error.create("Customfunctions dynamic registration failed");fa.metadataContent=JSON.stringify(JSON.parse(Fa));fa.isDynamicMetadata=!0;return this.fRd(hb,Ja,fa,!0,!0,Ba)},"CustomFunctionsInstaller::InstallDynamicFunctionsAsync failed due to ReadInstallationInfoAsync failed")}Srg(hb,
Ja){this.xk.ola();const Fa=Object(c.a)(new P,{solutionId:hb}),Ba=`CustomFunctionsInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(hb,Ja,null)}.`;return G(this.NRd(hb),()=>G(this.VRd(hb),()=>this.v6d(this.xk,hb,Ja,Fa),"CustomFunctionsInstaller.UninstallAsync failed due to RemoveManifestAsync failed"),Ba)}qmk(hb,Ja,Fa){const Ba=new f.a;OSF.OUtil.xhrGet(Fa.metadataUrl,fa=>{fa?Ba.setResult(fa):Ba.setException(Error.create("Invalid manifest"))},
fa=>{b.ULS.sendTraceTag(537163548,0,10,`CustomFunctionsInstaller.XhrGetMetadataAsync: Failed to download Custom Functions metadata for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(hb,Ja,null)}. ErrorCode: ${fa}.`);Ba.Zt()});return Ba.task}Rud(){return G(this.Kyc(),hb=>{const Ja=hb.result;if(!Ja.length)return la.Task.Ua(!0);b.ULS.sendTraceTag(537163547,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");hb=new d.a;const Fa=[];for(let Ba=
0;Ba<Ja.length;Ba++){const fa=Object(h.a)(String,Ja[Ba]);hb.add(M(this.gQd(fa),ta=>{if(ta=ta.result){const Oa=oa.a.Ad(this.MG,ta.addinId);Oa&&Oa===ta.metadataContent||(this.MG[ta.addinId]=ta.metadataContent,this.ZW[fa]=ta,Fa.push(ta))}return!0},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to ReadInstallationInfoAsync failed"))}return B(la.Task.WhenAllEnumerable(hb),()=>{if(Fa.length){let Ba=new z;Ba.registrationInfos=Fa;return this.L6b(this.xk,Ja,Ba)}b.ULS.sendTraceTag(537163546,0,
50,"CustomFunctionsInstaller.InstallFromCacheAsync: There is no custom function to register from cache");return la.Task.Ua(!0)},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to getInstallationInfoTasks failed")},"CustomFunctionsInstaller::InstallFromCacheAsync failed")}Fnf(){var hb=new f.a;new d.a;const Ja=[],Fa=[];Object.keys(this.ZW).forEach(Ba=>{Ba=Object(h.a)(String,Ba);const fa=oa.a.Ad(this.ZW,Ba);Ja.push(fa);Fa.push(Ba)});if(!Fa.length)return hb.setResult(!0),hb.task;hb=Object(c.a)(new z,
{registrationInfos:Ja});return this.L6b(this.xk,Fa,hb)}Kyc(){return M(this.Wnd(m.a.O1a),hb=>{hb=hb.result;return Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(hb||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(hb||"[]"):null},"CustomFunctionsInstaller::ReadSolutionIdsLowerCaseAsync failed due to GetLocalCacheItemSafeAsync failed")}cyg(hb){return this.sYd(m.a.O1a,Sys.Serialization.JavaScriptSerializer.serialize(hb))}gQd(hb){return G(this.Wnd(m.a.Y7a(hb)),Ja=>{Ja=Ja.result||
"";return 0<Ja.length?la.Task.Ua(Sys.Serialization.JavaScriptSerializer.deserialize(Ja,!0)):la.Task.Ua(null)},"CustomFunctionsInstaller::ReadInstallationInfoAsync failed due to GetLocalCacheItemSafeAsync failed")}imk(hb,Ja){return G(this.SXe(hb),()=>G(this.sYd(m.a.Y7a(hb),Sys.Serialization.JavaScriptSerializer.serialize(Ja)),()=>wa.tYd(m.a.Lrd,"true"),"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to SetLocalCacheItemSafeAsync failed"),"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to EnsureCacheEntryForAddinAsync failed")}NRd(hb){return G(this.z3f(hb),
()=>G(this.Q3f(m.a.Y7a(hb)),()=>G(this.Kyc(),Ja=>Ja.result.length?la.Task.Ua(!0):wa.tYd(m.a.Lrd,"false"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due update ReadSolutionIdsLowerCaseAsync failed"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveLocalCacheItemSafeAsync failed"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")}G0f(hb){return this.Wnd(m.a.X7a(hb))}$xg(hb,Ja){return G(this.SXe(hb),
()=>this.sYd(m.a.X7a(hb),Ja),"CustomFunctionsInstaller::WriteManifestAsync failed due to EnsureCacheEntryForAddinAsync failed")}VRd(hb){return G(this.z3f(hb),()=>this.Q3f(m.a.X7a(hb)),"CustomFunctionsInstaller::RemoveManifestAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")}SXe(hb){return G(this.Kyc(),Ja=>{Ja=Ja.result;const Fa=hb.toLowerCase();if(Ja.includes(Fa))return la.Task.Ua(!0);Ja.push(Fa);return this.cyg(Ja)},"CustomFunctionsInstaller::EnsureCacheEntryForAddinAsync failed due to ReadSolutionIdsLowerCaseAsync failed")}z3f(hb){return G(this.Kyc(),
Ja=>{Ja=Ja.result;const Fa=hb.toLowerCase();return Ja.includes(Fa)?(Ja.splice(Array.indexOf(Ja,Fa),1),this.cyg(Ja)):la.Task.Ua(!0)},"CustomFunctionsInstaller::RemoveCacheEntryForAddinSafeAsync failed due to ReadSolutionIdsLowerCaseAsync failed")}F$g(hb,Ja){if(aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix"))return hb=new OSF.AddinIdInfo(hb),hb.needToRestoreManifest()?this.$xg(hb.getSolutionId(),Ja):la.Task.Ua(!0);hb=new t(hb);return hb.needToRestoreManifest?this.$xg(hb.solutionId,
Ja):la.Task.Ua(!0)}BEj(hb){if(aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix")){const Fa=new OSF.AddinIdInfo(hb);return Fa.needToRestoreManifest()?M(this.G0f(Fa.getSolutionId()),Ba=>{(Ba=Ba.result)&&OSF.OsfManifestManager.cacheManifestFromXml(Fa.getSolutionId(),Fa.getSolutionVersion(),Ba,this.$.xa.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):la.Task.Ua(!0)}const Ja=new t(hb);return Ja.needToRestoreManifest?
M(this.G0f(Ja.solutionId),Fa=>{(Fa=Fa.result)&&OSF.OsfManifestManager.cacheManifestFromXml(Ja.solutionId,Ja.solutionVersion,Fa,this.$.xa.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):la.Task.Ua(!0)}Q3f(hb){return this.Nza?this.indexedDB.zdd(hb):wa.Uwj(hb)}sYd(hb,Ja){return this.Nza?this.indexedDB.Vgb(new za.a(hb,Ja)):wa.tYd(hb,Ja)}Wnd(hb){return this.Nza?this.indexedDB.T7a(hb):wa.Abf(hb)}fRd(hb,Ja,Fa,Ba,fa,ta){const Oa=`CustomFunctionsInstaller.RegisterFunctionsAsync: Failed to register Custom Functions for solution: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(hb,
Ja,null)}.`;return v.TaskExtensions.jJc(M(this.gRd(this.xk,hb,Ja,Fa,!1,Ba,ta),()=>fa?this.imk(hb,Fa):la.Task.Ua(!0),Oa))}gRd(hb,Ja,Fa,Ba,fa,ta,Oa){if(!ta&&(ta=oa.a.Ad(this.MG,Ba.addinId))&&ta===Ba.metadataContent)return la.Task.Ua(!0);this.MG[Ba.addinId]=Ba.metadataContent;this.ZW[Ja]=Ba;Oa||hb.iOb(Ja);hb.ola();return G(this.fuj(Ja,Fa,Ba),()=>this.POd(Ba.addinId,fa),"Failed to register functions for customfunction addin")}fuj(hb,Ja,Fa){const Ba=new f.a,fa=this.hKa(Fa);return this.I6(ta=>{J(wa.hxb,
hb);(ta=ta.Result)&&204===ta.ResponseStatusCode?Ba.setResult(!0):(delete this.MG[Fa.addinId],delete this.ZW[hb],H(this.NRd(hb),()=>{H(this.VRd(hb),()=>{this.qig()},"Failed to show customfunctions installation error info")},`CustomFunctionsInstaller: Failed to register Custom Functions for solution: ${hb}. Received status code ${ta?ta.ResponseStatusCode.toString():"Unknown"}.`),Ba.setResult(!1))},ta=>{ta=w.a.vf(ta.data);b.ULS.sendTraceTag(537163544,0,10,`CustomFunctionsInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(hb,
Ja,null)}. Errors: ${ea.a.Uc(ta)}.`);J(wa.gxb,hb);delete this.MG[Fa.addinId];delete this.ZW[hb];Ba.setResult(!1)},fa,Ba,!0)}L6b(hb,Ja,Fa){const Ba=new f.a,fa=V.a.Lb.hf.m;Ja.forEach(Oa=>{Oa=Object(h.a)(String,Oa);hb.jJe(Oa)});hb.ola();const ta=this.t6c(Fa);return this.I6(Oa=>{J(wa.hxb,Sys.Serialization.JavaScriptSerializer.serialize(Ja));Oa=Oa.Result;let Ma=!0;var fb=[];aa.EwaSettings.isChangeGateEnabled("OfficeVSO:7667457_responseBody"),fb=Sys.Serialization.JavaScriptSerializer.deserialize(Oa.ResponseBody.toString()),
fb=Array.isArray(fb.value)?fb.value:null;const pa=new d.a;for(let Ua=0;Ua<fb.length;Ua++)if(!fb[Ua]){Ma=!1;const Sa=`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Received status code ${Oa.ResponseStatusCode}.`;pa.add(G(this.NRd(Ja[Ua]),()=>{delete this.MG[Fa.registrationInfos[Ua].addinId];delete this.ZW[Ja[Ua]];return this.VRd(Ja[Ua])},Sa))}I(la.Task.WhenAllEnumerable(pa),()=>{H(this.POd("",!1),()=>{b.ULS.sendTraceTag(537163542,0,50,`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync takes ${V.a.Lb.hf.m-
fa} Millisecond.`);Ma?Ba.setResult(Ma):I(this.qig(),()=>{Ba.setResult(Ma)},"Failed to show customfunctions installation error info")},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions")},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to get registration information")},Oa=>{Oa=w.a.vf(Oa.data);b.ULS.sendTraceTag(537163541,0,10,`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Errors: ${ea.a.Uc(Oa)}.`);
J(wa.gxb,Sys.Serialization.JavaScriptSerializer.serialize(Ja));for(Oa=0;Oa<Fa.registrationInfos.length;Oa++)delete this.MG[Fa.registrationInfos[Oa].addinId],delete this.ZW[Ja[Oa]];Ba.setResult(!1)},ta,Ba,!0)}v6d(hb,Ja,Fa,Ba){return G(this.kck(hb,Ja,Fa,Ba),()=>this.POd(Ba.solutionId,!1),"Failed to unregister functions for customfunction addin")}kck(hb,Ja,Fa,Ba){const fa=new f.a;hb.iOb(Ja);(hb=oa.a.Ad(this.ZW,Ja))&&delete this.MG[hb.addinId];delete this.ZW[Ja];Ba=this.G6c(Ba);return this.I6(()=>{J(wa.vcd,
Ja);fa.setResult(!0)},ta=>{ta=w.a.vf(ta.data);b.ULS.sendTraceTag(537163539,0,10,`CustomFunctionsInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Ja,Fa,null)}. Errors: ${ea.a.Uc(ta)}.`);J(wa.ucd,Ja);fa.setResult(!1)},Ba,fa,!1)}I6(hb,Ja,Fa,Ba,fa){const ta=this.$.userOperationManager,Oa=this.$.qa;let Ma=null,fb=null,pa=null;const Ua=()=>{if(ta.eLa()||0<Oa.va.J6||0<Oa.Ol.J6)return!1;Ma&&ta.fp(Ma);fb&&Oa.Wt(fb);
pa&&Oa.Rz(pa);const Sa=Fa.request;let Ia=0;aa.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?Sa.RequestFlags&1&&256!==(Sa.RequestFlags&256)||(Ia=16):Ia=Sa.RequestFlags&1?0:16;ta.uG(new l.a(507,0,(X,ca,U)=>{J(fa?wa.tcd:wa.wcd,Sa.RequestBody);return k.g(Oa.va,"ExecuteRichApiRequest",Fa,ya.b(X,hb),ya.a(ca,Ja),U,null,0)},Ia|64));return!0};Ua()||(Ma=()=>{Ua()},fb=()=>{Ua()},pa=()=>{Ua()},ta.zs(Ma),Oa.Bs(fb),Oa.Qy(pa));return Ba.task}hKa(hb){const Ja={HttpMethod:"POST",
PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};Ja.RequestBody=JSON.stringify(hb);Ja.RequestFlags=1;aa.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(Ja.RequestFlags|=256);hb=this.$.qa.va.Pa(1);hb.request=Ja;return hb}t6c(hb){const Ja={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};Ja.RequestBody=JSON.stringify(hb);Ja.RequestFlags=1;aa.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&
(Ja.RequestFlags|=256);hb=this.$.qa.va.Pa(1);hb.request=Ja;return hb}G6c(hb){const Ja={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};Ja.RequestBody=JSON.stringify(hb);Ja.RequestFlags=1;aa.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(Ja.RequestFlags|=256);hb=this.$.qa.va.Pa(1);hb.request=Ja;return hb}POd(hb,Ja){const Fa=u.GetServiceTaskFactory.create(this.$.da,153,this.$.ka,1);return L(Fa,()=>{Fa.result.iUd();return hb&&Ja?
this.BEj(hb):la.Task.Ua(!0)},this.$.ka,x.a.instance,"CustomFunctionsInstaller::ProcessPostRegistrationActionsAsync failed due to create IFunctionInfoManager failed")}qig(){const hb=new Ea.a(1949669462,0,this.$.Tc,0,null);return this.$.Ia.mc(hb)}static Abf(hb){try{return la.Task.Ua(localStorage.getItem(hb))}catch(Ja){return b.ULS.sendTraceTag(537163537,0,50,`CustomFunctionsInstaller.GetLocalCacheItemSafe: Failed to get data from the localStorage. Reason: ${Ja.message||"Unknown"}`),la.Task.Ua(null)}}static tYd(hb,
Ja){try{return localStorage.setItem(hb,Ja),la.Task.Ua(!0)}catch(Fa){return b.ULS.sendTraceTag(537163536,0,50,`CustomFunctionsInstaller.SetLocalCacheItemSafe: Failed to set data into the localStorage. Reason: ${Fa.message||"Unknown"}`),la.Task.Ua(!1)}}static Uwj(hb){try{return localStorage.removeItem(hb),la.Task.Ua(!0)}catch(Ja){return b.ULS.sendTraceTag(537163535,0,50,`CustomFunctionsInstaller.RemoveLocalCacheItemSafeAsync: Failed to set data into the localStorage. Reason: ${Ja.message||"Unknown"}`),
la.Task.Ua(!1)}}static fRh(hb){return ia.a.equals(hb,"registry",!0)||ia.a.equals(hb,"uploadfiledevcatalog",!0)||e.AFrameworkApplication.userNameUnknown||e.AFrameworkApplication.limitedEdit}static rAd(hb){if(!hb)return!1;try{JSON.parse(hb)}catch(Ja){return!1}return!0}}wa.JDb="CustomFunctionCache";wa.KDb="CustomFunction";wa.tcd=new xa(2,"CustomFunctions [Registration] [Begin] SolutionId=");wa.hxb=new xa(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");wa.gxb=new xa(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");
wa.wcd=new xa(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");wa.vcd=new xa(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");wa.ucd=new xa(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(r.a)(wa,"CustomFunctionsInstaller",null,[746])},1255:function(r,C,a){a.r(C);r=a(0);var c=a(2),b=a(15),e=a(988),f=a(172),d=a(126),h=a(201),l=a(59),k=a(52),u=a(40),v=a(119),x=a(540),w=a(1016);class m{constructor(K){K=K.split("|");this.My=K[1];this.FZc=K[2];this.J2d=
K[3]}get solutionId(){return this.My}get solutionVersion(){return this.FZc}get needToRestoreManifest(){return this.J2d===OSF.StoreTypeEnum.Registry.toString()}}Object(r.a)(m,"AddinStoreInfo",null,[]);class t{}Object(r.a)(t,"CustomFunctionRegistrationInfos",null,[]);const z=(K,R)=>{if(a(1255).CustomFunctionsLegacyInstaller.pBb("CustomFunctionsRuntimeLogging")&&window.console)switch(R=y(K.severity)+" "+K.message+R,K.severity){case 2:window.console.log&&window.console.log(R);break;case 0:window.console.info&&
window.console.info(R);break;case 1:window.console.error&&window.console.error(R)}},y=K=>{switch(K){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}};class D{}Object(r.a)(D,"InstallationInfo",null,[]);class H{}Object(r.a)(H,"UninstallationInfo",null,[]);var F=a(168),G=a(38),L=a(34),M=a(1),O=a(16),B=a(248),E=a(912),I=a(63);class S{constructor(K,R){this.cZc=K;this._message=R}get severity(){return this.cZc}get message(){return this._message}}Object(r.a)(S,"CustomFunctionLog",
null,[]);a.d(C,"CustomFunctionsLegacyInstaller",function(){return J});class J{constructor(K){this.MG={};this.$=K;this.Rud().cqa()}Cnf(K,R,Z,P){const V=new f.a;if(P.invariantNamespace)for(R=0;R<P.invariantNamespace.length;++R){const oa=P.invariantNamespace.charAt(R);if("."!==oa&&"_"!==oa&&"a">oa&&"z"<oa&&"A">oa&&"Z"<oa&&"0">oa&&"9"<oa)return b.ULS.sendTraceTag(537163530,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: InvariantNamespace validation failed. Character='${oa}', Position=${R}.`),V.setResult(!1),
V.task}J.cacheManifest(Z,P.manifest);let Ea=J.hQd(K);(null===Ea||void 0===Ea?0:Ea.isDynamicMetadata)?this.eRd(K,Ea,V,!1,!1):OSF.OUtil.xhrGet(P.metadataUrl,oa=>{Ea=Object(c.a)(new D,{addinId:Z,locale:P.locale,addinInvariantNamespace:P.invariantNamespace,addinNamespace:P.namespace,addinTitle:P.title,isXllCompatible:P.isXllCompatible,metadataContent:JSON.stringify(JSON.parse(oa))});this.eRd(K,Ea,V,!1,w.a(this.$,P))},oa=>{b.ULS.sendTraceTag(537163528,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Failed to download Custom Functions metadata for solution ${K}. ErrorCode: ${oa}.`);
V.setResult(!1)});return V.task}Enf(K,R,Z,P){R=new f.a;if(!J.rAd(Z))return b.ULS.sendTraceTag(537163527,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),R.setResult(!1),R.task;const V=J.hQd(K);if(!V)return b.ULS.sendTraceTag(537163526,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Unexpected error, could not read existing solution cache info."),R.setResult(!1),R.task;V.metadataContent=JSON.stringify(JSON.parse(Z));V.isDynamicMetadata=
!0;this.eRd(K,V,R,!0,P);return R.task}Srg(K){const R=new f.a,Z=k.GetServiceTaskFactory.create(this.$.da,106,this.$.ka,1);u.TaskExtensions.za(Z,()=>{const P=Z.result;P.ola();const V=Object(c.a)(new H,{solutionId:K});J.ORd(K);J.WRd(K);u.TaskExtensions.za(this.v6d(P,K,V),Ea=>{F.b(Ea)?R.setResult(Ea.result):(Ea.Jg?b.ULS.sendTraceTag(537163524,0,10,`CustomFunctionsLegacyInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: ${K}.`):Ea.ji&&b.ULS.sendTraceTag(537163523,0,10,`CustomFunctionsLegacyInstaller.UninstallAsync: Uninstall Custom Functions is canceled for solution: ${K}.`),
R.setResult(!1))},this.$.ka,0)},this.$.ka,3);return R.task}Rud(){const K=new f.a,R=J.mQd();0<R.length&&b.ULS.sendTraceTag(537163522,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");const Z=[];R.forEach(V=>{V=Object(d.a)(String,V);if(V=J.hQd(V)){const Ea=G.a.Ad(this.MG,V.addinId);Ea&&Ea===V.metadataContent||(this.MG[V.addinId]=V.metadataContent,Z.push(V))}});if(!Z.length)return K.setResult(!0),b.ULS.sendTraceTag(537163521,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: There is no custom function to register from cache"),
K.task;const P=k.GetServiceTaskFactory.create(this.$.da,106,this.$.ka,1);u.TaskExtensions.za(P,()=>{const V=P.result,Ea=Object(c.a)(new t,{registrationInfos:Z});u.TaskExtensions.za(this.L6b(V,R,Ea),oa=>{F.b(oa)?K.setResult(oa.result):(oa.Jg?b.ULS.sendTraceTag(537163491,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Failed to register Custom Functions."):oa.ji&&b.ULS.sendTraceTag(537163490,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Registering Custom Functions is canceled."),
K.setResult(!1))},this.$.ka,0)},this.$.ka,3);return K.task}AEj(K){K=new m(K);if(K.needToRestoreManifest){const R=J.Hrj(K.solutionId);OSF.OsfManifestManager.cacheManifestFromXml(K.solutionId,K.solutionVersion,R,this.$.xa.UICultureTag)}}eRd(K,R,Z,P,V){const Ea=k.GetServiceTaskFactory.create(this.$.da,106,this.$.ka,1);u.TaskExtensions.za(Ea,()=>{u.TaskExtensions.za(this.gRd(Ea.result,K,R,!1,P,V),oa=>{F.b(oa)?((oa=oa.result)&&J.jmk(K,R),Z.setResult(oa)):(oa.Jg?b.ULS.sendTraceTag(537163488,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Failed to register Custom Functions for solution: ${K}.`):
oa.ji&&b.ULS.sendTraceTag(537163487,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Registering Custom Functions is canceled for solution: ${K}.`),Z.setResult(!1))},this.$.ka,0)},this.$.ka,3)}gRd(K,R,Z,P,V,Ea){if(!V&&(V=G.a.Ad(this.MG,Z.addinId))&&V===Z.metadataContent)return I.Task.Ua(!0);this.MG[Z.addinId]=Z.metadataContent;const oa=new f.a;Ea||K.iOb(R);K.ola();K=this.hKa(Z);return this.I6(ea=>{z(J.hxb,R);const aa=ea.Result;204===aa.ResponseStatusCode?u.TaskExtensions.za(this.OOd(oa,Z.addinId,
P),ia=>{ia.Jg?R?b.ULS.sendTraceTag(537163485,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${R}.`):b.ULS.sendTraceTag(537163484,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for addinId ${Z.addinId}.`):ia.ji&&(R?b.ULS.sendTraceTag(537163483,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for solution ${R}.`):
b.ULS.sendTraceTag(537163482,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for addinId ${Z.addinId}.`));oa.setResult(!1)},this.$.ka,4):(ea=()=>{delete this.MG[Z.addinId];J.ORd(R);J.WRd(R);b.ULS.sendTraceTag(537163481,0,10,`CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solution: ${R}. Received status code ${aa.ResponseStatusCode}.`);oa.setResult(!1)},ea=Object(c.a)(new E.a,{kPa:OSF.InfoType.Error,title:Z.addinTitle,
description:String.format(O.a.instance.Xb(153),O.a.instance.ha(1892)),buttonText:O.a.instance.ha(4),cka:ea,Kkc:!1,bla:ea,errorCode:OSF.ErrorStatusCodes.WAC_CustomFunctionsRegistrationError}),e.a.e0d(ea))},ea=>{ea=v.a.vf(ea.data);b.ULS.sendTraceTag(537163480,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${R}. Errors: ${L.a.Uc(ea)}.`);z(J.gxb,R);delete this.MG[Z.addinId];oa.setResult(!1)},K,oa,!0)}L6b(K,R,Z){const P=new f.a;R.forEach(Ea=>
{Ea=Object(d.a)(String,Ea);K.jJe(Ea)});K.ola();const V=this.t6c(Z);return this.I6(Ea=>{z(J.hxb,Sys.Serialization.JavaScriptSerializer.serialize(R));Ea=Ea.Result;let oa=!0;var ea=[];M.EwaSettings.isChangeGateEnabled("OfficeVSO:7667457_responseBody"),ea=Sys.Serialization.JavaScriptSerializer.deserialize(Ea.ResponseBody.toString()),ea=Array.isArray(ea.value)?ea.value:null;for(let aa=0;aa<ea.length;aa++)ea[aa]||(oa=!1,delete this.MG[Z.registrationInfos[aa].addinId],J.ORd(R[aa]),J.WRd(R[aa]),b.ULS.sendTraceTag(537163478,
0,10,`CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solutionId: ${R[aa]}. Received status code ${Ea.ResponseStatusCode}.`));u.TaskExtensions.za(this.OOd(P,"",!1),aa=>{aa.Jg?b.ULS.sendTraceTag(537163477,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"):aa.ji&&b.ULS.sendTraceTag(537163476,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Batch register Custom Functions is canceled");
P.setResult(!1)},this.$.ka,4);P.setResult(oa)},Ea=>{Ea=v.a.vf(Ea.data);b.ULS.sendTraceTag(537163475,0,10,`CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions for solutionIds ${Sys.Serialization.JavaScriptSerializer.serialize(R)}. Errors: ${L.a.Uc(Ea)}.`);z(J.gxb,Sys.Serialization.JavaScriptSerializer.serialize(R));for(const oa of Z.registrationInfos)delete this.MG[oa.addinId];P.setResult(!1)},V,P,!0)}v6d(K,R,Z){const P=new f.a;K.iOb(R);K=this.G6c(Z);
return this.I6(()=>{z(J.vcd,R);u.TaskExtensions.za(this.OOd(P,Z.solutionId,!1),V=>{V.Jg?R&&b.ULS.sendTraceTag(537163473,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${R}.`):V.ji&&R&&b.ULS.sendTraceTag(537163472,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Unregistering Custom Functions is canceled for solution ${R}.`);P.setResult(!1)},this.$.ka,4)},V=>{V=v.a.vf(V.data);b.ULS.sendTraceTag(537163471,
0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${R}. Errors: ${L.a.Uc(V)}.`);z(J.ucd,R);P.setResult(!1)},K,P,!1)}I6(K,R,Z,P,V){const Ea=this.$.userOperationManager,oa=this.$.qa;let ea=null,aa=null,ia=null;const ya=()=>{if(Ea.eLa()||0<oa.va.J6||0<oa.Ol.J6)return!1;ea&&Ea.fp(ea);aa&&oa.Wt(aa);ia&&oa.Rz(ia);const za=Z.request;Ea.uG(new h.a(507,0,(la,xa,wa)=>{z(V?J.tcd:J.wcd,za.RequestBody);return l.g(oa.va,"ExecuteRichApiRequest",
Z,B.b(la,K),B.a(xa,R),wa,null,0)},(za.RequestFlags&1?0:16)|64));return!0};ya()||(ea=()=>{ya()},aa=()=>{ya()},ia=()=>{ya()},Ea.zs(ea),oa.Bs(aa),oa.Qy(ia));return P.task}hKa(K){const R={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};R.RequestBody=JSON.stringify(K);R.RequestFlags=1;K=this.$.qa.va.Pa(1);K.request=R;return K}t6c(K){const R={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};R.RequestBody=JSON.stringify(K);R.RequestFlags=1;
K=this.$.qa.va.Pa(1);K.request=R;return K}G6c(K){const R={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};R.RequestBody=JSON.stringify(K);R.RequestFlags=1;K=this.$.qa.va.Pa(1);K.request=R;return K}OOd(K,R,Z){const P=k.GetServiceTaskFactory.create(this.$.da,153,this.$.ka,1);u.TaskExtensions.za(P,()=>{P.result.iUd();R&&Z&&this.AEj(R);K.setResult(!0)},this.$.ka,3);return P}Fnf(){return I.Task.Ua(!0)}static mQd(){return(Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(J.pBb(x.a.O1a)||
"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(J.pBb(x.a.O1a)||"[]"):null)||[]}static dyg(K){J.uYd(x.a.O1a,Sys.Serialization.JavaScriptSerializer.serialize(K))}static hQd(K){K=J.pBb(x.a.Y7a(K))||"";return 0<K.length?Sys.Serialization.JavaScriptSerializer.deserialize(K,!0):null}static jmk(K,R){J.RXe(K);J.uYd(x.a.Y7a(K),Sys.Serialization.JavaScriptSerializer.serialize(R))}static ORd(K){J.y3f(K);J.R3f(x.a.Y7a(K))}static Hrj(K){return J.pBb(x.a.X7a(K))}static kmk(K,R){J.RXe(K);J.uYd(x.a.X7a(K),
R)}static WRd(K){J.y3f(K);J.R3f(x.a.X7a(K))}static RXe(K){const R=J.mQd();K=K.toLowerCase();R.includes(K)||(R.push(K),J.dyg(R))}static y3f(K){const R=J.mQd();K=K.toLowerCase();R.includes(K)&&(R.splice(Array.indexOf(R,K),1),J.dyg(R))}static cacheManifest(K,R){K=new m(K);K.needToRestoreManifest&&J.kmk(K.solutionId,R)}static pBb(K){try{return localStorage.getItem(K)}catch(R){return b.ULS.sendTraceTag(537163469,0,50,`CustomFunctionsLegacyInstaller.GetLocalStorageItemSafe: Failed to get data from the localStorage. Reason: ${R.message||
"Unknown"}`),null}}static uYd(K,R){try{localStorage.setItem(K,R)}catch(Z){b.ULS.sendTraceTag(537163468,0,50,`CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: ${Z.message||"Unknown"}`)}}static R3f(K){try{localStorage.removeItem(K)}catch(R){b.ULS.sendTraceTag(537163467,0,50,`CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: ${R.message||"Unknown"}`)}}static rAd(K){if(!K)return!1;try{JSON.parse(K)}catch(R){return!1}return!0}}
J.tcd=new S(2,"CustomFunctions [Registration] [Begin] SolutionId=");J.hxb=new S(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");J.gxb=new S(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");J.wcd=new S(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");J.vcd=new S(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");J.ucd=new S(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(r.a)(J,"CustomFunctionsLegacyInstaller",null,[746])},
1297:function(r,C,a){r=a(0);var c=a(206),b=a(15);class e{}Object(r.a)(e,"AddinCommandsHost",null,[]);var f=a(1371),d=a(1475),h=a(909),l=a(59);const k=(G,L,M,O,B,E)=>{const I=G.Pa(9);I.sharedInfo=L;return l.g(G,"InsertAgaveTaskpane",I,M,O,B,E,0)},u=(G,L,M,O,B,E,I=null)=>{I=G.Pa(9,I);I.sharedInfo=L;return l.g(G,"ShowAgaveTaskpane",I,M,O,B,E,0)};var v=a(382),x=a(201),w=a(40),m=a(1),t=a(248),z=a(156);class y extends z.a{constructor(G){super();this.ef=this.rGa="AddInCommandsDialog";this.Ac=5;this.dialogWidth=
695;this.dialogHeight=438;this.zjh="100%";this.wjh="408px";this.xjh="15px";this.yjh="0";this.DLg=G}get containerDiv(){return this.Mi}oy(){super.oy();this.Mi.style.width=this.zjh;this.Mi.style.height=this.wjh;this.Mi.style.marginTop=this.xjh;this.Mi.style.padding=this.yjh}kF(){super.kF();this.Rb.style.width=String.format("{0}px",this.dialogWidth);this.Rb.style.height=String.format("{0}px",this.dialogHeight)}dispose(){super.dispose();this.DLg()}}Object(r.a)(y,"AddInCommandsDialog",z.a,[]);var D=a(63),
H=a(79);z=a(106);a.d(C,"a",function(){return F});class F extends e{constructor(G,L,M,O=null,B=null){super();this.$=G;this.ze=L;this.ownerAddinInfo=M;this.je=B;this.Igb=O||D.Task.Ua(!0)}rjh(){const G=this.Igb;this.Igb=D.Task.Ua(!0);return G}disposeHost(G){this.ze.jUa(G)}setOwnerAddinEToken(G){this.ownerAddinInfo.eToken=G}showTaskpane(G,L,M){b.ULS.sendTraceTag(537170642,220,50,"ShowTaskpane action called.");let O=null,B=!1,E=(new f.a("m_excelWebRenderer_ewaCtl_",this.ownerAddinInfo.solutionId,new h.a,
!0)).HRe(G.solutionId.substr(this.ownerAddinInfo.solutionId.length));O=L.getSharedRuntimeForTaskpane("Workbook",E);B=!!O&&1===O.LifeTime;this.ze.mJe(B?this.ownerAddinInfo.solutionId:G.solutionId,B?O:null,null)||(this.$Af(B,!0),this.Igb=this.Pud(G,O,(I,S)=>{I?(B&&(I.PrimaryMarketplace.SolutionId=this.ownerAddinInfo.solutionId,I.SharedRuntime=O),I.WebExtensionOsfControlType=3,this.ze.sLa(I),M(I.InstanceId,S),this.$Af(B,!1),m.EwaSettings.isChangeGateEnabled("OfficeVSO:6085876_TelemetryForActiveAddinSuccessOnExcelWacEnabled")&&
b.ULS.sendTraceTag(524818146,220,50,"ShowTaskpane: succeed to call.")):(b.ULS.sendTraceTag(17306640,220,10,"ShowTaskpane: instance id is null."),M(null,S))}))}getSettings(G,L){let M=this.ze.rda(G.solutionId);M?L(this.ze.rW(M).OsfPropertyBag):this.Igb=this.Pud(G,null,O=>{O?L(O.OsfPropertyBag):b.ULS.sendTraceTag(537170641,220,10,"GetSettings: insertData is null.")})}showDialog(G,L,M){b.ULS.sendTraceTag(537170640,220,50,"ShowDialog action called.");const O=this.$.qa.va,B=I=>{const S=I.Result,J=S?S.AgaveData:
null;J?(this.ze.AQe(J,()=>{const K=new y(()=>{this.disposeHost(J.InstanceId)});K.initializeAndShow("",null,null);return K.containerDiv}),M(J.InstanceId,0)):(b.ULS.sendTraceTag(537170638,220,10,"ShowDialog: instance id is null."),M(null,I.Errors?I.Errors[0].ErrorCause:5001))},E=F.owa(G,this.ownerAddinInfo);this.Igb=v.a(this.$.userOperationManager,(I,S,J)=>k(O,E,t.b(I,B),S,J,null),I=>new x.a(500,0,I,64),this.je)}createUILessSandbox(G,L,M){b.ULS.sendTraceTag(537170637,220,50,"UILess action called.");
const O=L.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"),B=!!O&&1===O.LifeTime;(L=this.ze.OTh(B?this.ownerAddinInfo.solutionId:G.solutionId,B?O:null))?M(L,0):this.Igb=this.Pud(G,O,(E,I)=>{E?(B?(E.PrimaryMarketplace.SolutionId=this.ownerAddinInfo.solutionId,E.SharedRuntime=O,E.TaskpaneVisible=!1,E.WebExtensionOsfControlType=3,this.ze.sLa(E)):(E.WebExtensionOsfControlType=4,this.ze.AQe(E,()=>{F.Qjb.ia(E.InstanceId,new d.a);return F.Qjb.ma(E.InstanceId).Vca})),M(E.InstanceId,I)):(b.ULS.sendTraceTag(537170636,
220,10,"UILess: instance id is null."),M(null,I))})}Pud(G,L,M){let O=null;const B=this.$.qa.va,E=R=>{const Z=R.Result;(O=Z?Z.AgaveData:null)||M(null,R.Errors?R.Errors[0].ErrorCause:5001)},I=F.owa(G,this.ownerAddinInfo);L&&(b.ULS.sendTraceTag(537170634,220,50,"Shared runtime agave is inserted."),I.SharedRuntimeId=L.Resid);let S=500;var J=(R,Z,P)=>k(B,I,t.b(R,E),Z,P,null);let K=0;void 0===I.IsToBePersisted||null===I.IsToBePersisted||I.IsToBePersisted||(S=538,J=(R,Z,P)=>{b.ULS.sendTraceTag(537170633,
220,50,"Web Method ShowAgaveTaskpane is called, StoreType {0}, StoreId {1}, SolutionId {2}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(this.ownerAddinInfo.solutionId,this.ownerAddinInfo.storeType,this.ownerAddinInfo.assetId,null,null,this.ownerAddinInfo.storeId));return u(B,I,t.b(R,E),Z,P,null)},K=16);K|=64;J=v.a(this.$.userOperationManager,J,R=>new x.a(S,0,R,K),this.je);return w.TaskExtensions.ts(J,()=>O?this.LCd(B,O.InstanceId,(R,Z)=>{if(R){L||(O.PrimaryMarketplace.MarketplaceType=G.storeType);
G.assetId?G.assetId.toLowerCase().startsWith("wa")?O.AssetMarketplace={SolutionId:G.assetId,SolutionVersion:G.version,MarketplaceType:OSF.StoreType.OMEX,MarketplaceRef:G.assetStoreId}:(O.AssetMarketplace=null,b.ULS.sendTraceTag(512325019,344,10,"WACExcelAddinCommandsHost: AssetId is not a valid value")):O.AssetMarketplace=null;O.OwnerAddinSolutionId=this.ownerAddinInfo.solutionId;O.OwnerAddinStoreType=this.ownerAddinInfo.storeType;O.OsfPropertyBag=[];for(Z=0;Z<R.Settings.length;Z++){const P=[];P[0]=
R.Settings[Z].Name;P[1]=R.Settings[Z].Value;O.OsfPropertyBag[Z]=P}M(O,0)}else M(null,Z.Errors?Z.Errors[0].ErrorCause:5001)}):D.Task.Ua(!1),c.a.none,3,H.a.current)}LCd(G,L,M){const O=B=>{M(B.Result,B)};return v.a(this.$.userOperationManager,(B,E,I)=>{B=t.b(B,O);const S=G.Pa(1);S.controlId=L;return l.g(G,"DdaLoadSettings",S,B,E,I,null,0)},B=>new x.a(501,0,B,80),this.je)}$Af(G,L){var M;G&&(null===(M=window.performance)||void 0===M?0:M.memory)&&b.ULS.sendTraceTag(537170630,220,50,`Shared runtime memory usage: before=${L}, jsHeapSizeLimit=${window.performance.memory.jsHeapSizeLimit}, totalJSHeapSize=${window.performance.memory.totalJSHeapSize}, usedJSHeapSize=${window.performance.memory.usedJSHeapSize}`)}static showUILessDialog(G){F.Qjb.Pb(G)&&
F.Qjb.ma(G).initializeAndShowWithTitle()}static hideUILessDialog(G){F.Qjb.Pb(G)&&F.Qjb.ma(G).hide()}static owa(G,L){const M={};M.SolutionId=G.solutionId;M.Version=G.version;M.StoreType=L.storeType;M.StoreId=G.storeId;M.AssetId=G.solutionId;M.AssetStoreId="omex";M.TargetType=1;M.Width=350;M.OwnerAddinSolutionId=L.solutionId;M.OwnerAddinStoreType=L.storeType;M.SharedRuntimeId=null;M.Preload=!1;return M}}F.Qjb=new z.a;Object(r.a)(F,"WACExcelAddinCommandsHost",e,[])},1371:function(r,C,a){a.d(C,"a",function(){return b});
r=a(0);a(15);var c=a(6);class b{constructor(e,f,d,h){this.Zob=e;c.AFrameworkApplication.fa.ra("AddInCommandsMissingTabIsEnabled")&&d.a$h();this.My=f;this.lOg=h}get BJb(){return this.Zob}get solutionId(){return this.My}get B_d(){return this.lOg}JNa(e){e=this.BJb+this.solutionId+e;return this.B_d?(e in b.e5b||(b.e5b[e]="AddinControl"+b.WZg++),b.e5b[e]):e}HRe(e){if(this.B_d){const d=b.e5b;for(let h in d){var f=h;if(e===d[h])return f.substr(this.BJb.length+this.solutionId.length)}}return e}rff(e){e=this.BJb+
this.solutionId+e;return this.B_d?(e in b.u3c||(b.u3c[e]="AddinTab"+b.g_g++),b.u3c[e]):e}}b.e5b={};b.u3c={};b.g_g=0;b.WZg=0;Object(r.a)(b,"DefaultRibbonNamingProvider",null,[807])},1436:function(r,C,a){a.r(C);r=a(0);var c=a(15),b=a(126),e;(function(w){w[w.none=0]="none";w[w.testEvent=1]="testEvent";w[w.test1Event=2]="test1Event";w[w.worksheetDataChangedEvent=10]="worksheetDataChangedEvent";w[w.worksheetActivatedEvent=11]="worksheetActivatedEvent";w[w.worksheetDeactivatedEvent=12]="worksheetDeactivatedEvent";
w[w.worksheetAddedEvent=13]="worksheetAddedEvent";w[w.worksheetSelectionChangedEvent=14]="worksheetSelectionChangedEvent";w[w.worksheetDeletedEvent=15]="worksheetDeletedEvent";w[w.worksheetCalculatedEvent=16]="worksheetCalculatedEvent";w[w.worksheetFilteredEvent=17]="worksheetFilteredEvent";w[w.worksheetFormatChangedEvent=18]="worksheetFormatChangedEvent";w[w.worksheetRowSortedEvent=19]="worksheetRowSortedEvent";w[w.worksheetColumnSortedEvent=20]="worksheetColumnSortedEvent";w[w.worksheetSingleClickedEvent=
21]="worksheetSingleClickedEvent";w[w.worksheetRowHiddenChangedEvent=22]="worksheetRowHiddenChangedEvent";w[w.worksheetFormulaChangedEvent=23]="worksheetFormulaChangedEvent";w[w.worksheetProtectionChangedEvent=24]="worksheetProtectionChangedEvent";w[w.worksheetNameChangedEvent=25]="worksheetNameChangedEvent";w[w.worksheetVisibilityChangedEvent=26]="worksheetVisibilityChangedEvent";w[w.worksheetMovedEvent=27]="worksheetMovedEvent";w[w.worksheetNavigationObjectChangedEvent=28]="worksheetNavigationObjectChangedEvent";
w[w.worksheetRowHeightChangedEvent=29]="worksheetRowHeightChangedEvent";w[w.workbookFormulaReferenceStyleChangedEvent=30]="workbookFormulaReferenceStyleChangedEvent";w[w.chartAddedEvent=50]="chartAddedEvent";w[w.chartActivatedEvent=51]="chartActivatedEvent";w[w.chartDeactivatedEvent=52]="chartDeactivatedEvent";w[w.chartDeletedEvent=53]="chartDeletedEvent";w[w.tableSelectionChangedEvent=100]="tableSelectionChangedEvent";w[w.tableDataChangedEvent=101]="tableDataChangedEvent";w[w.tableAddedEvent=102]=
"tableAddedEvent";w[w.tableDeletedEvent=103]="tableDeletedEvent";w[w.tableFilteredEvent=104]="tableFilteredEvent";w[w.agaveVisualUpdateEvent=150]="agaveVisualUpdateEvent";w[w.customFunctionExecutionBeginEvent=200]="customFunctionExecutionBeginEvent";w[w.customFunctionExecutionEndEvent=201]="customFunctionExecutionEndEvent";w[w.commentAddedEvent=250]="commentAddedEvent";w[w.commentDeletedEvent=251]="commentDeletedEvent";w[w.commentChangedEvent=252]="commentChangedEvent";w[w.invocationMessage=1E3]=
"invocationMessage";w[w.cancellationMessage=1001]="cancellationMessage";w[w.metadataMessage=1002]="metadataMessage";w[w.visualSelectionChangedEvent=2E3]="visualSelectionChangedEvent";w[w.visualChangeEvent=2001]="visualChangeEvent";w[w.visualTrackerModelChangedEvent=2002]="visualTrackerModelChangedEvent";w[w.shapeSelectionChangedEvent=2100]="shapeSelectionChangedEvent";w[w.shapeActivatedEvent=2101]="shapeActivatedEvent";w[w.shapeDeactivatedEvent=2102]="shapeDeactivatedEvent";w[w.shapeAddedEvent=2103]=
"shapeAddedEvent";w[w.shapeDeletedEvent=2104]="shapeDeletedEvent";w[w.workbookAutoSaveSettingChangedEvent=2200]="workbookAutoSaveSettingChangedEvent";w[w.wacOperationEvent=2201]="wacOperationEvent";w[w.recordingStateChangedEvent=2202]="recordingStateChangedEvent";w[w.workbookActivatedEvent=2203]="workbookActivatedEvent";w[w.workbookNavigationObjectChangedEvent=2204]="workbookNavigationObjectChangedEvent";w[w.ribbonCommandExecutedEvent=2300]="ribbonCommandExecutedEvent";w[w.linkedDataTypeRefreshRequestCompletedEvent=
2500]="linkedDataTypeRefreshRequestCompletedEvent";w[w.linkedDataTypeRefreshModeChangedEvent=2501]="linkedDataTypeRefreshModeChangedEvent";w[w.linkedDataTypeLinkedDataTypeAddedEvent=2502]="linkedDataTypeLinkedDataTypeAddedEvent";w[w.linkedWorkbookWorkbookLinksChangedEvent=2600]="linkedWorkbookWorkbookLinksChangedEvent";w[w.linkedWorkbookRefreshCompletedEvent=2601]="linkedWorkbookRefreshCompletedEvent";w[w.rangePickerSelectionChangedEvent=2700]="rangePickerSelectionChangedEvent";w[w.rangePickerDeactivatedEvent=
2701]="rangePickerDeactivatedEvent";w[w.lineageActivityUpdateAvailableEvent=2800]="lineageActivityUpdateAvailableEvent";w[w.lineageActivityFilterUpdatedEvent=2801]="lineageActivityFilterUpdatedEvent";w[w.lineageActivityLoadCompletedEvent=2802]="lineageActivityLoadCompletedEvent";w[w.pivotTableAddedEvent=2900]="pivotTableAddedEvent";w[w.pivotTableDeletedEvent=2901]="pivotTableDeletedEvent";w[w.namedItemAddedEvent=3E3]="namedItemAddedEvent";w[w.namedItemDeletedEvent=3001]="namedItemDeletedEvent";w[w.guidedReapplyManagerUpdateAvailableEvent=
3100]="guidedReapplyManagerUpdateAvailableEvent";w[w.vbaRecorderRecordingChangedEvent=3200]="vbaRecorderRecordingChangedEvent";w[w.externalCodeServiceDiagnosticsNewEntryEvent=3300]="externalCodeServiceDiagnosticsNewEntryEvent";w[w.externalCodeServiceDiagnosticsFilterUpdatedEvent=3301]="externalCodeServiceDiagnosticsFilterUpdatedEvent";w[w.rangeValuesPreviewDismissedEvent=3400]="rangeValuesPreviewDismissedEvent";w[w.appRuntimeVisibilityChangedEvent=65539]="appRuntimeVisibilityChangedEvent";w[w.beforeCloseNotifiactionCancelledEvent=
65540]="beforeCloseNotifiactionCancelledEvent";w[w.augmentationLoopAnnotationAddedEvent=65541]="augmentationLoopAnnotationAddedEvent"})(e||(e={}));Object(r.b)("MessageType",e);var f=a(799),d=a(262),h=a(767),l=a(62),k=a(40),u=a(168),v=a(1);a.d(C,"DdaEventDispatch",function(){return x});class x{constructor(w){this.gC=null;this.Ipg={};this.Kpg={};this.ljd={};this.DHd={};this.srd=(m,t)=>{m=this.$.yc.Fd("Task","DdaEventDispatch.HandleServerEvent");t=t.Wbg;for(let H=0;H<t.length;H++)switch(t[H].EventType){case 2:var z=
t[H],y={};y.Name=z.Name;y.BindingType=z.BindingType;y.ColCount=z.ColCount;y.RowCount=z.RowCount;this.Nya(z.InstanceId,OSF.DDA.EventDispId.dispidBindingDataChangedEvent,y,null);break;case 4:this.Nya(t[H].InstanceId,OSF.DDA.EventDispId.dispidSettingsChangedEvent,null,null);break;case 8:if(z=t[H],z.InstanceId){y=Array(z.Entries.length);for(var D=0;D<z.Entries.length;D++)y[D]=x.Aic(z.Entries[D],z.IsRemoteOverride);0<z.Entries.length&&1===z.Entries[0].Category?this.Qmj(z.InstanceId,y):z.InstanceId&&this.Nya(z.InstanceId,
OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,y)}else{this.ljd={};this.DHd={};for(y=0;y<z.Entries.length;y++)this.DUe(z.Entries[y],z.IsRemoteOverride);z=JSON.stringify(this.ljd);y=JSON.stringify(this.DHd);D=JSON.stringify(this.Ipg);const F=JSON.stringify(this.Kpg);c.ULS.sendTraceTag(537170593,0,50,`Number of Fired event: ${z}, Number of Not Fired event: ${y}, Total Number of Fired event: ${D}, Total Number of Not Fired event: ${F}`)}}m.stop()};this.xQb=(m,t)=>{this.Nya(m,OSF.DDA.EventDispId.dispidRichApiMessageEvent,
null,t)};this.$=w;this.dDc=this.srd}I4b(w){w&&(this.ola(),this.gC.push(w))}hAc(w){this.gC&&(Array.remove(this.gC,w),this.gC.length||(this.$.wantServerEvents=!1,this.$.cAj(this.dDc),this.gC=null))}Qmj(w,m){const t=Object(b.a)(h.DdaFacade,d.a(this.$));k.TaskExtensions.za(t.Gai(w),z=>{if(u.b(z)){var y=z.result;z=t.Xn(y);if(y)if(z.koc)this.Nya(y,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,m);else if(z.Yac)for(y=0;y<m.length;y++)z.Yac.push(m[y]);else z.Yac=m}else z.Jg?c.ULS.sendTraceTag(537170591,
0,10,"DdaEventDispatch.HandleServerEvent: Failed to get or create Custom Functions sandbox."):z.ji&&c.ULS.sendTraceTag(537170590,0,10,"DdaEventDispatch.HandleServerEvent: Getting or creating Custom Functions sandbox is cancelled.")},this.$.ka,0)}mnj(w,m){const t=Object(b.a)(h.DdaFacade,d.a(this.$)),z=t.r_h(w);z?OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(z,m,this.xQb):t.Vlh(w,m)}DUe(w,m){let t=!1;const z=parseInt(w.Type,10);var y=w.Target;const D=Object(b.a)(h.DdaFacade,d.a(this.$));
if((y=D.gi.Mai(z,y))&&0<Object.keys(y).length){t=!0;for(let F in y)if(y=F,D.gi.a6b(y)){const G=Array(1);G[0]=x.Aic(w,m);if(v.EwaSettings.isChangeGateEnabled("OfficeVSO:5379862_RichApiEventsTriggerSource")){var H=G[0][3];if(void 0!==H&&null!==H&&(H=Object(b.a)(Object,l.a.ij(H)))&&void 0!==H.triggerControlId&&null!==H.triggerControlId&&void 0!==H.triggerSource&&null!==H.triggerSource){let L=!1;m?(H.triggerSource="Unknown",L=!0):D.Kzh(H.triggerControlId,y)&&(H.triggerSource="ThisLocalAddin",L=!0);L&&
(G[0][3]=l.a.nd(H))}}this.Nya(y,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,G)}}t?(this.olc(e[z],this.ljd),this.olc(e[z],this.Ipg)):(this.olc(e[z],this.DHd),this.olc(e[z],this.Kpg))}ola(){this.gC||(this.gC=[],this.$.gze(this.dDc),this.$.wantServerEvents=!0)}olc(w,m){w in m||(m[w]=0);m[w]+=1}yG(w,m,t){const z={};z.Target=m;z.Category=65536;z.Type=w;z.Message=t;z.Id=-1;this.DUe(z,!1)}dUh(w,m){const t={Target:"",Category:2,Type:1E3};t.Message=m;t.Id=0;m=Array(1);m[0]=x.Aic(t,!1);this.mnj(w,m)}ufc(w,
m,t,z){const y={};y.Target=t;y.Category=65536;y.Type=m;y.Message=z;y.Id=-1;m=Array(1);m[0]=x.Aic(y,!1);this.Nya(w,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,m)}cUh(w,m){this.Nya(w,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,m)}Nya(w,m,t,z){if(this.gC){var y=Object(b.a)(h.DdaFacade,d.a(this.$));if(!y||m!==OSF.DDA.EventDispId.dispidBindingDataChangedEvent&&m!==OSF.DDA.EventDispId.dispidSettingsChangedEvent||y.gi.a6b(w)){w=new f.a(m,w,t,z);for(let D=0,H=this.gC.length;D<H;D++)(m=this.gC[D])&&
m(w)}}}static Aic(w,m){const t=Array(6);t[0]=w.Category;t[1]=w.Type;t[2]=w.Target;t[3]=w.Message;t[4]=w.Id;t[5]=m;return t}}Object(r.a)(x,"DdaEventDispatch",null,[])},1475:function(r,C,a){a.d(C,"a",function(){return b});r=a(0);C=a(156);var c=a(93);class b extends C.a{constructor(){super(void 0,void 0,void 0,!0);this.rGa="AddinCommandsUILessDialog";this.F_c="WACDialogTitleText";this.nZ="0";this.CF=380;this.wD=190;this.ef=this.rGa;this.Ac=5;this.pFg=String.format("{0}px",this.CF);this.mZ=String.format("{0}px",
this.wD);this.Wif=this.Ru=!1;this.oy()}oy(){super.oy();this.Mi.style.width=this.pFg;this.Mi.style.height=this.mZ;this.Mi.style.padding=this.nZ}Uz(e){this.kF();document.getElementById(this.Hi(this.F_c)).innerText=e}kF(){super.kF();this.Rb.style.width=String.format("{0}px",this.CF);this.Rb.style.height=String.format("{0}px",this.wD);this.Rb.removeAttribute(c.a.te);this.Rb.removeAttribute(c.a.FN)}hide(){this.a9a()}get Vca(){return this.Mi}initializeAndShowWithTitle(){this.initializeAndShow(CommonUIStrings.l_NotificationUITitle,
null,null)}}Object(r.a)(b,"AddinCommandsUILessDialog",C.a,[816])},1508:function(r,C,a){a.r(C);var c=a(522),b=a(10),e=a(0),f=a(230),d=a(198),h=a(602);class l{constructor(){this.mlb=null}get i5g(){this.mlb||(this.mlb=new d.a,this.mlb.add(12),this.mlb.add(11));return this.mlb}qzi(Q){return this.i5g.contains(Q.operation)}wbk(Q){const Wa=[],Ib=Q.payload;for(const fc of Ib.batchedOperations)Wa.push(new h.a(Q.operation,fc));return Wa}}Object(e.a)(l,"MacroRecorderBatchedEventList",null,[]);var k=a(15),u=
a(62),v=a(134),x=a(662);class w{equals(Q,Wa){return Q===Wa}getHashCode(Q){return Q}sma(Q){return Q}}Object(e.a)(w,"UserOperationNameComparer",null,[118,119]);class m{static jji(){m.ld||(m.ld=new x.a(new w),m.ld.add(507),m.ld.add(10),m.ld.add(576),m.ld.add(563),m.ld.add(564),m.ld.add(565),m.ld.add(566),m.ld.add(567),m.ld.add(568),m.ld.add(569),m.ld.add(570),m.ld.add(571),m.ld.add(572),m.ld.add(573),m.ld.add(574),m.ld.add(575),m.ld.add(501),m.ld.add(520),m.ld.add(1),m.ld.add(1002),m.ld.add(129),m.ld.add(198),
m.ld.add(500),m.ld.add(519),m.ld.add(538),m.ld.add(1E3),m.ld.add(1003),m.ld.add(144),m.ld.add(502),m.ld.add(505),m.ld.add(179),m.ld.add(205),m.ld.add(134),m.ld.add(230),m.ld.add(103),m.ld.add(110),m.ld.add(112),m.ld.add(113),m.ld.add(124),m.ld.add(133),m.ld.add(154),m.ld.add(162),m.ld.add(168),m.ld.add(172),m.ld.add(201),m.ld.add(222),m.ld.add(227),m.ld.add(513),m.ld.add(534),m.ld.add(539),m.ld.add(545),m.ld.add(600),m.ld.add(547),m.ld.add(555),m.ld.add(558),m.ld.add(562),m.ld.add(585),m.ld.add(1001),
m.ld.add(1005),m.ld.add(1008),m.ld.add(1010),m.ld.add(1011),m.ld.add(1012),m.ld.add(1018),m.ld.add(1029),m.ld.add(252),m.ld.add(253),m.ld.add(258),m.ld.add(101),m.ld.add(102),m.ld.add(108),m.ld.add(257),m.ld.add(119),m.ld.add(120),m.ld.add(123),m.ld.add(126),m.ld.add(127),m.ld.add(130),m.ld.add(140),m.ld.add(159),m.ld.add(160),m.ld.add(165),m.ld.add(166),m.ld.add(167),m.ld.add(169),m.ld.add(189),m.ld.add(223),m.ld.add(214),m.ld.add(228),m.ld.add(233),m.ld.add(247),m.ld.add(504),m.ld.add(511),m.ld.add(512),
m.ld.add(525),m.ld.add(533),m.ld.add(537),m.ld.add(542),m.ld.add(544),m.ld.add(548),m.ld.add(550),m.ld.add(551),m.ld.add(552),m.ld.add(554),m.ld.add(577),m.ld.add(584),m.ld.add(586),m.ld.add(587),m.ld.add(588),m.ld.add(592),m.ld.add(1009),m.ld.add(1016),m.ld.add(1017),m.ld.add(1024),m.ld.add(260),m.ld.add(597),m.ld.add(264),m.ld.add(596),m.ld.add(254),m.ld.add(262),m.ld.add(1030),m.ld.add(1031),m.ld.add(606));return m.ld}}m.ld=null;Object(e.a)(m,"MacroRecorderUnrecognizedEventList",null,[]);class t{constructor(Q,
Wa,Ib){this.pzb=null;this.DTi=(fc,sc)=>{this.khg()&&this.ijd(sc)};this.mDf=Wa;this.lDf=Ib;this.$=Q;this.$.hX&&this.$.vYg(this.DTi);Q.da.Ja(297,this)}init(Q){this.$.hX&&(Q?this.pzb=Q:k.ULS.sendTraceTag(537155424,0,10,"MacroRecorderEventHandler.Init failed because the function passed in is null."))}ijd(Q){if(this.khg())try{if(this.lDf.qzi(Q)){var Wa=this.lDf.wbk(Q);for(const Ib of Wa)this.G4e(Ib)}else this.G4e(Q)}catch(Ib){Wa=`MacroRecorderEventHandler.FireMacroRecorderEvent: Error: ${v.a(Q.operation)}, Exception: ${Ib.stack}`;
k.ULS.sendTraceTag(537155423,0,10,Wa);try{this.aUh(Q)}catch(fc){}}}G4e(Q){var Wa=this.mDf.Gbf(Q,!0);Wa?(this.pzb(Wa.eventId,u.a.nd(Q.payload)),k.ULS.sendTraceTag(537155422,0,50,`MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: ${Wa.eventId}`)):(Wa=this.mDf.Gbf(Q,!1))?k.ULS.sendTraceTag(537155421,0,50,`MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: ${Wa.eventId}, but failed to match filters`):m.jji().contains(Q.operation)||(this.pzb(0,u.a.nd(Q.operation)),Q=`MacroRecorderEventHandler.FireMacroRecorderEvent: Unrecognized: ${v.a(Q.operation)}`,
k.ULS.sendTraceTag(537155420,0,50,Q))}aUh(Q){this.pzb(222,u.a.nd(Q.operation))}khg(){return this.$.Rna&&this.pzb&&this.$.oea?!0:!1}}Object(e.a)(t,"MacroRecorderEventHandler",null,[748]);var z=a(1);class y{constructor(){this.tQc=this.uQc=this.BWc=this.e0c=null}get operations(){this.BWc||(this.BWc=new d.a,this.Jc());return this.BWc}get MKc(){this.e0c||(this.e0c=new d.a,this.Xg());return this.e0c}get l3e(){this.tQc||(this.tQc=new d.a);return this.tQc}get featureGates(){this.uQc||(this.uQc=new d.a,this.sud());
return this.uQc}Xg(){}sud(){}ie(Q){this.MKc.add(Q)}zc(Q){this.operations.contains(Q)||this.operations.add(Q)}twe(Q){this.l3e.add(Q)}}Object(e.a)(y,"MacroRecorderEventBase",null,[]);class D extends y{constructor(){super()}get eventId(){return 130}Jc(){this.zc(100)}}Object(e.a)(D,"AccessibilityCheckRunEvent",y,[]);class H extends y{constructor(){super()}get eventId(){return 160}Jc(){this.zc(241)}Xg(){this.ie(Q=>Q.addToPrintArea)}}Object(e.a)(H,"AddedToPrintAreaEvent",y,[]);class F extends y{constructor(){super()}get eventId(){return 65}Jc(){this.zc(516)}}
Object(e.a)(F,"AutoFilterToggledEvent",y,[]);class G extends y{constructor(){super()}get eventId(){return 118}Jc(){this.zc(502)}Xg(){this.ie(Q=>!(Q.o8a().FirstColumn===Q.o8a().LastColumn&&Q.o8a().FirstRow===Q.o8a().LastRow))}}Object(e.a)(G,"AutoSumEvent",y,[]);class L extends y{constructor(){super()}get eventId(){return 223}Jc(){this.zc(1032)}}Object(e.a)(L,"CellImageAltTextAppliedEvent",y,[]);class M extends y{constructor(Q,Wa){super();this.aia=Q;this.ojk=Wa}get eventId(){return this.aia}Jc(){this.zc(529);
this.zc(594)}Xg(){this.ie(Q=>this.ojk.includes(Q.tod()))}}Object(e.a)(M,"ChartPropertyAppliedEventBase",y,[]);class O extends M{constructor(){super(84,[348,349,350,351,352,353,354,355,356,357,372,373,374,375])}}Object(e.a)(O,"ChartAxisChangedEvent",M,[]);class B extends M{constructor(){super(80,[-104,-103,300,301,302,303,304,305,306,307,308,309,310,311])}}Object(e.a)(B,"ChartAxisTitleChangedEvent",M,[]);class E extends M{constructor(){super(82,[200,201,202,203,204,205,206,207,208,209,210])}}Object(e.a)(E,
"ChartDataLabelsChangedEvent",M,[]);class I extends M{constructor(){super(76,[-100])}}Object(e.a)(I,"ChartDataSelectedEvent",M,[]);class S extends M{constructor(){super(83,[500,501,502])}}Object(e.a)(S,"ChartDataTableChangedEvent",M,[]);var J=a(564),K=a(425),R=a(126);class Z extends y{constructor(){super()}}Object(e.a)(Z,"RichApiRequestExecutedEventBase",y,[]);class P{constructor(Q,Wa,Ib){this.response=this.request=this.eventId=this.source=null;Q&&(this.source=Q.source,this.eventId=Q.eventId,this.request=
Wa,this.response=Ib)}get isValid(){return!(void 0===this.source||null===this.source)&&!(void 0===this.eventId||null===this.eventId)&&!0}}Object(e.a)(P,"MacroRecorderRichApiRequestExecutedPayload",null,[144]);class V extends Z{constructor(){super()}get eventId(){return 117}Zx(Q){V.N9||(V.N9=new x.a(J.a.hh()),V.N9.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),V.N9.add("fa000000014"));return!!Q&&V.N9.contains(Q.toLowerCase())}Jc(){this.zc(507);this.zc(10);this.zc(576)}Xg(){this.ie(Q=>Object(K.a)(P,Q)&&
(Q=Object(R.a)(P,Q),Q.isValid&&this.Zx(Q.source))?(k.ULS.sendTraceTag(537155427,0,50,`[RichApiRecorder]: A ChartFormatRichApiRequestExecutedEvent is matched! eventId: ${Q.eventId}`),!0):!1)}}V.N9=null;Object(e.a)(V,"ChartFormatRichApiRequestExecutedEvent",Z,[]);class Ea extends M{constructor(){super(85,[328,329,330,331,332,333,334,335])}}Object(e.a)(Ea,"ChartGridlinesChangedEvent",M,[]);class oa extends y{constructor(){super()}get eventId(){return 66}Jc(){this.zc(528)}}Object(e.a)(oa,"ChartInsertedEvent",
y,[]);class ea extends M{constructor(){super(81,[100,101,102,103,104,105,106])}}Object(e.a)(ea,"ChartLegendChangedEvent",M,[]);class aa extends M{constructor(){super(75,[-101])}}Object(e.a)(aa,"ChartRowColumnSwitchedEvent",M,[]);class ia extends M{constructor(){super(79,[0,1,2,-102])}}Object(e.a)(ia,"ChartTitleChangedEvent",M,[]);class ya extends M{constructor(){super(78,[-105,-106,-107,-108,-109,-110,-111,-112,-113,-114,-127,-116,-117,-118,-119,-120,-121,-122,-123,-125,-124,-126,-216,-217,-218,-219,
-221,-222,-220,-129,-130,-131])}}Object(e.a)(ya,"ChartTypeChangedEvent",M,[]);class za extends y{constructor(){super()}get eventId(){return 131}Jc(){this.zc(521)}}Object(e.a)(za,"ConnectorFloatingObjectResizedEvent",y,[]);class la extends y{constructor(){super()}get eventId(){return 129}Jc(){this.zc(109)}}Object(e.a)(la,"EntitySelectedEvent",y,[]);class xa extends y{constructor(){super()}get eventId(){return 49}Jc(){this.zc(149);this.zc(147)}}Object(e.a)(xa,"FindCellEvent",y,[]);class wa extends y{constructor(){super()}get eventId(){return 96}Jc(){this.zc(122)}}
Object(e.a)(wa,"FloatingObjectAltTextAppliedEvent",y,[]);class hb extends y{constructor(){super()}get eventId(){return 93}Jc(){this.zc(522)}}Object(e.a)(hb,"FloatingObjectDeletedEvent",y,[]);class Ja extends y{constructor(){super()}get eventId(){return 94}Jc(){this.zc(524)}}Object(e.a)(Ja,"FloatingObjectMovedAndResizedEvent",y,[]);class Fa extends y{constructor(){super()}get eventId(){return 95}Jc(){this.zc(523)}}Object(e.a)(Fa,"FloatingObjectRotatedEvent",y,[]);class Ba extends y{constructor(){super()}get eventId(){return 100}Jc(){this.zc(543)}}
Object(e.a)(Ba,"GroupDetailsShownOrHiddenEvent",y,[]);class fa extends y{constructor(){super()}get eventId(){return 154}Jc(){this.zc(125)}}Object(e.a)(fa,"HyperlinksRemovedFromRangeEvent",y,[]);class ta extends Z{constructor(){super()}get eventId(){return 125}Zx(Q){ta.N9||(ta.N9=new x.a(J.a.hh()),ta.N9.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),ta.N9.add("fa000000005"));return!!Q&&ta.N9.contains(Q.toLowerCase())}Jc(){this.zc(507);this.zc(10);this.zc(576)}Xg(){this.ie(Q=>Object(K.a)(P,Q)?(Q=Object(R.a)(P,
Q),Q.isValid&&this.Zx(Q.source)):!1)}}ta.N9=null;Object(e.a)(ta,"IdeasRichApiRequestExecutedEvent",Z,[]);class Oa extends y{constructor(){super()}get eventId(){return 136}Jc(){this.zc(115)}}Object(e.a)(Oa,"LinkedEntityConvertedEvent",y,[]);class Ma extends y{constructor(){super()}get eventId(){return 148}Jc(){this.zc(114)}}Object(e.a)(Ma,"LinkedEntityDisambiguationPaneToggledEvent",y,[]);class fb extends y{constructor(){super()}get eventId(){return 127}Jc(){this.zc(119)}}Object(e.a)(fb,"MovedToEdgeEvent",
y,[]);class pa extends y{constructor(){super()}get eventId(){return 135}Jc(){this.zc(191)}}Object(e.a)(pa,"NamedSheetViewCreatedEvent",y,[]);class Ua extends y{constructor(){super()}get eventId(){return 166}Jc(){this.zc(200)}}Object(e.a)(Ua,"NamedSheetViewDeletedEvent",y,[]);class Sa extends y{constructor(){super()}get eventId(){return 133}Jc(){this.zc(192)}}Object(e.a)(Sa,"NamedSheetViewExitedEvent",y,[]);class Ia extends y{constructor(){super()}get eventId(){return 162}Jc(){this.zc(199)}}Object(e.a)(Ia,
"NamedSheetViewRenamedEvent",y,[]);class X extends y{constructor(){super()}get eventId(){return 167}Jc(){this.zc(195)}}Object(e.a)(X,"NamedSheetViewSwitchedEvent",y,[]);class ca extends y{constructor(){super()}get eventId(){return 99}Jc(){this.zc(174)}}Object(e.a)(ca,"OutlineLevelSetEvent",y,[]);class U extends y{constructor(){super()}get eventId(){return 156}Jc(){this.zc(244)}}Object(e.a)(U,"PageBreakInsertedEvent",y,[]);class ma extends y{constructor(){super()}get eventId(){return 157}Jc(){this.zc(245)}}
Object(e.a)(ma,"PageBreakRemovedEvent",y,[]);class ra extends y{constructor(){super()}get eventId(){return 158}Jc(){this.zc(246)}}Object(e.a)(ra,"PageBreaksAllResetEvent",y,[]);class Va extends y{constructor(){super()}get eventId(){return 112}Jc(){this.zc(503)}Xg(){this.ie(Q=>!!Q.pasteParameters.ClientEstimationFloatingObjectId&&2===Q.pasteParameters.CopyPasteTargetType&&!Q.isFromCurrentSession)}}Object(e.a)(Va,"PasteArtOtherWorkbookEvent",y,[]);class ob extends y{constructor(){super()}get eventId(){return 52}Jc(){this.zc(503)}Xg(){this.ie(Q=>
!!Q.pasteParameters.ClientEstimationFloatingObjectId&&2===Q.pasteParameters.CopyPasteTargetType&&Q.isFromCurrentSession)}}Object(e.a)(ob,"PasteArtSameWorkbookEvent",y,[]);class ja extends y{constructor(){super()}get eventId(){return 110}Jc(){this.zc(204)}}Object(e.a)(ja,"PasteHtmlEvent",y,[]);class lb extends y{constructor(){super()}get eventId(){return 35}Jc(){this.zc(506)}}Object(e.a)(lb,"PasteRangeEvent",y,[]);class wb extends y{constructor(){super()}get eventId(){return 111}Jc(){this.zc(503)}Xg(){this.ie(Q=>
1===Q.pasteParameters.CopyPasteTargetType)}}Object(e.a)(wb,"PasteShadowWorkbookRangeEvent",y,[]);class Ab extends y{constructor(){super()}get eventId(){return 42}Jc(){this.zc(180)}}Object(e.a)(Ab,"PasteStringEvent",y,[]);class nb extends y{constructor(){super()}get eventId(){return 134}Jc(){this.zc(220)}}Object(e.a)(nb,"PendingMergeEvent",y,[]);class pb extends y{constructor(){super()}get eventId(){return 122}Jc(){this.zc(510)}}Object(e.a)(pb,"PictureInsertedEvent",y,[]);class cb extends y{constructor(){super()}get eventId(){return 153}Jc(){this.zc(161)}}
Object(e.a)(cb,"PivotDrillToggledEvent",y,[]);class Da extends y{constructor(Q,Wa){super();this.aia=Q;this.opType=Wa}get eventId(){return this.aia}Jc(){this.zc(225)}Xg(){this.ie(Q=>Q.opType===this.opType)}}Object(e.a)(Da,"PivotTableSettingsChangedEventBase",y,[]);class zb extends Da{constructor(){super(171,4)}}Object(e.a)(zb,"PivotTableAllItemLabelsRepeatedEvent",Da,[]);class qb extends Da{constructor(){super(184,17)}}Object(e.a)(qb,"PivotTableAltTextDescriptionChangedEvent",Da,[]);class Pa extends Da{constructor(){super(183,
16)}}Object(e.a)(Pa,"PivotTableAltTextTitleChangedEvent",Da,[]);class Nb extends Da{constructor(){super(173,6)}}Object(e.a)(Nb,"PivotTableAutoFitColumnWidthsOnRefreshToggledEvent",Da,[]);class Tb extends Da{constructor(){super(172,5)}}Object(e.a)(Tb,"PivotTableBlankLineAfterEachItemToggledEvent",Da,[]);class Vb extends Da{constructor(){super(170,3)}}Object(e.a)(Vb,"PivotTableColumnGrandTotalShownEvent",Da,[]);class Jb extends y{constructor(){super()}get eventId(){return 98}Jc(){this.zc(132)}}Object(e.a)(Jb,
"PivotTableCreatedEvent",y,[]);class Qa extends Da{constructor(){super(177,10)}}Object(e.a)(Qa,"PivotTableDisplayErrorStringToggledEvent",Da,[]);class Db extends Da{constructor(){super(178,11)}}Object(e.a)(Db,"PivotTableDisplayNullStringToggledEvent",Da,[]);class sa extends Da{constructor(){super(179,12)}}Object(e.a)(sa,"PivotTableErrorStringChangedEvent",Da,[]);class Ha extends Da{constructor(){super(174,7)}}Object(e.a)(Ha,"PivotTableExpandCollapseButtonsShownEvent",Da,[]);class mb extends Da{constructor(){super(187,
20)}}Object(e.a)(mb,"PivotTableIndentChangedEvent",Da,[]);class qa extends Da{constructor(){super(176,9)}}Object(e.a)(qa,"PivotTableItemsWithNoDataOnColumnsShownEvent",Da,[]);class Xa extends Da{constructor(){super(175,8)}}Object(e.a)(Xa,"PivotTableItemsWithNoDataOnRowsShownEvent",Da,[]);class Ca extends Da{constructor(){super(186,19)}}Object(e.a)(Ca,"PivotTableLayoutTypeSetEvent",Da,[]);class va extends Da{constructor(){super(180,13)}}Object(e.a)(va,"PivotTableNullStringChangedEvent",Da,[]);class na extends y{constructor(){super()}get eventId(){return 149}Jc(){this.zc(219)}}
Object(e.a)(na,"PivotTablePivotLocationChangedEvent",y,[]);class Ka extends y{constructor(){super()}get eventId(){return 102}Jc(){this.zc(145)}}Object(e.a)(Ka,"PivotTablePivotedEvent",y,[]);class ib extends Da{constructor(){super(182,15)}}Object(e.a)(ib,"PivotTableRefreshDataOnLoadToggledEvent",Da,[]);class Ra extends y{constructor(){super()}get eventId(){return 104}Jc(){this.zc(50)}Xg(){this.ie(Q=>!!Q.pivotTableId&&!!Q.pivotTableName)}}Object(e.a)(Ra,"PivotTableRefreshedEvent",y,[]);class ka extends Da{constructor(){super(168,
1)}}Object(e.a)(ka,"PivotTableRenamedEvent",Da,[]);class da extends Da{constructor(){super(169,2)}}Object(e.a)(da,"PivotTableRowGrandTotalShownEvent",Da,[]);class kb extends Da{constructor(){super(181,14)}}Object(e.a)(kb,"PivotTableSaveSourceDataWithFileToggledEvent",Da,[]);var Ob=a(625);class lc extends y{constructor(){super()}get eventId(){return 155}Jc(){this.zc(131)}Xg(){this.ie(Q=>{Q=Object(R.a)(Ob.a,Q);return!!Q&&!!Q.ONa()&&!!Q.hierarchyName})}}Object(e.a)(lc,"PivotTableSortedEvent",y,[]);class tc extends Da{constructor(){super(185,
18)}}Object(e.a)(tc,"PivotTableSubTotalsVisibilitySettingSetEvent",Da,[]);class Pb extends y{constructor(){super()}get eventId(){return 206}Jc(){this.zc(560)}}Object(e.a)(Pb,"PivotValueFieldSettingAppliedEvent",y,[]);class tb extends y{constructor(){super()}get eventId(){return 161}Jc(){this.zc(243)}}Object(e.a)(tb,"PrintAreaClearedEvent",y,[]);class gc extends y{constructor(){super()}get eventId(){return 159}Jc(){this.zc(241)}Xg(){this.ie(Q=>!Q.addToPrintArea)}}Object(e.a)(gc,"PrintAreaSetEvent",
y,[]);class Xb extends y{constructor(){super()}get eventId(){return 57}Jc(){this.zc(517)}}Object(e.a)(Xb,"RangeAutoFilterClearedEvent",y,[]);class Ga extends y{constructor(Q,Wa){super();this.aia=Q;this.p8d=Wa}get eventId(){return this.aia}Jc(){this.zc(11)}Xg(){this.ie(Q=>16===Q.x0().ValidMembers);this.ie(Q=>Q.x0().Font.ValidMembers===this.p8d)}}Object(e.a)(Ga,"RangeFontFormattedEventBase",y,[]);class Za extends Ga{constructor(){super(3,4)}}Object(e.a)(Za,"RangeBoldedEvent",Ga,[]);class Sb extends y{constructor(){super()}get eventId(){return 2}Jc(){this.zc(11)}Xg(){this.ie(Q=>
128===Q.x0().ValidMembers)}}Object(e.a)(Sb,"RangeBorderedEvent",y,[]);class sb{}sb.Ndb="Table";sb.rwc="Sheet";Object(e.a)(sb,"MacroRecorderEventConstants",null,[]);class bc extends y{constructor(){super()}get eventId(){return 113}Jc(){this.zc(208)}Xg(){this.ie(Q=>Q.getParameters().FilterType===sb.rwc)}}Object(e.a)(bc,"RangeCheckedItemsFilteredEvent",y,[]);class kc extends y{constructor(){super()}get eventId(){return 109}Jc(){this.zc(105)}}Object(e.a)(kc,"RangeConditionalFormattingCreatedEvent",y,
[]);class vb extends y{constructor(){super()}get eventId(){return 124}Jc(){this.zc(221)}}Object(e.a)(vb,"RangeConditionalFormattingRuleDeletedEvent",y,[]);class ub extends y{constructor(){super()}get eventId(){return 29}Jc(){this.zc(508)}Xg(){this.ie(Q=>3===Q.Ms()||1===Q.Ms()||4===Q.Ms())}}Object(e.a)(ub,"RangeContentClearedEvent",y,[]);class Ub extends y{constructor(){super()}get eventId(){return 40}Jc(){this.zc(104)}}Object(e.a)(Ub,"RangeCopiedCutCellsInsertedEvent",y,[]);class Rd extends y{constructor(){super()}get eventId(){return 114}Jc(){this.zc(209)}Xg(){this.ie(Q=>
Q.getParameters().FilterType===sb.rwc)}}Object(e.a)(Rd,"RangeCustomFilteredEvent",y,[]);class Cd extends y{constructor(){super()}get eventId(){return 106}Jc(){this.zc(121)}}Object(e.a)(Cd,"RangeDataValidationChangedEvent",y,[]);class Yc extends Ga{constructor(){super(4,64)}}Object(e.a)(Yc,"RangeDoubleUnderlinedEvent",Ga,[]);class Kd extends y{constructor(){super()}get eventId(){return 69}Jc(){this.zc(190)}}Object(e.a)(Kd,"RangeDuplicatesRemovedEvent",y,[]);class oc extends y{constructor(){super()}get eventId(){return 1}Jc(){this.zc(527);
this.zc(12)}}Object(e.a)(oc,"RangeEditedEvent",y,[]);class eb extends y{constructor(){super()}get eventId(){return 164}Jc(){this.zc(255)}Xg(){this.ie(Q=>4===Q.actionType)}}Object(e.a)(eb,"RangeExternalLinksBrokeAllLinksEvent",y,[]);class yb extends y{constructor(){super()}get eventId(){return 119}Jc(){this.zc(255)}Xg(){this.ie(Q=>3===Q.actionType)}}Object(e.a)(yb,"RangeExternalLinksBrokeLinkEvent",y,[]);class zc extends y{constructor(){super()}get eventId(){return 205}Jc(){this.zc(256)}sud(){this.twe("Microsoft.Office.Excel.WebExternalLinksChangeSourceMacroRecorder")}}
Object(e.a)(zc,"RangeExternalLinksChangeSourceEvent",y,[]);class dd extends y{constructor(){super()}get eventId(){return 163}Jc(){this.zc(553)}Xg(){this.ie(Q=>1===Q.actionType)}}Object(e.a)(dd,"RangeExternalLinksRefreshedAllEvent",y,[]);class od extends y{constructor(){super()}get eventId(){return 77}Jc(){this.zc(553)}Xg(){this.ie(Q=>0===Q.actionType)}}Object(e.a)(od,"RangeExternalLinksRefreshedEvent",y,[]);class Ed extends y{constructor(){super()}get eventId(){return 165}Jc(){this.zc(224)}}Object(e.a)(Ed,
"RangeExternalLinksSetAutoRefreshEvent",y,[]);class ce extends y{constructor(){super()}get eventId(){return 5}Jc(){this.zc(11)}Xg(){this.ie(Q=>64===Q.x0().ValidMembers)}}Object(e.a)(ce,"RangeFillColoredEvent",y,[]);class wc extends y{constructor(){super()}get eventId(){return 59}Jc(){this.zc(155)}}Object(e.a)(wc,"RangeFilledEvent",y,[]);class ed extends y{constructor(){super()}get eventId(){return 115}Jc(){this.zc(176)}Xg(){this.ie(Q=>Q.zW().AutoFilterType===sb.rwc&&!!Q.zW().CriteriaType)}}Object(e.a)(ed,
"RangeFilterAppliedEvent",y,[]);class md extends y{constructor(){super()}get eventId(){return 58}Jc(){this.zc(176)}Xg(){this.ie(Q=>Q.zW().AutoFilterType===sb.rwc&&!Q.zW().CriteriaType)}}Object(e.a)(md,"RangeFilterClearedEvent",y,[]);class Yd extends y{constructor(){super()}get eventId(){return 41}Jc(){this.zc(518)}}Object(e.a)(Yd,"RangeFilterReappliedEvent",y,[]);class $d extends y{constructor(){super()}get eventId(){return 86}Jc(){this.zc(150)}}Object(e.a)($d,"RangeFlashFilledEvent",y,[]);class bd extends Ga{constructor(){super(6,
32)}}Object(e.a)(bd,"RangeFontColoredEvent",Ga,[]);class Vd extends Ga{constructor(){super(7,8)}}Object(e.a)(Vd,"RangeFontItalicizedEvent",Ga,[]);class De extends Ga{constructor(){super(8,1)}}Object(e.a)(De,"RangeFontNamedEvent",Ga,[]);class Pe extends Ga{constructor(){super(9,2)}}Object(e.a)(Pe,"RangeFontSizedEvent",Ga,[]);class Zb extends y{constructor(){super()}get eventId(){return 74}Jc(){this.zc(215)}}Object(e.a)(Zb,"RangeFormattedAsTableEvent",y,[]);class Vc extends y{constructor(){super()}get eventId(){return 97}Jc(){this.zc(188)}}
Object(e.a)(Vc,"RangeGroupedOrUngroupedEvent",y,[]);class Nc extends y{constructor(){super()}get eventId(){return 60}Jc(){this.zc(11)}Xg(){this.ie(Q=>2===Q.x0().ValidMembers)}}Object(e.a)(Nc,"RangeHorizontallyAlignedEvent",y,[]);class ld extends y{constructor(){super()}get eventId(){return 43}Jc(){this.zc(526)}}Object(e.a)(ld,"RangeHyperlinkAppliedEvent",y,[]);class yd extends y{constructor(){super()}get eventId(){return 63}Jc(){this.zc(11)}Xg(){this.ie(Q=>256===Q.x0().ValidMembers)}}Object(e.a)(yd,
"RangeIndentChangedEvent",y,[]);class sd extends y{constructor(){super()}get eventId(){return 53}Jc(){this.zc(156)}Xg(){this.ie(Q=>2===Q.Ms()||5===Q.Ms()||6===Q.Ms()||7===Q.Ms())}}Object(e.a)(sd,"RangeMergedEvent",y,[]);class ic extends y{constructor(){super()}get eventId(){return 107}Jc(){this.zc(216)}}Object(e.a)(ic,"RangeNamedCellStyleAppliedEvent",y,[]);class Ic extends y{constructor(){super()}get eventId(){return 12}Jc(){this.zc(11)}Xg(){this.ie(Q=>32===Q.x0().ValidMembers)}}Object(e.a)(Ic,"RangeNumberFormattedEvent",
y,[]);var kd=a(1010);class Hd extends y{constructor(){super()}get eventId(){return 108}Jc(){this.zc(141)}Xg(){this.ie(Q=>Object(K.a)(kd.a,Q))}}Object(e.a)(Hd,"RangeSortedEvent",y,[]);class Ud extends Ga{constructor(){super(10,128)}}Object(e.a)(Ud,"RangeStrikedThroughEvent",Ga,[]);class de extends Ga{constructor(){super(11,16)}}Object(e.a)(de,"RangeUnderlinedEvent",Ga,[]);class qe extends y{constructor(){super()}get eventId(){return 61}Jc(){this.zc(11)}Xg(){this.ie(Q=>1===Q.x0().ValidMembers)}}Object(e.a)(qe,
"RangeVerticallyAlignedEvent",y,[]);class fe extends y{constructor(){super()}get eventId(){return 62}Jc(){this.zc(11)}Xg(){this.ie(Q=>8===Q.x0().ValidMembers)}}Object(e.a)(fe,"RangeWrapTextToggledEvent",y,[]);class Ke extends y{constructor(){super()}get eventId(){return 103}Jc(){this.zc(51)}}Object(e.a)(Ke,"RefreshedAllEvent",y,[]);class Te extends y{constructor(){super()}get eventId(){return 47}Jc(){this.zc(148)}}Object(e.a)(Te,"ReplaceAllEvent",y,[]);class Se extends y{constructor(){super()}get eventId(){return 226}Jc(){this.zc(1025)}}
Object(e.a)(Se,"SampleTableCreatedEvent",y,[]);class df extends y{constructor(){super()}get eventId(){return 91}Jc(){this.zc(532)}Xg(){this.ie(Q=>95!==Q.getShapeType()&&96!==Q.getShapeType()&&97!==Q.getShapeType()&&98!==Q.getShapeType()&&100!==Q.getShapeType()&&102!==Q.getShapeType()&&103!==Q.getShapeType())}}Object(e.a)(df,"ShapeInsertedEvent",y,[]);class te extends y{constructor(){super()}get eventId(){return 92}Jc(){this.zc(531)}}Object(e.a)(te,"ShapeStyleSetEvent",y,[]);var gf=a(856);class cf extends y{constructor(Q,
Wa){super();this.aia=Q;this.p8d=Wa}get eventId(){return this.aia}Jc(){this.zc(581)}Xg(){this.ie(Q=>Object(K.a)(gf.a,Q)&&4===Q.getShapeTextFormat().ValidMembers);this.ie(Q=>Object(K.a)(gf.a,Q)&&Q.getShapeTextFormat().Font.ValidMembers===this.p8d)}}Object(e.a)(cf,"ShapeTextFontFormattedEventBase",y,[]);class bf extends cf{constructor(){super(193,4)}}Object(e.a)(bf,"ShapeTextBoldedEvent",cf,[]);var $a=a(1012);class Y extends y{constructor(){super()}get eventId(){return 191}Jc(){this.zc(581)}Xg(){this.ie(Q=>
Object(K.a)($a.a,Q))}}Object(e.a)(Y,"ShapeTextChangedEvent",y,[]);class Ta extends cf{constructor(){super(196,32)}}Object(e.a)(Ta,"ShapeTextFontColorChangedEvent",cf,[]);class Bb extends cf{constructor(){super(197,1)}}Object(e.a)(Bb,"ShapeTextFontNameChangedEvent",cf,[]);class Rb extends cf{constructor(){super(198,2)}}Object(e.a)(Rb,"ShapeTextFontSizeChangedEvent",cf,[]);class jc extends y{constructor(){super()}get eventId(){return 199}Jc(){this.zc(581)}Xg(){this.ie(Q=>Object(K.a)(gf.a,Q)&&2===Q.getShapeTextFormat().ValidMembers)}}
Object(e.a)(jc,"ShapeTextHorizontallyAlignedEvent",y,[]);class vc extends cf{constructor(){super(194,8)}}Object(e.a)(vc,"ShapeTextItalicizedEvent",cf,[]);class bb extends cf{constructor(){super(195,16)}}Object(e.a)(bb,"ShapeTextUnderlinedEvent",cf,[]);class Mb extends y{constructor(){super()}get eventId(){return 200}Jc(){this.zc(581)}Xg(){this.ie(Q=>Object(K.a)(gf.a,Q)&&1===Q.getShapeTextFormat().ValidMembers)}}Object(e.a)(Mb,"ShapeTextVerticallyAlignedEvent",y,[]);class hc extends y{constructor(){super()}get eventId(){return 13}Jc(){this.zc(138)}}
Object(e.a)(hc,"SheetAddedEvent",y,[]);var Cc=a(9);class Wb extends y{constructor(){super()}get eventId(){return 142}Jc(){this.zc(237)}Xg(){this.ie(Q=>!!Q.insertDeleteMultiRangeParameters);this.ie(Q=>!Q.insertDeleteMultiRangeParameters.IsTableCommand);this.ie(Q=>{Q=Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0>Q.DeltaColumn&&!Q.DeltaRow&&(!!Q.InsertDeleteRange.FirstRow||Q.InsertDeleteRange.LastRow!==Cc.a.Hz)||!Q.DeltaColumn&&0>Q.DeltaRow&&(!!Q.InsertDeleteRange.FirstColumn||
Q.InsertDeleteRange.LastColumn!==Cc.a.ey)})}}Object(e.a)(Wb,"SheetCellsDeletedEvent",y,[]);class mc extends y{constructor(){super()}get eventId(){return 143}Jc(){this.zc(237)}Xg(){this.ie(Q=>!!Q.insertDeleteMultiRangeParameters);this.ie(Q=>!Q.insertDeleteMultiRangeParameters.IsTableCommand);this.ie(Q=>{Q=Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0<Q.DeltaColumn&&!Q.DeltaRow&&(!!Q.InsertDeleteRange.FirstRow||Q.InsertDeleteRange.LastRow!==Cc.a.Hz)||!Q.DeltaColumn&&0<Q.DeltaRow&&
(!!Q.InsertDeleteRange.FirstColumn||Q.InsertDeleteRange.LastColumn!==Cc.a.ey)})}}Object(e.a)(mc,"SheetCellsInsertedEvent",y,[]);class Mc extends y{constructor(){super()}get eventId(){return 139}Jc(){this.zc(237)}Xg(){this.ie(Q=>!!Q.insertDeleteMultiRangeParameters);this.ie(Q=>!Q.insertDeleteMultiRangeParameters.IsTableCommand);this.ie(Q=>0>Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.ie(Q=>!Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.ie(Q=>
!Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow);this.ie(Q=>Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===Cc.a.Hz)}}Object(e.a)(Mc,"SheetColumnDeletedEvent",y,[]);class hd extends y{constructor(){super()}get eventId(){return 138}Jc(){this.zc(237)}Xg(){this.ie(Q=>!!Q.insertDeleteMultiRangeParameters);this.ie(Q=>!Q.insertDeleteMultiRangeParameters.IsTableCommand);this.ie(Q=>0<Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);
this.ie(Q=>!Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.ie(Q=>!Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow);this.ie(Q=>Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===Cc.a.Hz)}}Object(e.a)(hd,"SheetColumnInsertedEvent",y,[]);class pd extends y{constructor(){super()}get eventId(){return 14}Jc(){this.zc(137)}}Object(e.a)(pd,"SheetDeletedEvent",y,[]);class Nd extends y{constructor(){super()}get eventId(){return 137}Jc(){this.zc(185)}}
Object(e.a)(Nd,"SheetDirectionChangedEvent",y,[]);class Xd extends y{constructor(){super()}get eventId(){return 54}Jc(){this.zc(139)}}Object(e.a)(Xd,"SheetDuplicatedEvent",y,[]);class ae extends y{constructor(){super()}get eventId(){return 15}Jc(){this.zc(207)}}Object(e.a)(ae,"SheetNameEditedEvent",y,[]);class Ve extends y{constructor(){super()}get eventId(){return 90}Jc(){this.zc(151)}}Object(e.a)(Ve,"SheetPaneFrozenEvent",y,[]);class we extends y{constructor(){super()}get eventId(){return 120}Jc(){this.zc(226)}}
Object(e.a)(we,"SheetPrintSettingsSavedEvent",y,[]);var Mf=a(904);class Ye extends y{constructor(){super()}get eventId(){return 215}Jc(){this.zc(507)}sud(){this.twe("Microsoft.Office.Excel.SheetProtectionMacroRecording")}Xg(){this.ie(Q=>Object.getType(Q)===Mf.a)}}Object(e.a)(Ye,"SheetProtectionPausedResumedEvent",y,[]);class kf extends y{constructor(){super()}get eventId(){return 64}Jc(){this.zc(557)}}Object(e.a)(kf,"SheetReorderedEvent",y,[]);class Bf extends y{constructor(){super()}get eventId(){return 141}Jc(){this.zc(237)}Xg(){this.ie(Q=>
!!Q.insertDeleteMultiRangeParameters);this.ie(Q=>!Q.insertDeleteMultiRangeParameters.IsTableCommand);this.ie(Q=>!Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.ie(Q=>0>Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.ie(Q=>!Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn);this.ie(Q=>Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===Cc.a.ey)}}Object(e.a)(Bf,
"SheetRowDeletedEvent",y,[]);class vf extends y{constructor(){super()}get eventId(){return 140}Jc(){this.zc(237)}Xg(){this.ie(Q=>!!Q.insertDeleteMultiRangeParameters);this.ie(Q=>!Q.insertDeleteMultiRangeParameters.IsTableCommand);this.ie(Q=>!Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.ie(Q=>0<Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.ie(Q=>!Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn);
this.ie(Q=>Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===Cc.a.ey)}}Object(e.a)(vf,"SheetRowInsertedEvent",y,[]);class Rf extends y{constructor(){super()}get eventId(){return 39}Jc(){this.zc(135)}}Object(e.a)(Rf,"SheetRowsColumnsAutoFitEvent",y,[]);class re extends y{constructor(){super()}get eventId(){return 36}Jc(){this.zc(136)}}Object(e.a)(re,"SheetRowsColumnsResizedEvent",y,[]);class Aa extends y{constructor(){super()}get eventId(){return 68}Jc(){this.zc(183)}}
Object(e.a)(Aa,"SheetShowGridlinesToggledEvent",y,[]);class Eb extends y{constructor(){super()}get eventId(){return 67}Jc(){this.zc(184)}}Object(e.a)(Eb,"SheetShowHeadingsToggledEvent",y,[]);class cc extends y{constructor(){super()}get eventId(){return 89}Jc(){this.zc(213)}}Object(e.a)(cc,"SheetSpellCheckedEvent",y,[]);class pc extends y{constructor(){super()}get eventId(){return 70}Jc(){this.zc(515)}}Object(e.a)(pc,"SheetTabColoredEvent",y,[]);class Hc extends y{constructor(){super()}get eventId(){return 71}Jc(){this.zc(157)}}
Object(e.a)(Hc,"SheetVisibilityChangedEvent",y,[]);class td extends y{constructor(){super()}get eventId(){return 126}Jc(){this.zc(239)}}Object(e.a)(td,"SheetsVisibilityChangedEvent",y,[]);class me extends y{constructor(){super()}get eventId(){return 188}Jc(){this.zc(203)}}Object(e.a)(me,"SlicerInsertedEvent",y,[]);class ve extends y{constructor(){super()}get eventId(){return 189}Jc(){this.zc(173)}Xg(){this.ie(Q=>!Q.clearFilter)}}Object(e.a)(ve,"SlicerSelectionAppliedEvent",y,[]);class Qe extends y{constructor(){super()}get eventId(){return 190}Jc(){this.zc(173)}Xg(){this.ie(Q=>
Q.clearFilter)}}Object(e.a)(Qe,"SlicerSelectionClearedEvent",y,[]);class Ze extends y{constructor(){super()}get eventId(){return 27}Jc(){this.zc(208)}Xg(){this.ie(Q=>Q.getParameters().FilterType===sb.Ndb)}}Object(e.a)(Ze,"TableCheckedItemsFilteredEvent",y,[]);class nf extends y{constructor(){super()}get eventId(){return 144}Jc(){this.zc(237)}Xg(){this.ie(Q=>!!Q.insertDeleteMultiRangeParameters);this.ie(Q=>Q.insertDeleteMultiRangeParameters.IsTableCommand);this.ie(Q=>0>Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);
this.ie(Q=>!Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(e.a)(nf,"TableColumnDeletedEvent",y,[]);class Cb extends y{constructor(){super()}get eventId(){return 145}Jc(){this.zc(237)}Xg(){this.ie(Q=>!!Q.insertDeleteMultiRangeParameters);this.ie(Q=>Q.insertDeleteMultiRangeParameters.IsTableCommand);this.ie(Q=>0<Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.ie(Q=>!Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}
Object(e.a)(Cb,"TableColumnInsertedEvent",y,[]);var ac=a(1011);class qc extends y{constructor(){super()}get eventId(){return 121}Jc(){this.zc(141)}Xg(){this.ie(Q=>Object(K.a)(ac.a,Q))}}Object(e.a)(qc,"TableColumnSortedEvent",y,[]);class Oc extends y{constructor(){super()}get eventId(){return 105}Jc(){this.zc(193)}}Object(e.a)(Oc,"TableConvertedToRangeEvent",y,[]);class xd extends y{constructor(){super()}get eventId(){return 16}Jc(){this.zc(206)}}Object(e.a)(xd,"TableCreatedEvent",y,[]);class Md extends y{constructor(){super()}get eventId(){return 30}Jc(){this.zc(209)}Xg(){this.ie(Q=>
Q.getParameters().FilterType===sb.Ndb)}}Object(e.a)(Md,"TableCustomFilteredEvent",y,[]);class je extends y{constructor(){super()}get eventId(){return 25}Jc(){this.zc(187)}Xg(){this.ie(Q=>1===Q.options.OperationType)}}Object(e.a)(je,"TableCustomSortedEvent",y,[]);class oe extends y{constructor(){super()}get eventId(){return 28}Jc(){this.zc(176)}Xg(){this.ie(Q=>Q.zW().AutoFilterType===sb.Ndb);this.ie(Q=>0===Q.zW().CriteriaType)}}Object(e.a)(oe,"TableFilterClearedEvent",y,[]);class Ge extends y{constructor(){super()}get eventId(){return 32}Jc(){this.zc(176)}Xg(){this.ie(Q=>
Q.zW().AutoFilterType===sb.Ndb);this.ie(Q=>{const Wa=new d.a;Wa.add(1);Wa.add(2);Wa.add(8);Wa.add(9);Wa.add(10);Wa.add(11);Wa.add(12);Wa.add(13);Wa.add(14);Wa.add(15);Wa.add(16);Wa.add(17);Wa.add(18);Wa.add(19);Wa.add(20);Wa.add(21);Wa.add(22);Wa.add(23);Wa.add(24);Wa.add(25);Wa.add(26);Wa.add(27);Wa.add(28);Wa.add(29);Wa.add(30);Wa.add(31);Wa.add(32);Wa.add(33);Wa.add(34);Wa.add(35);Wa.add(36);Wa.add(37);Wa.add(38);Wa.add(39);return Wa.contains(Q.zW().CriteriaType)})}}Object(e.a)(Ge,"TableItemFilteredEvent",
y,[]);class Ce extends y{constructor(){super()}get eventId(){return 101}Jc(){this.zc(217)}}Object(e.a)(Ce,"TableRenamedEvent",y,[]);class Ya extends y{constructor(){super()}get eventId(){return 73}Jc(){this.zc(211)}}Object(e.a)(Ya,"TableResizedEvent",y,[]);class Qb extends y{constructor(){super()}get eventId(){return 44}Jc(){this.zc(514)}}Object(e.a)(Qb,"TableRowColumnRearrangedEvent",y,[]);class Ec extends y{constructor(){super()}get eventId(){return 146}Jc(){this.zc(237)}Xg(){this.ie(Q=>!!Q.insertDeleteMultiRangeParameters);
this.ie(Q=>Q.insertDeleteMultiRangeParameters.IsTableCommand);this.ie(Q=>!Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.ie(Q=>0>Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(e.a)(Ec,"TableRowDeletedEvent",y,[]);class id extends y{constructor(){super()}get eventId(){return 147}Jc(){this.zc(237)}Xg(){this.ie(Q=>!!Q.insertDeleteMultiRangeParameters);this.ie(Q=>Q.insertDeleteMultiRangeParameters.IsTableCommand);this.ie(Q=>!Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);
this.ie(Q=>0<Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(e.a)(id,"TableRowInsertedEvent",y,[]);class Bd extends y{constructor(){super()}get eventId(){return 26}Jc(){this.zc(177)}Xg(){this.ie(Q=>Q.zW().AutoFilterType===sb.Ndb)}}Object(e.a)(Bd,"TableSortedEvent",y,[]);class Id extends y{constructor(){super()}get eventId(){return 87}Jc(){this.zc(212)}}Object(e.a)(Id,"TableStyleAppliedEvent",y,[]);class ee extends y{constructor(){super()}get eventId(){return 88}Jc(){this.zc(196)}}
Object(e.a)(ee,"TableStyleOptionToggledEvent",y,[]);class Fe extends y{constructor(){super()}get eventId(){return 31}Jc(){this.zc(210)}Xg(){this.ie(Q=>Q.getParameters().FilterType===sb.Ndb)}}Object(e.a)(Fe,"TableTop10FilteredEvent",y,[]);class La extends y{constructor(){super()}get eventId(){return 207}Jc(){this.zc(238)}}Object(e.a)(La,"TextToColumnsEvent",y,[]);class Kb extends y{constructor(){super()}get eventId(){return 128}Jc(){this.zc(559)}}Object(e.a)(Kb,"ValuesSortedEvent",y,[]);class uc extends y{constructor(){super()}get eventId(){return 55}Jc(){this.zc(197)}}
Object(e.a)(uc,"WorkbookCalculationModeSetEvent",y,[]);class Sc extends y{constructor(){super()}get eventId(){return 34}Jc(){this.zc(181)}Xg(){this.ie(Q=>!!Q.parentCommentId)}}Object(e.a)(Sc,"WorkbookCommentRepliedEvent",y,[]);class nd extends y{constructor(){super()}get eventId(){return 33}Jc(){this.zc(181)}Xg(){this.ie(Q=>!Q.parentCommentId)}}Object(e.a)(nd,"WorkbookCommentedEvent",y,[]);class Jd extends y{constructor(){super()}get eventId(){return 56}Jc(){this.zc(128)}}Object(e.a)(Jd,"WorkbookRecalculatedEvent",
y,[]);class ke extends y{constructor(){super()}get eventId(){return 46}Jc(){this.zc(171);this.zc(1034)}}Object(e.a)(ke,"WorkbookRedoEvent",y,[]);class ne extends y{constructor(){super()}get eventId(){return 45}Jc(){this.zc(170);this.zc(1033);this.zc(1035)}}Object(e.a)(ne,"WorkbookUndoEvent",y,[]);class Ue extends y{constructor(){super()}get eventId(){return 116}Jc(){this.zc(507);this.zc(576);this.zc(10)}Xg(){this.ie(Q=>{if(Object(K.a)(P,Q)&&(Q=Object(R.a)(P,Q),void 0!==Q.source&&null!==Q.source&&
void 0!==Q.eventId&&null!==Q.eventId))return k.ULS.sendTraceTag(537155426,0,50,`[RichApiRecorder]: received a valid but unhandled event: source: ${Q.source}; eventId: ${Q.eventId}.`),!0;k.ULS.sendTraceTag(537155425,0,50,"[RichApiRecorder]: an invalid event was ignored.");return!1})}}Object(e.a)(Ue,"DefaultRichApiRequestExecutedEvent",y,[]);class of extends y{constructor(){super()}get eventId(){return 216}Jc(){this.zc(1022)}}Object(e.a)(of,"TablelAltTextEditedEvent",y,[]);class He extends y{constructor(){super()}get eventId(){return 217}Jc(){this.zc(263)}}
Object(e.a)(He,"FloatingObjectZOrderChangedEvent",y,[]);var We=a(1013);class $e extends y{constructor(){super()}get eventId(){return 192}Jc(){this.zc(507)}Xg(){this.ie(Q=>Object(K.a)(We.a,Q)?!0:!1)}}Object(e.a)($e,"VisualPropertySetEvent",y,[]);class Uf extends M{constructor(){super(219,[510])}}Object(e.a)(Uf,"ChartSeriesDeletedEvent",M,[]);class Re extends y{get eventId(){return 220}Jc(){this.zc(1027)}}Object(e.a)(Re,"ChartDataChangedEvent",y,[]);class gb extends M{constructor(){super(221,[512])}}
Object(e.a)(gb,"ChartSeriesDataChangedEvent",M,[]);class Fb extends y{constructor(){super()}get eventId(){return 225}Jc(){this.zc(269)}}Object(e.a)(Fb,"FloatingObjectPutFloatingImageInCellEvent",y,[]);class $b extends y{constructor(){super()}get eventId(){return 224}Jc(){this.zc(268)}}Object(e.a)($b,"ImageInCellConvertToFloatingObjectEvent",y,[]);class xc{constructor(Q){this.ic=null;this.$=Q}get macroRecorderEvents(){this.ic||(this.ic=new d.a,this.ic.add(new oc),this.ic.add(new Sb),this.ic.add(new Za),
this.ic.add(new Yc),this.ic.add(new ce),this.ic.add(new bd),this.ic.add(new Vd),this.ic.add(new De),this.ic.add(new Pe),this.ic.add(new Ud),this.ic.add(new de),this.ic.add(new Ic),this.ic.add(new hc),this.ic.add(new pd),this.ic.add(new ae),this.ic.add(new xd),this.ic.add(new nf),this.ic.add(new Cb),this.ic.add(new Ec),this.ic.add(new id),this.ic.add(new hd),this.ic.add(new Mc),this.ic.add(new vf),this.ic.add(new Bf),this.ic.add(new je),this.ic.add(new Bd),this.ic.add(new Ze),this.ic.add(new oe),this.ic.add(new ub),
this.ic.add(new Md),this.ic.add(new Fe),this.ic.add(new Ge),this.ic.add(new nd),this.ic.add(new Sc),this.ic.add(new lb),this.ic.add(new re),this.ic.add(new Wb),this.ic.add(new mc),this.ic.add(new Rf),this.ic.add(new Ub),this.ic.add(new Yd),this.ic.add(new ld),this.ic.add(new Ab),this.ic.add(new Qb),this.ic.add(new ke),this.ic.add(new ne),this.ic.add(new Te),this.ic.add(new xa),this.ic.add(new ob),this.ic.add(new sd),this.ic.add(new Xd),this.ic.add(new uc),this.ic.add(new Jd),this.ic.add(new Xb),this.ic.add(new md),
this.ic.add(new wc),this.ic.add(new Nc),this.ic.add(new qe),this.ic.add(new fe),this.ic.add(new yd),this.ic.add(new kf),this.ic.add(new F),this.ic.add(new oa),this.ic.add(new Eb),this.ic.add(new Aa),this.ic.add(new Kd),this.ic.add(new Hc),this.ic.add(new pc),this.ic.add(new Ya),this.ic.add(new Zb),this.ic.add(new aa),this.ic.add(new I),this.ic.add(new od),this.ic.add(new L),this.ic.add(new ya),this.ic.add(new ia),this.ic.add(new B),this.ic.add(new ea),this.ic.add(new E),this.ic.add(new S),this.ic.add(new O),
this.ic.add(new Ea),this.ic.add(new $d),this.ic.add(new Id),this.ic.add(new ee),this.ic.add(new cc),this.ic.add(new Ve),this.ic.add(new df),this.ic.add(new te),this.ic.add(new hb),this.ic.add(new Ja),this.ic.add(new Fa),this.ic.add(new wa),this.ic.add(new Vc),this.ic.add(new Jb),this.ic.add(new ca),this.ic.add(new Ba),this.ic.add(new Ce),this.ic.add(new Ka),this.ic.add(new Ke),this.ic.add(new Ra),this.ic.add(new Oc),this.ic.add(new Cd),this.ic.add(new ic),this.ic.add(new Hd),this.ic.add(new kc),this.ic.add(new ja),
this.ic.add(new wb),this.ic.add(new Va),this.ic.add(new bc),this.ic.add(new Rd),this.ic.add(new ed),this.ic.add(new G),this.ic.add(new pb),this.ic.add(new yb),this.ic.add(new we),this.ic.add(new qc),this.ic.add(new vb),this.ic.add(new td),this.ic.add(new fb),this.ic.add(new Kb),this.ic.add(new la),this.ic.add(new D),this.ic.add(new za),this.ic.add(new Sa),this.ic.add(new nb),this.ic.add(new pa),this.ic.add(new Oa),this.ic.add(new Nd),this.ic.add(new Ma),this.ic.add(new na),this.ic.add(new cb),this.ic.add(new fa),
this.ic.add(new lc),this.ic.add(new U),this.ic.add(new ma),this.ic.add(new ra),this.ic.add(new gc),this.ic.add(new H),this.ic.add(new tb),this.ic.add(new Ia),this.ic.add(new dd),this.ic.add(new eb),this.ic.add(new Ed),this.ic.add(new Ua),this.ic.add(new X),this.ic.add(new ka),this.ic.add(new da),this.ic.add(new Vb),this.ic.add(new zb),this.ic.add(new Tb),this.ic.add(new Nb),this.ic.add(new Ha),this.ic.add(new Xa),this.ic.add(new qa),this.ic.add(new Qa),this.ic.add(new Db),this.ic.add(new sa),this.ic.add(new va),
this.ic.add(new kb),this.ic.add(new ib),this.ic.add(new Pa),this.ic.add(new qb),this.ic.add(new tc),this.ic.add(new Ca),this.ic.add(new mb),this.ic.add(new me),this.ic.add(new ve),this.ic.add(new Qe),this.ic.add(new Y),this.ic.add(new bf),this.ic.add(new vc),this.ic.add(new bb),this.ic.add(new Ta),this.ic.add(new Bb),this.ic.add(new Rb),this.ic.add(new jc),this.ic.add(new Mb),this.ic.add(new zc),this.ic.add(new Pb),this.ic.add(new La),this.ic.add(new Ye),this.ic.add(new of),this.ic.add(new He),this.ic.add(new $e),
this.ic.add(new Uf),this.ic.add(new gb),this.ic.add(new Re),this.ic.add(new $b),this.ic.add(new Fb),this.ic.add(new Se),z.EwaSettings.isChangeGateEnabled("OfficeVSO:4825267_RemoveDisabledEvents")&&this.vwj());return this.ic}Gbf(Q,Wa){let Ib=this.Hbf(Q,this.macroRecorderEvents,Wa);Ib||(Ib=this.Hbf(Q,xc.dji(),Wa),!Ib&&this.Asf(Q,xc.CSe,Wa)&&(Ib=xc.CSe));return Ib}Hbf(Q,Wa,Ib){const fc=new d.a;for(let sc of Wa)this.Asf(Q,sc,Ib)&&fc.add(sc);return 1===fc.count?fc.ma(0):1<fc.count?xc.I0h(fc):null}Asf(Q,
Wa,Ib){const fc=xc.Dfj(Q,Wa);return Ib?fc&&xc.Xjk(Q,Wa):fc}vwj(){const Q=new d.a;for(let Wa of this.ic){let Ib=!1;for(let fc of Wa.featureGates)if(!z.EwaSettings.ya(fc)){Q.add(Wa);Ib=!0;break}if(!Ib)for(let fc of Wa.l3e)if(!z.EwaSettings.getBooleanFeatureGate(fc,!1)){Q.add(Wa);break}}for(let Wa of Q)this.ic.remove(Wa)}static dji(){xc.NIb||(xc.NIb=new d.a,xc.NIb.add(new V),xc.NIb.add(new ta));return xc.NIb}static Dfj(Q,Wa){return Wa.operations.contains(Q.operation)}static Xjk(Q,Wa){Wa=Wa.MKc;if(!Wa.count)return!0;
let Ib=!0;for(let fc of Wa)if(!fc(Q.payload)){Ib=!1;break}return Ib}static I0h(Q){let Wa=Q.ma(0);for(let Ib of Q)Ib.MKc.count>Wa.MKc.count&&(Wa=Ib);return Wa}}xc.NIb=null;xc.CSe=new Ue;Object(e.a)(xc,"MacroRecorderEventList",null,[]);class Qc extends f.a{constructor(Q){super();this.$=Q;this.uc()}create(){this.$b(this.$.da.Ba(297)||new t(this.$,new xc(this.$),new l))}static la(Q){Q.da.Ja(298,new Qc(Q))}}Object(e.a)(Qc,"MacroRecorderEventHandlerFactory",f.a,[]);var Xc=a(2),Dd=a(570);class Ld{constructor(){this.uEg=
new d.a}get F7b(){return this.uEg}vai(Q){k.ULS.sendTraceTag(17306645,220,50,"Context menu id: {0}",Q);const Wa=new d.a;for(let Ib of this.F7b)for(let fc of Ib.gKb)fc.id===Q&&Wa.add(fc);return Wa}gwe(Q){this.F7b.add(Q)}owj(Q){for(let Wa of this.F7b)if(Wa.bAe===Q.bAe){this.F7b.remove(Wa);break}}static kyh(Q,Wa,Ib=null){Q=Ld.p3h(Q);0<Q.length&&(Ld.GDc(Q,!1),Ib&&Ib(Wa,Q))}static p3h(Q){const Wa=[];if(Q&&Q.gKb&&0<Q.gKb.count)for(let Ib of Q.gKb)if(Ib.controls&&0<Ib.controls.count)for(let fc of Ib.controls)if(fc.menuItems&&
0<fc.menuItems.count)for(let sc of fc.menuItems)Array.add(Wa,sc.id);return Wa}static GDc(Q,Wa){if(Q.length){var Ib=[];for(const fc of Q)Ib.push(appChrome.actions.updateControlEnabledDisabledState(fc,Wa));appChrome.api.dispatch(Ib)}}}Object(e.a)(Ld,"ContextMenuExtensibilityCache",null,[810,811]);var le=a(1548),ge=a(88),Zd=a(6),Cf=a(912),n=a(853);class Yb{u1a(Q,Wa=null){if(Q=n.a.hAb(Q)){appChrome.addInApi.dispatchActionsToInstallAddIn(Q,Wa);for(const Ib of Q.tabs)if(Ib.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(Q,
()=>{});break}}}fSd(Q){(Q=n.a.hAb(Q))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(Q)}heg(){}static syh(Q,Wa,Ib=null){Q=Yb.Fdi(Q);0<Q.length&&(Yb.GDc(Q,!1),Ib&&Ib(Wa,Q))}static Fdi(Q){const Wa=[];if(Q&&(Q=Q.NX,Q.yu&&0<Q.yu.count))for(let Ib of Q.yu)if(Ib.groups&&0<Ib.groups.length)for(const fc of Ib.groups)if(fc.controls&&0<fc.controls.length)for(const sc of fc.controls)Array.add(Wa,sc.id);return Wa}static GDc(Q){if(Q.length){var Wa=[];for(const Ib of Q)Wa.push(appChrome.actions.updateControlEnabledDisabledState(Ib,
!0));appChrome.api.dispatch(Wa)}}}Object(e.a)(Yb,"OneLineRibbonExtensibilityManager",null,[846]);var rc=a(988);class Gc{constructor(){this.qbe=this.kMc=null}get O0c(){return this.kMc||(this.kMc=OfficeExt.DefaultControlActionBinder.retrieveActionContext)}set O0c(Q){this.kMc=Q}get H4g(){return this.qbe||(this.qbe=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}getTaskPaneControlIdFromSolutionIdRuntimeId(Q,Wa){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromSolutionIdRuntimeId(Q,
Wa)}Sqd(Q,Wa,Ib,fc,sc,Tc=null,ad=null){k.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",Q);if((Q=Wa.Gla(sc.ownerAddinInfo.storeType,sc.ownerAddinInfo.solutionId))&&Q.PC&&!Q.PC.getIsUpgrading())if(Wa=null,0<Q.PC.getNotificationParams().length&&(Wa=this.RFe(Q.PC.getNotificationParams()[0]))&&2147758681===Wa.errorCode&&(Q.isUpgraded=!0),2!==Q.PC.getStatus()&&(1!==Q.PC.getStatus()||Wa&&2147758681===Wa.errorCode))Wa&&this.$hg(Q,Wa,ad);else try{Ib.setOwnerAddinEToken(Q.PC.getEToken()),sc.action(Ib,
fc.Dfa),Tc&&Tc()}catch(cd){k.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error info : {0}.",Zd.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?cd.stack:cd.message)),rc.a.d0d(CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)}}$hg(Q,Wa,Ib=null){const fc=Q.PC;if(1===fc.getNotificationParams().length||Wa.Kkc){const sc=Wa.cka,Tc=Wa.bla;Wa.cka=()=>{fc.removeFirstNotification();if(0<fc.getNotificationParams().length){const ad=
this.RFe(fc.getNotificationParams()[0]);this.$hg(Q,ad)}2147758681===Wa.errorCode&&(Yb.syh(Q.gp,fc,Object(ge.a)(this,this.Jmf,"initUpgradeStateDetectTask")),Ld.kyh(Q.ewb,fc,Object(ge.a)(this,this.Jmf,"initUpgradeStateDetectTask")));sc&&sc()};Wa.bla=()=>{Tc&&Tc();Ib&&Ib()};rc.a.e0d(Wa)}}Jmf(Q,Wa){let Ib=null;Ib=()=>{Q.getIsUpgrading()?window.setTimeout(Ib,1E3):Q.getUpgradingFailed()?Yb.GDc(Wa,!0):Zd.AFrameworkApplication.sa.updateCommandUI()};window.setTimeout(Ib,1E3)}RFe(Q){const Wa=new Cf.a;Wa.kPa=
Q.infoType;Wa.id=Q.id;Wa.title=Q.title;Wa.description=Q.description;Wa.buttonText=Q.buttonTxt;Wa.cka=Q.buttonCallback;Wa.Kkc=Q.highPriority;Wa.bla=Q.dismissCallback;Wa.errorCode=Q.errorCode;Wa.Olf=Q.iframeNotificationUrl;return Wa}}Object(e.a)(Gc,"AddinCommandsActionHandler",null,[818]);var fd=a(84),Fd=a(172),Sd=a(724),Wd=a(7),ue=a(769),Ie=a(725);class Xe{constructor(Q,Wa){this.Ya=Q;this.Qjh=Wa}LYh(Q){if(void 0!==Q&&null!==Q&&Q===Wd.a.xNe)Q="ContextMenuCell";else return null;const Wa=this.Ya.zd();
this.dYh(Wa,Q);return Wa}dYh(Q,Wa){Wa=this.Qjh.vai(Wa);for(let Ib of Wa){Wa=Ib.controls;for(let fc of Wa)this.QXh(Q,fc)}}QXh(Q,Wa){var Ib=Wa.HV[ue.a.id];const fc=Wa.HV[ue.a.lYa],sc=Wa.HV[ue.a.pYa];let Tc="Image16by16",ad=Wa.HV[ue.a.mYa];Ie.c(sc)&&(Tc="None");0<Wa.menuItems.count?(Ib=this.Ya.Jw(Ib,Ib,fc,798637440),Ib.cRb(Tc,sc,null),this.JYh(Ib.menu,Wa),Q.buttons.push(Ib)):Q.buttons.push(this.Ya.oLa(Ib,fc,ad,sc,Tc,null,!1))}JYh(Q,Wa){const Ib=this.Ya.zd();for(let fc of Wa.menuItems){Wa=fc.Aoa[ue.a.id];
const sc=fc.Aoa[ue.a.lYa],Tc=fc.Aoa[ue.a.pYa];let ad="Image16by16";const cd=fc.Aoa[ue.a.mYa];Ie.c(Tc)&&(ad="None");Wa=this.Ya.oLa(Wa,sc,cd,Tc,ad,null,!1);Ib.buttons.push(Wa)}Q.hd.push(Ib)}}Object(e.a)(Xe,"AddInCommandsContextMenuExtensibilityHandler",null,[762]);var wf=a(905);class mf{constructor(){this.Qi=null;this.visible=!1}}Object(e.a)(mf,"AddinStatusCommandValues",null,[]);class Zf{static foj(Q){const Wa=new mf;Wa.Qi=Q.M1a;Wa.visible=Wa.Qi?!0:!1;return Wa}static tFc(Q,Wa,Ib,fc,sc){const Tc=document.getElementById(Ib);
Tc?Zf.DYj(Q,Wa,Tc,fc,sc):k.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",Ib))}static DYj(Q,Wa,Ib,fc,sc){Ib?Q.M1a===CommonUIStrings.l_ErrorLoadingAddInsTitle?rc.a.rXj(Wa,Ib,fc,sc):Q.M1a===CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg&&rc.a.JYj(Wa,Ib):k.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))}}Object(e.a)(Zf,"AddinCommandsStatusHandler",null,[]);var Tf=a(42),Jg=a(234),Df=a(16),tf=a(30);class rg extends Tf.a{constructor(Q,
Wa){super();this.agaveCommandManager=this.statusBarManager=null;this.nKe=()=>{this.sH&&this.sH.QJe()};this.nhf=()=>{this.raiseEvent("LAC")};this.Md=(Ib,fc)=>{!Ib.Oc&&Jg.b(fc)&&this.statusBarManager&&(this.statusBarManager.pH(this),this.statusBarManager=null)};this.sH=Wa;this.$=Q;tf.a.Gp()||(this.vGc=Q.qc+"OfficeAddinLabel-Medium14");this.$.da.Qb(29,Ib=>{this.statusBarManager=Ib;Ib.TK(this)});this.$.ea.Mk(this.Md);this.sH.cWg(this.nhf);this.$.da.Qb(206,Ib=>{this.agaveCommandManager=Ib;Ib.DXg(this.nKe)})}Ar(Q){this.addHandler("LAC",
Q)}$r(Q){this.removeHandler("LAC",Q)}Gt(Q,Wa){if("QueryAddinLabel"!==Q)return!1;Wa[wf.a.LabelText]!==this.sH.M1a&&(Q=Zf.foj(this.sH),Wa[wf.a.LabelText]=Q.Qi,Wa[wf.a.Visible]=Q.visible,window.setTimeout(()=>{this.tFc()},0));return!0}Co(){return!0}tFc(){if(this.$){if(tf.a.Gp()&&isNullOrUndefined(this.vGc)){const Q=document.querySelector('button[data-unique-id="StatusBar-OfficeAddinLabel"]');Q&&(this.vGc=Q.getElementsByClassName("ms-Button-label")[0].id)}this.vGc&&Zf.tFc(this.sH,this.$.domElement,this.vGc,
Df.a.instance.ha(333),Df.a.instance.ha(334))}}dispose(){this.$.ea.Vk(this.Md);this.sH.Axj(this.nhf);this.agaveCommandManager&&(this.agaveCommandManager.Myj(this.nKe),this.agaveCommandManager=null);this.statusBarManager&&(this.statusBarManager.pH(this),this.statusBarManager=null);this.sH=this.$=null;super.dispose()}}Object(e.a)(rg,"AddinCommandsStatusBarManager",Tf.a,[204,205]);var cg=a(175),Na=a(114),Gb=a(745),ba=a(908),ha=a(1369),Hb=a(823),Bc=a(133),Rc=a(112),qd=a(583),Td=a(142);class pe{constructor(){this.L1a=
null}setErrorMessageForAddin(Q,Wa){this.L1a||(this.L1a={});this.L1a[Q]=Wa}F5h(Q){return this.L1a&&Q in this.L1a?this.L1a[Q]:null}}Object(e.a)(pe,"AddinCommandsErrorManager",null,[]);var Me=a(105);class xe{constructor(){this.Us=this.Bpa=0;this.p3c=null;this.hyc=this.pIc=0;this.Esa=this.ZQc=this.CMc=null}get d5b(){this.CMc||(this.CMc=new d.a);return this.CMc}get Akd(){this.ZQc||(this.ZQc=new d.a);return this.ZQc}get fLa(){this.Esa||(this.Esa=new d.a);return this.Esa}}Object(e.a)(xe,"AddinCommandsListLoaderContext",
null,[]);var xf=a(859);class Sf{constructor(Q,Wa){this.entitlement=Q;this.metadata=Wa}WTb(){var Q=this.entitlement;const Wa={};Wa.solutionId=Q.solutionId;Wa.version=Q.version;Wa.storeType=Q.storeType;Wa.storeId=Q.storeId;Wa.assetId=Q.assetId;Wa.assetStoreId=Q.assetStoreId;Wa.targetType=Q.targetType;Wa.requireConsent=Q.requireConsent||!1;Wa.isAddinCommands=!0;Wa.addinCommandsActionType=0;Wa.targetType=this.targetType;return Wa}get solutionId(){return this.entitlement.solutionId}get version(){return this.entitlement.version}get storeType(){return this.entitlement.storeType}get storeId(){return this.entitlement.storeId}get assetId(){return this.entitlement.assetId}get assetStoreId(){return this.entitlement.assetStoreId}get targetType(){return-1!==
this.entitlement.targetType?this.entitlement.targetType:this.metadata.targetType}get eToken(){return this.entitlement.eToken}get requireConsent(){return this.entitlement.requireConsent}get installTimeInMS(){return this.entitlement.installTimeInMS}}Object(e.a)(Sf,"AddinEntitlementEx",null,[]);var Kf=a(270),Hf=a(342);class Ng{}Object(e.a)(Ng,"AppsForOfficeEntitlementQueryInfo",null,[]);var yg=a(43),jg=a(32);class ch{constructor(){this.addinId=null;this.targetType=0;this.solutionId=null}}Object(e.a)(ch,
"AddinAbstract",null,[]);class zg extends Sys.EventArgs{constructor(){super();this.gp=this.El=null}}Object(e.a)(zg,"InsertionParamEventArgs",Sys.EventArgs,[]);class hh{constructor(Q,Wa,Ib,fc=null){this.IPb=Zd.AFrameworkApplication.fa.Va("RoamingServiceHandlerWebServiceBase");this.appName=Q;this.WGa=Wa;this.rnb=Ib;this.Dpb=fc}Phd(Q){this.q2e(Q,"getAddinTeachingCalloutSettings",Object(ge.a)(this,this.Gma,"getRequestSuccessCallback"),Object(ge.a)(this,this.HW,"getRequestFailureCallback"))}WPh(){const Q=
new d.a;Q.add(this.appName);this.q2e(Q,"getTeachingCalloutSettingsForAddinBetterEntryPoint",Object(ge.a)(this,this.sdi,"getRequestSuccessCallbackForBEP"),Object(ge.a)(this,this.HW,"getRequestFailureCallback"))}q2e(Q,Wa,Ib,fc){const sc=new Sys.StringBuilder(this.IPb);sc.append("RoamingServiceHandler.ashx?action=");sc.append(Wa);sc.append("&");sc.append(this.Ood(Q));sc.append("&");sc.append(Zd.AFrameworkApplication.oj);Zd.AFrameworkApplication.qe.Sn(sc.toString(),1,null,null,!0,2,Ib,fc,null)}tec(Q){this.v2e(Q,
"saveAddinTeachingCalloutSettings")}aQh(Q){this.v2e(Q,"saveTeachingCalloutSettingsForAddinBetterEntryPoint")}v2e(Q,Wa){const Ib=new Sys.StringBuilder(this.IPb);Ib.append("RoamingServiceHandler.ashx?action=");Ib.append(Wa);Ib.append("&");Ib.append(Zd.AFrameworkApplication.oj);Wa=Ib.toString();Q=yg.c(Q);Zd.AFrameworkApplication.qe.Sn(Wa,2,Q,null,!0,4,null,Object(ge.a)(this,this.u9,"postRequestFailureCallback"),null)}Gma(Q){let Wa=!1,Ib=null;try{if(0<Q.data.Pe.length){const fc=Object(R.a)(Object,yg.a(Q.data.Pe)),
sc=fc?fc[this.appName]:null;sc&&(Ib=Object(R.a)(Object,yg.a(sc.toString())))}Wa=!0}catch(fc){this.HW(null)}Wa&&this.WGa&&this.WGa(Ib)}sdi(Q){let Wa=!1,Ib=null;try{if(0<Q.data.Pe.length){const fc=Object(R.a)(Object,yg.a(Q.data.Pe));Ib=Object(R.a)(String,fc[this.appName])||null}Wa=!0}catch(fc){this.HW(null)}Wa&&this.WGa&&(Q={},Q.Platforms=Ib,this.WGa(Q))}HW(Q){this.rnb&&this.rnb(Q?Q.data:null)}u9(Q){this.Dpb&&this.Dpb(Q?Q.data:null)}Ood(Q){const Wa=new Sys.StringBuilder("requestedsettings=");for(let Ib=
0;Ib<Q.count;Ib++)Wa.append(Q.ma(Ib)),Ib<Q.count-1&&Wa.append(";");return Wa.toString()}}Object(e.a)(hh,"AddinTeachingUIRoamingRequestHandler",null,[]);class Sg extends Sys.EventArgs{constructor(Q){super();this.solutionId=Q.solutionId;this.assetId=Q.assetId;this.storeType=Q.storeType;this.storeId=Q.storeId;this.assetStoreId=Q.assetStoreId;this.targetType=Q.targetType;this.width=Q.width;this.height=Q.height;this.displayName=Q.displayName;this.version=Q.version}}Object(e.a)(Sg,"ShowTeachingCalloutForContentAddinEventArgs",
Sys.EventArgs,[]);var Pf=a(355);class tg{constructor(Q){this.P1a=this.El=null;this.NUa=!1;this.Esa=this.xWb=this.Wfa=this.Xf=this.GMc=this.Ngb=null;this.Ta=Q}get appName(){return Zd.AFrameworkApplication.fa.Va("WebAppShortName")}get Esb(){this.GMc||(this.GMc=new hh(this.appName,Object(ge.a)(this,this.Gma,"getRequestSuccessCallback"),Object(ge.a)(this,this.HW,"getRequestFailureCallback"),Object(ge.a)(this,this.u9,"postRequestFailureCallback")));return this.GMc}get Zua(){this.xWb||(this.xWb=new d.a);
return this.xWb}set Zua(Q){this.xWb=Q}get fLa(){this.Esa||(this.Esa=new d.a);return this.Esa}set fLa(Q){this.Esa=Q}lTg(Q,Wa){window.addEventListener?(this.El=Q,this.P1a=Wa,window.addEventListener("LaunchAddinTaskpane",Object(ge.a)(this,this.b9i,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(ge.a)(this,this.lJd,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(ge.a)(this,this.$Id,"onCloseButtonClickedEventHandler"),!0),
window.addEventListener("FGWebSurfaceEvent",Object(ge.a)(this,this.mJf,"onCampaignLaunchedHandler"),!0)):k.ULS.sendTraceTag(525112601,220,15,"AddEventListenerForTeachingCallout failed to get Window")}F5d(Q,Wa,Ib,fc){this.Xf=Q;this.Zua=Wa;this.fLa=Ib;this.Wfa=fc;k.ULS.sendTraceTag(0,220,50,"Calls into TriggerTeachingCallout with addin entitlements: command addins: {0}, content addins: {1}",Wa?Wa.count.toString():"null",Ib?Ib.count.toString():"null");0<this.Zua.count||0<this.fLa.count?(Q=new d.a,Q.add(this.appName),
this.Esb.Phd(Q)):this.Wfa(new d.a,null)}b9i(){const Q=new Kf.ScriptSharpLegacyMap;this.P1a&&this.P1a.tabs&&!this.P1a.tabs[0].isOfficeTab&&Q.ia("SDX.FeatureFlags","NonOfficeTab");this.Ebb(tg.g8a(this.El),"ClickOnLaunch",Q);this.msc();this.P1a?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.P1a,()=>{const Wa=new zg;Wa.El=this.El;this.Ta.raiseEvent(Gb.a.myf,Wa)}):k.ULS.sendTraceTag(525112602,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")}$Id(){this.Ebb(tg.g8a(this.El),
"ClickOnClose");this.msc()}lJd(){this.Ebb(tg.g8a(this.El),"ClickOnDismiss");this.msc()}mJf(Q){if(Q&&(Q=Q.detail)&&Q.id&&this.Jzi(Q.id)){const Wa=(Q.action||"").toLowerCase();if(Q.success&&"opened"===Wa)this.Ebb(tg.g8a(this.El),"CampaignLaunched"),k.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming."),this.msc(),window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",Object(ge.a)(this,this.mJf,"onCampaignLaunchedHandler"),!0);else{let Ib;
try{Ib=JSON.stringify(Q),k.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+Ib)}catch(fc){Ib="id : "+Q.id+" telemetryEventName: "+Q.telemetryEventName,k.ULS.sendTraceTag(523321996,220,50,"Error serializing campaign event. "+Ib+" Error: "+(fc?fc.toString():""))}}}}Jzi(Q){Q=jg.a.Hl(Q);return-1!==Q.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==Q.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==Q.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==Q.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||
-1!==Q.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==Q.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}aCc(Q){if(this.appName){const Wa={},Ib={};Ib.LastTeachingUIShowTime=(new Date).toUTCString();Ib.AddinHasShown=Q;Wa[this.appName]=yg.c(Ib);this.Esb.tec(Wa);k.ULS.sendTraceTag(539530527,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else k.ULS.sendTraceTag(539530528,220,10,"Fail to save roaming service since AppName is null")}msc(){if(!this.NUa){const Q=
window.g_roamingAddinList;Q&&(this.aCc(Q),this.NUa=!0)}}Gma(Q){Q?this.Q_d(Q)?(k.ULS.sendTraceTag(527523845,220,50,"should show teaching UI"),this.Ngb="AddinHasShown"in Q&&Q.AddinHasShown?Q.AddinHasShown.toString():null,this.LMe()):(k.ULS.sendTraceTag(538248466,220,50,"Not Show TeachingUI this time"),this.Wfa(this.Zua,null)):(k.ULS.sendTraceTag(527523844,220,50,"userSettings is null"),this.Ngb=null,this.LMe())}HW(Q){k.ULS.sendTraceTag(539530529,220,10,"GET data from Roaming Settings Service with status: {0}, fallback",
Q?Q.httpStatus:-1);this.Wfa(this.Zua,null)}u9(Q){k.ULS.sendTraceTag(539530530,220,10,"failed to POST data to Roaming Settings Service with status: {0}",Q?Q.httpStatus:-1)}LMe(){const Q=this.fxh();0===Q.targetType?(Q.solutionId?this.boj(Q):this.Ebb(null,"NoSolutionId"),this.zug(Q),this.Wfa(this.Zua,null)):this.Wfa(this.Zua,Q);k.ULS.sendTraceTag(528023563,220,50,"Show teaching callout for: {0}",Q.addinId)}boj(Q){const Wa=new Ng;Wa.callbackFunc=Ib=>{if(Ib.errorCode){this.Ebb(Q.solutionId,"FailToGetAppDetails");
var fc=window.g_roamingAddinList;fc&&this.aCc(fc)}else if(Ib.value)for(fc of Ib.value)if(Ib=fc[1],Ib===Q.solutionId){const sc={};sc.solutionId=Ib;sc.assetId=fc[5];sc.storeType=fc[12];sc.storeId=fc[11];sc.assetStoreId=fc[6];sc.targetType=fc[3];sc.width=fc[7];sc.height=fc[8];sc.displayName=fc[0];sc.version=fc[4];k.ULS.sendTraceTag(0,220,50,"Raise a teaching callout event for content addin: {0}.",Q.solutionId);fc=new Sg(sc);this.Ta.raiseEvent(Gb.a.gig,fc);break}};Wa.storeType=OSF.StoreTypeEnum.PrivateCatalog;
Wa.fromInsertDialog=!1;Wa.refresh=!1;this.Xf.queryEntitlementDetails(Wa)}Q_d(Q){if("LastTeachingUIShowTime"in Q){if(Q=+new Date-+new Date(Q.LastTeachingUIShowTime.toString()),Q<Zd.AFrameworkApplication.fa.GW("AddinShowTeachingUIIntervalInMS",864E5))return k.ULS.sendTraceTag(538248467,220,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",Q),!1}else k.ULS.sendTraceTag(527523846,220,50,"userSetting has no date key");return!0}fxh(){let Q=new Hf.a(new ch,0),Wa=new Hf.a(new ch,0),Ib=
0,fc=0,sc=0;var Tc=new d.a;for(var ad of this.Zua)Tc.add(ad);for(let cd of this.fLa)Tc.add(cd);for(let cd of Tc)if(!("excatalog"!==cd.storeType||Ie.c(cd.installTimeInMS)||!cd.installTimeInMS||cd.installTimeInMS<=Zd.AFrameworkApplication.fa.GW("DateTimeInMSForNewAddin",16409952E5))){Tc=tg.L7e(cd);if(this.Ngb&&(ad=this.Ngb.split(","),0<ad.length&&Array.contains(ad,Tc))){sc++;k.ULS.sendTraceTag(528345032,220,50,"This addin has shown teaching UI before");continue}Tc.startsWith("private_")?(Q=tg.rbf(cd,
Q),fc++):(Wa=tg.rbf(cd,Wa),Ib++)}k.ULS.sendTraceTag(528345033,220,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",fc,Ib,sc);return 0<Wa.value?Wa.key:0<Q.value?Q.key:Object.assign(new ch,{addinId:null,targetType:-1,solutionId:null})}Ebb(Q,Wa,Ib=null){Q={["AppTeachingUICalloutAction"]:Wa,["SDX.Id"]:Q,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};if(Ib)for(let fc of Ib.keys)Q[fc]=Ib.ma(fc);cg.a.sendTelemetryEvent(Object.assign(new Pf.a,
{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Na.a.Wj(Q)}))}zug(Q){Q&&(window.g_roamingAddinList=this.Ngb?this.Ngb+","+Q.addinId:Q.addinId)}static g8a(Q){return Telemetry.PrivacyRules.GetPrivacyCompliantId(Q.solutionId,Q.storeType,Q.assetId,null,null,Q.storeId)}static rbf(Q,Wa){return Wa.value<Q.installTimeInMS?new Hf.a(Object.assign(new ch,{addinId:tg.L7e(Q),targetType:Q.targetType,solutionId:Q.solutionId}),Q.installTimeInMS):Wa}static L7e(Q){return Telemetry.PrivacyRules.IsPrivateAddin(Q.storeType,
Q.assetId,null,null,Q.storeId)?"private_"+Q.installTimeInMS:Q.solutionId}}Object(e.a)(tg,"PrivateCatalogTeachingCalloutHandler",null,[]);var Eh=a(64);const mh=()=>{const Q=Eh.a.H0(window.location.href.toLowerCase(),"wdomexsrctype");return!!Q&&"4"===Q},Zg=()=>Eh.a.H0(window.location.href.toLowerCase(),"wdtpl"),uh=()=>{const Q=Eh.a.H0(window.location.href.toLowerCase(),"wdomexsrctype");return!!Q&&"1"===Q};var nh=a(858);class oh extends Sys.EventArgs{constructor(Q){super();this.properties=Q}}Object(e.a)(oh,
"AddinCommandsEntitlementsRetrievedEventArgs",Sys.EventArgs,[]);class ph{constructor(Q,Wa,Ib){this.Ta=new Me.a;this.context=new xe;this.k_c=null;this.contextActivationMgr=Q;this.XZg=Wa;this.c5b=Ib;this.appName=Zd.AFrameworkApplication.fa.Va("WebAppShortName")}get ETb(){this.k_c||(this.k_c=new tg(this.Ta));return this.k_c}aWg(Q){this.Ta.addHandler(Gb.a.vze,Q)}vZg(Q){this.Ta.addHandler(Gb.a.gig,Q)}Rak(Q){null!==Q&&(this.context.Bpa=Q[Gb.a.g5],this.context.Us=Q[Gb.a.f_],this.context.pIc=this.context.hyc=
0,Q=Gb.a.qJa in Q?Q[Gb.a.qJa]:0,-1!==this.context.Bpa&&0!==this.context.Us&&(this.context.p3c=this.XZg.createAddinDataProvider(nh.a(this.context.Bpa),this.contextActivationMgr),this.context.p3c?this.context.p3c.getEntitlementsAsync(this.contextActivationMgr.Dfa,!0,Q,Wa=>{this.n9i(Wa)}):k.ULS.sendTraceTag(17638145,220,10,"Create AddinDataProvider fails for {0}",this.context.Bpa)))}n9i(Q){if(Q&&0<Q.length){this.context.pIc=Q.length;const Ib=Zd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")?
Zg():null;for(let fc=0;fc<Q.length;fc++){const sc=Q[fc];if(Zd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")&&uh()&&sc&&sc.storeType&&"omex"===sc.storeType.toLowerCase()&&sc.assetId&&Ib&&sc.assetId.toLowerCase()===Ib.toLowerCase()){var Wa={["SDX_AppInstallOrigin"]:"DeeplinkUser",["SDX_Id"]:ph.g8a(sc)};cg.a.sendTelemetryEvent(Object.assign(new Pf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Na.a.Wj(Wa)}))}!sc||1!==sc.targetType&&-1!==sc.targetType?
this.wId():(Wa={},Zd.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.VSO6786086_RetireAddinCommandsCheckingContextProperties")?(Wa.solutionId=sc.solutionId,Wa.version=sc.version):(Wa.marketplaceId=sc.solutionId,Wa.marketplaceVersion=sc.version),Wa.storeType=sc.storeType,Wa.storeId=sc.storeId,Wa.targetData=sc,this.contextActivationMgr.isAddinCommandsExAsync(Wa,Object(ge.a)(this,this.H8i,"onIsAddinCommandsExCompleted")))}}else this.wId()}wId(){var Q;(Q=this.context).hyc=
Q.hyc+1;this.context.hyc>=this.context.pIc&&(this.c5b.lcg(this.context.Bpa,!1),0<this.context.pIc&&10===this.context.Bpa&&("Excel"===this.appName||"PowerPoint"===this.appName||"Word"===this.appName)?(Q=!1,mh()&&(Q=this.fQi(this.context.Akd)),this.tPi(this.context.Akd),Zd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&!Q?this.ETb.F5d(this.contextActivationMgr,this.context.d5b,this.context.fLa,(Wa,Ib)=>{const fc=new d.a;for(let sc of Wa)Wa=
sc.WTb(),Ib&&Ib.solutionId===sc.solutionId&&(Wa.showCallout=!0,this.ETb.zug(Ib)),fc.add(Wa);this.Wfa(fc)}):this.Wfa(this.KMe(this.context.d5b))):this.Wfa(this.KMe(this.context.d5b)))}KMe(Q){const Wa=new d.a;if(Q)for(let Ib of Q)Wa.add(Ib.WTb());return Wa}Wfa(Q){Q&&Q.count||xf.a.MIc(Gb.a.o3c,"false",this.context.Bpa);Q={["ack2"]:Q};Q[Gb.a.g5]=this.context.Bpa;Q[Gb.a.f_]=this.context.Us;this.Ta.raiseEvent(Gb.a.vze,new oh(Q),this)}fQi(Q){let Wa=!1;if(Q&&1>Q.count)return Wa;const Ib=Zg();if(!Ib)return Wa;
for(let fc of Q)if(fc.storeId&&fc.storeId.toLowerCase()===Ib.toLowerCase()||fc.assetId&&fc.assetId.toLowerCase()===Ib.toLowerCase())Q={["SDX_Id"]:ph.odf(fc),["SDX_TargetType"]:Ie.c(fc.targetType)?"":fc.targetType.toString()},cg.a.sendTelemetryEvent(Object.assign(new Pf.a,{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:Na.a.Wj(Q)})),Wa=!0;return Wa}tPi(Q){if(!(Q&&1>Q.count))if(this.c5b.uEi()){var Wa=this.c5b.Qbi();Wa?(Q=this.Q9e(Q,Wa),k.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):
(Q=this.Q9e(Q,null),k.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.c5b.PPj(Q)}else k.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}Q9e(Q,Wa){const Ib={};let fc=!1;for(let sc of Q)if(Q=ph.odf(sc))!Wa||Q in Wa||(this.RA(sc,Q),k.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===Q.toLowerCase()?fc||(fc=!0,Ib[Q]=null):Ib[Q]=null;return Ib}RA(Q,Wa){var Ib=Q.installTimeInMS?(new Date(Q.installTimeInMS)).toISOString():"";Ib={["SDX.Id"]:Wa,
["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:Ie.c(Q.targetType)?"":Q.targetType.toString(),["SDX.AdminDeploymentTime"]:Ib};cg.a.sendTelemetryEvent(Object.assign(new Pf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Na.a.Wj(Ib)}));1===Q.targetType&&(Q={["SDX.Id"]:Wa,["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},cg.a.sendTelemetryEvent(Object.assign(new Pf.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:Na.a.Wj(Q)})))}H8i(Q,Wa,Ib,fc){Q?
(Q=new Sf(Ib.targetData,fc),Wa&&this.context.d5b.add(Q),10===this.context.Bpa&&(this.context.Akd.add(Q),0===Q.targetType&&this.context.fLa.add(Q))):(Wa=Ib.targetData,k.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Wa.solutionId,Wa.storeType,Wa.assetId,null,null,Wa.storeId),Wa.storeType));this.wId()}static g8a(Q){return Telemetry.PrivacyRules.GetPrivacyCompliantId(Q.solutionId,Q.storeType,Q.assetId,null,null,Q.storeId)}static odf(Q){return Telemetry.PrivacyRules.GetPrivacyCompliantId(Q.solutionId,
Q.storeType,Q.assetId,null,null,Q.storeId)}}Object(e.a)(ph,"AddInCommandsListLoader",null,[]);class Ug{constructor(Q){this.PLg=Q}get Dfa(){return this.PLg}insertOsfControl(Q){return this.Dfa.insertOsfControl(Q)}getManifestInvaildErrorString(){return this.Dfa.getManifestInvaildErrorString()}isAddinCommandsAsync(Q,Wa){this.Dfa.isAddinCommandsAsync(Q,Wa)}isAddinCommandsExAsync(Q,Wa){this.Dfa.isAddinCommandsExAsync(Q,Wa)}ownerAddinControlRecreated(Q,Wa){this.Dfa.ownerAddinControlRecreated(Q,Wa)}queryEntitlementDetails(Q){this.Dfa.queryEntitlementDetails(Q)}}
Object(e.a)(Ug,"ContextActivationMgrWrapper",null,[806]);class $g{createAddinDataProvider(Q,Wa){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(Q,Wa.Dfa)}static get instance(){$g.Oa||($g.Oa=new $g);return $g.Oa}}$g.Oa=null;Object(e.a)($g,"OSFAddinDataProviderFactory",null,[808]);class Ih{constructor(){this.Ver=1}}Object(e.a)(Ih,"CacheItem",null,[]);class dh{constructor(Q){this.tHa=Q}Am(Q){const Wa=this.tHa.getItem(Q);if(Wa){let Ib=new Ih;try{Ib=Sys.Serialization.JavaScriptSerializer.deserialize(Wa,
!0)}catch(fc){return this.tHa.removeItem(Q),null}return Ib.Data?Ib.Data:Ib.data}return null}hUa(Q){this.tHa.removeItem(Q)}}Object(e.a)(dh,"AppsDataCacheManager",null,[845]);class eh{constructor(){new dh(Hb.a.instance)}lcg(Q,Wa){Q=Gb.a.V$e()+Q;Hb.a.instance.setItem(Q,Wa.toString())}Qbi(){var Q=Gb.a.qdf();k.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",Q);Q=Hb.a.instance.getItem(Q);return yg.a(Q)}PPj(Q){const Wa=Gb.a.qdf();k.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",Wa);Hb.a.instance.setItem(Wa,
yg.c(Q))}uEi(){return!!Hb.a.instance.localStorage}static get instance(){eh.Oa||(eh.Oa=new eh);return eh.Oa}}eh.Oa=null;Object(e.a)(eh,"AddInCommandsCacheManager",null,[809]);class Ff{constructor(Q){this.DHc=null;this.NUa=!1;this.Ta=new Me.a;this.JPb=this.psa=null;this.contextActivationMgr=Q;window.addEventListener&&(window.addEventListener("LaunchBEPCallout",Object(ge.a)(this,this.baj,"onPrimaryButtonClickedEventHandler"),!0),window.addEventListener("DismissBEPCallout",Object(ge.a)(this,this.lJd,
"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseBEPCallout",Object(ge.a)(this,this.$Id,"onCloseButtonClickedEventHandler"),!0))}get appName(){Ie.b(this.psa)&&(this.psa=Zd.AFrameworkApplication.fa.Va("WebAppShortName"));return this.psa}VXg(Q){this.Ta.addHandler(Gb.a.ryf,Q)}F5d(){this.contextActivationMgr.queryStoreDisabled("omex",Q=>{Q?k.ULS.sendTraceTag(509686157,344,50,"Store is disabled for current user"):this.v$j()})}v$j(){this.DHc=new hh(this.appName,Object(ge.a)(this,
this.Gma,"getRequestSuccessCallback"),Object(ge.a)(this,this.HW,"getRequestFailureCallback"),Object(ge.a)(this,this.u9,"postRequestFailureCallback"));this.DHc.WPh()}Gma(Q){this.Q_d(Q)&&(k.ULS.sendTraceTag(509690977,344,50,"should show teaching UI"),this.X0d())}HW(Q){k.ULS.sendTraceTag(509690976,344,10,"Failed to GET data from Roaming Settings with status: {0}",Q?Q.httpStatus:-1)}u9(Q){k.ULS.sendTraceTag(509690975,344,10,"Failed to POST data to Roaming Settings with status: {0}",Q?Q.httpStatus:-1)}Q_d(Q){if(!Q)k.ULS.sendTraceTag(509690974,
344,50,"userSettings is null");else if("Platforms"in Q&&(this.JPb=Object(R.a)(String,Q.Platforms),!Ie.b(this.JPb)&&(Q=this.JPb.split(","),0<Q.length&&Array.contains(Q,"Web"))))return k.ULS.sendTraceTag(509690973,344,50,"callout has shown for this platform"),!1;return!0}X0d(){const Q=fd.a.instance.Dc("Common.ISystemInitiatedFeedback");if(Q){var Wa=this.o_h();Ie.b(Wa)?k.ULS.sendTraceTag(509686979,344,50,"activity name is empty"):Q.execute(Ib=>{Ib.logActivity(Wa,null)})}else k.ULS.sendTraceTag(509690972,
344,50,"Error resolving ISystemInitiatedFeedback Future")}baj(){this.RA("ClickOnLaunch");this.TVd();this.Ta.raiseEvent(Gb.a.ryf)}$Id(){this.RA("ClickOnClose");this.TVd()}lJd(){this.RA("ClickOnDismiss");this.TVd()}o_h(){let Q;switch(this.appName){case "Word":Q="WordShowCalloutForBEPHomeTab";break;case "Excel":Q="ExcelShowCalloutForBEPHomeTab";break;case "PowerPoint":Q="PPTShowCalloutForBEPHomeTab";break;default:Q=""}return Q}RA(Q){Q={["AppTeachingUICalloutAction"]:Q,["AppTeachingUICalloutGoal"]:"BetterEntryPoint"};
cg.a.sendTelemetryEvent(Object.assign(new Pf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Na.a.Wj(Q)}))}TVd(){if(!this.NUa)if(Ie.b(this.appName))k.ULS.sendTraceTag(509690970,344,10,"Fail saving to roaming service since AppName is null");else{const Q={};Q[this.appName]=this.JPb?this.JPb+",Web":"Web";this.DHc&&(this.DHc.aQh(Q),k.ULS.sendTraceTag(509690971,344,50,"Initiating call to save Roaming Settings for current user"));this.NUa=!0}}}Object(e.a)(Ff,"BetterEntryTeachingCalloutLauncher",
null,[]);class A{constructor(Q,Wa,Ib,fc,sc,Tc){this.Us=Q;this.El=Wa;this.B2=Ib;this.displayName=sc;this.nxf=Tc}}Object(e.a)(A,"PostLaunchAddinCommandsParameters",null,[]);class W{constructor(Q){this.mUc=null;this.Phe=Q}get VQa(){return this.mUc}u1a(Q,Wa=null){this.Phe.u1a(Q,Wa);this.mUc=Q}fSd(Q){this.Phe.fSd(Q)}heg(Q){this.mUc=Q}}Object(e.a)(W,"RibbonExtensibilityManagerWithChangeDetection",null,[846]);var jb=a(911),xb=a(106);class nc{static Oaf(Q){const Wa=new d.a;if(nc.xMe)for(var Ib of nc.xMe)Wa.add(Ib);
Ib=null;switch(Q){case "Workbook":Ib=nc.Rlk;break;case "Document":Ib=nc.fAh;break;case "Presentation":Ib=nc.Ulj}if(Ib)for(const fc of Ib)Wa.add(fc);return Wa}}nc.xMe=["PrimaryCommandSurface","ContextMenu"];nc.Rlk=null;nc.fAh=null;nc.Ulj=null;Object(e.a)(nc,"ExtensionPointType",null,[]);class Uc{constructor(Q){this.cne=null;if(Ie.c(Q))throw k.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),Error.create("The agave key should not be null or undefined");this.$Cg=Q}get gKb(){return this.cne||
(this.cne=new d.a)}get bAe(){return this.$Cg}}Object(e.a)(Uc,"ContextMenuExtensibility",null,[817]);class rd{constructor(Q,Wa=null,Ib=0){if(Ie.c(Q))throw k.ULS.sendTraceTag(9041814,220,10,"OneLineRibbonExtensibilityObject should not be null or undefined."),Error.create("OneLineRibbonExtensibilityObject should not be null or undefined.");this.ILg=Q;this.UOg=Wa;this.DHg=Ib}get NX(){return this.ILg}get startedNode(){return this.UOg}get NZh(){return this.DHg}}Object(e.a)(rd,"RibbonExtensibility",null,
[879]);class Od{constructor(Q){this.EGg=Q.entitlement}get entitlement(){return this.EGg}createActionContext(Q,Wa){Q={};Q.ownerAddinInfo=this.entitlement;Q.action=Wa;return Q}}Object(e.a)(Od,"AddInCommandsContextProvider",null,[]);class ie{constructor(Q,Wa,Ib){this.Eae=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=this.commandSurface=null;this.ribbonBuilder=Q;this.eventBuilder=Wa;this.contextMenuBuilder=Ib}get addinInfo(){return this.Eae}unh(Q){return new Od(Q)}createActionBuilder(Q,
Wa){return OfficeExt.DefaultControlActionBinder.createActionBuilder(Q,Wa.entitlement,Wa.manifest)}startApplyAddin(Q){this.Eae=Q;const Wa=this.unh(Q);this.actionBuilder=this.createActionBuilder(Wa,Q)}endApplyAddin(){}bld(Q,Wa,Ib=0){return this.ribbonBuilder.yu&&0<this.ribbonBuilder.yu.count?new rd(this.YYh(Q,Wa),this.addinInfo.startedNode,Ib):null}Y6e(){var Q=null;if(this.contextMenuBuilder.Fsc&&0<this.contextMenuBuilder.Fsc.count){Q||(Q=this.addinInfo.entitlement.solutionId);Q=new Uc(Q);for(let Wa of this.contextMenuBuilder.Fsc)Q.gKb.add(Wa);
return Q}return null}YYh(Q,Wa){return this.ribbonBuilder.yu&&0<this.ribbonBuilder.yu.count?new n.a(this.ribbonBuilder.yu,Q,Wa):null}}Object(e.a)(ie,"AddinCommandsBuilder",null,[]);class ye{constructor(Q,Wa,Ib,fc,sc,Tc,ad){this.JWa=new xb.a;this.Us=Q;this.Xf=Wa;this.cq=Ib;this.ribbonManager=fc;this.contextMenuManager=sc;this.sH=Tc;this.Cja=ad;this.cQ=Zd.AFrameworkApplication.sa.qF}LHb(Q,Wa,Ib,fc,sc,Tc,ad){const cd=(zd,Qd,Ae,Oe)=>{sc(zd,Qd,Ae,Oe);zd=jb.a[this.Us]+Qd.assetId;({value:Qd}=this.JWa.Ad(zd)).returnValue&&
(Qd.stop(),this.JWa.remove(zd))};if(0!==this.Us&&Q){k.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",Q.count);4===this.Us&&(k.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",fc)),this.weh(Q,fc),Tc());for(let zd of Q)if(Q=zd,k.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",this.cq.sO,Telemetry.PrivacyRules.GetPrivacyCompliantId(Q.solutionId,Q.ownerAddinStoreType||Q.storeType,Q.assetId,null,null,Q.storeId))),this.zwg(Q))if(ad&&
Q.requireConsent)ad(Q,Qd=>{try{if(this.cQ){const Oe=jb.a[this.Us]+Qd.solutionId,sf=this.cQ.Fd("ComponentAttach",Oe);this.JWa.ia(Oe,sf)}const Ae=this.sH.Gla(Qd.storeType,Qd.solutionId);6!==this.Us&&(Ae&&(this.U8b(Ae),Ae.PC.purge(!1)),this.Xf.insertOsfControl(this.QMb(Qd,Wa,Ib,cd)),Ae&&this.Xf.ownerAddinControlRecreated(Qd.solutionId,Qd.storeType))}catch(Ae){k.ULS.sendTraceTag(572839882,220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",
this.cq.sO,Telemetry.PrivacyRules.GetPrivacyCompliantId(Qd.solutionId,Qd.ownerAddinStoreType||Qd.storeType,Qd.assetId,null,null,Qd.storeId),Qd.version,Qd.storeType,Qd.storeId,Ae.message)),cd(!1,Qd,null,null)}});else try{if(this.cQ){const Ae=jb.a[this.Us]+Q.solutionId,Oe=this.cQ.Fd("ComponentAttach",Ae);this.JWa.ia(Ae,Oe)}const Qd=this.sH.Gla(Q.storeType,Q.solutionId);!Zd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFAddinLaunchRefactor",!1)||3!==Zd.AFrameworkApplication.sa.Qa.li&&
1!==Zd.AFrameworkApplication.sa.Qa.li&&2!==Zd.AFrameworkApplication.sa.Qa.li||3!==this.Us||"excatalog"===Q.storeType||!Qd||Qd.isUpgraded?6!==this.Us&&(Qd&&(this.U8b(Qd),Qd.PC.purge(!1)),this.Xf.insertOsfControl(this.QMb(Q,Wa,Ib,cd)),Qd&&this.Xf.ownerAddinControlRecreated(Q.solutionId,Q.storeType)):(this.ribbonManager.heg(Qd.gp),cd(!0,Q,null,Qd.displayName))}catch(Qd){k.ULS.sendTraceTag(17388185,220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",
this.cq.sO,Telemetry.PrivacyRules.GetPrivacyCompliantId(Q.solutionId,Q.ownerAddinStoreType||Q.storeType,Q.assetId,null,null,Q.storeId),Q.version,Q.storeType,Q.storeId,Qd.message)),cd(!1,Q,null,null)}else cd(!1,Q,null,null)}}DMi(Q,Wa,Ib,fc,sc,Tc){const ad=(cd,zd,Qd,Ae)=>{Tc(cd,zd,Qd,Ae);cd=jb.a[this.Us]+zd.solutionId;({value:zd}=this.JWa.Ad(cd)).returnValue&&(zd.stop(),this.JWa.remove(cd))};if(6===this.Us&&Q)if(k.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",this.cq.sO,
Telemetry.PrivacyRules.GetPrivacyCompliantId(Q.solutionId,Q.ownerAddinStoreType||Q.storeType,Q.assetId,null,null,Q.storeId))),this.zwg(Q))try{if(this.cQ){const zd=jb.a[this.Us]+Q.solutionId,Qd=this.cQ.Fd("ComponentAttach",zd);this.JWa.ia(zd,Qd)}const cd=this.sH.Gla(Q.storeType,Q.solutionId);cd||ad(!1,Q,null,null);Zd.AFrameworkApplication.sa&&Zd.AFrameworkApplication.sa.Qa.delayInstallAddInIsEnabled?this.v7e(Q,Wa,fc,sc,Ib,zd=>{ad(zd,Q,Ib,cd.displayName)}):(this.v7e(Q,Wa,fc,sc,Ib),ad(!0,Q,Ib,cd.displayName))}catch(cd){k.ULS.sendTraceTag(592290764,
220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",this.cq.sO,Telemetry.PrivacyRules.GetPrivacyCompliantId(Q.solutionId,Q.ownerAddinStoreType||Q.storeType,Q.assetId,null,null,Q.storeId),Q.version,Q.storeType,Q.storeId,cd.message)),ad(!1,Q,null,null)}else ad(!1,Q,null,null)}K0i(Q,Wa,Ib,fc,sc,Tc){if(Tc)if(Tc._isAddinCommandsManifest(this.cq.sO))try{Zd.AFrameworkApplication.sa&&Zd.AFrameworkApplication.sa.Qa.delayInstallAddInIsEnabled?
this.u7e(Q,Wa,Ib,sc,Tc,ad=>{fc(ad,Q,Tc,Tc.getDefaultDisplayName())}):(this.u7e(Q,Wa,Ib,sc,Tc),fc(!0,Q,Tc,Tc.getDefaultDisplayName()))}catch(ad){k.ULS.sendTraceTag(17586257,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",this.cq.sO,Telemetry.PrivacyRules.GetPrivacyCompliantId(Q.solutionId,Q.ownerAddinStoreType||Q.storeType,Q.assetId,null,null,Q.storeId),Q.version,Q.storeType,Q.storeId,ad.message)),
fc(!1,Q,Tc,Tc.getDefaultDisplayName())}else k.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",this.cq.sO,Telemetry.PrivacyRules.GetPrivacyCompliantId(Q.solutionId,Q.ownerAddinStoreType||Q.storeType,Q.assetId,null,null,Q.storeId),Q.version,Q.storeType,Q.storeId)),fc(!1,Q,null,null);else k.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",
this.cq.sO,Telemetry.PrivacyRules.GetPrivacyCompliantId(Q.solutionId,Q.ownerAddinStoreType||Q.storeType,Q.assetId,null,null,Q.storeId),Q.version,Q.storeType,Q.storeId)),fc(!1,Q,null,null)}QMb(Q,Wa,Ib,fc){const sc={},Tc=document.createElement("div");Tc.setAttribute("visible","false");sc.div=Tc;sc.id=Q.solutionId;sc.solutionId=Q.solutionId;sc.version=Q.version;sc.storeType=Q.storeType;sc.storeId=Q.storeId;sc.assetId=Q.assetId;sc.assetStoreId=Q.assetStoreId;sc.isvirtualOsfControl=!0;sc.virtualOsfControlActivationCallback=
(ad,cd)=>{const zd=this.sH.Gla(Q.storeType,Q.solutionId);zd&&(zd.isUpgraded&&(Q.isUpgraded=!0),this.U8b(zd));this.K0i(Q,Wa,Ib,fc,ad,cd)};sc.reason=3===this.Us?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;return sc}u7e(Q,Wa,Ib,fc,sc,Tc=null){const ad={};ad.solutionId=fc.getSolutionId();ad.version=fc.getVersion();ad.storeType=fc.getStoreType();ad.storeId=fc.getStoreId();ad.assetId=fc.getAssetId();ad.assetStoreId=fc.getAssetStoreId();
ad.targetType=fc.getOsfControlType();let cd=null,zd=null;if(Zd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1))cd=(new OfficeExt.Parser.AddinCommandsManifestParser(this.cq.sO,this.cq.formFactor)).parseExtensions(ad,sc,this.Cja),zd=nc.Oaf(this.cq.sO);else try{cd=(new OfficeExt.Parser.AddinCommandsManifestParser(this.cq.sO,this.cq.formFactor)).parseExtensions(ad,sc,this.Cja),zd=nc.Oaf(this.cq.sO)}catch(Ae){throw k.ULS.sendTraceTag(538752131,
220,10,"Exception encounter while parsing manifest. Exception: "+Ae.message),Ae;}if(zd&&0<zd.count){if(Zd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1)){var Qd=Wa(Q);Wa=Ib(Q);Ib=!!Zd.AFrameworkApplication.fa&&Zd.AFrameworkApplication.fa.ra("AddinCommandsMultipleCustomTabsEnabled");Qd=new ie(Qd,null,Wa);for(let Ae of zd)Qd.commandSurface=Ae,cd.apply(Qd,this.Cja,Ib)}else try{let Ae=Wa(Q),Oe=Ib(Q),sf=!!Zd.AFrameworkApplication.fa&&
Zd.AFrameworkApplication.fa.ra("AddinCommandsMultipleCustomTabsEnabled");Qd=new ie(Ae,null,Oe);for(let Bg of zd)Qd.commandSurface=Bg,cd.apply(Qd,this.Cja,sf)}catch(Ae){throw k.ULS.sendTraceTag(538752132,220,10,"Exception encounter while building ribbon. Exception: "+Ae.message),Ae;}if(OSF.OUtil.checkFlight(14))try{let Ae=Qd.bld(Q.solutionId,sc.getDefaultDisplayName()),Oe=Qd.Y6e();Ae&&this.ribbonManager.u1a(Ae,Tc);Oe&&this.contextMenuManager.gwe(Oe);this.sH.Jwe(fc,Ae,Oe,sc.getDefaultDisplayName());
k.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",sc.getDefaultDisplayName())}catch(Ae){throw OfficeExt.DevConsole.log(Ae),k.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+Ae.message),Ae;}else try{let Ae=Qd.bld(Q.solutionId,sc.getDefaultDisplayName()),Oe=Qd.Y6e();Ae&&this.ribbonManager.u1a(Ae);Oe&&this.contextMenuManager.gwe(Oe);this.sH.Jwe(fc,Ae,Oe,sc.getDefaultDisplayName());k.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",sc.getDefaultDisplayName())}catch(Ae){throw k.ULS.sendTraceTag(539870851,
220,10,"Error generating ribbon extensibility. Exception: "+Ae.message),Ae;}}}v7e(Q,Wa,Ib,fc,sc,Tc=null){const ad={};ad.solutionId=Q.solutionId;ad.version=Q.version;ad.storeType=Q.storeType;ad.storeId=Q.storeId;ad.assetId=Q.assetId;ad.assetStoreId=Q.assetStoreId;ad.targetType=Q.targetType;const cd=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.cq.sO,this.cq.formFactor);try{const zd=Wa.getManifest(),Qd=cd.parse(ad,zd,sc,this.Cja,Wa.getSharedRuntimeId(),Wa),Ae=Ib(Q),Oe=fc(Q),sf=new ie(Ae,null,
Oe);sf.commandSurface="PrimaryCommandSurface";Qd.apply(sf,this.Cja,!0);if(sf.ribbonBuilder.yu&&0<sf.ribbonBuilder.yu.count){const Bg=sf.bld(Q.solutionId,Wa.getManifest().getDefaultDisplayName(),1);Zd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",!1)?this.ribbonManager.u1a(Bg,Tc):Bg&&this.ribbonManager.u1a(Bg,Tc);this.sH.eUg(Wa,Bg,sc,Wa.getManifest().getDefaultDisplayName());k.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",
Wa.getManifest().getDefaultDisplayName())}}catch(zd){k.ULS.sendTraceTag(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",Wa.getManifest().getDefaultDisplayName(),zd.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(zd)}}U8b(Q){Q.gp&&this.ribbonManager.fSd(Q.gp);Q.ewb&&this.contextMenuManager.owj(Q.ewb);this.sH.Wvj(Q.PC.getStoreType(),Q.PC.getSolutionId())}weh(Q,Wa){Wa=nh.a(Wa);for(let Ib of this.sH.H9a){if(Ib.PC.getStoreType()!==Wa)continue;
let fc=!0;for(let sc of Q){const Tc=sc;if(Tc&&Ib.puf(Tc.storeType,Tc.solutionId)){fc=!1;break}}fc&&(this.U8b(Ib),Ib.PC.purge(!1))}}zwg(Q){return!!Q&&!!Q.solutionId&&!!Q.version&&!!Q.storeType&&!!Q.storeId}}Object(e.a)(ye,"AddInCommandsIntegration",null,[]);class jf{constructor(Q,Wa,Ib,fc,sc,Tc,ad,cd=null){this.$a=new Me.a;this.EMc=Q;this.uFg=Wa;this.Kk=Ib;this.pte=fc;this.d0a=sc;this.PCg=Tc;this.yWb=ad;this.zLg=cd}bWg(Q){this.$a.addHandler(Gb.a.wze,Q)}UXg(Q){this.$a.addHandler(Gb.a.myf,Q)}uZg(Q){this.$a.addHandler(Gb.a.hig,
Q)}iWg(Q){this.$a.addHandler(Gb.a.v5c,Q)}YMi(Q,Wa,Ib){const fc=Ib[Gb.a.Asb],sc=void 0===Ib[Gb.a.f_]?0:Ib[Gb.a.f_];if(fc&&0!==sc)if(0>=fc.count&&4!==sc)this.XWf(new A(sc,null,null,Wa,null,!0));else{var Tc=fc.count,ad=new W(new Yb),cd=void 0===Ib[Gb.a.g5]?-1:Ib[Gb.a.g5],zd=new ye(sc,this.Kk,this.EMc,ad,this.uFg,this.d0a,this.yWb),Qd=ig=>this.pte.B8g(ig.solutionId,this.yWb,this.EMc,Q),Ae=ig=>this.pte.L7g(ig.solutionId),Oe=(ig,ag,eg)=>{Tc--;eg=new A(sc,ag,ad,Wa,eg,0>=Tc);if(ig&&ag)this.XWf(eg);else{if(3===
sc||ag&&ag.isUpgraded)ig="",ag&&(ig=Telemetry.PrivacyRules.GetPrivacyCompliantId(ag.solutionId,ag.ownerAddinStoreType||ag.storeType,ag.assetId,null,null,ag.storeId)),ag={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"onAddinCompletedBase.fail",["SDX_Id"]:ig},cg.a.sendTelemetryEvent(Object.assign(new Pf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Na.a.Wj(ag)}));this.WWf(eg)}Tc||Zd.AFrameworkApplication.sa.updateCommandUI()},sf=(ig,ag,eg,Cg)=>{Oe(ig,ag,Cg)},Bg=()=>{this.QHd();
0>=fc.count&&4===sc&&this.d0a.WXd()};6===sc?(cd=Ib[Gb.a.jMa],Ib=Ib[Gb.a.kMa],zd.DMi(fc.ma(0),cd,Ib,Qd,Ae,(ig,ag,eg,Cg)=>{Oe(ig,ag,Cg)})):zd.LHb(fc,Qd,Ae,cd,sf,Bg,this.zLg)}else cg.a.sendTelemetryEvent(Object.assign(new Pf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Na.a.Wj({["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"LaunchOneLineRibbonAddinCommands.fail",["SDX_Id"]:""})})),k.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",
this.EMc.sO)),this.WWf(new A(sc,null,null,Wa,null,!0))}WWf(Q){this.QHd(Q);this.Zig(!1,Q)}XWf(Q){const Wa=Q.El;let Ib=null;null!==Wa&&(Ib=Wa.storeType,Ib=Ib.toLowerCase());if(Q&&"omex"===Ib&&(3===Q.Us||Wa.isUpgraded)){var fc={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Wa.solutionId,Wa.ownerAddinStoreType||Wa.storeType,Wa.assetId,null,null,Wa.storeId)};cg.a.sendTelemetryEvent(Object.assign(new Pf.a,{name:"Office.Extensibility.Host.AppInstall",
dataFields:Na.a.Wj(fc)}))}this.QHd(Q);fc=uh()&&"omex"===Ib&&!!Q.B2&&!!Wa.solutionId&&2===Q.Us&&Wa.solutionId.toLowerCase()===Zg().toLowerCase();var sc="excatalog"===Ib&&3===Q.Us;if("omex"===Ib&&Q.B2&&(3===Q.Us&&"hardcodedpreinstall"!==Ib||Wa.isUpgraded)||fc||sc)fc=new zg,fc.El=Wa,fc.gp=Q.B2.VQa,this.$a.raiseEvent(Gb.a.v5c,fc);fc=mh();sc=Zg();fc&&Wa&&"excatalog"===Wa.storeType&&Q.B2&&5===Q.Us&&sc&&(Wa.storeId&&Wa.storeId.toLowerCase()===sc.toLowerCase()||Wa.assetId&&Wa.assetId.toLowerCase()===sc.toLowerCase())&&
(fc=new zg,fc.El=Wa,fc.gp=Q.B2.VQa,this.$a.raiseEvent(Gb.a.v5c,fc),k.ULS.sendTraceTag(525362254,220,50,"Email alert triggers AutoLaunchAddin event."));Wa&&(eh.instance.lcg(nh.b(Ib),!0),"uploadfiledevcatalog"===Ib&&(fc=this.PCg.createAddinDataProvider(Ib,this.Kk))&&fc.localCacheAddinCommands(this.Kk.Dfa,Wa.solutionId,Wa.version,Wa.storeId),xf.a.MIc(Gb.a.o3c,"true",nh.b(Ib)));this.Zig(!0,Q)}Zig(Q,Wa){Q?Zd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",
!1)&&Wa.B2&&5===Wa.Us&&Wa.B2.VQa&&void 0!==Wa.El.showCallout&&null!==Wa.El.showCallout&&Wa.El.showCallout?((new tg(this.$a)).lTg(Wa.El,n.a.hAb(Wa.B2.VQa)),Q=new zg,Q.gp=Wa.B2.VQa,Q.El=Wa.El,this.$a.raiseEvent(Gb.a.hig,Q)):3!==Wa.Us?Wa.nxf&&this.d0a.WXd():Wa.B2&&Wa.B2.VQa&&"hardcodedpreinstall"!==Wa.El.storeType&&rc.a.tXj(Wa.displayName,Wa.B2.VQa,Wa.El.isAutoLaunched):3===Wa.Us?Wa.El&&"uploadfiledevcatalog"===Wa.El.storeType.toLowerCase()?(Wa=this.yWb.F5h(Wa.El.solutionId),rc.a.d0d(Wa?Wa:CommonUIStrings.l_InternalError+
" "+CommonUIStrings.l_InternalError_Directive)):this.d0a.vdg():Wa.nxf&&this.d0a.WXd()}QHd(Q=null){var Wa=Q?Q.El:null;const Ib=new zg;if(Ib.El=Wa){var fc=this.d0a.Gla(Wa.storeType,Wa.solutionId,6===Q.Us?1:0);if(fc&&fc.gp){Ib.gp=fc.gp;var sc=Zg();sc=uh()&&!!Wa.solutionId&&!!sc&&Wa.solutionId.toLowerCase()===sc.toLowerCase()&&2===Q.Us;if(3===Q.Us&&"hardcodedpreinstall"!==Wa.storeType||sc)Q="",fc.gp.NX&&fc.gp.NX.yu&&(fc=fc.gp.NX.yu.ma(0))&&(Q=fc.id),Wa={["SDX_CommandPlacement"]:Q,["SDX_PinningAction"]:"Pinning",
["SDX_PinningActionErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Wa.solutionId,Wa.ownerAddinStoreType||Wa.storeType,Wa.assetId,null,null,Wa.storeId)},cg.a.sendTelemetryEvent(Object.assign(new Pf.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:Na.a.Wj(Wa)}))}}this.$a.raiseEvent(Gb.a.wze,Ib)}}Object(e.a)(jf,"LaunchAddinCommandsHandler",null,[819]);class lf{}lf.lYa="Alt";lf.mYa="Command";lf.id="Id";lf.pYa="Image16by16";lf.hWb="LabelText";lf.qYa="Title";lf.GROUP="Group";
lf.x$d="Groups";lf.Xkb="Controls";lf.button="Button";lf.vda="FlyoutAnchor";lf.LARGE="Large";lf.SMALL="Small";Object(e.a)(lf,"AddinDataNodeConstants",null,[]);var Nf=a(385);a(578);var kg=a(573);a(140);class pg{constructor(Q,Wa){this.zHa=this.nde=null;if(Ie.c(Q)||Ie.c(Wa))throw k.ULS.sendTraceTag(9175312,220,10,"ControlDefinition id or type should not be null or undefined."),Error.create("ControlDefinition id or type should not be null or undefined");this.AFg=Wa;this._id=Q;this.HV[lf.id]=this._id}get id(){return this._id||
""}get HV(){return this.nde||(this.nde={})}get controlType(){return this.AFg||""}get menuItems(){return this.zHa||(this.zHa=new d.a)}}Object(e.a)(pg,"ControlDefinition",null,[814]);class qg{constructor(Q){this.Nle=null;if(Ie.c(Q))throw k.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");this._id=Q;this.Aoa[lf.id]=this._id}get Aoa(){return this.Nle||(this.Nle={})}get id(){return this._id||
""}}Object(e.a)(qg,"MenuItemDefinition",null,[859]);class lg{constructor(Q){this.Gsa=null;if(Ie.c(Q))throw k.ULS.sendTraceTag(9175314,220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=Q}get id(){return this._id}get controls(){return this.Gsa||(this.Gsa=new d.a)}}Object(e.a)(lg,"OfficeMenuDefinition",null,[812]);var zf=a(27);class yh{constructor(Q,Wa,Ib){this.BK=this.bZa=null;this.YVc=Q;this.SYa=Wa;this.tYa=
Ib;this.YKg=new d.a}get ltc(){return this.YVc}get Gvb(){return this.SYa}get N0c(){return this.tYa}addButton(Q){k.ULS.sendTraceTag(17085952,220,50,"ContextMenu button actiontype: {0}.",Q.actionType);this.BK=new pg(this.Bva(Q.id),lf.button);this.BK.HV[lf.hWb]=Q.label;this.BK.HV[lf.lYa]=Q.label;this.BK.HV[lf.pYa]=Q.icon["16"];this.Ttb(this.BK.HV[lf.id],Q.action);this.$Ia(this.BK.HV);this.bZa.controls.add(this.BK);this.BK=null}startBuildMenu(Q){if(Ie.c(this.bZa))this.bZa=new lg(Q.id);else{const Wa=this.Bva(Q.id);
this.BK=new pg(Wa,lf.vda);this.b3a(this.BK.HV,Q);this.BK.HV[lf.pYa]=Q.icon["16"];this.BK.HV[lf.mYa]=zf.a.alwaysEnabled}}addMenuItem(Q){k.ULS.sendTraceTag(17085953,220,50,"ContextMenu menu item actiontype: {0}.",Q.actionType);const Wa=new qg(this.Bva(Q.id));this.b3a(Wa.Aoa,Q);Q.icon&&(Wa.Aoa[lf.pYa]=Q.icon["16"]);this.Ttb(Wa.Aoa[lf.id],Q.action);this.$Ia(Wa.Aoa);this.BK.menuItems.add(Wa)}endBuildMenu(){Ie.c(this.BK)?(this.Fsc.add(this.bZa),this.bZa=null):(this.bZa.controls.add(this.BK),this.BK=null)}get Fsc(){return this.YKg}Ttb(Q,
Wa){this.N0c.bindAction(Q,Wa)}$Ia(Q){this.Gvb.$Ia(Q)}Bva(Q){return this.ltc.JNa(Q)}b3a(Q,Wa){Q[lf.hWb]=Wa.label;Q[lf.lYa]=Wa.label}}Object(e.a)(yh,"ContextMenuExtensibilityCreator",null,[843,839]);class zh{constructor(Q){this.Zob=Q}get BJb(){return this.Zob}JNa(Q){return this.BJb+Q}}Object(e.a)(zh,"DefaultContextMenuNamingProvider",null,[842]);var ih=a(1371);class Ah{bindAction(Q,Wa){OfficeExt.DefaultControlActionBinder.bindAction(Q,Wa)}}Object(e.a)(Ah,"DefaultUIControlActionBinder",null,[841]);class Sh{constructor(Q){this.cGa=
Q}get command(){return this.cGa}$Ia(Q){Q[lf.mYa]=this.command}}Object(e.a)(Sh,"DefaultUIControlCommandBinder",null,[840]);var si=a(28);class vh{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=null}}Object(e.a)(vh,"AddInControl",null,[]);class Lh{constructor(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=null}}Object(e.a)(Lh,"AddInGroup",null,[]);class Xf{constructor(){this.iconLocation=this.title=
this.id=null;this.enabled=!1;this.attributes=null}}Object(e.a)(Xf,"AddInMenuItem",null,[]);class gi{constructor(){this.groups=this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}}Object(e.a)(gi,"AddInTab",null,[]);class Th{constructor(Q,Wa,Ib,fc,sc,Tc){this.vWb=new d.a;this.lmb=this.Pha=this.cZa=null;this.YVc=Q;this.tYa=Wa;this.SYa=Ib;this.My=fc;this.yWb=sc;this.ufe=Tc}get ltc(){return this.YVc}get yu(){return this.vWb}get N0c(){return this.tYa}get Gvb(){return this.SYa}startBuildTab(Q){const Wa=
Q.isOfficeTab?Q.id:this.ltc.rff(Q.id),Ib=Q.isOfficeTab?null:Q.label;this.cZa=Object.assign(new gi,{id:Wa,title:Ib,isOfficeTab:Q.isOfficeTab,visible:Q.visible,groups:[],tabType:Q.tabType,insertBefore:Q.insertBefore,insertAfter:Q.insertAfter,autoFocus:Q.autoFocus})}startBuildGroup(Q){const Wa=this.Bva(Q.id);this.Pha=Object.assign(new Lh,{id:Wa,mlrId:Q.mlrId,title:Q.label,controls:[],groupType:0})}addNativeGroup(Q){this.Pha=Object.assign(new Lh,{id:Q.id,mlrId:Q.mlrId,title:Q.label,controls:[],groupType:1});
this.cZa.groups.push(this.Pha)}addButton(Q){const Wa=this.Bva(Q.id);Wa&&(this.Ttb(Wa,Q.action),k.ULS.sendTraceTag(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",Q.actionType),Q=Object.assign(new vh,{id:Wa,title:Q.label,iconLocation:this.Fnd(Q),enabled:Q.enabled,controlType:0,attributes:this.b3a()}),this.ufe.Rve(new si.a(Wa,this.Gvb.command.toString())),this.Pha.controls.push(Q))}addNativeControl(Q){Q.id&&(k.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",
Q.actionType),Q=Object.assign(new vh,{id:Q.id,title:"",iconLocation:"",enabled:Q.enabled,controlType:2,attributes:this.b3a()}),this.Pha.controls.push(Q))}startBuildMenu(Q){const Wa=this.Bva(Q.id);Wa&&(this.lmb=Object.assign(new vh,{id:Wa,title:Q.label,iconLocation:this.Fnd(Q),controlType:1,attributes:{},menuItems:[]}))}addMenuItem(Q){const Wa=this.Bva(Q.id);Wa&&(this.Ttb(Wa,Q.action),k.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",Q.actionType),Q=Object.assign(new Xf,
{id:Wa,title:Q.label,iconLocation:this.Fnd(Q),enabled:Q.enabled,attributes:this.b3a()}),this.ufe.Rve(new si.a(Wa,this.Gvb.command.toString())),this.lmb.menuItems.push(Q))}endBuildMenu(){Ie.c(this.lmb.id)||this.Pha.controls.push(this.lmb);this.lmb=null}endBuildGroup(){Ie.c(this.Pha.id)||this.cZa.groups.push(this.Pha);this.Pha=null}endBuildTab(){Ie.c(this.cZa.id)||this.vWb.add(this.cZa);this.cZa=null}b3a(){const Q={};this.$Ia(Q);return Q}Fnd(Q){return Q.icon["80"]?Q.icon["80"]:Q.icon["32"]}$Ia(Q){this.Gvb.$Ia(Q)}Bva(Q){return this.ltc.JNa(Q)}Ttb(Q,
Wa){this.N0c.bindAction(Q,Wa)}}Object(e.a)(Th,"OneLineRibbonExtensibilityCreator",null,[838,839]);class ci{constructor(Q,Wa){this.Zob=Q;this.tYa=new Ah;this.SYa=new Sh(Wa)}L7g(Q){Q=new zh(Q);return new yh(Q,this.SYa,this.tYa)}B8g(Q,Wa,Ib,fc){Ib=new ih.a(this.Zob,Q,Ib,!0);return new Th(Ib,this.tYa,this.SYa,Q,Wa,fc)}}Object(e.a)(ci,"UIExtensibilityFactory",null,[805]);var jh=a(91),ti=a(909),kh=a(23),Wf=a(40),Hg=a(75),Kg=a(52);class Tg{constructor(Q){this.pJa=this.sJa=this.El=this.gp=null;this.I3f=0;
this.$8i=()=>{if(this.El&&this.pJa){const Wa=new jh.a(zf.a.Y4,0,0,2,null);this.addinUICommandHandler.executeCommand(0,Wa,{["SourceControlId"]:this.pJa},null);k.ULS.sendTraceTag(537170697,220,50,"Launch addin command has been triggered")}};this.uXj=(Wa,Ib)=>{Wa=null;if(Ib)if(Wa=Ib,this.El=Wa.El,(this.gp=Wa.gp)&&this.gp.NX&&this.gp.NX.yu&&(this.sJa=this.gp.NX.yu.ma(0)),this.sJa&&this.sJa.id)if(this.sJa.isOfficeTab)if(Ib=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap(),Wa=
this.El.solutionId,Wa in Ib?this.pJa=Ib[Wa]:(Ib=Tg.GetPrivacyCompliantId(this.El),k.ULS.sendTraceTag(537170695,220,15,`Failed to get button id from controlIdMap for add-in: ${Ib}`),this.pJa=this.x_h(this.gp)),this.pJa)if(kh.a.contains(this.sJa.id,Wd.a.yP,!0))appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(n.a.hAb(this.gp),()=>{this.Cjg(this.Pod(this.pJa))});else{if(Ib=this.$.Ia)Ib.nze(this.tSf),k.ULS.sendTraceTag(537170693,220,50,"ShowCalloutOnAddin registered a tab switched event")}else k.ULS.sendTraceTag(537170694,
220,10,"Failed to get button id for addin"),Ib={["AppTeachingUICalloutAction"]:"NoEnabledButtonFound",["SDX.Id"]:Tg.GetPrivacyCompliantId(this.El),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},cg.a.sendTelemetryEvent(Object(Xc.a)(new Pf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Na.a.Wj(Ib)})),this.z8();else this.Ejg(this.Pod(this.sJa.id),0);else k.ULS.sendTraceTag(537170696,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),
Ib={["AppTeachingUICalloutAction"]:"NoTabFound",["SDX.Id"]:Tg.GetPrivacyCompliantId(this.El),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},cg.a.sendTelemetryEvent(Object(Xc.a)(new Pf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Na.a.Wj(Ib)})),this.z8();else this.z8()};this.tSf=()=>{if(kh.a.contains(this.sJa.id,appChrome.selectors.getSelectedTabId(),!0)){var Wa=this.$.Ia;Wa&&Wa.G5f(this.tSf);this.Cjg(this.Pod(this.pJa))}};this.c9i=
()=>{var Wa={["AppTeachingUICalloutAction"]:"ClickOnLaunch",["SDX.Id"]:Tg.nYa(this.fE),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};cg.a.sendTelemetryEvent(Object(Xc.a)(new Pf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Na.a.Wj(Wa)}));this.z8();let Ib={};Ib[Hg.a.Og]=this.fE;Wa={};Wa.solutionId=this.fE.solutionId;Wa.assetId=this.fE.assetId;Wa.assetStoreId=this.fE.assetStoreId;Wa.height=0!=this.fE.height?this.fE.height:600;Wa.storeId=
this.fE.storeId;Wa.storeType=this.fE.storeType;Wa.targetType=this.fE.targetType;Wa.width=0!=this.fE.width?this.fE.width:600;Wa.displayName=this.fE.displayName;Wa.version=this.fE.version;Wa.isAddinCommands=!1;Ib[Gb.a.Dja]=Wa;let fc=new jh.a(-741808261,0,0,2,null);Wf.TaskExtensions.za(Kg.GetServiceTaskFactory.Za(this.$.da,374,375,1),sc=>{sc=sc.result;null!=sc&&sc.insertAgave(Ib,fc)},this.$.ka,3)};this.K2i=()=>{let Wa={["AppTeachingUICalloutAction"]:"ClickOnClose",["SDX.Id"]:Tg.nYa(this.fE),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};cg.a.sendTelemetryEvent(Object(Xc.a)(new Pf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Na.a.Wj(Wa)}));this.z8()};this.h4i=()=>{let Wa={["AppTeachingUICalloutAction"]:"ClickOnDismiss",["SDX.Id"]:Tg.nYa(this.fE),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};cg.a.sendTelemetryEvent(Object(Xc.a)(new Pf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Na.a.Wj(Wa)}));this.z8()};
this.u9=Wa=>{k.ULS.sendTraceTag(522981591,306,10,`failed to POST data to Roaming Settings Service with status: ${Wa?Wa.httpStatus:-1}`)};this.$=Q.$;this.addinUICommandHandler=Q;this.appName=Zd.AFrameworkApplication.fa.Va("WebAppShortName")||"Excel";this.b_g=Zd.AFrameworkApplication.fa.Ae("AddinMaxDOMElementDetectionTimesForTeachingUI",10)}static GetPrivacyCompliantId(Q){return Telemetry.PrivacyRules.GetPrivacyCompliantId(Q.solutionId,Q.storeType,Q.assetId,null,null,Q.storeId)}static nYa(Q){return Telemetry.PrivacyRules.GetPrivacyCompliantId(Q.solutionId,
Q.storeType,Q.assetId,null,null,Q.storeId)}ovj(Q){this.fE=Q;window.addEventListener&&(window.addEventListener("LaunchContentAddin",this.c9i,!0),window.addEventListener("DismissCallout",this.h4i,!0),window.addEventListener("CloseCallout",this.K2i,!0))}Pod(Q){return"[id="+Q+"]"}Ejg(Q,Wa){Wa>this.b_g?(window.clearTimeout(this.I3f),this.Djg("[data-unique-id='pivotOverflowButton']"),k.ULS.sendTraceTag(537170692,220,50,"ShowTeachingCalloutWithPoll did not find the DOM element in time")):document.querySelector("button"+
Q)?this.Djg(Q):this.I3f=window.setTimeout(()=>{this.Ejg(Q,Wa+1)},1E3)}Cjg(Q){var Wa=document.querySelector("button[data-unique-id='RightPaddle']");if(Wa)Q={["AppTeachingUICalloutAction"]:"RightPaddlePresent",["SDX.Id"]:Tg.GetPrivacyCompliantId(this.El),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},cg.a.sendTelemetryEvent(Object(Xc.a)(new Pf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Na.a.Wj(Q)}));else if(Wa=document.querySelector("button"+
Q),!Wa||"none"===window.getComputedStyle(Wa).display)if(Wa=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!Wa){Wa={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:Tg.GetPrivacyCompliantId(this.El),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};cg.a.sendTelemetryEvent(Object(Xc.a)(new Pf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Na.a.Wj(Wa)}));k.ULS.sendTraceTag(537170691,220,15,"ShowTeachingCallout failed to get an anchorElement");
this.z8();return}this.hqg(Wa,"ShowTeachingUIForAddinButton")}Djg(Q){Q=document.querySelector("button"+Q);if(!Q&&(Q=document.querySelector("button[data-unique-id='pivotOverflowButton']"),!Q)){Q={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:Tg.GetPrivacyCompliantId(this.El),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};cg.a.sendTelemetryEvent(Object(Xc.a)(new Pf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Na.a.Wj(Q)}));k.ULS.sendTraceTag(537170690,
220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");this.z8();return}this.hqg(Q,"ShowTeachingUIForAddinTab")}hqg(Q,Wa){Q.setAttribute("lpp-id","latestAddin");const Ib=fd.a.instance.Dc("Common.ISystemInitiatedFeedback");Ib&&Q?(Ib.execute(fc=>{fc.logActivity(Wa,null)}),Q={["AppTeachingUICalloutAction"]:"Show",["SDX.Id"]:Tg.GetPrivacyCompliantId(this.El),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},cg.a.sendTelemetryEvent(Object(Xc.a)(new Pf.a,
{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Na.a.Wj(Q)})),k.ULS.sendTraceTag(537170688,220,50,"ShowTeachingCalloutToAddinTab triggered an LPP activity")):(k.ULS.sendTraceTag(537170689,220,15,"ShowTeachingCalloutToAddinTab failed to get a sifFuture"),Q={["AppTeachingUICalloutAction"]:"NoSifFutureObject",["SDX.Id"]:Tg.GetPrivacyCompliantId(this.El),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},cg.a.sendTelemetryEvent(Object(Xc.a)(new Pf.a,
{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Na.a.Wj(Q)})),this.z8())}x_h(Q){if(!Q)return null;Q=Q.NX;if((null===Q||void 0===Q?0:Q.yu)&&0<Q.yu.count)for(let Wa of Q.yu)if(Wa.groups&&0<Wa.groups.length)for(const Ib of Wa.groups)if(Ib.controls&&0<Ib.controls.length)for(const fc of Ib.controls){if(fc.attributes&&0===fc.controlType&&fc.enabled)return fc.id;if(fc.menuItems)for(const sc of fc.menuItems)if(sc.attributes&&sc.enabled)return fc.id}return null}NZj(){var Q=document.querySelector("button[data-unique-id = 'Ribbon-InsertAppsForOffice']");
if(Q&&"none"!==window.getComputedStyle(Q).display)k.ULS.sendTraceTag(527286666,220,15,"Callout show on OfficeAddin Button");else{Q=document.querySelector("button[data-unique-id = 'Overflow-RibbonOverflowMenu-overflow']");if(null==Q){Q={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:Tg.nYa(this.fE),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};cg.a.sendTelemetryEvent(Object(Xc.a)(new Pf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Na.a.Wj(Q)}));
k.ULS.sendTraceTag(527286668,220,15,"ShowTeachingCalloutToContentAddin failed to get an anchorElement");this.z8();return}k.ULS.sendTraceTag(527286667,220,15,"Callout show on Overflow button")}const Wa=fd.a.instance.Dc("Common.ISystemInitiatedFeedback");null==Wa||null==Q?(Q={["AppTeachingUICalloutAction"]:"NoSifFutureObject",["SDX.Id"]:Tg.nYa(this.fE),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},cg.a.sendTelemetryEvent(Object(Xc.a)(new Pf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:Na.a.Wj(Q)})),k.ULS.sendTraceTag(527286665,220,15,"ShowTeachingCalloutToContentAddin failed to get a sifFuture"),this.z8()):(Wa.execute(Ib=>{Ib.logActivity("ShowTeachingUIForContentAddin",null)}),Q={["AppTeachingUICalloutAction"]:"Show",["SDX.Id"]:Tg.nYa(this.fE),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},cg.a.sendTelemetryEvent(Object(Xc.a)(new Pf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Na.a.Wj(Q)})),k.ULS.sendTraceTag(527286664,
220,50,"ShowTeachingCalloutToContentAddin triggered an LPP activity"))}aCc(Q){const Wa={},Ib={};Ib.LastTeachingUIShowTime=(new Date).toUTCString();Ib.AddinHasShown=Q;Wa[this.appName]=yg.c(Ib);this.Esb=new hh(this.appName,null,null,this.u9),this.Esb.tec(Wa),k.ULS.sendTraceTag(522981592,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}z8(){if(!this.NUa){const Q=window.g_roamingAddinList;Q&&(this.aCc(Q),this.NUa=!0)}}}Object(e.a)(Tg,"AddinTeachingCalloutHandler",
null,[]);var se=a(1297),N=a(429),ua=a(12),ab=a(199),Lb=a(46),dc=a(19),Dc=a(63),Ac=a(156),Wc=a(193);class Pc extends Ac.a{constructor(Q,Wa,Ib,fc){super();this.mZ="calc(100% - 46px)";this.paa="15px";this.nZ="0";this.Emb="WACDialogPanel";this.CF=695;this.Fmb=462;this.wD="80%";this.rlb=350;this.wsa="100%";this.AU=null;this.Ac=5;this.ef="AddinInstallDialog";this.EDg=Q;this.yZ=Wa;this.sQg=Ib;this.FLg=fc}oy(){super.oy();this.Mi.style.width=this.wsa;this.Mi.style.height=this.mZ;this.Mi.style.marginTop=this.paa;
this.Mi.style.padding=this.nZ;document.getElementById(this.Hi("WACDialogButtonPanel")).style.display="none";this.mka.setAttribute("tabindex","0");$addHandler(this.mka,"keyup",Object(ge.a)(this,this.onKeyUp,"onKeyUp"));const Q=document.createElement("iframe");Q.setAttribute("id","InstallAddinDialog");Q.setAttribute("src","about:blank");Q.setAttribute("width","100%");Q.setAttribute("height","100%");Q.setAttribute("marginHeight","0");Q.setAttribute("marginWidth","0");Q.setAttribute("frameBorder","0");
Q.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin ms-allow-popups allow-popups");const Wa=String.format("https://inclient.store.office.com/gyro/clientstore/flyoutdetails/{0}?client={1}&ui={2}&rs={2}",this.EDg,this.yZ,this.sQg);Q.setAttribute("src",Wa);this.AU=Q;$addHandler(Q,"load",Object(ge.a)(this,this.onLoad,"onLoad"));$addHandler(window,"message",Object(ge.a)(this,this.onMessage,"onMessage"));this.Mi.appendChild(Q);this.Mi.appendChild(this.soh())}soh(){const Q=document.createElement("div");
Q.setAttribute("tabindex","0");$addHandler(Q,"focus",Object(ge.a)(this,this.x9i,"onLoopPivotFocus"));return Q}onKeyUp(Q){13!==Q.keyCode&&32!==Q.keyCode||this.hide()}x9i(){this.mka.focus()}onLoad(){this.AU.focus()}onMessage(Q){Q=Q.rawEvent;if(Q.source===this.AU.contentWindow&&(Q=(Q=Q.data)?Q.split("|"):null)&&0<Q.length&&("REFRESH_REQUIRED"===Q[0]||"PRELOAD_MANIFEST"===Q[0])){Hb.a.instance.setItem("refreshRequired","true");const Wa={};Wa.solutionId=Q[1];Wa.version=Pc.pZi(Q[3]);Wa.storeType=Q[4];Wa.storeId=
Q[5];Wa.assetId=Q[6];Wa.targetType=Pc.whj(Q[2]);Wa.assetStoreId=Q[7];Wa.width=parseInt(Q[8]);Wa.height=parseInt(Q[9]);this.FLg(Wa)}}Fpa(){this.Mi.style.width=this.wsa;this.Mi.style.height=this.mZ;this.Mi.style.marginTop=this.paa;this.Mi.style.padding=this.nZ;this.CF>Wc.a.e2?(this.Rb.style.width=String.format("{0}px",Wc.a.e2),this.Rb.style.overflowX="scroll",Zd.AFrameworkApplication.isRtl?this.Rb.style.right="0":this.Rb.style.left="0"):(this.Rb.style.width=String.format("{0}px",this.CF),this.Rb.style.overflowX=
"hidden");this.Rb.offsetHeight>Wc.a.jT||this.Fmb+50>Wc.a.jT?(this.Rb.style.height=String.format("{0}px",Wc.a.jT),this.Rb.style.overflowY="scroll",this.Rb.style.top="0",Zd.AFrameworkApplication.isRtl?this.Rb.style.right="0":this.Rb.style.left="0",this.Mi.style.minHeight=String.format("{0}px",this.rlb)):(this.Rb.style.overflowY="hidden",this.Rb.style.top="10%",this.Rb.style.height=this.wD);this.hca()}hca(){if(this.Rb){var Q=this.Rb.style.zIndex;this.Rb.style.zIndex="-9999";if(this.CF>Wc.a.e2)Zd.AFrameworkApplication.isRtl?
this.Rb.style.marginRight="0":this.Rb.style.marginLeft="0";else{const Wa=String.format("{0}px",Math.floor(-this.Rb.offsetWidth/2));Zd.AFrameworkApplication.isRtl?this.Rb.style.marginRight=Wa:this.Rb.style.marginLeft=Wa;Zd.AFrameworkApplication.isRtl?this.Rb.style.right="50%":this.Rb.style.left="50%"}this.Rb.style.zIndex=String(Q)}else k.ULS.sendTraceTag(509871430,306,10,"_divMessageBox is null in CenterDialog()")}kF(){super.kF();const Q=document.getElementById(this.Hi(this.Emb));Q.style.width=String.format("{0}px",
this.CF);Q.style.height=this.wD}get Vca(){return this.Mi}dispose(){super.dispose();$removeHandler(window,"message",Object(ge.a)(this,this.onMessage,"onMessage"))}static whj(Q){switch(Q){case "1":return 0;case "2":return 1;default:return 0}}static pZi(Q){const Wa=Q.split(".");for(let Ib=0;Ib<4-Wa.length;Ib++)Q+=".0";return Q}}Object(e.a)(Pc,"AddinInstallDialog",Ac.a,[]);var Zc=a(910);class ud{constructor(Q){this.LYc=Q}next(Q){this.LYc=(9301*this.LYc+49297)%233280;return Math.floor(this.LYc/233280*
Q)}}Object(e.a)(ud,"Random",null,[]);class Pd extends Nf.a{constructor(){super();this.DismissHostingSurfaceOnExecute=!0}}Object(e.a)(Pd,"CuiButtonPropsExtended",Nf.a,[]);var he=a(1015),Ne=a(595);class Be{constructor(){this.InsertionPoint=this.GalleryButtons=this.Title=this.SectionId=null}}Object(e.a)(Be,"GallerySectionProps",null,[]);var Ee=a(1370),Af=a(579);class ef{constructor(){this.text=this.href=null}}Object(e.a)(ef,"LinkProps",null,[]);class hf{constructor(){this.icon=this.text=this.href=null}}
Object(e.a)(hf,"LinkWithLabelProps",null,[]);var Jf=a(1014),af=a(161);class Jc{constructor(Q,Wa,Ib,fc,sc,Tc=null,ad=null){this.gRc={};this.Vke={};this.TYb={};this.uge=0;this.zoe=!1;this.dlb=0;this.Lge=!1;this.xGa=this.oob=0;this.elb=Wa;this.Ky=null;this.qKg=Ib;this.sKg=fc;this.TNg=sc;this.Bae=ad;this.Ra=Tc||Zd.AFrameworkApplication.fa;this.elb.Ifb(Object(ge.a)(this,this.xBa,"onAddinDetailsRefreshed"));appChrome.addInApi.loadOfficeAddInIcons()}get nkh(){return this.TYb}wuj(Q){if(Q.XK)for(let Wa=0;Wa<
Q.XK.length;Wa++)appChrome.addInApi.registerAddinIcon("AddinFlyoutControl"+Q.XK[Wa].solutionId,Q.XK[Wa].iconUrl);else 0===Q.errorCode&&k.ULS.sendTraceTag(509687429,220,10,"addinDetails is null which will lead to no icons registered")}get Inc(){return!!this.Ra&&this.Ra.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",!1)}get Ixd(){return!!this.Ra&&this.Ra.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewDownloadV2Enabled",!1)}get Tnc(){return!!this.Ra&&
this.Ra.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutNotifyObserverFailuresEnabled",!1)&&this.Ra.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsPopularLoaderEnabled",!1)}AUj(Q){0===Q.wI&&(this.dlb|=1);1===Q.wI&&(this.dlb|=2);return!!this.dlb}xBa(Q,Wa){this.wuj(Wa);this.Bae&&this.Bae.xBa(Q,Wa);this.AUj(Wa)&&this.Ra.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutOverflowTelemetryEnabled",!1)&&this.iRi()}Fij(Q){const Wa=[];var Ib=new ud((new Date).getDate());
for(var fc=0;8>fc;fc++)Array.add(Wa,Ib.next(Q.count));Ib=0;for(let sc of Q){fc=!1;for(const Tc of Wa)if(Ib===Tc){fc=!0;break}Ib++;if(fc){let Tc;(Tc=sc.addinInfo).AUP=20*Tc.AUP}else if(1===sc.addinInfo.priority){let Tc;(Tc=sc.addinInfo).AUP=4*Tc.AUP}else if(2===sc.addinInfo.priority){let Tc;(Tc=sc.addinInfo).AUP=2*Tc.AUP}}Q.Sc((sc,Tc)=>sc.addinInfo.AUP<Tc.addinInfo.AUP?1:-1);return Q}Gij(Q){for(let Wa of Q)if(1===Wa.addinInfo.priority){let Ib;(Ib=Wa.addinInfo).AUP=4*Ib.AUP}else if(2===Wa.addinInfo.priority){let Ib;
(Ib=Wa.addinInfo).AUP=2*Ib.AUP}Q.Sc((Wa,Ib)=>Wa.addinInfo.AUP<Ib.addinInfo.AUP?1:-1);return Q}Jca(Q,Wa){const Ib={};Ib.width=Q;Ib.height=Wa;Ib.backgroundColor="transparent";return Ib}Xad(){return{flexDirection:"column"}}pbd(){return{"margin-top":"4px","max-width":"96px",height:"32px","font-size":"12px",overflow:"hidden",display:"-webkit-box","-webkit-line-clamp":"2","-webkit-box-orient":"vertical","white-space":"normal","word-break":"break-word","text-overflow":"ellipsis"}}p7h(){const Q={},Wa={},
Ib={};Wa.root={marginTop:"12px",marginLeft:"16px",marginRight:"16px",marginBottom:"20px",width:"100%",padding:0};Wa.inner={margin:"-4px"};Ib.root=this.Jca(100,100);Ib.flexContainer=this.Xad();Ib.label=this.Inc?{"margin-top":"4px","max-width":"86px","font-size":"12px","text-overflow":"ellipsis"}:this.pbd();Q.galleryButtonInExpanded=Ib;Q.galleryStack=Wa;return Q}pZh(){return Object.assign(new Ee.a,{Id:"AddinFlyoutMoreButton",ExternalId:"AddinFlyoutMoreButton",Icon:"AllApps_16",Command:this.TNg,LabelText:CommonUIStrings.l_AddinsFlyoutSeeAllButtonText,
FullIconStyle:{root:{"max-width":"16px","max-height":"16px","min-width":"16px","min-height":"16px",border:"1px solid #E0E0E0","border-radius":"6px",padding:"15px 15px 15px 15px",overflow:"hidden"}},Alt:CommonUIStrings.l_AddinsPickerGalleryButtonMoreArialText})}kYh(Q,Wa,Ib){const fc={},sc={width:"32px",height:"32px","border-radius":"6px",overflow:"hidden",padding:"7px",border:"1px solid #E0E0E0"};Zd.AFrameworkApplication.isRtl&&(sc.direction="ltr");fc.root=sc;return Object.assign(new Ee.a,{Id:Ib,ExternalId:Ib,
Icon:"AddinFlyoutControl"+Wa.solutionId,Command:Q===CommonUIStrings.l_PopularAddins?this.qKg:this.sKg,LabelText:Wa.displayName,FullIconStyle:fc,Alt:Wa.description})}Qjj(Q,Wa,Ib){const fc=Object.assign(new Be,{SectionId:Q,Title:Q,GalleryButtons:[]});for(let sc=0;sc<Ib;sc++)Array.add(fc.GalleryButtons,this.kYh(Q,Wa[sc],this.gRc[Wa[sc].solutionId]));return fc}Pci(){var Q=[];const Wa=this.elb.oAb(0);Array.addRange(Q,Wa.XK);const Ib=this.elb.oAb(1);Array.addRange(Q,Ib.XK);let fc=Q.length;this.xGa=0<fc?
5:6;Zd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",!0)&&k.ULS.sendTraceTag(509687428,220,15,"The MRU list number is {0}, myAddins: {1}|{2}, adminManaged: {3}|{4}",fc,Zc.a[Wa.errorCode],Wa.XK.length,Zc.a[Ib.errorCode],Ib.XK.length);Q.sort((Ae,Oe)=>{Ae=af.d(Ae.displayName);Oe=af.d(Oe.displayName);return jg.a.localeCompare(Ae,Oe)});const sc=6<fc;sc&&(fc=5);for(var Tc=0;Tc<fc;Tc++)this.JFe(Q[Tc]);let ad=[];Tc=null;this.Ky?ad=this.Ky:(Tc=this.elb.oAb(2),
0===Tc.errorCode&&Tc.XK.forEach(Ae=>{-1!==Ae.addinInfo.priority&&(this.JFe(Ae),ad.push(Ae))}));Tc=!0;ad.length||(Tc=!1);let cd=0;if(Tc&&(cd=Q.length?3>=Q.length?9:6:12,ad=this.Inc?this.j2g(ad,Q):this.i2g(ad,Q),cd>ad.length&&(cd=ad.length),Zd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",!0)&&!this.zoe&&!this.Inc)){var zd="",Qd="";for(let Ae=0;Ae<ad.length&&Ae<cd;Ae++)zd+=ad[Ae].displayName,zd+=",",Qd+=ad[Ae].solutionId,Qd+=",";k.ULS.sendTraceTag(509673818,
220,15,"The popular list number is {0}, addin name list:{1}, addin solution id list:{2}",cd,zd,Qd);this.zoe=!0}zd=Object.assign(new Dd.a,{Id:"FooterSection",ControlsId:"FooterSection.Controls",ControlList:[]});Qd=Object.assign(new Nf.a,{ExternalId:"InsertMoreAddInsFromFooter",AriaDescription:CommonUIStrings.l_AddinsPickerFooterButtonMoreArialText});Array.add(zd.ControlList,Qd);appChrome.api.dispatch(appChrome.actions.setControlLabel("InsertMoreAddInsFromFooter",CommonUIStrings.l_AddinPickerButtonMore));
zd=Object.assign(new kg.a,{Id:"Ribbon.AddinPicker",MenuSectionList:[],MenuFooterSection:zd,UpdateDynamically:!0});2!==Wa.errorCode||Q.length?3===Wa.errorCode&&3===Ib.errorCode?(k.ULS.sendTraceTag(509687426,220,10,"dataProvider invoke error hit"),Q=this.a7e("Common",CommonUIStrings.l_AddinPickerGeneralError),Array.add(zd.MenuSectionList,Q)):(0<fc?this.yOe(zd,Q,fc,"MRUAddins",CommonUIStrings.l_MyAddinSection,sc):this.Ra&&this.Ra.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutBannerEnabled",
!1)&&(Q=this.MXh(),Array.add(zd.MenuSectionList,Q),k.ULS.sendTraceTag(509216389,220,50,"Show flyout banner")),Tc&&(this.Inc?(Array.add(zd.MenuSectionList,this.eZh(ad,this.xGa)),Q=[],this.Ytg(Q),appChrome.api.dispatch(Q),this.oob=this.Ky.length<this.xGa?this.Ky.length:this.xGa):this.yOe(zd,ad,cd,"PopularAddins",CommonUIStrings.l_PopularAddins))):(k.ULS.sendTraceTag(509687427,220,10,"store disabled hit"),Q=this.a7e("StoreDisabled",CommonUIStrings.l_AddinPickerDisableError),Array.add(zd.MenuSectionList,
Q));return zd}z4j(){if(!(this.xGa>=this.Ky.length)){var Q=[];for(let Wa=0;Wa<this.xGa;Wa++)this.Vke["PopularAddInsListItem"+Wa]=this.Ky[Wa].solutionId,this.jdk(Q,Wa.toString(),this.Ky[this.oob]),this.oob===this.Ky.length-1?this.oob=0:this.oob++;this.Ytg(Q);appChrome.api.dispatch(Q)}}Ytg(Q){6>this.xGa?Q.push(appChrome.actions.updateControlHiddenState("PopularAddInsListItem5",!0)):Q.push(appChrome.actions.updateControlHiddenState("PopularAddInsListItem5",!1))}eZh(Q,Wa){const Ib=Object.assign(new Dd.a,
{Id:"PopularAddinListSection",ControlsId:"PopularAddinListSection.Controls",ControlList:[],Title:CommonUIStrings.l_PopularAddins});for(let fc=0;fc<0+Wa&&fc<Q.length;fc++)this.Vke.PopularAddInsListItem0=Q[fc].solutionId,this.HXh(Ib.ControlList,fc.toString(),Q[fc]);Q=Object.assign(new Pd,{Id:"SwitchPopularAddIns",ExternalId:"SwitchPopularAddIns",ExternalImageId:"RefreshGreen_20",Command:"152023954",LabelText:CommonUIStrings.l_AddinSwitchText,ShouldTakeFocus:!1,DismissHostingSurfaceOnExecute:!1});Array.add(Ib.ControlList,
Q);return Ib}HXh(Q,Wa,Ib){Wa=this.KPe(Wa,Ib);Array.add(Q,Wa)}jdk(Q,Wa,Ib){Ib=this.KPe(Wa,Ib);const fc={};fc.label=Ib.Label;fc.secondaryLabel=Ib.SecondaryLabel;fc.description=Ib.Description;fc.iconSet=Ib.iconSet;fc.links=Ib.Links;this.Ixd&&(fc.details=Ib.Details);fc.commandValueId=Ib.CommandValueId;fc.actionCommandValueId=Ib.ActionCommandValueId;Q.push(appChrome.actions.updateMultiActionButton("PopularAddInsListItem"+Wa,fc))}KPe(Q,Wa){var Ib="";if(this.Ixd){var fc=Wa.addinInfo.downloadNumber;5E6<=
fc?Ib=(5E6).toLocaleString()+"+":1E3<=fc?(fc=1E3*Math.round(fc/1E3),Ib=fc.toLocaleString()+"+"):Ib=500<=fc?(500).toLocaleString()+"+":100<=fc?(100).toLocaleString()+"+":0<fc?fc.toLocaleString():CommonUIStrings.l_AddinDownloadNewText}fc=[];const sc=[];this.Ixd?(Ib=Object.assign(new hf,{icon:Ib===CommonUIStrings.l_AddinDownloadNewText?null:"download",text:Ib}),Array.add(sc,Ib),Ib=Object.assign(new hf,{text:this.Ra.getStringFeatureGate("Microsoft.Office.SharedOnline.AddinListStoreLabel",CommonUIStrings.l_AddinListStore2),
href:"https://appsource.microsoft.com/en-us/product/office/"+Wa.solutionId}),Array.add(sc,Ib)):(Ib=Object.assign(new ef,{text:CommonUIStrings.l_AddinListPrivacy,href:Wa.privacyUrl}),Array.add(fc,Ib),Ib=Object.assign(new ef,{text:CommonUIStrings.l_AddinListLicense,href:Wa.licenseUrl}),Array.add(fc,Ib),Ib=Object.assign(new ef,{text:CommonUIStrings.l_AddinListStore,href:"https://appsource.microsoft.com/en-us/product/office/"+Wa.solutionId}),Array.add(fc,Ib));Ib={};Ib["default"]="AddinFlyoutControl"+
Wa.solutionId;const Tc=this.S6e(Wa);return Object.assign(new Jf.a,{Id:"PopularAddInsListItem"+Q,ExternalId:"PopularAddInsListItem"+Q,CommandId:"PopularAddInsListItem"+Q,iconSet:Ib,SecondaryLabel:null,Details:sc,Label:Wa.displayName,ActionText:CommonUIStrings.l_AddinListAdd,Description:Wa.description,Links:fc,ActionId:"PopularAddInsListItemAdd"+Q,ActionCommandValueId:Tc,CommandValueId:Tc})}S6e(Q){return this.Tnc?String.format("{0}#{1}",Q.solutionId,Q.storeId):Q.solutionId}u7a(Q){if(!Q)return null;
var Wa=Q.split("#");if(1!==Wa.length&&2!==Wa.length)return k.ULS.sendTraceTag(508912466,220,10,"GetAddinDetailByUniqueId: uniqueId's format is wrong"),null;Q=Wa[0].trim();Wa=2===Wa.length?Wa[1].trim():Zd.AFrameworkApplication.uiCulture;return this.elb.nAb(Q,Wa)}JFe(Q){if(!(Q.solutionId in this.gRc)){const Wa="AddinGalleryButton"+this.uge.toString();this.gRc[Q.solutionId]=Wa;Q=this.S6e(Q);this.TYb[Wa]=Q;this.TYb[Wa+"Add"]=Q;this.uge++}}Xff(Q){return Q?this.TYb[Q]:null}MXh(){const Q=Object.assign(new Dd.a,
{Id:"BannerSection",ControlsId:"BannerSection.Controls",ControlList:[]}),Wa=Object.assign(new Af.a,{Id:"AddInFlyoutBanner",ExternalId:"AddInFlyoutBanner",LabelText:this.Ra.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableConfigBannerUIString",CommonUIStrings.l_AddinBannerText),IconName:"FlyoutBannerCommon",IsBanner:!0});Array.add(Q.ControlList,Wa);return Q}a7e(Q,Wa){const Ib=Object.assign(new Dd.a,{Id:"ErrorSection",ControlsId:"ErrorSection.Controls",ControlList:[]});Q=Object.assign(new he.a,
{Id:"ErrorView",ExternalId:"ReloadAddInPicker",IconName:Q,Label:Wa,RetryButtonTitle:CommonUIStrings.l_AddinPickerTryAgain,OnRetryCommandId:"ReloadAddInPicker",AriaDescription:"StoreDisabled"===Q?Wa:CommonUIStrings.l_AddinPickerTryAgainAriaLabel});Array.add(Ib.ControlList,Q);return Ib}i2g(Q,Wa){var Ib=new d.a;for(let fc=0;fc<Q.length;fc++)Ib.add(Q[fc]);this.Ky||(8<Ib.count&&(Ib=this.Fij(Ib)),this.Ky=Ib.toArray());for(Q=0;Q<this.Ky.length;Q++)for(Ib=0;Ib<Wa.length;Ib++)if(this.Ky[Q].solutionId.toLowerCase()===
Wa[Ib].solutionId.toLowerCase()){Array.remove(this.Ky,this.Ky[Q--]);break}return this.Ky}j2g(Q,Wa){var Ib=new d.a;for(let fc=0;fc<Q.length;fc++)Ib.add(Q[fc]);this.Ky||(8<Ib.count&&(Ib=this.Gij(Ib)),this.Ky=Ib.toArray());for(Q=0;Q<this.Ky.length;Q++)for(Ib=0;Ib<Wa.length;Ib++)if(this.Ky[Q].solutionId.toLowerCase()===Wa[Ib].solutionId.toLowerCase()){Array.remove(this.Ky,this.Ky[Q--]);break}return this.Ky}yOe(Q,Wa,Ib,fc,sc,Tc=!1){const ad=Object.assign(new Dd.a,{Id:fc+"Section",ControlsId:fc+"Section.Controls",
ControlList:[]});fc=Object.assign(new Ne.a,{Id:fc+"GalleryControl",ExternalId:fc+"GalleryControl",GalleryStyle:this.p7h(),Width:3,Type:4,GallerySections:[]});Array.add(Q.MenuSectionList,ad);Array.add(ad.ControlList,fc);Q=this.Qjj(sc,Wa,Ib);Tc&&Array.add(Q.GalleryButtons,this.pZh());fc.GallerySections.push(Q)}Ujj(Q){if(Q)try{Q.MenuItems=this.Pci()}catch(Wa){k.ULS.sendTraceTag(509687425,220,10,"GetReactGalleryMenu hit exception "+(Wa?Wa.toString():""))}else k.ULS.sendTraceTag(509687424,220,10,"PopulateMenu menuProps is null")}dispose(){}iRi(){if(!this.Lge&&
this.SCc){var Q=appChrome.selectors.getSelectedTabId();Q&&af.a(Q,"Home")&&((Q=document.getElementById("InsertAddInFlyout"))&&"none"!==window.getComputedStyle(Q,"").display||k.ULS.sendTraceTag(509368032,344,15,"Addin button is in overflow"),this.Lge=!0)}}get SCc(){return!!window.appChrome&&!!appChrome.selectors}}Object(e.a)(Jc,"AppsFlyoutGenerator",null,[2]);var vd=a(72),Gf=a(100),bg=a(149),sg=a(35);class og{constructor(Q,Wa,Ib,fc,sc,Tc,ad=null){this.disposed=!1;this.f5b=null;this.zsb=0;this.drf=this.f0d=
!1;this.kVh=1E3;this.pVh="AddinFlyoutFeedbackSurvey";this.qVh=15E3;this.M_d=!0;this.nki=(cd,zd)=>{if(cd){if(cd=this.u7a(cd))cd={["solutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(cd.solutionId,cd.storeType,cd.assetId,cd.storeId)},cd.href=zd,cg.a.sendTelemetryEvent(Object.assign(new Pf.a,{name:"Office.Extensibility.Host.AddInListLinkClickedFromFlyout",dataFields:Na.a.Wj(cd)}))}else k.ULS.sendTraceTag(509089754,220,10,"Unique id is null.")};this.Pli=cd=>{if(this.Mba.Tnc){cd=this.u7a(cd);if(!cd){k.ULS.sendTraceTag(508872144,
220,10,"Fail to get a valid AddinDetail with provided unique id.");return}cd=cd.WTb()}else cd=this.bbf(cd);if(cd){var zd={[Gb.a.Dja]:cd,[Hg.a.Og]:this.ze.owa(cd)},Qd=new jh.a(-741808261,0,this.$.Tc,0,"");this.$.Ia.mc(Qd,zd);this.ze.gLb("installAddinFromFlyout",OSF.AgaveHostAction.ClickTrust,cd);cd={["solutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(cd.solutionId,cd.storeType,cd.assetId,cd.storeId)};cg.a.sendTelemetryEvent(Object.assign(new Pf.a,{name:"Office.Extensibility.Host.InstallPopularAddinFromFlyoutListView",
dataFields:Na.a.Wj(cd)}))}else k.ULS.sendTraceTag(509362325,220,10,"Get add-in entitlement fails.")};this.kif=cd=>{if(cd)if(cd=this.u7a(cd)){var zd=this.ze.Xf;zd=zd?zd.getAppUILocale()||"en-US":"en-US";this.f5b=new Pc(cd.solutionId,"wac_excel",zd,Qd=>{this.ze.gLb("installAddinFromFlyout",OSF.AgaveHostAction.ClickTrust,Qd);const Ae=new jh.a(-741808261,0,this.$.Tc,0,null);this.$.Ia.mc(Ae,{[Gb.a.Dja]:Qd,[Hg.a.Og]:this.ze.owa(Qd)});this.f5b&&this.f5b.hide();z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PopularAddinInstalledTelemetryEnabled",
!0)&&(Qd=Telemetry.PrivacyRules.GetPrivacyCompliantId(Qd.solutionId,Qd.storeType,Qd.assetId,null,null,Qd.storeId),cg.a.sendTelemetryEvent(Object(Xc.a)(new Pf.a,{name:"Office.Extensibility.Host.InstallPopularAddinFromFlyout",dataFields:Na.a.Wj({SolutionId:Qd})})))});this.f5b.initializeAndShow("",null,null)}else k.ULS.sendTraceTag(508872143,220,10,"Can not find a valid addinDetail with provided unique id.");else k.ULS.sendTraceTag(509362328,220,10,"Unique id is null.")};this.Tli=cd=>{if(cd){if(this.Mba.Tnc){cd=
this.Mba.Xff(cd);if(!cd){k.ULS.sendTraceTag(508872142,220,10,"Can not find a valid uniqueId with control id.");return}cd=this.Mba.u7a(cd);if(!cd){k.ULS.sendTraceTag(508872141,220,10,"Can not find a valid addinDetail with provided unique id");return}cd=cd.WTb()}else{cd=this.Mba.nkh[cd];if(!cd){k.ULS.sendTraceTag(509362326,220,10,"SolutionId is null.");return}cd=this.bbf(cd);if(!cd){k.ULS.sendTraceTag(509089755,220,10,"Get add-in entitlement fails.");return}}var zd={[Gb.a.Dja]:cd,[Hg.a.Og]:this.ze.owa(cd)},
Qd=new jh.a(-741808261,0,this.$.Tc,0,"");this.$.Ia.mc(Qd,zd);z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MRUAddinInstalledTelemetryEnabled",!0)&&(cd=Telemetry.PrivacyRules.GetPrivacyCompliantId(cd.solutionId,cd.storeType,cd.assetId,null,null,cd.storeId),cg.a.sendTelemetryEvent(Object(Xc.a)(new Pf.a,{name:"Office.Extensibility.Host.InstallMRUAddinFromFlyout",dataFields:Na.a.Wj({SolutionId:cd})})))}else k.ULS.sendTraceTag(509362327,220,10,"Control id is null.")};this.u7a=cd=>
this.Mba.Tnc?this.Mba.u7a(cd):this.Bba.nAb(cd);this.p1i=(cd,zd)=>{if(zd)if(zd)if(cd=zd.El){if(uh()||mh()){const Ae=this.$.ea.workbookContext.WebExtensions;if(Ae){let Oe=!1;for(var Qd of Ae)if(Qd.PrimaryMarketplace.SolutionId.toLowerCase()===cd.solutionId.toLowerCase()){Oe=!0;break}if(!Oe){k.ULS.sendTraceTag(512258444,220,15,"Not find add-in persisted in the template file.");return}}else{k.ULS.sendTraceTag(512258443,220,15,"Has no add-in persisted in the file.");return}}zd=zd.gp;Qd=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();
if(cd.solutionId in Qd)zd=Qd[cd.solutionId];else if(zd=this.q3h(zd),void 0===zd||null===zd){k.ULS.sendTraceTag(528098434,220,15,"addinCommandControlId is NullOrUndefined");return}Qd=new jh.a(zf.a.Y4,0,0,2,null);this.executeCommand(0,Qd,{["SourceControlId"]:zd},null);cd.isAutoLaunched=!0}else k.ULS.sendTraceTag(528098435,220,15,"insertionParam is null");else k.ULS.sendTraceTag(528098436,220,15,"agaveParams is null");else k.ULS.sendTraceTag(528098437,220,15,"No args for OnAutoLaunchAddin event")};this.ynf=
(cd,zd)=>{"Insert"==zd.tabName&&(cd=this.$.Ia,null!=cd&&(cd.G5f(this.ynf),k.ULS.sendTraceTag(527286662,220,50,"Remove insertTabSwitched handler")),this.ETb.NZj())};this.a9i=(cd,zd)=>{cd=null;zd&&(cd=zd);(null===cd||void 0===cd?0:cd.gp)&&this.gQj(cd.gp);this.$.ig();cd&&cd.El&&this.G4g(cd.El)};this.idk=(cd,zd)=>{zd.wI===ba.a.myAddins&&(this.zsb|=1);zd.wI===ba.a.adminManaged&&(this.zsb|=2);this.Ogg()&&appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("InsertAddInFlyout",!1))};
this.$=Q;k.ULS.shipAssertTag(537170659,0,!(void 0===Wa||null===Wa),`AddinUICommandHandler constructor error - ddaFacade param should not be null, stack: ${Lb.a.J_()}`);this.ze=Wa;this.wNe=Ib;this.b5b=fc;this.Aba=sc;this.Bsb=Tc;this.cq=new ti.a;this.Cja=new pe;this.hid=ad;ha.a.iDb=ha.a.f2e;this.idd=new d.a;this.C5a=new d.a;this.r3c&&(this.f0d=Zd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowFlyoutSurveyEnabled",!1),this.Bba=this.ze.Bba,null!==this.Bba?(this.Mba=
new Jc(Zd.AFrameworkApplication.dc,this.Bba,zf.a.Eqc.toString(),zf.a.Jqc.toString(),"1296389134",Zd.AFrameworkApplication.fa),this.Bba.Ifb(this.idk)):k.ULS.sendTraceTag(509362330,220,10,"addinDetailsProvider is null"))}get r3c(){return Zd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)&&Zd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)}dispose(){void 0!==this.Bsb&&null!==
this.Bsb&&(this.Bsb.dispose(),this.Bsb=null);this.ze=this.$=null;this.disposed=!0}wUj(Q,Wa){switch(Q){case zf.a.Y4:Q=this.fUj(Wa);break;default:Q=!1}return Q}yd(Q,Wa){return 619219938===Wa?!this.Ogg():!1}executeCommand(Q,Wa,Ib){Q=Wf.TaskExtensions.Ik();Wa=Wa.command;switch(Wa){case 843847158:break;case zf.a.Eqc:this.Tfb();Ib=Ib.SourceControlId;if(!Ib){k.ULS.sendTraceTag(509362329,220,10,"Control id is null.");break}this.kif(this.Mba.Xff(Ib));break;case zf.a.VBd:this.Tfb();Wa=Ib.CommandValueId;"LinkClickedPayload"===
Ib.Type?this.nki(Wa,Ib.Href):this.kif(Wa);break;case zf.a.r3d:this.Tfb();this.Mba.z4j();break;case zf.a.Sud:this.Tfb();this.Pli(Ib.CommandValueId);break;case zf.a.Jqc:this.Tfb();this.Tli(Ib.SourceControlId);break;case -2025863019:rc.a.d0d(Ib[Gb.a.q3c].toString(),()=>{dc.h(this.$).focus()});break;case -1777565636:se.a.showUILessDialog(Ib[Gb.a.Dsb].toString());this.ze.HXj(Ib[Gb.a.Dsb].toString());break;case 1592314317:se.a.hideUILessDialog(Ib[Gb.a.Dsb].toString());this.ze.Api(Ib[Gb.a.Dsb].toString());
break;case zf.a.Y4:Q=this.Sqd(Ib);break;case zf.a.KHb:this.LHb(Ib);break;case zf.a.mH:this.Znj(Ib);break;case zf.a.Ypa:this.Ypa(Ib);break;case zf.a.dFc:this.Bsb.tFc();break;case zf.a.refreshAddinCommands:this.dtj();break;case 1949669462:this.Aba.vdg(!0);break;case -1014260128:Q=this.executeDynamicAddInCommandsAPI(Ib);break;case zf.a.Ijb:this.Ijb();break;default:Q=ab.a(Wa)}return Q}fd(Q,Wa,Ib){Q=!1;switch(Wa.command){case zf.a.VBd:case zf.a.r3d:case zf.a.Sud:case zf.a.Eqc:case zf.a.Jqc:Q=!!Ib;break;
case 843847158:case -2025863019:case -1777565636:case 1592314317:case zf.a.mH:case zf.a.Ypa:case zf.a.dFc:case zf.a.refreshAddinCommands:case 1949669462:case zf.a.KHb:case -1014260128:case zf.a.Ijb:Q=!0;break;case zf.a.Y4:Q=!Zd.AFrameworkApplication.protectedFile}return Q}Ogg(){return 0!==this.zsb&&this.$.nV&&!z.EwaSettings.ya(174)}Cd(Q,Wa,Ib){switch(Wa){case "PopulateAddInGallery":return z.EwaSettings.isChangeGateEnabled("OfficeVSO:7653071_PopulateAddInGalleryTelemetryEnabled")&&cg.a.sendTelemetryEvent(Object(Xc.a)(new Pf.a,
{name:"Office.Extensibility.Host.PopulateAddinGallery",dataFields:Na.a.Wj({})})),this.Mba.Ujj(Ib),this.f0d&&(this.Tfb(),this.tMi()),!0;default:return!1}}tMi(){Hb.a.instance.getItem("AddinFlyoutSurveyShowed")&&(this.M_d=!1);this.M_d&&(window.setTimeout(()=>{let Q=this.eaf();Q&&"hidden"!==Q.visibility&&(this.drf=!0)},this.kVh),this.Iwj=window.setTimeout(()=>{this.lng=fd.a.instance.Dc("Common.ISystemInitiatedFeedback");this.drf&&this.lng&&this.lng.execute(Q=>{let Wa=this.eaf();Wa&&"hidden"===Wa.visibility&&
(Q.sib(this.pVh,null),this.M_d=!1,Hb.a.instance.setItem("AddinFlyoutSurveyShowed","1"))})},this.qVh))}eaf(){let Q=null;try{const Wa=document.getElementById("Ribbon-InsertAddInFlyoutDropdown");Wa&&(Q=Bc.a.DA(Wa.parentNode.parentNode.parentNode))}catch(Wa){k.ULS.sendTraceTag(508911886,220,10,"AddinFlyout get parent and parent get exception "+(Wa?Wa.toString():""))}return Q}Tfb(){this.f0d&&window.clearTimeout(this.Iwj)}q3h(Q){if(!Q)return k.ULS.sendTraceTag(528098432,220,10,"Failed to get button id for addin"),
null;if((Q=Q.NX)&&Q.yu&&0<Q.yu.count)for(let Wa of Q.yu){if(Wa.groups&&1===Wa.groups.length){Q=Wa.groups[0];if(Q.controls&&1===Q.controls.length){const Ib=Q.controls[0];if(Ib.attributes&&!Ib.controlType&&Ib.enabled)return Ib.id}Q.controls&&k.ULS.sendTraceTag(528098403,220,15,"It has multiple buttons")}Wa.groups&&k.ULS.sendTraceTag(528098402,220,15,"It has multiple groups")}return null}Znj(Q){Q&&Gb.a.g5 in Q?this.mH(Q[Gb.a.g5],!0):k.ULS.sendTraceTag(509686151,220,10,"queryAddinDetailsWithActionData: invalid actionData.")}mH(Q,
Wa=!1){this.ze?(k.ULS.sendTraceTag(509686149,220,50,"QueryAddinDetails: providerType: {0}, refreshRequired: {1}",Q,Wa),this.ze.mH(Q,Wa)):k.ULS.sendTraceTag(509686150,220,10,"QueryAddinDetails: abort because ddaFacadeService is null..")}dtj(){if(this.Aba.drc()){this.Aba.QJe();var Q=this.xld();if(Q&&0<Q.count)for(let Wa of Q)Q={[Gb.a.g5]:Wa,[Gb.a.f_]:4,[Gb.a.qJa]:(new Date).getTime()},this.Ypa(Q)}else Zd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",
!1)&&(k.ULS.sendTraceTag(509686148,220,50,"refreshAllAddinCommands: LoadingCompleteForAllProviders() returns {0}",this.Aba.drc()),this.mH(10,!0),this.mH(0,!0))}Ypa(Q){k.ULS.sendTraceTag(537170657,220,50,`Launch AddinCommands entitlements list, LaunchOperationType ${Q[Gb.a.f_]}, DataProvider ${Q[Gb.a.g5]}.`);this.Aba.cMj();window.setTimeout(()=>{if(void 0===this.ze||null===this.ze)k.ULS.sendTraceTag(537170656,220,10,`AddinUICommandHandler RetrieveAddInCommandsEntitlementsList error - DdaFacadeService should not be null, stack: ${Lb.a.J_()}`);
else{const Wa=new ph(new Ug(this.ze.Xf),$g.instance,eh.instance);Wa.aWg((Ib,fc)=>{Zd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.mH(Q[Gb.a.g5]);this.LHb(fc.properties)});Zd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&Wa.vZg((Ib,fc)=>{null==fc?cg.a.sendTelemetryEvent(Object(Xc.a)(new Pf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Na.a.Wj({["AppTeachingUICalloutAction"]:"InvalidEventArgs",
["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"})})):(this.ETb=new Tg(this),this.ETb.ovj(fc),Ib=this.$.Ia,null!=Ib&&(Ib.nze(this.ynf),k.ULS.sendTraceTag(527286663,220,50,"Register tab switched event")))});Wa.Rak(Q)}},0)}Ijb(){if(this.ozi)if(void 0===this.ze||null===this.ze)k.ULS.sendTraceTag(509686154,220,10,"DdaFacadeService should not be null");else{const Q=new Ff(this.ze.Xf);Q.VXg(()=>{this.YBd()});Q.F5d()}}get ozi(){return!z.EwaSettings.ya(174)&&this.$.ea.Dh.get(27)&&
this.$.nV}YBd(){const Q=document.getElementById("InsertAddInFlyout");if(null===Q||void 0===Q||"none"===window.getComputedStyle(Q).display){const Wa=document.getElementById("RibbonOverflowMenu-overflow");null!=Wa?(Wa.onclick=function(){const Ib=new Rc.a(0,1,500,()=>{const fc=document.getElementsByName("Add-ins")[0];null!=fc&&(fc.click(),k.ULS.sendTraceTag(509445257,341,50,"Launch flyout in overflow"))});Zd.AFrameworkApplication.Xi.wg(Ib);Wa.onclick=function(){}},Wa.click()):k.ULS.sendTraceTag(509677591,
220,10,"Cannot find flyout button on ribbon or overflow button")}else Q.click(),k.ULS.sendTraceTag(509677590,220,50,"Launch flyout")}LHb(Q){if(!this.disposed){k.ULS.sendTraceTag(537170655,220,50,`LaunchOperationType ${Q[Gb.a.f_]}.`);try{if(z.EwaSettings.ya(174)){const Ib=Q[Gb.a.Asb];if(Ib&&0<Ib.count){const fc=Ib.count;for(let sc=fc-1;0<=sc;sc--){const Tc=Ib.ma(sc);OSF.OsfControl.isFirstPartyStoreString(Tc.storeType)||Ib.remove(Ib.ma(sc))}if(Ib.count<fc){const sc=Object(vd.b)("OfficeVSO:7624544_ConvertBusinessBarManagerService")?
Object(Gf.d)(bg.a.resolve(sg.h,{Wa:0})):Kg.GetServiceTaskFactory.Za(this.$.da,5,4,0);Wf.TaskExtensions.za(sc,()=>{sc.result.oh(36,null)},this.$.ka,3)}if(!Ib.count)return}}if(void 0===this.ze||null===this.ze)k.ULS.sendTraceTag(537170654,220,10,`LaunchAddinCommands error - this.DdaFacadeService should not be null, stack: ${Lb.a.J_()}`);else{var Wa=null;Wa=Zd.AFrameworkApplication.fa.ra("HostInstallAddInsIsEnabled")?new jf(this.cq,this.wNe,new Ug(this.ze.Xf),new ci(this.$.qc,zf.a.Y4),this.Aba,$g.instance,
this.Cja,(Ib,fc)=>{const sc={};sc.InstanceId=qd.a.create().toString();sc.PrimaryMarketplace={};sc.PrimaryMarketplace.SolutionId=Ib.solutionId;sc.PrimaryMarketplace.SolutionVersion=Ib.version;sc.PrimaryMarketplace.MarketplaceType=Ib.storeType;sc.PrimaryMarketplace.MarketplaceRef=Ib.storeId;sc.WebExtensionType=1;this.ze.VZj(sc,()=>{fc(Ib)})}):new jf(this.cq,this.wNe,new Ug(this.ze.Xf),new ci(this.$.qc,zf.a.Y4),this.Aba,$g.instance,this.Cja);Wa.iWg(this.p1i);Wa.bWg(this.a9i);if(Zd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",
!1)){const Ib=new Tg(this);Wa.UXg(Ib.$8i);Wa.uZg(Ib.uXj)}this.$.da.Ba(53).xq&&Td.a.get_instance().Fj(5,null).continueWith(()=>{this.disposed||Wa.YMi(this.hid,this.$.domElement,Q)})}}catch(Ib){k.ULS.sendTraceTag(537170653,220,10,`LaunchAddinCommands error message : ${Ib.message}.`)}}}Sqd(Q){const Wa=Wf.TaskExtensions.Ik();Q=Q[this.cq.Eka];const Ib=this.b5b.O0c(Q),fc=new se.a(this.$,this.ze,Ib.ownerAddinInfo,Wa);return this.mhf(Wa,Q,Ib,fc)}mhf(Q,Wa,Ib,fc){this.b5b.Sqd(Wa,this.Aba,fc,new Ug(this.ze.Xf),
Ib,()=>{Q=fc.rjh()},()=>{dc.h(this.$).focus()});return Q}G4g(Q){const Wa=Wf.TaskExtensions.Ik();var Ib=this.ze.rda(Q.solutionId);if(Ib){var fc=this.ze.rW(Ib);if(ua.HelperMethods.Vx(fc)&&0!==fc.SharedRuntime.State)return}fc=this.b5b.H4g;const sc=Q.solutionId in fc?fc[Q.solutionId]:null;if(sc){const Tc=this.b5b.O0c(sc),ad=new se.a(this.$,this.ze,Tc.ownerAddinInfo,Wa),cd=Telemetry.PrivacyRules.GetPrivacyCompliantId(Q.solutionId,null!==Tc.ownerAddinInfo?Tc.ownerAddinInfo.storeType:Q.storeType,Q.assetId,
null,null,Q.storeId);fc=zd=>{if(zd){const Qd={};for(const Ae of zd)Qd[Ae[0]]=Ae[1];(zd=Gb.a.uze in Qd?Qd[Gb.a.uze]:null)&&"true"===zd.toLowerCase()&&(k.ULS.sendTraceTag(537170652,220,50,`Auto-Show AddinCommands TaskPane, StoreType ${Q.storeType}, StoreId ${Q.storeId}, SolutionId ${cd}.`),this.mhf(Wa,sc,Tc,ad))}};k.ULS.sendTraceTag(537170651,220,50,`Check Auto-Show AddinCommands TaskPane, StoreType ${Q.storeType}, StoreId ${Q.storeId}, SolutionId ${cd}.`);if(Ib)fc(this.ze.rW(Ib).OsfPropertyBag);else if(Ib=
this.$.ea.workbookContext.WebExtensions)for(const zd of Ib)if((1===zd.WebExtensionType?OSF.OsfControlTarget.TaskPane:OSF.OsfControlTarget.InContent)===Q.targetType&&zd.PrimaryMarketplace.MarketplaceType.toLowerCase()===Q.storeType.toLowerCase()&&zd.PrimaryMarketplace.MarketplaceRef.toLowerCase()===Q.storeId.toLowerCase()&&zd.PrimaryMarketplace.SolutionId.toLowerCase()===Q.solutionId.toLowerCase()){fc(zd.OsfPropertyBag);break}}}w3d(Q,Wa,Ib=!1){Q&&(!Ib||Wa||this.idd.contains(Q)||this.idd.add(Q),(Ib=
this.C5a.contains(Q))&&Wa&&this.C5a.remove(Q),Ib||Wa||this.C5a.add(Q))}gQj(Q){if((Q=Q.NX)&&Q.yu)for(let Wa of Q.yu)if(Wa.groups)for(const Ib of Wa.groups)if(Ib.controls)for(const fc of Ib.controls)if(this.w3d(fc.id,fc.enabled,!0),1===fc.controlType&&fc.menuItems)for(const sc of fc.menuItems)this.w3d(sc.id,sc.enabled,!0)}xld(){const Q=new d.a;z.EwaSettings.ya(52)&&(this.$.ea.Dh.get(27)&&(Q.add(0),Q.add(16)),this.$.ea.Dh.get(33)&&Q.add(1),Q.add(8));return Q}executeDynamicAddInCommandsAPI(Q){let Wa=
!0;if(void 0===Q||null===Q||void 0===Q[Gb.a.iyb]||null===Q[Gb.a.iyb])return Dc.Task.Ua(!1);switch(Q[Gb.a.iyb]){case 1:Wa=this.eek(Q);break;case 2:Wa=this.kQj(Q);break;case 4:this.C5a.clear();this.C5a.addRange(this.idd);break;case 3:Wa=this.installContextualTab(Q);break;default:Wa=!1}return Dc.Task.Ua(Wa)}fUj(Q){return Q&&this.cq.Eka in Q?(Q=Q[this.cq.Eka])?this.C5a.contains(Q):!1:!1}eek(Q){var Wa=null;let Ib=null,fc=null,sc=!0;void 0!==Q[Gb.a.v6]&&null!==Q[Gb.a.v6]&&void 0!==Q[this.cq.Eka]&&null!==
Q[this.cq.Eka]&&void 0!==Q[Gb.a.u6]&&null!==Q[Gb.a.u6]&&(Wa=Q[Gb.a.v6],Ib=Q[Gb.a.Vcc],fc=Q[this.cq.Eka],sc=Q[Gb.a.u6]);if(!Wa||!fc)return k.ULS.sendTraceTag(537170649,220,15,"UpdateControlEnableState failed to get solutionId or controlId."),!1;Q=(new ih.a(this.$.qc,Wa,this.cq,!0)).JNa(fc);Wa={DynamicAddinCommandsApiName:"UpdateControlEnableState"};Wa.AssetId=Ib;Wa.MaskedTabId=Q;Wa.IsToEnable=sc;k.ULS.sendTraceTag(537170648,220,50,u.a.nd(Wa));this.w3d(Q,sc);N.a.PF.updateCommandUI();return!0}kQj(Q){var Wa,
Ib,fc=null,sc=null;let Tc=null;var ad=null;let cd=!0;void 0!==Q[Gb.a.Oed]&&null!==Q[Gb.a.Oed]&&void 0!==Q[Gb.a.v6]&&null!==Q[Gb.a.v6]&&void 0!==Q[this.cq.Eka]&&null!==Q[this.cq.Eka]&&void 0!==Q[Gb.a.u6]&&null!==Q[Gb.a.u6]&&(fc=Q[Gb.a.Oed],sc=Q[Gb.a.v6],Tc=Q[Gb.a.Vcc],ad=Q[this.cq.Eka],cd=Q[Gb.a.u6]);if(!fc||!sc||!ad)return k.ULS.sendTraceTag(537170647,220,15,"SetRibbonTabVisible failed to get storeType or solutionId or tabId."),!1;Q=(new ih.a(this.$.qc,sc,this.cq,!0)).rff(ad);ad={DynamicAddinCommandsApiName:"SetRibbonTabVisible"};
ad.StoreType=fc;ad.AssetId=Tc;ad.MaskedTabId=Q;ad.IsToShow=cd;k.ULS.sendTraceTag(537170646,220,15,u.a.nd(ad));fc=this.Aba.Gla(fc,sc,1);sc=!1;if(null===(Ib=null===(Wa=null===fc||void 0===fc?void 0:fc.gp)||void 0===Wa?void 0:Wa.NX)||void 0===Ib?0:Ib.yu)for(let zd of fc.gp.NX.yu)if(zd.id===Q){sc=!0;break}if(!sc)return k.ULS.sendTraceTag(537170645,220,15,"SetRibbonTabVisible failed to get contextual tabs"),!1;Wa=[];cd?appChrome.selectors.getSelectedTabId()!==Q&&Wa.push(appChrome.actions.activateRibbonTab(Q)):
(appChrome.selectors.getSelectedTabId()===Q&&Wa.push(appChrome.actions.setCurrentTab(Wd.a.yP)),Wa.push(appChrome.actions.deactivateRibbonTab(Q)));appChrome.api.dispatch(Wa);return!0}bbf(Q){if(this.Bba){if(Q=this.Bba.nAb(Q)){const Wa={};Wa.solutionId=Q.solutionId;Wa.version=Q.version;Wa.storeType=Q.storeType;Wa.storeId=Q.storeId;Wa.assetId=Q.assetId;Wa.assetStoreId=Q.assetStoreId;Wa.targetType=Q.targetType;Wa.displayName=Q.displayName;Wa.width=Q.width;Wa.height=Q.height;return Wa}k.ULS.sendTraceTag(509362324,
0,10,"Get addinDetail fail.");return null}k.ULS.sendTraceTag(509362323,0,10,"No addinDetailManager instance.");return null}installContextualTab(Q){let Wa=null,Ib=null,fc=null;var sc=null;if(void 0!==Q[Gb.a.v6]&&null!==Q[Gb.a.v6]&&void 0!==Q[Gb.a.u6]&&null!==Q[Gb.a.u6]){const Tc=Q[Gb.a.u6];Wa=Q[Gb.a.v6];void 0!==Tc[Gb.a.jMa]&&null!==Tc[Gb.a.jMa]&&void 0!==Tc[Gb.a.kMa]&&null!==Tc[Gb.a.kMa]&&(Ib=Tc[Gb.a.jMa],fc=Tc[Gb.a.kMa],sc=Tc[Gb.a.Ped])}if(!(Wa&&fc&&Ib&&sc))return k.ULS.sendTraceTag(537170644,220,
15,"InstallContextualTab failed to invalid parameters"),!1;Q=this.Aba.Gla(sc.PrimaryMarketplace.MarketplaceType,sc.PrimaryMarketplace.SolutionId,1);if(null===Q||void 0===Q?0:Q.gp)return k.ULS.sendTraceTag(537170643,220,15,"InstallContextualTab was called multiple times"),!1;Q={};Q.solutionId=sc.PrimaryMarketplace.SolutionId;Q.version=sc.PrimaryMarketplace.SolutionVersion;Q.storeType=sc.PrimaryMarketplace.MarketplaceType;Q.storeId=sc.PrimaryMarketplace.MarketplaceRef;sc.AssetMarketplace?(Q.assetId=
sc.AssetMarketplace.SolutionId,Q.assetStoreId=sc.AssetMarketplace.MarketplaceRef):(Q.assetId=null,Q.assetStoreId=null);Q.targetType=sc.WebExtensionOsfControlType;Q.width=sc.TaskpaneWidth;Q.height=0;Q.isAddinCommands=!0;sc=new d.a;sc.add(Q);Q={};Q[Gb.a.Asb]=sc;Q[Gb.a.f_]=6;Q[Gb.a.jMa]=Ib;Q[Gb.a.kMa]=fc;this.LHb(Q);return!0}}Object(e.a)(og,"AddinUICommandHandler",null,[208,210,2]);var lh=a(66);class Dh{constructor(Q=null,Wa=null,Ib=null,fc=0){this.b_d=Q;this.U0c=Wa;this.Ycd=Ib;this.bzb=fc}Vhb(){return this.b_d()}activate(){return this.U0c()}deactivate(){this.Ycd()}dispose(){this.Ycd=
this.U0c=this.b_d=null}}Object(e.a)(Dh,"FeatureActivator",null,[20,2]);var Rh=a(21),ri=a(18);class Nh extends Sd.a{constructor(Q){super(Q);this.handler=null;this.NRg=()=>{k.ULS.sendTraceTag(38410434,0,50,`AddinUICommandHandlerFactory.ActivateFeature, isEditMode [${this.$.isEditMode}] ShowCommandUI [${!!(this.$.oe&16384)}]`);const Wa=new Fd.a;this.$.da.Qb(53,Qd=>{k.ULS.sendTraceTag(38410435,0,50,"AddinUICommandHandlerFactory.ActivateFeature success to get service IRibbonManager");Wa.setResult(Qd)});
const Ib=Wa.task,fc=new Ld,sc=le.a.getInstance(),Tc=new rg(this.$,sc),ad=Kg.GetServiceTaskFactory.create(this.$.da,203,this.ka,this.La),cd=this.Ltj(fc),zd=Object(vd.b)("OfficeVSO:7624847_MigrateOAuthToNewServiceInfra")?Object(Gf.d)(bg.a.resolve(sg.ib,{Wa:this.La})):Kg.GetServiceTaskFactory.Za(this.$.da,349,350,this.La);return Wf.TaskExtensions.za(Wf.TaskExtensions.xe([Ib,ad,cd,zd],this.ka),()=>{k.ULS.sendTraceTag(38942482,0,50,"AddinUICommandHandlerFactory.ActivateFeature, ContinueWith after realated task finished.");
Wf.TaskExtensions.za(Kg.GetServiceTaskFactory.create(this.$.da,106,this.ka,this.La),Qd=>{this.handler=new og(this.$,Qd.result,fc,new Gc,sc,Tc,fd.a.instance.nh("Common.IExternalUICommandDefinitionMapping"));k.ULS.sendTraceTag(38410436,0,50,"AddinUICommandHandlerFactory.ActivateFeature, OnCommandHandlersCreated");this.Zd([this.handler]);this.$.da.Ja(198,this.handler)},this.ka,3)},this.ka,3)};this.Euh=()=>{void 0!==this.handler&&null!==this.handler?(this.$.Ia.Rfb(this.handler),this.$.da.XV(198),this.handler=
null):k.ULS.sendTraceTag(42341715,0,50,"AddinUICommandHandlerFactory.DeactivateFeature: handler is not defined, it might have never been activated.");this.$.da.XV(204);ri.a(Rh.a,20,this.$.da,198)}}ue(){k.ULS.sendTraceTag(38410432,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync");lh.a(this.$).add(Object(Xc.a)(new Dh,{b_d:()=>{const Q=this.$.ea.sJ&&this.$.ea.Oc&&!!(this.$.oe&16384)&&this.$.isEditMode;this.$.ea.Oc&&k.ULS.sendTraceTag(38410433,0,50,`AddinUICommandHandlerFactory.CreateCommandHandlersAsync FeatureActivator: shouldActivate [${Q}] IsSessionFullyLoaded [${this.$.ea.sJ}] IsSessionActive [${this.$.ea.Oc}] ShowCommandUI [${!!(this.$.oe&
16384)}] IsEditMode [${this.$.isEditMode}]`);return Q},U0c:this.NRg,Ycd:this.Euh,bzb:2}))}Ltj(Q){const Wa=Kg.GetServiceTaskFactory.create(this.$.da,102,this.ka,this.La);return Wf.TaskExtensions.za(Wa,()=>{k.ULS.sendTraceTag(38942483,0,50,"AddinUICommandHandlerFactory.RegisterContextMenuExtensibilityService ribbonControlManagerTask finished.");this.$.da.Ja(204,new Xe(Wa.result,Q))},this.ka,3)}static la(Q){Sd.a.Ie(199,new Nh(Q))}}Object(e.a)(Nh,"AddinUICommandHandlerFactory",Sd.a,[]);var Si=a(1251),
cj=a(1255),Fi=a(727);class Yh extends f.a{constructor(Q){super();this.$=Q;this.uc()}create(){let Q;if(z.EwaSettings.ya(355)){const Wa=Kg.GetServiceTaskFactory.create(this.$.da,106,this.$.ka,this.La);let Ib=Object(Gf.d)(bg.a.resolve(sg.Y,{Wa:this.La}));Wf.TaskExtensions.za(Dc.Task.PH(Wa,Ib),()=>{this.$b(Object(Fi.a)(this.$.da,278,()=>new Si.CustomFunctionsInstaller(this.$,Wa.result,Ib.result)))},this.$.ka,3)}else Q=Object(Fi.a)(this.$.da,278,()=>new cj.CustomFunctionsLegacyInstaller(this.$)),this.$b(Q)}static la(Q){Q.da.Ja(279,
new Yh(Q))}}Object(e.a)(Yh,"CustomFunctionsInstallerFactory",f.a,[]);var ii=a(92),ji=a(51),Gg=a(48);class Vh{constructor(Q,Wa){this.PTa=this.QTa=null;this.kqg=(Ib,fc)=>{let sc=null,Tc=null,ad=null;fc?(Object(K.a)(403,fc)?(sc=fc.zJa,ad=fc.instanceId):Object(K.a)(497,fc)&&(sc=fc.get_element(),ad=fc.instanceId),sc)?(Tc=Object(R.a)(739,Ib),Tc)?this.e1f(ad,sc,Tc)||ad in this.PTa||(this.QTa[ad]=0,this.PTa[ad]=ji.a.instance.iE(()=>{10<=this.QTa[ad]||this.e1f(ad,sc,Tc)?(delete this.QTa[ad],this.PTa[ad].dispose(),
delete this.PTa[ad]):this.QTa[ad]+=1},500,Gg.a.M_g,!0,!1)):k.ULS.sendTraceTag(537170624,0,10,"The AgaveOnSelectedReadoutEvent raised from a null object."):k.ULS.sendTraceTag(537170625,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."):k.ULS.sendTraceTag(537170626,0,10,"Invalid parameter for ReadoutSelection")};this.ariaLiveNotifier=Q;this.$=Wa;this.f5c=!1;this.$.da.Ja(224,this)}la(Q){this.f5c?k.ULS.sendTraceTag(537170629,0,10,"The instance AgaveOnSelectedReadoutHandler should not attach multiple times."):
(this.f5c=!0,this.PTa={},this.QTa={},Q?Q.MWg(this.kqg):k.ULS.sendTraceTag(537170628,0,10,"The AgaveOnSelectedReadoutHandler should not attach to a null object."))}detach(Q){if(Q){Q.dyj(this.kqg);Q=this.PTa;for(let Wa in Q)ii.a.Ka(Q[Wa]);this.QTa=this.PTa=null;this.f5c=!1}else k.ULS.sendTraceTag(537170627,0,10,"The AgaveOnSelectedReadoutHandler should not detach from a null object.")}e1f(Q,Wa,Ib){if(this.Ryi(Ib,Q))return!1;Q=Wa.querySelector("iframe");if(!Q)return k.ULS.sendTraceTag(537170595,0,10,
"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;Q=Q.title;if(!Q||!Q.length)return k.ULS.sendTraceTag(537170594,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;this.ariaLiveNotifier.readText(Q);return!0}Ryi(Q,Wa){return(Q=Q.Xf.getOsfControl(Wa))?Q.getPageStatus()!==OSF.OsfControlPageStatus.Ready:!0}}Object(e.a)(Vh,"AgaveOnSelectedReadoutHandler",null,[740]);class ui extends f.a{constructor(Q){super();this.$=Q;this.uc()}create(){const Q=
this.$.da;Wf.TaskExtensions.za(Kg.GetServiceTaskFactory.Za(Q,211,212,this.La),Wa=>{Wa=Q.Ba(224)||new Vh(Wa.result,this.$);this.$b(Wa)},this.ka,3)}static la(Q){Q.da.Ja(225,new ui(Q))}}Object(e.a)(ui,"AgaveOnSelectedReadoutHandlerFactory",f.a,[]);var Ig=a(767),Gi=a(54);const vi=(Q,Wa)=>Gi.a.KCd(67,()=>window.OfficeExtension&&!!window.OfficeExtension.WacRuntime,Zd.AFrameworkApplication.fa.Ae("MaxRetriesForLoadingScript",0),Q,Wa);var Oh=a(251);class ki{constructor(Q,Wa,Ib){this.iframe=Q;this.onSuccess=
Wa;this.onError=Ib;$addHandler(window,"message",Object(ge.a)(this,this.yif,"handleResponse"))}yif(Q){try{if(Q&&Q.rawEvent&&Q.rawEvent.origin&&this.iframe&&this.iframe.id){var Wa=this.hVf(Q.rawEvent.origin);const Ib=this.hVf(document.domain);if(J.a.hh().equals(Ib,Wa))if(Q.rawEvent.source&&Q.rawEvent.source.frameElement&&Q.rawEvent.source.frameElement.id&&J.a.hh().equals(Q.rawEvent.source.frameElement.id,this.iframe.id)){Wa=null;try{Wa=JSON.parse(Q.rawEvent.data)}catch(fc){k.ULS.sendTraceTag(39112971,
344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",fc.message)}Wa?(Wa.statusCode!==Oh.a.xK||void 0!==Wa.error&&Wa.error?(k.ULS.sendTraceTag(23707648,344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",Wa.statusCode,Wa.error),this.onError()):(k.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),this.onSuccess(Wa.authorizationCode?Wa.authorizationCode:
Wa.signInUrl)),$removeHandler(window,"message",Object(ge.a)(this,this.yif,"handleResponse")),this.iframe?document.body.contains(this.iframe)?document.body.removeChild(this.iframe):k.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):k.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):k.ULS.sendTraceTag(575976219,344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else k.ULS.sendTraceTag(51451614,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");
else k.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else k.ULS.sendTraceTag(51418200,344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(Ib){k.ULS.sendTraceTag(23707649,344,10,"Exception in authentication proxy message handler: {0}.",Ib.message)}}hVf(Q){let Wa="";try{Q&&(Wa=-1<Q.indexOf("//")?Q.split("/")[2]:Q.split("/")[0])&&(Wa=Wa.split(":")[0],Wa=Wa.split("?")[0])}catch(Ib){k.ULS.sendTraceTag(51451615,
344,10,"Failed to parse host name from url: {0}",Ib.message)}return Wa}static la(Q,Wa,Ib){new ki(Q,Wa,Ib)}}Object(e.a)(ki,"ResponseHandler",null,[]);var qf=a(265);class fh{constructor(Q){this.MIa=Q}tryAuthenticate(Q,Wa){this.neb(fh.DIg,()=>{Q()},Wa)}tryAuthorize(Q,Wa){this.neb(fh.LDg,Q,Wa)}getSignInUrl(Q,Wa){this.neb(fh.Mre,Q,Wa)}signOut(Q,Wa){this.neb(fh.FOg,Q,Wa)}neb(Q,Wa,Ib){var fc=new qf.QueryStringBuilder("AuthenticationProxyHandler.aspx");fc.Tj("responseType",Q);Zd.AFrameworkApplication.o1a(fc);
fc=String.format("{0}{1}&{2}",this.MIa,fc.toString(),Zd.AFrameworkApplication.oj);const sc=document.createElement("iframe");sc.setAttribute("id","privateCatalogIframe");sc.setAttribute("name","privateCatalogIframe");sc.setAttribute("style","display: none");J.a.hh().equals(Q,fh.Mre)||sc.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");ki.la(sc,Wa,Ib);sc.setAttribute("src",fc);document.body.appendChild(sc)}}fh.LDg="authcode";fh.DIg="identitytoken";
fh.Mre="signinurl";fh.FOg="signout";Object(e.a)(fh,"AuthenticationProxy",null,[]);class dg{}dg.getUserId="getUserId";dg.getLastStoreUpdate="laststoreupdate";dg.getEntitlement="getEntitlements";dg.getEToken="getEToken";dg.getManifest="getManifest";dg.getAppState="getAppState";dg.getKilledApps="getRemovedAddins";dg.getAppDetails="getAppDetails";dg.removeApps="removeAddin";dg.getLastPrivateCatalogUpdate="getLastPrivateCatalogUpdate";dg.getPrivateCatalogAddIns="getAddIns";dg.getPrivateCatalogManifests=
"getAppManifests";dg.isStoreDisabled="isStoreDisabled";Object(e.a)(dg,"S2SWebRequestActions",null,[]);var bh=a(588);class Wg{getUserId(Q,Wa){const Ib=new d.a;Ib.add(new Hf.a("corr",Q));this.CY(dg.getUserId,Ib,1,Wa)}getLastStoreUpdate(Q,Wa,Ib){const fc=new d.a;fc.add(new Hf.a("lc",Q));fc.add(new Hf.a("corr",Wa));this.CY(dg.getLastStoreUpdate,fc,1,Ib)}getEntitlement(Q,Wa,Ib,fc){Q=new d.a;Q.add(new Hf.a("av",Wa));Q.add(new Hf.a("corr",Ib));this.CY(dg.getEntitlement,Q,1,fc)}getEToken(Q,Wa,Ib,fc,sc,Tc){const ad=
new d.a;ad.add(new Hf.a("cmu",Q));ad.add(new Hf.a("cmf",Wa));ad.add(new Hf.a("assetid",Ib));ad.add(new Hf.a("expver",fc));ad.add(new Hf.a("corr",sc));this.CY(dg.getEToken,ad,1,Tc)}getManifest(Q,Wa,Ib,fc){const sc=new d.a;sc.add(new Hf.a("cmu",Q));sc.add(new Hf.a("assetid",Wa));sc.add(new Hf.a("corr",Ib));this.CY(dg.getManifest,sc,1,fc)}getAppState(Q,Wa,Ib){const fc=new d.a;fc.add(new Hf.a("ma",Q));fc.add(new Hf.a("corr",Wa));this.CY(dg.getAppState,fc,1,Ib)}getKilledApps(Q,Wa){const Ib=new d.a;Ib.add(new Hf.a("corr",
Q));this.CY(dg.getKilledApps,Ib,1,Wa)}getAppDetails(Q,Wa,Ib,fc){const sc=new d.a;sc.add(new Hf.a("cmo",Q));sc.add(new Hf.a("corr",Ib));this.sendWithBody(dg.getAppDetails,sc,Wa,2,fc,!1)}removeApps(Q,Wa,Ib){const fc=new d.a;fc.add(new Hf.a("corr",Wa));this.sendWithBody(dg.removeApps,fc,Q,2,Ib,!1)}getLastPrivateCatalogUpdate(Q,Wa,Ib,fc,sc,Tc){const ad=new d.a;ad.add(new Hf.a("catalog","privatecatalog"));ad.add(new Hf.a("clientCode",Q));ad.add(new Hf.a("clientVersion",Wa));ad.add(new Hf.a("corr",sc));
Q=String.format("authorizationCode={0}&refreshToken={1}",Ib?jg.a.Rf(Ib):"",fc?jg.a.Rf(fc):"");this.sendWithBody(dg.getLastPrivateCatalogUpdate,ad,Q,2,Tc,!0)}getPrivateCatalogAddIns(Q,Wa,Ib,fc,sc,Tc){const ad=new d.a;ad.add(new Hf.a("catalog","privatecatalog"));ad.add(new Hf.a("clientCode",Q));ad.add(new Hf.a("clientVersion",Wa));ad.add(new Hf.a("corr",sc));Q=String.format("authorizationCode={0}&refreshToken={1}",Ib?jg.a.Rf(Ib):"",fc?jg.a.Rf(fc):"");this.sendWithBody(dg.getPrivateCatalogAddIns,ad,
Q,2,Tc,!0)}getPrivateCatalogManifests(Q,Wa,Ib,fc,sc){const Tc=new d.a;Tc.add(new Hf.a("catalog","privatecatalog"));Tc.add(new Hf.a("corr",fc));Q=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",jg.a.Rf(Q),Wa?jg.a.Rf(Wa):"",Ib?jg.a.Rf(Ib):"");this.sendWithBody(dg.getPrivateCatalogManifests,Tc,Q,2,sc,!0)}isStoreDisabled(Q,Wa){const Ib=new d.a;Ib.add(new Hf.a("corr",Q));this.CY(dg.isStoreDisabled,Ib,2,Wa)}CY(Q,Wa,Ib,fc){this.sendWithBody(Q,Wa,null,Ib,fc,!1)}sendWithBody(Q,Wa,Ib,
fc,sc,Tc){const ad=new qf.QueryStringBuilder("AddinServiceHandler.ashx");ad.Tj("action",Q);ad.Tj("app",bh.a[Zd.AFrameworkApplication.sa.Qa.li]);for(let cd of Wa)ad.Tj(cd.key,cd.value);Wa=String.format("{0}{1}&{2}",Zd.AFrameworkApplication.sa.Qa.L1,ad.toString(),Zd.AFrameworkApplication.oj);Zd.AFrameworkApplication.qe.Sn(Wa,fc,Ib,null,!1,2,cd=>{let zd=null,Qd=null;cd&&cd.data&&(cd.data.responseHeaders["X-BlockedForMinor"]&&"1"===cd.data.responseHeaders["X-BlockedForMinor"].toString()&&(cd.data.httpStatus=
451),zd=cd.data.Pe,Qd=cd.data.responseHeaders);sc(cd.data.httpStatus,zd,Qd)},cd=>{var zd=null;let Qd=null;Tc&&cd&&cd.data&&cd.data.Pe&&(zd=cd.data.Pe,Qd=cd.data.responseHeaders);sc(cd.data.httpStatus,zd,Qd);if(Zd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",!0)){zd={message:"AddinServiceHandler request failed"};zd.code=cd.data.httpStatus;zd.action=Q;if(cd.data.request||cd.data.request.get_headers())zd["X-UserSessionId"]=cd.data.request.get_headers()["X-UserSessionId"];
408===cd.data.httpStatus||503===cd.data.httpStatus?k.ULS.sendTraceTag(538784582,220,10,JSON.stringify(zd)):k.ULS.sendTraceTag(18392345,220,50,JSON.stringify(zd))}else k.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",cd.data.httpStatus)},null,void 0,void 0,void 0,void 0,"AddinServiceHandler_"+Q,void 0,void 0,void 0,["X-UserKey"])}}Object(e.a)(Wg,"S2SWebRequestManager",null,[]);class li extends f.a{constructor(Q){super();this.d1f=this.ddaFacade=null;this.$=Q;Q.da.Ja(106,this);
this.uc()}get ze(){return this.ddaFacade||(this.ddaFacade=new Ig.DdaFacade(this.$,this.d1f,this.pg))}create(){k.ULS.sendTraceTag(537170507,0,50,"DdaFacadeServiceFactory:Create.");Zd.AFrameworkApplication.disableWholeAppsForOfficeFeature?k.ULS.sendTraceTag(537170506,0,50,`DdaFacadeServiceFactoryError.Create not creating DdaFacadeService : DisableWholeAppsForOfficeFeature [${Zd.AFrameworkApplication.disableWholeAppsForOfficeFeature}]`):z.EwaSettings.ya(359)?fd.a.instance.Dc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Q=>
{Q.isFeatureEnabled("mso_officeStore",!0).then(Wa=>{Ig.DdaFacade.s$b=Wa;this.Cwb();return null})}):this.Cwb()}Cwb(){const Q=Kg.GetServiceTaskFactory.Za(this.$.da,224,225,this.La),Wa=Gi.a.KCd(66,()=>!(void 0===window.OSF||null===window.OSF),this.$.xa.MaxRetriesForLoadingScript,this.$.ka,this.La,106),Ib=vi(this.ka,this.La);let fc;fc=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatCellsActionNewService",!1)?Object(Gf.d)(bg.a.resolve(sg.L,{Wa:this.La})):Kg.GetServiceTaskFactory.create(this.$.da,
18,this.$.ka,this.La);Wf.TaskExtensions.za(Wf.TaskExtensions.xe([Q,Wa,Ib,fc],this.$.ka),()=>{"undefined"===typeof OfficeExt||"undefined"===typeof OSF?k.ULS.sendTraceTag(537170505,0,15,`DdaFacadeServiceFactoryError.Create not creating DdaFacadeService. OfficeExt/OSF shouldn't be undefined. Stack: ${Lb.a.J_()}`):this.lti();k.ULS.sendTraceTag(537170504,0,50,"DdaFacadeServiceFactoryError.Create: DdaFacadeService created");this.d1f=Q.result;this.pg=fc.result;this.$b(this.ze);k.ULS.sendTraceTag(537170503,
0,50,"VSO#2693929: ServiceCreatedEvent is registered.")},this.ka,3)}lti(){z.EwaSettings.ya(63)&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new Wg);this.$.Xe.get(35)&&OfficeExt.PrivateCatalogService.initRequestHandler(new Wg,new fh(Zd.AFrameworkApplication.fa.appSettings.WebServiceBase),z.EwaSettings.ya(70),!0);OfficeExt.MosRequestHandler.init&&OfficeExt.MosRequestHandler.init(new Wg);OfficeExt.ProxyBasedCatalogService.initRequestHandler&&OfficeExt.ProxyBasedCatalogService.initRequestHandler(new Wg)}dispose(){ii.a.Ka(this.ddaFacade);
this.$=this.ddaFacade=null;super.dispose()}static la(Q){new li(Q)}}Object(e.a)(li,"DdaFacadeServiceFactory",f.a,[]);class mi{constructor(Q,Wa,Ib,fc,sc,Tc){this.$=Q;this.agaveCommandManager=Tc}Cd(){return!1}yd(){return!1}fd(Q,Wa,Ib,fc){let sc=!1;switch(Wa.command){case -684355545:sc=!0;break;case -741808261:sc=!!Ib;break;case -859308420:sc=!!fc&&1===fc.Yy;break;case 418618014:sc=1===Q&&!!fc&&1===fc.Yy;break;case -167264441:sc=tf.a.UEb(this.$)&&1===Q&&!!fc&&1===fc.Yy;break;case -515602470:Wa=z.EwaSettings.ya(217)&&
2===Q;sc=(1===Q||Wa)&&!!fc&&1===fc.Yy;break;case 2086613372:sc=z.EwaSettings.ya(217)&&2===Q&&!!fc&&1===fc.Yy;break;case -1336341324:sc=z.EwaSettings.ya(417)&&1===Q&&!!fc&&1===fc.Yy;break;case 451940422:sc=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AnalyzeDataInAutoFilter",!1)&&1===Q&&!!fc&&1===fc.Yy;break;case -1444574190:case -336193495:sc=1===Q&&!!fc&&1===fc.Yy;break;case 1296389134:sc=1===Q&&!!fc&&1===fc.Yy;break;case zf.a.F9a:sc=1===Q&&!!fc&&1===fc.Yy;break;case 1221897806:sc=
z.EwaSettings.ya(155)&&2===Q;break;case 1172793074:case 1930653487:sc=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&2===Q;break;case -1753056834:sc=!0;break;case 932597253:sc=!0;break;case 301511274:sc=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NavigationPaneWeb",!1);break;case 515196233:sc=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammer",!0)&&this.$.isEditMode;break;case 1723441034:sc=this.$.isEditMode&&
this.$.ea.IRb;break;case 1485761473:sc=tf.a.Fna()&&this.$.isEditMode}return sc}executeCommand(Q,Wa,Ib){let fc=Wf.TaskExtensions.Ik();const sc=Wa.command;switch(Wa.command){case zf.a.F9a:this.agaveCommandManager.Mmh(Ib.SourceControlId);break;case 1296389134:this.agaveCommandManager.W1j(Ib.SourceControlId,Ib.LabelText);break;case -684355545:this.agaveCommandManager.t7c();break;case -741808261:fc=this.agaveCommandManager.insertAgave(Ib,Wa);break;case -1336341324:z.EwaSettings.ya(417)&&(fc=this.agaveCommandManager.Gjc(Ib,
Q,Wa));break;case 1172793074:z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&(fc=this.agaveCommandManager.Gjc(Ib,Q,Wa));break;case 1485761473:fc=this.agaveCommandManager.Gjc(Ib,Q,Wa);break;case -859308420:case -515602470:case -167264441:case 2086613372:case -336193495:case -1444574190:case 451940422:case 418618014:case 1221897806:case 1930653487:case -1753056834:case 932597253:case 301511274:case 515196233:case 1723441034:fc=this.agaveCommandManager.Gjc(Ib,Q,Wa);
break;default:fc=ab.a(sc)}return fc}}Object(e.a)(mi,"AgaveCommandHandler",null,[210]);class Hi{}Object(e.a)(Hi,"Selection",null,[]);var wi=a(1377),ni=a(1376),xi=a(1378),vg=a(1374),yi=a(1372);class Ti{}Object(e.a)(Ti,"SmartLookupApplicationInterface",null,[]);class Ui{}Object(e.a)(Ui,"ApplicationProperties",null,[]);class Vi{}Object(e.a)(Vi,"EnterpriseUserInfo",null,[]);class Ii{}Object(e.a)(Ii,"FeatureGates",null,[]);class Wi{constructor(Q,Wa,Ib=!0){this.j8j=9E5;this.m8j=3E5;this.qEd=null;this.ZBf=
"";this.nEd=0;this.nxb=Date.now;this.PAa=Q;this.Xbb=Wa;Ib&&this.tld()}ifi(){const Q=this.nxb();if(Q<this.nEd+this.j8j)return Q>this.nEd+this.m8j&&this.tld(),this.ZBf;this.tld();return""}tld(){this.qEd=this.qEd||new Promise(Q=>{this.jfi().then(Wa=>{this.ZBf=Wa;this.nEd=this.nxb();this.qEd=null;Q(Wa)})})}jfi(){return this.Xbb&&this.Xbb.length?new Promise(Q=>{this.PAa.kD("SmartLookup",this.Xbb).then(Wa=>{Wa.IsSuccess?Wa.Token||(Q(""),k.ULS.sendTraceTag(51446545,1313,15,"SmartLookupManager - The AAD token is empty")):
(k.ULS.sendTraceTag(51446544,1313,15,"SmartLookupManager - Failed to get AAD token with error: "+Wa.ErrorCode+": "+Wa.ErrorMessage),Q(""));Q(Wa.Token)}).catch(Wa=>{Wa=yg.c(Wa);k.ULS.sendTraceTag(51446546,1313,15,"SmartLookupManager - Failed to get AAD token with exception: "+Wa);Q("")})}):(k.ULS.sendTraceTag(51446543,1313,10,"SmartLookupManager - Missing service endpoint: "),Promise.resolve(""))}}Object(e.a)(Wi,"SmartLookupAuthenticationManager",null,[779]);class Ji{static y5h(){switch(Object(R.a)(String,
Zd.AFrameworkApplication.Yc.AudienceGroup)||""){case "Dogfood":if(Zd.AFrameworkApplication.fa){let Q=Zd.AFrameworkApplication.fa.Va("UserPrincipalName");Q=jg.a.Hl(Q);const Wa=Zd.AFrameworkApplication.fa.Lq("SmartLookupINTEnabledForSKITeam")?Zd.AFrameworkApplication.fa.Tw("SmartLookupINTEnabledForSKITeam"):[];return 0<=Array.indexOf(Wa,Q)?"INT":"EDOG"}return"EDOG";default:return"PROD"}}static Gei(){switch(Zd.AFrameworkApplication.fa.ra("IntentSvcEnableEdogSourceLocationOverride")?"EDOG":Zd.AFrameworkApplication.fa.ra("IntentSvcEnableProdSourceLocationOverride")?
"PROD":Zd.AFrameworkApplication.fa.ra("IntentSvcEnableIntSourceLocationOverride")?"INT":Ji.y5h()){case "INT":return"wss://augmentation.osi.office-int.net/officeaugmentation/searchendpoint/";case "EDOG":return"wss://augmentation.osi.officeppe.net/officeaugmentation/searchendpoint/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpoint/"}}}Object(e.a)(Ji,"Utils",null,[]);var dj=a(569),wh=a(173);class Zh{constructor(Q){k.ULS.sendTraceTag(41521353,1313,50,"SmartLookupManager - Initialize");
this.GCf=Zd.AFrameworkApplication.fa.ra("IsTellMeUpSellEnterpriseEnabled");this.USi=Zd.AFrameworkApplication.fa.Va("SmartLookupApprovedOriginPattern");this.Xbb=Zd.AFrameworkApplication.fa.Va("SmartLookupShredderServiceEndpoint");this.xTi=Eh.a.$I(Zd.AFrameworkApplication.fa.Va("AppCatalogUrl")||"");this.Wbb=new Ii;this.Wbb.EnableAllTabV2=!0;this.Wbb.EnableIntentService=!0;this.Wbb.EnableInDocumentSearch=Zd.AFrameworkApplication.fa.ra("SmartLookupEnableInDocumentSearch");this.Wbb.EnableLocalSearch=
Zd.AFrameworkApplication.fa.ra("SmartLookupEnableLocalSearch");this.Wbb.IntentServiceEndpoint=Ji.Gei();this.sTi=new Wi(Q,this.Xbb)}get approvedOriginPattern(){return this.USi}a0h(){return Promise.resolve(this.b0h())}b0h(){const Q=new Ui;Q.anid="";Q.applicationVersion=Zd.AFrameworkApplication.buildVersion;Q.appCorrelationId=wh.a.create().toString();Q.themePlatform=Zh.Zkk;Q.lcid=Zd.AFrameworkApplication.lcid;Q.launchUtcTime=(new Date).toUTCString();Q.featureGates=this.Wbb;var Wa=dj.a.KL(Zd.AFrameworkApplication.lcid);
Wa=Wa?Wa.name:null;Q.market=this.hhc(Wa);Q.uiLanguage=Wa;Q.sessionId=Zd.AFrameworkApplication.userSessionId;Q.themeId=0;Q.parentalControl=Zh.Ugj;const Ib=new Vi;Ib.CountryCode=this.hhc(Wa);Ib.ServiceEndpoint=this.Xbb;Ib.IsGoLocal=!1;Ib.IsEnabled=this.GCf;Ib.IsEnterpriseEnabled=this.GCf;Ib.TenantRoot=this.xTi;Q.enterpriseUserInfo=Ib;Q.accessToken=this.sTi.ifi();return Q}hhc(Q){Q=Q.split("-");return Q[Q.length-1]}}Zh.Zkk="web";Zh.Ugj="yes";Object(e.a)(Zh,"SmartLookupManager",null,[771]);class Wh extends Tf.a{constructor(Q){super();
this.$=Q;this.isFirstLaunch=!1}Cd(){return!1}yd(){return!1}fd(Q,Wa){Q=z.EwaSettings.ya(127);return-983891024===Wa.command&&Q}executeCommand(Q,Wa){Q=Wf.TaskExtensions.Ik();-983891024===Wa.command&&this.EMi();return Q}EMi(){var Q=new Zh(null);const Wa={};var Ib=dc.h(this.$).tc(null).originalText;Ib=Object(Xc.a)(new Hi,{neighborhood:Ib,mentionStart:0,mentionLength:Ib?Ib.length:0});const fc=Object(Xc.a)(new Ti,{selection:Ib,entryPoint:0});Q.a0h().then(Tc=>{Tc.applicationName=Wh.appName;Tc.isFirstLaunch=
this.isFirstLaunch;Tc.themeId=5;Wa[Wh.smartLookupApplicationInterface]=JSON.stringify(fc);Wa[Wh.k1g]=JSON.stringify(Tc);this.isFirstLaunch=!1});Q=new wi.a("ExcelOnline","Web","en-Us");Ib=new ni.a("FA000000006",OSF.StoreType.FirstParty,OSF.StoreType.FirstParty,"1.0.0.0");const sc=new xi.a;sc.optionalProperties[vg.a.sl]=Df.a.instance.ha(1810);sc.optionalProperties[vg.a.taskPaneWidth]=350;sc.optionalProperties[vg.a.sourceLocationOverrideResourceId]="WAC.PROD.URL";sc.Hr=Wa;yi.a.instance.zAa(Ib,"Taskpane",
"SmartLookupSDXTaskpane",Q,sc)}}Wh.k1g="AppProperties";Wh.appName="Excel";Wh.smartLookupApplicationInterface="SmartLookupApplicationInterface";Object(e.a)(Wh,"SmartLookupCommandHandler",Tf.a,[210]);var Ki=a(467);class di extends Sd.a{constructor(Q){super(Q)}ue(){Ki.a(this.$,374,375,this.La,Q=>{this.Zd([new mi(this.$,null,null,null,null,Q),new Wh(this.$)])})}static la(Q){Sd.a.Ie(76,new di(Q))}}Object(e.a)(di,"AgaveCommandHandlerFactory",Sd.a,[]);var Li=a(1379),Ph=a(111);class Hh{constructor(){this.ze=
null;this.Yeb=(Q,Wa,Ib,fc,sc)=>{if(2===Ib){Q=sc?sc:{};Wa=Q.callback;Ib=Q.refresh?Q.refresh:!1;if(!Wa)return 16;Zd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType")&&null!=Q.storeType?this.ze.zZf(Wa,Ib,Q.storeType):this.ze.mPd(Wa,Ib)}return 32};this.gzc=(Q,Wa,Ib,fc,sc)=>{if(2===Ib){Q=sc?sc:{};Wa=Q.Observer;if(!Wa)return k.ULS.sendTraceTag(509686147,220,10,"registerAddinDetailObserver: invalid actionData: {0}",JSON.stringify(Q)),16;if(!this.ze||!this.ze.Bba)return k.ULS.sendTraceTag(509671006,
220,10,"registerAddinDetailObserver: ddaFacadeService or its addinDetailsProvider is null, abort the operation, actionData: {0}",JSON.stringify(Q)),16;this.ze.Bba.Ifb(Wa)}return 32};this.Puj=(Q,Wa,Ib,fc,sc)=>{2===Ib&&(Q=sc?sc.callback:null)&&this.ze.LWg(Q);return 32};this.iwi=(Q,Wa,Ib,fc,sc)=>{2===Ib&&this.ze.gLb(null,OSF.AgaveHostAction.InsertAgave,sc);return 32}}initialize(Q){Hh.initialized||(this.ze=Q,this.Ih(),Hh.initialized=!0)}Ih(){Zd.AFrameworkApplication.dc.pf(zf.a.Yeb,Ph.a.frame,this.Yeb,
96);Zd.AFrameworkApplication.dc.pf(zf.a.gzc,Ph.a.frame,this.gzc,96);Zd.AFrameworkApplication.dc.Hc(zf.a.Btj,Ph.a.frame,this.Puj);z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RegisterInsertOfficeAddinCommand",!1)&&Zd.AFrameworkApplication.dc.pf(zf.a.vnf,Ph.a.frame,this.iwi,96)}static get instance(){Hh.Oa||(Hh.Oa=new Hh);return Hh.Oa}}Hh.Oa=null;Hh.initialized=!1;Object(e.a)(Hh,"AgaveCommandActor",null,[]);var xh=a(1432),Fg=a(1375),oi=a(115),zi=a(366),ej=a(362),Xi=a(1282),wg=a(20),fj=
a(357);class ei{constructor(){this.P3d=this.AHc=null;this.nx=0;this.yHc=null}}Object(e.a)(ei,"FirstPartyAddinTaskpaneOverrides",null,[]);class Ch{constructor(){this.addressWithSheet=this.address=this.sheetName=this.sheetId=null;this.columnIndex=this.columnCount=this.rowIndex=this.rowCount=0;this.isSheetEmpty=!1;this.selectionType=null}}Object(e.a)(Ch,"IdeasSelectionContext",null,[]);class pi extends Ch{constructor(){super();this.hasTableHeaders=this.isPivotTable=this.isTable=!1;this.tableName=null;
this.userSelectedPivotTable=!1}}Object(e.a)(pi,"IdeasTableSelectionContext",Ch,[]);class gj{constructor(){this.sheetName=null;this.lastRow=this.firstRow=this.lastColumn=this.firstColumn=0}}Object(e.a)(gj,"AutoFilterRange",null,[]);class Yi{constructor(){this.autoFilterType=this.autoFilterRange=null;this.id=this.itemIndex=0}}Object(e.a)(Yi,"IdeasAutoFilterSource",null,[]);class Ai{constructor(Q,Wa){this.selection=Q;this.tables=Wa}}Object(e.a)(Ai,"IdeasXLIMTableBoundaries",null,[]);var Rg=a(59);const Zi=
(Q,Wa,Ib,fc,sc,Tc,ad=null)=>{ad=Q.Pa(9,ad);ad.sharedInfo=Wa;return Rg.g(Q,"ShowAgaveTaskpane",ad,Ib,fc,sc,Tc,0)};var gh=a(1018),$h=a(74),Mi=a(136),Xh=a(47),$i=a(382),fi=a(201),Ni=a(186),Oi=a(575),$f=a(248),Bi=a(109),hj=a(137),Pi=a(55);class Ci extends Ac.a{constructor(){super();this.mZ="calc(100% - 46px)";this.paa="15px";this.nZ="0";this.Emb="WACDialogPanel";this.CF=695;this.Fmb=462;this.wD="80%";this.rlb=350;this.wsa="100%";this.Ac=5;this.ef="AppsForOfficeInsertionDialog";this.ZPc=!!Zd.AFrameworkApplication.fa&&
Zd.AFrameworkApplication.fa.ra("OfficeAddinEnableInsertDialogAccessibilityFix")}oy(){super.oy();this.Mi.style.width=this.wsa;this.Mi.style.height=this.mZ;this.Mi.style.marginTop=this.paa;this.Mi.style.padding=this.nZ}Fpa(){this.Mi.style.width=this.wsa;this.Mi.style.height=this.mZ;this.Mi.style.marginTop=this.paa;this.Mi.style.padding=this.nZ;this.CF>Wc.a.e2?(this.Rb.style.width=String.format("{0}px",Wc.a.e2),this.Rb.style.overflowX="scroll",Zd.AFrameworkApplication.isRtl?this.Rb.style.right="0":this.Rb.style.left=
"0"):(this.Rb.style.width=String.format("{0}px",this.CF),this.Rb.style.overflowX="hidden");this.Rb.offsetHeight>Wc.a.jT||this.Fmb+50>Wc.a.jT?(this.Rb.style.height=String.format("{0}px",Wc.a.jT),this.Rb.style.overflowY="scroll",this.Rb.style.top="0",Zd.AFrameworkApplication.isRtl?this.Rb.style.right="0":this.Rb.style.left="0",this.ZPc||(this.Rb.style.marginTop="-48px"),this.Mi.style.minHeight=String.format("{0}px",this.rlb)):(this.Rb.style.overflowY="hidden",this.Rb.style.top="10%",this.Rb.style.height=
this.wD);this.hca()}hca(){if(this.Rb){var Q=this.Rb.style.zIndex;this.Rb.style.zIndex="-9999";if(this.CF>Wc.a.e2)Zd.AFrameworkApplication.isRtl?this.Rb.style.marginRight="0":this.Rb.style.marginLeft="0";else{const Wa=String.format("{0}px",Math.floor(-this.Rb.offsetWidth/2));Zd.AFrameworkApplication.isRtl?this.Rb.style.marginRight=Wa:this.Rb.style.marginLeft=Wa;Zd.AFrameworkApplication.isRtl?this.Rb.style.right="50%":this.Rb.style.left="50%"}this.Rb.style.zIndex=String(Q)}else k.ULS.sendTraceTag(19976784,
306,10,"_divMessageBox is null in CenterDialog()")}kF(){super.kF();const Q=document.getElementById(this.Hi(this.Emb));Q.style.width=String.format("{0}px",this.CF);Q.style.height=this.wD}get Vca(){return this.Mi}}Object(e.a)(Ci,"AppsForOfficeInsertionDialog",Ac.a,[788]);class Qi extends Ac.a{constructor(Q=!0,Wa=!0,Ib=null){super();this.mZ="calc(100% - 46px)";this.paa="15px";this.nZ="0";this.Emb="WACDialogPanel";this.CF=695;this.Fmb=462;this.wD="80%";this.rlb=350;this.wsa="100%";this.Bee="auto";this.Cee=
"5px";this.Dee="auto";this.Aee="40px";this.fYb="100px";this.Gmb="200px";this.Ac=5;this.ef="SDXDialog";this.JZb=Q;this.LCb=Wa;this.aYb=Ib}oy(){super.oy();this.Mi.style.width=this.wsa;this.Mi.style.height=this.mZ;this.Mi.style.marginTop=this.paa;this.Mi.style.padding=this.nZ}Fpa(){this.Mi.style.width=this.wsa;this.Mi.style.height=this.JZb?this.mZ:"100%";this.Mi.style.marginTop=this.JZb?this.paa:"0px";this.Mi.style.padding=this.nZ;if(this.JZb){this.fYb&&this.Gmb&&(this.CF=parseInt(this.Gmb.substring(0,
this.Gmb.length-2)),this.wD=this.fYb);this.CF>Wc.a.e2?(this.Rb.style.width=String.format("{0}px",Wc.a.e2),this.Rb.style.overflowX="scroll",Zd.AFrameworkApplication.isRtl?this.Rb.style.right="0":this.Rb.style.left="0"):(this.Rb.style.width=String.format("{0}px",this.CF),this.Rb.style.overflowX="hidden");if(this.Rb.offsetHeight>Wc.a.jT||this.Fmb+50>Wc.a.jT)this.Rb.style.height=String.format("{0}px",Wc.a.jT),this.Rb.style.overflowY="scroll",this.Rb.style.top="0",Zd.AFrameworkApplication.isRtl?this.Rb.style.right=
"0":this.Rb.style.left="0",this.Mi.style.minHeight=String.format("{0}px",this.rlb);else{this.Rb.style.overflowY="hidden";const Q="%"===this.wD.substring(this.wD.length-1,this.wD.length),Wa=Q?parseInt(this.wD.substring(0,this.wD.length-1)):parseInt(this.wD.substring(0,this.wD.length-2));this.Rb.style.top=Q?(100-Wa)/2+"%":100*(Wc.a.jT-Wa)/Wc.a.jT/2+"%";this.Rb.style.height=this.wD}this.hca()}else this.Rb.style.left=this.Bee,this.Rb.style.right=this.Cee,this.Rb.style.top=this.Dee,this.Rb.style.bottom=
this.Aee,this.Rb.style.width=this.Gmb,this.Rb.style.height=this.fYb,this.Rb.style.overflowX="hidden",this.Rb.style.overflowY="hidden"}hca(){if(this.Rb){var Q=this.Rb.style.zIndex;this.Rb.style.zIndex="-9999";if(this.CF>Wc.a.e2)Zd.AFrameworkApplication.isRtl?this.Rb.style.marginRight="0":this.Rb.style.marginLeft="0";else{const Wa=String.format("{0}px",Math.floor(-this.Rb.offsetWidth/2));Zd.AFrameworkApplication.isRtl?this.Rb.style.marginRight=Wa:this.Rb.style.marginLeft=Wa;Zd.AFrameworkApplication.isRtl?
this.Rb.style.right="50%":this.Rb.style.left="50%"}this.Rb.style.zIndex=String(Q)}else k.ULS.sendTraceTag(524892188,306,10,"_divMessageBox is null in CenterDialog()")}kF(){super.kF();const Q=document.getElementById(this.Hi(this.Emb));Q.style.width=String.format("{0}px",this.CF);Q.style.height=this.wD}get S7(){return this.JZb}get Vca(){return this.Mi}bNj(Q,Wa,Ib,fc){this.Bee=Q;this.Cee=Wa;this.Dee=Ib;this.Aee=fc}dNj(Q,Wa){this.fYb=Q;this.Gmb=Wa}}Object(e.a)(Qi,"SDXDialog",Ac.a,[]);var th=a(913),aj=
a(128),Ri=a(333),ai;(function(Q){Q[Q.Valid=2]="Valid";Q[Q.Invalid=4]="Invalid";Q[Q.All=6]="All"})(ai||(ai={}));Object(e.b)("MetadataState",ai);var T=a(354),db=a(861);class rb extends Tf.a{constructor(Q,Wa,Ib,fc,sc){super();this.Dqa={};this.mWd={};this.rjd={};this.wTa=this.sdxDialog=this.U0=null;this.Kfb=!1;this.O0j=new Map([["InsertAddInsFromBackstage","Backstage"],["InsertAppsForOffice","Ribbon"],["LaunchAddinDialogFromTellMe","TellMe"],["TeachingCallout","TeachingCallout"],["AddinFlyoutMoreButton",
"AddinFlyoutSeeAll"],["InsertMoreAddInsFromFooter","InsertMoreAddInsFromFooter"]]);this.Mmh=Tc=>{Tc?(Tc=new jh.a(-847286761,Hg.a.fc,this.$.Tc,0,Tc),this.$.Ia.mc(Tc,{["CalloutName"]:19})):k.ULS.sendTraceTag(509220127,220,10,"Control id is null.")};this.Sli=(Tc,ad,cd,zd,Qd)=>{if(2!==cd)return 32;this.Iqc(Qd);return 32};this.MHb=(Tc,ad,cd,zd,Qd)=>{2===cd&&(this.U0=new Ci,this.U0.initializeAndShow("",null,null),Tc=Qd.CommandValueId,ad=[],ad.push(Qd.SourceControlId),ad.push(Tc),ad.push(null),this.ze.wyf(this.U0.Vca,
ad));return 32};this.Iqc=Tc=>{var ad=Tc[th.a.Yyb];Tc=Tc[th.a.Cfa];var cd=Tc.optionalProperties[vg.a.Bl],zd=Tc.optionalProperties[vg.a.dialogHeight];const Qd=Tc.optionalProperties[vg.a.dialogWidth],Ae=Tc.optionalProperties[vg.a.dialogLeft],Oe=Tc.optionalProperties[vg.a.OTe],sf=Tc.optionalProperties[vg.a.dialogTop],Bg=Tc.optionalProperties[vg.a.ETe];this.sdxDialog=new Qi(Tc.optionalProperties[vg.a.KTe],Tc.optionalProperties[vg.a.PTe]);null!=Ae&&null!=Oe&&null!=sf&&null!=Bg&&this.sdxDialog.bNj(Ae,Oe,
sf,Bg);null!=zd&&null!=Qd&&this.sdxDialog.dNj(zd,Qd);this.sdxDialog.initializeAndShow(cd,null,null);cd=Tc.optionalProperties.InstanceToken;zd=null!=cd?cd:(new qd.a(wh.a.create(),1)).toString();cd={};cd.div=this.sdxDialog.Vca;cd.id=zd;cd.solutionId=ad.getId();cd.version=ad.KFa;cd.storeType=ad.getStoreType();cd.storeId=ad.getStoreId();cd.assetId=null;cd.assetStoreId=null;cd.settings=null!=Tc.Hr?Tc.Hr:{};cd.reason=Microsoft.Office.WebExtension.InitializationReason.Inserted;cd.osfControlType=OSF.OsfControlType.ContainerLevel;
cd.sourceLocationOverrideResourceId=Tc.optionalProperties[vg.a.sourceLocationOverrideResourceId];cd.featureGates=Zd.AFrameworkApplication.fa.W$e(ad.getId());cd.onExtensionLaunchCallback=Tc.optionalProperties[vg.a.onExtensionLaunchCallback];ad={};ad.InstanceId=cd.id;ad.WebExtensionType=2;ad.PrimaryMarketplace={};ad.PrimaryMarketplace.SolutionId=cd.solutionId;ad.PrimaryMarketplace.MarketplaceType=cd.storeType;ad.PrimaryMarketplace.MarketplaceRef=cd.storeId;ad.PrimaryMarketplace.SolutionVersion=cd.version;
ad.SrcLocationOverrideResourceId=cd.sourceLocationOverrideResourceId;ad.WebExtensionOsfControlType=6;ad.OnExtensionLaunchCallback=cd.onExtensionLaunchCallback;this.Dqa[cd.solutionId]=cd.settings;const {jyc:ig,tzb:ag}=this.Isc([],cd.solutionId);ad.OsfPropertyBag=ig;ad.HostPropertyBag=ag;this.ze.sLa(ad);this.ze.Xf.insertOsfControl(cd)};this.mni=(Tc,ad,cd,zd,Qd)=>{if(2!==cd)return 32;Tc=Qd[th.a.Yyb];cd=Qd[th.a.$Ka];Qd=Qd[th.a.Cfa];ad=new xh.a;ad.Iwi=Qd.optionalProperties.InstanceToken;ad.sl=Qd.optionalProperties[vg.a.sl];
ad.iQ=Qd.optionalProperties[vg.a.iQ];vg.a.taskPaneWidth in Qd.optionalProperties&&(ad.taskPaneWidth=Qd.optionalProperties[vg.a.taskPaneWidth]);ad.sourceLocationOverrideResourceId=Qd.optionalProperties[vg.a.sourceLocationOverrideResourceId];ad.onTaskPaneClose=Qd.optionalProperties[vg.a.onTaskPaneClose];ad.onExtensionLaunchCallback=Qd.optionalProperties[vg.a.onExtensionLaunchCallback];ad.VA=Qd.Hr;ad.$Ka=cd;cd=new jh.a(-859308420,0,2,0,"");zd=Tc.getStoreType()===OSF.StoreType.Sdx;const Ae=new gh.a;Ae.P0=
Qd.optionalProperties.HeaderCssClass||wg.a.w6a;Ae.njb=Qd.optionalProperties.TitleCssClass;this.b3(cd,Tc.getId(),ad,zd,Ae);return 32};this.Rmi=(Tc,ad,cd,zd,Qd)=>{if(2!==cd)return 32;Tc=Qd[th.a.Yyb].getId();Qd=Qd[th.a.Cfa].optionalProperties[vg.a.sourceLocationOverrideResourceId];return Tc?(this.ze.Xf.refreshOsfControl(Tc,Qd),32):8};this.Hkj=Tc=>{Tc=Tc.Result;if(Tc=null===Tc?null:Tc.SolutionId)this.ze.jwe(Tc),Bi.a(this.$).d$(3,Tc)};this.VWf=(Tc,ad)=>{var cd;const zd=(Tc=Tc.Result)?Tc.AgaveData:null;
if(zd){var Qd=Telemetry.PrivacyRules.GetPrivacyCompliantId(zd.PrimaryMarketplace.SolutionId,zd.PrimaryMarketplace.MarketplaceType,null===(cd=null===zd||void 0===zd?void 0:zd.AssetMarketplace)||void 0===cd?void 0:cd.SolutionId,null,null,zd.PrimaryMarketplace.MarketplaceRef);k.ULS.shipAssertTag(537170434,0,zd.TaskpaneWidth===rb.ISe,`Taskpane width is ${zd.TaskpaneWidth}, assetId is ${Qd}.`);if(cd=this.rjd[zd.PrimaryMarketplace.SolutionId])cd.AHc&&(zd.TaskpaneTitle=cd.AHc),cd.yHc&&(zd.TaskpaneIconId=
cd.yHc),cd.P3d&&(zd.TaskpaneButtonTooltip=cd.P3d),0<cd.nx&&(zd.TaskpaneWidth=cd.nx);ad&&(zd.FocusOnIframeWhenLoaded=ad.focusOnIframeWhenLoaded,ad.width&&(zd.TaskpaneWidth=ad.width),zd.TaskpaneIconCssClass=ad.Dl,zd.TaskpaneHeaderCssClass=ad.P0,zd.TaskpaneTitleCssClass=ad.njb,zd.IsFirstPartyOptOutAppContextOptmization=ad.isFirstPartyOptOutAppContextOptmization);if(this.Dqa[zd.PrimaryMarketplace.SolutionId]){const {jyc:Ae,tzb:Oe}=this.Isc(zd.OsfPropertyBag,zd.PrimaryMarketplace.SolutionId);zd.OsfPropertyBag=
Ae;zd.HostPropertyBag=Oe}Oi.a(zd)||(zd.WebExtensionOsfControlType=1);zd.OnExtensionLaunchCallback=this.mWd[zd.PrimaryMarketplace.SolutionId];zd&&(this.ze.jwe(Tc.SolutionId),this.ze.sLa(zd))}else k.ULS.sendTraceTag(593285650,220,10,"AgaveCommandHandler.PostInsertAgaveTaskpaneSuccess: failed to return valid response.")};this.sRh=Tc=>{Tc&&(this.Aid.Twf(Tc),this.qIe())};this.ZWf=Tc=>{Tc=Tc.toDataURL("image/jpeg");const ad=this.ze.rda(rb.kkf+"."+rb.njc),cd={};cd.screenshot=Tc;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(ad,
"onScreenshot",cd,()=>{})};this.jli=(Tc,ad,cd,zd,Qd)=>{if(2!==cd)return 32;if(oi.a.Gh(Qd)||Qd[th.a.JMe]!==Fg.a.action)return 8;ad=Qd[th.a.Cfa];return ad?(Tc=(Tc=this.Lai(Qd))?this.ze.rda(Tc):null)?(Qd=this.ze.Rlh(Qd[th.a.$Ka],ad.optionalProperties[vg.a.M0c]),z.EwaSettings.isChangeGateEnabled("OfficeVSO:5295210_SdxTaskpaneTitleOverrideNew")&&(cd=this.ze.rW(Tc),cd.TaskpaneTitle!==ad.optionalProperties[vg.a.sl]&&(cd.TaskpaneTitle=ad.optionalProperties[vg.a.sl],cd.TaskpaneIconCssClass=ad.optionalProperties.IconCssClass,
cd.TaskpaneIconUrl=ad.optionalProperties.TaskPaneIconUrl,cd.TaskpaneIconId=ad.optionalProperties.TaskPaneIconId,cd.OnExtensionLaunchCallback=ad.optionalProperties[vg.a.onExtensionLaunchCallback],z.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")?(ad=this.ze.Xf,ad.changeIframeTitle(Tc,cd.TaskpaneTitle),cd=ad.getOsfControl(Tc),ad.raiseOsfControlStatusChange(cd)):(ad=this.ze.Xf.getOsfControl(Tc),this.ze.Xf.raiseOsfControlStatusChange(ad)))),OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(Tc,
Qd,this.xQb),32):8:8};this.xQb=(Tc,ad)=>{this.ze.XTh(Tc,ad)};this.oRd=()=>{Wf.TaskExtensions.V5(Kg.GetServiceTaskFactory.Za(this.$.da,20,404,1),Tc=>{Tc.result.Dya()},this.$.ka)};this.$=Q;this.viewBlockContainerHelpers=Ib;this.ze=Wa;this.Aid=fc;this.Ni=sc;this.Ni.Hc(zf.a.Big,Ph.a.frame,this.mni);this.Ni.Hc(zf.a.u8f,Ph.a.frame,this.Rmi);this.Ni.Hc(zf.a.i2e,Ph.a.frame,this.jli);this.Ni.Hc(zf.a.Iqc,Ph.a.frame,this.Sli);this.Ni.Hc(zf.a.MHb,Ph.a.frame,this.MHb)}DXg(Q){this.addHandler(rb.wLd,Q)}Myj(Q){this.removeHandler(rb.wLd,
Q)}dispose(){ii.a.Ka(this.U0);this.U0=null;this.Kfb&&(this.$.ea.en(this.oRd),this.Kfb=!1);super.dispose()}t7c(){this.U0&&this.U0.hide()}W1j(Q,Wa){var Ib;if(Q){z.EwaSettings.isChangeGateEnabled("OfficeVSO:7671629_LogUserInstalledOMEXAddinListSizeEnabled")&&this.ze.Xf.getEntitlementDetails(Object.assign(new db.a,{storeType:OSF.StoreTypeEnum.MarketPlace,refresh:!1}),sc=>{sc={["AddinListSize"]:null==sc.value?0:sc.value.length,["Origin"]:"OMEX"};cg.a.sendTelemetryEvent(Object.assign(new Pf.a,{name:"Office.Extensibility.Host.AddinListInfoWhenUserOpenDialog",
dataFields:Na.a.Wj(sc)}))});this.raiseEvent(rb.wLd);const fc=Q.split("|");this.VQi(Q,Wa,fc);this.U0=new Ci;this.U0.initializeAndShow("",null,null);this.ze.wyf(this.U0.Vca,fc);window[rb.ZZg]=null!==(Ib=this.O0j.get(Q))&&void 0!==Ib?Ib:"Unknown"}}Gjc(Q,Wa,Ib){var fc=Wf.TaskExtensions.Ik();if(-515602470===Ib.command||-167264441===Ib.command||-336193495===Ib.command||2086613372===Ib.command||-1444574190===Ib.command||-1336341324===Ib.command||451940422===Ib.command)fc=this.Gli(Q,Wa,Ib);418618014===Ib.command&&
(Wa=new xh.a,Wa.sl=Df.a.instance.ha(1823),fc=this.b3(Ib,rb.mpi,Wa,!0));if((Ib.tabName===this.$.qc+Wd.a.c9f||Ib.tabName===Wd.a.n2)&&2===Ib.Jf||-1!==Array.indexOf("A0 A1 Help ContactSupport WhatsNew GiveFeedback".split(" "),Q[Hg.a.Gd])||Q[Hg.a.Gd]===Wd.a.rS)return this.cif(Q,Ib);if(7===Ib.Jf&&Q.SourceControlId===this.$.qc+Wd.a.Jya)return Q.MenuItemId=Wd.a.oQd,this.cif(Q,Ib);1221897806===Ib.command&&(fc=this.jig(Ib,"Format"));if(1930653487===Ib.command||1172793074===Ib.command)fc=this.jig(Ib,"Data");
-1753056834===Ib.command&&(fc=this.BYj(Ib));932597253===Ib.command&&(k.ULS.sendTraceTag(537170445,0,50,"InsertPowerBIPivotTable - addin launch requested"),aj.c(932597253,!0),Wa=new xh.a,Wa.sl=Df.a.instance.ha(2163),Wa.sourceLocationOverrideResourceId=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerBIUseDevURL",!1)?rb.Qkj:rb.Skj,Wa.focusOnIframeWhenLoaded=!0,Wa.taskPaneWidth=rb.Klf,fc={},fc.LaunchSource=Object(R.a)(String,Q.SourceControlId),fc.LaunchMode="Default",Wa.VA=fc,fc=this.b3(Ib,
rb.Rkj,Wa,!0));301511274===Ib.command&&(fc=this.MYj(Ib));if(515196233===Ib.command){Wa=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerEnableTaskPaneFeedback",!1);fc=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerEnableClosePaneFeedback",!1);var sc=this.$.da.Ba(465);sc&&(sc.Z8a(),Wa||fc)&&(sc.Kvi(),fc&&sc.DOj(10===Ib.Jf));sc=new xh.a;sc.sl=Df.a.instance.ha(2237);const Tc={};Tc.SourceUILocation=zi.a[Ib.Jf];if(Wa||fc)Tc.SessionID=
this.$.ea.sessionId,Wa&&this.XXd(Tc);sc.VA=Tc;Wa=new gh.a;Wa.P0=wg.a.w6a;fc=this.b3(Ib,rb.Ffj,sc,!0,Wa,void 0,sc.sl)}1723441034===Ib.command&&(Wa=new xh.a,Wa.sl=Df.a.instance.ha(2249),Wa.focusOnIframeWhenLoaded=!0,Wa.taskPaneWidth=rb.Jnj,fc=new gh.a,fc.P0=wg.a.FZe,fc=this.b3(Ib,Ri.c,Wa,!0,fc));z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",!1)&&Q.LoadDataFromPictureTaskpane&&(Wa={},fc=new xh.a,fc.sl=Df.a.instance.ha(2276),Wa.SessionID=Q.SessionID,fc.VA=Wa,fc.focusOnIframeWhenLoaded=
!0,fc=this.b3(Ib,Q.DataFromPictureAssetId,fc,!0));1485761473===Ib.command&&tf.a.Fna()&&(Q=new xh.a,Q.sl=rb.llh,Q.focusOnIframeWhenLoaded=!0,Q.taskPaneWidth=rb.ISe,Wa=new gh.a,Wa.P0=wg.a.FZe,fc=this.b3(Ib,rb.klh,Q,!0,Wa));return fc}insertAgave(Q,Wa){var Ib=Wf.TaskExtensions.Ik();const fc=this.$;let sc;var Tc=Q[Gb.a.Dja];sc=Q[Hg.a.Og];let ad=null;gh.a.key in Q&&(ad=Q[gh.a.key]);this.U0&&this.U0.hide();if(!sc||!Tc)return k.ULS.sendTraceTag(537170444,220,10,"Inserting addin needs inserted agave parameters"),
Ib;this.$.Y7&&Wd.a.lra in Q&&(sc.EnabledInViewMode=Q[Wd.a.lra]);Q=this.Q2h(Wa.command);if(!sc.EnabledInViewMode&&!fc.xt(null,!1,Q))return Ib;let cd=void 0===sc.IsToBePersisted||null===sc.IsToBePersisted||sc.IsToBePersisted?0:16;if(1===sc.TargetType)Ib=this.Ewi(sc,Tc,Wa,ad,cd);else{Tc=dc.h(fc);Ib=this.viewBlockContainerHelpers.Hkb(Tc);const zd=fc.ea.isNamedObjectViewMode?fc.na.sheetName:fc.na.name;let Qd,Ae,Oe,sf;Ib?(Tc=Ib.Se,Qd=Tc.mf.top,Ae=Tc.mf.left,Oe=Ib.wK.x,sf=Ib.wK.y):(Qd=Ae=1,Ib=this.viewBlockContainerHelpers.uOa(Tc),
Oe=Ib.x,sf=Ib.y);const Bg=this.$.qa.va.Lc();cd|=64;Ib=$i.a(this.$.userOperationManager,(ig,ag,eg)=>{var Cg=fc.qa.va,Xg=Qd,Mg=Ae,Yg=Oe,bi=sf;ig=$f.b(ig,this.Hkj);const qi=Cg.Pa(9,Bg);qi.sharedInfo=sc;qi.sheetName=zd;qi.positionRow=Xg;qi.positionCol=Mg;qi.positionOffsetX=Yg;qi.positionOffsetY=bi;return Rg.g(Cg,"InsertWebExtension",qi,ig,ag,eg,null,0)},ig=>new fi.a(534,0,ig,cd),Wa)}return Ib}mjh(){var Q=fd.a.instance.Dc("Common.App.ICustomerFeedbackUiWrapper");if(!z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OcvFeedbackvNextEnabled",
!1)){var Wa=fd.a.instance.Dc("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager");this.Aid?this.Aid.gob?this.qIe():Wa.instance.zed(this.sRh):k.ULS.sendTraceTag(537170443,1302,15,"feedbackFormManager is undefined")}Wa={};Zd.AFrameworkApplication.fa.Cwe(Wa);Q=Q.instance.getContext(Wa);Wa={};"telemetryGroup"in Q&&(Wa=Q.telemetryGroup);Wa.processSessionId=Q.sessionId;Wa.officeBuild=Q.build;Q.telemetryGroup=Wa;Q.feedbackType=-1;Q.userVoiceEnabled=!1;"disableIncludeScreenshot"in Q||(Q.disableIncludeScreenshot=
!1);"screenshot"in Q||(Q.screenshot=!1);Q.disableScreenshotPreview=!1;Q.includeScreenshotSelectedDefault=!0;return Q}rXf(Q){if(!this.wTa){var Wa=this.Nnd();Wa=this.KFe(Wa);const Ib=new gh.a;Ib.Dl=wg.a.Oyb;Ib.P0=wg.a.e_e;Ib.njb=wg.a.Qgd;this.wTa=this.oCc(Wa,null,!1,null,Ib);hj.b(this.$).Vd(Mi.a.flj,{["Location"]:Q?zi.a[Q.Jf]:0,["InputMethod"]:Q?ej.a[Q.method]:0},void 0,!0);z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PassXlimTableBoundariesToIdeas",!1)&&this.C5d()}}XXd(Q){const Wa=this.$.ea.Dh.get(17);
fd.a.instance.Dc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Ib=>{Ib.isFeatureEnabled("mso_sendASmile",Wa).then(fc=>{Q.FeedbackEnabled=Wa&&fc;return null})})}CDi(){return this.ze.fJi(this.ze.wNa(rb.ePa,this.Nnd()))}jig(Q,Wa){const Ib=dc.h(this.$),fc=new xh.a;var sc={};sc.ActiveTab=Wa;sc.DatapaneFlighting=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1);sc.MergeIvyBiDataSources=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeIvyBiDataSources",
!1);sc.ComboChartUIInXLO=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSComboChartUIInXLO",!1);sc.AceFlighting=!0;sc.ThemeColorsFlighting=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&z.EwaSettings.isChangeGateEnabled("OfficeVSO:5732064_ThemeColorsInChartsTaskpaneEnabled");sc.UOMirror=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UOMirror",!1);sc.FormatTaskPaneAceButtonDark=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneAceButtonDark",
!1);sc.FormatTaskPaneBetterFeedbackButton=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneBetterFeedbackButton",!1);sc.FormatTaskPaneBetterScrollbar=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneBetterScrollbar",!1);sc.FormatTaskPaneUXImprovePhase2=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneUXImprovePhase2",!1);sc.ChartTPNewFontAndColorTheme=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTPNewFontAndColorTheme",
!1);sc.ChartFOTPRenderRefactor=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSTrendlineEquationFormat",!1);this.XXd(sc);sc.startTimeMs=Date.now();sc.UserSessionId=this.$.xa.UserSessionId;(Wa=Ib.ga.Sa.hp)&&(sc.SubSelection=Wa);k.ULS.sendTraceTag(592524688,0,50,`Chart task pane launched. UserSessionId: ${sc.UserSessionId}, UILocation: ${void 0===Q.Jf||null===Q.Jf?"Null":zi.a[Q.Jf]}, SubSelection: ${Wa||"ChartRoot"}`);fc.VA=sc;fc.sl=Df.a.instance.ha(984);sc=new gh.a;sc.P0=wg.a.w6a;
return this.b3(Q,rb.cdh,fc,!0,sc)}BYj(Q){const Wa=new xh.a;Wa.VA={};Wa.sl=Df.a.instance.ha(1809);Wa.iQ=rb.Xyf;const Ib=new gh.a;Ib.P0=wg.a.w6a;return this.b3(Q,rb.Xyf,Wa,!0,Ib,void 0,Wa.sl)}MYj(Q){const Wa=new xh.a;Wa.VA={};Wa.sl=Df.a.instance.ha(2187);const Ib=new gh.a;Ib.P0=wg.a.NJh;Ib.njb=wg.a.i_e;return this.b3(Q,rb.zYi,Wa,!0,Ib)}cif(Q,Wa){const Ib=rb.kkf;var fc=Q[Hg.a.Gd].toString();const sc={},Tc=new xh.a;Tc.sl=Df.a.instance.ha(9);switch(fc){case "A0":sc.query=(Q[Hg.a.Og]||"").split("|").slice(2,
fj.a.E3).join("|");break;case "A1":sc.query=Q.CommandValueId;break;case "Help":sc.query="";break;case Wd.a.oQd:z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?(Tc.sl=Df.a.instance.ha(1775),Tc.sourceLocationOverrideResourceId=rb.njc,sc.feedback=this.mjh()):sc.query=fc;break;case "HelpArticle":sc.query=Q[Hg.a.Og];break;case "ContactSupport":sc.query=fc;Tc.sourceLocationOverrideResourceId=rb.ujh;break;case "ShowTraining":case "WhatsNew":sc.query=fc;
break;default:return Dc.Task.Ua(!0)}Tc.VA=sc;fc=new gh.a;fc.P0=wg.a.w6a;return this.b3(Wa,Ib,Tc,!1,fc,Q[Wd.a.lra]||!1)}KFe(Q){const Wa={};Wa.SolutionId=rb.ePa;Wa.Version="0.0.0.0";Wa.StoreType=OSF.StoreType.Sdx;Wa.StoreId=OSF.StoreType.Sdx;Wa.AssetId=null;Wa.AssetStoreId=null;Wa.Height=0;Wa.Width=0;Wa.TargetType=OSF.OsfControlTarget.TaskPane;Wa.IsToBePersisted=!1;Wa.SourceLocationOverrideResourceId=Q;Wa.SharedRuntimeId=Q;return Wa}Gli(Q,Wa,Ib){function fc(){ad.LaunchMode="Default";sc.sl=Df.a.instance.ha(1822);
sc.iQ=rb.E5b;sc.Dl=wg.a.Oyb;Tc.Dl=wg.a.Oyb}const sc=new xh.a,Tc=new gh.a,ad={};this.wTa&&this.XXd(ad);ad.LaunchSource="";ad.StartTimeMs=Date.now();ad.CorrelationId=wh.a.create().toString();sc.VA=ad;sc.focusOnIframeWhenLoaded=!0;sc.taskPaneWidth=rb.Klf;Tc.P0=wg.a.e_e;Tc.njb=wg.a.Qgd;switch(Ib.command){case -1444574190:let Qd;ad.LaunchMode="RecommendedPivotTables";ad.SelectionContext="";ad.LaunchSource="PivotTableHandRaise"===Object(R.a)(String,Q.SourceControlId)?"PivotTableHandRaise":"InsertPivotTable";
if(this.$&&z.EwaSettings.isChangeGateEnabled("OfficeVSO:4618462_PassSourceSelectionToIdeas")&&Q.SourceSelection){var cd=Q.SourceSelection.split(",")[0];Wa=z.EwaSettings.isChangeGateEnabled("OfficeVSO:4701499_IdeasSelectionIndexing")?-1:0;if(({sheetName:cd,X_f:Qd,range:zd}=Xh.ab(cd,this.$.ua)).returnValue&&!dc.h(this.$).Wb.jX(zd))Q=this.$.ua.getItemByName(cd),ad.SelectionContext=JSON.stringify(Object(Xc.a)(new Ch,{address:Qd,addressWithSheet:cd+"!"+zd.vz(!1),sheetId:$h.d(Q),sheetName:cd,isSheetEmpty:!1,
columnCount:zd.width,rowCount:zd.height,columnIndex:zd.left+Wa,rowIndex:zd.top+Wa,selectionType:"Continuous"}));else if((Q=this.$.oc.getItemByName(Object(R.a)(String,Q.SourceSelection)))&&$h.n(Q)){var zd=Ni.a(Q,!0);cd=this.$.ua.getItemByName(Q.sheetName);ad.SelectionContext=JSON.stringify(Object(Xc.a)(new pi,{tableName:Q.name,hasTableHeaders:Ni.d(Q),isPivotTable:!1,isTable:!0,userSelectedPivotTable:!1,address:zd.vz(!1),addressWithSheet:cd.name+"!"+zd.vz(!1),sheetId:$h.d(cd),sheetName:cd.name,isSheetEmpty:!1,
columnCount:zd.width,rowCount:zd.height,columnIndex:zd.left+Wa,rowIndex:zd.top+Wa,selectionType:"Continuous"}))}}sc.sl=Df.a.instance.ha(1821);sc.iQ=rb.Xij;sc.Dl=wg.a.p1e;Tc.Dl=wg.a.p1e;break;case -336193495:ad.LaunchMode="RecommendedCharts";sc.sl=Df.a.instance.ha(1820);sc.iQ=rb.isj;sc.Dl=wg.a.q1e;Tc.Dl=wg.a.q1e;break;case -1336341324:if(!z.EwaSettings.ya(417))return Dc.Task.Ua(!1);ad.LaunchMode="NL";sc.iQ=rb.E5b;switch(z.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",
0)){case 1:sc.sl=Df.a.instance.ha(1825);ad.NLLaunchModeBrandingCandidatesIndex=1;break;case 2:sc.sl=Df.a.instance.ha(1826);ad.NLLaunchModeBrandingCandidatesIndex=2;break;default:sc.sl=Df.a.instance.ha(1824),ad.NLLaunchModeBrandingCandidatesIndex=0}break;case 2086613372:if(!z.EwaSettings.ya(217))return Dc.Task.Ua(!1);ad.LaunchMode="ChartDesigner";ad.LaunchSelectionMode=Wa.toString();sc.sl=Df.a.instance.ha(1827);sc.iQ=rb.E5b;break;case 451940422:ad.LaunchSource="AutoFilter";zd=JSON.parse(Q.CommandValueId);
ad.AutoFilterSource=JSON.stringify(Object.assign(new Yi,{autoFilterRange:{sheetName:zd.AutoFilterRange.SheetName,firstColumn:zd.AutoFilterRange.FirstColumn,lastColumn:zd.AutoFilterRange.LastColumn,firstRow:zd.AutoFilterRange.FirstRow,lastRow:zd.AutoFilterRange.LastRow},autoFilterType:zd.AutoFilterType,itemIndex:zd.ItemIndex,id:zd.Id}));fc();break;case -167264441:ad.LaunchMode="ExcelIntelligence";ad.TableName=Q.tableName;sc.sl=Df.a.instance.ha(2287);sc.iQ=rb.E5b;sc.Dl=wg.a.Oyb;Tc.Dl=wg.a.Oyb;break;
default:z.EwaSettings.ya(217)&&(ad.LaunchSelectionMode=Wa.toString()),z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PassXlimTableBoundariesToIdeas",!1)&&(ad.XlimTableBoundaries=this.lgi()),fc()}sc.sourceLocationOverrideResourceId=this.Nnd();return this.wTa?this.wTa.Mq(()=>this.LJj(ad,sc)):this.Lui(Ib,sc,Tc,ad)}Lui(Q,Wa,Ib,fc){this.wTa=this.oCc(this.KFe(Wa.sourceLocationOverrideResourceId),Wa,!1,Q,Ib,!1);fc.NoActionMsgOnFirstInstance=!0;this.Dqa[rb.ePa]=fc;return this.wTa}LJj(Q,Wa){const Ib=
this.ze.rda(this.ze.wNa(rb.ePa,Wa.sourceLocationOverrideResourceId));if(Ib){this.Dqa[rb.ePa]=Q;const {jyc:fc,tzb:sc}=this.Isc(this.ze.rW(Ib).OsfPropertyBag,rb.ePa);this.ze.rW(Ib).OsfPropertyBag=fc;this.ze.rW(Ib).HostPropertyBag=sc}this.zAa(rb.ePa,Fg.a.action,"LaunchIdeasAction",Q,"1.0.0.0",Wa);return Dc.Task.Ua(!0)}Nnd(){const Q=Zd.AFrameworkApplication.Yc.AudienceGroup;if(z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPEApi",!1)){switch(Q){case "Automation":case "Dogfood":case "Microsoft":return"Ideas.PPEApi.PPE"}return"Ideas.PPEApi"}switch(Q){case "Automation":case "Dogfood":case "Microsoft":return"Insights.Https.PPE.Bundle"}return"Insights.Https.Bundle"}b3(Q,
Wa,Ib=null,fc=!1,sc=null,Tc=!1,ad=null){Wf.TaskExtensions.Ik();Ib||(Ib=new xh.a);const cd={};cd.SolutionId=Wa;cd.Version="0.0.0.0";cd.StoreType=fc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;cd.StoreId=fc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;cd.AssetId=null;cd.AssetStoreId=null;cd.Height=0;cd.Width=0;cd.TargetType=OSF.OsfControlTarget.TaskPane;cd.IsToBePersisted=!1;cd.SourceLocationOverrideResourceId=Ib.sourceLocationOverrideResourceId;if(Ib.sl||ad)this.rjd[Wa]=Object(Xc.a)(new ei,{AHc:Ib.sl,
P3d:ad,yHc:Ib.iQ});z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)?(Ib.VA||(Ib.VA={}),Ib.VA.ShowFeedback=this.$.isFeedbackEnabled,this.Dqa[Wa]=Ib.VA):Ib.VA&&(this.Dqa[Wa]=Ib.VA);this.mWd[Wa]=Ib.onExtensionLaunchCallback;Wa={};Wa[Hg.a.Og]=cd;ad={};ad.solutionId=cd.SolutionId;ad.version=cd.Version;ad.storeType=cd.StoreType;ad.storeId=cd.StoreId;ad.assetId=cd.AssetId;ad.assetStoreId=cd.AssetStoreId;ad.height=cd.Height;ad.targetType=
cd.TargetType;ad.width=cd.Width;ad.isAddinCommands=!fc;Wa[Gb.a.Dja]=ad;sc||(sc=new gh.a);sc.focusOnIframeWhenLoaded=Ib.focusOnIframeWhenLoaded;sc.width=Ib.taskPaneWidth;Wa[gh.a.key]=sc;Wa[Wd.a.lra]=Tc;return this.insertAgave(Wa,Q)}Ewi(Q,Wa,Ib,fc,sc){const Tc=(Qd,Ae)=>{var Oe=Qd.SolutionId;const sf=OSF.OsfControl.isFirstPartyStoreString(Qd.StoreType);sf&&Qd.SourceLocationOverrideResourceId&&(Oe=this.ze.wNa(Oe,Qd.SourceLocationOverrideResourceId));var Bg=this.ze.mJe(Oe,null,Qd.SharedRuntimeId);if(sf){if(z.EwaSettings.ya(263)&&
Bg&&(Oe=this.ze.rda(Oe))){const {jyc:ig,tzb:ag}=this.Isc(this.ze.rW(Oe).OsfPropertyBag,Qd.SolutionId);if(Oe=this.ze.Xf.getOsfControl(Oe))Oe.setSettings(ig),Oe.setHostSettings(ag)}Qd.SharedRuntimeId&&Bg||this.ze.Xf.refreshOsfControl(Qd.SolutionId,Qd.SourceLocationOverrideResourceId)}if(!Bg){const ig=this.$.qa.va.Lc();let ag=519;Bg=(eg,Cg,Xg)=>{var Mg=this.$.qa.va;eg=$f.b(eg,this.VWf);const Yg=Mg.Pa(9,ig);Yg.sharedInfo=Qd;return Rg.g(Mg,"InsertAgaveTaskpane",Yg,eg,Cg,Xg,fc,0)};void 0===Qd.IsToBePersisted||
null===Qd.IsToBePersisted||Qd.IsToBePersisted||(ag=538,Bg=(eg,Cg,Xg)=>{const Mg=Telemetry.PrivacyRules.GetPrivacyCompliantId(Qd.SolutionId,Qd.StoreType,Qd.AssetId,null,null,Qd.StoreId);k.ULS.sendTraceTag(537170442,220,50,`Web Method ShowAgaveTaskpane is called, StoreType ${Qd.StoreType}, StoreId ${Qd.StoreId}, SolutionId ${Mg}.`);return Zi(this.$.qa.va,Qd,$f.b(eg,this.VWf),Cg,Xg,fc,ig)});sc|=64;return $i.a(this.$.userOperationManager,Bg,eg=>new fi.a(ag,0,eg,sc),Ae)}return Wf.TaskExtensions.Kda()},
ad=Qd=>{var Ae=Telemetry.PrivacyRules.GetPrivacyCompliantId(Qd.solutionId,Qd.storeType,Qd.assetId,null,null,Qd.storeId);k.ULS.sendTraceTag(537170440,220,50,`Insert addincommands for ${Ae} from ${Qd.storeType}.`);Ae={};const Oe=new d.a;Oe.add(Qd);Ae[Gb.a.Asb]=Oe;Ae[Gb.a.f_]=3;Qd=new jh.a(zf.a.KHb,0,this.$.Tc,0,null);return this.$.Ia.mc(Qd,Ae)};if(!z.EwaSettings.ya(52)||Q.StoreId===OSF.StoreType.FirstParty)return Tc(Q,Ib,fc);if(Wa.isAddinCommands)return ad(Wa);const cd=new Fd.a,zd={};zd.solutionId=
Q.SolutionId;zd.version=Q.Version;zd.storeType=Q.StoreType;zd.storeId=Q.StoreId;zd.targetData=Q;this.ze.Xf.isAddinCommandsAsync(zd,(Qd,Ae,Oe)=>{cd.setResult(Ae);Qd||(Qd=Oe.targetData,Ae=Telemetry.PrivacyRules.GetPrivacyCompliantId(Qd.SolutionId,Qd.StoreType,Qd.AssetId,null,null,Qd.StoreId),k.ULS.sendTraceTag(537170438,220,10,`Judging AddinCommands failed for ${Ae} from ${Qd.StoreType} during addin inserting`))});return Wf.TaskExtensions.ts(cd.task,Qd=>Qd.result?ad(Wa):Tc(Q,Ib,fc),this.$.ka)}Isc(Q,
Wa){if(!this.Dqa[Wa])return{Qok:Q,tzb:null};const Ib={},fc={};if(Q)for(const [Tc,ad]of Q)Ib[Tc]=ad;Q=this.Dqa[Wa];for(var sc of Object.keys(Q))Wa=Q[sc],sc===rb.uRh&&z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?Ib[sc]=fc[sc]=Sys.Serialization.JavaScriptSerializer.serialize(Wa):Ib[sc]=fc[sc]=Sys.Serialization.JavaScriptSerializer.serialize(Wa.toString());sc=Object.keys(Ib).map(Tc=>[Tc,Ib[Tc].toString()]);Q=Object.keys(fc).map(Tc=>[Tc,fc[Tc].toString()]);
return{jyc:sc,tzb:Q}}VQi(Q,Wa,Ib){const fc=this.$.xa.UserSessionId,sc=this.$.xa.UICultureTag,Tc=this.$.xa.UICultureTagLcid,ad=this.$.xa.WacHostId;let cd="",zd="";5<=Ib.length&&(cd=Ib[3],zd=Ib[4]);this.WQi(cd,zd,Q,Wa,sc,Tc,fc,ad)}WQi(Q,Wa,Ib,fc,sc,Tc,ad,cd){const zd={};zd.a=ad;zd.b=Ib;zd.c=fc;zd.d=Q;zd.e=Wa;zd.f=sc;zd.g=Tc;zd.h=cd;Pi.b().Of(36,zd)}qIe(){if(Xi.a.CHf())k.ULS.sendTraceTag(537170433,1302,15,"OBF is undefined");else{try{OfficeBrowserFeedback.createScreenshot(document.body).then(this.ZWf);
return}catch(Q){k.ULS.sendTraceTag(537170432,1302,15,"Failed to use createScreenshot "+(Q?Q.toString():null))}try{OfficeBrowserFeedback.html2canvas(document.body,null)().then(this.ZWf)}catch(Q){k.ULS.sendTraceTag(537170403,1302,15,"Failed to use html2canvas"+(Q?Q.toString():null))}}}oCc(Q,Wa=null,Ib=!1,fc=null,sc=null,Tc=!0){var ad=Q.SolutionId;let cd=Dc.Task.Ua(!1);Q&&ad&&Q.SharedRuntimeId&&(fc=fc||new jh.a(-859308420,0,2,0,""),ad={},ad.solutionId=Q.SolutionId,ad.version=Q.Version,ad.storeType=Q.StoreType,
ad.storeId=Q.StoreId,ad.assetId=Q.AssetId,ad.assetStoreId=Q.AssetStoreId,ad.height=Q.Height,ad.targetType=Q.TargetType,ad.width=0,ad.isAddinCommands=!1,ad.sharedRuntimeId=Q.SharedRuntimeId,Q.Preload=Tc,sc=sc?sc:new gh.a,sc.width=0,Wa&&(sc.focusOnIframeWhenLoaded=Wa.focusOnIframeWhenLoaded,Tc=new ei,Wa.sl&&(Tc.AHc=Wa.sl),0<Wa.taskPaneWidth&&(Tc.nx=Wa.taskPaneWidth),Wa.iQ&&(Tc.yHc=Wa.iQ),z.EwaSettings.isChangeGateEnabled("OfficeVSO:7644290_MsFormsCorrelationId")&&Wa.VA&&(this.Dqa[Q.SolutionId]=Wa.VA),
this.rjd[Q.SolutionId]=Tc,this.mWd[Q.SolutionId]=Wa.onExtensionLaunchCallback),Wa={},Wa[Hg.a.Og]=Q,Wa[Gb.a.Dja]=ad,Wa[gh.a.key]=sc,Wa[Wd.a.lra]=Ib,cd=this.insertAgave(Wa,fc));return cd}zAa(Q,Wa,Ib,fc,sc,Tc=null){if(Q&&Ib){Q=new ni.a(Q,OSF.StoreType.Sdx,OSF.StoreType.Sdx,sc);sc=new wi.a("ExcelOnline","Web",this.$.xa.UICultureTag);const ad=new xi.a;ad.optionalProperties[vg.a.M0c]=fc;Tc&&(Tc.sourceLocationOverrideResourceId&&(ad.optionalProperties[vg.a.sourceLocationOverrideResourceId]=Tc.sourceLocationOverrideResourceId),
Tc.sl&&(ad.optionalProperties[vg.a.sl]=Tc.sl),Tc.Dl&&(ad.optionalProperties.IconCssClass=Tc.Dl),Tc.M3d&&(ad.optionalProperties.TaskPaneIconUrl=Tc.M3d),Tc.iQ&&(ad.optionalProperties.TaskPaneIconId=Tc.iQ),Tc.onExtensionLaunchCallback&&(ad.optionalProperties[vg.a.onExtensionLaunchCallback]=Tc.onExtensionLaunchCallback));yi.a.instance.zAa(Q,Wa,Ib,sc,ad)}}Lai(Q){if(!oi.a.Gh(Q)){var Wa=Q[th.a.Yyb];if(Wa&&(Wa=Wa.getId(),Q=Q[th.a.Cfa],Wa&&Q))return this.wNa(Wa,Q.optionalProperties[vg.a.sourceLocationOverrideResourceId])}return null}wNa(Q,
Wa=null){return Q&&Wa?`${Q}.${Wa}`:Q}Q2h(Q){switch(Q){case 1172793074:case 1221897806:case 1930653487:return 2;case -515602470:case 2086613372:return z.EwaSettings.ya(217)?1023:1;case 1723441034:return 1023;case -859308420:return 1023;case 515196233:return 1023;case 301511274:return 1023;default:return 1}}C5d(){this.$.ea.fg?this.oRd():(this.$.ea.yk(this.oRd),this.Kfb=!0)}lgi(){var Q=this.$.da.Ba(20);if(!Q)return this.C5d(),"";Q=Q.Dya();if(!Q)return this.C5d(),"";var Wa=this.$.ua.getItemByName(this.$.ea.isNamedObjectViewMode?
this.$.na.sheetName:this.$.na.name);Wa=$h.d(Wa);var Ib=dc.h(this.$).ga.pa.selectedRanges;const fc=[];for(const Tc of Ib){Ib=new T.a(Tc,Wa);var sc=Q.l8a(Ib,ai.Valid);Ib=[];if(sc)for(const ad of sc)(sc=ad.table.XB)&&(sc=sc.range.toString())&&Ib.push(sc);Ib=new Ai(Tc.toString(),Ib);fc.push(Ib)}return JSON.stringify(fc)}}rb.wLd="IDS";rb.kkf="FA000000012";rb.ePa="FA000000005";rb.mpi="HelloWorld";rb.cdh="FA000000014";rb.njc="Help.GiveFeedback.Url";rb.ujh="Help.ContactSupport.Url";rb.uRh="feedback";rb.Xyf=
"FA000000066";rb.Skj="PowerBi.Url";rb.Qkj="PowerBi.DevUrl";rb.Rkj="FA000000054";rb.zYi="FA000000064";rb.Ffj="FA000000075";rb.E5b="AnalyzeDataTaskPane";rb.isj="RecommendedChartsTaskPane";rb.Xij="PivotTableTaskPane";rb.ISe=350;rb.Klf=320;rb.Jnj=320;rb.klh="FA000000124";rb.llh="Copilot (Preview)";rb.ZZg="g_InstallOrigin";Object(e.a)(rb,"AgaveCommandManager",Tf.a,[741,742]);class ec extends f.a{constructor(Q){super();this.$=Q;this.uc()}create(){const Q=this.$.da,Wa=Kg.GetServiceTaskFactory.create(Q,106,
this.ka,this.La),Ib=Kg.GetServiceTaskFactory.create(Q,104,this.ka,this.La),fc=Gi.a.loadScript(35,0,this.La,void 0,void 0,375);Wf.TaskExtensions.za(Wf.TaskExtensions.xe([Ib,Wa,fc],this.ka),()=>{let sc=null;z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)&&(sc=fd.a.instance.Dc("Common.App.CustomerFeedback.ICustomerFeedbackFormManager").instance);Hh.instance.initialize(Wa.result);const Tc=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PreloadRaceCondition6395242",
!0)?Object(Fi.a)(this.$.da,374,()=>new rb(this.$,Wa.result,Ib.result,sc,Zd.AFrameworkApplication.dc)):new rb(this.$,Wa.result,Ib.result,sc,Zd.AFrameworkApplication.dc);Q.Ja(206,Tc);this.$b(Q.Ba(374)||Q.Ja(374,Tc))},this.ka,3);fd.a.instance.register(Li.a,"Common.Utils.AriaNotifier").as("Common.Utils.IAriaNotifier").gd().od(()=>new Li.a(this.$.Hw))}static la(Q){Q.da.Ja(375,new ec(Q))}}Object(e.a)(ec,"AgaveCommandManagerFactory",f.a,[]);var yc=a(1381),Lc=a(764);class $c{constructor(){this.Gfe=this.afe=
this.Uha=null;this.Gnb=0}get displayName(){return this.Uha}set displayName(Q){this.Uha=Q}get email(){return this.afe}set email(Q){this.afe=Q}get federationProvider(){return this.Gfe}set federationProvider(Q){this.Gfe=Q}get identityType(){return this.Gnb}set identityType(Q){this.Gnb=Q}getTypeName(){return"Microsoft.Authentication.OfficeIdentityInfo"}invokePropertyGet(Q){switch(Q){case 4:return this.displayName;case 3:return this.email;case 2:return this.federationProvider;case 1:return this.identityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);
}invokePropertyGetAsync(Q){Q=this.invokePropertyGet(Q);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}invokePropertySet(Q,Wa){switch(Q){case 4:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Wa,0,"string");return;case 3:this.email=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Wa,0,"string");return;case 2:this.federationProvider=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Wa,0,"string");return;case 1:this.identityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Wa,
0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertySetAsync(Q,Wa){this.invokePropertySet(Q,Wa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokeMethodAsync(Q,Wa){Q=this.invokeMethod(Q,Wa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}static zoh(Q){const Wa=new $c;Wa.displayName=Q.displayName;Wa.email=Q.email;
switch(Q.authority){case yc.a.ITf:Wa.identityType=1;break;default:Wa.identityType=0}Wa.federationProvider="";return Wa}}Object(e.a)($c,"OfficeIdentityInfo",null,[]);class jd{static get wYe(){return jd.IGg}static vhc(Q){return Q in jd.wYe?jd.wYe[Q].toString():Q}}jd.IGg={["GeneralException"]:Lc.a.generalException,["AccessDenied"]:Lc.a.H0c,["ApiNotAvailable"]:Lc.a.apiNotAvailable,["UserNotSignedIn"]:Lc.a.userNotSignedIn,["UserAborted"]:Lc.a.userAborted,["UnsupportedUserIdentity"]:Lc.a.bdk,["InvalidResourceUrl"]:Lc.a.invalidResourceUrl,
["InvalidGrant"]:Lc.a.invalidGrant,["AddinIsAlreadyRequestingToken"]:Lc.a.a_g,["ResourceNotAllowed"]:Lc.a.lEj,["ClientError"]:Lc.a.clientError,["ServerError"]:Lc.a.serverError};jd.map=null;Object(e.a)(jd,"SingleSignOnErrorCodeMap",null,[]);class Fc{constructor(Q,Wa){this.nWb=Q;this.Gnb=Wa}get accessToken(){return this.nWb}set accessToken(Q){this.nWb=Q}get tokenIdenityType(){return this.Gnb}set tokenIdenityType(Q){this.Gnb=Q}getTypeName(){return"Microsoft.Authentication.SingleSignOnToken"}invokePropertyGet(Q){switch(Q){case 2:return this.accessToken;
case 3:return this.tokenIdenityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertyGetAsync(Q){Q=this.invokePropertyGet(Q);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}invokePropertySet(Q,Wa){switch(Q){case 2:this.accessToken=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Wa,0,"string");return;case 3:this.tokenIdenityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Wa,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);
}invokePropertySetAsync(Q,Wa){this.invokePropertySet(Q,Wa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokeMethodAsync(Q,Wa){Q=this.invokeMethod(Q,Wa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}}Object(e.a)(Fc,"SingleSignOnToken",null,[]);class gd{constructor(){this.nbe=null;this.Bqe=this.$0b=this.zF="";this.Ore=!0;this.options=null}get authChallenge(){return this.nbe}set authChallenge(Q){this.nbe=
Q}get correlationId(){return this.zF}set correlationId(Q){this.zF=Q}get policy(){return null}set policy(Q){}get resource(){return this.$0b}set resource(Q){this.$0b=Q}get scope(){return this.Bqe}set scope(Q){this.Bqe=Q}get silentLogin(){return this.Ore}set silentLogin(Q){this.Ore=Q}getTypeName(){return"Microsoft.Authentication.TokenParameters"}invokePropertyGet(Q){switch(Q){case 3:return this.authChallenge;case 7:return this.correlationId;case 4:return this.policy;case 2:return this.resource;case 5:return this.scope;
case 6:return this.silentLogin}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertyGetAsync(Q){Q=this.invokePropertyGet(Q);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}invokePropertySet(Q,Wa){switch(Q){case 3:this.authChallenge=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Wa,0,"string");return;case 7:this.correlationId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Wa,0,"string");return;case 4:this.policy=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Wa,
0,"string");return;case 2:this.resource=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Wa,0,"string");return;case 5:this.scope=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Wa,0,"string");return;case 6:this.silentLogin=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Wa,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertySetAsync(Q,Wa){this.invokePropertySet(Q,Wa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);
}invokeMethodAsync(Q,Wa){Q=this.invokeMethod(Q,Wa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}}Object(e.a)(gd,"TokenParameters",null,[412]);class wd{constructor(Q,Wa){this.cmb=Wa;this.zx=Q}get roamingSettings(){return null}getAccessToken(Q){const Wa=this.cmb.getOsfControl(this.zx),Ib=Wa.getManifest(),fc=Ib.getMarketplaceID();this.xRa(Q,fc);return OfficeExtension.WacRuntime.Utility.createPromise((sc,Tc)=>{Wa.isFirstParty()&&this.cmb._enableFirstPartySSO?this.jzi(Ib,Q)?fd.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAccessToken(Q,
fc).then(ad=>{sc(ad)},ad=>{Tc(ad)}):Tc(Lc.a.H0c):Tc(Lc.a.apiNotAvailable)}).then(sc=>{let Tc;switch(sc.authority){case yc.a.ITf:Tc=1;break;default:Tc=0}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Fc(sc.accessToken,Tc))},sc=>{this.logErrorResponse(Q,fc,sc);return sc?OfficeExtension.WacRuntime.Utility.createPromise((Tc,ad)=>{ad(OfficeExtension.WacRuntime.Utility.createRichApiException(sc,jd.vhc(sc)))}):OfficeExtension.WacRuntime.Utility.createPromise((Tc,ad)=>{ad(OfficeExtension.WacRuntime.Utility.createRichApiException(Lc.a.generalException,
jd.vhc(Lc.a.generalException)))})})}getAuthContext(){return null}getPrimaryIdentityInfo(){const Q=this.cmb.getOsfControl(this.zx);Q.getManifest();const Wa=Q.getManifest().getMarketplaceID();return OfficeExtension.WacRuntime.Utility.createPromise((Ib,fc)=>{fd.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getPrimaryIdentityInfo(Wa).then(sc=>{Ib(sc)},sc=>{fc(sc.toString())})}).then(Ib=>{Ib=$c.zoh(Ib);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Ib)},Ib=>Ib?OfficeExtension.WacRuntime.Utility.createPromise((fc,
sc)=>{sc(OfficeExtension.WacRuntime.Utility.createRichApiException(Ib,jd.vhc(Ib)))}):OfficeExtension.WacRuntime.Utility.createPromise((fc,sc)=>{sc(OfficeExtension.WacRuntime.Utility.createRichApiException(Lc.a.generalException,jd.vhc(Lc.a.generalException)))}))}getTypeName(){return"Microsoft.Authentication.AuthenticationService"}invokePropertyGet(Q){switch(Q){case 99:return this.roamingSettings}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertyGetAsync(Q){Q=this.invokePropertyGet(Q);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}invokePropertySet(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertySetAsync(Q,Wa){this.invokePropertySet(Q,Wa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokeMethodAsync(Q,Wa){switch(Q){case 1:return this.ZZh(Wa);case 3:return this.p0h();case 2:return this.Sbi()}Q=this.invokeMethod(Q,
Wa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}ZZh(Q){Q=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Q,0,gd);return this.getAccessToken(Q)}p0h(){return this.getAuthContext()}Sbi(){return this.getPrimaryIdentityInfo()}jzi(Q,Wa){let Ib=!1;const fc=Q.getWebApplicationAuthorizations();Q=null;for(const sc of fc)if(sc.getResource().toLowerCase()===Wa.resource.toLowerCase()){Q=sc;Ib=!0;break}if(!Ib)return!1;Wa=Wa.scope.split(" ,+");for(const sc of Wa)if(sc&&sc.length){Wa=
!1;for(const Tc of Q.getScopes())sc.toLowerCase()===Tc.toLowerCase()&&(Wa=!0);if(!Wa)return!1}return!0}xRa(Q,Wa){Q=this.tHf(Q.resource);k.ULS.sendTraceTag(538572831,369,50,"{0}",{["manifestId"]:Wa,["resource"]:Q})}logErrorResponse(Q,Wa,Ib){Q=this.tHf(Q.resource);k.ULS.sendTraceTag(538572830,369,10,"{0}",{["manifestId"]:Wa,["resource"]:Q,["error"]:Ib})}tHf(Q){return Q.replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(e.a)(wd,"AuthenticationService",null,[]);class Ad{create(Q,
Wa){return new wd(Q,Wa)}}Object(e.a)(Ad,"AuthenticationServiceFactory",null,[]);var Gd=a(118),be=a(891),ze=a(1017),Le=a(1001);class ff{}ff.generalException="generalException";ff.invalidArgument="invalidArgument";ff.notAllowed="notAllowed";ff.apiNotAvailable="apiNotAvailable";ff.unresolvedPendingRequest="unresolvedPendingRequest";ff.timeout="timeout";ff.adalTimeout="adalTimeout";ff.userNotSignedIn="userNotSignedIn";ff.userAborted="userAborted";ff.silentSignInFailed="silentSignInFailed";ff.invalidResourceUrl=
"invalidResourceUrl";ff.invalidGrant="invalidGrant";ff.connectionLost="connectionLost";ff.clientError="clientError";ff.serverError="serverError";Object(e.a)(ff,"WopiHostErrorCodes",null,[]);var gg=a(428);class Yf{}Object(e.a)(Yf,"OAuthCallerMetadata",null,[]);var uf=a(31);class ng{constructor(Q){this.PAa=Q;this.zGg=Zd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}BRg(Q,Wa,Ib,fc,sc,Tc){if(!this.PAa)return fc=new ze.a,fc.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,
Promise.resolve(fc);const ad=new Yf;ad.AddinName=sc;ad.AddinTrustId=Tc;let cd=-1;Tc=null;if(fc&&this.asf())Tc=this.PAa.Tqg(Gb.a.SHc,Q,fc,ng.rdf(sc),ad);else{const zd=Date.now();Tc=this.PAa.kD(Gb.a.SHc,Q,ad).then(Qd=>{cd=Date.now()-zd;const Ae=(Wa||Ib)&&"login_required"===Qd.ErrorCode;return(Wa&&("interaction_required"===Qd.ErrorCode||"consent_required"===Qd.ErrorCode||"invalid_grant"===Qd.ErrorCode)||Ae)&&this.asf()?this.PAa.Tqg(Gb.a.SHc,Q,null,ng.rdf(sc),ad):Promise.resolve(Qd)})}return Tc.then(zd=>
{const Qd=new ze.a;zd.IsSuccess?(Qd.token=zd.Token,zd.Telemetry&&(Qd.lXa=zd.Telemetry.fromCache,Qd.expiresOn=zd.Telemetry.expiresOn)):(Qd.errorCode=this.rUi(zd),Qd.T3d=this.Wgj(zd));return Qd}).catch(()=>{const zd=new ze.a;zd.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(zd)}).then(zd=>{zd.Pja="OauthManager";0<=cd&&(zd.ZBb=cd);return zd})}MBi(Q){const Wa=(Zd.AFrameworkApplication.fa.Va(Zd.AFrameworkApplication.P$)||"").toLowerCase();return(uf.a.gAa||"teams"===
Wa&&gg.OAuthManagerSettings.jDb)&&!ng.qBi(Q)||!this.PAa||!this.PAa.APa()?!1:!0}asf(){return this.zGg||1!==Le.a.Ggc()}rUi(Q){switch(Q.ErrorCode){case "UserCancelled":case "interaction_required":Q=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;case "consent_required":case "invalid_grant":Q=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":Q=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":Q=
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;break;case "invalid_resource":Q=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":Q=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;break;default:Q=Q.ErrorCode===ff.userAborted?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:Q.ErrorCode===ff.silentSignInFailed?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:Q.ErrorCode===ff.invalidResourceUrl?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:
Q.ErrorCode===ff.invalidGrant?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:Q.ErrorCode===ff.connectionLost?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return Q}Wgj(Q){let Wa="";(Q=RegExp("AADSTS(\\d+)").exec(Q.ErrorMessage))&&1<Q.length&&(Wa=Q[1]);return Wa}static rdf(Q){return String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,Q)}static qBi(Q){if(!Q)return!1;Q=Q.toLowerCase();for(const Wa of be.AppsForOfficeSingleSignOnManager.O4e)if(Wa===
Q)return!0;return!1}}Object(e.a)(ng,"AppsforOfficeTokenFromOauthManager",null,[218]);class If{constructor(Q){this.zTi=Q}static Dra(){if(Zd.AFrameworkApplication.fa.ra("AppForOfficeSSOV2IsEnabled")){var Q=null;try{Q=fd.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(Wa){k.ULS.sendTraceTag(592061330,1300,10,"Unable to resolve IOAuthManager: "+Wa)}Q=new ng(Q);If.Oa=new If(Q)}}static getInstance(){If.Hhe||(If.Dra(),If.Hhe=!0);return If.Oa}}If.Oa=null;If.Hhe=!1;Object(e.a)(If,"AppsForOfficeOauthManagerFactory",
null,[179]);var xg=a(1380),Qg=a(147);class Vg{constructor(Q,Wa,Ib,fc){this.menuItemId=Q;this.lF=Wa;this.q3j=Ib;this.eSh=fc}}Object(e.a)(Vg,"NewDocumentParameters",null,[]);const ah=Q=>{var Wa=Q.addType("Microsoft.Office.ActionService","{b9b4137f-8502-4b7a-9f64-d9b7c69bf883}","{df562add-0bb3-47cb-9780-0bd6c054e5e8}",3,0);var Ib=Wa.addMethod("AreShortcutsInUse",3,"Object[]",1,0,"AreShortcutsInUse",0);Ib.addParameter("shortcuts","String[]",1,null,0);Wa.addMethod("GetShortcuts",1,"Object",1,1,"Shortcuts",
0);Ib=Wa.addMethod("ReplaceShortcuts",2,"Void",0,0,"ReplaceShortcuts",0);Ib.addParameter("shortcuts","Object",1,null,0);Wa=Q.addType("Microsoft.Office.SharedFilePicker","{209dd80f-a169-43dd-be1e-504a1a11a736}","{3f72536f-72cd-42d9-b4fd-eb8f8561e1f5}",3,0);Ib=Wa.addMethod("GetSharedFilePickerResponse",1,"Object",1,1,"SharedFilePickerResponse",0);Ib.addParameter("pickerCustomizationJsonString","String",1,null,0);Wa=Q.addType("Microsoft.Office.Auth","{8f3d8395-fba3-422f-9e98-33e38d23c2ba}","{e1b105a8-d9d5-4fc8-aa4e-3d90aeb48abf}",
3,2);Ib=Wa.addMethod("GetAccessTokenFirstPartyOAuth",1,"Object",1,1,"AccessTokenFirstPartyOAuth",4);Ib.addParameter("appName","String",1,null,0);Ib.addParameter("target","String",1,null,0);Wa=Q.addType("Microsoft.Office.AugLoopHostMessageReceivedEventArgs","{52ebe40e-6476-4f8d-81cb-89f5c90e2e76}","{891f2f5b-6598-4c8e-af9d-dc48bf34839f}",2,0);Wa.addProperty("Data",4,"String",1,!1,null,0);Wa=Q.addType("Microsoft.Office.AugLoopEventService","{846cb932-2065-4d2e-b051-5d6673cca2d9}","{019765ca-6d77-447a-9bd8-b07dc47bc657}",
3,2);Ib=Wa.addMethod("SendMessage",1,"Void",0,1,"SendMessage",4);Ib.addParameter("data","String",1,null,0);Wa.addMethod("_RegisterHostMessageReceivedEvent",2,"Void",0,1,"_RegisterHostMessageReceivedEvent",4);Wa.addMethod("_UnregisterHostMessageReceivedEvent",3,"Void",0,1,"_UnregisterHostMessageReceivedEvent",4);Wa=Q.addType("Microsoft.Office.CopilotOperationStartedEventArgs","{45400499-b374-4bc9-a709-18989d9cebd1}","{a7c458d5-f043-4d71-b091-03160b2c450e}",2,0);Wa.addProperty("BatchId",6,"String",
1,!1,null,0);Wa=Q.addType("Microsoft.Office.UndoService","{69f39738-6c6b-4497-9833-02728cf72dc3}","{9628bdd5-9267-4ca8-8162-82d0a7e484f8}",3,2);Ib=Wa.addMethod("EndCopilotOperation",5,"Void",0,0,"EndCopilotOperation",4);Ib.addParameter("batchId","String",1,null,0);Ib=Wa.addMethod("StartCopilotOperation",4,"Boolean",1,0,"StartCopilotOperation",4);Ib.addParameter("batchId","String",1,null,0);Wa.addMethod("Undo",1,"Boolean",1,0,"Undo",4);Wa.addMethod("_RegisterUndoStackChangedEvent",2,"Void",0,1,"_RegisterUndoStackChangedEvent",
4);Wa.addMethod("_UnregisterUndoStackChangedEvent",3,"Void",0,1,"_UnregisterUndoStackChangedEvent",4);Wa=Q.addType("Microsoft.ExcelServices.WacWorkbook","{79eea901-609d-4204-a8f6-9f40f367a679}","",3,0);Ib=Wa.addMethod("CreateAndOpenWorkbook",1,"Void",0,1,"CreateAndOpenWorkbook",0);Ib.addParameter("base64File","String",1,null,0);Wa=Q.addType("Microsoft.ExcelServices.AppRuntimeService","{21351f4a-8ee5-42e7-9776-62f23a567703}","",3,0);Wa.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",
1,1,"AppRuntimeState",0);Ib=Wa.addMethod("SetAppRuntimeState",1,"Void",0,1,"SetAppRuntimeState",0);Ib.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);Wa=Q.addType("Microsoft.ExcelServices.CustomFunctionManager","{158db0d2-762c-449f-9917-b7c4778971ef}","{1a8cbe28-44d1-4b9a-9cd2-69311e909c1a}",3,0);Wa.addProperty("Status",2,"Microsoft.ExcelServices.CustomFunctionEngineStatus",2,!0,null,0);Ib=Wa.addMethod("Register",1,"Void",0,0,"Register",0);Ib.addParameter("metadata",
"String",1,null,0);Ib.addParameter("javascript","String",1,null,0);Wa=Q.addType("Microsoft.ExcelServices.CustomFunctionEngineStatus","{22864d76-d53e-416b-b496-23e5bb38ebd0}","",2,0);Wa.addProperty("Enabled",1,"Boolean",1,!1,null,0);Wa.addProperty("NativeRuntime",3,"Boolean",1,!1,null,0);Wa.addProperty("StreamingEnabled",2,"Boolean",1,!1,null,0);Wa=Q.addEnumType("Microsoft.Authentication.IdentityType");Wa.addEnumField("OrganizationAccount",0);Wa.addEnumField("MicrosoftAccount",1);Wa=Q.addEnumType("Microsoft.Authentication.AuthorityType");
Wa.addEnumField("External",0);Wa.addEnumField("Msa",1);Wa.addEnumField("Aad",2);Wa=Q.addType("Microsoft.Authentication.OfficeIdentityInfo","{4c070280-74b4-4850-adfd-178c6c287817}","{8b83e3cb-6183-4206-bbcf-cc019d857327}",2,0);Wa.addProperty("DisplayName",4,"String",1,!1,null,0);Wa.addProperty("Email",3,"String",1,!1,null,0);Wa.addProperty("FederationProvider",2,"String",1,!1,null,0);Wa.addProperty("IdentityType",1,"Microsoft.Authentication.IdentityType",1,!1,null,0);Wa=Q.addType("Microsoft.Authentication.AuthContext",
"{fd7bb67b-838a-4e86-84df-43023e360260}","{14d05e71-cb07-4eb7-bb51-93bc432750f9}",2,0);Wa.addProperty("AppId",4,"String",1,!1,null,0);Wa.addProperty("Authority",2,"String",1,!1,null,0);Wa.addProperty("AuthorityType",3,"Microsoft.Authentication.AuthorityType",1,!1,null,0);Wa.addProperty("IsAnonymous",5,"Boolean",1,!1,null,0);Wa.addProperty("TenantId",6,"String",1,!1,null,0);Wa.addProperty("Upn",1,"String",1,!1,null,0);Wa=Q.addType("Microsoft.Authentication.AuthenticationService","{3084014c-8862-4ad3-adf6-fb105947dd9a}",
"{799af6f3-8bf5-4859-8aca-7dd712862fca}",3,0);Wa.addProperty("RoamingSettings",99,"Microsoft.Authentication.RoamingSettingCollection",3,!0,null,0);Ib=Wa.addMethod("GetAccessToken",1,"Microsoft.Authentication.SingleSignOnToken",2,1,"AccessToken",4);Ib.addParameter("tokenParameters","Microsoft.Authentication.TokenParameters",2,null,0);Wa.addMethod("GetAuthContext",3,"Microsoft.Authentication.AuthContext",2,1,"AuthContext",0);Wa.addMethod("GetPrimaryIdentityInfo",2,"Microsoft.Authentication.OfficeIdentityInfo",
2,1,"PrimaryIdentityInfo",4);Wa=Q.addType("Microsoft.Authentication.TokenParameters","{d9b0bca1-16af-48a6-b707-3b2bc97b082e}","{6e979115-496c-4ded-8ffb-b21d9ae45a6c}",2,0);Wa.addProperty("AuthChallenge",3,"String",1,!1,null,0);Wa.addProperty("CorrelationId",7,"String",1,!1,null,0);Wa.addProperty("Policy",4,"String",1,!1,null,0);Wa.addProperty("Resource",2,"String",1,!1,null,0);Wa.addProperty("Scope",5,"String",1,!1,null,0);Wa.addProperty("SilentLogin",6,"Boolean",1,!1,null,0);Wa=Q.addType("Microsoft.Authentication.SingleSignOnToken",
"{dd692cad-089f-4adf-b070-bb12a957fef1}","{21e799a6-33ec-4ec7-8e74-fe7c4765a59f}",2,0);Wa.addProperty("AccessToken",2,"String",1,!1,null,0);Wa.addProperty("TokenIdenityType",3,"Microsoft.Authentication.IdentityType",1,!1,null,0);Wa=Q.addType("Microsoft.Authentication.RoamingSetting","{4f7e9fad-cbd7-4d76-8dab-9a2f7dc00141}","",3,0);Wa.addProperty("Id",1,"String",1,!0,null,0);Wa.addProperty("Value",2,"Object",1,!1,null,0);Wa=Q.addType("Microsoft.Authentication.RoamingSettingCollection","{f9e004e4-a087-42ec-b22d-51ac584551a9}",
"",3,0);Ib=Wa.addMethod("GetItem",1,"Microsoft.Authentication.RoamingSetting",3,1,"Item",0);Ib.addParameter("id","String",1,null,0);Ib=Wa.addMethod("GetItemOrNullObject",2,"Microsoft.Authentication.RoamingSetting",3,1,"ItemOrNullObject",0);Ib.addParameter("id","String",1,null,0);Wa=Q.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}","{43a4559c-806b-4e89-914e-da9256212148}",3,0);Wa.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",
0);Ib=Wa.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0);Ib.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);Wa=Q.addEnumType("Microsoft.AppRuntime.AppRuntimeState");Wa.addEnumField("Inactive",0);Wa.addEnumField("Background",1);Wa.addEnumField("Visible",2);Wa=Q.addEnumType("Microsoft.AppRuntime.Visibility");Wa.addEnumField("Hidden",1);Wa.addEnumField("Visible",2);Wa=Q.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}",
"{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);Wa.addProperty("Buttons",4,"Microsoft.DynamicRibbon.RibbonButtonCollection",3,!0,null,0);Ib=Wa.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",0);Ib.addParameter("jsonCreate","String",1,null,0);Ib=Wa.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);Ib.addParameter("jsonUpdate","String",1,null,0);Ib=Wa.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);Ib.addParameter("id","String",
1,null,0);Ib=Wa.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",3,1,"Tab",0);Ib.addParameter("id","String",1,null,0);Wa.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Wa=Q.addType("Microsoft.DynamicRibbon.RibbonTab","{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);Wa.addProperty("Id",2,"String",1,!0,null,0);Ib=Wa.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",0);Ib.addParameter("visibility","Boolean",1,null,0);Wa.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Wa=Q.addType("Microsoft.DynamicRibbon.RibbonButton",
"{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}","",3,0);Wa.addProperty("Enabled",3,"Boolean",1,!1,null,0);Wa.addProperty("Id",2,"String",1,!0,null,0);Wa.addProperty("Label",4,"String",1,!0,null,0);Ib=Wa.addMethod("SetEnabled",5,"Void",0,0,"SetEnabled",0);Ib.addParameter("enabled","Boolean",1,null,0);Wa.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Wa=Q.addType("Microsoft.DynamicRibbon.RibbonButtonCollection","{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);Wa.addMethod("GetCount",3,"Int32",1,1,"Count",
0);Ib=Wa.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",3,0);Ib.addParameter("key","String",1,null,0);Wa.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Wa.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",!0);Wa=Q.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");Wa.addEnumField("Unknown",0);Wa.addEnumField("Basic",1);Wa.addEnumField("Premium",2);Wa=Q.addType("Microsoft.Office.Licensing.License","{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",
3,0);Ib=Wa.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",1,1,"FeatureTier",0);Ib.addParameter("feature","String",1,null,0);Ib.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);Ib=Wa.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",0);Ib.addParameter("feature","String",1,null,0);Ib=Wa.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);Ib.addParameter("feature","String",
1,null,0);Ib.addParameter("fallbackValue","Boolean",1,null,0);Wa.addMethod("IsFreemiumUpsellEnabled",3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);Ib=Wa.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0);Ib.addParameter("experienceId","String",1,null,0);Ib=Wa.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",4);Ib.addParameter("feature","String",1,null,0);Wa=Q.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}",
"",3,0);Wa.addProperty("Id",5,"String",1,!0,null,0);Wa.addMethod("_RegisterStateChange",6,"Void",0,1,"_RegisterStateChange",0);Wa.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);Wa=Q.addType("Microsoft.InternalService.AddinInternalService","{4ddc0abf-728b-44e0-b834-138c166e2651}","{16374866-b755-4a62-8e65-ad23696872b0}",3,0);Wa.addMethod("NotifyActionHandlerReady",1,"Void",0,1,"NotifyActionHandlerReady",0);Wa=Q.addType("Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification",
"{d689e1c3-2ec7-4e8d-9327-7d6703cde2c5}","{bc4e14a3-3463-425f-8e52-07b578e4c4b7}",3,0);Wa.addMethod("Disable",3,"Void",0,1,"Disable",0);Wa.addMethod("Enable",2,"Void",0,1,"Enable",0);Wa.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0)};var Eg=a(200);class rh{constructor(Q,Wa){this.SKg=Q;this.mLg=Wa}createAndOpenWorkbook(Q){if(Q&&Q.length>this.SKg)throw k.ULS.sendTraceTag(538572821,0,15,"Too large base64 stream size:{0}",Q.length),OfficeExtension.WacRuntime.Utility.createRichApiException(Lc.a.invalidArgument,
Eg.a.ha(1769));const Wa=new Vg("blank","agave",Q?"streamBase64":"streamEmpty",Q);let Ib=null;return OfficeExtension.WacRuntime.Utility.createPromise((fc,sc)=>{const Tc=new Qg.StandardDialog;Tc.Ac=4;Tc.km(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,ad=>{2===ad||0===ad?sc("Cancelled"):(Ib=window.open(""),this.mLg.create(fc,sc,Wa).J4a())})}).then(fc=>{if(!fc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(Lc.a.generalException,Eg.a.ha(1765));
try{Ib.top.location.href=fc}catch(sc){k.ULS.sendTraceTag(538572820,0,10,"CreateWorkbook API - exception while trying to change Window.Top.Location.Href, isChrome:{0}, exception:{1}",uf.a.Wo,sc),k.ULS.sendTraceTag(538572819,0,50,"CreateWorkbook API: calling self Window.Location.Replace instead of Window.Top.Location.Replace"),Ib.location.replace(fc)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},fc=>{if("Cancelled"===fc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(Lc.a.zLd,
Eg.a.ha(1768));Ib.close();this.D6j();return null})}getTypeName(){return"Microsoft.ExcelServices.WacWorkbook"}invokePropertyGet(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertyGetAsync(Q){Q=this.invokePropertyGet(Q);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}invokePropertySet(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertySetAsync(Q,Wa){this.invokePropertySet(Q,Wa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);
}invokeMethodAsync(Q,Wa){switch(Q){case 1:return this.kmh(Wa)}Q=this.invokeMethod(Q,Wa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}kmh(Q){Q=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Q,0,"string");return this.createAndOpenWorkbook(Q)}D6j(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(Lc.a.generalException,Eg.a.ha(1765));}}Object(e.a)(rh,"WacWorkbook",null,[]);const Gh=(Q,Wa)=>{console.log("InternalTestPreviewExecution.PreviewExecutionMethod: typeof(objectId)="+
typeof Q+", objectId="+Q+", value="+Wa);return null},sh=Q=>{Q.add("InternalTest","PreviewExecutionMethod",Gh)};var yf=a(262),Je=a(762),Qf=a(763);class pf{constructor(Q){this.Ub=Q}get $(){return this.Ub}}Object(e.a)(pf,"RichApiPreviewExecutionContext",null,[]);var Of=a(25),rf=a(1019),Vf=a(216),Dg=a(220),Pg=a(132),fg=a(13);class Jh extends Dg.a{constructor(Q,Wa,Ib,fc,sc){super(Q,"Select Data");this.Utb=null;this.ZRe=Wa;this.Xcd=Ib;this.Bc=sc;this.callback=fc}get dd(){return"DdaBindingPrompt"}start(Q,
Wa){let Ib="<div class='"+Pg.a.OGh+" "+wg.a.Kv+"'><label for='{1}'>{0}</label></div>\r\n<div><input type='text' id='{1}' maxlength='388' class='"+Pg.a.zL+"' /></div>";Ib=String.format(Ib,jg.a.xi(this.Xcd.DdaBindingsMethod.PromptText.substr(0,200)),"bindingText");this.Bc.Yh(this.Kc,Ib);this.Utb=fg.DOMElementExtensions.getElementById(this.Kc,"bindingText");Q=Wa?Q.P6a(Wa,this.Xcd.DdaBindingsMethod.BindingId):null;(null===Q||void 0===Q?0:Q.IsValidRef)?(Wa=new Of.Range(Q.Reference.FirstRow+1,Q.Reference.FirstColumn+
1,Q.Reference.LastRow+1,Q.Reference.LastColumn+1,!1,!1),this.Utb.value=Q.Reference.SheetName+"!"+Wa):(Q=dc.h(this.$).ga,this.Utb.value=$h.f(this.$.na)||!Q.pa.Vh?"":Q.Uka);this.initialize();this.ah()}lr(){this.G8c();this.addButton(0);this.addButton(1);super.lr()}setFocus(){fg.DOMElementExtensions.setFocus(this.Utb)}validate(){return!0}commit(){let Q=this.Utb.value.trim();const Wa=Q.indexOf("!");-1!==Wa&&(Q=this.afi(Q.substring(0,Wa))+Q.substr(Wa));this.ZRe.addBinding(this.Xcd,Q,0,this.callback);return!0}Gva(){this.ZRe.PR.xg(Je.a.internalError,
this.callback);super.Gva()}afi(Q){Q=kh.a.trimStart(Q.trim(),"=");return Q.length?Q.startsWith("'")&&Q.endsWith("'")?Q:ua.HelperMethods.Kdc(Q):""}}Object(e.a)(Jh,"DdaBindingPrompt",Dg.a,[]);class Mh{constructor(Q){this.ea=Q}xg(Q,Wa){if(Wa){const Ib={};Ib.Error=Q;Ib.Version=this.ea.gf;Wa(Ib)}}vNa(Q,Wa){this.xg(Q,Wa)}VI(Q,Wa){this.xg(Je.a.v6e(Q.Errors[0].MessageId),Wa)}Pw(Q){Q&&Q(this.CR())}CR(){const Q={Error:0};Q.Version=this.ea.gf;return Q}}Object(e.a)(Mh,"DdaErrorGenerator",null,[]);var Ag=a(231);
class Bh{constructor(Q,Wa,Ib){this.$=Q;this.PR=Wa;this.AB=Ib}GGd(Q,Wa){const Ib=Q.DdaGoToByIdMethod.GoToType,fc=Q.DdaGoToByIdMethod.SelectionMode,sc=Q.DdaGoToByIdMethod.Id.toString().trim(),Tc=ad=>{const cd=this.$.ua.getItemByName(ad.SheetName);(null===cd||void 0===cd?0:cd.visible)?(dc.h(this.$).Eh(ad,null,null,null,3,"DdaNavigator.NavigateTo",void 0,void 0,void 0,void 0,!0),this.PR.Pw(Wa)):this.PR.xg(Je.a.Fbh,Wa)};0===Ib?this.oYi(sc,fc,Q.DdaMethod.ControlId,Tc,Wa):1===Ib?this.sYi(sc,fc,Tc,Wa):this.PR.xg(Je.a.Zck,
Wa)}oYi(Q,Wa,Ib,fc,sc){this.AB.ddaGetBinding(Ib,Q,Tc=>{if(!Ag.a(Tc)&&Tc.Result&&Tc.Result.Reference){Tc=Tc.Result;var ad={};ad.SheetName=Tc.Reference.SheetName;ad.FirstRow=Tc.Reference.FirstRow;ad.FirstColumn=Tc.Reference.FirstColumn;ad.LastRow=Tc.Reference.LastRow;ad.LastColumn=Tc.Reference.LastColumn;Bh.D3c(ad,Wa);1!==Tc.BindingType?fc(ad):this.AB.ddaGetBindingData(Ib,Q,1,0,2,0,0,-1,-1,cd=>{Ag.a(cd)||!cd.Result?this.PR.VI(cd,sc):(cd=cd.Result,2!==Wa&&(ad.FirstRow-=cd.Headers.length,0>ad.FirstRow&&
(ad.FirstRow=0)),fc(ad))},sc)}else this.PR.vNa(Je.a.Ikg,sc)},sc)}sYi(Q,Wa,Ib,fc){var sc=Xh.A(Q);sc?(sc=Xh.v(sc,this.$),Bh.D3c(sc,Wa),Ib(sc)):this.$.ea.isNamedObjectViewMode&&this.$.oc.Pk(Q)?this.$.oc.na=this.$.oc.getItemByName(Q):(sc=Tc=>{Ag.a(Tc)||!Tc.Result?this.$.ua.contains(Q)?(Tc={},Tc.SheetName=Q,Tc.FirstRow=0,Tc.FirstColumn=0,Tc.LastRow=0,Tc.LastColumn=0,Ib(Tc)):this.PR.vNa(Je.a.Ikg,fc):(Tc=Tc.Result,Bh.D3c(Tc,Wa),Ib(Tc))},this.$.ua.na?this.AB.parseRangeForGoto(Q,this.$.ua.na.name,sc,fc):this.AB.parseRange(Q,
sc,fc))}static D3c(Q,Wa){Q.LastRow=2===Wa?Q.FirstRow:Q.LastRow;Q.LastColumn=2===Wa?Q.FirstColumn:Q.LastColumn}}Object(e.a)(Bh,"DdaNavigator",null,[]);const mg=(Q,Wa,Ib,fc,sc,Tc)=>{const ad=Q.Pa(1);ad.request=Wa;return Rg.g(Q,"ExecuteRichApiRequest",ad,Ib,fc,sc,Tc,0)};var Lg=a(305),Og;(function(Q){Q[Q.unsupported=0]="unsupported";Q[Q.surface=1]="surface";Q[Q.combo=2]="combo";Q[Q.column=3]="column";Q[Q.column3D=4]="column3D";Q[Q.bar=5]="bar";Q[Q.bar3D=6]="bar3D";Q[Q.line=7]="line";Q[Q.line3D=8]="line3D";
Q[Q.pie=9]="pie";Q[Q.pie3D=10]="pie3D";Q[Q.scatter=11]="scatter";Q[Q.bubble=12]="bubble";Q[Q.area=13]="area";Q[Q.area3D=14]="area3D";Q[Q.doughnut=15]="doughnut";Q[Q.radar=16]="radar";Q[Q.stock=17]="stock";Q[Q.waterfall=18]="waterfall";Q[Q.funnel=19]="funnel";Q[Q.treemap=20]="treemap";Q[Q.sunburst=21]="sunburst";Q[Q.boxWhisker=22]="boxWhisker";Q[Q.histogram=23]="histogram";Q[Q.pareto=24]="pareto";Q[Q.regionMap=25]="regionMap";Q[Q.noVisibleSeries=26]="noVisibleSeries";Q[Q.complexDataSource=27]="complexDataSource";
Q[Q.pivotChart=28]="pivotChart"})(Og||(Og={}));Object(e.b)("ChartCategory",Og);class hg{constructor(Q,Wa){this.source=Q;this.eventId=Wa}}Object(e.a)(hg,"MacroRecorderEventData",null,[]);class ug{constructor(Q,Wa,Ib){this.parentName=Q;this.$=Wa;this.request=Ib}qdi(Q){var Wa;if(void 0===Q||null===Q||void 0===Q.RequestBody||null===Q.RequestBody)return null;const Ib=JSON.parse(Q.RequestBody);if(void 0!==Q.ActiveFloatingObjectId&&null!==Q.ActiveFloatingObjectId){Ib.ActiveFloatingObjectId=Q.ActiveFloatingObjectId;
const fc=dc.h(this.$).ga.Sa.Pc;if(null===(Wa=null===fc||void 0===fc?void 0:fc.floatingObject)||void 0===Wa?0:Wa.Pd)Ib.ActiveChartType=Og[fc.floatingObject.Pd.ChartCategory]}void 0!==Q.SheetMultiRange&&null!==Q.SheetMultiRange&&(Ib.SheetName=Q.SheetMultiRange.SheetName);return Ib}Cdi(Q){if(void 0===Q||null===Q||void 0===Q.Result||null===Q.Result)return null;Q=Q.Result;return void 0===Q.ResponseBody||null===Q.ResponseBody||Q.ResponseBody[0].startsWith('{"Error":')?null:JSON.parse(Q.ResponseBody.join(""))}KGi(Q){return!!Q&&
!(void 0===Q.eventId||null===Q.eventId)&&0<Q.eventId.length}Xk(Q){return()=>{if(this.$.oea){const Wa=this.L8g(this.request);if(this.KGi(Wa)){const Ib=this.qdi(this.request),fc=this.Cdi(Q);if(Ib&&!oi.a.isEmpty(Ib)&&fc&&!oi.a.isEmpty(fc))return k.ULS.sendTraceTag(537163164,0,50,"[RichApiRecorder]: Creating a MacroRecorderRichApiRequestExecutedPayload object."),new P(Wa,Ib,fc);k.ULS.sendTraceTag(537163163,0,50,`[RichApiRecorder]: Failed due to bad data: ${`requestInfo: ${Ib?"(not null)":"(null)"}; responseInfo: ${fc?
"(not null)":"(null)"}`}`)}}return new P(null,null,null)}}L8g(Q){const Wa=this.LGi(Q.SolutionId),Ib=ug.Xci(Q);if(Ib&&Wa)return k.ULS.sendTraceTag(537163162,0,50,`[RichApiRecorder][${this.parentName}]: ${({["recorderEventId"]:Ib,["request.SolutionId"]:Q.SolutionId})}`),new hg(Q.SolutionId,Ib);Q=JSON.stringify({["recorderEventId"]:Ib,["isRecorderAwareAddin"]:Wa,["request.SolutionId"]:Q.SolutionId});k.ULS.sendTraceTag(537163161,0,50,`[RichApiRecorder][${this.parentName}]: ${Q}`);return null}LGi(Q){if(!Q)return!1;
Q=Q.toLowerCase();return ug.gji().contains(Q)}static gji(){ug.JCa||(ug.JCa=new x.a(J.a.hh()),ug.JCa.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),ug.JCa.add("fa000000005"),ug.JCa.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),ug.JCa.add("fa000000014"),ug.JCa.add("c5daabb3-e185-4e8c-adfc-1a7b7283fb6f"));return ug.JCa}static Xci(Q){let Wa=null;var Ib=RegExp('"Name":"EnableOfficeScriptRecording".*?Arguments":\\[.*?"(.*?)"',"mi");if(Ib.test(Q.RequestBody))Wa=Ib.exec(Q.RequestBody)[1];else{Q=Q.RequestHeaders;
if(!Q)return Wa;Ib=Cc.a.d0i.toLowerCase();for(let fc=0;fc<Q.length;fc++)if(Q[fc].Name.toLowerCase()===Ib){Wa=Q[fc].Value;break}}return Wa}}ug.JCa=null;Object(e.a)(ug,"DdaRichApiRequestRecorder",null,[]);class qh extends Lg.a{constructor(Q,Wa,Ib,fc,sc,Tc,ad,cd){super(10,0,Wa,cd);this.Iqb=Ib;this.Zmb=fc;this.k6=sc;this.FIa=Tc;this.request=ad;this.qVd=new ug("10",Q,ad)}get zKc(){return this.FIa}get DH(){return this.Iqb}get Ala(){return this.Zmb}u5(Q){return super.u5(Q)||this.Bah(Q)}Xk(){return this.qVd.Xk(this.me)}pjb(){const Q=
{OperationType:3};Q.RichApiRequest=this.request;return Q}Bah(Q){return(Wa,Ib,fc)=>mg(Q,this.request,$f.b(Wa,this.Iqb),$f.a(Ib,this.Zmb),fc,this.k6)}}Object(e.a)(qh,"DdaRichApiRequestBatchOperation",Lg.a,[]);class Fh extends fi.a{constructor(Q,Wa,Ib,fc){super(576,0,Ib,fc);this.qVd=new ug("576",Q,Wa)}Xk(){return this.qVd.Xk(this.me)}}Object(e.a)(Fh,"DdaRichApiRequestOperation",fi.a,[]);class Uh{constructor(Q,Wa){this.OJ=(Ib,fc)=>{this.PR.vNa(Je.a.internalError,fc)};this.$=Q;this.PR=Wa}ddaAddBinding(Q,
Wa,Ib,fc,sc,Tc,ad){this.AL((cd,zd,Qd)=>{var Ae=this.$.qa.va,Oe=this.oma();cd=$f.b(cd,Tc);zd=$f.a(zd,this.OJ);const sf=Ae.Pa(9);sf.controlId=Q;sf.bindingId=Wa;sf.bindingType=Ib;sf.currentSheetName=Oe;sf.formula=fc;sf.options=sc;return Rg.g(Ae,"DdaAddBinding",sf,cd,zd,Qd,ad,0)},ad,563)}ddaReleaseBinding(Q,Wa,Ib,fc){this.AL((sc,Tc,ad)=>{var cd=this.$.qa.va;sc=$f.b(sc,Ib);Tc=$f.a(Tc,this.OJ);const zd=cd.Pa(9);zd.controlId=Q;zd.bindingId=Wa;return Rg.g(cd,"DdaReleaseBinding",zd,sc,Tc,ad,fc,0)},fc,564)}ddaGetBinding(Q,
Wa,Ib,fc){this.AL((sc,Tc,ad)=>{var cd=this.$.qa.va;sc=$f.b(sc,Ib);Tc=$f.a(Tc,this.OJ);const zd=cd.Pa(1);zd.controlId=Q;zd.bindingId=Wa;return Rg.g(cd,"DdaGetBinding",zd,sc,Tc,ad,fc,0)},fc,565,16)}ddaGetAllBindings(Q,Wa,Ib){this.AL((fc,sc,Tc)=>{var ad=this.$.qa.va;fc=$f.b(fc,Wa);sc=$f.a(sc,this.OJ);const cd=ad.Pa(1);cd.controlId=Q;return Rg.g(ad,"DdaGetAllBindings",cd,fc,sc,Tc,Ib,0)},Ib,566,16)}ddaGetBindingData(Q,Wa,Ib,fc,sc,Tc,ad,cd,zd,Qd,Ae){this.AL((Oe,sf,Bg)=>{var ig=this.$.qa.va,ag=this.oma();
Oe=$f.b(Oe,Qd);sf=$f.a(sf,this.OJ);const eg=ig.Pa(1);eg.controlId=Q;eg.bindingId=Wa;eg.coerceType=Ib;eg.valueFormat=fc;eg.filterType=sc;eg.startRow=Tc;eg.startCol=ad;eg.rowCount=cd;eg.colCount=zd;eg.currentSheetName=ag;return Rg.g(ig,"DdaGetBindingData",eg,Oe,sf,Bg,Ae,0)},Ae,567,16)}ddaSetBindingData(Q,Wa,Ib,fc,sc,Tc,ad){this.AL((cd,zd,Qd)=>{var Ae=this.$.qa.va,Oe=this.oma();cd=$f.b(cd,Tc);zd=$f.a(zd,this.OJ);const sf=Ae.Pa(9);sf.controlId=Q;sf.bindingId=Wa;sf.startRow=Ib;sf.startCol=fc;sf.currentSheetName=
Oe;sf.bindingData=sc;return Rg.g(Ae,"DdaSetBindingData",sf,cd,zd,Qd,ad,0)},ad,568)}ddaGetSelectedData(Q,Wa,Ib,fc,sc,Tc,ad){this.AL((cd,zd,Qd)=>{var Ae=this.$.qa.va,Oe=this.oma();cd=$f.b(cd,Tc);zd=$f.a(zd,this.OJ);const sf=Ae.Pa(1);sf.controlId=Q;sf.coerceType=Wa;sf.valueFormat=Ib;sf.filterType=fc;sf.currentSheetName=Oe;sf.formula=sc;return Rg.g(Ae,"DdaGetSelectedData",sf,cd,zd,Qd,ad,0)},ad,569,16)}ddaSetSelectedData(Q,Wa,Ib,fc,sc){this.AL((Tc,ad,cd)=>{var zd=this.$.qa.va,Qd=this.oma();Tc=$f.b(Tc,
fc);ad=$f.a(ad,this.OJ);const Ae=zd.Pa(9);Ae.controlId=Q;Ae.currentSheetName=Qd;Ae.formula=Wa;Ae.bindingData=Ib;return Rg.g(zd,"DdaSetSelectedData",Ae,Tc,ad,cd,sc,0)},sc,570)}ddaLoadSettings(Q,Wa,Ib){this.AL((fc,sc,Tc)=>{var ad=this.$.qa.va;fc=$f.b(fc,Wa);sc=$f.a(sc,this.OJ);const cd=ad.Pa(1);cd.controlId=Q;return Rg.g(ad,"DdaLoadSettings",cd,fc,sc,Tc,Ib,0)},Ib,501,16)}ddaSaveSettings(Q,Wa,Ib,fc,sc){this.AL((Tc,ad,cd)=>{var zd=this.$.qa.va;Tc=$f.b(Tc,fc);ad=$f.a(ad,this.OJ);const Qd=zd.Pa(9);Qd.controlId=
Q;Qd.settings=Wa;Qd.overwriteIfStale=Ib;return Rg.g(zd,"DdaSaveSettings",Qd,Tc,ad,cd,sc,0)},sc,571)}ddaAddRowsColumns(Q,Wa,Ib,fc,sc,Tc){this.AL((ad,cd,zd)=>{var Qd=this.$.qa.va,Ae=this.oma();ad=$f.b(ad,sc);cd=$f.a(cd,this.OJ);const Oe=Qd.Pa(9);Oe.controlId=Q;Oe.bindingId=Wa;Oe.isRow=Ib;Oe.currentSheetName=Ae;Oe.bindingData=fc;return Rg.g(Qd,"DdaAddRowsColumns",Oe,ad,cd,zd,Tc,0)},Tc,572)}ddaDeleteAllDataValues(Q,Wa,Ib,fc){this.AL((sc,Tc,ad)=>{var cd=this.$.qa.va,zd=this.oma();sc=$f.b(sc,Ib);Tc=$f.a(Tc,
this.OJ);const Qd=cd.Pa(9);Qd.controlId=Q;Qd.bindingId=Wa;Qd.currentSheetName=zd;return Rg.g(cd,"DdaDeleteAllDataValues",Qd,sc,Tc,ad,fc,0)},fc,573)}ddaClearBindingFormats(Q,Wa,Ib,fc){this.AL((sc,Tc,ad)=>{var cd=this.$.qa.va,zd=this.oma();sc=$f.b(sc,Ib);Tc=$f.a(Tc,this.OJ);const Qd=cd.Pa(9);Qd.controlId=Q;Qd.bindingId=Wa;Qd.currentSheetName=zd;return Rg.g(cd,"DdaClearBindingFormats",Qd,sc,Tc,ad,fc,0)},fc,574)}ddaSetBindingFormats(Q,Wa,Ib,fc,sc,Tc){this.AL((ad,cd,zd)=>{var Qd=this.$.qa.va,Ae=this.oma();
ad=$f.b(ad,sc);cd=$f.a(cd,this.OJ);const Oe=Qd.Pa(9);Oe.controlId=Q;Oe.bindingId=Wa;Oe.currentSheetName=Ae;Oe.bindingData=Ib;Oe.isSetFormats=fc;return Rg.g(Qd,"DdaSetBindingFormats",Oe,ad,cd,zd,Tc,0)},Tc,575)}parseRange(Q,Wa,Ib){this.AL((fc,sc,Tc)=>{const ad=this.$.qa.va.Lc();return Rg.v(this.$.qa.va,Q,-1,$f.b(fc,Wa),$f.a(sc,this.OJ),Tc,Ib,ad)},Ib,162,16)}parseRangeForGoto(Q,Wa,Ib,fc){this.AL((sc,Tc,ad)=>{const cd=this.$.qa.va.Lc();return Rg.w(this.$.qa.va,Q,Wa,$f.b(sc,Ib),$f.a(Tc,this.OJ),ad,fc,
cd)},fc,562,16)}executeRichApiRequest(Q,Wa,Ib){z.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(Q.RequestFlags&=8191);if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:7867662_RichApiUndoThirdPartyFlight")){var fc=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichApiUndoThirdParty",!1);const sc=0!==(Q.RequestFlags&128);fc||"sdxcatalog"===Q.MarketplaceType||sc||(Q.RequestFlags&=-17)}z.EwaSettings.ya(233)?this.iQh(this.$.qa.va.Lc(),Wa,()=>{this.PR.vNa(Je.a.internalError,
Ib)},Ib,Q):(fc=Ig.DdaFacade.sod(Q),!this.$.Zb.Gz||fc&16?(fc|=64,this.$.userOperationManager.uG(new Fh(this.$,Q,(sc,Tc,ad)=>mg(this.$.qa.va,Q,$f.b(sc,Wa),$f.a(Tc,this.OJ),ad,Ib),fc))):(this.PR.vNa(Je.a.ALc,Ib),k.ULS.sendTraceTag(537163160,0,50,"Write operation is not allowed")))}oma(){return this.$.ea.isNamedObjectViewMode?this.$.na.sheetName:this.$.activeItemName}AL(Q,Wa,Ib,fc=0){!this.$.Zb.Gz||fc&16?this.$.userOperationManager.uG(new fi.a(Ib,0,Q,fc|64)):(this.PR.vNa(Je.a.ALc,Wa),k.ULS.sendTraceTag(537163159,
0,50,"Write operation is not allowed"))}iQh(Q,Wa,Ib,fc,sc){let Tc=Ig.DdaFacade.sod(sc);if(!this.$.Zb.Gz||Tc&16){var ad=this.$.yc.Fd("UserAction","Rich Api request");this.$.userOperationManager.Bd(new qh(this.$,Q,Wa,Ib,fc,ad,sc,Tc|64),null)}else this.PR.vNa(Je.a.ALc,fc),k.ULS.sendTraceTag(537163158,0,50,"Write operation is not allowed")}}Object(e.a)(Uh,"DdaWebServiceHelper",null,[]);class hi{constructor(Q,Wa,Ib,fc){this.TRh=Q;this.fileSize=Wa;this.P_j=fc}}Object(e.a)(hi,"DocumentFile",null,[]);class Qh{}
Qh.generalException="GeneralException";Qh.Z0g="ApiNotFound";Qh.zLd="OperationCancelled";Qh.invalidArgument="InvalidArgument";Object(e.a)(Qh,"ErrorCodes",null,[]);class ij{replaceShortcuts(){return Promise.reject("ReplaceShortcuts method is not overridden")}getShortcuts(){return Promise.reject("GetShortcuts method is not overridden")}checkShortcutsInUse(){return Promise.reject("CheckShortcutsInUse method is not overridden")}}Object(e.a)(ij,"WacApiDelegates",null,[]);var Bj=a(633);class bj extends ij{constructor(Q,
Wa){super();this.Suf=(Ib,fc)=>{Ib=bj.Dkh(Ib,fc);if(!Bj.a(this.$,Ib))return!0;Ib=this.$.shortcutKeyManager.Ref(Ib);return!!Ib&&0<Ib.length};this.addinId=Q;this.$=Wa}replaceShortcuts(Q){return OfficeExt.ShortcutKeyDispatchManager.replaceShortcuts(this.addinId,Q,this.Suf)}getShortcuts(){return OfficeExt.ShortcutKeyDispatchManager.getShortcuts(this.addinId)}checkShortcutsInUse(Q){return OfficeExt.ShortcutKeyDispatchManager.checkShortcutsInUse(Q,this.Suf)}static fph(Q,Wa){const Ib=document.createEvent("KeyboardEvent");
if(uf.a.WG)Ib.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,!!(Q&8),!!(Q&32),!!(Q&4),!!(Q&256));else{const fc=[];Q&4&&fc.push("Shift");Q&8&&fc.push("Control");Q&32&&fc.push("Alt");Ib.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,fc.join(" "),!1,"en-US")}Q=new Sys.UI.DomEvent(Ib);Q.keyCode=Wa;return Q}static Dkh(Q,Wa){if(uf.a.Bg)switch(Wa){case 189:Wa=173;break;case 187:Wa=61;break;case 186:Wa=59}return bj.fph(Q,Wa)}}Object(e.a)(bj,"ExcelWacApiDelegates",ij,[]);class Kh{constructor(Q){this.fMa=
{};this.kVi=Q}hTg(Q,Wa){this.$jc(Q)||(this.fMa[Q]={});if(this.pBi(Q))return k.ULS.sendTraceTag(537163157,344,50,`App ${Q} has reach the limit of number of cached files.`),Je.a.RVi;this.fMa[Q][Wa.TRh.toString()]=Wa;return Je.a.success}$4h(Q,Wa){let Ib=null;this.$jc(Q)&&(Ib=this.fMa[Q][Wa.toString()]);Ib||k.ULS.sendTraceTag(537163156,344,15,`File cache for [agave:${Q}, fileHandler:${Wa}] doesn't exist`);return Ib}$jc(Q){return Q in this.fMa}Ovj(Q,Wa){if(this.$jc(Q)){const Ib=this.fMa[Q];delete Ib[Wa.toString()];
1>Object.keys(Ib).length&&delete this.fMa[Q];return Wa.toString()in Ib?Je.a.internalError:Je.a.success}return Je.a.internalError}pBi(Q){return this.$jc(Q)?Object.keys(this.fMa[Q]).length>=this.kVi:!1}static getInstance(Q){return Q.da.Ba(200)||Q.da.Ja(200,new Kh(Kh.lVi))}static YYi(){return++Kh.J$g}}Kh.MUi=4194304;Kh.lVi=1;Kh.J$g=0;Object(e.a)(Kh,"GetFileApiHelper",null,[]);class mj{constructor(Q){this.zx=Q}notifyActionHandlerReady(){OfficeExt.ShortcutKeyDispatchManager.sendQueuedActions(this.zx)}getTypeName(){return"Microsoft.InternalService.AddinInternalService"}invokePropertyGet(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);
}invokePropertyGetAsync(Q){Q=this.invokePropertyGet(Q);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}invokePropertySet(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertySetAsync(Q,Wa){this.invokePropertySet(Q,Wa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(Q){switch(Q){case 1:return this.EZi()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokeMethodAsync(Q,Wa){Q=this.invokeMethod(Q,
Wa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}EZi(){this.notifyActionHandlerReady();return null}}Object(e.a)(mj,"AddinInternalService",null,[]);class nj{constructor(Q,Wa){this.XH=Wa;this.zx=Q}getAppRuntimeState(){return this.XH.getAppRuntimeState(this.zx)?2:1}setAppRuntimeState(Q){switch(Q){case 2:Q=!0;break;case 1:Q=!1;break;default:throw OfficeExtension.WacRuntime.Utility.createRichApiException(Lc.a.invalidArgument,Eg.a.ha(1769));}this.XH.setAppRuntimeState(this.zx,Q)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimeService"}invokePropertyGet(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);
}invokePropertyGetAsync(Q){Q=this.invokePropertyGet(Q);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}invokePropertySet(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertySetAsync(Q,Wa){this.invokePropertySet(Q,Wa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(Q,Wa){switch(Q){case 2:return this.c0h();case 1:return this.TLj(Wa)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokeMethodAsync(Q,
Wa){Q=this.invokeMethod(Q,Wa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}c0h(){return this.getAppRuntimeState()}TLj(Q){Q=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Q,0,"int");this.setAppRuntimeState(Q);return null}}Object(e.a)(nj,"AppRuntimeService",null,[]);var jj=a(1020);class oj{constructor(Q,Wa,Ib,fc){this.My=Q;this.Z3=Ib;this.eA=fc.Xf.getOsfControl(Wa)}disable(){try{if(!Eg.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.LOe();
if(!this.ouf())return this.MOe();this.Z3.bck(this.My)}catch(Q){return k.ULS.sendTraceTag(538572829,0,15,"BeforeDocumentCloseNotification.Disable() Failed. reason: {0}",Q.message||"Unknown"),this.JOe()}return null}enable(){try{if(!Eg.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.LOe();if(!this.ouf())return this.MOe();this.Z3.Gtj(this.My)}catch(Q){return k.ULS.sendTraceTag(538572828,0,15,"BeforeDocumentCloseNotification.Enable() Failed. reason: {0}",
Q.message||"Unknown"),this.JOe()}return null}_OnAccess(){}getTypeName(){return"Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification"}invokePropertyGet(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertyGetAsync(Q){Q=this.invokePropertyGet(Q);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}invokePropertySet(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertySetAsync(Q,Wa){this.invokePropertySet(Q,
Wa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(Q){switch(Q){case 1:return this.CFa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokeMethodAsync(Q,Wa){switch(Q){case 3:return this.oyh();case 2:return this.iDh()}Q=this.invokeMethod(Q,Wa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}oyh(){return this.disable()}iDh(){return this.enable()}CFa(){this._OnAccess();return null}LOe(){return jj.a(Lc.a.notImplemented,
Eg.a.ha(1770))}MOe(){return jj.a(Lc.a.sharedRuntimeNotAvailable,Eg.a.ha(1774))}JOe(){return jj.a(Lc.a.generalException,Eg.a.ha(1765))}ouf(){const Q=this.eA.getSharedRuntimeId();return!!Q&&0<Q.length}}Object(e.a)(oj,"BeforeDocumentCloseNotification",null,[]);class pj{constructor(){this.nse=this.vme=this.kp=!1}get enabled(){return this.kp}set enabled(Q){this.kp=Q}get nativeRuntime(){return this.vme}set nativeRuntime(Q){this.vme=Q}get streamingEnabled(){return this.nse}set streamingEnabled(Q){this.nse=
Q}getTypeName(){return"Microsoft.ExcelServices.CustomFunctionEngineStatus"}invokePropertyGet(Q){switch(Q){case 1:return this.enabled;case 3:return this.nativeRuntime;case 2:return this.streamingEnabled}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertyGetAsync(Q){Q=this.invokePropertyGet(Q);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}invokePropertySet(Q,Wa){switch(Q){case 1:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Wa,
0,"boolean");return;case 3:this.nativeRuntime=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Wa,0,"boolean");return;case 2:this.streamingEnabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Wa,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertySetAsync(Q,Wa){this.invokePropertySet(Q,Wa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);
}invokeMethodAsync(Q,Wa){Q=this.invokeMethod(Q,Wa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}}Object(e.a)(pj,"CustomFunctionEngineStatus",null,[]);class qj{constructor(Q,Wa,Ib){this.bJg=Q;this.cJg=Wa;this.$Mg=Ib}get status(){const Q=new pj;Q.enabled=this.bJg;Q.streamingEnabled=this.cJg;Q.nativeRuntime=!1;return Q}register(Q){return OfficeExtension.WacRuntime.Utility.createPromise(this.$Mg(Q))}getTypeName(){return"Microsoft.ExcelServices.CustomFunctionManager"}invokePropertyGet(Q){switch(Q){case 2:return this.status}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);
}invokePropertyGetAsync(Q){Q=this.invokePropertyGet(Q);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}invokePropertySet(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertySetAsync(Q,Wa){this.invokePropertySet(Q,Wa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokeMethodAsync(Q,Wa){switch(Q){case 1:return this.zuj(Wa)}Q=this.invokeMethod(Q,
Wa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}zuj(Q){const Wa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Q,0,"string");Q=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Q,1,"string");return this.register(Wa,Q)}}Object(e.a)(qj,"CustomFunctionManager",null,[]);var Cj=a(1E3);class rj{constructor(Q,Wa,Ib,fc){this.ace="";this.BYb=0;this.FQ=Q;this._id=Wa;this.zx=Ib;this.XH=fc}get id(){return this._id}_RegisterStateChange(){this.BYb||this.FQ.execute(Q=>
{this.ace=Q.aUa(this._id,Wa=>{this.XH.bUh(this.zx,this._id,JSON.stringify(Wa))})});this.BYb++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}_UnregisterStateChange(){this.BYb--;this.BYb||this.FQ.execute(Q=>{Q.JRd(this._id,this.ace)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getTypeName(){return"Microsoft.Office.Licensing.LicenseFeature"}invokePropertyGet(Q){switch(Q){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);
}invokePropertyGetAsync(Q){Q=this.invokePropertyGet(Q);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}invokePropertySet(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertySetAsync(Q,Wa){this.invokePropertySet(Q,Wa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokeMethodAsync(Q,Wa){switch(Q){case 6:return this.BCg();case 7:return this.ECg()}Q=
this.invokeMethod(Q,Wa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}BCg(){return this._RegisterStateChange()}ECg(){return this._UnregisterStateChange()}}Object(e.a)(rj,"LicenseFeature",null,[]);class sj{constructor(Q,Wa){this.FQ=fd.a.instance.Dc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.zx=Q;this.XH=Wa;this.QLg=this.XH.Xf.getOsfControl(this.zx)}getFeatureTier(Q,Wa){return OfficeExtension.WacRuntime.Utility.createPromise(Ib=>{const fc=1===Wa?1:2===
Wa?2:0;this.FQ.execute(sc=>{sc.getFeatureTier(Q,fc).then(Tc=>{Ib(this.w9h(Tc))},()=>{Ib(Wa)})})})}getLicenseFeature(Q){Q=new rj(this.FQ,Q,this.zx,this.XH);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}isFeatureEnabled(Q,Wa){return OfficeExtension.WacRuntime.Utility.createPromise(Ib=>{this.FQ.execute(fc=>{fc.isFeatureEnabled(Q,Wa).then(sc=>{Ib(sc)},()=>{Ib(Wa)})})})}isFreemiumUpsellEnabled(){return OfficeExtension.WacRuntime.Utility.createPromise(Q=>{this.FQ.execute(Wa=>{Wa=
Wa.isFreemiumUpsellEnabled();Q(Wa)})})}launchUpsellExperience(Q){if(this.QLg.isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(()=>{this.FQ.execute(Wa=>{Wa.launchUpsellExperience(Q)})});throw OfficeExtension.WacRuntime.Utility.createRichApiException(Lc.a.H0c,"");}_TestFireStateChangedEvent(){}getTypeName(){return"Microsoft.Office.Licensing.License"}invokePropertyGet(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertyGetAsync(Q){Q=this.invokePropertyGet(Q);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}invokePropertySet(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertySetAsync(Q,Wa){this.invokePropertySet(Q,Wa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(Q,Wa){switch(Q){case 6:return this.CCg(Wa)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokeMethodAsync(Q,Wa){switch(Q){case 2:return this.T5h(Wa);case 5:return this.v9h(Wa);
case 1:return this.dCi(Wa);case 3:return this.TCi();case 4:return this.fNi(Wa)}Q=this.invokeMethod(Q,Wa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}T5h(Q){const Wa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Q,0,"string");Q=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Q,1,"int");return this.getFeatureTier(Wa,Q)}v9h(Q){Q=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Q,0,"string");return this.getLicenseFeature(Q)}dCi(Q){const Wa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Q,
0,"string");Q=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Q,1,"boolean");return this.isFeatureEnabled(Wa,Q)}TCi(){return this.isFreemiumUpsellEnabled()}fNi(Q){Q=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Q,0,"string");return this.launchUpsellExperience(Q)}CCg(Q){Q=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Q,0,"string");this._TestFireStateChangedEvent(Q);return null}w9h(Q){switch(Q){case 1:return 1;case 2:return 2;default:return 0}}}Object(e.a)(sj,"License",
null,[]);var Dj=a(168);const Ej=(Q,Wa,Ib)=>fc=>(sc,Tc)=>{Wf.TaskExtensions.za(Kg.GetServiceTaskFactory.create(Wa.da,279,Wa.ka,1),ad=>{ad=ad.result;let cd=!1;var zd=Ib.Xf.getOsfControl(Q);let Qd=null;zd&&(Qd=zd.getStoreType(),(zd=zd.getManifest())&&zd.getSharedRuntimeForCustomFunctions("Workbook")&&(cd=!0));Wf.TaskExtensions.za(ad.Enf(Q,Qd,fc,cd),Ae=>{Dj.b(Ae)?Ae.result?sc(null):Tc(OfficeExtension.WacRuntime.Utility.createRichApiException(Lc.a.invalidArgument,Df.a.instance.ha(1769))):Tc(OfficeExtension.WacRuntime.Utility.createRichApiException(Lc.a.generalException,
Df.a.instance.ha(1765)))},Wa.ka,3)},Wa.ka,3)};class tj{constructor(Q){if(!Q)throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument","wacApiDelegates parameter is null");this.OEd=Q}areShortcutsInUse(Q){return OfficeExtension.WacRuntime.Utility.createPromise((Wa,Ib)=>{this.OEd.checkShortcutsInUse(Q).then(fc=>{Wa(fc)}).catch(fc=>{Ib(fc)})})}getShortcuts(){return OfficeExtension.WacRuntime.Utility.createPromise((Q,Wa)=>{this.OEd.getShortcuts().then(Ib=>{Q(Ib)}).catch(Ib=>{Wa(Ib)})})}replaceShortcuts(Q){return OfficeExtension.WacRuntime.Utility.createPromise((Wa,
Ib)=>{this.OEd.replaceShortcuts(Q).then(()=>{Wa(null)}).catch(fc=>{Ib(fc)})})}getTypeName(){return"Microsoft.Office.ActionService"}invokePropertyGet(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertyGetAsync(Q){Q=this.invokePropertyGet(Q);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}invokePropertySet(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertySetAsync(Q,Wa){this.invokePropertySet(Q,Wa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);
}invokeMethodAsync(Q,Wa){switch(Q){case 3:return this.O2g(Wa);case 1:return this.ffi();case 2:return this.lBj(Wa)}Q=this.invokeMethod(Q,Wa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}O2g(Q){Q=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Q,0,"Array<string>");return this.areShortcutsInUse(Q)}ffi(){return this.getShortcuts()}lBj(Q){Q=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Q,0,"any");return this.replaceShortcuts(Q)}}Object(e.a)(tj,"ActionService",
null,[]);class uj{constructor(){this.data=null}}Object(e.a)(uj,"AugLoopHostMessageReceivedEventArgs",null,[]);var vj=a(1021);class Di{constructor(Q,Wa=!1,Ib=null){this.kGa=Q;this.c_a=Wa;this.gQc=Ib||OfficeExtension.WacRuntime.RichApi.getEventManager()}sendMessage(Q){this.c_a||vj.a.BKj(Q)}_RegisterHostMessageReceivedEvent(){this.c_a||(Di.$2f||(vj.a.ruj(Q=>{this.gQc.fireEvent("",65542,Object.assign(new uj,{data:Q}))}),Di.$2f=!0),this.gQc.register(this.kGa,"",65542))}_UnregisterHostMessageReceivedEvent(){this.c_a||
this.gQc.unregister(this.kGa,"",65542)}getTypeName(){return"Microsoft.Office.AugLoopEventService"}invokePropertyGet(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertyGetAsync(Q){Q=this.invokePropertyGet(Q);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}invokePropertySet(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertySetAsync(Q,Wa){this.invokePropertySet(Q,Wa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(Q,
Wa){switch(Q){case 1:return this.qKj(Wa);case 2:return this.ACg();case 3:return this.DCg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokeMethodAsync(Q,Wa){Q=this.invokeMethod(Q,Wa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}qKj(Q){Q=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Q,0,"string");this.sendMessage(Q);return null}ACg(){this._RegisterHostMessageReceivedEvent();return null}DCg(){this._UnregisterHostMessageReceivedEvent();
return null}}Di.$2f=!1;Object(e.a)(Di,"AugLoopEventService",null,[]);var Fj=a(800),wj=a(529);class Ei{constructor(Q,Wa,Ib){this.lWc=this.xge=null;this.kGa=Q;this.Jne=Wa;if(this.Ra=Ib)this.xge=this.Ra.Va("GetAccessTokenOAuthFirstPartyAllowList")}rai(){this.lWc||(this.lWc=wj.a.mr(fd.a.instance.Dc("Common.App.OAuth.IOAuthManager")));return this.lWc}cDi(Q,Wa){if(!this.Jne||""===this.kGa||!this.Ra)return!1;const Ib=this.Jne.getOsfControl(this.kGa);if(!Ib)return!1;let fc=!1;this.xge.split(";").forEach(sc=>
{Wa===sc&&(fc=!0)});return this.Ra.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthManagerAPI",!1)&&1===Zd.AFrameworkApplication.sa.Qa.li&&Ib.isFirstParty()&&Q===Ei.v0g&&fc&&af.d(Ib.getSolutionId())===Ei.w0g}getAccessTokenFirstPartyOAuth(Q,Wa){let Ib;Ib=this.cDi(Q,Wa)?fc=>{const sc=this.rai();sc.continueWith(()=>{sc.result.kD(Q,Wa).then(Tc=>{fc(Tc);return Tc})})}:fc=>{fc(Object.assign(new Fj.a,{IsSuccess:!1,Token:null,ErrorCode:"NotEnabled",ErrorMessage:"OAuthManager is disabled."}))};return OfficeExtension.WacRuntime.Utility.createPromise(Ib)}getTypeName(){return"Microsoft.Office.Auth"}invokePropertyGet(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);
}invokePropertyGetAsync(Q){Q=this.invokePropertyGet(Q);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}invokePropertySet(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertySetAsync(Q,Wa){this.invokePropertySet(Q,Wa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokeMethodAsync(Q,Wa){switch(Q){case 1:return this.YZh(Wa)}Q=this.invokeMethod(Q,
Wa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}YZh(Q){const Wa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Q,0,"string");Q=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Q,1,"string");return this.getAccessTokenFirstPartyOAuth(Wa,Q)}}Ei.v0g="Maker";Ei.w0g="fa000000043";Object(e.a)(Ei,"Auth",null,[]);class xj{constructor(){this.lua=null}Sei(){this.lua||(this.lua=wj.a.mr(fd.a.instance.Dc("Common.App.SharedFilePicker.ISharedFilePicker")));return this.lua}getSharedFilePickerResponse(Q){return OfficeExtension.WacRuntime.Utility.createPromise((Wa,
Ib)=>{try{const fc=this.Sei();Dc.Task.WAA.call(null,fc).continueWith(()=>{const sc=fc.result;if(sc){let Tc={};({Bt:Tc}=yg.d(Q)).returnValue?sc.Smd(Tc).then(ad=>{ad&&0<ad.length?Wa(ad):Ib(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker returned null or an empty array."))}).catch(ad=>{Ib(ad)}):Ib(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The dialog customazation json string can not be deserialized."))}else Ib(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException",
"The picker is resolved as null."))})}catch(fc){Ib(fc)}})}getTypeName(){return"Microsoft.Office.SharedFilePicker"}invokePropertyGet(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertyGetAsync(Q){Q=this.invokePropertyGet(Q);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}invokePropertySet(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertySetAsync(Q,Wa){this.invokePropertySet(Q,Wa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);
}invokeMethodAsync(Q,Wa){switch(Q){case 1:return this.Rei(Wa)}Q=this.invokeMethod(Q,Wa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}Rei(Q){Q=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Q,0,"string");return this.getSharedFilePickerResponse(Q)}}Object(e.a)(xj,"SharedFilePicker",null,[]);class yj{createInstance(Q,Wa,Ib="",fc=null,sc=null){switch(Q){case "Microsoft.Office.ActionService":return new tj(Wa);case "Microsoft.Office.SharedFilePicker":return new xj;case "Microsoft.Office.Auth":return new Ei(Ib,
fc,sc);case "Microsoft.Office.AugLoopEventService":return new Di(Ib)}return null}}Object(e.a)(yj,"WacApiHost",null,[]);class zj{constructor(Q,Wa,Ib,fc,sc){this.$2b=null;this.HWb=Q;this.zx=Wa;this.XH=Ib;this.Ub=fc;this.oue=sc}hostName(){return"ExcelOnline"}appId(){return this.HWb}createInstance(Q){switch(Q){case "Microsoft.Authentication.AuthenticationService":return fd.a.instance.resolve("Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").create(this.zx,this.XH.Xf);case "Microsoft.Authentication.TokenParameters":return new gd;
case "Microsoft.ExcelServices.CustomFunctionManager":Q=z.EwaSettings.ya(114);var Wa=z.EwaSettings.ya(115);return new qj(Q,Wa,Ej(this.HWb,this.Ub,this.XH));case "Microsoft.AppRuntime.AppRuntimeService":return new nj(this.zx,this.XH);case "Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification":return Q=yf.a(this.Ub),new oj(this.HWb,this.zx,Q,this.XH);case "Microsoft.DynamicRibbon.DynamicRibbon":return Q=yf.a(this.Ub),new Cj.DynamicRibbon(this.HWb,this.zx,this.XH,Q,Q.Xn(this.zx).Zl);
case "Microsoft.Office.Licensing.License":return new sj(this.zx,this.XH);case "Microsoft.InternalService.AddinInternalService":return new mj(this.zx);case "Microsoft.Office.AugLoopEventService":const Ib=yf.a(this.Ub),fc=Ib.Xn(this.zx).Zl;Wa=()=>"9202c06a-b7d3-466f-9adb-acad75789dbc"===fc.PrimaryMarketplace.SolutionId&&z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.AugLoopEventServiceDevBypass",!1)&&("TestHost"===this.Ub.xa.DocumentHostInfo.HostTier||"Dogfood"===Zd.AFrameworkApplication.Yc.AudienceGroup);
if(Oi.a(fc)||Wa())return Q=sc=>(Tc,ad,cd)=>{Ib.gi.Lhf({actionType:sc,controlId:Tc,messageType:cd,targetId:ad,message:""})},Q={register:Q(1),unregister:Q(2),fireEvent:(sc,Tc,ad)=>{Ib.gi.XL(Tc,sc)&&Ib.yG(Tc,sc,JSON.stringify(ad))}},new Di(this.zx,!1,Q);break;default:if(this.$2b||(this.$2b=new yj),Zd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthManagerAPI",!1)){if(Wa=this.$2b.createInstance(Q,this.oue,this.zx,this.XH.Xf,Zd.AFrameworkApplication.fa))return Wa}else if(Wa=
this.$2b.createInstance(Q,this.oue))return Wa}k.ULS.sendTraceTag(537163155,0,10,`Typename: ${Q} is an invalid parameter for the RichApiHost.CreateInstance method.`);throw OfficeExtension.WacRuntime.Utility.createRichApiException(Lc.a.generalException,Lc.a.generalException);}}Object(e.a)(zj,"RichApiHost",null,[]);var Gj=a(391),Aj=a(33),Hj=a(130),kj=a(38),Ij=a(107),Jj=a(295),Kj=a(50),Lj=a(263),Mj=a(8),Nj=a(77);class Ef{constructor(Q,Wa,Ib,fc){this.Bc=this.rangePicker=null;this.$=Q;this.ze=Wa;this.Bc=
fc;this.uf=new Mh(Q.ea);this.AB=new Uh(Q,this.uf);this.iGf=Ib;this.Kec=new Map}get PR(){return this.uf}dispose(){this.$=this.Kec=null}yd(){return!1}Cd(){return!1}executeCommand(Q,Wa,Ib){Q=Wa.command;switch(Q){case 451041795:this.uf.xg(Ib[Hg.a.Og],Ib[Hg.a.k6]);break;case 974713501:this.Zli(Ib[Hg.a.Og],Ib[Hg.a.k6]);break;case 1237877382:this.uf.Pw(Ib[Hg.a.k6]);break;default:return ab.a(Q)}return Dc.Task.Ua(!0)}fd(Q,Wa,Ib){if(Q=!!Ib)switch(Wa.command){case 974713501:case 1237877382:case 451041795:break;
default:Q=!1}return Q}Zli(Q,Wa){var Ib;const fc=Q.DdaMethod;"undefined"===typeof fc.DispatchId?this.uf.xg(Je.a.internalError,Wa):Ef.hBi(Q)||this.$.oe&1?(fc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromPromptMethod?(new Jh(this.$,this,Q,Wa,this.Bc)).start(this.ze,Q.DdaMethod.ControlId):fc.DispatchId===OSF.DDA.MethodDispId.dispidGetSelectedDataMethod?this.qei(Q,Wa):fc.DispatchId===OSF.DDA.MethodDispId.dispidSetSelectedDataMethod?this.HQj(Q,Wa):fc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod?
this.addBinding(Q,this.kmd(Q.DdaMethod.ControlId),0,Wa):fc.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingDataMethod?this.K0h(Q,Wa):fc.DispatchId===OSF.DDA.MethodDispId.dispidSetBindingDataMethod?this.dMj(Q,Wa):fc.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingMethod?this.J0h(Q,Wa):fc.DispatchId===OSF.DDA.MethodDispId.dispidReleaseBindingMethod?this.Nvj(Q,Wa):fc.DispatchId===OSF.DDA.MethodDispId.dispidGetAllBindingsMethod?this.I_h(Q,Wa):fc.DispatchId===OSF.DDA.MethodDispId.dispidLoadSettingsMethod?
this.LCd(Q,Wa):fc.DispatchId===OSF.DDA.MethodDispId.dispidSaveSettingsMethod?this.saveSettings(Q,Wa):fc.DispatchId===OSF.DDA.MethodDispId.dispidAddRowsMethod?(Q.DdaAddRowsColumns.IsRow=!0,this.bxe(Q,Wa)):fc.DispatchId===OSF.DDA.MethodDispId.dispidAddColumnsMethod?(Q.DdaAddRowsColumns.IsRow=!1,this.bxe(Q,Wa)):fc.DispatchId===OSF.DDA.MethodDispId.dispidClearAllRowsMethod?this.Vvh(Q,Wa):fc.DispatchId===OSF.DDA.MethodDispId.dispidClearFormatsMethod?this.Aeh(Q,Wa):fc.DispatchId===OSF.DDA.MethodDispId.dispidSetFormatsMethod?
(Q.DdaSetBindingFormats.IsSetFormats=!0,this.Ccg(Q,Wa)):fc.DispatchId===OSF.DDA.MethodDispId.dispidSetTableOptionsMethod?(Q.DdaSetBindingFormats.IsSetFormats=!1,this.Ccg(Q,Wa)):fc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod?this.addBinding(Q,Q.DdaBindingsMethod.ItemName,Q.DdaBindingsMethod.FailOnCollision?2:1,Wa):fc.DispatchId===OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod?this.Y5h(Wa):fc.DispatchId===OSF.DDA.MethodDispId.dispidNavigateToMethod?this.GGd(Q,Wa):fc.DispatchId===
OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod?this.executeRichApiRequest(Q,Wa):fc.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod?this.X4h(Q,Wa):fc.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod?this.Y4h(Q,Wa):fc.DispatchId===OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod?this.Pvj(Q,Wa):fc.DispatchId===OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod?(OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(Q.DdaMethod.ControlId,Q),this.uf.Pw(Wa)):
fc.DispatchId===OSF.DDA.MethodDispId.dispidMessageParentMethod?z.EwaSettings.ya(23)?this.uf.xg(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Wa):this.lWi(Q,Wa):fc.DispatchId===OSF.DDA.MethodDispId.dispidSendMessageMethod?z.EwaSettings.ya(23)?this.uf.xg(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Wa):this.iWi(Q,Wa):fc.DispatchId===OSF.DDA.MethodDispId.dispidGetAccessTokenMethod?this.getAccessToken(Q,Wa):fc.DispatchId===OSF.DDA.MethodDispId.dispidGetAuthContextMethod?
this.getAuthContext(Q,Wa):this.uf.xg(Je.a.DLd,Wa),z.EwaSettings.isChangeGateEnabled("OfficeVSO:5649666_AddLogForExcelOnlineCommonAPIUsage")&&fc.DispatchId!==OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(Q=this.ze.rW(Q.DdaMethod.ControlId),Wa="",Q&&(Wa=Ig.DdaFacade.getSolutionId(Q,this.$),Wa=Telemetry.PrivacyRules.GetPrivacyCompliantId(Wa,Q.OwnerAddinStoreType||Q.PrimaryMarketplace.MarketplaceType,null===(Ib=Q.AssetMarketplace)||void 0===Ib?void 0:Ib.SolutionId,null,null,Q.PrimaryMarketplace.MarketplaceRef)),
k.ULS.sendTraceTag(537163224,344,50,`DDA method Id: ${fc.DispatchId}, AppID: ${Wa}`))):this.uf.xg(Je.a.iVe,Wa)}K0h(Q,Wa){Q.DdaGetBindingData.CoerceType=Ef.s9b(Q.DdaGetBindingData.CoerceType);Q.DdaGetBindingData.FilterType=Ef.X3e(Q.DdaGetBindingData.FilterType);Q.DdaGetBindingData.ValueFormat=Ef.swg(Q.DdaGetBindingData.ValueFormat);if(this.xpc(Q.DdaGetBindingData.CoerceType,Wa)){if(Q.DdaGetBindingData){const Ib=Q.DdaGetBindingData;0===Ib.FilterType&&(Ib.FilterType=2);Ib.StartCol|=0;Ib.StartRow|=0;
Ib.ColCount=void 0===Ib.ColCount?-1:Ib.ColCount;Ib.RowCount=void 0===Ib.RowCount?-1:Ib.RowCount}this.AB.ddaGetBindingData(Q.DdaMethod.ControlId,Q.DdaGetBindingData.BindingId,Q.DdaGetBindingData.CoerceType,Q.DdaGetBindingData.ValueFormat,Q.DdaGetBindingData.FilterType,Q.DdaGetBindingData.StartRow,Q.DdaGetBindingData.StartCol,Q.DdaGetBindingData.RowCount,Q.DdaGetBindingData.ColCount,Ib=>{if(Ag.a(Ib)||!Ib.Result)this.uf.VI(Ib,Wa);else{const fc=this.uf.CR();fc.Data=Ef.HFe(Ib.Result);Wa(fc)}},Wa)}}dMj(Q,
Wa){Q.DdaSetBindingData.CoerceType=Ef.s9b(Q.DdaSetBindingData.CoerceType);if(this.xpc(Q.DdaSetBindingData.CoerceType,Wa)){var Ib=Ef.u6c(Q.DdaSetBindingData.CoerceType,Q.DdaSetBindingData.Data);Ef.tmc(Ib)?this.uf.xg(Je.a.gJc,Wa):(1===Ib.CoerceType&&(Ib.CellFormat||(Ib.CellFormat=Q.DdaSetBindingData.CellFormat),Ib.TableOptions||(Ib.TableOptions=Q.DdaSetBindingData.TableOptions)),Q.DdaSetBindingData&&(Q.DdaSetBindingData.StartCol|=0,Q.DdaSetBindingData.StartRow|=0),this.AB.ddaSetBindingData(Q.DdaMethod.ControlId,
Q.DdaSetBindingData.BindingId,Q.DdaSetBindingData.StartRow,Q.DdaSetBindingData.StartCol,Ib,fc=>{Ag.a(fc)?this.uf.VI(fc,Wa):this.uf.Pw(Wa)},Wa))}}qei(Q,Wa){Q.DdaGetBindingData.CoerceType=Ef.s9b(Q.DdaGetBindingData.CoerceType);Q.DdaGetBindingData.ValueFormat=Ef.swg(Q.DdaGetBindingData.ValueFormat);Q.DdaGetBindingData.FilterType=Ef.X3e(Q.DdaGetBindingData.FilterType);if(this.xpc(Q.DdaGetBindingData.CoerceType,Wa)){var Ib=this.kmd(Q.DdaMethod.ControlId);Ib?this.AB.ddaGetSelectedData(Q.DdaMethod.ControlId,
Q.DdaGetBindingData.CoerceType,Q.DdaGetBindingData.ValueFormat,Q.DdaGetBindingData.FilterType,Ib,fc=>{if(Ag.a(fc))this.uf.VI(fc,Wa);else{const sc=this.uf.CR();sc.Data=Ef.HFe(fc.Result);Wa(sc)}},Wa):this.uf.xg(Je.a.Aef,Wa)}}X4h(Q,Wa){const Ib=Q[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()],fc=Q[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()],sc=Q.DdaMethod.ControlId,Tc=Kh.getInstance(this.$);if(0>=fc)k.ULS.sendTraceTag(537163221,344,15,"Invalid slice size. It should be greater than 0."),
this.uf.xg(Je.a.Exi,Wa);else if(fc>Kh.MUi)k.ULS.sendTraceTag(537163220,344,15,"Invalid slice size. It should be not greater than 4MB."),this.uf.xg(Je.a.b$e,Wa);else{var ad=null;switch(Ib){case 1:ad="Compressed";break;case 0:ad="Text";break;case 2:ad="Pdf";break;default:k.ULS.sendTraceTag(537163219,344,15,`Requested file type ${Ib} is not supported.`);this.uf.xg(Je.a.H3e,Wa);return}if("Text"===ad)k.ULS.sendTraceTag(537163218,344,15,`Requested file type ${ad} is not supported.`),this.uf.xg(Je.a.H3e,
Wa);else{z.EwaSettings.isChangeGateEnabled("OfficeVSO:4182305_AddWholeWorkbookPrintOptionToGetFileAPI")?(Q=new Sys.StringBuilder,Q.append(rf.a(this.$,ad)),"Pdf"===ad&&Vf.a.Ml(Q,Cc.a.JZf,"WholeWorkbook"),Q=Q.toString()):Q=rf.a(this.$,ad);var cd=null,zd=new XMLHttpRequest;zd.onreadystatechange=()=>{if(4===zd.readyState)if(200===zd.status){var Qd=zd.response;if(Qd){cd=new Uint8Array(Qd);Qd=this.uf.CR();var Ae=cd.length,Oe=Kh.YYi(),sf={},Bg=0;for(let ig=0;ig<Ae;ig+=fc){const ag=[],eg=ig+fc<Ae?ig+fc:Ae;
for(let Cg=0,Xg=ig;Xg<eg;Cg++,Xg++)ag[Cg]=cd[Xg];sf[(Bg++).toString()]=ag}sf=new hi(Oe,Ae,fc,sf);sf=Tc.hTg(sc,sf);sf!==Je.a.success?this.uf.xg(sf,Wa):(Qd[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=Oe,Qd[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=Ae,k.ULS.sendTraceTag(537163216,344,50,`GetFileAsync get file successfully for file type ${ad}, the file size is ${Ae}`),Wa(Qd))}else k.ULS.sendTraceTag(537163217,344,15,`Request is successful, but respone have no data for file type ${ad}.`),
this.uf.xg(Je.a.internalError,Wa)}else 500===zd.status?this.uf.xg(Je.a.v6e(parseInt(zd.statusText,10)),Wa):(k.ULS.sendTraceTag(537163215,344,15,`Request failed to obtain the file for type ${ad}.`),this.uf.xg(Je.a.IYi,Wa))};zd.open("GET",Q,!0);zd.responseType="arraybuffer";zd.setRequestHeader("If-Modified-Since","0");zd.send(null)}}}Y4h(Q,Wa){var Ib=Q[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()],fc=Q[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];Q=Q.DdaMethod.ControlId;(Ib=
Kh.getInstance(this.$).$4h(Q,Ib))?(Ib=Ib.P_j,0>fc||fc>=Object.keys(Ib).length?this.uf.xg(Je.a.hsi,Wa):(fc=Ib[fc.toString()],Ib=this.uf.CR(),Ib[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=fc,Ib[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=fc.length,Wa(Ib))):this.uf.xg(Je.a.internalError,Wa)}Pvj(Q,Wa){var Ib=Q[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];Q=Q.DdaMethod.ControlId;Ib=Kh.getInstance(this.$).Ovj(Q,Ib);Ib===Je.a.success?this.uf.Pw(Wa):this.uf.xg(Ib,
Wa)}HQj(Q,Wa){Q.DdaSetBindingData.CoerceType=Ef.s9b(Q.DdaSetBindingData.CoerceType);if(this.xpc(Q.DdaSetBindingData.CoerceType,Wa)){var Ib=this.kmd(Q.DdaMethod.ControlId);if(Ib){var fc=Ef.u6c(Q.DdaSetBindingData.CoerceType,Q.DdaSetBindingData.Data),sc=dc.h(this.$).ga;1===fc.CoerceType&&(!fc.Data&&sc.pa.rX&&(fc.Headers||(fc.Headers=[]),fc.Headers.length||fc.Headers.push([]),fc.Headers[0].length||fc.Headers[0].push("")),Ef.tmc(fc)||(fc.CellFormat||(fc.CellFormat=Q.DdaSetBindingData.CellFormat),fc.TableOptions||
(fc.TableOptions=Q.DdaSetBindingData.TableOptions)));if(Ef.tmc(fc))this.uf.xg(Je.a.gJc,Wa);else{var Tc=sc.pa.Sd.clone(),ad=sc.pa.activeCell.clone();this.AB.ddaSetSelectedData(Q.DdaMethod.ControlId,Ib,fc,cd=>{var zd;if(Ag.a(cd))this.uf.VI(cd,Wa);else{cd=Tc.clone();const Qd=fc.Headers?fc.Headers[0].length:fc.Data[0].length;1!==fc.CoerceType||fc.Data?1===fc.CoerceType&&(null===(zd=fc.TableOptions)||void 0===zd?0:zd.length)&&0==fc.TableOptions[0]?(cd.top+=1,cd.bottom=cd.top+fc.Data.length-1):cd.bottom=
cd.top+fc.Data.length-(1===fc.CoerceType?0:1):cd.bottom=cd.top+1;cd.right=cd.left+Qd-1;zd=cd.contains(ad)?ad:cd.topLeft;sc.updateSelection(cd,zd,0);this.uf.Pw(Wa)}},Wa)}}else this.uf.xg(Je.a.mIe,Wa)}}addBinding(Q,Wa,Ib,fc){Wa?this.AB.ddaAddBinding(Q.DdaMethod.ControlId,Q.DdaBindingsMethod.BindingId,Q.DdaBindingsMethod.BindingType,Wa,Ib,sc=>{if(Ag.a(sc))this.uf.VI(sc,fc);else{const Tc=this.uf.CR();Tc.Bindings=Array(1);Tc.Bindings[0]=this.ze.Q6b(sc.Result);fc(Tc)}},fc):this.uf.xg(Je.a.tJj,fc)}J0h(Q,
Wa){this.AB.ddaGetBinding(Q.DdaMethod.ControlId,Q.DdaBindingsMethod.BindingId,Ib=>{if(Ag.a(Ib)||!Ib.Result)this.uf.VI(Ib,Wa);else{const fc=this.uf.CR();fc.Bindings=Array(1);fc.Bindings[0]=this.ze.Q6b(Ib.Result);Wa(fc)}},Wa)}Y5h(Q){const Wa=this.uf.CR(),Ib={};Ib[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=this.$.workbookContext.ClientUrl;Wa[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=Ib;Q(Wa)}Nvj(Q,Wa){this.AB.ddaReleaseBinding(Q.DdaMethod.ControlId,Q.DdaBindingsMethod.BindingId,
Ib=>{Ag.a(Ib)?this.uf.VI(Ib,Wa):this.uf.Pw(Wa)},Wa)}I_h(Q,Wa){this.AB.ddaGetAllBindings(Q.DdaMethod.ControlId,Ib=>{if(Ag.a(Ib))this.uf.VI(Ib,Wa);else{const fc=this.uf.CR();if(Ib.Result){Ib=Ib.Result;fc.Bindings=Array(Ib.length);for(let sc=0;sc<Ib.length;sc++)fc.Bindings[sc]=this.ze.Q6b(Ib[sc])}else fc.Bindings=null;Wa(fc)}},Wa)}LCd(Q,Wa){this.AB.ddaLoadSettings(Q.DdaMethod.ControlId,Ib=>{if(Ag.a(Ib))this.uf.VI(Ib,Wa);else{const fc=this.uf.CR();fc.Properties=Ib.Result;Wa(fc)}},Wa)}saveSettings(Q,Wa){const Ib=
{Settings:[]};for(let fc=0;fc<Q.DdaSettingsMethod.Properties.length;fc++){const sc={};sc.Name=Q.DdaSettingsMethod.Properties[fc][0];sc.Value=Q.DdaSettingsMethod.Properties[fc][1];Ib.Settings[fc]=sc}this.AB.ddaSaveSettings(Q.DdaMethod.ControlId,Ib,Q.DdaSettingsMethod.OverwriteIfStale,fc=>{Ag.a(fc)?this.uf.VI(fc,Wa):this.uf.Pw(Wa)},Wa)}bxe(Q,Wa){const Ib=Ef.u6c(1,Q.DdaAddRowsColumns.Data);Ef.tmc(Ib)?this.uf.xg(Je.a.gJc,Wa):this.AB.ddaAddRowsColumns(Q.DdaMethod.ControlId,Q.DdaAddRowsColumns.BindingId,
Q.DdaAddRowsColumns.IsRow,Ib,fc=>{Ag.a(fc)?this.uf.VI(fc,Wa):this.uf.Pw(Wa)},Wa)}Vvh(Q,Wa){this.AB.ddaDeleteAllDataValues(Q.DdaMethod.ControlId,Q.DdaBindingsMethod.BindingId,Ib=>{Ag.a(Ib)?this.uf.VI(Ib,Wa):this.uf.Pw(Wa)},Wa)}Aeh(Q,Wa){this.AB.ddaClearBindingFormats(Q.DdaMethod.ControlId,Q.DdaClearBindingFormats.BindingId,Ib=>{Ag.a(Ib)?this.uf.VI(Ib,Wa):this.uf.Pw(Wa)},Wa)}Ccg(Q,Wa){const Ib={},fc=Q.DdaSetBindingFormats.IsSetFormats;fc?Ib.CellFormat=Q.DdaSetBindingFormats.CellFormat:Ib.TableOptions=
Q.DdaSetBindingFormats.TableOptions;this.AB.ddaSetBindingFormats(Q.DdaMethod.ControlId,Q.DdaSetBindingFormats.BindingId,Ib,fc,sc=>{Ag.a(sc)?this.uf.VI(sc,Wa):this.uf.Pw(Wa)},Wa)}executeRichApiRequest(Q,Wa){var Ib;const fc=Q.ArrayData,sc={},Tc=dc.h(this.$).ga;if(fc){if("WacPartition"===fc[0]){this.LPh(Q,Wa);return}const Oe=Object(R.a)(Ig.DdaFacade,yf.a(this.$));if("SetOsfControlContainerReadyForCustomFunctions"===fc[0]){var ad=Oe.Xn(Q.DdaMethod.ControlId);ad&&(ad.koc=!0,ad.WYf())}sc.HttpMethod=fc[1];
sc.PathAndQuery=fc[2];sc.RequestHeaders=Ef.Eaf(fc[3]);sc.RequestBody=fc[4];sc.AppPermission=fc[5];ad=fc[6];sc.RequestFlags=ad;var cd=0;if($h.i(this.$.na))switch(Tc.rf){case 1:cd=2;break;case 2:cd=3;break;case 64:cd=16;break;case 128:cd=4;break;default:cd=1}var zd=null;Tc.Sa.eC&&(zd=Tc.Sa.eC.ek);sc.SheetMultiRange=Xh.r(Tc.pa.selectedRanges,this.$);sc.ActiveCell=Xh.v(Tc.pa.activeCell,this.$);sc.ActiveFloatingObjectId=zd;sc.SelectionState=cd;cd=this.ze.rW(Q.DdaMethod.ControlId);sc.InstanceId=cd?cd.InstanceId:
"";if(cd&&cd.PrimaryMarketplace){let sf;if(cd.PrimaryMarketplace.MarketplaceType!==OSF.StoreType.InMemory)sf=cd.PrimaryMarketplace.SolutionId,zd=cd.PrimaryMarketplace.MarketplaceType;else{if(!cd.OwnerAddinSolutionId){k.ULS.sendTraceTag(512325018,344,10,"executeRichApiRequest: No OwnerAddinSolutionId for AppCommand");this.uf.xg(Je.a.eEb,Wa);return}if(!cd.OwnerAddinStoreType){k.ULS.sendTraceTag(512325017,344,10,"executeRichApiRequest: No OwnerAddinStoreType for AppCommand");this.uf.xg(Je.a.eEb,Wa);
return}sf=cd.OwnerAddinSolutionId;zd=cd.OwnerAddinStoreType}let Bg=Telemetry.PrivacyRules.GetPrivacyCompliantId(sf,zd,null===(Ib=cd.AssetMarketplace)||void 0===Ib?void 0:Ib.SolutionId,null,null,cd.PrimaryMarketplace.MarketplaceRef);sc.CompliantSolutionId=Bg;sc.SolutionId=sf;sc.MarketplaceType=zd;sc.SolutionVersion=cd.PrimaryMarketplace.SolutionVersion;sc.StoreLocation=cd.PrimaryMarketplace.MarketplaceRef}else sc.SolutionId=sc.MarketplaceType="",sc.CompliantSolutionId="";sc.IsEventsEnabled=void 0===
Oe||null===Oe||Oe.gi.a6b(sc.InstanceId);sc.RequestGuid=wh.a.create().toString();Ib=sc.RequestBody.length;if(Ib>this.$.xa.ExcelRichApiMaxAllowedRequestPayloadSize){this.uf.xg(Je.a.JCj,Wa);k.ULS.sendTraceTag(537163213,0,50,`Request payload size:${Ib} exceeded the limit`);return}z.EwaSettings.isChangeGateEnabled("OfficeVSO:5079365_RichApiPreviewExecution")&&ad&4096&&(Ib=new pf(this.$),OfficeExtension.WacRuntime.RichApi.previewExecute(Ib,sh,fc),sc.RequestBody=fc[4])}const Qd=Ef.Ydf(sc.RequestHeaders);
Ef.BMd++;const Ae=Aj.a.Lb.Mc;z.EwaSettings.isChangeGateEnabled("OfficeVSO:4316383_RichApiLogRequestBodySize")&&sc&&sc.RequestBody&&k.ULS.sendTraceTag(537163212,0,50,`Richapi json request body size is ${sc.RequestBody.length}`);this.AB.executeRichApiRequest(sc,Oe=>{var sf;this.Hbg(Ae,!0,Oe.ServerCorrelationId);let Bg=null,ig=null;var ag=Oe.ServerCorrelationId;if(null===(sf=null===Oe||void 0===Oe?void 0:Oe.Errors)||void 0===sf?0:sf[0])Bg=Oe.Errors[0].MessageIdName,ig=Oe.Errors[0].Description,Nj.a(this.$).$d.BN(Oe.Errors[0].MessageId);
if(Ag.a(Oe)||!Oe.Result)this.Lbb(ag,Qd,"Server error",Bg,ig),this.uf.VI(Oe,Wa);else{let Cg=null;if(z.EwaSettings.ya(233))if((sf=Oe.Result)&&sf.length){for(let Yg=0;Yg<sf.length;Yg++)if(sf[Yg].RequestGuid===sc.RequestGuid){Cg=sf[Yg];break}Cg||this.uf.VI(Oe,Wa)}else Cg=Oe.Result;else Cg=Oe.Result;if(!Bg&&Cg&&Cg.ResponseBody&&Cg.ResponseBody[0])if(Oe=Cg.ResponseBody[0],Oe.startsWith('{"Error":')){1<Cg.ResponseBody.length&&(Oe=Oe.substring(0,Oe.indexOf("}")+1),Oe+="}");try{var eg=u.a.ij(Oe);eg.Error&&
this.Lbb(ag,Qd,"Pipeline error",eg.Error.Code,eg.Error.Message)}catch(Yg){this.Lbb(ag,Qd,"Json deserialize error",null,"Error info cannot be deserialized.")}}else this.Lbb(ag,Qd);else this.Lbb(ag,Qd,"Server error",Bg,ig);const Xg=(ag=Cg.SheetMultiRange)?ag.SheetName:null;eg=Cg.ActiveFloatingObjectId;const Mg=Cg.SelectionState;Oe=5===Mg&&!!ag||6===Mg||7===Mg||17===Mg||8===Mg;if(this.$.Zb.Gz&&Oe)this.uf.xg(Je.a.ALc,Wa),k.ULS.sendTraceTag(537163211,0,50,`${Mg.toString()} is not allowed`);else if(5===
Mg&&ag){if(this.$.ua&&Xg)if(this.$.ua.Pk(Xg))this.j1c(Xg);else{let Yg=null;Yg=()=>{this.$.ua.Pk(Xg)&&(k.ULS.sendTraceTag(537163210,0,50,"Sheets item add event handler called"),this.j1c(Xg),this.$.ua.DOb(Yg))};this.$.ua.lsb(Yg);if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:3973943_RichApiFixSheetActivateOnNewWorkbookEnabled")){let bi=null;bi=()=>{this.$.ua.Pk(Xg)&&(this.j1c(Xg),this.$.ua.Qpa(bi))};this.$.ua.yja(bi)}}}else if(6===Mg||7===Mg||17===Mg||8===Mg||9===Mg){if(ag){const Yg=Xh.g(ag.Ranges);
if(Xg&&Xh.db(Yg,!0))if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:4211161_RichApiUpdateSelectionWithoutExistsWorksheet")&&!this.$.ua.Pk(Xg)){let bi=null;bi=()=>{this.Eug(Tc,Yg,Xg,Mg);this.$.ua.Qpa(bi)};this.$.ua.yja(bi)}else this.Eug(Tc,Yg,Xg,Mg)}7===Mg?(eg="38.{"+af.e(eg)+"}",Bi.a(this.$).d$(0,eg,!0)):17===Mg?(eg="38.{"+af.e(eg)+"}",Bi.a(this.$).d$(5,eg,!0)):8===Mg&&Bi.a(this.$).d$(2,eg,!0);9===Mg&&(this.$.xa.ApiCallToSetPageLayout=!0)}Cg.PostProcessActions?(ag=u.a.ij(Cg.PostProcessActions),this.Lkj(ag).then(()=>
{this.fhb(Cg,Wa);this.jjd(Q.DdaMethod.ControlId,sc);return Promise.resolve(null)},Yg=>{this.fhb(Cg,Wa,Yg);return Promise.reject(Yg)})):this.fhb(Cg,Wa)}},Oe=>{this.Hbg(Ae,!1,null);this.Lbb(null,Qd,"Web service error");Wa(Oe)})}jjd(Q,Wa){const Ib=Object(R.a)(Ig.DdaFacade,yf.a(this.$));(null===Ib||void 0===Ib?0:Ib.pVd)&&Ib.Xn(Q)&&Ef.IUj(Wa.RequestHeaders)&&(k.ULS.sendTraceTag(537163209,0,50,`ExecuteRichApiRequest(PostProcess): fire a RecordingStateChanged event to ControlId: ${Q}; SolutionId: ${Wa.SolutionId}.`),
Ib.pVd.tEh(Q))}LPh(Q,Wa){var Ib=this.ze.rW(Q.DdaMethod.ControlId);const fc=Ig.DdaFacade.getSolutionId(Ib,this.$);var sc=null;sc=Ig.DdaFacade.Qxa(Ib,this.$);sc=new bj(sc,this.$);sc=new zj(fc,Q.DdaMethod.ControlId,this.ze,this.$,sc);const Tc={ResponseHeaders:[]};Tc.ResponseBody=Array(1);Ib=Ef.Eaf(Q.ArrayData[3]);const ad=Ef.Ydf(Ib);Ib=new rh(this.$.xa.CreateWorkbookMaxAllowedBase64Size,this.iGf);OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(sc,ah,Ib,Q.ArrayData).then(cd=>{if(!cd)return this.BDd(!1,
"The rich api executor call failed",ad),k.ULS.sendTraceTag(537163208,0,10,"The rich api executor call failed"),Tc.ResponseStatusCode=500,this.fhb(Tc,Wa),null;this.BDd(!0,"The rich api executor call succeeded",ad);Tc.ResponseStatusCode=cd[0];Tc.ResponseBody[0]=cd[2];this.fhb(Tc,Wa);return null},cd=>{Tc.ResponseStatusCode=400;Tc.ResponseBody[0]=cd.toString();this.BDd(!1,"The rich api executor call failed",ad);k.ULS.sendTraceTag(537163207,0,10,`A Excel Rich API batch execution was failed, AppId:${fc}`);
this.fhb(Tc,Wa);return null})}Hbg(Q,Wa,Ib){Ef.BMd--;Q=Hj.a(Aj.a.Lb,Q);k.ULS.sendTraceTag(36763356,0,50,`Rich Api perf log -- total milliseconds used:${Q}, requests pending:${Ef.BMd}, request result:${Wa?"success":"false"}, server correlationid: ${Ib}.`)}fhb(Q,Wa,Ib=null){const fc=Array(3);fc[0]=Q.ResponseStatusCode;fc[1]=Ef.Rfi(Q.ResponseHeaders);const sc=[];var Tc=!1;if(Ib&&Q.ResponseBody){const ad=u.a.ij(Q.ResponseBody.join(""));ad.Error||(Tc={},Tc.Error=Ib,Tc.TraceIds=ad.TraceIds,Tc.ProcessedResults=
{},Tc.ProcessedResults.Results=ad.Results,sc[0]=u.a.nd(Tc),Tc=!0)}fc[2]=Tc?sc:Q.ResponseBody;Q=this.uf.CR();Q.Data=fc;Wa(Q)}GGd(Q,Wa){(new Bh(this.$,this.uf,this.AB)).GGd(Q,Wa)}lWi(Q,Wa){k.ULS.sendTraceTag(537163206,0,50,"MessageParent API called!");const Ib=Q[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],fc=Q[Gb.a.s3c],sc=Q[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];Q=this.$.da.Ba(232).x5a.mWi(Q.DdaMethod.ControlId,Ib,fc,sc);Q===Je.a.success?this.uf.Pw(Wa):(k.ULS.sendTraceTag(537163205,
0,10,"MessageParent API Failed!"),this.uf.xg(Q,Wa))}iWi(Q,Wa){k.ULS.sendTraceTag(537163204,0,50,"MessageChild API called!");const Ib=Q[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],fc=Q[Gb.a.s3c],sc=Q[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];this.$.da.Ba(232).x5a.rKj(Q.DdaMethod.ControlId,Ib,fc,sc);this.uf.Pw(Wa)}getAccessToken(Q,Wa){k.ULS.sendTraceTag(537163203,0,50,"GetAccessToken API called!");const Ib=(sc,Tc)=>{var ad;if(sc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)sc=this.uf.CR(),
sc[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=Tc.accessToken,Wa(sc);else{Tc=this.ze.rW(Q.DdaMethod.ControlId);let cd=null!==Tc.OwnerAddinStoreType?Tc.OwnerAddinStoreType:Tc.PrimaryMarketplace.MarketplaceType;k.ULS.sendTraceTag(537163202,0,10,`${({["errorCode"]:sc.toString(),["appId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Ig.DdaFacade.getSolutionId(Tc,this.$),cd,null===(ad=Tc.AssetMarketplace)||void 0===ad?void 0:ad.SolutionId,null,null,Tc.PrimaryMarketplace.MarketplaceRef),
["storeType"]:cd})}.`);this.uf.xg(sc,Wa)}},fc=!z.EwaSettings.ya(23);Wf.TaskExtensions.za(Kg.GetServiceTaskFactory.create(this.$.da,137,this.$.ka,1),sc=>{const Tc=this.ze.Xf,ad=If.getInstance();be.AppsForOfficeSingleSignOnManager.getInstance(Tc,sc.result,ad).getAccessToken(Q.DdaMethod.ControlId,fc,Q,Ib)},this.$.ka)}getAuthContext(Q,Wa){Wf.TaskExtensions.za(Kg.GetServiceTaskFactory.create(this.$.da,137,this.$.ka,1),()=>{var Ib=this.ze.Xf.getOsfControl(Q.DdaMethod.ControlId);if(Ib.isFirstParty()){Ib=
Ib.getManifest();var fc=Ib.getMarketplaceID(),sc=Ib.getWebApplicationId(),Tc=Ib.getWebApplicationMsaId();fd.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(fc).then(ad=>{const cd=this.uf.CR(),zd={};zd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=sc;zd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=Tc||sc;zd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=ad.upn;zd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=ad.userId;
zd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=ad.authority;zd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=xg.a.r0h(ad.authorityType);zd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=ad.isAnonymous;zd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=ad.tenantId;zd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=ad.supportsAuthToken;cd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=zd;
Wa(cd)},ad=>{const cd=this.uf.CR(),zd={},Qd=new xg.a;zd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=sc;zd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=Tc||sc;zd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=Qd.upn;zd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=Qd.userId;zd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=Qd.authority;zd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=Qd.authorityType;zd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=
Qd.isAnonymous;zd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=Qd.tenantId;zd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=ad;zd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=Qd.supportsAuthToken;cd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=zd;cd.Error=1;Wa(cd)})}},this.$.ka)}WAi(Q){const Wa=dc.h(this.$).ga;return 16===Wa.rf&&!!Wa.Sa.Pc&&!!Wa.Sa.Pc.floatingObject&&kh.a.equals(Wa.Sa.Pc.floatingObject.id,Q,!0)}kmd(Q){const Wa=
dc.h(this.$).ga;return Wa.pa.Vh?1===Wa.rf||this.WAi(Q)?Wa.Uka:null:null}xpc(Q,Wa){return 1!==Q&&2!==Q&&3!==Q?(this.uf.xg(Je.a.BLe,Wa),!1):!0}BDd(Q,Wa,Ib){const fc={};fc.a=this.$.xa.UserSessionId;fc.b=Q;fc.c=Wa;fc.d=null;fc.e=Ib;Pi.b().Of(37,fc)}Lbb(Q,Wa,Ib=null,fc=null,sc=null){const Tc={};Q&&(Tc.ServerCorrelationId=Q);void 0!==Wa&&null!==Wa&&(Tc.Source=Wa);Ib&&(Tc.ErrorType=Ib);fc&&(Tc.MessageId=fc);sc&&(Tc.StatusDescription=sc);z.EwaSettings.isChangeGateEnabled("OfficeVSO:6144055_EUIIDataInDbxheTag")&&
fc&&"ExternalDataRefreshFailed"===fc&&(Tc.StatusDescription="");k.ULS.sendTraceTag(50688452,0,50,u.a.nd(Tc))}Lkj(Q){let Wa=new Promise(Ib=>{Ib(null)});for(let Ib=0;Ib<Q.length;Ib++)Wa=this.Kkj(Wa,Q[Ib]);return Wa}Kkj(Q,Wa){return Object(Gd.a)(this,void 0,void 0,function*(){if(!Wa)return k.ULS.sendTraceTag(537163201,0,10,"Null PostProcessAction."),Q.then(()=>Promise.reject(Ef.o7a(Qh.generalException,Df.a.instance.ha(1765),null)));switch(Wa.actionType){case 1:case 2:Q=Q.then(()=>{const sc=Object(R.a)(Ig.DdaFacade,
yf.a(this.$));if(sc.Xn(Wa.controlId))switch(sc.gi.Lhf(Wa),Wa.messageType){case 14:case 100:sc.oVd.y6b(Wa);break;case 11:case 12:sc.xFj.Etb(Wa);break;case 51:case 52:sc.vFj.Etb(Wa);break;case 2101:case 2102:sc.wFj.Etb(Wa);break;case 2E3:sc.yFj.y6b(Wa);break;case 2201:this.$.Rna&&sc.pVd.I3g(Wa);break;case 2203:sc.zFj.J3g(Wa);break;case 2700:z.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&sc.nVd.y6b(Wa);break;case 65541:sc.mVd.H3g(Wa)}else k.ULS.sendTraceTag(537163171,0,10,`OsfControl with instanceId[${Wa.controlId}] doesn't exist.`);
return Promise.resolve(null)});break;case 3:Q=Q.then(()=>{this.Qki(Wa);return Promise.resolve(null)});break;case 15:z.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&(Q=Q.then(()=>{this.Hmi(Wa);return Promise.resolve(null)}));break;case 4:Q=Q.then(()=>{if(z.EwaSettings.ya(102)){var sc=dc.h(this.$).ga.pa.activeCell;sc.top!==Wa.row+1&&sc.left!==Wa.column+1&&(sc=Xh.v(Of.Range.xd(Wa.row+1,Wa.column+1),this.$),dc.h(this.$).Eh(sc,null,null,null,3,"DdaMethodHandler.ShowCard"));Ki.a(this.$,
243,242,0,Tc=>{Tc.lib(Wa.row+1,Wa.column+1,1,!1,!1)})}return Promise.resolve(null)});break;case 7:Q=Q.then(()=>{Object(R.a)(Ig.DdaFacade,yf.a(this.$)).gi.nXe(Wa.controlId,Wa.isEnableEvents);return Promise.resolve(null)});break;case 5:Q=Q.then(()=>this.fth(Wa));break;case 6:Q=Q.then(()=>this.yfj(Wa));break;case 8:Q=Q.then(()=>{z.EwaSettings.isChangeGateEnabled("OfficeVSO:5333368_ClearBeforeCloseRegistrationsInWorkbookCloseApi")&&Object(R.a)(Ig.DdaFacade,yf.a(this.$)).zeh();const sc=new Lj.a(Mj.a.Nk,
5,null);Kj.a(this.$).Ys(sc);return Promise.resolve(null)});break;case 9:Q=Q.then(()=>this.hMj(Wa));break;case 10:Q=Q.then(()=>this.Ylk(Wa));break;case 11:Q=Q.then(()=>this.Xlk());break;case 12:Q=Q.then(()=>this.Ulk());break;case 13:Q=Q.then(()=>this.Vlk(Wa));break;case 14:Q=Q.then(()=>this.Wlk(Wa));break;case 16:Q=Q.then(()=>Promise.resolve(Wa));break;case 17:Q=Q.then(()=>this.rIj(Wa,Object(R.a)(Ig.DdaFacade,yf.a(this.$))));break;case 18:dc.h(this.$).focus();break;case 19:this.rhf(Wa.entryType,!1,
Wa.options);break;case 20:this.rhf(Wa.entryType,!0,Wa.options);break;case 21:const Ib=yf.a(this.$);Q=Q.then(()=>Ib.mVd.wki(Wa));break;case 22:const fc=yf.a(this.$);Q=Q.then(()=>fc.mVd.xki(Wa));break;case 23:(tf.a.UEb(this.$)||tf.a.Fna())&&this.ze.j9f.oni(Wa.worksheetId,Wa.anchorCell,Wa.values,Wa.options);break;case 24:(tf.a.UEb(this.$)||tf.a.Fna())&&this.ze.j9f.Cli(Wa.worksheetId);break;default:Q=Q.then(()=>Promise.reject(Ef.o7a(Qh.Z0g,Df.a.instance.ha(1766),null)))}return Q})}Hmi(Q){var Wa=Object(R.a)(Ig.DdaFacade,
yf.a(this.$)).Xn(Q.controlId);if(Wa&&!(0===Q.operationType^!Wa.vga)){dc.h(this.$).FDb=!0;switch(Q.operationType){case 0:var Ib=new Jj.a(document.createElement("input"));Ib.text=Q.range;Wa.tvi(dc.h(this.$).Nh.Brh(Ib,new Gj.a(this.$)));Wa.vga.startEdit(!0);break;case 1:Wa.f4f();this.rangePicker=null;break;case 2:Wa.vga.Uug(Q.range);break;case 3:Wa.vga.Uug(Q.startingRange);Wa=Q.expandSelection;Ib=Q.getNextDataRegionCell;let fc=0;switch(Q.keyboardDirectionValue){case 2:fc=38;Q=Wa&&Ib?105288353:Wa?-31900117:
Ib?542791952:137938150;break;case 3:fc=40;Q=Wa&&Ib?-1297307319:Wa?-1603798598:Ib?1713663844:-798660877;break;case 0:fc=37;Q=Wa&&Ib?-403586027:Wa?2039316657:Ib?-2012742350:-1470715894;break;case 1:fc=39;Q=Wa&&Ib?784916030:Wa?589730764:Ib?1324884057:-1231471547;break;default:Q=1461300262}Wa=this.dac("keydown",fc,Wa,Ib);dc.h(this.$).NPb(Wa,new jh.a(Q,1,0,8,null))}dc.h(this.$).FDb=!1}}dac(Q,Wa,Ib,fc){const sc=document.createEvent("KeyboardEvent");if(uf.a.WG)sc.initKeyboardEvent(Q,!1,!1,window.self,"A",
0,fc,!1,Ib,!1);else{let Tc="";Ib&&(Tc+="Shift");fc&&(Tc+=0<Tc.length?" Control":"Control");sc.initKeyboardEvent(Q,!1,!1,window.self,"A",0,Tc,!1,"en-US")}Q=new Sys.UI.DomEvent(sc);Q.keyCode=Wa;return Q}Qki(Q){switch(Q.operationType){case 1:Wf.TaskExtensions.za(Kg.GetServiceTaskFactory.create(this.$.da,153,this.$.ka,1),Wa=>{Wa.result.iUd()},this.$.ka,3);break;case 2:if(Q=Object(R.a)(Ig.DdaFacade,yf.a(this.$)).Xn(Q.controlId))Q.koc=!0,Q.WYf()}}fth(Q){const Wa=Q.fileBase64;return Wa&&Wa.length>this.$.xa.CreateWorkbookMaxAllowedBase64Size?
Promise.reject(Ef.o7a(Qh.invalidArgument,Df.a.instance.ha(1769),"Application.CreateWorkbook")):(new Promise((Ib,fc)=>{const sc=new Qg.StandardDialog;sc.Ac=4;sc.km(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,Tc=>{2!==Tc&&0!==Tc||fc(Ef.o7a(Qh.zLd,Df.a.instance.ha(1768),"Application.CreateWorkbook"));Tc=new Vg("blank","agave",Wa?"streamBase64":"streamEmpty",Wa);this.iGf.create(Ib,fc,Tc).J4a()})})).then(Ib=>{this.Kec.set(Q.fakeFileId,Ib);return Promise.resolve(null)},
Ib=>Ib?Promise.reject(Ib):Promise.reject(Ef.o7a(Qh.generalException,Df.a.instance.ha(1765),"Application.CreateWorkbook")))}yfj(Q){return new Promise((Wa,Ib)=>{if(this.Kec.has(Q.fakeFileId)){const fc=this.Kec.get(Q.fakeFileId);Ib=new Qg.StandardDialog;Ib.Ac=4;Ib.km(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_OpenWindowConsentMessage,1,sc=>{1===sc&&ua.HelperMethods.Vf(fc,void 0,void 0,"DdaMethodHandler.fileUrl");Wa(null)})}else Ib(Ef.o7a(Qh.generalException,Df.a.instance.ha(1765),
"Document.Open"))})}hMj(Q){return new Promise(Wa=>{Object(R.a)(Ig.DdaFacade,yf.a(this.$)).k9f=Q.runtimeCalculationMode;const Ib=this.$.da.Ba(268);Ib&&Ib.JHd(3===Q.runtimeCalculationMode);Wa(null)})}Ylk(Q){tf.a.SGb(this.$)&&this.$.da.Ba(331).ghb(0,Q.urlStr,!0,!0,null);return Promise.resolve(null)}Xlk(){tf.a.SGb(this.$)&&this.$.da.Ba(331).ghb(1,null,!0,!0,null);return Promise.resolve(null)}Ulk(){tf.a.SGb(this.$)&&this.$.da.Ba(331).kXe();return Promise.resolve(null)}Vlk(Q){tf.a.SGb(this.$)&&this.$.da.Ba(331).ghb(5,
Q.urlStr,!0,!0,null);return Promise.resolve(null)}Wlk(Q){if(tf.a.SGb(this.$)){const Wa=this.$.da.Ba(331);for(const Ib of Wa.nda)Ib.IsActive&&Ib.HostEditUrl&&Ib.UrlStr===Q.hostEditUrlStr&&ua.HelperMethods.Vf(Ib.HostEditUrl,"_blank")}return Promise.resolve(null)}rIj(Q,Wa){const Ib=Qf.a.FM;Q=u.a.ij(Q.payload);const fc={};"eventId"in Q&&"payload"in Q&&(fc.eventId=Q.eventId,fc.payload=Q.payload);Wa.yG(2201,Ib,u.a.nd(fc));return Promise.resolve(null)}rhf(Q,Wa,Ib){const fc=this.$.da.Ba(5);fc&&(Q=this.o1h(Q))&&
(Wa?fc.removeEntry(Q):fc.Owe(Q,Ib))}o1h(Q){switch(Q){case 0:return 64;case 1:if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:7109926_MsFormsBusinessBarApi"))return 69}}j1c(Q){Q=Object(R.a)(Ij.a,this.$.ua.getItemByName(Q));(null===Q||void 0===Q?0:Q.visible)&&Q.activate(!0)}Eug(Q,Wa,Ib,fc){var sc=Q.pa.Qr;const Tc=sc<Wa.length&&Wa[sc].contains(Q.pa.activeCell);Q=Tc?Q.pa.activeCell:Wa[0].topLeft;sc=Tc?sc:0;dc.h(this.$).M0(Wa,sc,Ib,null,Q,null,null,3,"DdaMethodHandler.UpdateSelection",void 0,void 0,void 0,
6===fc)}static get xuh(){Ef.Psa||(Ef.Psa={},Ef.Psa[Microsoft.Office.WebExtension.CoercionType.Table]=1,Ef.Psa[Microsoft.Office.WebExtension.CoercionType.Text]=2,Ef.Psa[Microsoft.Office.WebExtension.CoercionType.Matrix]=3,Ef.Psa[Microsoft.Office.WebExtension.CoercionType.Html]=4,Ef.Psa[Microsoft.Office.WebExtension.CoercionType.Ooxml]=5);return Ef.Psa}static get Auh(){Ef.pmb||(Ef.pmb={},Ef.pmb[Microsoft.Office.WebExtension.FilterType.All]=1,Ef.pmb[Microsoft.Office.WebExtension.FilterType.OnlyVisible]=
2);return Ef.pmb}static get Buh(){Ef.qmb||(Ef.qmb={},Ef.qmb[Microsoft.Office.WebExtension.ValueFormat.Unformatted]=2,Ef.qmb[Microsoft.Office.WebExtension.ValueFormat.Formatted]=1);return Ef.qmb}static Eaf(Q){if(!Q||!Q.length)return null;const Wa=Array(Q.length/2);for(let Ib=0;Ib<Q.length/2;Ib++)Wa[Ib]={},Wa[Ib].Name=Q[2*Ib],Wa[Ib].Value=Q[2*Ib+1];return Wa}static Rfi(Q){if(!Q||!Q.length)return null;const Wa=Array(2*Q.length);for(let Ib=0;Ib<Q.length;Ib++)Wa[2*Ib]=Q[Ib].Name,Wa[2*Ib+1]=Q[Ib].Value;
return Wa}static zjd(Q){if(!Q||!Q.length)return null;const Wa=Array(Q.length);for(let Ib=0,fc=Q.length;Ib<fc;Ib++){const sc=Q[Ib].length;if(sc){Wa[Ib]=Array(sc);for(let Tc=0;Tc<sc;Tc++)Wa[Ib][Tc]=null==Q[Ib][Tc]?null:Q[Ib][Tc].toString()}else return null}return Wa}static s9b(Q){return"string"===typeof Q?kj.a.nr(Ef.xuh,Q,0):Q}static X3e(Q){return"string"===typeof Q?kj.a.nr(Ef.Auh,Q,0):Q}static swg(Q){return"string"===typeof Q?kj.a.nr(Ef.Buh,Q,0):Q}static hBi(Q){switch(Q.DdaMethod.DispatchId){case 68:case 74:case 70:case 77:case 80:case 64:case 75:case 81:return!0}return!1}static u6c(Q,
Wa){const Ib={};Ib.CoerceType=Q;1===Ib.CoerceType?(Ib.Data=Ef.zjd(Wa.Rows),Ib.Headers=Ef.zjd(Wa.Headers)):Ib.Data=Ef.zjd(Wa);return Ib}static HFe(Q){return 1===Q.CoerceType?{["Headers"]:Q.Headers,["Rows"]:Q.Data}:Q.Data}static tmc(Q){return 1===Q.CoerceType?!Q.Data&&!Q.Headers:!Q.Data}static Ydf(Q){let Wa="Unknown";if(!Q)return Wa;for(let Ib=0;Ib<Q.length;Ib++)if(Q[Ib].Name.toLowerCase()===Cc.a.AFj){Wa=Q[Ib].Value;break}return Wa}static IUj(Q){if(!Q)return!1;const Wa=Cc.a.e0i.toLowerCase();for(let Ib=
0;Ib<Q.length;Ib++)if(Q[Ib].Name.toLowerCase()===Wa)return!0;return!1}static o7a(Q,Wa,Ib){const fc={};fc.Code=Q;fc.Message=Wa;fc.Location=Ib;fc.ActionIndex=0;return fc}}Ef.Psa=null;Ef.pmb=null;Ef.qmb=null;Ef.BMd=0;Object(e.a)(Ef,"DdaMethodHandler",null,[210,2]);class lj extends Sd.a{constructor(Q){super(Q)}ue(){const Q=Kg.GetServiceTaskFactory.create(this.$.da,106,this.ka,this.La),Wa=Kg.GetServiceTaskFactory.create(this.$.da,165,this.ka,this.La),Ib=vi(this.ka,this.La),fc=Object(Gf.d)(bg.a.resolve(sg.W,
{Wa:this.La}));Wf.TaskExtensions.za(Wf.TaskExtensions.xe([Q,Wa,Ib,fc],this.ka),()=>{const Tc=Q.result,ad=fd.a.instance.resolve("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory");this.Zd([new Ef(this.$,Tc,ad,fc.result)])},this.ka,3);const sc=fd.a.instance;Wf.TaskExtensions.za(Kg.GetServiceTaskFactory.create(this.$.da,137,this.$.ka,this.La),()=>{sc.register(Ad,"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").gd().od(()=>new Ad)},this.$.ka)}static la(Q){Sd.a.Ie(82,
new lj(Q))}}Object(e.a)(lj,"DdaCommandHandlerFactory",Sd.a,[]);c.a.sj(".ewa-wx-disabled-div{position:absolute;height:100%;width:100%}.ewa-wx-container-div{position:relative}.ewa-ptp-nov2-flex .ewa-wx-container-div{flex:1}");(()=>{b.a.Fa(Q=>{Qc.la(Q)})})();(()=>{b.a.Fa(Q=>{z.EwaSettings.ya(52)&&Nh.la(Q)})})();(()=>{b.a.Fa(Q=>{z.EwaSettings.ya(114)&&Yh.la(Q)})})();b.a.Fa(ui.la);b.a.Fa(li.la);(()=>{b.a.Fa(Q=>{di.la(Q);ec.la(Q)})})();b.a.Fa(lj.la)},1548:function(r,C,a){r=a(0);var c=a(198),b=a(105);class e{constructor(){this.gWe=
this.displayName=this.ewb=this.gp=this.PC=null;this.isUpgraded=!1}puf(d,h){return this.PC.getStoreType().toLowerCase()===d.toLowerCase()&&this.PC.getSolutionId().toLowerCase()===h.toLowerCase()}}Object(r.a)(e,"AddinCommandsResourceItem",null,[]);a.d(C,"a",function(){return f});class f{constructor(){this.DMc=null;this.xRc=0;this.cTc=!1;this.$a=new b.a;this.VIg=new c.a}cWg(d){this.$a.addHandler("AddinCommandsLoadingMessageChanged",d)}Axj(d){this.$a.removeHandler("AddinCommandsLoadingMessageChanged",
d)}get M1a(){return this.DMc}Ghb(d){d!==this.DMc&&(this.DMc=d,this.$a.raiseEvent("AddinCommandsLoadingMessageChanged"))}cMj(){this.xRc++;this.M1a||this.Ghb(CommonUIStrings.l_LoadingAddInsTitle)}WXd(){this.xRc--;this.drc()&&(this.cTc?this.M1a!==CommonUIStrings.l_ErrorLoadingAddInsTitle&&this.Ghb(CommonUIStrings.l_ErrorLoadingAddInsTitle):this.Ghb(null))}vdg(d=!1){this.cTc=!0;this.Ghb(d?CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg:CommonUIStrings.l_ErrorLoadingAddInsTitle)}QJe(){this.cTc=
!1;this.drc()?this.Ghb(null):this.Ghb(CommonUIStrings.l_LoadingAddInsTitle)}drc(){return 0>=this.xRc}get H9a(){return this.VIg}Gla(d,h,l=0){for(let k of this.H9a)if(k.puf(d,h)&&(!k.gp||k.gp.NZh===l))return k;return null}Jwe(d,h,l,k){const u=new e;u.PC=d;u.gp=h;u.ewb=l;u.displayName=k;this.H9a.add(u)}eUg(d,h,l,k){const u=new e;u.PC=d;u.gp=h;u.ewb=null;u.gWe=l;u.displayName=k;this.H9a.add(u)}Wvj(d,h){let l=0;for(let k of this.H9a)k.PC.getStoreType()===d&&k.PC.getSolutionId()===h?this.H9a.removeAt(l):
l++}static getInstance(){f.Oa||(f.Oa=new f);return f.Oa}}f.Oa=null;Object(r.a)(f,"AddinCommandsResourceManager",null,[])},762:function(r,C,a){a.d(C,"a",function(){return b});r=a(0);var c=a(38);class b{static get kWi(){return b.Vle||(b.Vle={["-2002156328"]:b.BLe,["-1954750170"]:b.Aef,["317650254"]:b.pgh,["-1005263101"]:b.xxi,["1353664579"]:b.GJj,["159671765"]:b.yxi,["1446690022"]:b.b$e,["1150069548"]:b.gJc,["-1409306331"]:b.mIe,["338507772"]:b.ORe,["-457159301"]:b.pgj,["-1037701970"]:b.Yth,["-1893322318"]:b.Dxi,
["965579896"]:b.$th,["93287890"]:b.Zth,["358088857"]:b.UMj,["-1223650923"]:b.ORe,["2007306190"]:b.lch,["1549955423"]:b.KEe,["-1275974171"]:b.Cxi,["382101082"]:b.Bfj,["-898776235"]:b.SXi,["335464256"]:b.JXi,["1677378049"]:b.Bxi,["-261992848"]:b.Ubk,["-980820954"]:b.KEe,["-931375837"]:b.Afj,["929186550"]:b.MBh,["-982144310"]:b.Inj,["-785741187"]:b.vxi,["2125217573"]:b.Fxi,["299124955"]:b.wxi,["1669853884"]:b.OFj,["-1515932330"]:b.qgh,["314621024"]:b.dWh,["-300049690"]:b.pch,["14766835"]:b.lSj,["-1251992761"]:b.iVe,
["-2087635043"]:b.invalidOrTimedOutSession,["2100961153"]:b.invalidOrTimedOutSession,["-1218744139"]:b.invalidSheetName,["-1468309555"]:5006,["-315732528"]:b.invalidOrTimedOutSession,["611268539"]:b.invalidOrTimedOutSession,["1531005923"]:5006,["1593924569"]:5006,["299476328"]:b.WIa,["49173765"]:b.WIa,["-907155566"]:b.WIa,["-1201603824"]:b.WIa,["1541165282"]:b.WIa,["-1347753427"]:b.WIa,["134912532"]:b.WIa,["1780971550"]:b.responsePayloadSizeLimitExceeded})}static v6e(e){return c.a.nr(b.kWi,e.toString(),
b.internalError)}}b.success=0;b.BLe=1E3;b.Aef=1001;b.pgh=1002;b.xxi=1003;b.GJj=1004;b.yxi=1005;b.b$e=1008;b.H3e=1009;b.invalidSheetName=1014;b.gJc=2E3;b.mIe=2001;b.ORe=2002;b.pgj=2003;b.Yth=2004;b.Dxi=2005;b.$th=2007;b.Zth=2008;b.UMj=2009;b.lch=2014;b.tJj=3E3;b.KEe=3002;b.Cxi=3004;b.Bfj=3005;b.SXi=3006;b.JXi=3007;b.Bxi=3008;b.Ubk=3009;b.Afj=3010;b.lSj=4002;b.DLd=5E3;b.internalError=5001;b.iVe=5002;b.eEb=5004;b.Zck=5007;b.hsi=5008;b.B7f=5011;b.invalidOrTimedOutSession=5012;b.ALc=5016;b.WIa=5102;b.JCj=
5103;b.responsePayloadSizeLimitExceeded=5104;b.Fbh=7001;b.Ikg=7002;b.MBh=8E3;b.Inj=8001;b.vxi=8010;b.Fxi=8011;b.wxi=8012;b.OFj=8020;b.qgh=8021;b.dWh=8022;b.pch=8023;b.RVi=11E3;b.IYi=11001;b.Exi=11002;b.Vle=null;Object(r.a)(b,"DdaErrorIds",null,[])},763:function(r,C,a){a.d(C,"a",function(){return e});r=a(0);var c=a(15),b=a(115);class e{constructor(){this.xRd=0;this.iY={};this.cwa={}}Mai(f,d){return this.iY[e.x6c(f,d)]}nXe(f,d){d||void 0!==this.cwa[f]&&null!==this.cwa[f]?d&&void 0!==this.cwa[f]&&null!==
this.cwa[f]&&delete this.cwa[f]:this.cwa[f]=1}a6b(f){return void 0===this.cwa[f]||null===this.cwa[f]}Lhf(f){const d=e.x6c(f.messageType,f.targetId);1===f.actionType?this.Mmi(f.controlId,f.messageType,d):2===f.actionType&&this.Eni(f.controlId,f.messageType,d)}Dwj(f){if(f){var d=Object.keys(this.iY);if(!(void 0===d||null===d||0>=d.length))for(const h of d)d=this.iY[h],d[f]&&(delete d[f],Object.keys(d).length||delete this.iY[h])}}XL(f,d){f=e.x6c(f,d);f=this.iY[f];return!!f&&0<Object.keys(f).length}zoi(){return!b.a.isEmpty(this.iY)}mvf(){return 0<
this.xRd}K5h(){const f=[],d=this.iY;for(let k in d){var h=k,l=d[k];for(let u in l){l=u;const v={};v.eventType=parseInt(h.split("#")[0],10);v.targetId=h.split("#")[1];v.addinId=l;f.push(v)}}return f}Mmi(f,d,h){if(this.iY[h])h=this.iY[h],h[f]=h[f]?h[f]+1:1;else{let l={};l[f]=1;this.iY[h]=l}100===d&&this.xRd++}Eni(f,d,h){if(this.iY[h]){const l=this.iY[h];if(f){const k=l[f];1===k?(delete l[f],Object.keys(l).length||delete this.iY[h]):l[f]=k-1;100===d&&this.xRd--}else c.ULS.sendTraceTag(537170459,0,50,
`The OsfControl[${f}] doesn't register event with key[${h}].`)}else c.ULS.sendTraceTag(537170460,0,50,`The event with key[${h}] that will be unregistered doesn't exist.`)}static x6c(f,d){return String.format("{0}#{1}",f,d)}}e.FM="Workbook";Object(r.a)(e,"RichApiEventRegistration",null,[])},764:function(r,C,a){a.d(C,"a",function(){return c});r=a(0);class c{}c.generalException="GeneralException";c.invalidArgument="InvalidArgument";c.notImplemented="NotImplemented";c.H0c="AccessDenied";c.notSupported=
"NotSupported";c.apiNotAvailable="ApiNotAvailable";c.notAllowed="NotAllowed";c.zLd="OperationCancelled";c.userNotSignedIn="UserNotSignedIn";c.userAborted="UserAborted";c.bdk="UnsupportedUserIdentity";c.invalidResourceUrl="InvalidResourceUrl";c.invalidGrant="InvalidGrant";c.a_g="AddinIsAlreadyRequestingToken";c.lEj="ResourceNotAllowed";c.clientError="ClientError";c.serverError="ServerError";c.okh="ControlIdNotFound";c.XEj="RibbonApiNotAvailable";c.hostRestartNeeded="HostRestartNeeded";c.invalidRibbonDefinition=
"InvalidRibbonDefinition";c.sharedRuntimeNotAvailable="SharedRuntimeNotAvailable";Object(r.a)(c,"ErrorCodes",null,[])},767:function(r,C,a){a.r(C);var c=a(0),b=a(2),e=a(15),f=a(1372),d=a(88),h=a(105);class l{constructor(Aa,Eb,cc){this._id=Aa;this.RCg=Eb;this.ZEg=cc;this.kof=OfficeExt.CommandInvokeMode.Default}get id(){return this._id}get $Zg(){return this.RCg}get Ugh(){return this.ZEg}execute(Aa,Eb,cc){cc=cc||{};cc.commandMode=this.kof;Eb.invokeAppCommand(this.$Zg,this.Ugh,cc,()=>{Aa.S9i(this.id)})}}
Object(c.a)(l,"AddinNativeActionBase",null,[855]);class k extends l{constructor(Aa,Eb){super(1,Aa,Eb);this.kof=OfficeExt.CommandInvokeMode.ExclusiveForNew}}Object(c.a)(k,"AddinTakeSnapshotAction",l,[]);class u{Wlh(Aa){return new l(3,Aa,this.v_h().getNativeActionName(3))}v_h(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()}}Object(c.a)(u,"AddinNativeActionManager",null,[832]);var v=a(156);class x{invokeAppCommand(Aa,Eb,cc,pc){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(Aa,
Eb,cc,pc)}static getInstance(){x.Oa||(x.Oa=new x);return x.Oa}}x.Oa=null;Object(c.a)(x,"OSFAddinCommandsRuntimeManager",null,[833]);var w=a(6),m=a(193),t=a(31);class z extends v.a{constructor(Aa,Eb,cc){super();this.hba=null;this.F_c="WACDialogTitleText";this.nZ="0";this.paa="15px";this.oFg="0px";this.mZ="calc(100% - 30px)";this.nFg="100%";this.vpe=0;this.$a=new h.a;this.TCg=new u;this.Ac=5;this.ef=this.rGa=cc;this.KPc=Aa;this.iee=Eb;this.ZPc=!!w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ra("OfficeAddinEnableInsertDialogAccessibilityFix")}qYg(Aa){this.$a.addHandler("OnDialogClosedEventKey",
Aa)}cPj(){this.BHa=null}oy(){super.oy();this.Mi.style.width="100%";this.Mi.style.height=this.LCb?this.mZ:this.nFg;this.Mi.style.marginTop=this.LCb?this.paa:this.oFg;this.Mi.style.padding=this.nZ}kF(){super.kF();this.Rb.style.width=String.format("{0}px",this.KPc*window.innerWidth/100);this.Rb.style.height=String.format("{0}px",this.iee*window.innerHeight/100);this.Rb.style.minWidth="0px";this.ZPc&&w.AFrameworkApplication.isRtl&&100===this.KPc&&(this.Rb.style.right="0px",this.Rb.style.marginRight="0px");
this.hba=document.getElementById(this.Hi(this.F_c));this.hba.style.position="absolute";this.hba.style.whiteSpace="nowrap";this.hba.style.textOverflow="ellipsis";w.AFrameworkApplication.isRtl?(this.hba.style.right="14px",this.hba.style.left="44px"):(this.hba.style.right="44px",this.hba.style.left="14px")}Uz(Aa){super.Uz(Aa);this.hba&&this.hba.setAttribute("title",Aa)}get Vca(){return this.Mi}oUd(){this.Rb.style.width=String.format("{0}px",this.KPc*window.innerWidth/100);this.Rb.style.height=String.format("{0}px",
this.iee*window.innerHeight/100);this.Rb.style.overflowY="hidden";this.Rb.style.overflowX="hidden";this.Rb.style.marginTop="";this.Rb.style.top="";t.a.gX&&w.AFrameworkApplication.isRtl?(this.Rb.style.right="",this.Rb.style.marginRight=""):(this.Rb.style.left="",this.Rb.style.marginLeft="")}hide(){this.TCg.Wlh(this.rGa).execute(this,x.getInstance(),{});this.vpe=window.setTimeout(()=>{this.$a.raiseEvent("OnDialogClosedEventKey",this.rGa);m.a.prototype.hide.call(this)},500)}S9i(Aa){3===Aa&&(window.clearTimeout(this.vpe),
this.$a.raiseEvent("OnDialogClosedEventKey",this.rGa),super.hide())}}Object(c.a)(z,"AppsForOfficeDialog",v.a,[798,799]);class y{constructor(){this.dialog=this.ef=null}}Object(c.a)(y,"DialogInfo",null,[]);class D{}D.url="url";D.height="height";D.width="width";D.ded="displayInIframe";D.Jkc="hideTitle";Object(c.a)(D,"DialogSettings",null,[]);class H{constructor(){this.height=this.width=0;this.ef=this.controlId=this.pageUrl=null;this.Jkc=this.ded=!1}}Object(c.a)(H,"DisplayDialogParams",null,[]);class F extends Sys.EventArgs{constructor(Aa,
Eb,cc=null,pc="",Hc=""){super();this.controlId=Aa;this.messageType=Eb;this.messageContent=cc;this.messageOrigin=pc;this.targetOrigin=Hc}}Object(c.a)(F,"OnMessageDialogEventArgs",Sys.EventArgs,[]);class G extends Sys.EventArgs{constructor(Aa,Eb,cc=null,pc="",Hc=""){super();this.controlId=Aa;this.messageType=Eb;this.messageContent=cc;this.messageOrigin=pc;this.targetOrigin=Hc}}Object(c.a)(G,"OnMessageParentEventArgs",Sys.EventArgs,[]);var L=a(43),M=a(32),O=a(173),B=a(106);class E{constructor(Aa){this.$a=
new h.a;this.Kk=Aa}yYg(Aa){this.$a.addHandler("OnMessageParentEventKey",Aa)}xYg(Aa){this.$a.addHandler("OnMessageDialogEventKey",Aa)}showDialog(Aa,Eb,cc,pc){if(E.caa.Pb(Eb))e.ULS.sendTraceTag(18896285,344,100,"ShowDialog: agave dialog map already has dialog info for this control."),cc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else try{const nf=L.b(Aa),Cb=nf[D.url];if(this.Kk.getOsfControl(Eb).checkAppDomains(Cb)){var Hc=new H;Hc.width=nf[D.width];Hc.height=nf[D.height];Hc.pageUrl=Cb;Hc.ded=
nf[D.ded];Hc.Jkc=nf[D.Jkc];Hc.controlId=Eb;Hc.ef=O.a.create().toString();var td=new y;td.ef=Hc.ef;var me=this.Kk.getOsfControl(Hc.controlId).getManifest().getDefaultDisplayName(),ve=this.Kk.getOsfControl(Hc.controlId).getStoreType().toLowerCase();Aa=null;Aa=(4===w.AFrameworkApplication.sa.Qa.li&&"hardcodedpreinstall"===ve||"sdxcatalog"===ve)&&Hc.Jkc?this.createAndShowAppsForOfficeDialog(Hc.width,Hc.height,Hc.ef,!0,me):this.createAndShowAppsForOfficeDialog(Hc.width,Hc.height,Hc.ef,!1,me);var Qe=this.Kk.getOsfControl(Hc.controlId),
Ze=Qe.getManifest();Eb={};Eb.id=Hc.ef;Eb.solutionId=Qe.getSolutionId();Eb.version=Qe.getVersion();Eb.storeType=ve;Eb.storeId=Qe.getStoreId();Eb.assetId=Qe.getAssetId();Eb.assetStoreId=Qe.getAssetStoreId();Eb.ownerAddinSolutionId=Qe.getOwnerAddinSolutionId();Eb.ownerAddinStoreType=Qe.getOwnerAddinStoreType();Eb.appDomains=Ze.getAppDomains();Eb.dialogUrl=Cb;Eb.osfControlType=1;Eb.agaveName=me;Eb.div=Aa.Vca;e.ULS.sendTraceTag(542978531,344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Eb.solutionId,
Eb.ownerAddinStoreType||Eb.storeType,Eb.assetId,null,null,Eb.storeId),M.a.Av(Hc.pageUrl));this.Kk.insertDialogControl(Eb);Aa.qYg(Object(d.a)(this,this.c4i,"onDialogClosed"));td.dialog=Aa;E.caa.ia(Hc.controlId,td);pc&&pc(Eb);cc(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else e.ULS.sendTraceTag(19940611,344,10,"ShowDialog: dialog url not in app domains list."),cc(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(nf){e.ULS.sendTraceTag(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",
nf.message),cc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}mWi(Aa,Eb,cc,pc){w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",!1)||""===pc&&(pc=cc);try{const Hc=this.JNa(Aa);Hc&&this.$a.raiseEvent("OnMessageParentEventKey",new G(Hc,OSF.DialogMessageType.DialogMessageReceived,Eb,cc,pc))}catch(Hc){return e.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",Hc.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}Bvb(Aa,
Eb){if(E.caa.Pb(Aa))try{const cc=E.caa.ma(Aa);cc.dialog&&cc.dialog.hide();this.Kk.purgeDialogControl(cc.ef);E.caa.remove(Aa);Eb(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(cc){e.ULS.sendTraceTag(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",cc.message),Eb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else e.ULS.sendTraceTag(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),Eb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}rKj(Aa,
Eb,cc,pc){w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",!1)||""===pc&&(pc=cc);if(E.caa.Pb(Aa)&&(Aa=E.caa.ma(Aa),Aa.dialog))try{this.$a.raiseEvent("OnMessageDialogEventKey",new F(Aa.ef,OSF.DialogMessageType.DialogParentMessageReceived,Eb,cc,pc))}catch(Hc){e.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",Hc.message)}}JNa(Aa){let Eb=null;for(let cc of E.caa)if(cc.value.ef===Aa){Eb=cc.key;
break}return Eb}c4i(Aa,Eb){if(Aa=this.JNa(Eb))this.Kk.purgeDialogControl(Eb),E.caa.remove(Aa),this.$a.raiseEvent("OnMessageParentEventKey",new G(Aa,OSF.DialogMessageType.DialogClosed,null,null,"*"))}createAndShowAppsForOfficeDialog(Aa,Eb,cc,pc,Hc){Aa=new z(Aa,Eb,cc);Hc=pc?"":String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,Hc);pc&&(Aa.LCb=!1,Aa.Ru=!1);Aa.initializeAndShow(Hc,null,null);Aa.cPj();return Aa}static Qii(){return E.caa}static getInstance(Aa){E.Oa||(E.Oa=new E(Aa));return E.Oa}}
E.Oa=null;E.caa=new B.a;Object(c.a)(E,"AppsForOfficeDialogManager",null,[176]);var I=a(891),S=a(714),J=a(564),K=a(198),R=a(386),Z=a(908);class P{constructor(){this.downloadNumber=this.AUP=this.priority=0}}Object(c.a)(P,"AddinDetailInfo",null,[]);class V{constructor(Aa){this.solutionIds=null;this.errorCode=0;this.failure=null;this.rca=Aa}}Object(c.a)(V,"AddinCollection",null,[]);class Ea extends Sys.EventArgs{constructor(Aa,Eb,cc,pc=null){super();this.wI=Aa;this.errorCode=Eb;this.XK=cc;this.failure=
pc}}Object(c.a)(Ea,"AddinDetailsRefreshedEventArgs",Sys.EventArgs,[]);class oa{constructor(Aa){this.errorCode=Aa;this.XK=[];this.failure=null}}Object(c.a)(oa,"GetAddinDetailsResult",null,[]);var ea=a(745),aa=a(825),ia=a(861),ya=a(161),za=a(188),la=a(85);class xa{constructor(Aa,Eb,cc=null){this.$a=new h.a;this.Xp=new S.a(J.a.hh());this.fk=new R.a;this.VQ=null;this.G4=new za.a;this.G4.add(OSF.StoreTypeEnum.MarketPlace,0);this.G4.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.Ra=Aa;this.Kk=Eb;this.ks=
cc;this.Inb=xa.jBb(Aa,"https://store-images.s-microsoft.com");this.Wua(Object(d.a)(this,this.xBa,"onAddinDetailsRefreshed"))}get Exa(){return!!this.Ra&&this.Ra.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",!1)}get $Eb(){return this.Ra.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",!1)}get Xf(){return this.Kk.value}oAb(Aa){if(!this.y7(Aa))return Aa=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:Z.a[Aa]}),
Object.assign(new oa(1),{failure:Aa});if(this.fk.ma(Aa).failure)return Object.assign(new oa(this.fk.ma(Aa).errorCode),{failure:this.fk.ma(Aa).failure});e.ULS.shipAssertTag(509870082,220,!!this.fk.ma(Aa).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",Aa);const Eb=new oa(0);for(let cc of this.fk.ma(Aa).solutionIds)this.Xp.Pb(cc)&&Array.add(Eb.XK,this.Xp.ma(cc));return Eb}nAb(Aa){return this.Xp.Pb(Aa)?this.Xp.ma(Aa):null}Ifb(Aa){if(Aa){this.Wua(Aa);
for(let cc of this.fk.keys)if(this.y7(cc)&&!this.fk.ma(cc).failure){e.ULS.shipAssertTag(509870081,220,!!this.fk.ma(cc).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",cc);var Eb=[];for(let pc of this.fk.ma(cc).solutionIds)Array.add(Eb,this.Xp.ma(pc));Eb=new Ea(cc,this.fk.ma(cc).errorCode,Eb);Aa(null,Eb)}}}mH(Aa,Eb=!1){0!==Aa&&10!==Aa?e.ULS.sendTraceTag(509870080,220,50,"QueryAddinDetails: skipping providerType: {0}.",aa.a[Aa]):this.lNb(Aa,Object(d.a)(this,
this.nLb,"onQueryAddinDetailsCompleted"),Eb)}Wua(Aa){this.$a.addHandler(ea.a.N1a,Aa)}nLb(Aa,Eb,cc){if(cc)if(xa.kIb(Aa,cc,window.performance.now()-Eb),0===cc.errorCode){let Hc;if(cc.value){let td=0;Hc=Array(cc.value.length);cc.value.forEach(me=>{Hc[td++]=me})}else Hc=[];this.HC(Aa,Hc)}else if(-1===cc.errorCode||10===cc.errorCode)this.HC(Aa,[]);else{var pc={};pc.collectionType=Z.a[Aa];pc.invokeResultCode=cc.errorCode;pc["queryResult.Value"]=cc.value?String.format("Length: {0}",cc.value.length):"null";
pc.queryStart=Eb;pc.queryDuration=window.performance.now()-Eb;this.fk.ia(Aa,Object.assign(new V(Aa),{errorCode:3,failure:Error.create("QueryAddinDetails hit an invocation failure",pc)}));e.ULS.sendTraceTag(512231324,220,15,"OnQueryAddinDetailsCompleted: fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",Z.a[Aa],this.fk.ma(Aa).failure.toString(),JSON.stringify(this.fk.ma(Aa).failure))}else pc={},pc.collectionType=Z.a[Aa],pc.queryResult=cc?"not null":"null",pc.queryStart=
Eb,pc.queryDuration=window.performance.now()-Eb,this.fk.ia(Aa,Object.assign(new V(Aa),{errorCode:3,failure:Error.create("QueryAddinDetails hit an invocation failure",pc)})),e.ULS.sendTraceTag(512231323,220,10,"OnQueryAddinDetailsCompleted: fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",Z.a[Aa],this.fk.ma(Aa).failure.toString(),JSON.stringify(this.fk.ma(Aa).failure))}wrd(Aa){const Eb={};Eb.collectionType=Z.a[Aa];this.fk.ia(Aa,Object.assign(new V(Aa),{errorCode:2,
failure:Error.create("The store is disabled.",Eb)}));e.ULS.sendTraceTag(510253056,220,15,"Fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",Z.a[Aa],this.fk.ma(Aa).failure.toString(),JSON.stringify(this.fk.ma(Aa).failure))}WRb(){return this.y7(2)?this.Ra.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins")?!!this.fk.ma(2).failure:!1:!0}lNb(Aa,Eb,cc=!1){e.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",Aa);Aa!==
OSF.StoreTypeEnum.MarketPlace&&Aa!==OSF.StoreTypeEnum.PrivateCatalog?e.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",Aa):(this.WRb()&&this.queryStoreDisabled(0,(pc,Hc)=>{Hc?this.wrd(2):(pc=window.performance.now(),Eb(2,pc,this.Jod()))}),this.queryStoreDisabled(Aa,(pc,Hc)=>{if(pc===OSF.StoreTypeEnum.MarketPlace&&Hc)this.wrd(0);else if(pc===OSF.StoreTypeEnum.PrivateCatalog&&Hc)this.wrd(1);else{var td=window.performance.now();this.Xf.getEntitlementDetails(Object.assign(new ia.a,{storeType:pc,
refresh:cc}),me=>{Eb(this.G4.ma(pc),td,me)})}}))}HC(Aa,Eb){Aa=new Ea(Aa,0,Eb);this.$a.raiseEvent(ea.a.N1a,Aa)}xBa(Aa,Eb){Aa=Object.assign(new V(Eb.wI),{solutionIds:new K.a});var cc=Eb.XK;for(const pc of cc)cc=pc.solutionId,this.Xp.Pb(cc)?this.Xp.ia(cc,this.ZIb(this.Xp.ma(cc),Eb.wI,pc)):this.Xp.add(cc,pc),Aa.solutionIds.add(cc);this.fk.ia(Eb.wI,Aa)}y7(Aa){return this.fk.Pb(Aa)?!!this.Xp:!1}get ktb(){return this.ks?!this.ks.AreThirdPartyAddInsAllowed||this.ks.AppsForOfficeThirdPartyIsDisabled:!this.Ra.ra("AreThirdPartyAddInsAllowed")||
this.Ra.ra("AppsForOfficeThirdPartyIsDisabled")}get EFb(){return this.ks?!this.ks.AppsForOfficeAllowExternalMarketplace:!this.Ra.ra("AppsForOfficeAllowExternalMarketplace")}get iCa(){return this.ks?this.ks.PopularAddinDetailsJsonString:this.Ra.Va("PopularAddinDetailsJsonString")}queryStoreDisabled(Aa,Eb){if(this.ktb)Eb(Aa,!0);else if(Aa===OSF.StoreTypeEnum.MarketPlace&&this.EFb)Eb(Aa,!0);else{const cc=xa.YTb(Aa);if(cc){const pc=window.performance.now();this.Xf.queryStoreDisabled(cc,Hc=>{e.ULS.sendTraceTag(509679070,
220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",Aa,Hc,pc,window.performance.now()-pc);Eb(Aa,Hc)})}else Eb(Aa,!1)}}ZIb(Aa,Eb,cc){if(!Aa)return cc;if(!cc)return Aa;if(this.Exa)return 2===Eb?xa.cBa(cc,Aa):xa.cBa(Aa,cc);if(2===Eb)return Aa.addinInfo=cc.addinInfo,Aa;cc.addinInfo=Aa.addinInfo;return cc}Jod(){if(!this.VQ){const Aa=JSON.parse(this.iCa);this.xzb(Aa);this.VQ=Aa}return xa.gKa(0,this.VQ)}xzb(Aa){this.Exa&&xa.$sb(Aa);this.m2a(Aa);this.yzb(Aa)}m2a(Aa){const Eb=
this.pub();for(var cc=0;cc<Aa.length&&0<Eb.count;cc++){const pc=Aa[cc];if(Eb.Pb(pc.solutionId)){let Hc=String.format("Found an override, solutionId: {0}",pc.solutionId);const td=Eb.ma(pc.solutionId);td&&(isNaN(td.addinInfo.priority)||(Hc=String.format("{0}; AddinInfo.Priority: update {1} to {2}",Hc,pc.addinInfo.priority,td.addinInfo.priority),pc.addinInfo.priority=td.addinInfo.priority),isNaN(td.addinInfo.AUP)||(Hc=String.format("{0}; AddinInfo.AUP: update {1} to {2}",Hc,pc.addinInfo.AUP,td.addinInfo.AUP),
pc.addinInfo.AUP=td.addinInfo.AUP),isNaN(td.addinInfo.downloadNumber)||(Hc=String.format("{0}; AddinInfo.DownloadNumber: update {1} to {2}",Hc,pc.addinInfo.downloadNumber,td.addinInfo.downloadNumber),pc.addinInfo.downloadNumber=td.addinInfo.downloadNumber),td.displayName&&(Hc=String.format("{0}; DisplayName: update {1} to {2}",Hc,pc.displayName,td.displayName),pc.displayName=td.displayName),td.iconUrl&&(Hc=String.format("{0}; IconUrl: update {1} to {2}",Hc,pc.iconUrl,td.iconUrl),pc.iconUrl=td.iconUrl),
td.description&&(Hc=String.format("{0}; Description: update {1} to {2}",Hc,pc.description,td.description),pc.description=td.description));Eb.remove(pc.solutionId);this.$Eb&&e.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",Hc)}}for(let pc of Eb.keys)cc=Eb.ma(pc),cc.displayName&&cc.iconUrl&&cc.addinInfo&&(Aa.push(cc),this.$Eb&&e.ULS.sendTraceTag(509379107,220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",JSON.stringify(cc)))}pub(){const Aa=
new S.a(J.a.hh());let Eb=this.Ra.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!Eb)return Aa;Eb=Eb.trim();if(12>=Eb.length)return 0<Eb.length&&e.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",Eb),Aa;this.$Eb&&e.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",Eb);try{const cc=[],pc=Eb.split("|");for(let Hc=pc.length-1;0<=Hc;Hc--){const td=pc[Hc],me=td.split("\\");if(2>
me.length){cc.push(td);continue}const ve=xa.kMb(me);ve?Aa.Pb(ve.solutionId)||Aa.add(ve.solutionId,ve):cc.push(td)}this.$Eb&&0<cc.length&&e.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",cc.join("|"));this.$Eb&&0<Aa.count&&e.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",Aa.count,JSON.stringify(la.toArray(Aa.values)));return Aa}catch(cc){e.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",
Eb,cc.toString())}return Aa}yzb(Aa){for(let Eb=0;Eb<Aa.length;Eb++)ya.c(Aa[Eb].iconUrl.toLowerCase(),"http",0)||(Aa[Eb].iconUrl=String.format("{0}/image/apps.{1}",this.Inb,Aa[Eb].iconUrl))}static kIb(Aa,Eb,cc){const pc={};pc.AddinCollectionType=Z.a[Aa];pc.ErrorCode=Eb.errorCode;pc.AddinCount=Eb.value?Eb.value.length:0;e.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; fields: {1}",cc,JSON.stringify(pc))}static gKa(Aa,Eb){const cc={};cc.errorCode=
Aa;cc.value=Eb;return cc}static YTb(Aa){return Aa===OSF.StoreTypeEnum.MarketPlace?"omex":Aa===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static cBa(Aa,Eb){Eb.solutionId=Eb.solutionId||Aa.solutionId;Eb.version=Eb.version||Aa.version;Eb.storeType=Eb.storeType||Aa.storeType;Eb.storeId=Eb.storeId||Aa.storeId;Eb.assetId=Eb.assetId||Aa.assetId;Eb.assetStoreId=Eb.assetStoreId||Aa.assetStoreId;Eb.displayName=Eb.displayName||Aa.displayName;Eb.provider=Eb.provider||Aa.provider;Eb.description=Eb.description||
Aa.description;Eb.iconUrl=Eb.iconUrl||Aa.iconUrl;Eb.webApplicationId=Eb.webApplicationId||Aa.webApplicationId;Eb.highResolutionIconUrl=Eb.highResolutionIconUrl||Aa.highResolutionIconUrl;Eb.licenseUrl=Eb.licenseUrl||Aa.licenseUrl;Eb.privacyUrl=Eb.privacyUrl||Aa.privacyUrl;Eb.addinInfo=Eb.addinInfo||Aa.addinInfo;isNaN(Eb.targetType)&&(Eb.targetType=Aa.targetType);isNaN(Eb.height)&&(Eb.height=Aa.height);isNaN(Eb.width)&&(Eb.width=Aa.width);return Eb}static $sb(Aa){for(const Eb of Aa)isNaN(Eb.targetType)&&
(Eb.targetType=1),Eb.assetId=Eb.assetId||Eb.solutionId,Eb.storeId=Eb.storeId||"en-US",Eb.storeType=Eb.storeType||"omex",Eb.assetStoreId=Eb.assetStoreId||"omex",isNaN(Eb.width)&&(Eb.width=0),isNaN(Eb.height)&&(Eb.height=0)}static kMb(Aa){const Eb={};let cc=0;cc<Aa.length&&0<Aa[cc].trim().length&&Aa[cc].trim().toLowerCase().startsWith("wa")&&(Eb.solutionId=Aa[cc].trim(),Eb.addinInfo=Object.assign(new P,{priority:Number.NaN,AUP:Number.NaN,downloadNumber:Number.NaN}),++cc<Aa.length&&0<Aa[cc].trim().length&&
(Eb.addinInfo.priority=parseInt(Aa[cc].trim())),++cc<Aa.length&&0<Aa[cc].trim().length&&(Eb.addinInfo.AUP=parseInt(Aa[cc].trim())),++cc<Aa.length&&0<Aa[cc].trim().length&&(Eb.addinInfo.downloadNumber=parseInt(Aa[cc].trim())),++cc<Aa.length&&0<Aa[cc].trim().length&&(Eb.displayName=Aa[cc].trim()),++cc<Aa.length&&0<Aa[cc].trim().length&&(Eb.iconUrl=Aa[cc].trim()),++cc<Aa.length&&0<Aa[cc].trim().length&&(Eb.description=Aa[cc].trim()));return Eb.solutionId?Eb:null}static jBb(Aa,Eb){Aa=Aa.Va("AddinImageStoreServiceUrl");
if(!Aa)return Eb;Aa=Aa.toLowerCase();return Aa.startsWith("http://")||Aa.startsWith("https://")?Aa:Eb}}Object(c.a)(xa,"AddinDetailsManager",null,[823,824]);class wa{constructor(Aa,Eb=0){this.failure=null;this.rca=Aa;this.errorCode=Eb}}Object(c.a)(wa,"AddinQueryResult",null,[]);class hb extends wa{constructor(Aa,Eb=0){super(Aa,Eb);this.solutionIds=null}}Object(c.a)(hb,"AddinCollection",wa,[]);var Ja=a(910);class Fa{constructor(Aa,Eb,cc=null){this.$a=new h.a;this.Xp=new S.a(J.a.hh());this.fk=new R.a;
this.VQ=null;this.G4=new za.a;this.G4.add(OSF.StoreTypeEnum.MarketPlace,0);this.G4.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.Ra=Aa;this.Kk=Eb;this.ks=cc;this.Inb=Fa.jBb(Aa,"https://store-images.s-microsoft.com");this.Wua(Object(d.a)(this,this.xBa,"onAddinDetailsRefreshed"))}get isAnonymousUser(){return!!this.Ra&&this.Ra.ra("IsAnonymousUser")}get Mjd(){return!!this.Ra&&this.Ra.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNoMailboxFixEnabled",!0)}get Kzb(){return!!this.Ra&&this.Ra.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNotSignedInFixEnabled",
!0)}get Exa(){return!!this.Ra&&this.Ra.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",!1)}get R6(){return this.Ra.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",!1)}get Xf(){return this.Kk.value}oAb(Aa){if(!this.y7(Aa))return Aa=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:Z.a[Aa]}),Object.assign(new oa(1),{failure:Aa});if(this.fk.ma(Aa).failure)return Object.assign(new oa(this.fk.ma(Aa).errorCode),
{failure:this.fk.ma(Aa).failure});e.ULS.shipAssertTag(509870082,220,!!this.fk.ma(Aa).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",Aa);const Eb=new oa(0);for(let cc of this.fk.ma(Aa).solutionIds)this.Xp.Pb(cc)&&Array.add(Eb.XK,this.Xp.ma(cc));return Eb}nAb(Aa){return this.Xp.Pb(Aa)?this.Xp.ma(Aa):null}Ifb(Aa){if(Aa){this.Wua(Aa);for(let Eb of this.fk.keys){if(!this.y7(Eb)||this.fk.ma(Eb).failure)continue;e.ULS.shipAssertTag(509870081,220,!!this.fk.ma(Eb).solutionIds,
"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",Eb);const cc=[],pc=this.fk.ma(Eb);for(let Hc of pc.solutionIds)Array.add(cc,this.Xp.ma(Hc));Aa(null,new Ea(Eb,pc.errorCode,cc,pc.failure))}}}mH(Aa,Eb=!1){0!==Aa&&10!==Aa?e.ULS.sendTraceTag(509870080,220,50,"QueryAddinDetails: skipping providerType: {0}.",aa.a[Aa]):this.lNb(Aa,Object(d.a)(this,this.nLb,"onQueryAddinDetailsCompleted"),Eb)}Wua(Aa){this.$a.addHandler(ea.a.N1a,Aa)}nLb(Aa,Eb,cc){if(cc)if(Fa.kIb(Aa,cc,
window.performance.now()-Eb),0===cc.errorCode){let pc;if(cc.value){let Hc=0;pc=Array(cc.value.length);cc.value.forEach(td=>{pc[Hc++]=td})}else pc=[];this.HC(new wa(Aa),pc)}else-1===cc.errorCode||10===cc.errorCode?this.HC(new wa(Aa),[]):(Aa=this.E6c(Aa,Eb,cc),this.HC(Aa));else Aa=Fa.F6c(Aa,Eb),this.HC(Aa)}E6c(Aa,Eb,cc){const pc={};pc.collectionType=Z.a[Aa];pc.invokeResultCode=cc.errorCode;pc["queryResult.Value"]=cc.value?String.format("Length: {0}",cc.value.length):"null";pc.queryStart=Eb;pc.queryDuration=
window.performance.now()-Eb;return Object.assign(new wa(Aa,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",pc)})}WRb(){return this.y7(2)?this.Ra.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins")?!!this.fk.ma(2).failure:!1:!0}lNb(Aa,Eb,cc=!1){e.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",Aa);Aa!==OSF.StoreTypeEnum.MarketPlace&&Aa!==OSF.StoreTypeEnum.PrivateCatalog?e.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",
Aa):(this.WRb()&&this.queryStoreDisabled(0,(pc,Hc)=>{Hc?(pc=Fa.iKa(2),this.HC(pc)):(pc=window.performance.now(),Eb(2,pc,this.Jod()))}),this.Kzb&&this.isAnonymousUser?(Aa=Fa.s6c(Aa===OSF.StoreTypeEnum.MarketPlace?0:1),this.HC(Aa)):this.queryStoreDisabled(Aa,(pc,Hc)=>{if(pc===OSF.StoreTypeEnum.MarketPlace&&Hc)Hc=Fa.iKa(0),this.HC(Hc);else if(pc===OSF.StoreTypeEnum.PrivateCatalog&&Hc)Hc=Fa.iKa(1),this.HC(Hc);else{var td=window.performance.now();this.Xf.getEntitlementDetails(Object.assign(new ia.a,{storeType:pc,
refresh:cc}),me=>{Eb(this.G4.ma(pc),td,me)})}}))}HC(Aa,Eb=null){0!==Aa.errorCode?(e.ULS.shipAssertTag(509116673,220,!Eb,"The parameter addinDetails must be null for any failed queries"),e.ULS.shipAssertTag(509116672,220,!!Aa.failure,"The result.Failure must not be available for any failed queries"),e.ULS.sendTraceTag(510253056,220,this.dqd(Aa),"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; errorCode: {1}; failure: {2}; errorInfo: {3}",Z.a[Aa.rca],Ja.a[Aa.errorCode],Aa.failure?Aa.failure.toString():
"null",JSON.stringify(Aa.failure))):(e.ULS.shipAssertTag(509116643,220,!!Eb,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}' - The parameter addinDetails is invalid.",Z.a[Aa.rca]),e.ULS.sendTraceTag(509116642,220,15,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; contains {1} addinDetails",Z.a[Aa.rca],Eb?Eb.length:-1));Aa=new Ea(Aa.rca,Aa.errorCode,Eb,Aa.failure);this.$a.raiseEvent(ea.a.N1a,Aa)}dqd(Aa){return 3===Aa.errorCode&&(this.Kzb&&-2147208619===Fa.mBb(Aa)||this.Mjd&&-2===
Fa.mBb(Aa))?15:2===Aa.errorCode?15:10}xBa(Aa,Eb){if(0!==Eb.errorCode)this.fk.ia(Eb.wI,Object.assign(new hb(Eb.wI,Eb.errorCode),{failure:Eb.failure}));else{Aa=Object.assign(new hb(Eb.wI),{solutionIds:new K.a});var cc=Eb.XK;for(const pc of cc)cc=pc.solutionId,this.Xp.Pb(cc)?this.Xp.ia(cc,this.ZIb(this.Xp.ma(cc),Eb.wI,pc)):this.Xp.add(cc,pc),Aa.solutionIds.add(cc);this.fk.ia(Eb.wI,Aa)}}y7(Aa){return this.fk.Pb(Aa)?!!this.Xp:!1}get ktb(){return this.ks?!this.ks.AreThirdPartyAddInsAllowed||this.ks.AppsForOfficeThirdPartyIsDisabled:
!this.Ra.ra("AreThirdPartyAddInsAllowed")||this.Ra.ra("AppsForOfficeThirdPartyIsDisabled")}get EFb(){return this.ks?!this.ks.AppsForOfficeAllowExternalMarketplace:!this.Ra.ra("AppsForOfficeAllowExternalMarketplace")}get iCa(){return this.ks?this.ks.PopularAddinDetailsJsonString:this.Ra.Va("PopularAddinDetailsJsonString")}queryStoreDisabled(Aa,Eb){if(this.ktb)Eb(Aa,!0);else if(Aa===OSF.StoreTypeEnum.MarketPlace&&this.EFb)Eb(Aa,!0);else{const cc=Fa.YTb(Aa);if(cc){const pc=window.performance.now();this.Xf.queryStoreDisabled(cc,
Hc=>{e.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",Aa,Hc,pc,window.performance.now()-pc);Eb(Aa,Hc)})}else Eb(Aa,!1)}}ZIb(Aa,Eb,cc){if(!Aa)return cc;if(!cc)return Aa;if(this.Exa)return 2===Eb?Fa.cBa(cc,Aa):Fa.cBa(Aa,cc);if(2===Eb)return Aa.addinInfo=cc.addinInfo,Aa;cc.addinInfo=Aa.addinInfo;return cc}Jod(){if(!this.VQ){const Aa=JSON.parse(this.iCa);this.xzb(Aa);this.VQ=Aa}return Fa.gKa(0,this.VQ)}xzb(Aa){this.Exa&&Fa.$sb(Aa);
this.m2a(Aa);this.yzb(Aa)}m2a(Aa){const Eb=this.pub();for(var cc=0;cc<Aa.length&&0<Eb.count;cc++){const pc=Aa[cc];if(Eb.Pb(pc.solutionId)){let Hc=String.format("Found an override, solutionId: {0}",pc.solutionId);const td=Eb.ma(pc.solutionId);td&&(isNaN(td.addinInfo.priority)||(Hc=String.format("{0}; AddinInfo.Priority: update {1} to {2}",Hc,pc.addinInfo.priority,td.addinInfo.priority),pc.addinInfo.priority=td.addinInfo.priority),isNaN(td.addinInfo.AUP)||(Hc=String.format("{0}; AddinInfo.AUP: update {1} to {2}",
Hc,pc.addinInfo.AUP,td.addinInfo.AUP),pc.addinInfo.AUP=td.addinInfo.AUP),isNaN(td.addinInfo.downloadNumber)||(Hc=String.format("{0}; AddinInfo.DownloadNumber: update {1} to {2}",Hc,pc.addinInfo.downloadNumber,td.addinInfo.downloadNumber),pc.addinInfo.downloadNumber=td.addinInfo.downloadNumber),td.displayName&&(Hc=String.format("{0}; DisplayName: update {1} to {2}",Hc,pc.displayName,td.displayName),pc.displayName=td.displayName),td.iconUrl&&(Hc=String.format("{0}; IconUrl: update {1} to {2}",Hc,pc.iconUrl,
td.iconUrl),pc.iconUrl=td.iconUrl),td.description&&(Hc=String.format("{0}; Description: update {1} to {2}",Hc,pc.description,td.description),pc.description=td.description));Eb.remove(pc.solutionId);this.R6&&e.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",Hc)}}for(let pc of Eb.keys)cc=Eb.ma(pc),cc.displayName&&cc.iconUrl&&cc.addinInfo&&(Aa.push(cc),this.R6&&e.ULS.sendTraceTag(509379107,220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",
JSON.stringify(cc)))}pub(){const Aa=new S.a(J.a.hh());let Eb=this.Ra.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!Eb)return Aa;Eb=Eb.trim();if(12>=Eb.length)return 0<Eb.length&&e.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",Eb),Aa;this.R6&&e.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",Eb);try{const cc=[],pc=Eb.split("|");for(let Hc=pc.length-1;0<=Hc;Hc--){const td=
pc[Hc],me=td.split("\\");if(2>me.length){cc.push(td);continue}const ve=Fa.kMb(me);ve?Aa.Pb(ve.solutionId)||Aa.add(ve.solutionId,ve):cc.push(td)}this.R6&&0<cc.length&&e.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",cc.join("|"));this.R6&&0<Aa.count&&e.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",Aa.count,JSON.stringify(la.toArray(Aa.values)));return Aa}catch(cc){e.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",
Eb,cc.toString())}return Aa}yzb(Aa){for(let Eb=0;Eb<Aa.length;Eb++)ya.c(Aa[Eb].iconUrl.toLowerCase(),"http",0)||(Aa[Eb].iconUrl=String.format("{0}/image/apps.{1}",this.Inb,Aa[Eb].iconUrl))}static F6c(Aa,Eb){const cc={};cc.collectionType=Z.a[Aa];cc.queryResult="null";cc.queryStart=Eb;cc.queryDuration=window.performance.now()-Eb;return Object.assign(new wa(Aa,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",cc)})}static iKa(Aa){const Eb={};Eb.collectionType=Z.a[Aa];return Object.assign(new wa(Aa,
2),{failure:Error.create("The store is disabled.",Eb)})}static s6c(Aa){const Eb={};Eb.collectionType=Z.a[Aa];Eb.invokeResultCode=-2147208619;Eb.queryDuration=0;return Object.assign(new wa(Aa,3),{failure:Error.create("Anonymous users do not have installed add-ins.",Eb)})}static mBb(Aa){return Aa.failure?Aa.failure.invokeResultCode:-1E3}static kIb(Aa,Eb,cc){const pc={};pc.AddinCollectionType=Z.a[Aa];pc.ErrorCode=Eb.errorCode;pc.AddinCount=Eb.value?Eb.value.length:0;e.ULS.sendTraceTag(512231322,220,
50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; fields: {1}",cc,JSON.stringify(pc))}static gKa(Aa,Eb){const cc={};cc.errorCode=Aa;cc.value=Eb;return cc}static YTb(Aa){return Aa===OSF.StoreTypeEnum.MarketPlace?"omex":Aa===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static cBa(Aa,Eb){Eb.solutionId=Eb.solutionId||Aa.solutionId;Eb.version=Eb.version||Aa.version;Eb.storeType=Eb.storeType||Aa.storeType;Eb.storeId=Eb.storeId||Aa.storeId;Eb.assetId=Eb.assetId||Aa.assetId;Eb.assetStoreId=
Eb.assetStoreId||Aa.assetStoreId;Eb.displayName=Eb.displayName||Aa.displayName;Eb.provider=Eb.provider||Aa.provider;Eb.description=Eb.description||Aa.description;Eb.iconUrl=Eb.iconUrl||Aa.iconUrl;Eb.webApplicationId=Eb.webApplicationId||Aa.webApplicationId;Eb.highResolutionIconUrl=Eb.highResolutionIconUrl||Aa.highResolutionIconUrl;Eb.licenseUrl=Eb.licenseUrl||Aa.licenseUrl;Eb.privacyUrl=Eb.privacyUrl||Aa.privacyUrl;Eb.addinInfo=Eb.addinInfo||Aa.addinInfo;isNaN(Eb.targetType)&&(Eb.targetType=Aa.targetType);
isNaN(Eb.height)&&(Eb.height=Aa.height);isNaN(Eb.width)&&(Eb.width=Aa.width);return Eb}static $sb(Aa){for(const Eb of Aa)isNaN(Eb.targetType)&&(Eb.targetType=1),Eb.assetId=Eb.assetId||Eb.solutionId,Eb.storeId=Eb.storeId||"en-US",Eb.storeType=Eb.storeType||"omex",Eb.assetStoreId=Eb.assetStoreId||"omex",isNaN(Eb.width)&&(Eb.width=0),isNaN(Eb.height)&&(Eb.height=0)}static kMb(Aa){const Eb={};let cc=0;cc<Aa.length&&0<Aa[cc].trim().length&&Aa[cc].trim().toLowerCase().startsWith("wa")&&(Eb.solutionId=Aa[cc].trim(),
Eb.addinInfo=Object.assign(new P,{priority:Number.NaN,AUP:Number.NaN,downloadNumber:Number.NaN}),++cc<Aa.length&&0<Aa[cc].trim().length&&(Eb.addinInfo.priority=parseInt(Aa[cc].trim())),++cc<Aa.length&&0<Aa[cc].trim().length&&(Eb.addinInfo.AUP=parseInt(Aa[cc].trim())),++cc<Aa.length&&0<Aa[cc].trim().length&&(Eb.addinInfo.downloadNumber=parseInt(Aa[cc].trim())),++cc<Aa.length&&0<Aa[cc].trim().length&&(Eb.displayName=Aa[cc].trim()),++cc<Aa.length&&0<Aa[cc].trim().length&&(Eb.iconUrl=Aa[cc].trim()),++cc<
Aa.length&&0<Aa[cc].trim().length&&(Eb.description=Aa[cc].trim()));return Eb.solutionId?Eb:null}static jBb(Aa,Eb){Aa=Aa.Va("AddinImageStoreServiceUrl");if(!Aa)return Eb;Aa=Aa.toLowerCase();return Aa.startsWith("http://")||Aa.startsWith("https://")?Aa:Eb}}Object(c.a)(Fa,"AddinDetailsManager1",null,[823,824]);class Ba{constructor(Aa,Eb=null){this.description=this.provider=this.displayName=this.assetStoreId=this.assetId=this.storeId=this.storeType=this.version=this.solutionId=this.addinInfo=null;this.width=
this.height=this.targetType=0;this.privacyUrl=this.licenseUrl=this.highResolutionIconUrl=this.webApplicationId=this.iconUrl=null;this.solutionId=Aa.solutionId;this.version=Aa.version;this.storeType=Aa.storeType;this.storeId=Aa.storeId;this.assetId=Aa.assetId;this.assetStoreId=Aa.assetStoreId;this.displayName=Aa.displayName;this.provider=Aa.provider;this.description=Aa.description;this.targetType=Aa.targetType;this.height=Aa.height;this.width=Aa.width;this.iconUrl=Aa.iconUrl;this.webApplicationId=
Aa.webApplicationId;this.highResolutionIconUrl=Aa.highResolutionIconUrl;this.licenseUrl=Aa.licenseUrl;this.privacyUrl=Aa.privacyUrl;this.addinInfo=Eb}WTb(){const Aa={};Aa.solutionId=this.solutionId;Aa.version=this.version;Aa.storeType=this.storeType;Aa.storeId=this.storeId;Aa.assetId=this.assetId;Aa.assetStoreId=this.assetStoreId;Aa.targetType=this.targetType;Aa.displayName=this.displayName;Aa.width=this.width;Aa.height=this.height;return Aa}}Object(c.a)(Ba,"AddinDetail",null,[]);class fa{constructor(Aa,
Eb,cc,pc,Hc){this.$1b=null;this.Ra=Aa;this.Kk=Eb;this.SHa=cc;this.IMg=pc;this.imb=Hc}mH(Aa,Eb){this.Xf.queryAppDetails(this.IMg,this.imb,this.solutionIds,Aa,(cc,pc)=>{const Hc=Array(pc.length);for(let td=0;td<pc.length;td++)Hc[td]=new Ba(pc[td],this.PSi(pc[td].solutionId));Eb(cc,Hc)})}get YCi(){return!!this.Xf.queryAppDetails}PSi(Aa){return this.SHa.ma(Aa)}get solutionIds(){if(!this.$1b){this.$1b=new K.a;for(let Aa of this.SHa.keys)this.$1b.add(ya.d(Aa))}return this.$1b.toArray()}get Xf(){return this.Kk.value}}
Object(c.a)(fa,"AddinDetailsLoader",null,[]);class ta{constructor(Aa,Eb=0){this.failure=null;this.rca=Aa;this.errorCode=Eb}}Object(c.a)(ta,"AddinQueryResult",null,[]);class Oa extends ta{constructor(Aa,Eb=0){super(Aa,Eb);this.H2d=this.solutionIds=null}}Object(c.a)(Oa,"AddinCollection",ta,[]);var Ma=a(723);class fb extends Ma.a{constructor(){super(J.a.hh())}}Object(c.a)(fb,"AddinDetailTable",Ma.a,[]);class pa{constructor(Aa,Eb,cc=null){this.$a=new h.a;this.Xp=new S.a(J.a.hh());this.fk=new R.a;this.SHa=
this.VQ=null;this.G4=new za.a;this.G4.add(OSF.StoreTypeEnum.MarketPlace,0);this.G4.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.Ra=Aa;this.Kk=Eb;this.ks=cc;this.Inb=pa.jBb(Aa,"https://store-images.s-microsoft.com");this.lXc=null;this.Wua(Object(d.a)(this,this.xBa,"onAddinDetailsRefreshed"))}get isAnonymousUser(){return!!this.Ra&&this.Ra.ra("IsAnonymousUser")}get Mjd(){return!!this.Ra&&this.Ra.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNoMailboxFixEnabled",!0)}get Kzb(){return!!this.Ra&&
this.Ra.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNotSignedInFixEnabled",!0)}get Exa(){return!!this.Ra&&this.Ra.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",!1)}get R6(){return this.Ra.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",!1)}get Xf(){return this.Kk.value}get eNd(){this.lXc||(this.lXc=new fa(this.Ra,this.Kk,this.zjj,0,this.Xf.getAppUILocale()));return this.lXc}oAb(Aa){if(!this.y7(Aa))return Aa=Error.create("AddinDetails is not ready yet",
{["errorCode"]:1,["collectionType"]:Z.a[Aa]}),Object.assign(new oa(1),{failure:Aa});const Eb=this.fk.ma(Aa);if(Eb.failure)return Object.assign(new oa(Eb.errorCode),{failure:Eb.failure});e.ULS.shipAssertTag(509870082,220,!!Eb.solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",Aa);const cc=new oa(0);for(let pc=0;pc<Eb.solutionIds.count;pc++){const Hc=Eb.solutionIds.ma(pc),td=Eb.H2d.ma(pc);if(this.Xp.Pb(Hc)){const me=this.Xp.ma(Hc);me.Pb(td)?Array.add(cc.XK,
me.ma(td)):e.ULS.sendTraceTag(0,220,15,"The addin with solutionId '{0}' in '{1}' must contain storeId '{2}' when the collection is ready.",Hc,Aa,td)}else e.ULS.sendTraceTag(0,220,15,"The addin with solutionId '{0}' in '{1}' must exist when the collection is ready.",Hc,Aa)}return cc}nAb(Aa,Eb=null){if(Aa=this.s_h(Aa))if(Eb||(Eb=this.uiCulture),Aa.Pb(Eb))return Aa.ma(Eb);return null}s_h(Aa){return this.Xp.Pb(Aa)?this.Xp.ma(Aa):null}Ifb(Aa){if(Aa){this.Wua(Aa);for(let Eb of this.fk.keys){if(!this.y7(Eb)||
this.fk.ma(Eb).failure)continue;e.ULS.shipAssertTag(509870081,220,!!this.fk.ma(Eb).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",Eb);const cc=[],pc=this.fk.ma(Eb);for(let Hc of pc.solutionIds)Array.add(cc,this.Xp.ma(Hc));Aa(null,new Ea(Eb,pc.errorCode,cc,pc.failure))}}}mH(Aa,Eb=!1){0!==Aa&&10!==Aa?e.ULS.sendTraceTag(509870080,220,50,"QueryAddinDetails: skipping providerType: {0}.",aa.a[Aa]):this.lNb(Aa,Object(d.a)(this,this.nLb,"onQueryAddinDetailsCompleted"),
Eb)}Wua(Aa){this.$a.addHandler(ea.a.N1a,Aa)}nLb(Aa,Eb,cc){cc?(pa.kIb(Aa,cc,window.performance.now()-Eb),0===cc.errorCode?(Eb=cc.value?pa.c1g(cc.value):[],this.HC(new ta(Aa),Eb)):-1===cc.errorCode||10===cc.errorCode?this.HC(new ta(Aa),[]):(Aa=this.E6c(Aa,Eb,cc),this.HC(Aa))):(Aa=pa.F6c(Aa,Eb),this.HC(Aa))}E6c(Aa,Eb,cc){const pc={};pc.collectionType=Z.a[Aa];pc.invokeResultCode=cc.errorCode;pc["queryResult.Value"]=cc.value?String.format("Length: {0}",cc.value.length):"null";pc.queryStart=Eb;pc.queryDuration=
window.performance.now()-Eb;return Object.assign(new ta(Aa,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",pc)})}WRb(){return this.y7(2)?this.Ra.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins")?!!this.fk.ma(2).failure:!1:!0}lNb(Aa,Eb,cc=!1){e.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",Aa);Aa!==OSF.StoreTypeEnum.MarketPlace&&Aa!==OSF.StoreTypeEnum.PrivateCatalog?e.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",
Aa):(this.WRb()&&this.queryStoreDisabled(0,(pc,Hc)=>{Hc?(pc=pa.iKa(2),this.HC(pc)):this.Flj(Eb)}),this.Kzb&&this.isAnonymousUser?(Aa=pa.s6c(Aa===OSF.StoreTypeEnum.MarketPlace?0:1),this.HC(Aa)):this.queryStoreDisabled(Aa,(pc,Hc)=>{if(pc===OSF.StoreTypeEnum.MarketPlace&&Hc)Hc=pa.iKa(0),this.HC(Hc);else if(pc===OSF.StoreTypeEnum.PrivateCatalog&&Hc)Hc=pa.iKa(1),this.HC(Hc);else{var td=window.performance.now();this.Xf.getEntitlementDetails(Object.assign(new ia.a,{storeType:pc,refresh:cc}),me=>{Eb(this.G4.ma(pc),
td,me)})}}))}HC(Aa,Eb=null){0!==Aa.errorCode?(e.ULS.shipAssertTag(509116673,220,!Eb,"The parameter addinDetails must be null for any failed queries"),e.ULS.shipAssertTag(509116672,220,!!Aa.failure,"The result.Failure must not be available for any failed queries"),e.ULS.sendTraceTag(510253056,220,this.dqd(Aa),"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; errorCode: {1}; failure: {2}; errorInfo: {3}",Z.a[Aa.rca],Ja.a[Aa.errorCode],Aa.failure?Aa.failure.toString():"null",JSON.stringify(Aa.failure))):
(e.ULS.shipAssertTag(509116643,220,!!Eb,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}' - The parameter addinDetails is invalid.",Z.a[Aa.rca]),e.ULS.sendTraceTag(509116642,220,15,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; contains {1} addinDetails",Z.a[Aa.rca],Eb?Eb.length:-1));Aa=new Ea(Aa.rca,Aa.errorCode,Eb,Aa.failure);this.$a.raiseEvent(ea.a.N1a,Aa)}dqd(Aa){return 3===Aa.errorCode&&(this.Kzb&&-2147208619===pa.mBb(Aa)||this.Mjd&&-2===pa.mBb(Aa))?15:2===Aa.errorCode?
15:10}xBa(Aa,Eb){if(0!==Eb.errorCode)this.fk.ia(Eb.wI,Object.assign(new Oa(Eb.wI,Eb.errorCode),{failure:Eb.failure}));else{Aa=Object.assign(new Oa(Eb.wI),{solutionIds:new K.a,H2d:new K.a});var cc=Eb.XK;for(const Hc of cc){cc=Hc.solutionId;const td=Hc.storeId;if(this.Xp.Pb(cc)){var pc=this.Xp.ma(cc);pc.Pb(td)?pc.ia(td,this.ZIb(pc.ma(td),Eb.wI,Hc)):pc.add(td,Hc)}else pc=new fb,pc.add(td,Hc),this.Xp.add(cc,pc);Aa.solutionIds.add(cc);Aa.H2d.add(td)}this.fk.ia(Eb.wI,Aa)}}y7(Aa){return this.fk.Pb(Aa)?!!this.Xp:
!1}get uiCulture(){return this.ks&&this.ks.UICulture?this.ks.UICulture:w.AFrameworkApplication.uiCulture}get ktb(){return this.ks?!this.ks.AreThirdPartyAddInsAllowed||this.ks.AppsForOfficeThirdPartyIsDisabled:!this.Ra.ra("AreThirdPartyAddInsAllowed")||this.Ra.ra("AppsForOfficeThirdPartyIsDisabled")}get EFb(){return this.ks?!this.ks.AppsForOfficeAllowExternalMarketplace:!this.Ra.ra("AppsForOfficeAllowExternalMarketplace")}get zjj(){if(!this.SHa){this.SHa=new S.a(J.a.hh());const Aa=JSON.parse(this.iCa);
for(const Eb of Aa)this.SHa.add(Eb.solutionId,Eb.addinInfo)}return this.SHa}get iCa(){return this.ks?this.ks.PopularAddinDetailsJsonString:this.Ra.Va("PopularAddinDetailsJsonString")}queryStoreDisabled(Aa,Eb){if(this.ktb)Eb(Aa,!0);else if(Aa===OSF.StoreTypeEnum.MarketPlace&&this.EFb)Eb(Aa,!0);else{const cc=pa.YTb(Aa);if(cc){const pc=window.performance.now();this.Xf.queryStoreDisabled(cc,Hc=>{e.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",
Aa,Hc,pc,window.performance.now()-pc);Eb(Aa,Hc)})}else Eb(Aa,!1)}}ZIb(Aa,Eb,cc){if(!Aa)return cc;if(!cc)return Aa;if(this.Exa)return 2===Eb?pa.cBa(cc,Aa):pa.cBa(Aa,cc);if(2===Eb)return Aa.addinInfo=cc.addinInfo,Aa;cc.addinInfo=Aa.addinInfo;return cc}Flj(Aa){const Eb=window.performance.now();if(this.VQ)Aa(2,Eb,pa.gKa(0,this.VQ));else if(this.eNd&&this.eNd.YCi)this.eNd.mH(!1,(pc,Hc)=>{this.m2a(Hc);this.VQ=Hc;Aa(2,Eb,pa.gKa(pc,this.VQ))});else{var cc=JSON.parse(this.iCa);this.xzb(cc);this.VQ=cc;Aa(2,
Eb,pa.gKa(0,this.VQ))}}xzb(Aa){this.Exa&&pa.$sb(Aa);this.m2a(Aa);this.yzb(Aa)}m2a(Aa){const Eb=this.pub();for(var cc=0;cc<Aa.length&&0<Eb.count;cc++){const pc=Aa[cc];if(Eb.Pb(pc.solutionId)){let Hc=String.format("Found an override, solutionId: {0}",pc.solutionId);const td=Eb.ma(pc.solutionId);td&&(isNaN(td.addinInfo.priority)||(Hc=String.format("{0}; AddinInfo.Priority: update {1} to {2}",Hc,pc.addinInfo.priority,td.addinInfo.priority),pc.addinInfo.priority=td.addinInfo.priority),isNaN(td.addinInfo.AUP)||
(Hc=String.format("{0}; AddinInfo.AUP: update {1} to {2}",Hc,pc.addinInfo.AUP,td.addinInfo.AUP),pc.addinInfo.AUP=td.addinInfo.AUP),isNaN(td.addinInfo.downloadNumber)||(Hc=String.format("{0}; AddinInfo.DownloadNumber: update {1} to {2}",Hc,pc.addinInfo.downloadNumber,td.addinInfo.downloadNumber),pc.addinInfo.downloadNumber=td.addinInfo.downloadNumber),td.displayName&&(Hc=String.format("{0}; DisplayName: update {1} to {2}",Hc,pc.displayName,td.displayName),pc.displayName=td.displayName),td.iconUrl&&
(Hc=String.format("{0}; IconUrl: update {1} to {2}",Hc,pc.iconUrl,td.iconUrl),pc.iconUrl=td.iconUrl),td.description&&(Hc=String.format("{0}; Description: update {1} to {2}",Hc,pc.description,td.description),pc.description=td.description));Eb.remove(pc.solutionId);this.R6&&e.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",Hc)}}for(let pc of Eb.keys)cc=Eb.ma(pc),cc.displayName&&cc.iconUrl&&cc.addinInfo&&(Aa.push(cc),this.R6&&e.ULS.sendTraceTag(509379107,220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",
JSON.stringify(cc)))}pub(){const Aa=new S.a(J.a.hh());let Eb=this.Ra.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!Eb)return Aa;Eb=Eb.trim();if(12>=Eb.length)return 0<Eb.length&&e.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",Eb),Aa;this.R6&&e.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",Eb);try{const cc=[],pc=Eb.split("|");for(let Hc=pc.length-1;0<=Hc;Hc--){const td=
pc[Hc],me=td.split("\\");if(2>me.length){cc.push(td);continue}const ve=pa.kMb(me);ve?Aa.Pb(ve.solutionId)||Aa.add(ve.solutionId,ve):cc.push(td)}this.R6&&0<cc.length&&e.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",cc.join("|"));this.R6&&0<Aa.count&&e.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",Aa.count,JSON.stringify(la.toArray(Aa.values)));return Aa}catch(cc){e.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",
Eb,cc.toString())}return Aa}yzb(Aa){for(let Eb=0;Eb<Aa.length;Eb++)ya.c(Aa[Eb].iconUrl.toLowerCase(),"http",0)||(Aa[Eb].iconUrl=String.format("{0}/image/apps.{1}",this.Inb,Aa[Eb].iconUrl))}static F6c(Aa,Eb){const cc={};cc.collectionType=Z.a[Aa];cc.queryResult="null";cc.queryStart=Eb;cc.queryDuration=window.performance.now()-Eb;return Object.assign(new ta(Aa,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",cc)})}static iKa(Aa){const Eb={};Eb.collectionType=Z.a[Aa];return Object.assign(new ta(Aa,
2),{failure:Error.create("The store is disabled.",Eb)})}static s6c(Aa){const Eb={};Eb.collectionType=Z.a[Aa];Eb.invokeResultCode=-2147208619;Eb.queryDuration=0;return Object.assign(new ta(Aa,3),{failure:Error.create("Anonymous users do not have installed add-ins.",Eb)})}static mBb(Aa){return Aa.failure?Aa.failure.invokeResultCode:-1E3}static kIb(Aa,Eb,cc){const pc={};pc.AddinCollectionType=Z.a[Aa];pc.ErrorCode=Eb.errorCode;pc.AddinCount=Eb.value?Eb.value.length:0;e.ULS.sendTraceTag(512231322,220,
50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; fields: {1}",cc,JSON.stringify(pc))}static gKa(Aa,Eb){const cc={};cc.errorCode=Aa;cc.value=Eb;return cc}static YTb(Aa){return Aa===OSF.StoreTypeEnum.MarketPlace?"omex":Aa===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static cBa(Aa,Eb){Eb.solutionId=Eb.solutionId||Aa.solutionId;Eb.version=Eb.version||Aa.version;Eb.storeType=Eb.storeType||Aa.storeType;Eb.storeId=Eb.storeId||Aa.storeId;Eb.assetId=Eb.assetId||Aa.assetId;Eb.assetStoreId=
Eb.assetStoreId||Aa.assetStoreId;Eb.displayName=Eb.displayName||Aa.displayName;Eb.provider=Eb.provider||Aa.provider;Eb.description=Eb.description||Aa.description;Eb.iconUrl=Eb.iconUrl||Aa.iconUrl;Eb.webApplicationId=Eb.webApplicationId||Aa.webApplicationId;Eb.highResolutionIconUrl=Eb.highResolutionIconUrl||Aa.highResolutionIconUrl;Eb.licenseUrl=Eb.licenseUrl||Aa.licenseUrl;Eb.privacyUrl=Eb.privacyUrl||Aa.privacyUrl;Eb.addinInfo=Eb.addinInfo||Aa.addinInfo;isNaN(Eb.targetType)&&(Eb.targetType=Aa.targetType);
isNaN(Eb.height)&&(Eb.height=Aa.height);isNaN(Eb.width)&&(Eb.width=Aa.width);return Eb}static c1g(Aa){const Eb=Array(Aa.length);for(let cc=0;cc<Eb.length;cc++)Eb[cc]=new Ba(Aa[cc],Aa[cc].addinInfo);return Eb}static $sb(Aa){for(const Eb of Aa)isNaN(Eb.targetType)&&(Eb.targetType=1),Eb.assetId=Eb.assetId||Eb.solutionId,Eb.storeId=Eb.storeId||"en-US",Eb.storeType=Eb.storeType||"omex",Eb.assetStoreId=Eb.assetStoreId||"omex",isNaN(Eb.width)&&(Eb.width=0),isNaN(Eb.height)&&(Eb.height=0)}static kMb(Aa){const Eb=
{};let cc=0;cc<Aa.length&&0<Aa[cc].trim().length&&Aa[cc].trim().toLowerCase().startsWith("wa")&&(Eb.solutionId=Aa[cc].trim(),Eb.addinInfo=Object.assign(new P,{priority:Number.NaN,AUP:Number.NaN,downloadNumber:Number.NaN}),++cc<Aa.length&&0<Aa[cc].trim().length&&(Eb.addinInfo.priority=parseInt(Aa[cc].trim())),++cc<Aa.length&&0<Aa[cc].trim().length&&(Eb.addinInfo.AUP=parseInt(Aa[cc].trim())),++cc<Aa.length&&0<Aa[cc].trim().length&&(Eb.addinInfo.downloadNumber=parseInt(Aa[cc].trim())),++cc<Aa.length&&
0<Aa[cc].trim().length&&(Eb.displayName=Aa[cc].trim()),++cc<Aa.length&&0<Aa[cc].trim().length&&(Eb.iconUrl=Aa[cc].trim()),++cc<Aa.length&&0<Aa[cc].trim().length&&(Eb.description=Aa[cc].trim()));return Eb.solutionId?Eb:null}static jBb(Aa,Eb){Aa=Aa.Va("AddinImageStoreServiceUrl");if(!Aa)return Eb;Aa=Aa.toLowerCase();return Aa.startsWith("http://")||Aa.startsWith("https://")?Aa:Eb}}Object(c.a)(pa,"AddinDetailsManager2",null,[823,824]);class Ua{static createInstance(Aa,Eb,cc=null){if(Ua.oFi(Aa)){if(Ua.YZg(Aa))return e.ULS.sendTraceTag(508925833,
220,50,"AddinDetailsManagerFactory.CreateInstance: Creating an instance of AddinDetailsManager2."),new pa(Aa,Eb,cc);e.ULS.sendTraceTag(508925832,220,50,"AddinDetailsManagerFactory.CreateInstance: Creating an instance of AddinDetailsManager1.");return new Fa(Aa,Eb,cc)}e.ULS.sendTraceTag(508925831,220,50,"AddinDetailsManagerFactory.CreateInstance: Creating an instance of AddinDetailsManager");return new xa(Aa,Eb,cc)}static oFi(Aa){return(Aa||w.AFrameworkApplication.fa).getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutNotifyObserverFailuresEnabled",
!1)}static YZg(Aa){return(Aa||w.AFrameworkApplication.fa).getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsPopularLoaderEnabled",!1)}}Object(c.a)(Ua,"AddinDetailsManagerFactory",null,[]);var Sa=a(858),Ia=a(1371),X=a(1475),ca=a(988),U=a(187),ma=a(1379),ra=a(131),Va=a(84),ob=a(92),ja=a(662),lb=a(126),wb=a(425),Ab=a(563),nb=a(172),pb=a(42),cb=a(7),Da=a(909),zb=a(1297),qb=a(86);class Pa{constructor(){this.command=0;this.properties=null}}Object(c.a)(Pa,"DdaRequestInfo",null,[]);var Nb=
a(762),Tb=a(75);class Vb extends qb.a{constructor(Aa,Eb){super();this.requests=[];this.disposed=this.m8b=!1;this.Ug=()=>{if(!this.disposed){this.grid.Gc.fn(this.Ug);this.m8b=!1;const cc=this.requests;this.requests=[];for(let pc of cc)this.ddaFacade.RL(pc.command,pc.properties)}};this.ddaFacade=Aa;this.grid=Eb}Lvh(Aa,Eb){this.disposed||(this.m8b||(this.grid.Gc.Pm(this.Ug),this.m8b=!0),this.requests.push(Object(b.a)(new Pa,{command:Aa,properties:Eb})))}dispose(){if(!this.disposed){this.disposed=!0;
this.m8b&&this.grid.Gc.fn(this.Ug);var Aa=this.requests;this.requests=null;for(let Eb of Aa)(Aa=Eb.properties?Eb.properties[Tb.a.k6]:null)&&this.ddaFacade.xg(Nb.a.eEb,Aa);this.ddaFacade=this.grid=null;super.dispose()}}static Xgh(Aa,Eb){var cc=!1;974713501===Aa&&(Eb=(Aa=Eb?Eb[Tb.a.Og]:null)?Aa.DdaMethod:null)&&Eb.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(cc=Aa.ArrayData,cc=!!cc&&64===(cc[6]&64));return cc}}Object(c.a)(Vb,"DdaCellEditDelayRequestHandler",qb.a,[]);var Jb=
a(799);class Qa extends Jb.a{constructor(Aa,Eb,cc,pc,Hc,td,me){super(Aa,Eb,cc);this.messageType=0;this.targetOrigin=this.messageOrigin=this.messageContent=null;this.messageType=pc;this.messageContent=Hc;this.messageOrigin=td;this.targetOrigin=me}}Object(c.a)(Qa,"DialogMessageReceivedEventArgs",Jb.a,[]);class Db extends Jb.a{constructor(Aa,Eb,cc,pc,Hc,td,me){super(Aa,Eb,cc);this.messageType=0;this.targetOrigin=this.messageOrigin=this.messageContent=null;this.messageType=pc;this.messageContent=Hc;this.messageOrigin=
td;this.targetOrigin=me}}Object(c.a)(Db,"DialogParentMessageReceivedEventArgs",Jb.a,[]);var sa=a(1),Ha=a(19);class mb{constructor(Aa){this.Xf=this.t4c=null;this.I9i=(Eb,cc)=>{this.handlers.Pb(cc.controlId)&&(Eb=new Qa(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,cc.controlId,null,cc.messageType,cc.messageContent,cc.messageOrigin,cc.targetOrigin),this.handlers.ma(cc.controlId)(Eb),cc.messageType===OSF.DialogMessageType.DialogClosed&&this.handlers.remove(cc.controlId))};this.H9i=(Eb,cc)=>{this.Ksc.Pb(cc.controlId)&&
(Eb=new Db(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,cc.controlId,null,cc.messageType,cc.messageContent,cc.messageOrigin,cc.targetOrigin),this.Ksc.ma(cc.controlId)(Eb))};this.handlers=new B.a;this.Ksc=new B.a;this.Qh=Aa;this.x5a.yYg(this.I9i);this.x5a.xYg(this.H9i)}get x5a(){this.t4c||(this.t4c=E.getInstance(this.contextActivationMgr));return this.t4c}get contextActivationMgr(){!this.Xf&&this.Qh&&(this.Xf=this.Qh.Xf);return this.Xf}addHandler(Aa,Eb,cc,pc){if(sa.EwaSettings.ya(23))this.Qh.xg(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,
cc);else{e.ULS.sendTraceTag(537170502,0,50,"DialogMessageReceivedEventManager.AddHandler called!");const Hc=td=>{td===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(this.handlers.ia(Aa,Eb),this.Qh.Pw(cc)):(e.ULS.sendTraceTag(537170501,0,10,"DialogMessageReceivedEventManager.AddHandler failed!"),this.Qh.xg(td,cc))};this.handlers.Pb(Aa)?Hc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.showDialog(Aa,pc,Hc)}}WTg(Aa,Eb,cc){sa.EwaSettings.ya(23)?this.Qh.xg(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,
cc):(e.ULS.sendTraceTag(537170500,0,50,"DialogMessageReceivedEventManager.AddMessageChildHandler called!"),this.Ksc.ia(Aa,Eb),this.Qh.Pw(cc))}removeHandler(Aa,Eb){sa.EwaSettings.ya(23)?this.Qh.xg(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Eb):this.handlers.Pb(Aa)?(e.ULS.sendTraceTag(537170499,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.x5a.Bvb(Aa,cc=>{this.handlers.remove(Aa);cc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?this.Qh.Pw(Eb):(e.ULS.sendTraceTag(537170498,
0,10,"DialogMessageReceivedEventManager.RemoveHandler failed!"),this.Qh.xg(cc,Eb))})):this.Qh.xg(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,Eb)}Wwj(Aa,Eb){sa.EwaSettings.ya(23)?this.Qh.xg(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Eb):(e.ULS.sendTraceTag(537170497,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.Ksc.remove(Aa),this.Qh.Pw(Eb))}showDialog(Aa,Eb,cc){try{sa.EwaSettings.isChangeGateEnabled("OfficeVSO:6254758_ExitCellEditModeDialogAPI")&&
Ha.h(this.Qh.$).Ob&&Ha.h(this.Qh.$).Up(!0),this.x5a.showDialog(Eb,Aa,cc,pc=>{this.Qh.mUg(this.F9g(pc))})}catch(pc){e.ULS.sendTraceTag(537170496,0,10,`DialogMessageReceivedEventManager: show dialog failed. Exception message: ${pc.message}`),cc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}F9g(Aa){const Eb={};Eb.InstanceId=Aa.id;Eb.WebExtensionType=Aa.osfControlType===OSF.OsfControlTarget.InContent?0:1;Eb.PrimaryMarketplace={};Eb.PrimaryMarketplace.SolutionId=Aa.solutionId;Eb.PrimaryMarketplace.SolutionVersion=
Aa.version;Eb.PrimaryMarketplace.MarketplaceRef=Aa.storeId;Eb.PrimaryMarketplace.MarketplaceType=Aa.storeType;Eb.OwnerAddinSolutionId=Aa.ownerAddinSolutionId;Eb.OwnerAddinStoreType=Aa.ownerAddinStoreType;return Eb}static la(Aa){if(!Aa.$.da.Ba(232)){const Eb=new mb(Aa);Aa.$.da.Ja(232,Eb)}}}Object(c.a)(mb,"DialogMessageReceivedEventManager",null,[787]);class qa{constructor(Aa,Eb){this.gC=null;this.aia=Aa;this.vPg=Eb}I4b(Aa){Aa&&(this.gC||(this.gC=[]),this.gC.push(Aa))}hAc(Aa){this.gC&&Array.remove(this.gC,
Aa)}get eventId(){return this.aia}get targetId(){return this.vPg}get noi(){return 0<this.gC.length}KUi(Aa){return this.eventId!==Aa.dispid?!1:this.eventId===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||this.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent?this.targetId===Aa.ddaBinding.Name:!0}R7b(Aa){this.gC&&Array.forEach(this.gC,Eb=>{Eb(Aa)})}Mpa(){this.gC=[]}}Object(c.a)(qa,"DdaEventRegistration",null,[]);class Xa{constructor(Aa){this.oG=null;this.fza=!1;this.Od=()=>{this.oG.forEach(Eb=>
{Eb.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&Eb.R7b(new Jb.a(Eb.eventId,"",null))})};this.Qh=Aa}invokeDdaMethod(Aa,Eb){const cc={};cc[Tb.a.Og]=Aa;cc[Tb.a.k6]=Eb;this.Qh.RL(974713501,cc)}registerDdaEventAsync(Aa,Eb,cc,pc,Hc){Xa.TEb(Aa)?(Xa.rwd(Aa)&&this.Isd(),this.oG||(this.oG=[]),Eb=this.kzb(Aa,cc),Eb||(Eb=new qa(Aa,cc),this.oG.push(Eb)),Eb.I4b(pc),this.Qh.Pw(Hc)):this.Qh.xg(-1,Hc)}unregisterDdaEventAsync(Aa,Eb,cc,pc,Hc){Xa.TEb(Aa)?((Aa=this.kzb(Aa,cc))&&Aa.hAc(pc),this.Qh.Pw(Hc)):
this.Qh.xg(-1,Hc)}Isd(){this.fza||(Ha.h(this.Qh.$).ga.WK(this.Od),this.fza=!0)}kzb(Aa,Eb){if(!this.oG)return null;for(let cc=0;cc<this.oG.length;cc++){const pc=this.oG[cc];if(pc.eventId===Aa&&pc.targetId===Eb)return pc}return null}static TEb(Aa){return Aa===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}static rwd(Aa){return Aa===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}}Object(c.a)(Xa,"EmbeddingPage",null,[745]);var Ca=a(190);class va extends Jb.a{constructor(Aa,Eb,cc,pc,
Hc,td,me,ve){super(Aa,Eb,cc);this.columnCount=this.rowCount=this.startColumn=this.startRow=0;this.startColumn=td-pc.Reference.FirstColumn;this.columnCount=ve;Aa=Math.max(Hc,pc.Reference.FirstRow);Hc=Math.min(Hc+me-1,pc.Reference.LastRow);Aa>Hc?this.startRow=this.rowCount=void 0:(this.startRow=Aa-pc.Reference.FirstRow,this.rowCount=Hc-Aa+1)}getStartRow(){return this.startRow}getStartColumn(){return this.startColumn}getRowCount(){return this.rowCount}getColumnCount(){return this.columnCount}}Object(c.a)(va,
"DdaBindingSelectionEventArgs",Jb.a,[]);var na=a(210),Ka=a(25),ib=a(47),Ra=a(52),ka=a(426),da=a(30),kb=a(40),Ob=a(575),lc=a(129),tc=a(54),Pb=a(91),tb=a(13),gc=a(12),Xb=a(109);class Ga{}Ga.mLh="ewa-wx-disabled-div";Ga.lLh="ewa-wx-container-div";Ga.f_e="ewa-ptp-nov2-flex";Object(c.a)(Ga,"CssClassNames",null,[]);var Za=a(72),Sb=a(100),sb=a(149),bc=a(35),kc=a(323),vb=a(201),ub=a(382);const Ub=Ga.mLh,Rd=Ga.lLh;class Cd extends Ca.a{constructor(Aa,Eb,cc,pc=!1){super();this.khb=0;this.oG=null;this.fza=!1;
this.Wxc=null;this.ZV=0;this.Zac=this.eZa=this.Mde=this.mbe=null;this.qTc=this.gje=!1;this.CWc=this.vga=this.n9d=null;this.Od=()=>{this.enabled&&(this.DKj(),this.Wxc=ib.d(Ha.h(this.$).ga.pa.selectedRanges))};this.zhf=Hc=>{Hc.controlId===this.he.InstanceId&&Array.forEach(this.oG,td=>{td.KUi(Hc)&&td.R7b(Hc)})};this.tIf=Hc=>{if((Hc=Object(lb.a)(403,Hc))&&!Hc.Vu())if(!this.he||OSF.OsfControl.isFirstPartyStoreString(this.he.PrimaryMarketplace.MarketplaceType)||this.$.nV){Hc.Zf=this.he;Hc.xk=this.Qh;this.n9d=
Hc;this.VDc(Hc.zJa);const td=sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5947100_createHiddenTaskpanePreload")&&da.a.de()&&gc.HelperMethods.Vx(this.he)&&this.he.Preload&&!this.he.TaskpaneVisible;td?Hc.VJd():sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5550690_FixHiddenStartupStateUnderReactPaneInfra")?(Hc.VJd(),(this.he.SharedRuntime&&1===this.he.SharedRuntime.LifeTime||this.he.SharedRuntimeId)&&!this.he.TaskpaneVisible&&Hc.Oh(!1)):((this.he.SharedRuntime&&1===this.he.SharedRuntime.LifeTime||this.he.SharedRuntimeId)&&
!this.he.TaskpaneVisible&&Hc.Oh(!1),Hc.VJd());this.Q9a||(da.a.de()?td||Hc.m9():ka.a(this.$).result.$J(Hc,!0));this.$.da.Ba(77).v4f(this.tIf);this.Sba=Object(lb.a)(419,Hc)}else e.ULS.sendTraceTag(537170464,0,50,"Taskpane web add-in disabled by doc IRM")};this.onFloatingObjectControlAdded=(Hc,td)=>{3===td.control.floatingObject.type&&td.control.floatingObject.Zl.InstanceId===this.C3.WebExtensionId&&(this.Sba=Object(lb.a)(419,td.control),this.VDc(td.control.ye.firstChild),Xb.a(this.$).aAc(this.onFloatingObjectControlAdded))};
this.Ub=Aa.$;this.Qh=Aa;this.he=cc;this.he.InstanceId=cc.SrcLocationOverrideResourceId?Aa.wNa(cc.InstanceId,cc.SrcLocationOverrideResourceId):cc.InstanceId;this.Rh=Eb;this.C3={};this.C3.WebExtensionId=cc.InstanceId;this.vUf="osfControl_"+cc.InstanceId;this.Rdd="disabled_"+cc.InstanceId;this.C3.BindingData=cc.BindingData;this.Q9a=this.Qh.Q9a(cc.InstanceId);this.kmc=this.Qh.kmc(cc.InstanceId);this.Ine=cc.WebExtensionOsfControlType;this.UXf=pc}get controlId(){return this.he.InstanceId}get RDi(){return this.qTc}tvi(Aa){this.vga||
(this.vga=Aa)}f4f(){this.vga&&(this.vga.dispose(),this.vga=null)}get controlType(){return this.he.WebExtensionType}get ownerAddinSolutionId(){return this.he.OwnerAddinSolutionId}get $(){return this.Ub}get enabled(){return!this.ZV}get visible(){return this.he.TaskpaneVisible}get Nz(){return this.CWc}get AR(){return this.he.SrcLocationOverrideResourceId?this.Qh.wNa(this.he.PrimaryMarketplace.SolutionId,this.he.SrcLocationOverrideResourceId):this.he.PrimaryMarketplace.SolutionId}get sourceLocationOverrideResourceId(){return this.he.SrcLocationOverrideResourceId}get Zl(){return this.he}get Sba(){return this.mbe}set Sba(Aa){this.mbe=
Aa}get osfControlType(){return this.Ine}get Awa(){return this.Mde}set Awa(Aa){this.Mde=Aa}get Yac(){return this.eZa}set Yac(Aa){this.eZa=Aa}get focusOnIframeWhenLoaded(){return this.he.FocusOnIframeWhenLoaded}get koc(){return this.gje}set koc(Aa){this.gje=Aa}bud(){if(!OSF.OsfControl.isFirstPartyStoreString(this.he.PrimaryMarketplace.MarketplaceType)&&sa.EwaSettings.ya(174)){const Eb=Object(Za.b)("OfficeVSO:7811663_ConvertBusinessBarManagerService2")?Object(Sb.d)(sb.a.resolve(bc.h,{Wa:0})):Ra.GetServiceTaskFactory.Za(this.$.da,
5,4,0);kb.TaskExtensions.za(Eb,()=>{Eb.result.oh(36,null)},this.ka,3);return this}if(1===this.he.WebExtensionType)kb.TaskExtensions.za(ka.a(this.$),Eb=>{Eb.result.ywb(this.$.da,77,5,this.tIf,1)},this.ka,3);else{var Aa=this.d4e();const Eb=Xb.a(this.$);Aa||(Aa={Type:3},Aa.Id=this.C3.WebExtensionId,Aa.WebExtensionData=this.he,Aa.ContentHtml="<div/>",Aa.Version=0,Aa.AbsoluteLeft=0,Aa.AbsoluteTop=0,Aa.AbsoluteRight=0,Aa.AbsoluteBottom=0,Aa.Width=0,Aa.Height=0,Aa.ZOrder=0,Aa.OriginDeltaX=0,Aa.OriginDeltaY=
0,Aa=new na.a(Aa),Eb.K$b(Aa,null),Aa=Eb.Ns(Aa.Th()));Aa?(this.VDc(Aa.ye.firstChild),this.Sba=Object(lb.a)(419,Aa)):Eb.A4b(this.onFloatingObjectControlAdded)}return this}Bmf(Aa){this.VDc(Aa);return this}quc(){this.UXf||this.Qh.Xf.purgeOsfControl(this.controlId,!1);const Aa=this.$.qa.va.Lc();ub.a(this.$.userOperationManager,(cc,pc,Hc)=>kc.e(this.$.qa.va,this.he.InstanceId,cc,pc,Hc,Aa),cc=>new vb.a(606,0,cc,64),null);this.Prg(!0);const Eb=this.d4e();Eb&&Xb.a(this.$).deleteFloatingObject(Eb);this.Qh.gi.Dwj(this.controlId);
this.Qh.gi.nXe(this.controlId,!0);this.CWc=null}fKd(Aa){this.C3=Aa}invokeDdaMethod(Aa,Eb){if(sa.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled){var cc={};cc[Tb.a.Og]=Aa;cc[Tb.a.k6]=Eb;this.Qh.RL(974713501,cc)}else this.Qh.xg(Nb.a.eEb,Eb)}Ntj(Aa,Eb,cc,pc){if(sa.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled)if(!Cd.pAh(Aa)||void 0!==Eb&&null!==Eb&&void 0!==this.P6a(Eb)&&null!==this.P6a(Eb))if(e.ULS.sendTraceTag(36444195,0,50,
`eventId: ${Aa}, targetId: ${Eb}`),Cd.fqf(Aa)&&this.pqi(),Cd.rwd(Aa)&&this.Isd(),Cd.dqf(Aa))sa.EwaSettings.ya(23)?this.Qh.xg(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,pc):(this.qTc=!0,this.Qh.$.da.Ba(232).addHandler(this.controlId,cc,pc,Eb));else if(Cd.eqf(Aa))sa.EwaSettings.ya(23)?this.Qh.xg(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,pc):(this.qTc=!0,this.Qh.$.da.Ba(232).WTg(this.controlId,cc,pc));else{Cd.cqf(Aa)&&this.Bhf(-1777565636,pc);this.oG||(this.oG=
[]);var Hc=this.kzb(Aa,Eb);Hc||(Hc=new qa(Aa,Eb),this.oG.push(Hc));Hc.Mpa();Hc.I4b(cc);this.Qh.Pw(pc);Aa===OSF.DDA.EventDispId.dispidRichApiMessageEvent&&this.eZa&&(this.Zac=cc)}else this.Qh.xg(3002,pc);else this.Qh.xg(-1,pc)}eck(Aa,Eb,cc,pc){Cd.dqf(Aa)?sa.EwaSettings.ya(23)?this.Qh.xg(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,pc):this.Qh.$.da.Ba(232).removeHandler(this.controlId,pc):Cd.eqf(Aa)?sa.EwaSettings.ya(23)?this.Qh.xg(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,
pc):this.Qh.$.da.Ba(232).Wwj(this.controlId,pc):(Cd.cqf(Aa)&&this.Bhf(1592314317,pc),Eb=this.kzb(Aa,Eb),this.enabled?(Eb&&(Eb.hAc(cc),Eb.noi||Array.remove(this.oG,Eb),this.oG.length?Cd.fqf(Aa)&&this.Qrg(!1):this.Prg(!1)),this.Qh.Pw(pc)):this.Qh.xg(-1,pc))}la(Aa){tb.DOMElementExtensions.getElementById(Aa,this.vUf)||Aa.appendChild(tb.DOMElementExtensions.tg(this.Nz))}showHide(Aa){tb.DOMElementExtensions.setVisible(this.Nz,Aa)}resize(Aa,Eb){tb.DOMElementExtensions.qx(this.Nz,Aa);tb.DOMElementExtensions.uK(this.Nz,
Eb)}bUe(Aa){if(!this.ZV&&!tb.DOMElementExtensions.getElementById(this.Nz,this.Rdd)&&this.Nz){const Eb=document.createElement("div");Eb.id=this.Rdd;Eb.className=Ub;Eb.style.backgroundImage="url("+tc.a.current.Uo(104)+")";Eb.style.opacity=Aa?"1":"0";Eb.style.backgroundRepeat="no-repeat";Eb.style.backgroundPosition="center";this.Nz.insertBefore(Eb,this.Nz.firstChild)}this.ZV++}fDh(){0<this.ZV&&this.ZV--;this.ZV||(tb.DOMElementExtensions.tg(tb.DOMElementExtensions.getElementById(this.Nz,this.Rdd)),this.fza&&
!ib.R(this.Wxc,Ha.h(this.$).ga.pa.selectedRanges)&&this.Od(null,null))}P6a(Aa){if(!this.C3||!this.C3.BindingData)return null;for(let Eb=0;Eb<this.C3.BindingData.length;Eb++)if(this.C3.BindingData[Eb].Name===Aa)return this.C3.BindingData[Eb];return null}getDefaultIconUrl(){const Aa=this.Mcf();return Aa?Aa.getDefaultIconUrl():null}getDefaultDisplayName(){if(this.he.TaskpaneTitle)return this.he.TaskpaneTitle;const Aa=this.Mcf();return Aa?Aa.getDefaultDisplayName():null}WYf(){if(this.eZa&&this.Zac){const Aa=
new Jb.a(OSF.DDA.EventDispId.dispidRichApiMessageEvent,this.controlId,null,this.eZa);this.Zac(Aa);this.Zac=this.eZa=null}}Oh(Aa){this.n9d&&this.n9d.Oh(Aa)}GMj(){this.$.ea.isNamedObjectViewMode&&this.fGi()&&(this.$.da.Ba(34).FMj(this.Nz),this.showHide(!1));if(this.Qh.llk){if(!this.UXf){const Aa={};Aa.div=this.Nz;Aa.id=this.he.InstanceId;Aa.solutionId=this.he.PrimaryMarketplace.SolutionId;Aa.version=this.he.PrimaryMarketplace.SolutionVersion;Aa.storeId=this.he.PrimaryMarketplace.MarketplaceRef;Aa.storeType=
this.he.PrimaryMarketplace.MarketplaceType;Aa.ownerAddinSolutionId=this.he.OwnerAddinSolutionId;Aa.ownerAddinStoreType=this.he.OwnerAddinStoreType;this.he.AssetMarketplace?(Aa.assetId=this.he.AssetMarketplace.SolutionId,Aa.assetStoreId=this.he.AssetMarketplace.MarketplaceRef):(Aa.assetId=null,Aa.assetStoreId=null);Aa.settings=this.he.OsfPropertyBag;Aa.hostSettings=this.he.HostPropertyBag;sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5022710_EnableAgaveInitReasonControlActivation")?Aa.reason=this.Q9a?
Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:this.kmc?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.ControlActivation:Aa.reason=this.Q9a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:Microsoft.Office.WebExtension.InitializationReason.Inserted;Aa.osfControlType=0===this.he.WebExtensionType?OSF.OsfControlTarget.InContent:OSF.OsfControlTarget.TaskPane;Aa.isForUILessAction=4===this.he.WebExtensionOsfControlType;
Aa.sourceLocationOverrideResourceId=this.he.SrcLocationOverrideResourceId;Aa.focusOnIframeWhenLoaded=this.he.FocusOnIframeWhenLoaded;Ob.a(this.he)&&(Aa.featureGates=w.AFrameworkApplication.fa.W$e(Aa.solutionId));Aa.hostInfoFlags=0;this.Awa&&(Aa.hostInfoFlags|=2);gc.HelperMethods.Vx(this.he)&&(Aa.hostInfoFlags|=1);this.$.nV||(e.ULS.sendTraceTag(537170466,0,50,"Content web add-in disabled by doc IRM"),Aa.hostInfoFlags|=4);sa.EwaSettings.ya(553)&&(Aa.hostInfoFlags|=8);Aa.sharedRuntimeId=this.he.SharedRuntime?
this.he.SharedRuntime.Resid:this.he.SharedRuntimeId;!gc.HelperMethods.Vx(this.he)||this.he.Preload||Ob.a(this.he)||this.Qh.Xf.getOsfControl(a(767).DdaFacade.getSolutionId(this.he,this.$))||(sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5707326_FixBackgroundAppCrashInViewMode")?this.$.isEditMode&&this.Qh.fTf(this.he):this.Qh.fTf(this.he));Aa.onExtensionLaunchCallback=this.he.OnExtensionLaunchCallback;Aa.initialDisplayMode=this.he.TaskpaneVisible?2:1;sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")&&
(Aa.titleOverride=this.Zl.TaskpaneTitle);this.Qh.Xf.insertOsfControl(Aa)}this.ZV=0}else this.bUe(!0)}Prg(Aa){this.Qrg(Aa);this.Nbk()}pqi(){this.khb||this.Rh.I4b(this.zhf);this.khb++}Qrg(Aa){0<this.khb&&(Aa?this.khb=0:this.khb--,this.khb||this.Rh.hAc(this.zhf))}Isd(){if(!this.fza){const Aa=Ha.h(this.$).ga;this.Wxc=ib.d(Ha.h(this.$).ga.pa.selectedRanges);Aa.WK(this.Od);this.fza=!0}}Nbk(){this.fza&&(Ha.h(this.$).ga.GP(this.Od),this.fza=!1)}uJj(Aa){var Eb=new Ka.Range(Aa.Reference.FirstRow+1,Aa.Reference.FirstColumn+
1,Aa.Reference.LastRow+1,Aa.Reference.LastColumn+1,!1,!1);1===Aa.BindingType&&(Aa.HasHeaders&&--Eb.top,Aa.HasTotals&&(Eb.bottom+=1));var cc=Ha.h(this.$).ga.pa.selectedRanges;Aa=Eb.K9a(this.Wxc);cc=Eb.K9a(cc);return(Eb=Eb.ff(Ha.h(this.$).ga.pa.activeRange))&&(lc.e(Aa)&&!lc.e(cc)||!lc.e(Aa)&&!lc.e(cc)&&!ib.R(Aa,cc))?Eb:null}DKj(){Array.forEach(this.oG,Aa=>{if(Aa.eventId!==OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&Aa.eventId!==OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||this.Qh.gi.a6b(this.controlId))if(Aa.eventId===
OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent)Aa.R7b(new Jb.a(Aa.eventId,this.controlId,null));else if(Aa.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent){const Eb=this.P6a(Aa.targetId);if((null===Eb||void 0===Eb?0:Eb.IsValidRef)&&(this.$.ea.isNamedObjectViewMode?this.$.oc.na.sheetName:this.$.ua.na.name)===Eb.Reference.SheetName){const cc=this.uJj(Eb);cc&&Aa.R7b(new va(Aa.eventId,this.controlId,this.Qh.Q6b(Eb),Eb,cc.top-1,cc.left-1,cc.height,cc.width))}}})}kzb(Aa,Eb){if(!this.oG)return null;
for(let cc=0;cc<this.oG.length;cc++){const pc=this.oG[cc];if(pc.eventId===Aa&&pc.targetId===Eb)return pc}return null}d4e(){const Aa=Xb.a(this.$).sW;for(let Eb=Aa.length-1;0<=Eb;--Eb){const cc=Aa[Eb];if(3===cc.floatingObject.type&&cc.floatingObject.Zl.InstanceId===this.C3.WebExtensionId)return cc}return null}fGi(){for(let Aa=0;Aa<this.$.oc.count;Aa++)if(this.$.oc.getItem(Aa).imageId===this.C3.WebExtensionId)return!0;return!1}VDc(Aa){this.CWc=Aa;this.Nz.id=this.vUf;this.Nz.className=Rd;this.Nz.dir=
this.$.isChromeRtl?"rtl":"ltr";this.GMj()}Mcf(){if(!this.enabled)return null;const Aa=Ob.a(this.Zl)?"":this.Zl.PrimaryMarketplace.SolutionVersion;return OSF.OsfManifestManager.getCachedManifest(this.Zl.PrimaryMarketplace.SolutionId,Aa)}Bhf(Aa,Eb){if(sa.EwaSettings.ya(23))this.Qh.xg(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Eb);else try{if(e.ULS.sendTraceTag(537170462,0,50,"HandleDialogNotificationShownInAddinEvent called!"),4!==this.Ine)this.Qh.xg(OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog,
Eb);else{const cc={};cc[ea.a.Dsb]=this.controlId;const pc=new Pb.a(Aa,0,this.$.isEditMode?2:1,0,null);this.$.Ia.mc(pc,cc);this.Qh.Pw(Eb)}}catch(cc){e.ULS.sendTraceTag(537170461,0,10,`HandleDialogNotificationShownInAddinEvent called. Error message: ${cc.message}.`),this.Qh.xg(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,Eb)}}static pAh(Aa){return Aa===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||Aa===OSF.DDA.EventDispId.dispidBindingDataChangedEvent}static fqf(Aa){return Aa===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||
Aa===OSF.DDA.EventDispId.dispidSettingsChangedEvent||Aa===OSF.DDA.EventDispId.dispidRichApiMessageEvent}static rwd(Aa){return Aa===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||Aa===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}static dqf(Aa){return Aa===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent}static eqf(Aa){return Aa===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent}static cqf(Aa){return Aa===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent}}
Object(c.a)(Cd,"OsfControl",Ca.a,[786]);class Yc{constructor(){this.Q1a={}}add(Aa){this.Q1a[Aa]=!0}remove(Aa){delete this.Q1a[Aa]}clear(){for(const Aa of Object.keys(this.Q1a))delete this.Q1a[Aa]}Sif(){return 0<Object.keys(this.Q1a).length}u_h(){return Object.keys(this.Q1a)}}Object(c.a)(Yc,"RichApiBeforeDocumentCloseNotificationRegistrationManager",null,[]);var Kd=a(62);class oc{constructor(Aa,Eb,cc){this.Z2f=this.Y2f=0;this.HRb=this.Leb=null;this.f2i=()=>{var pc=Ha.h(this.$).ga.Sa.eC;if(this.$vd(pc)&&
(pc=this.CAb(pc))){var Hc={};Hc.chartId=pc;Hc.worksheetId=this.pma();Hc=Kd.a.nd(Hc);this.Jla(51,pc,Hc);this.Jla(51,this.pma(),Hc)}};this.g2i=()=>{if(this.Leb){var pc={};pc.chartId=this.Leb;pc.worksheetId=this.HRb;pc=Kd.a.nd(pc);this.Jla(52,this.Leb,pc);this.Jla(52,this.HRb,pc)}pc=Ha.h(this.$).ga.Sa.eC;this.$vd(pc)?(this.Leb=this.CAb(pc),this.HRb=this.pma()):this.HRb=this.Leb=null};this.$=Aa;this.gi=Eb;this.Rh=cc}Etb(Aa){51===Aa.messageType?this.Y2f=this.OJa(Aa.actionType,this.Y2f,this.f2i):52===Aa.messageType&&
(this.Z2f=this.OJa(Aa.actionType,this.Z2f,this.g2i))}OJa(Aa,Eb,cc){if(1===Aa)Eb||Ha.h(this.$).ga.Sa.A2c(cc),Eb++,this.GQj();else if(2===Aa){if(1>Eb)return Eb;1===Eb&&Ha.h(this.$).ga.Sa.vSd(cc);Eb--}return Eb}Jla(Aa,Eb,cc){Eb&&this.gi.XL(Aa,Eb)&&this.Rh.yG(Aa,Eb,cc)}CAb(Aa){return Aa&&Aa.floatingObject?(Aa=Aa.floatingObject.id.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}")))&&1===Aa.length?Aa[0]:null:null}pma(){const Aa=this.$.ua.na;return Aa&&0===Aa.yH?Aa.sheetId:null}GQj(){const Aa=Ha.h(this.$).ga.Sa.eC;
this.$vd(Aa)&&(this.Leb=this.CAb(Aa),this.HRb=this.pma())}$vd(Aa){return!!Aa&&!!Aa.floatingObject&&0===Aa.floatingObject.type}}Object(c.a)(oc,"RichApiEventChartActivatedDeactivatedHandler",null,[]);var eb=a(763),yb=a(194),zc=a(629),dd=a(107),od=a(358),Ed=a(63);class ce extends qb.a{constructor(Aa,Eb,cc){super();this.ZV=this.QCa=0;this.Od=(pc,Hc)=>{if(this.enabled&&!(this.fsf()||null!==Hc&&void 0!==Hc&&Hc.zvf)&&(pc=Object(lb.a)(dd.a,this.$.ua.na))&&0===pc.yH){const td=pc.sheetId,me=this.U9e();let ve=
null,Qe=null;this.gi.mvf()&&(ve=this.grid.Wb.rh(this.grid.ga.pa.activeCell),Qe=td in this.jqc?this.jqc[td]:null);this.JCe(td,me)&&kb.TaskExtensions.za(Ed.Task.Ua(!0),()=>{this.Lni(td,me);this.vni(td,me,ve,Qe)},this.ka);this.dVe(td,me,ve)}};this.$=Aa;this.gi=Eb;this.Rh=cc;this.grid=Ha.h(Aa);this.bRa={};this.jqc={}}get enabled(){return!this.ZV&&0<this.QCa}y6b(Aa){Object(lb.a)(od.a,this.$.ua);1===Aa.actionType?(this.QCa||this.grid.ga.WK(this.Od),this.QCa++):2!==Aa.actionType||1>this.QCa||(1===this.QCa&&
this.grid.ga.GP(this.Od),this.QCa--)}EDc(Aa){Aa?this.ZV++:(0<this.ZV&&this.ZV--,this.ZV||this.Od(null,new zc.a(!1)))}U9e(){return this.grid.ga.pa.selectedRanges}JCe(Aa,Eb){return sa.EwaSettings.isChangeGateEnabled("OfficeVSO:4233860_EnableSelectionChangedEventForFirstTimeOnOpenSheet")?(!!Aa&&yb.e(this.bRa)||Aa in this.bRa)&&!ib.R(this.bRa[Aa],Eb):Aa in this.bRa&&!ib.R(this.bRa[Aa],Eb)}dVe(Aa,Eb,cc){this.bRa[Aa]=ib.d(Eb);this.jqc[Aa]=cc}fsf(){return this.grid.Ob||this.grid.hj}C4e(Aa,Eb){this.gi.XL(14,
Aa)&&this.Rh.yG(14,Aa,Eb);this.gi.XL(14,eb.a.FM)&&this.Rh.yG(14,eb.a.FM,Eb)}Lni(Aa,Eb){const cc={};cc.worksheetId=Aa;cc.address=this.Tod(Eb);Eb=Kd.a.nd(cc);this.C4e(Aa,Eb)}vni(Aa,Eb,cc,pc){if(this.gi.mvf()){var Hc="";let td="";pc&&(Hc=pc.ek);cc&&(td=cc.ek);pc?cc?(Eb=cc.usedRange.K9a(Eb),Hc!==td&&this.vfc(Hc,"",Aa),this.vfc(td,this.Tod(Eb),Aa)):this.vfc(Hc,"",Aa):cc&&(Hc=cc.usedRange.K9a(Eb),this.vfc(td,this.Tod(Hc),Aa))}}vfc(Aa,Eb,cc){if(this.gi.XL(100,Aa)){const pc={};pc.address=Eb;pc.worksheetId=
cc;this.Rh.yG(100,Aa,Kd.a.nd(pc))}}Tod(Aa){return ib.i(Aa,",",this.$,!1)}dispose(){0<this.QCa&&this.grid.ga.GP(this.Od);this.jqc=this.bRa=null;this.QCa=0;this.Rh=this.gi=this.$=this.grid=null}}Object(c.a)(ce,"RichApiEventSelectionChangedHandler",qb.a,[]);var wc=a(354);class ed extends ce{constructor(Aa,Eb,cc){super(Aa,Eb,cc);this.Axf=this.Bxf=null}U9e(){return wc.a.iac(this.grid.ga.rangePicker.sP)}JCe(Aa,Eb){return this.Bxf!==Aa||!ib.R(this.Axf,Eb)}dVe(Aa,Eb){this.Bxf=Aa;this.Axf=ib.d(Eb)}fsf(){return!this.grid.Ob&&
!this.grid.hj}C4e(Aa,Eb){this.gi.XL(2700,eb.a.FM)&&this.Rh.yG(2700,eb.a.FM,Eb)}}Object(c.a)(ed,"RichApiEventPickedRangesChangedHandler",ce,[]);class md{constructor(Aa,Eb,cc){this.dUa=this.cUa=0;this.pKa=this.eka=null;this.ZLf=()=>{var pc=Ha.h(this.$).ga.Sa.eC;if(0<this.dUa&&this.eka&&this.pKa){var Hc={};Hc.shapeId=this.eka;Hc.worksheetId=this.pKa;Hc=Kd.a.nd(Hc);this.fireEvent(2102,this.eka,Hc)}this.cIi(pc)?(this.eka=this.pak(pc),this.pKa=this.pma(),this.eka&&this.pKa)?0<this.cUa&&(pc={},pc.shapeId=
this.eka,pc.worksheetId=this.pKa,pc=Kd.a.nd(pc),this.fireEvent(2101,this.eka,pc)):e.ULS.sendTraceTag(537170458,344,10,`Something goes wrong, we got invalid shape id: '${this.eka}', or worksheet id: '${this.pKa}' from a Floating object or gridview.`):this.pKa=this.eka=null};this.$=Aa;this.gi=Eb;this.Rh=cc}Etb(Aa){const Eb=Ha.h(this.$).ga;1===Aa.actionType?(this.cUa||this.dUa||Eb.Sa.A2c(this.ZLf),2101===Aa.messageType?this.cUa++:2102===Aa.messageType&&this.dUa++):2===Aa.actionType&&(2101===Aa.messageType?
this.cUa=0<this.cUa?this.cUa-1:0:2102===Aa.messageType&&(this.dUa=0<this.dUa?this.dUa-1:0),this.cUa||this.dUa||Eb.Sa.vSd(this.ZLf))}cIi(Aa){return!!Aa&&!!Aa.floatingObject&&(0===Aa.floatingObject.type||7===Aa.floatingObject.type||1===Aa.floatingObject.type||3===Aa.floatingObject.type||5===Aa.floatingObject.type)}pak(Aa){if(!Aa||!Aa.floatingObject)return null;Aa=Aa.floatingObject.id;var Eb=Aa.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}"));Eb=Eb&&1===Eb.length?Eb[0]:null;return Eb?Eb:(e.ULS.sendTraceTag(537170457,
344,10,`Expect get the guid like shape id from the floating object id: '${Aa}', but we failed.`),null)}pma(){const Aa=this.$.ua.na;return Aa&&0===Aa.yH?Aa.sheetId:null}fireEvent(Aa,Eb,cc){Eb&&this.gi.XL(Aa,Eb)&&this.Rh.yG(Aa,Eb,cc)}}Object(c.a)(md,"RichApiEventShapeActivatedDeactivatedHandler",null,[]);class Yd{constructor(Aa,Eb,cc){this.c3f=this.b3f=this.d3f=this.a3f=0;this.Fej=(pc,Hc)=>{pc=Object(lb.a)(dd.a,Hc.na);this.Oab(pc)&&(Hc={},Hc.worksheetId=pc.sheetId,Hc=Kd.a.nd(Hc),this.Jla(11,pc.sheetId,
Hc))};this.Iej=(pc,Hc)=>{pc=Object(lb.a)(dd.a,Hc.WC);this.Oab(pc)&&(Hc={},Hc.worksheetId=pc.sheetId,Hc=Kd.a.nd(Hc),this.Jla(12,pc.sheetId,Hc))};this.Gej=(pc,Hc)=>{pc=Object(lb.a)(dd.a,Hc.na);this.Oab(pc)&&(Hc={},Hc.worksheetId=pc.sheetId,pc=Kd.a.nd(Hc),this.Jla(11,null,pc,!0))};this.Hej=(pc,Hc)=>{pc=Object(lb.a)(dd.a,Hc.WC);this.Oab(pc)&&(Hc={},Hc.worksheetId=pc.sheetId,pc=Kd.a.nd(Hc),this.Jla(12,null,pc,!0))};this.$=Aa;this.gi=Eb;this.Rh=cc}Etb(Aa){11===Aa.messageType?Aa.targetId===eb.a.FM?this.L3g(Aa.actionType):
this.K3g(Aa.actionType):12===Aa.messageType&&(Aa.targetId===eb.a.FM?this.M3g(Aa.actionType):this.N3g(Aa.actionType))}K3g(Aa){this.a3f=this.OJa(Aa,this.a3f,this.Fej)}N3g(Aa){this.d3f=this.OJa(Aa,this.d3f,this.Iej)}L3g(Aa){this.b3f=this.OJa(Aa,this.b3f,this.Gej)}M3g(Aa){this.c3f=this.OJa(Aa,this.c3f,this.Hej)}OJa(Aa,Eb,cc){1===Aa?Eb=this.NJa(Eb,cc):2===Aa&&(Eb=this.RLa(Eb,cc));return Eb}NJa(Aa,Eb){Aa||this.$.ua.Vg(Eb);Aa++;return Aa}RLa(Aa,Eb){if(1>Aa)return Aa;1===Aa&&this.$.ua.xh(Eb);Aa--;return Aa}Oab(Aa){return!!Aa&&
0===Aa.yH}Jla(Aa,Eb,cc,pc=!1){Eb=pc?eb.a.FM:Eb;this.gi.XL(Aa,Eb)&&this.Rh.yG(Aa,Eb,cc)}}Object(c.a)(Yd,"RichApiEventSheetActivatedDeactivatedHandler",null,[]);var $d=a(250),bd=a(14),Vd=a(232);class De extends Sys.EventArgs{constructor(Aa,Eb,cc,pc){super();this.sheet=Aa;this.ich=Eb;this.offsetX=cc;this.offsetY=pc}}Object(c.a)(De,"ClickInActiveCellEventArgs",Sys.EventArgs,[]);class Pe{constructor(Aa,Eb,cc){this.h9b=null;this.eAd=!1;this.onPointerDown=pc=>{let Hc;3===pc.kc?({W3a:Hc}=this.gridView.Ngc(pc.clientPoint),
this.eAd=!!Hc&&this.gridView.ga.pa.jVe(Hc)):this.eAd=!1;this.h9b=pc.clientPoint;return!1};this.Ud=pc=>{if(this.gridView.inRangePicker||this.gridView.hj||this.eAd||pc.shiftKey||pc.ctrlKey||pc.Da.button!==Sys.UI.MouseButton.leftButton||!this.h9b||!pc.clientPoint||pc.clientPoint.x!==this.h9b.x||pc.clientPoint.y!==this.h9b.y)return!1;const Hc=({W3a:pc}=this.gridView.Ngc(pc.clientPoint)).returnValue,td=Object(lb.a)(dd.a,this.$.ua.na);if(Hc&&td&&0===td.yH){if(!this.gridView.ga.pa.U6.contains(pc))return!1;
pc=new De(td,pc,gc.HelperMethods.VMd(Hc.x),gc.HelperMethods.VMd(Hc.y));this.Jej(pc)}return!1};this.$=Aa;this.gridView=Ha.h(Aa);this.gi=Eb;this.Rh=cc;this.rvj()}dispose(){this.Dck()}rvj(){for(const Aa of this.gridView.Ho){const Eb=Aa.domElement;$d.a.instance.ta(bd.a.pointerDown,Eb,this.onPointerDown);Vd.a.instance.ta(bd.a.click,Eb,this.Ud)}}Dck(){for(const Aa of this.gridView.Ho){const Eb=Aa.domElement;$d.a.instance.Aa(bd.a.pointerDown,Eb,this.onPointerDown);Vd.a.instance.Aa(bd.a.click,Eb,this.Ud)}}Jej(Aa){var Eb=
Aa.sheet;if(this.Oab(Eb)){var cc={};cc.worksheetId=Eb.sheetId;cc.address=Aa.ich.toString();cc.offsetX=Aa.offsetX;cc.offsetY=Aa.offsetY;Aa=Eb.sheetId;this.gi.XL(21,Aa)&&(Eb=Kd.a.nd(cc),this.Rh.yG(21,Aa,Eb));Aa=eb.a.FM;this.gi.XL(21,Aa)&&(cc=Kd.a.nd(cc),this.Rh.yG(21,Aa,cc))}}Oab(Aa){return!!Aa&&0===Aa.yH}}Object(c.a)(Pe,"RichApiEventSingleClickedHandler",null,[]);class Zb{constructor(Aa,Eb,cc){this.YNb=0;this.zeb=this.Ieb=null;this.sTf=()=>{const pc=Ha.h(this.$).ga.Sa.eC;if(pc)if(this.dwf(pc)){const Hc=
this.pma();this.kjd(Hc);this.Ieb=pc.floatingObject.id;this.zeb=Hc}else this.Ieb&&(this.kjd(this.zeb),this.zeb=this.Ieb=null);else this.Ieb&&(this.kjd(this.zeb),this.zeb=this.Ieb=null)};this.$=Aa;this.gi=Eb;this.Rh=cc}y6b(Aa){2E3===Aa.messageType&&(1===Aa.actionType?(this.YNb||Ha.h(this.$).ga.Sa.A2c(this.sTf),this.YNb++,this.NMj()):2===Aa.actionType&&this.YNb&&(1===this.YNb&&Ha.h(this.$).ga.Sa.vSd(this.sTf),this.YNb--))}kjd(Aa){var Eb;const cc={};cc.worksheetId=Aa;cc.revisionLoad=!1;if(sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5509495_SelectedVisualIdVisualSelectionChangedEventArgs")&&
(sa.EwaSettings.ya(616)||sa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSChartPlayerManualPlacement",!1))){const pc=Ha.h(this.$).ga.Sa.eC;(null===(Eb=null===pc||void 0===pc?void 0:pc.floatingObject)||void 0===Eb?0:Eb.Pd)?cc.selectedVisualId=pc.floatingObject.Pd.VisualID:cc.selectedVisualId=null}Eb=Kd.a.nd(cc);Aa&&this.gi.XL(2E3,Aa)&&this.Rh.yG(2E3,Aa,Eb)}pma(){const Aa=this.$.ua.na;return Aa&&0===Aa.yH?Aa.sheetId:null}NMj(){const Aa=Ha.h(this.$).ga.Sa.eC;this.dwf(Aa)&&(this.Ieb=
Aa.floatingObject.id,this.zeb=this.pma())}dwf(Aa){return!!Aa&&Aa.CAd()}}Object(c.a)(Zb,"RichApiEventVisualSelectionChangedHandler",null,[]);class Vc{constructor(Aa,Eb,cc){this.ZNb=0;this.Yxg=!0;this.Jfc=0;this.Xyd=!0;this.uJe=()=>{const pc=document.hasFocus();if(this.Yxg!==pc){if(pc){const Hc=Kd.a.nd({});this.Rh.yG(2203,eb.a.FM,Hc)}this.Yxg=pc}};this.vJe=pc=>{(0<pc.timeRemaining()||pc.didTimeout)&&this.uJe();window.requestIdleCallback(this.vJe)};this.$=Aa;this.gi=Eb;this.Rh=cc;window.requestIdleCallback||
(this.Xyd=!1)}J3g(Aa){1===Aa.actionType?(this.ZNb||this.a4g(),this.ZNb++):2!==Aa.actionType||1>this.ZNb||(1===this.ZNb&&this.Xwh(),this.ZNb--)}a4g(){if(this.gi.XL(2203,eb.a.FM))if(this.Xyd){const Aa={};Aa.timeout=this.$.xa.CheckFocusTimeout;this.Jfc=window.requestIdleCallback(this.vJe,Aa)}else this.Jfc=window.setInterval(this.uJe,this.$.xa.CheckFocusTimeInterval)}Xwh(){this.Xyd?window.cancelIdleCallback(this.Jfc):window.clearInterval(this.Jfc)}}Object(c.a)(Vc,"RichApiEventWorkbookActivatedHandler",
null,[]);var Nc;(function(Aa){Aa[Aa.none=0]="none";Aa[Aa.registerEvent=1]="registerEvent";Aa[Aa.unregisterEvent=2]="unregisterEvent";Aa[Aa.customFunction=3]="customFunction";Aa[Aa.showCard=4]="showCard";Aa[Aa.createWorkbook=5]="createWorkbook";Aa[Aa.openWorkbook=6]="openWorkbook";Aa[Aa.enableEvents=7]="enableEvents";Aa[Aa.closeWorkbook=8]="closeWorkbook";Aa[Aa.setCalculationMode=9]="setCalculationMode";Aa[Aa.workbookLinksRequestRefresh=10]="workbookLinksRequestRefresh";Aa[Aa.workbookLinksRequestRefreshAll=
11]="workbookLinksRequestRefreshAll";Aa[Aa.workbookLinksEnableContent=12]="workbookLinksEnableContent";Aa[Aa.workbookLinksFindNextLink=13]="workbookLinksFindNextLink";Aa[Aa.workbookLinksOpenWorkbook=14]="workbookLinksOpenWorkbook";Aa[Aa.rangePicker=15]="rangePicker";Aa[Aa.enableRichApiRecording=16]="enableRichApiRecording";Aa[Aa.recordAction=17]="recordAction";Aa[Aa.focus=18]="focus";Aa[Aa.businessBarShow=19]="businessBarShow";Aa[Aa.businessBarHide=20]="businessBarHide";Aa[Aa.augmentationLoopActivateAnnotation=
21]="augmentationLoopActivateAnnotation";Aa[Aa.augmentationLoopSubmitSignal=22]="augmentationLoopSubmitSignal";Aa[Aa.showRangeValuesPreview=23]="showRangeValuesPreview";Aa[Aa.hideRangeValuesPreview=24]="hideRangeValuesPreview"})(Nc||(Nc={}));Object(c.b)("PostProcessActionType",Nc);var ld=a(262);class yd{constructor(Aa,Eb,cc){this.wUf=null;this.ijd=(pc,Hc)=>{const td=eb.a.FM,me={};me.eventId=pc;me.payload=Hc;this.gi.XL(2201,td)&&this.Rh.yG(2201,td,Kd.a.nd(me))};this.$=Aa;this.gi=Eb;this.Rh=cc;this.Uui()}I3g(Aa){1===
Aa.actionType?(this.$.oea=!0,Object(lb.a)(a(767).DdaFacade,ld.a(this.$)).jjd(!0)):2===Aa.actionType&&(this.$.oea=!1);this.wUf=Aa.controlId;e.ULS.sendTraceTag(537170456,0,50,`AttachOrDetachMacroRecorderEventHandler: actionType: ${Nc[Aa.actionType]}; controlId: ${this.wUf}; this.ewaControl.IsMacroRecorderListening: ${this.$.oea}.`)}tEh(Aa){Object(lb.a)(a(767).DdaFacade,ld.a(this.$)).F4e(Aa,this.$.oea)}Uui(){this.$.hX&&kb.TaskExtensions.za(Ra.GetServiceTaskFactory.Za(this.$.da,297,298,1),Aa=>{(Aa=Aa.result)&&
Aa.init(this.ijd)},this.$.ka,3)}}Object(c.a)(yd,"RichApiMacroRecorderEventHandler",null,[]);class sd{}Object(c.a)(sd,"StyleCacheItem",null,[]);class ic{constructor(Aa,Eb,cc){this.$=Aa;this.gridView=Eb;this.pg=cc}Tja(Aa){this.range=Aa;this.A9b=Array(Aa.width);this.IGc=Array.from({length:Aa.height},()=>Array(Aa.width))}wMj(Aa,Eb,cc,pc){this.muf(Aa,Eb)&&(this.IGc[Aa-this.range.top][Eb-this.range.left]||(this.IGc[Aa-this.range.top][Eb-this.range.left]={backgroundColor:cc.backgroundColor}),cc.backgroundColor=
pc)}yMj(Aa,Eb,cc){if(this.muf(Aa,Eb)){Aa=Ka.Range.xd(Aa,Eb);var pc=this.gridView.tc(Aa);pc&&(this.A9b[Eb-this.range.left]||(this.A9b[Eb-this.range.left]=pc.width),Eb=this.pg.A0d(this.gridView,[Aa],cc,!1),"Success"!==Eb.kind&&e.ULS.sendTraceTag(509223560,0,10,`InstantaneousGridContentRestorer.setColumnWidth: failed to set column width - ${Eb.reason}`))}}restore(){this.range&&(this.A9b.forEach((Aa,Eb)=>{Aa=this.pg.A0d(this.gridView,[Ka.Range.xd(this.range.top,this.range.left+Eb)],Aa,!1);"Success"!==
Aa.kind&&e.ULS.sendTraceTag(509220497,0,10,`InstantaneousGridContentRestorer.restore: failed to set column width - ${Aa.reason}`)}),this.IGc.forEach((Aa,Eb)=>{Aa.forEach((cc,pc)=>{pc=Ka.Range.xd(this.range.top+Eb,this.range.left+pc);if(pc=this.gridView.tc(pc))pc.cell.backgroundColor=cc.backgroundColor})}),this.A9b=this.IGc=this.range=void 0)}muf(Aa,Eb){if(!this.range)return e.ULS.sendTraceTag(509223559,0,15,"InstantaneousGridContentRestorer.isRowColInRange: range not yet created - begin has not been called"),
!1;(Aa=this.range.contains(Ka.Range.xd(Aa,Eb)))||e.ULS.sendTraceTag(509223558,0,10,"InstantaneousGridContentRestorer.isRowColInRange: row/column not in range");return Aa}}Object(c.a)(ic,"InstantaneousGridContentRestorer",null,[]);var Ic=a(219),kd=a(139);class Hd{constructor(Aa,Eb,cc,pc){this.Aci=Hc=>{const td=Hc.Td.block;if(this.$u.ff(td.mf)){this.KWf([td.mf]);const me=Ha.h(this.$).$Y(td.mf),ve=()=>this.CWf([td.mf]);setTimeout(()=>{me.skeletonMode?setTimeout(()=>{me.skeletonMode?e.ULS.sendTraceTag(509220498,
0,10,"RichApiRangeValuesPreview.getRangeCallback: skeleton mode not dismissed within alloted time"):ve()},Hd.xAg):ve()},Hd.lBg)}};this.BSa=(Hc,td)=>{0===td.Yr&&576!==td.Cg.operation.operationName&&this.gDb(!0)};this.CKd=Hc=>{this.yFc&&(this.$Th(Hc),this.z2())};this.$=Aa;this.gi=Eb;this.Rh=cc;this.gridView=Ha.h(this.$);this.Rlc=new ic(this.$,this.gridView,pc)}oni(Aa,Eb,cc,pc){this.Atf(Aa)?(Eb=this.lah(Eb,cc))?this.CTa?e.ULS.sendTraceTag(509227293,0,15,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: preview already showing, exit"):
(this.worksheetId=Aa,this.$u=Eb,this.values=cc,this.Sqa(pc)):e.ULS.sendTraceTag(509384200,0,10,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: failed to calculate range"):e.ULS.sendTraceTag(509384201,0,50,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: not showing the preview, desired worksheet not supported for this operation")}Cli(Aa){this.Atf(Aa)?this.gDb(!1):e.ULS.sendTraceTag(509359639,0,50,"RichApiRangeValuesPreview.handleHideRangeValuesPreviewPostProcessAction: not hiding the preview, desired worksheet not supported for this operation")}Sqa(Aa){this.KWf(this.u8e());
Aa&&(e.ULS.sendTraceTag(509227290,0,50,`RichApiRangeValuesPreview.showPreview: options: ${JSON.stringify(Aa)}`),Aa.autoexpandTable&&this.pah(),Aa.autofitColumns&&this.N$g());this.yFc=this.gridView.uP.Sqa(this.$u,this.Aci).then(Eb=>{e.ULS.sendTraceTag(509384199,0,50,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: preview shown");this.CTa=Eb;this.Rlc.Tja(this.$u);this.CWf(this.u8e());this.$.userOperationManager.zs(this.BSa);Eb.J8f.then(()=>this.CKd(!0),()=>this.CKd(!0));return Promise.resolve()},
Eb=>{e.ULS.sendTraceTag(509384198,0,10,`RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: failed to show preview, rejectionString = ${Eb}`);this.z2();return Promise.resolve()})}gDb(Aa){this.yFc&&(e.ULS.sendTraceTag(509359638,0,50,"RichApiRangeValuesPreview.hidePreview: showPromise exists, will hide preview"),this.yFc.then(()=>{const Eb=this.CTa;this.CKd(Aa);Eb&&Eb.ena("RichApiRangeValuesPreview")},()=>{e.ULS.sendTraceTag(509383618,0,10,"RichApiRangeValuesPreview.hidePreview: unexpected rejection of this.showPromise")}))}lah(Aa,
Eb){Aa=ib.ab(Aa,this.$.ua);if(Aa.returnValue)return new Ka.Range(Aa.range.top,Aa.range.left,Aa.range.top+Eb.length-1,Aa.range.left+Eb[0].length-1,!0,!0)}Atf(Aa){const Eb=this.$.ua.na;return Eb&&Aa===Eb.sheetId}KWf(Aa){this.Zjd(Aa,(Eb,cc,pc,Hc)=>{Hc.cell.Heb=this.values[Eb][cc];return!0})}CWf(Aa){this.Uqa&&this.Zjd(Aa,(Eb,cc,pc,Hc)=>{this.Rlc.wMj(pc.top,pc.left,Hc,this.a6h(pc.top));return!0});if(this.I2a){const Eb=this.$u.K9a(Aa);0<Eb.length&&this.I2a&&this.I2a.forEach((cc,pc)=>{this.Rlc.yMj(Eb[0].top,
this.$u.left+pc,cc)})}}Zjd(Aa,Eb){for(let pc=0;pc<this.values.length;++pc)for(let Hc=0;Hc<this.values[pc].length;++Hc){const td=Ka.Range.xd(this.$u.top+pc,this.$u.left+Hc);if(!Aa||Aa.some(me=>me.contains(td))){var cc=this.gridView.Mv(td);if((!cc||td.equals(cc.topLeft))&&(cc=this.gridView.tc(td))&&!Eb(pc,Hc,td,cc))return}}}u8e(){return this.gridView.Ca.uz().filter(Aa=>Aa.na===this.$.na).map(Aa=>Aa.mf)}$Th(Aa){this.gi.XL(3400,this.worksheetId)&&(Aa=Kd.a.nd({type:"RangeValuesPreviewDismissed",source:"Local",
vok:Aa}),this.Rh.yG(3400,this.worksheetId,Aa))}z2(){this.$.userOperationManager.fp(this.BSa);this.CEj();this.Uqa=this.worksheetId=this.yFc=this.values=this.$u=this.CTa=void 0}pah(){if(this.$u){var Aa=this.ogi(this.$u);if(Aa){e.ULS.sendTraceTag(509227289,0,50,"RichApiRangeValuesPreview.calculateSimulatedAutoexpandData: table directly above or to the left of the range - faking autoexpand table");var Eb=(td,me)=>{var ve;return null===(ve=this.gridView.tc(Ka.Range.xd(td,me)))||void 0===ve?void 0:ve.backgroundColor},
cc=Aa.usedRange.top;if(Aa.attributes&16){var pc=Eb(Aa.usedRange.top,Aa.usedRange.left);++cc}var Hc=Eb(cc,Aa.usedRange.left);Eb=Eb(cc+1,Aa.usedRange.left);this.Uqa={Dpg:Aa.usedRange.top,fsd:pc,C8j:Hc,s6g:Eb}}else e.ULS.sendTraceTag(509223561,0,50,"RichApiRangeValuesPreview.calculateSimulatedAutoexpandData: table autoexpand requested but no table found")}else e.ULS.sendTraceTag(509227291,0,10,"RichApiRangeValuesPreview.calculateSimulatedAutoexpandData: this should never be called with no preview range set")}N$g(){this.I2a=
Array(this.$u.width);let Aa=!1;this.Zjd(void 0,(Eb,cc,pc,Hc)=>{var td;if(this.gridView.Mv(pc))return Aa=!0,!1;Eb=Hc.cell;Eb=Eb.pNe(Eb.Heb);Eb>Hc.width&&(this.I2a[cc]=Object(kd.a)(null!==(td=this.I2a[cc])&&void 0!==td?td:0,Eb));return!0});Aa&&(this.I2a=void 0)}CEj(){this.Rlc.restore();ib.z(this.$u,(Aa,Eb)=>{Aa=Ka.Range.xd(Aa,Eb);if(Aa=this.gridView.tc(Aa))Aa.cell.Heb=void 0})}a6h(Aa){return this.Uqa.fsd&&Aa===this.Uqa.Dpg?this.Uqa.fsd:0===(Aa-this.Uqa.Dpg-(this.Uqa.fsd?1:0))%2?this.Uqa.C8j:this.Uqa.s6g}ogi(Aa){const Eb=
Ic.b(this.gridView.$,Aa,!0);if(!(1<Eb.length)){var cc=Hc=>{var td;const me=null!==(td=this.gridView.Wb.ngi(Hc))&&void 0!==td?td:this.gridView.Wb.pgi(Hc);if(me)return me},pc=cc(Aa);if(pc&&0===Eb.length)return pc;if(0!==Eb.length&&(Aa=ib.Y(Aa,Eb[0].usedRange),1===Aa.length))return cc(Aa[0])}}}Hd.lBg=20;Hd.xAg=100;Object(c.a)(Hd,"RichApiRangeValuesPreview",null,[]);class Ud{}Object(c.a)(Ud,"SessionRecreationInfo",null,[]);class de{constructor(Aa,Eb,cc){this.$=Aa;this.gi=Eb;this.runtimeCalculationMode=
cc}BYi(){return sa.EwaSettings.ya(234)?this.gi.zoi()||0!==this.runtimeCalculationMode:!1}R8g(){var Aa={};Aa.eventRegistrationInfos=this.gi.K5h();Aa.runtimeCalculationMode=this.runtimeCalculationMode;Aa=Object(b.a)(new Ud,{runtimeState:Aa});const Eb={HttpMethod:"POST",PathAndQuery:"RestoreRuntimeState",RequestHeaders:null};Eb.RequestBody=JSON.stringify(Aa);Eb.RequestFlags=1;return Eb}}Object(c.a)(de,"RichApiRuntimeStateHandler",null,[]);class qe{constructor(Aa,Eb,cc,pc,Hc,td,me,ve,Qe){this.dequeueUtcTime=
this.processUtcTime=this.enqueueUtcTime=null;this.operationCount=this.executionDurationInMS=this.inQueueDurationInMS=0;this.UserOperationName=this.ServerCorrelationId=null;this.IsDocumentHidden=!1;this.enqueueUtcTime=Aa;this.processUtcTime=Eb;this.dequeueUtcTime=cc;this.inQueueDurationInMS=pc;this.executionDurationInMS=Hc;this.operationCount=td;this.ServerCorrelationId=me;this.UserOperationName=ve;this.IsDocumentHidden=Qe}}Object(c.a)(qe,"UserOperationQueueItemsStatisticsData",null,[]);var fe=a(338),
Ke=a(36),Te=a(20),Se=a(304),df=a(53),te=a(609),gf=a(74),cf=a(58),bf=a(76);class $a extends fe.a{constructor(Aa,Eb,cc){super(cc,Aa);this.Hya=this.hashCode=null;this.j$b=!1;this.fo=(pc,Hc)=>{Hc.Td.hash===this.hashCode&&this.Hya&&Object(lb.a)(a(767).DdaFacade,this.$.da.Ba(35)).nYj(this.Hya.InstanceId)};this.gg=(pc,Hc)=>{switch(Hc.Td.block.state){case 1:case 3:case 5:this.Iga(Hc)}};this.Kj=()=>{this.qNb(!0)};this.Mp=(pc,Hc)=>{this.isVisible&&this.AXa(Hc.WC);this.clearCache()};this.Oe=(pc,Hc)=>{this.EWa(Hc.na,
!!Hc.WC)};this.iy=()=>{this.$.ea.kpa()};this.gYa=Eb;this.domElement.classList.add(Ke.a.jec);this.domElement.classList.add(Te.a.Kv);cc.tabIndex=0;this.EWa(this.$.na,!1);this.Dd.la("mousedown",this.iy);this.Dd.la("contextmenu",pc=>{bf.g(pc)});this.$.ua.UK(this.Mp);this.$.oc.UK(this.Mp);this.$.oc.Vg(this.Oe);this.$.ua.Vg(this.Oe);this.Ca.vv(this.gg);this.Ca.vI(this.fo);this.Ca.Aw(this.Kj);this.ut(this.CBa)}get Ca(){return this.gYa}dispose(){this.$&&(this.$.ua.zM(this.Mp),this.$.oc.zM(this.Mp),this.$.oc.xh(this.Oe),
this.$.ua.xh(this.Oe));this.gYa&&(this.gYa.Vt(this.gg),this.gYa.SJ(this.fo),this.gYa.gx(this.Kj));this.$v(this.CBa);this.clearCache();ob.a.Ka(this.gYa);this.gYa=null;tb.DOMElementExtensions.tg(this.domElement);super.dispose()}FMj(Aa){tb.DOMElementExtensions.tg(tb.DOMElementExtensions.getElementById(this.domElement,Aa.id));this.domElement.appendChild(Aa)}qud(){if(this.Hya&&!this.j$b){var Aa=Object(lb.a)(a(767).DdaFacade,ld.a(this.$)).Xn(this.Hya.InstanceId);Aa&&(Aa.resize(this.Hya.Width,this.Hya.Height),
Aa.la(this.domElement),Aa.showHide(!0),this.j$b=!0)}}Qab(){return!0}Iga(Aa){this.Hya=Aa.Td.block.Ne;this.j$b=!1;this.qud()}AXa(Aa){this.$.ea.C7&&Aa&&(Aa.hu||(Aa.hu=new Se.a),Aa.hu.kj=new df.a(this.domElement.scrollLeft,this.domElement.scrollTop),Aa.hu.IMb=20)}clearCache(){this.Ca.hUa(this.hashCode);this.Hya=this.hashCode=null;this.j$b=!1}EWa(Aa,Eb){if(this.isVisible=!!Aa&&gf.o(Aa))this.hashCode=this.Ca.Pua(Aa,cf.a.lbc,this.hashCode),this.gEc(Eb)}static PJa(Aa){if(!Aa.da.Ba(34)){const Eb=Aa.og;Aa.da.Ja(34,
new $a(Aa,new te.a(Aa,Aa.ea,Aa.qa.Ol,3,0),Eb.appendChild(Eb.ownerDocument.createElement("div"))))}}}Object(c.a)($a,"WebExtensionView",fe.a,[785,207,2]);var Y=a(234),Ta=a(445),Bb=a(59),Rb=a(119),jc=a(51),vc=a(48),bb=a(168),Mb=a(116),hc=a(66),Cc=a(33),Wb=a(34),mc=a(231),Mc=a(23),hd=a(16),pd=a(248),Nd=a(761),Xd=a(55),ae=a(175),Ve=a(860);const we=Aa=>{ae.a.sendOtelEvent(Object.assign(new Ve.a,{otelEvent:Aa}))},Mf=Aa=>{ae.a.sendOtelCustomerContent(Object.assign(new Ve.a,{otelEvent:Aa}))};var Ye=a(912),
kf=a(27),Bf=a(118),vf=a(747);class Rf{constructor(Aa,Eb,cc){this.kzc=0;this.dve=new Set;this.Wtf=!1;this.$=Aa;this.gi=Eb;this.Rh=cc}H3g(Aa){1===Aa.actionType?this.gi.XL(65541,eb.a.FM)?this.kzc++:e.ULS.sendTraceTag(509649754,0,10,"AugmentationLoop AnnotationAdded event is not registered"):2===Aa.actionType&&0<this.kzc&&this.kzc--}wIf(Aa,Eb){if(0===this.kzc)e.ULS.sendTraceTag(509649753,0,50,"No event listeners. Event not fired.");else if(Eb){Aa=Eb.YB;var cc=[];cc.push({content:JSON.stringify(Eb.YB),
annotationType:vf.a.Fya(Aa),id:Aa.id});this.Rh.yG(65541,eb.a.FM,JSON.stringify({annotationProperties:cc}))}else e.ULS.sendTraceTag(509649752,0,10,"Event args are null")}wki(Aa){return Object(Bf.a)(this,void 0,void 0,function*(){if(!this.gi.XL(65541,eb.a.FM))e.ULS.sendTraceTag(509649751,0,10,"Event is not registered");else if(!this.dve.has(Aa.annotationType)){var Eb=sa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateAugmentationLoopToNewServiceInfra",!1)?yield sb.a.resolve(bc.f,{Wa:1}):
yield Ra.GetServiceTaskFactory.F0(this.$.da,328,327,1);sa.EwaSettings.isChangeGateEnabled("OfficeVSO:7694128_RichAPIUseNewALAPI")?(this.Wtf||(Eb.register(Eb.v0().S2("RichApi").P2(()=>{}).build()),this.Wtf=!0),Eb.K9("RichApi",{annotationType:Aa.annotationType,Tv:!1,WO:this.wIf.bind(this)})):(Eb.srb(Aa.annotationType),Eb.Nua(Aa.annotationType,this.wIf.bind(this)));this.dve.add(Aa.annotationType)}})}xki(Aa){return Object(Bf.a)(this,void 0,void 0,function*(){(sa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateAugmentationLoopToNewServiceInfra",
!1)?yield sb.a.resolve(bc.f,{Wa:1}):yield Ra.GetServiceTaskFactory.F0(this.$.da,328,327,1)).eTb(JSON.parse(Aa.content));e.ULS.sendTraceTag(509649750,0,100,`Submit operation for type: ${Aa.signalType}`)})}}Object(c.a)(Rf,"RichApiAugmentationLoopHandler",null,[]);a.d(C,"DdaFacade",function(){return re});class re extends pb.a{constructor(Aa,Eb,cc){super();this.Rh=this.Kk=this.ea=null;this.hg=[];this.pMa=null;this.disposed=this.initialized=this.XVb=this.uRe=!1;this.lFa=null;this.wwc=[];this.oRe=[];this.gTa=
[];this.k5a=null;this.MMd=new ja.a(J.a.hh());this.a5b=new S.a(J.a.hh());this.sMb=[];this.SVf=[];this.vxb=350;this.nAa=this.Iha=null;this.p0c=!1;this.FMc=this.mob=this.eqe=this.dqe=this.Upe=this.cqe=this.bqe=this.$pe=this.Wpe=this.aqe=this.Xpe=this.Zpe=this.Vpe=this.Ype=null;this.rg=()=>{this.lFa=this.ea.ao.WebExtensions;var pc=td=>sa.EwaSettings.ya(114)?!td.Awa:!0,Hc=td=>sa.EwaSettings.isChangeGateEnabled("OfficeVSO:7116850_fixDialogApiOsfControlDeletedBySheetLocking")?!td.RDi:!0;for(let td=this.hg.length-
1;0<=td;--td){let me=this.hg[td];!this.TTh(me.controlId)&&pc(me)&&Hc(me)&&(me.quc(),this.hg.splice(td,1))}if(this.lFa)for(let td=0,me=this.lFa.length;td<me;td++)pc=this.lFa[td],(Hc=this.Xn(pc.WebExtensionId))&&Hc.fKd(pc)};this.vvc=pc=>{this.raiseEvent("csc",pc.getID())};this.gLb=(pc,Hc,td)=>{if(Hc===OSF.AgaveHostAction.KeyboardShortcuts){var me=Object(lb.a)(Object,td);Hc={};Hc.keyCode=me.keyCode;Hc.type="keydown";Hc.ctrlKey=me.ctrlKey;Hc.shiftKey=me.shiftKey;Hc.altKey=me.altKey;Hc.metaKey=me.metaKey;
me=this.Xn(pc);pc=me.Sba;Hc.srcElement=Object(wb.a)(403,pc)?pc.zJa:Ha.h(this.$).Wc;pc=new Sys.UI.DomEvent(Hc);me=re.Qxa(me.Zl,this.$);Hc={};Hc.focusedAddinId=me;me=new Pb.a(1461300262,1,this.$.Tc,6,null);Ha.h(this.$).NPb(pc,me,Hc)}else if(Hc===OSF.AgaveHostAction.Select)this.ohf(!0);else if(Hc===OSF.AgaveHostAction.UnSelect)this.ohf(!1);else if(Hc===OSF.AgaveHostAction.CancelDialog)this.RL(-684355545,null);else if(Hc===OSF.AgaveHostAction.InsertAgave)pc={},td&&(this.mob=td,pc[ea.a.Dja]=td,pc[Tb.a.Og]=
this.owa(td),this.RL(-741808261,pc));else if(Hc===OSF.AgaveHostAction.ClickTrust)this.F3c&&td&&(this.mob=td);else if(Hc===OSF.AgaveHostAction.OsfControlLoad)this.F3c&&this.mob&&td&&this.L2g(this.mob,td)&&td.storeType&&(this.mob=null,this.mH(Sa.b(td.storeType)));else if(Hc===OSF.AgaveHostAction.InsertDevManifest)pc={},td&&(pc[ea.a.Dja]=td,pc[Tb.a.Og]=this.owa(td),this.RL(-741808261,pc));else if(Hc===OSF.AgaveHostAction.InsertDevManifestError)pc=Object(lb.a)(Object,td),pc={[ea.a.q3c]:this.Kk.getDevManifestInvalidUrlErrorString(pc.manifestUrl)},
this.RL(-2025863019,pc);else if(Hc===OSF.AgaveHostAction.NotifyHostError)pc={[ea.a.q3c]:this.Kk.getManifestInvaildErrorString()},this.RL(-2025863019,pc);else if(Hc===OSF.AgaveHostAction.RefreshAddinCommands)sa.EwaSettings.ya(52)&&this.RL(kf.a.refreshAddinCommands,null);else if(Hc===OSF.AgaveHostAction.CtrlF6Exit||Hc===OSF.AgaveHostAction.CtrlF6ExitShift){if(me=this.$.da.Ba(15)){(pc=this.Xn(pc).Sba)&&pc.yGc();t.a.Bg&&document.activeElement.blur();var ve={keyCode:117,type:"keydown",ctrlKey:!0};ve.shiftKey=
Hc===OSF.AgaveHostAction.CtrlF6ExitShift;ve.srcElement=Object(wb.a)(403,pc)?pc.zJa:Ha.h(this.$).Wc;pc=new Sys.UI.DomEvent(ve);me.Zoa(pc)}}else if(Hc===OSF.AgaveHostAction.PageIsReady){if((pc=this.Xn(pc).Sba)&&pc.X1a===OSF.OsfControlTarget.TaskPane&&(pc=this.$.da.Ba(183))&&this.hg){Hc=da.a.de();for(me of this.hg)re.KPa(me.AR)&&(Hc?pc.$g(!0,!1):pc.setFocusOnToolbarFirstElement())}}else if(Hc===OSF.AgaveHostAction.TabExit){Hc=this.Xn(pc);const nf=Hc.Sba;if(nf)if(nf.X1a===OSF.OsfControlTarget.InContent)nf.exf();
else{if(nf.X1a===OSF.OsfControlTarget.TaskPane)if(da.a.de())t.a.Bg&&document.activeElement.blur(),U.UISurfaces.nk().then(Cb=>{const ac=Object(wb.a)(403,nf)?nf:null;ac?ac.isResizable?Cb.focusResizeHandle():Cb.focusTabbedTaskPaneArea():Cb.focusTabbedTaskPaneArea();return null});else if(Hc=this.$.da.Ba(183))t.a.Bg&&document.activeElement.blur(),(pc=document.getElementById(this.$.qc+cb.a.Ftc))&&tb.DOMElementExtensions.isVisible(pc)?tb.DOMElementExtensions.setFocus(pc):Hc.setFocusOnToolbarFirstElement()}else Hc&&
4===Hc.osfControlType&&this.Kk.notifyAgave(pc,OSF.AgaveHostAction.TabIn)}else if(Hc===OSF.AgaveHostAction.TabExitShift)(Hc=this.Xn(pc),me=Hc.Sba)?me.X1a===OSF.OsfControlTarget.InContent?me.fxf():me.X1a===OSF.OsfControlTarget.TaskPane&&(pc=Object(wb.a)(403,me)?me:null)&&(t.a.Bg&&document.activeElement.blur(),pc.Ddg()):Hc&&4===Hc.osfControlType&&this.Kk.notifyAgave(pc,OSF.AgaveHostAction.TabIn);else if(Hc===OSF.AgaveHostAction.EscExit||Hc===OSF.AgaveHostAction.ExitNoFocusable||Hc===OSF.AgaveHostAction.ExitNoFocusableShift)if(me=
this.Xn(pc).Sba)me.yGc();else{if(Hc===OSF.AgaveHostAction.EscExit){Hc=null;for(ve of E.Qii())if(ve.value.ef===pc){ve.value.dialog.hide();Hc=ve.key;break}Hc&&(pc=this.Xn(Hc))&&4!==pc.osfControlType&&this.Xf.notifyAgave(Hc,OSF.AgaveHostAction.TabIn)}}else if(Hc===OSF.AgaveHostAction.InstallCustomFunctions)if(sa.EwaSettings.ya(114)){hc.a(this.$).T5e(()=>!1);var Qe=this.$.da;kb.TaskExtensions.za(Ra.GetServiceTaskFactory.Za(Qe,278,279,1),nf=>{nf=nf.result;Qe.Ba(278)||Qe.Ja(278,nf);const Cb=td.osfControl.getStoreType();
nf.Cnf(td.osfControl.getSolutionId(),Cb,re.Z3h(td.osfControl),td).cqa()},this.ka,3)}else e.ULS.sendTraceTag(537170577,0,10,"DdaFacade.OnOsfNotifyHost: Cannot install Custom Functions because this feature is not enabled.");else if(Hc===OSF.AgaveHostAction.UninstallCustomFunctions)if(sa.EwaSettings.ya(114)){hc.a(this.$).T5e(()=>!1);var Ze=this.$.da;kb.TaskExtensions.za(Ra.GetServiceTaskFactory.Za(Ze,278,279,1),nf=>{nf=nf.result;Ze.Ba(278)||Ze.Ja(278,nf);nf.Srg(td.solutionId,td.storeType).cqa()},this.ka,
3)}else e.ULS.sendTraceTag(537170574,0,10,"DdaFacade.OnOsfNotifyHost: Cannot uninstall Custom Functions because this feature is not enabled.");else Hc===OSF.AgaveHostAction.SendTelemetryEvent?we(td):Hc===OSF.AgaveHostAction.SendCustomerContent?Mf(td):Hc===OSF.AgaveHostAction.LaunchExtensionComponent?f.a.instance.GMi(td):Hc===OSF.AgaveHostAction.RefreshRibbonGallery?(pc=this.$.da.Ba(519))&&pc.rrd(td):Hc===OSF.AgaveHostAction.RemoveAppCommandsAddin?(this.cxj(td.solutionId),da.a.de()||(pc=this.$.da.Ba(183))&&
pc.mD()):Hc===OSF.AgaveHostAction.GetOriginalControlId&&(pc=new Ia.a(this.$.qc,td.ownerAddinSolutionId,new Da.a,!0),td.originalControlId=pc?pc.HRe(td.controlId):td.controlId)};this.EKj=(pc,Hc)=>{const td=Array(2);td[0]=Hc;td[1]=null;this.Rh.dUh(pc,JSON.stringify(td))};this.pej=()=>{this.$.na&&gf.o(this.$.na)&&this.$.da.Ba(34).qud()};this.ee=()=>{this.kzf()};this.dT=(pc,Hc)=>{var td,me;1===Hc.Yr&&(pc=Hc.Cg)&&(Hc=new qe(Mb.toTimestamp(pc.enqueueUtcTime),Mb.toTimestamp(pc.processUtcTime),Mb.toTimestamp(pc.dequeueUtcTime),
Mb.getElapsedMilliseconds(pc.enqueueUtcTime,pc.processUtcTime),Mb.getElapsedMilliseconds(pc.processUtcTime,pc.dequeueUtcTime),pc.operationCount,(null===(me=null===(td=pc.operation)||void 0===td?void 0:td.me)||void 0===me?0:me.ServerCorrelationId)?pc.operation.me.ServerCorrelationId:null,pc.operation?Enum.toString(Ta.a,pc.operation.operationName):null,Nd.a.HE(Mb.getElapsedMilliseconds(pc.enqueueUtcTime,Cc.a.Lb.Mc))),td=Sys.Serialization.JavaScriptSerializer.serialize(Hc),e.ULS.sendTraceTag(50872916,
0,50,td))};this.Md=(pc,Hc)=>{!this.ea.Oc&&Y.a(Hc)?(Array.forEach(this.hg,this.JKf),this.hg.length=0,this.XVb=!1):(Hc.QG&&(e.ULS.sendTraceTag(537170516,0,50,"Silent Reload require reset osf controls."),this.Z7f()),this.CM(),sa.EwaSettings.isChangeGateEnabled("OfficeVSO:4058224_ResetWorkbookContextLoadedAfterSilentReload")&&(this.XVb=!1))};this.ho=()=>{sa.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(e.ULS.sendTraceTag(537170515,0,50,"Load on demand occurred require reset osf controls."),
this.Z7f());this.CM();sa.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(this.XVb=!1)};this.JKf=pc=>{pc.quc();this.raiseEvent("cd",pc.controlId)};this.Ub=Aa;this.I3c=Eb;this.initialize(cc);mb.la(this);this.k9f=0;(Aa=(Aa=!(t.a.rq||t.a.f1))&&!t.a.Bg)&&OfficeExt.ShortcutKeyDispatchManager.init();this.WIg={}}get j6b(){return this.Iha||(this.Iha=new ma.a(this.$.Hw))}Xxe(Aa){this.addHandler("cd",Aa)}cyj(Aa){this.removeHandler("cd",Aa)}NWg(Aa){this.addHandler("csc",
Aa)}eyj(Aa){this.removeHandler("csc",Aa)}KWg(Aa){this.addHandler("ca",Aa)}byj(Aa){this.removeHandler("ca",Aa)}LWg(Aa){this.addHandler("ci",Aa)}MWg(Aa){this.addHandler("ekros",Aa)}dyj(Aa){this.removeHandler("ekros",Aa)}oMd(Aa,Eb){try{return JSON.parse(Aa)[Eb].toLowerCase()}catch(cc){return""}}CTj(Aa){const Eb=this.oMd(Aa,"AudienceGroup"),cc=this.oMd(Aa,"SessionOrigin");try{const pc=parseInt(this.oMd(Aa,"Ring"),10);if("automation"!==Eb&&"bluechicken"!==cc&&-2<=pc)return!0}catch(pc){if("automation"!==
Eb&&"bluechicken"!==cc)return!0}return!1}get Xf(){if(!this.Kk){const Aa={},Eb=!(this.$.oe&1),cc=tc.a.current.sM,pc=this.$.workbookContext,Hc=ra.a.PM+ra.a.F9b;Aa.pageBaseUrl=cc.LayoutsContentUrlPrefix;Aa.appName=OSF.AppName.ExcelWebApp;Aa.appVersion="16";Aa.appSettings=this.$7h();Aa.singleSignOnSettings=I.AppsForOfficeSingleSignOnManager.nfi();Aa.clientMode=Eb?OSF.ClientMode.ReadOnly:OSF.ClientMode.ReadWrite;Aa.appUILocale=this.$.xa.UICultureTag;Aa.dataLocale=this.$.xa.DataCultureTag;Aa.docUrl=pc.ClientUrl;
Aa.hostControl=this;Aa.formFactor=OSF.FormFactor.Default;Aa.lcid=this.$.sF.toString();Aa.localizedScriptsUrl=ra.a.PM+ra.a.i$c;Aa.localizedImagesUrl=Hc;Aa.localizedStylesUrl=ra.a.PM+ra.a.wMe;Aa.localizedResourcesUrl=Hc;Aa.osfOmexBaseUrl=cc.OsfOmexBaseUrl;Aa.firstPartyManifestCDNUrl=cc.FirstPartyAddInManifestCDN;Aa.sdxAssetsToPrefetchMapping=w.AFrameworkApplication.fa.Va("SdxAssetsToPrefetchMapping");Aa.sdxCdnUrl=cc.SdxCdnUrl;Aa.sdxDmsUrl=cc.SdxDmsUrl;Aa.devCatalogUrl=cc.DevCatalogUrl;Aa.controlStatusChanged=
this.vvc;Aa.notifyHost=this.gLb;Aa.allowExternalMarketplace=this.$.ea.Dh.get(27)&&re.s$b;Aa.enableAddinCommands=sa.EwaSettings.ya(52);Aa.enableBlackForestRedirect=sa.EwaSettings.ya(87);Aa.enableMyOrg=this.$.ea.Dh.get(33);Aa.enableMyApps=this.$.ea.Dh.get(34);Aa.enableDevCatalog=sa.EwaSettings.ya(43);Aa.enablePrivateCatalog=this.yUj();Aa.showSignOutFromPrivateCatalogMessage=this.$.ea.Dh.get(36);Aa.enableUploadFileDevCatalog=sa.EwaSettings.ya(52)&&!sa.EwaSettings.ya(254);Aa.userNameHashCode=M.a.Av(w.AFrameworkApplication.userName);
Aa.envCode=this.$.xa.OfficeAddinTelemetryDataSourceCode.toString();Aa.enableSingleSignOnForAddin=!sa.EwaSettings.ya(23)&&w.AFrameworkApplication.isAppsForOfficeSingleSignOnSupportedOnHost;Aa.enableDisplayBlockedMinorError=sa.EwaSettings.ya(171);Aa.hideAppsExtensionUrl=w.AFrameworkApplication.hideAppsExtensionUrl;Aa.enableAnonymousUseLegacyCatalogService=sa.EwaSettings.ya(162);Aa.enableInsertDialogAccessibilityFix=sa.EwaSettings.ya(169);Aa.disableAppsForOfficeThirdParty=sa.EwaSettings.ya(174);Aa.enableFirstPartySSO=
sa.EwaSettings.ya(186);Aa.wacSessionId=this.$.xa.UserSessionId;Aa.disableLogging=!this.$.xa.AriaLoggingIsEnabled;Aa.enableFirstPartySDXErrorMessages=sa.EwaSettings.ya(198);Aa.enableRichApiCellEditDelay=sa.EwaSettings.ya(178);Aa.isHostDocumentDomain=sa.EwaSettings.ya(209);Aa.loggableUserId=w.AFrameworkApplication.fa.Va("LoggableUserId");Aa.sessionStartInfoJson=w.AFrameworkApplication.fa.Va("SessionStartInfoJson");Aa.wopiHostOriginFromPostMessage=w.AFrameworkApplication.wopiHostOriginFromPostMessage;
Aa.wopiHostOriginFromWacPropBag=w.AFrameworkApplication.fa.Va("PostMessageOrigin");Aa.wacIsEmbedded=w.AFrameworkApplication.fa.ra("IsEmbedded");Aa.accessibilityAllowFocusAddinTaskpane=w.AFrameworkApplication.fa.ra("AccessibilityAllowFocusAddinTaskpane");Aa.enableRemoveAppCommandsAddin=w.AFrameworkApplication.fa.ra("RemoveAppCommandsAddinIsEnabled");Aa.isHostFrameTrustCheckEnabledForAddIns=w.AFrameworkApplication.fa.ra("HostFrameTrustCheckIsEnabledForAddIns");Aa.isHostFrameTrusted=w.AFrameworkApplication.isHostFrameTrusted;
Aa.agaveAddinUploadEnabled=sa.EwaSettings.ya(45);Aa.hostAllowedOfficeStore=w.AFrameworkApplication.fa.ra("HostAllowedOfficeStore");Aa.hostAllowedSdxEmbedding=w.AFrameworkApplication.fa.ra("HostAllowedSdxEmbedding");Aa.hostInstallAddIns=w.AFrameworkApplication.fa.Va("HostInstallAddIns");Aa.hostInstallAddInsIsEnabled=w.AFrameworkApplication.fa.ra("HostInstallAddInsIsEnabled");Aa.approvedAddIns=w.AFrameworkApplication.fa.Va("ApprovedAddIns");Aa.addinEnforceHttpsIsEnabled=this.CTj(Aa.sessionStartInfoJson);
Aa.hostFeatureGateFlag=0;Aa.isUpnCheckEnabled=w.AFrameworkApplication.fa.ra("IsUpnCheckEnabled");Aa.wacUpn=w.AFrameworkApplication.fa.Va("UserPrincipalName");Aa.isReactRibbonEnabled=da.a.isReactRibbonEnabled();Aa.enableSetFocusOnTaskpaneOnUserAction=sa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",!1);Aa.isSafariWithIndexedDBDisabled=sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&t.a.xQa;Aa.isIndexedDBDisabled=
sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&t.a.xQa||sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5735286_IDBBuggedInFirefox")&&t.a.Bg;Aa.enableCustomShortcuts=!0;Aa.changeGetModifierKeyStringOutputOrder=sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5426302_ChangeGetModifierKeyStringOutputOrder");Aa.officeJsUrl=w.AFrameworkApplication.zT("OfficeJs/excel.js",5);Aa.enableOfficeJsUrlParam=sa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableOfficeJsUrlParam",
!1);this.Kk=new OSF.ContextActivationManager(Aa);this.Kk.setIframeAttributeBag({["frameborder"]:0,["marginheight"]:0,["marginwidth"]:0});this.Kk.setWSA(w.AFrameworkApplication.Jm);this.Kk&&"undefined"!==typeof this.Kk.hostCheckReadyHandler&&w.AFrameworkApplication.IXg(Object(d.a)(this.Kk,this.Kk.hostCheckReadyHandler,"hostCheckReadyHandler"));try{const td=Va.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.Kk.setOAuthManager(td)}catch(td){}}return this.Kk}get llk(){return this.p0c}get gi(){return this.Ype}get Zpa(){return this.Vpe}get oVd(){return this.Zpe}get nVd(){return this.Xpe}get xFj(){return this.aqe}get vFj(){return this.Wpe}get wFj(){return this.$pe}get yFj(){return this.bqe}get zFj(){return this.cqe}get pVd(){return this.dqe}get j9f(){return this.eqe}get ZW(){return this.WIg}get $(){return this.Ub}get mVd(){return this.Upe}Q6b(Aa){const Eb=
{};Eb.Name=Aa.Name;Eb.BindingType=Aa.BindingType;Eb.HasHeaders=Aa.HasHeaders;Aa.IsValidRef&&(Eb.ColCount=Aa.Reference.LastColumn-Aa.Reference.FirstColumn+1,Eb.RowCount=Aa.Reference.LastRow-Aa.Reference.FirstRow+1);return Eb}get r3c(){return w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)}wyf(Aa,Eb){const cc=this.S7g(Eb);
let pc=null;if(w.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:7073634_TellMeLaunchAddinDialogSetTabIdEnabled")&&sa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",!1)&&null!==Eb&&"LaunchAddinDialogFromTellMe"===Eb[0])null!==cc.assetId&&"undefined"!==typeof cc.assetId&&(pc="{98143890-AC66-440E-A448-ED8771A02D52}");else if(this.r3c){const Hc=this.$.ea.Dh.get(27);Hc&&null!==Eb&&"InsertMoreAddInsFromFooter"===Eb[0]?pc="{98143890-AC66-440E-A448-ED8771A02D52}":
Hc&&null!==Eb&&"AddinFlyoutMoreButton"===Eb[0]&&(pc="0")}this.Kk.launchInsertDialog(Aa,pc,cc)}get Bba(){return this.Csb}get Csb(){this.F3c&&!this.FMc&&(this.FMc=Ua.createInstance(w.AFrameworkApplication.fa,new Ab.a(()=>this.Kk),{["AppsForOfficeAllowExternalMarketplace"]:this.allowExternalMarketplace,["AppsForOfficeThirdPartyIsDisabled"]:this.p6j,["AreThirdPartyAddInsAllowed"]:this.$.nV,["PopularAddinDetailsJsonString"]:re.iCa,["UICulture"]:w.AFrameworkApplication.uiCulture}));return this.FMc}get p6j(){return sa.EwaSettings.ya(174)}get allowExternalMarketplace(){return this.$.ea.Dh.get(27)}get F3c(){return w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",
!1)}static get iCa(){return'[{"displayName":"Bing Maps","solutionId":"wa102957661","version":"1.5.0.0","targetType":0,"width":600,"height":600,"description":"The Bing Maps add-in makes it easy to plot locations and visualize your data through Bing Maps in Excel","iconUrl":"45.d6c30518-91f7-4e79-b846-0813b56a1b2d.75cc16b5-7155-4a84-8094-a4ae7e997116.688fcadb-9dca-414b-91d4-2075b00c2772.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":1,"AUP":1770,"downloadNumber":3723306}},{"displayName":"Mini Calendar and Date Picker","solutionId":"wa102957665","version":"1.3.0.0","targetType":0,"width":240,"height":220,"description":"Add a mini monthly calendar to your spreadsheet and use it to insert dates or the current time.","iconUrl":"31013.352a833c-760b-49ee-b384-f9718a71d650.3966871d-bbca-4abd-996d-777127e5f717.aac00a7f-336d-4d49-9fbb-f41bc3db4515.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.vertex42.com/privacy.html","addinInfo":{"priority":1,"AUP":20064,"downloadNumber":3787515}},{"displayName":"Bubbles","solutionId":"wa103147117","version":"1.1.0.0","targetType":0,"width":500,"height":500,"description":"Visualize your data in a fun and interactive way using bubbles to quickly identify patterns.","iconUrl":"6406.490601bf-78b6-49e5-be4f-e671fe712516.9fc1cb98-b071-4854-918e-40a0d2c7a467.49ae5470-5b06-4fa6-8762-6977e397810a.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://roljs.azurewebsites.net/bubbles-privacy-statement","addinInfo":{"priority":1,"AUP":40,"downloadNumber":7547}},{"displayName":"Geographic Heat Map","solutionId":"wa103304320","version":"1.1.0.0","targetType":0,"width":480,"height":350,"description":"This app will help you visualize data across geographic locations. It\'s simply formatting on a map.","iconUrl":"33870.9aae8635-7790-49e5-9809-7704d4347793.cf84e746-9ce3-4a9a-83c5-4efc8117bc45.2cdca20b-36a0-45d8-bc0e-859ce6e806da.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"","addinInfo":{"priority":-1,"AUP":359,"downloadNumber":88214}},{"displayName":"QR4Office","solutionId":"wa104051163","version":"1.2.0.3","targetType":1,"width":0,"height":0,"description":"A first-of-its-kind QR-generator that integrates seamlessly into your Office documents.","iconUrl":"53638.20ce8aca-39c5-4b97-b87a-47d0f3e21e0d.0b60ea0f-7e02-4465-baeb-bb55c723d670.9147ef8e-cf16-47cf-af10-ef553e88804d.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://q.michaelzlat.com/","addinInfo":{"priority":1,"AUP":1369,"downloadNumber":5211012}},{"displayName":"Wikipedia","solutionId":"wa104099688","version":"1.4.0.0","targetType":1,"width":0,"height":0,"description":"Find and quote related information from Wikipedia.","iconUrl":"7450.110c9a11-7db2-4228-b768-f1ad828e16be.9bd16ea2-22ff-455c-9f92-70de827e079a.aeef7210-898b-4a79-82b5-b648805129b9.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949674774/Asset_733b35d6-e5e0-4163-b45d-3396185864bd/WIKIPEDIAAPPFOROFFICELICENSETE.docx","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":2,"AUP":368,"downloadNumber":1946395}},{"displayName":"Solver","solutionId":"wa104100404","version":"3.0.0.1","targetType":1,"width":0,"height":0,"description":"Solve optimization models in Excel Online and Excel on iPad, upward compatible from Solver in Excel.","iconUrl":"37315.adb6ef87-ef0f-4f99-b639-c08a45950b58.cb56fe0c-c385-43b5-8c1b-88701ddbb898.c5239aae-28c3-4dec-8338-e6c0ceef5b82.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836842/Product_42949683093/Asset_5ef7a7a3-cb57-4c16-8fe4-6032d115bc04/FrontlineSystemsSoftwareLicens.pdf","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-solver-app","addinInfo":{"priority":1,"AUP":3146,"downloadNumber":1177320}},{"displayName":"People Graph","solutionId":"wa104104476","version":"1.4.0.0","targetType":0,"width":580,"height":400,"description":"Transform cold data into a cool picture.","iconUrl":"49387.7b82fde0-3b87-471f-a121-86215bd4c0d4.5c5551ff-1f1c-4fdd-83a0-9a311307f989.b07f3a4e-26ca-4174-83e2-a8953ecb5eb6.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949674809/Asset_488b8377-7de8-40ce-82ca-0a2fd48220dd/PEOPLEGRAPHAPPFOROFFICELICENSE.docx","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":1,"AUP":1364,"downloadNumber":8198147}},{"displayName":"E2D3","solutionId":"wa104379169","version":"2.0.1.0","targetType":0,"width":800,"height":680,"description":"Create dynamic and interactive graphs on Excel","iconUrl":"1677.6b2891ac-505f-41cc-80f6-db53a4274b85.62a2ad24-69c3-41ae-9419-bd700be3f626.67a1d711-d2ca-4e12-94b8-49464dc829ec.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://e2d3.org/privacy","addinInfo":{"priority":1,"AUP":68,"downloadNumber":36590}},{"displayName":"XLMiner Analysis ToolPak","solutionId":"wa104379190","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Statistical analysis in Excel Online, with functions matching the Analysis ToolPak in desktop Excel.","iconUrl":"2225.9cbf413e-e33f-4be9-90ef-2fdb353c52a1.6e475dbb-9ae3-4b89-ae41-004faa21a088.e9552e6b-53ec-4728-ba49-ba04757c6dd0.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-analysis-toolpak-app","addinInfo":{"priority":3,"AUP":6262,"downloadNumber":543258}},{"displayName":"Stock Connector","solutionId":"wa104379220","version":"8.0.0.0","targetType":1,"width":0,"height":0,"description":"Link stocks, currency, & crypto prices to cells in Excel spreadsheets and update them in real time.","iconUrl":"35421.d104d786-d979-48bb-9827-1b28ac5178cf.c0696ae0-87b8-4c16-ab8c-171be18ca0a9.8dcfdc9c-2863-4fa9-905d-84ff8534af7a.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://michael-saunders.com/stocksapp/pages/privacy.html","addinInfo":{"priority":1,"AUP":1710,"downloadNumber":109178}},{"displayName":"Symbols and Characters - Fast Symbol Lookup","solutionId":"wa104379279","version":"2.1.0.0","targetType":1,"width":0,"height":0,"description":"Symbols and characters | Fast symbol and emoticon search with convenient auto-lookup","iconUrl":"53409.631e9a68-2435-4716-b1b8-dc48b99d3f85.d2f9c29f-cf48-4dcc-8202-fcbc5e4d1482.0216011c-2369-4ee7-8351-ac51d77015c2.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.tec-it.com/en/legalconditions/Default.aspx","addinInfo":{"priority":1,"AUP":673,"downloadNumber":304226}},{"displayName":"Microsoft Dynamics Office Add-in","solutionId":"wa104379629","version":"1.3.0.0","targetType":1,"width":0,"height":0,"description":"The Microsoft Dynamics Office Add-in enables data connections to Microsoft Dynamics systems.","iconUrl":"2287.eac0bf67-c34b-4302-aaa9-a07c1e560721.16c405d8-e48b-42e1-ac8f-7c402b8ae0d1.5ce79e5f-d108-48a7-b34b-75c71b620973.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949677398/Asset_e3871df6-665b-4927-a7fe-cd9e228611cc/LCSTermsofUseFinalFebruary2016.pdf","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=271135","addinInfo":{"priority":2,"AUP":2790,"downloadNumber":3737454}},{"displayName":"officeatwork | Template Chooser for Office - M365","solutionId":"wa104380050","version":"3.4.0.0","targetType":1,"width":0,"height":0,"description":"Access your centrally shared templates in Office, Teams, SharePoint Online, and other Apps.","iconUrl":"21517.40f3490e-24f2-4502-9a44-28e543d36a75.cc0236b1-594c-49ad-9462-3f787be3cd4f.f383d0e6-2de8-4367-9108-e62781456dad","licenseUrl":"https://links.officeatwork.com/officeatwork-licenseterms","privacyUrl":"https://links.officeatwork.com/officeatwork-privacypolicy","addinInfo":{"priority":1,"AUP":588,"downloadNumber":525805}},{"displayName":"Lucidchart Diagrams for Excel","solutionId":"wa104380194","version":"1.1.2.0","targetType":1,"width":0,"height":0,"description":"The easiest way to draw and insert flowcharts, mockups, UML, mind maps and more in Office documents.","iconUrl":"21470.3fa72610-07ba-489f-b48f-1fcb5ca4253a.fc3d89ad-c9dc-445c-9baa-074b7b8f0cfb.9bc93e17-dd72-4215-b8b0-0cf81a3d9925.png","licenseUrl":"https://www.lucidchart.com/pages/tos","privacyUrl":"https://www.lucidchart.com/pages/privacy","addinInfo":{"priority":3,"AUP":358,"downloadNumber":895006}},{"displayName":"Microsoft PowerApps Office Add-in","solutionId":"wa104380330","version":"1.3.0.1","targetType":1,"width":0,"height":0,"description":"The Microsoft PowerApps Office Add-in enables data connections to Microsoft PowerApps systems","iconUrl":"60124.e1dfe8b1-6892-4a07-bb52-91fc1006be11.a6787a94-2200-4943-9d6a-f9efb8369662.47ff6184-6b13-4120-955b-1c285e83cbc7.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949679879/Asset_661a2a7f-2764-43c5-aef4-25bc316a1b08/DynamicsAppforOfficeSLTEnglish.pdf","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=271135","addinInfo":{"priority":2,"AUP":597,"downloadNumber":4268442}},{"displayName":"Adobe Acrobat for Microsoft Word, Excel, and PowerPoint","solutionId":"wa104380526","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Do more with enterprise PDF tools, built right into your favorite Microsoft 365 apps.","iconUrl":"832.4553b45a-c9b7-42b8-9c57-e33b57f5df4d.80d83ec3-4ec7-4f7d-b45f-36b1f0c05e78.3d5b10f9-0a9c-4ac1-84fc-b7439dfb4f35.png","licenseUrl":"https://www.adobe.com/go/terms_en","privacyUrl":"https://www.adobe.com/go/privacy_policy_en","addinInfo":{"priority":1,"AUP":1812,"downloadNumber":3103601}},{"displayName":"ChartExpo\u2122 for Excel","solutionId":"wa104380662","version":"1.0.0.7","targetType":0,"width":655,"height":390,"description":"Select a chart, select your data, and create Insightful charts without hardwork!","iconUrl":"47793.590471af-7e3e-4855-8e7f-1438a654488b.5e466c13-5861-4e47-bf0e-d6a735f06208.7800aa4f-c6b6-43bb-8099-c14624743abc.png","licenseUrl":"https://www.chartexpo.com/Home/EULA","privacyUrl":"https://www.chartexpo.com/Home/OfficeAppPrivacy","addinInfo":{"priority":1,"AUP":434,"downloadNumber":95967}},{"displayName":"Facebook Ads Manager for Excel","solutionId":"wa104380711","version":"1.0.0.2","targetType":1,"width":0,"height":0,"description":"The fastest way to view performance data for all of your Facebook ad accounts.","iconUrl":"47990.d08ffb67-b1f0-4ef6-ac6f-4b5379c5d285.a5cb5ec2-3726-4cf0-ae84-5d8ee7ee3439.3af0d784-7a14-4e39-897b-24e4e633fb76.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.facebook.com/about/privacy","addinInfo":{"priority":3,"AUP":353,"downloadNumber":25753}},{"displayName":"Script Lab, a Microsoft Garage project","solutionId":"wa104380862","version":"1.5.0.0","targetType":1,"width":0,"height":0,"description":"Create, run, and share your Office Add-in code snippets from within Excel, Word, or PowerPoint.","iconUrl":"52703.9fd54003-f1a2-4196-a8a8-ea11bec509a8.9b4da1d4-cb1c-46e6-9463-8a258eb273e6.b5c7baa9-2a17-4db7-b0dd-ca9dea75bd27.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":-1,"AUP":1299,"downloadNumber":177312}},{"displayName":"Excel-to-Word Document Automation","solutionId":"wa104380955","version":"3.16.2.1","targetType":1,"width":0,"height":0,"description":"Update Word and PowerPoint documents from Excel data, calculations, text, tables, and charts.","iconUrl":"44742.554108a6-3275-4065-9a18-887d38776dca.31f4b432-c6cb-49c5-9fba-56c194301365.e534a91d-b3f5-445e-bdbd-1559dbb4b396.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://analysisplace.com/Privacy","addinInfo":{"priority":3,"AUP":371,"downloadNumber":149144}},{"displayName":"Journal Entry Batch Creator for Financial Edge NXT","solutionId":"wa104380978","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Create new journal entry batches in Financial Edge NXT via Excel (for existing customers)","iconUrl":"10843.146167ad-49b2-41d3-aff7-76ed38a0ea33.da610372-55d7-45b3-9134-1aa080eaa154.adce15a7-2cb2-4d79-90f8-6888df00287e.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.blackbaud.com/privacy-shield","addinInfo":{"priority":3,"AUP":297,"downloadNumber":60607}},{"displayName":"Mobile Data Collection - Scan-IT to Office","solutionId":"wa104381026","version":"1.2.0.0","targetType":1,"width":0,"height":0,"description":"Real-time mobile data collection and barcode scanning for Excel and Word ","iconUrl":"7989.6963e6f3-4ebf-4a63-82b7-734a5a002866.814dcb0f-f024-477c-9b9b-9407aef3d56a.a4027334-e000-4b89-bd22-18d0d906a688.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.tec-it.com/en/website/legalconditions/Default.aspx#Privacy","addinInfo":{"priority":3,"AUP":935,"downloadNumber":357671}},{"displayName":"Functions Translator, a Microsoft Garage project","solutionId":"wa104381504","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Translate the Excel functions and formulas between different languages","iconUrl":"6460.beedf6f4-7724-4c03-8e90-d6cc7d58e77c.a85b2258-a967-4d48-898f-a8db56e4d9c6.1b6557bd-4e89-4bad-a3d7-0ad2f0f0ee55.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://go.microsoft.com/fwlink/p/?LinkId=123161","addinInfo":{"priority":2,"AUP":1421,"downloadNumber":977902}},{"displayName":"Cryptosheets","solutionId":"wa104381695","version":"1.0.10.0","targetType":1,"width":0,"height":0,"description":"The easiest way to pull live, real-time, and historical cryptocurrency data directly into a sheet.","iconUrl":"44479.63cc4a83-c6d9-41b8-ab03-721c5071695c.9ab58e20-a9a3-4915-8ece-423d1fbe8e5f.af1fbf7c-11e4-4278-a726-d902df022e8c.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://cryptosheets.com/privacy","addinInfo":{"priority":3,"AUP":373,"downloadNumber":75023}},{"displayName":"Microsoft Power Automate for Excel","solutionId":"wa104381701","version":"1.0.0.4","targetType":1,"width":0,"height":0,"description":"Automate repetitive tasks by integrating your favorite apps and services with Power Automate.","iconUrl":"24472.5327e164-9595-41b5-94b6-dc524c42d5f6.318749ea-0f55-45b9-aee5-b89aae584a0c.73475625-266a-4866-b041-d9536d4673bb.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":2,"AUP":8162,"downloadNumber":2009209}},{"displayName":"Tiller Money Feeds","solutionId":"wa104381717","version":"1.0.3.0","targetType":1,"width":0,"height":0,"description":"Manage your money, your way with the most powerful automated personal finance service for Excel.","iconUrl":"57987.b83fa962-bb4f-4dd1-89e2-6b40f8b0a724.95198c12-4345-4728-b4c6-d3e76bb58555.affa1083-0e0c-4cf9-b006-636291dae421.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.tillerhq.com/privacy","addinInfo":{"priority":1,"AUP":192,"downloadNumber":15361}},{"displayName":"FYI for Office","solutionId":"wa104381841","version":"1.0.2.2","targetType":1,"width":0,"height":0,"description":"Standardise your output and enforce filing across your practice with FYI.","iconUrl":"55705.a91d847f-3878-41c0-90a2-1a25491d561e.6ece2a38-0dd7-4c23-abd0-2d418443543e.4218a512-bae0-420b-b293-2194a885c9aa.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474848155/Product_42949682443/Asset_5cb37a96-0b6a-4b64-bbf2-fa24ee29cec5/eula.pdf","privacyUrl":"https://www.fyidocs.com/privacy","addinInfo":{"priority":2,"AUP":696,"downloadNumber":12047}},{"displayName":"VitalTax | Making Tax Digital (MTD) for VAT","solutionId":"wa104381859","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Submit your VAT return directly from Excel and digitally link your data to HMRC","iconUrl":"10434.1d05b34e-479a-4769-bf99-07b416b11cbc.482ef49e-8635-4bfe-bb8d-e5ce4a2a4e61.be642c2c-717a-424c-96d8-8cea91a28e75.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474848420/Product_42949682533/Asset_28a3de04-adcc-4a88-8d42-b3493d67599a/ENDUSERLICENSEAGREEMENT.docx","privacyUrl":"https://vitaltax.uk/privacy-policy","addinInfo":{"priority":1,"AUP":382,"downloadNumber":18570}},{"displayName":"Microsoft Visio Data Visualizer","solutionId":"wa104381973","version":"1.0.0.4","targetType":0,"width":732,"height":448,"description":"Quickly and easily visualize your data into polished Visio diagrams within Excel.","iconUrl":"28591.0bb30ee2-d030-40d4-ba7e-3cb028cacb85.45958ca1-0858-42f7-9002-36ecaceadb38.84405685-1ffe-4d1d-9782-069079dc8d28.png","licenseUrl":"https://visio.officeapps.live.com/va/resources/licenseterms.html","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":1,"AUP":10559,"downloadNumber":11584101}},{"displayName":"XL-Connector 365","solutionId":"wa104382023","version":"2.0.0.1","targetType":1,"width":0,"height":0,"description":"Salesforce connector for Microsoft Office Online and Microsoft Office for Mac","iconUrl":"22105.87e56e91-0218-41b6-baf7-cd6d66ed7064.2132bae0-8ca0-4c27-ba4c-949cf6364791.f1ed243e-17f7-41ff-b99a-341d95cc8088.gif","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.xappex.com/docs/xl-connector-365-docs/xl-connector-365-privacy-policy","addinInfo":{"priority":-1,"AUP":1674,"downloadNumber":52744}},{"displayName":"Analytic Solver","solutionId":"wa200000018","version":"23.1.0.0","targetType":1,"width":0,"height":0,"description":"Analyze risk, find the best way to allocate resources using Monte Carlo Simulation and Optimization","iconUrl":"13898.dda126ef-5dd2-44ef-b6bc-a6cb0309f3a1.5b43104b-37e9-4650-8c16-71e032e6cb7d.e1dd0809-9020-4553-ba59-1479f07f4705.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836842/Product_42949683093/Asset_5ef7a7a3-cb57-4c16-8fe4-6032d115bc04/FrontlineSystemsSoftwareLicens.pdf","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-solver-app","addinInfo":{"priority":2,"AUP":1315,"downloadNumber":437152}},{"displayName":"Analytic Solver Data Mining","solutionId":"wa200000019","version":"23.1.0.0","targetType":1,"width":0,"height":0,"description":"Forecast the future, train and deploy predictive models using Data/Text Mining and Machine Learning","iconUrl":"34090.1ece6668-5136-4cbf-8b60-e7747688efc8.cfabfded-2a53-4b39-9eda-001adba2da25.c6775c6d-8ebd-4525-90d6-1304a00887d8.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836842/Product_42949683094/Asset_8b514640-453a-4c63-9e63-d0c3f2b29f37/FrontlineSystemsSoftwareLicens.pdf","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-solver-app","addinInfo":{"priority":-1,"AUP":640,"downloadNumber":151171}},{"displayName":"draw.io Diagrams","solutionId":"wa200000113","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Easily embed draw.io diagrams from cloud storage","iconUrl":"14142.2ec57164-ba5b-42ee-8253-ade72ca74c8d.e8efbcc8-e27f-4682-9321-eb111eb3bc68.950e1c22-0dd9-4079-807b-145ecdb6df9c.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474849055/Product_42949683254/Asset_f99133a0-53c0-4c21-905f-757b27070c6a/drawioEULATermsofServicedrawio.pdf","privacyUrl":"https://desk.draw.io/support/solutions/articles/16000096192-privacy-policy-for-draw-io-add-in-for-microsoft-office","addinInfo":{"priority":2,"AUP":441,"downloadNumber":992110}},{"displayName":"SAP Analytics Cloud for Office","solutionId":"wa200000169","version":"1.15.0.0","targetType":1,"width":0,"height":0,"description":"Use Microsoft Excel\u2019s strengths to get deeper insights into your SAP Analytics Cloud data.","iconUrl":"22967.ffbd93af-2e67-49da-bff8-62f9e5029e69.9930b4d4-9fd9-4eac-8578-8c77ca3d7e15.3a9c2449-9616-45b4-83e5-2f8360c19338.png","licenseUrl":"https://hcs.cloud.sap/office/eula.html","privacyUrl":"https://www.sap.com/about/legal/privacy.html","addinInfo":{"priority":2,"AUP":1112,"downloadNumber":583228}},{"displayName":"iServer365 Import Tool","solutionId":"wa200000421","version":"2.1.4.7","targetType":1,"width":0,"height":0,"description":"Import data from Excel Workbooks to your iServer365 Repository","iconUrl":"31253.df1e5367-d9bc-46a7-8259-9b24225f294e.24914354-af15-4aa0-8ead-1c9d3e44a16d.8c184953-6f7c-4728-add7-e9aa9aa1c7a1.png","licenseUrl":"https://www.orbussoftware.com/orbus-store-app-terms","privacyUrl":"https://www.orbussoftware.com/privacy-policy","addinInfo":{"priority":3,"AUP":471,"downloadNumber":207947}},{"displayName":"Jira Cloud for Excel","solutionId":"wa200000556","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Export Jira data to Excel - Combine the power of Jira with the flexibility of Excel","iconUrl":"56884.e2ba98e8-580f-430a-a0f6-2d54d53d7762.fb12baec-4bec-40e4-8dfc-21c060e87964.7ef37c2b-d095-4918-89f1-25637b11e385.png","licenseUrl":"https://www.microsoft.com/en-us/store/standard-application-license-terms","privacyUrl":"https://www.atlassian.com/legal/privacy-policy","addinInfo":{"priority":2,"AUP":83858,"downloadNumber":1824830}},{"displayName":"Refinitiv Add-in","solutionId":"wa200000565","version":"1.0.0.58","targetType":1,"width":0,"height":0,"description":"Build your models in Excel using Refinitiv\u2019s unique content and analytics","iconUrl":"22646.a3a6e343-b9d7-46ab-aad8-c0fc34c7b498.395fe483-7a9c-4c7f-ae27-4082290d2ccf.2a4f9940-98cd-460a-a422-d954187c3909.png","licenseUrl":"https://download.microsoft.com/download/F/D/8/FD8BA8F2-72AF-45D9-B39E-230B26CBD39D/StandardContractMarch2019.pdf","privacyUrl":"https://www.refinitiv.com/en/policies/privacy-statement","addinInfo":{"priority":-1,"AUP":356,"downloadNumber":250456}},{"displayName":"Money in Excel","solutionId":"wa200001306","version":"2.3.0.1","targetType":1,"width":0,"height":0,"description":"Seamlessly connect your financial accounts to Excel to view and manage your finances in one place.","iconUrl":"9427.a6eaa8f8-8441-4e98-b51b-7cdc68b3ad70.1e0bd518-ace3-4c76-a4e1-5bec9f355e89.eb2dcf06-11b7-4c0c-873b-df18bf95b4fa.png","licenseUrl":"https://officepreview.microsoft.com/en-us/office-store-standard-application-license-terms-HA102821243.aspx","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":2,"AUP":1382,"downloadNumber":178279}},{"displayName":"AI-aided Formula Editor","solutionId":"wa200001584","version":"2.6.0.0","targetType":1,"width":0,"height":0,"description":"GPT-4-powered AI features like formula generation and explanation built-in a modern Formula Editor.","iconUrl":"65260.49589048-b9b0-4c4d-9166-9853dbc8d0d0.00f729b3-2b4d-4d96-a381-52c6e940cf4e.1e8d39fe-6248-4e13-b4cc-1e61e02c196d.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.10studio.tech/privacy","addinInfo":{"priority":1,"AUP":679,"downloadNumber":58708}},{"displayName":"McGraw Hill","solutionId":"wa200002270","version":"3.0.0.0","targetType":1,"width":0,"height":0,"description":"McGraw Hill tool application aimed to assist students to learn and leverage Microsoft Excel.","iconUrl":"10994.a2611ae6-e1fb-468e-9a75-4292ffd45f92.3e087ea2-0e00-40c2-9e26-d5c264f97fae.ffc523c3-0e09-439c-9422-af52e0770aff.png","licenseUrl":"https://www.mheducation.com/terms-use.html?external_browser=2","privacyUrl":"https://www.mheducation.com/privacy.html?external_browser=2","addinInfo":{"priority":2,"AUP":118855,"downloadNumber":17}},{"displayName":"Jasperactive for Office","solutionId":"wa200002334","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Web-based learning for Microsoft Word, Microsoft Excel and for Microsoft PowerPoint.","iconUrl":"24398.0a1bdc08-ac9f-4231-8e69-4eb02a692937.a4408ec1-bba8-4f97-961d-09257a62e38a.0013100a-0ba3-4b30-b729-14bf64da59dc.png","licenseUrl":"https://jasperactive.com/end-user-license-agreement","privacyUrl":"https://jasperactive.com/privacy-policy","addinInfo":{"priority":3,"AUP":1991,"downloadNumber":948014}},{"displayName":"XLSTAT Cloud","solutionId":"wa200002503","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Statistics and data analysis add-in.","iconUrl":"49744.000d2e73-975d-42e3-8f0f-ca360dc2cc60.8a9d0e1f-183b-4ab0-b765-b64f7b230131.6ebabbd6-be54-4fd5-8e89-3e07680d70ba.png","licenseUrl":"https://xlstat365.s3.us-east-2.amazonaws.com/legal/CLUF.pdf","privacyUrl":"https://xlstat365.s3.us-east-2.amazonaws.com/legal/PRIVACY_POLICY.pdf","addinInfo":{"priority":1,"AUP":272,"downloadNumber":95161}},{"displayName":"PitchBook for Excel","solutionId":"wa200002663","version":"1.6.0.0","targetType":1,"width":0,"height":0,"description":"Strengthen your analysis and build better financial models using PitchBook\u2019s data.","iconUrl":"50447.f729f52c-6484-4a27-9fd9-9a62d0ad734b.8b8a588c-46ce-4201-bddc-3d6086c7d7f2.3d88619d-29d6-49b5-a2ba-33bb2a724d32.png","licenseUrl":"https://pitchbook.com/terms-of-use","privacyUrl":"https://pitchbook.com/privacy-policy","addinInfo":{"priority":-1,"AUP":768,"downloadNumber":16652}},{"displayName":"Personalised QR Code Generator","solutionId":"wa200003220","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Quickly generate personalised, branded QR codes.","iconUrl":"1053.89a21dfa-3fde-4c6f-89e4-3eae439d83e7.67539e4a-131a-406f-a541-73c85a95eb0f.7a449688-1bb3-4511-9f43-2cc1a09edc9b.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://littleappy.co/office/qr-code-generator/privacy","addinInfo":{"priority":3,"AUP":129,"downloadNumber":203447}},{"displayName":"FRED Data","solutionId":"wa200003692","version":"1.0.0.1","targetType":1,"width":0,"height":0,"description":"Download data from the Federal Reserve Bank of St. Louis Economic Data (FRED).","iconUrl":"51797.9b2b8182-033d-4060-9ca5-866292d44261.be4b3e57-cbb1-436a-98af-42040dca76d3.1d354664-b22f-4494-a818-f28e5304fc35.png","licenseUrl":"https://fred.stlouisfed.org/fred-addin/legal.html","privacyUrl":"https://research.stlouisfed.org/privacy.html","addinInfo":{"priority":1,"AUP":185,"downloadNumber":340160}},{"displayName":"Advanced formula environment, a Microsoft Garage project","solutionId":"wa200003696","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Create, edit, and reuse formulas.","iconUrl":"42604.70ef3bb6-fd4c-4868-b560-ed816d7473dd.f2947730-eef9-434b-a86d-fa6e3bafe076.525d558d-aea8-4a78-89dd-576bcceda686.png","licenseUrl":"https://support.office.com/client/61994a3b-2c87-41c4-a88d-a6455efa362d?omkt=en-US","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":-1,"AUP":382,"downloadNumber":465970}},{"displayName":"Spreadsheet Sync","solutionId":"wa200003784","version":"1.2.0.1","targetType":1,"width":0,"height":0,"description":"It syncs your QBO Adv data directly with Excel, enabling businesses to build customized reports ","iconUrl":"19754.85145a97-15c6-4376-9196-8515ee6dfda2.17b17ce3-53d9-4050-b1a9-cd8f6d333853.43963bbc-6904-4da7-8514-7b2e0bb7b291.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.intuit.com/privacy","addinInfo":{"priority":3,"AUP":404,"downloadNumber":20528}},{"displayName":"ArcGIS for Excel","solutionId":"wa200004179","version":"2022.3.6.0","targetType":1,"width":0,"height":0,"description":"Discover new patterns and bring Excel data to life with maps using ArcGIS.","iconUrl":"14874.7ac80e32-4af3-4961-b3a6-2e871982b721.910edbf9-9d95-4224-a14c-7935fbbf3263.64da2c2e-9f1d-4b19-9264-dfe092cbe3eb.png","licenseUrl":"https://www.esri.com/en-us/legal/terms/master-agreement-product","privacyUrl":"https://www.esri.com/en-us/privacy/privacy-statements/privacy-statement","addinInfo":{"priority":3,"AUP":403,"downloadNumber":314491}},{"displayName":"Cegid Expert Connector for Excel","solutionId":"wa200004571","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Application apportant des fonctions personnalis\u00e9es pour exporter des donn\u00e9es de Cegid Expert.","iconUrl":"10618.583afe98-a839-46f6-a732-dbbf9ac8ac05.b4296dcd-6aea-4fb5-9e1d-d2a88879c875.ee35bc13-726a-4c70-8c82-dd0e375097d6.png","licenseUrl":"https://www.cegid.com/fr/cgv","privacyUrl":"https://www.cegid.com/fr/privacy-policy","addinInfo":{"priority":-1,"AUP":2501,"downloadNumber":12800}},{"displayName":"QR Code Tracker","solutionId":"wa200004687","version":"1.0.0.1","targetType":1,"width":0,"height":0,"description":"QR Code Tracker lets you easily generate/scan QR codes in a sheet.","iconUrl":"35614.d62fd4d2-7872-42e1-a0c2-405317558142.c8500959-825f-4100-b3e6-c21597165a0b.f5cfa5f9-1345-4020-805c-d8345f029ae2.png","licenseUrl":"https://www.formiraex.com/QR_Code_Tracker/license.html","privacyUrl":"https://www.formiraex.com/QR_Code_Tracker/privacy-policy.html","addinInfo":{"priority":3,"AUP":120,"downloadNumber":22465}},{"displayName":"Zebra BI Charts for Office","solutionId":"wa200004688","version":"1.0.0.0","targetType":0,"width":1000,"height":500,"description":"The most powerful charting visual in Excel & PowerPoint with a complete set of advanced charts! ","iconUrl":"9365.95df6186-f63a-4f9b-8cd5-414e80da57c8.ef9390f9-280b-4847-b1c6-c6fa272d852c.33527d56-43f3-4e84-bfe0-2bb6d2c2594d.png","licenseUrl":"https://zebrabi.com/legal/?doc=eula","privacyUrl":"https://zebrabi.com/legal/?doc=privacy-policy-visuals","addinInfo":{"priority":1,"AUP":120,"downloadNumber":18597}},{"displayName":"Flow | Your instant translator for the enterprise","solutionId":"wa200004858","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Access on-brand translations with Flow all across the internet","iconUrl":"21223.73dc3f42-d93e-46d2-ac41-21e4e22f1e9d.9e6a4242-8ef5-4d96-8f3e-e8dd4eebf01b.ea39d408-2aa7-45a1-bab6-3adbaca33d44.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.lengoo.com/privacy-policy","addinInfo":{"priority":1,"AUP":18,"downloadNumber":516}},{"displayName":"AI Formula Generator Bot for Excel","solutionId":"wa200004935","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Transform your text instructions into Excel formulas in seconds with the help of AI.","iconUrl":"15321.02bef729-7dee-4518-80a6-f1201acff812.20f898b8-6e94-4547-b2c1-2680aff4db58.e0447c81-0b85-428e-8e98-0c3ecefac08c.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://excelformulabot.com/privacy-policy","addinInfo":{"priority":1,"AUP":286,"downloadNumber":51919}},{"displayName":"Ghostwriter","solutionId":"wa200005107","version":"1.0.0.5","targetType":1,"width":0,"height":0,"description":"Introducing Ghostwriter OpenAI GPT-3 for Microsoft Office \u2013 the revolutionary writing assistant ","iconUrl":"8283.9a73910f-bc07-461c-a5aa-da58e2ce898e.24d0d825-2d57-4a56-9377-9087d459417f.b690bd3b-df98-4bef-bfc3-14135f3786f8.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://creativedatastudios.com/privacypolicy.html","addinInfo":{"priority":-1,"AUP":19,"downloadNumber":54328}},{"displayName":"Sage Reporting 365","solutionId":"wa200005246","iconUrl":"40546.f88bb9d8-63aa-45c5-9857-bba65a51e0dd.6bd00930-2608-40f8-b6b9-6b9b7660abf7.8c645fcb-d1e3-4b8d-82a5-cea0150a26a3.png","targetType":1,"width":0,"height":0,"description":"Sage Reporting 365 is a Business Intelligence software providing access to your management data","version":"1.0.0.3","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://blog.infineo.online/privacy","addinInfo":{"priority":1,"AUP":165,"downloadNumber":13423}},{"displayName":"ChatGPT for Excel","solutionId":"wa200005271","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Unlock the power of Excel with ChatGPT intelligence.","iconUrl":"55257.86bed75f-2814-457c-b505-403f890ae109.bd03c17e-334d-4b64-b573-33cf7a68a966.65bd7d1b-46c0-4876-a3a5-d2b84c95918d.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://chatgptforexcel.com/privacy-policy","addinInfo":{"priority":1,"AUP":1541,"downloadNumber":8869}},{"displayName":"Numerous.ai","solutionId":"wa200005281","iconUrl":"19340.b57a7be8-416b-490a-9c58-b5567322666d.bc5fbf37-4907-473d-826c-150e0ae698aa.35f4cdd6-af50-49e7-8607-efcddc63f117.png","targetType":1,"width":0,"height":0,"description":"Use AI to generate formulas, categorize items, format cells, and perform repetitive tasks.","version":"1.0.0.0","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://numerous.ai/privacy.html","addinInfo":{"priority":1,"AUP":283,"downloadNumber":1376}},{"displayName":"FormulAI","solutionId":"wa200005333","version":"1.0.0.2","targetType":1,"width":0,"height":0,"description":"FormulAI is a powerful Microsoft Excel formula assistant using AI.","iconUrl":"18944.a414168a-5468-4d7d-905c-6a9ff954a4a8.ad819f3c-11ba-4124-975b-22d1d3b278cc.d82fb89a-dcbe-49d9-9013-de1b3221d003.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.formulai.xyz/privacy-policy","addinInfo":{"priority":1,"AUP":4,"downloadNumber":0}}]'}mH(Aa,
Eb){this.Csb&&this.Csb.mH(Aa,Eb)}gzc(Aa){this.Csb&&this.Csb.Ifb(Aa)}L2g(Aa,Eb){return J.a.hh().equals(Aa.solutionId,Eb.solutionId)&&J.a.hh().equals(Aa.storeType,Eb.storeType)}mPd(Aa,Eb){if(w.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType"))this.zZf(Aa,Eb,OSF.StoreTypeEnum.MarketPlace);else{const cc={};cc.callbackFunc=Aa;cc.storeType=OSF.StoreTypeEnum.MarketPlace;cc.fromInsertDialog=!1;cc.refresh=Eb;this.Kk.queryEntitlementDetails(cc)}}zZf(Aa,Eb,cc){const pc=
{};pc.callbackFunc=Aa;pc.storeType=cc;pc.fromInsertDialog=!1;pc.refresh=Eb;this.Kk.queryEntitlementDetails(pc)}invokeDdaMethod(Aa,Eb){const cc=this.Xn(Aa.DdaMethod.ControlId);cc?cc.invokeDdaMethod(Aa,Eb):this.xg(Nb.a.internalError,Eb)}registerDdaEventAsync(Aa,Eb,cc,pc,Hc){(Eb=this.Xn(Eb))?re.TEb(Aa)?Eb.Ntj(Aa,cc,pc,Hc):this.xg(Nb.a.DLd,Hc):this.xg(Nb.a.internalError,Hc)}unregisterDdaEventAsync(Aa,Eb,cc,pc,Hc){(Eb=this.Xn(Eb))?re.TEb(Aa)?Eb.eck(Aa,cc,pc,Hc):this.xg(Nb.a.DLd,Hc):this.xg(Nb.a.internalError,
Hc)}dispose(){this.disposed||(this.$.hn(this.ee),this.ea.Vk(this.Md),this.ea.EP(this.ho),this.ea.hx(this.rg),this.I3c.detach(this),this.$.userOperationManager.fp(this.dT),this.wwc=this.hg=this.Rh=this.I3c=this.Ub=null,this.pMa&&(this.pMa.dispose(),this.pMa=null),ob.a.Ka(this.oVd),ob.a.Ka(this.nVd),this.k5a&&(this.k5a.dispose(),this.k5a=null),super.dispose(),this.disposed=!0,e.ULS.sendTraceTag(537170583,0,50,"DdaFacade is disposed"))}nmd(Aa){return(Aa=this.Xn(Aa))?Aa.getDefaultIconUrl():null}EDc(Aa){if(this.uRe!==
Aa){this.uRe=Aa;for(let Eb=0,cc=this.hg.length;Eb<cc;Eb++){const pc=this.hg[Eb];Aa?pc.bUe(!1):pc.fDh()}this.oVd.EDc(Aa);this.nVd.EDc(Aa)}}u4h(Aa){return(Aa=this.Xn(Aa))?Aa.getDefaultDisplayName():null}xg(Aa,Eb,cc=!0){const pc={};pc[Tb.a.Og]=Aa;pc[Tb.a.k6]=Eb;this.RL(451041795,pc,cc)}Pw(Aa){const Eb={};Eb[Tb.a.k6]=Aa;this.RL(1237877382,Eb)}RL(Aa,Eb,cc=!0){const pc=new Pb.a(Aa,0,this.$.Tc,0,null),Hc=Eb?Eb[Tb.a.k6]:null;this.k5a&&Ha.h(this.$).Ob&&Vb.Xgh(Aa,Eb)?this.k5a.Lvh(Aa,Eb):(Aa=this.$.Ia.mc(pc,
Eb),cc&&kb.TaskExtensions.za(Aa,td=>{bb.a(td)?this.xg(Nb.a.internalError,Hc,!1):td.result||(Ha.h(this.$).Ob?this.xg(Nb.a.eEb,Hc,!1):this.xg(Nb.a.internalError,Hc,!1))},this.ka,8))}Ajh(Aa){return!!this.Ila(Eb=>re.getSolutionId(Eb.Zl,this.$)===re.getSolutionId(Aa,this.$)&&Eb.Zl.PrimaryMarketplace.MarketplaceType===Aa.PrimaryMarketplace.MarketplaceType&&Eb.Zl.PrimaryMarketplace.MarketplaceRef===Aa.PrimaryMarketplace.MarketplaceRef&&Eb.Zl.PrimaryMarketplace.SolutionVersion===Aa.PrimaryMarketplace.SolutionVersion)}Xn(Aa){return this.Ila(Eb=>
Eb.controlId.startsWith(Aa))}HTh(Aa){return this.Ila(Eb=>Eb.Awa===Aa)}e4e(Aa){return this.Ila(Eb=>Eb.AR===Aa&&!!Eb.Awa)}u4e(Aa,Eb,cc,pc){return this.Ila(Hc=>Hc.AR===Aa&&Hc.Zl.PrimaryMarketplace.MarketplaceRef.toLowerCase()===Eb.toLowerCase()&&Hc.Zl.PrimaryMarketplace.MarketplaceType.toLowerCase()===cc.toLowerCase()&&!!Hc.Zl.SharedRuntime&&!!Hc.Zl.SharedRuntime.Resid&&!!pc&&!!pc.Resid&&Hc.Zl.SharedRuntime.Resid.toLowerCase()===pc.Resid.toLowerCase())}u3g(Aa,Eb){if(Aa=this.Xn(Aa))Aa.la(Eb),Aa.showHide(!0)}nYj(Aa){(Aa=
this.Xn(Aa))&&Aa.showHide(!1)}sLa(Aa){var Eb;if(1!==Aa.WebExtensionType||this.$.oe&8388608&&Aa.TaskpaneVisible||this.$.oe&8388608&&!Aa.TaskpaneVisible&&gc.HelperMethods.Vx(Aa)){let cc=null;gc.HelperMethods.Vx(Aa)&&(cc=re.Qxa(Aa,this.$),Aa.TaskpaneWidth||(Aa.TaskpaneWidth=this.vxb));const pc=(new Cd(this,this.Rh,Aa)).bud();e.ULS.sendTraceTag(51263011,0,50,`DdaFacade::CreateOsfControl: SolutionId: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Aa.PrimaryMarketplace.SolutionId,Aa.OwnerAddinStoreType||
Aa.PrimaryMarketplace.MarketplaceType,null===(Eb=Aa.AssetMarketplace)||void 0===Eb?void 0:Eb.SolutionId,null,null,Aa.PrimaryMarketplace.MarketplaceRef)}, StoreType: ${Aa.PrimaryMarketplace.MarketplaceType}, UseShareRuntime: ${gc.HelperMethods.Vx(Aa)}`);cc&&(pc.Awa=cc);this.hg.push(pc);this.nAa=null;this.Q9a(Aa.InstanceId)||(Aa=String.format("{0}|{1}|{2}|{3}|{4}",Aa.PrimaryMarketplace.SolutionId,Aa.PrimaryMarketplace.SolutionVersion,Aa.PrimaryMarketplace.MarketplaceRef,Aa.PrimaryMarketplace.MarketplaceType,
Aa.WebExtensionType),this.raiseEvent("ci",Aa))}}VZj(Aa,Eb){Aa.TaskpaneWidth=this.vxb;Aa.TaskpaneVisible=!0;const cc={};cc.SolutionId=Aa.PrimaryMarketplace.SolutionId;cc.TargetType=Aa.WebExtensionType;cc.Version=Aa.PrimaryMarketplace.SolutionVersion;cc.StoreType=Aa.PrimaryMarketplace.MarketplaceType;cc.StoreId=Aa.PrimaryMarketplace.MarketplaceRef;Aa.AssetMarketplace?(cc.AssetId=Aa.AssetMarketplace.SolutionId,cc.AssetStoreId=Aa.AssetMarketplace.MarketplaceRef):(cc.AssetId=null,cc.AssetStoreId=null);
cc.Width=Aa.TaskpaneWidth;const pc=new Cd(this,this.Rh,Aa,!0);pc.bud();this.hg.push(pc);const Hc=()=>{this.jUa(pc.controlId);this.Xf.purgeOsfControl(pc.controlId,!1);Eb()};let td=null;td=jc.a.instance.iE(()=>{pc.Nz&&(ob.a.Ka(td),td=null,this.Xf.insertBlankControlWithErrorUX(this.QMb(pc,cc),Hc))},100,vc.a.zuh)}Bnh(Aa){if(Aa&&Aa.length){var Eb=[];Aa.forEach(cc=>{if(cc.ContainsCustomFunctions){const pc=re.Qxa(cc,this.$);this.MMd.contains(pc)||(this.MMd.add(pc),this.SVf.push(cc));this.Ajh(cc)||Eb.push(cc)}});
Eb.length&&this.AOe(Eb)}}AQe(Aa,Eb){this.Xn(Aa.InstanceId)||(Eb=Eb(),Aa=(new Cd(this,this.Rh,Aa)).Bmf(Eb),this.hg.push(Aa),this.nAa=null)}HXj(Aa){re.c5a.Pb(Aa)&&re.c5a.ma(Aa).initializeAndShowWithTitle()}Api(Aa){re.c5a.Pb(Aa)&&re.c5a.ma(Aa).hide()}Gai(Aa){var Eb=null;let cc,pc,Hc=null;cc=re.rqd(Aa,!0);if(!cc)return e.ULS.sendTraceTag(537170570,0,10,"DdaFacade.GetOrCreateCustomFunctionSandboxAsync: webextension data is null"),Ed.Task.Ua(null);(pc=this.Kk.getOsfControl(re.getSolutionId(cc,this.$)))&&
(Eb=pc.getManifest())&&(Hc=Eb.getSharedRuntimeForCustomFunctions("Workbook"));if(Eb=Hc&&1===Hc.LifeTime?this.u4e(cc.PrimaryMarketplace.SolutionId,cc.PrimaryMarketplace.MarketplaceRef,cc.PrimaryMarketplace.MarketplaceType,Hc):this.HTh(Aa))return Ed.Task.Ua(Eb.controlId);const td=new nb.a;gc.HelperMethods.Apc(Hc)&&(cc.SharedRuntime=Hc);Aa=pc?pc.getNotificationParams():[];if(!Aa.length)return this.dPe(cc);this.cig(Aa,()=>{kb.TaskExtensions.za(td.task,()=>{this.dPe(cc)},this.ka,3)},()=>{});return td.task}r_h(Aa){Aa=
re.rqd(Aa,!1);if(!Aa)return e.ULS.sendTraceTag(537170569,0,10,"DdaFacade.GetAddinCommandSandbox: webextension data is null"),null;let Eb=null;var cc=this.Kk.getOsfControl(re.getSolutionId(Aa,this.$));cc&&(cc=cc.getManifest())&&(Eb=cc.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));return gc.HelperMethods.Apc(Eb)&&(Aa=this.u4e(Aa.PrimaryMarketplace.SolutionId,Aa.PrimaryMarketplace.MarketplaceRef,Aa.PrimaryMarketplace.MarketplaceType,Eb))?Aa.controlId:null}Vlh(Aa,Eb){var cc=re.rqd(Aa,!1);if(cc){var pc=
null,Hc=this.Kk.getOsfControl(re.getSolutionId(cc,this.$));Hc&&(Hc=Hc.getManifest())&&(pc=Hc.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));if(gc.HelperMethods.Apc(pc)){cc.SharedRuntime=pc;var td=cc.PrimaryMarketplace.SolutionId;Hc=cc.PrimaryMarketplace.SolutionVersion;var me=OSF.OsfManifestManager.getCachedManifest(td,Hc);if(me)if(this.a5b.Pb(Aa))pc=this.a5b.ma(Aa),kb.TaskExtensions.za(pc,Ze=>{(Ze=Ze.result)&&OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(Ze,Eb,this.Rh.xQb)},
this.ka,3);else{var ve={};ve.solutionId=td;ve.version=Hc;ve.storeType=cc.PrimaryMarketplace.MarketplaceType;ve.storeId=cc.PrimaryMarketplace.MarketplaceRef;cc.AssetMarketplace?(ve.assetId=cc.AssetMarketplace.SolutionId,ve.assetStoreId=cc.AssetMarketplace.MarketplaceRef):(ve.assetId=null,ve.assetStoreId=null);ve.targetType=OSF.OsfControlTarget.TaskPane;var Qe=new nb.a;cc=kb.TaskExtensions.Ik();cc=new zb.a(this.$,this,ve,cc);pc=OSF.OsfManifestManager.getSharedRuntimeManifestCacheKey(td,pc.Resid);OfficeExt.AddinCommandsManifestManager.cacheManifestForAction(me,
pc,Hc);cc.createUILessSandbox(ve,me,(Ze,nf)=>{Ze&&!nf?(OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(Ze,Eb,this.Rh.xQb),Qe.setResult(Ze)):Qe.setResult(null);this.a5b.remove(Aa)});this.a5b.ia(Aa,Qe.task)}}}else e.ULS.sendTraceTag(537170568,0,10,"DdaFacade.CreateAddinCommandSandboxAsync: webextension data is null")}jJe(Aa){(Aa=this.e4e(Aa))&&(Aa.Zl.SharedRuntime||this.iOb(Aa.controlId))}iOb(Aa){(Aa=this.e4e(Aa))&&this.jUa(Aa.controlId)}Kzh(Aa,Eb){if(!this.hg||!Aa||!Eb)return!1;
if(Aa.toLowerCase()===Eb.toLowerCase())return!0;let cc=null,pc=null;for(let Hc=0,td=this.hg.length;Hc<td;Hc++){const me=this.hg[Hc];if(me.ownerAddinSolutionId&&(me.controlId===Aa&&(cc=me.ownerAddinSolutionId.toLowerCase()),me.controlId===Eb&&(pc=me.ownerAddinSolutionId.toLowerCase()),cc&&pc))break}return cc&&cc===pc?!0:!1}mUg(Aa){this.Xn(Aa.InstanceId)||(Aa=new Cd(this,this.Rh,Aa),this.hg.push(Aa),this.nAa=null)}X3f(Aa){if(this.hg&&0<=Aa&&Aa<this.hg.length){const Eb=this.hg[Aa],cc=Eb.Nz;this.hg.splice(Aa,
1);this.JKf(Eb);tb.DOMElementExtensions.tg(cc)}}jUa(Aa){if(this.hg)for(let Eb=0,cc=this.hg.length;Eb<cc;Eb++)if(this.hg[Eb].controlId===Aa){this.X3f(Eb);break}}cxj(Aa){if(this.hg){Aa=Aa.toLowerCase();for(let Eb=0,cc=this.hg.length;Eb<cc;Eb++)if(Aa===this.hg[Eb].ownerAddinSolutionId.toLowerCase()){this.X3f(Eb);break}}}$3g(Aa){Aa.Ij&&(this.Xn(Aa.floatingObject.Zl.InstanceId)||(this.kmc(Aa.floatingObject.Zl.InstanceId)||this.wwc.push(Aa.floatingObject.Zl.InstanceId),this.sLa(Aa.floatingObject.Zl)),this.ea.isNamedObjectViewMode&&
this.u3g(Aa.floatingObject.Zl.InstanceId,Aa.ye))}p4e(Aa){return null==this.hg?null:this.hg.find(Eb=>1===Eb.controlType&&Mc.a.equals(Eb.AR,Aa,!0))}rda(Aa){if(sa.EwaSettings.isChangeGateEnabled("OfficeVSO:7645729_ConsolidateFindOsfControlFromSolutionId"))return Aa=this.p4e(Aa),null===Aa||void 0===Aa?void 0:Aa.controlId;if(this.hg)for(let Eb=0,cc=this.hg.length;Eb<cc;Eb++)if(1===this.hg[Eb].controlType&&Mc.a.equals(this.hg[Eb].AR,Aa,!0))return this.hg[Eb].controlId;return null}fJi(Aa){return(Aa=this.p4e(Aa))?
Aa.visible:!1}iTh(Aa){const Eb=[];if(this.hg)for(let cc=0,pc=this.hg.length;cc<pc;cc++)Mc.a.equals(this.hg[cc].AR,Aa,!0)&&Eb.push(this.hg[cc].controlId);return Eb}OTh(Aa,Eb){if(!Eb||!Aa)return null;if(this.hg)for(let cc=0,pc=this.hg.length;cc<pc;cc++)if(1===this.hg[cc].controlType&&Mc.a.equals(this.hg[cc].AR,Aa,!0)&&this.hg[cc].Zl.SharedRuntime&&Mc.a.equals(this.hg[cc].Zl.SharedRuntime.Resid,Eb.Resid,!0))return this.hg[cc].controlId;return null}wNa(Aa,Eb=null){return Aa?Eb?`${Aa}.${Eb}`:Aa:""}mJe(Aa,
Eb,cc){if(this.nAa===Aa)return!0;this.nAa=Aa;let pc=null,Hc=!1;if(!pc&&this.hg)for(let td=0,me=this.hg.length;td<me;td++)if(1===this.hg[td].controlType&&Mc.a.equals(this.hg[td].AR,Aa,!0)){let ve=!1,Qe=!1;Eb?(ve=!0,Qe=!!this.hg[td].Zl.SharedRuntime&&Mc.a.equals(this.hg[td].Zl.SharedRuntime.Resid,Eb.Resid,!0)):cc&&(ve=!0,Qe=Mc.a.equals(this.hg[td].Zl.SharedRuntimeId,cc,!0));if(!ve||Qe){Qe&&this.hg[td].Oh(!0);pc=this.hg[td].controlId;Hc=!0;this.nAa=null;break}}pc&&this.raiseEvent("ca",pc);return Hc}setAppRuntimeState(Aa,
Eb){var cc;if(Aa){const pc=this.Xn(Aa);if(pc&&gc.HelperMethods.Vx(pc.Zl))pc.Oh(Eb),Eb&&(this.raiseEvent("ca",Aa),(null===(cc=pc.Nz)||void 0===cc?0:cc.firstChild)&&(Aa=pc.Nz.firstChild.title)&&0<Aa.length&&this.j6b.tKj(Aa));else throw e.ULS.sendTraceTag(537170565,0,50,"SetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(hd.a.instance.ha(2250));}else throw e.ULS.sendTraceTag(537170564,0,15,"SetAppRuntimeState: Invalid controlId."),Error.invalidOperation(hd.a.instance.ha(2251));
}getAppRuntimeState(Aa){if(Aa)if((Aa=this.Xn(Aa))&&gc.HelperMethods.Vx(Aa.Zl))Aa=Aa.Zl.TaskpaneVisible;else throw e.ULS.sendTraceTag(537170563,0,50,"GetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(hd.a.instance.ha(2250));else throw e.ULS.sendTraceTag(537170562,0,15,"GetAppRuntimeState: Invalid controlId."),Error.invalidOperation(hd.a.instance.ha(2251));return Aa}P6a(Aa,Eb){return(Aa=this.Xn(Aa))?Aa.P6a(Eb):null}Q9a(Aa){return this.oJe(this.wwc,Aa)}kmc(Aa){return this.oJe(this.oRe,
Aa)}jwe(Aa){this.oRe.push(Aa)}rW(Aa){return(Aa=this.Xn(Aa))?Aa.Zl:null}LHd(Aa){this.raiseEvent("ekros",Aa,this)}fTf(Aa){if(Aa){var Eb=this.Xn(Aa.InstanceId);Eb&&(Aa.SharedRuntime||Aa.SharedRuntimeId||(this.jUa(Eb.controlId),this.Xf.purgeOsfControl(Eb.controlId,!1)),Eb={},Eb.SolutionId=Aa.PrimaryMarketplace.SolutionId,Eb.TargetType=Aa.WebExtensionType,Eb.Version=Aa.PrimaryMarketplace.SolutionVersion,Eb.StoreType=Aa.PrimaryMarketplace.MarketplaceType,Eb.StoreId=Aa.PrimaryMarketplace.MarketplaceRef,
Aa.AssetMarketplace?(Eb.AssetId=Aa.AssetMarketplace.SolutionId,Eb.AssetStoreId=Aa.AssetMarketplace.MarketplaceRef):(Eb.AssetId=null,Eb.AssetStoreId=null),Eb.Width=Aa.TaskpaneWidth,Eb.SharedRuntimeId=Aa.SharedRuntimeId,this.iqg(Eb))}}ola(){this.Rh.ola()}yG(Aa,Eb,cc){this.Rh.yG(Aa,Eb,cc)}F4e(Aa,Eb){Eb=re.jrh(Eb);Aa=this.rW(Aa);this.Rh.ufc(Aa.InstanceId,2202,eb.a.FM,Eb)}jjd(Aa){for(let Eb=0,cc=this.hg.length;Eb<cc;Eb++)this.F4e(this.hg[Eb].controlId,Aa)}YTh(Aa,Eb){Eb=re.Amh(Eb);this.Rh.ufc(Aa,65539,
"",Eb)}bUh(Aa,Eb,cc){this.Rh.ufc(Aa,1,Eb,cc)}XTh(Aa,Eb){this.Rh.cUh(Aa,Eb)}Rlh(Aa,Eb){return[[2,1E3,"",JSON.stringify([Aa,Eb]),0,!1]]}rzi(){return!!this.Zpa&&this.Zpa.Sif()}zeh(){this.Zpa&&this.Zpa.clear()}ZTh(){if(this.Zpa&&this.Zpa.Sif()){var Aa=this.Zpa.u_h();for(const Eb of Aa){Aa=this.iTh(Eb);for(const cc of Aa)this.Rh.ufc(cc,65540,"","{}")}}}Gtj(Aa){this.Zpa.add(Aa)}bck(Aa){this.Zpa.remove(Aa)}Ila(Aa){if(!this.hg)return null;for(const Eb of this.hg)if(Aa(Eb))return Eb;return null}dPe(Aa){const Eb=
new nb.a,cc=re.Qxa(Aa,this.$);if(gc.HelperMethods.Vx(Aa))e.ULS.sendTraceTag(537170531,0,50,"Shared runtime custom function agave is started."),this.PVf(Aa,pc=>{pc?(Aa.InstanceId=pc.InstanceId,Aa.WebExtensionOsfControlType=3,Aa.TaskpaneVisible=!1,this.sLa(Aa),Eb.setResult(Aa.InstanceId)):(e.ULS.sendTraceTag(537170530,0,10,`InsertAgaveTaskPane for customfunction: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Aa.PrimaryMarketplace.SolutionId,Aa.PrimaryMarketplace.MarketplaceType,null,null,null,Aa.PrimaryMarketplace.MarketplaceRef)} failed`),
Eb.setException(Error.create("Null insert data")))});else{re.c5a.ia(Aa.InstanceId,new X.a);const pc=re.c5a.ma(Aa.InstanceId).Vca;this.Anh(Aa,pc,cc);this.PVf(Aa,null);Eb.setResult(Aa.InstanceId)}return Eb.task}Anh(Aa,Eb,cc){this.Xn(Aa.InstanceId)||(Aa=new Cd(this,this.Rh,Aa),Aa.Awa=cc,Aa.Bmf(Eb),this.hg.push(Aa),this.nAa=null)}PVf(Aa,Eb){const cc=re.Qxa(Aa,this.$);if(!this.MMd.contains(cc))this.sMb.push(Aa),1<=this.sMb.length&&this.QVf(Aa,Eb);else if(Eb)for(const pc of this.SVf)if(re.Qxa(pc,this.$)===
cc){Eb(pc,0);break}}QVf(Aa,Eb){let cc=null;const pc={};pc.SolutionId=re.getSolutionId(Aa,this.$);pc.TargetType=Aa.WebExtensionType;pc.Version=Aa.PrimaryMarketplace.SolutionVersion;pc.StoreType=Aa.PrimaryMarketplace.MarketplaceType;pc.StoreId=Aa.PrimaryMarketplace.MarketplaceRef;Aa.AssetMarketplace?(pc.AssetId=Aa.AssetMarketplace.SolutionId,pc.AssetStoreId=Aa.AssetMarketplace.MarketplaceRef):(pc.AssetId=null,pc.AssetStoreId=null);pc.Width=Aa.TaskpaneWidth;pc.ContainsCustomFunctions=!0;gc.HelperMethods.Vx(Aa)&&
(pc.SharedRuntimeId=Aa.SharedRuntime.Resid);const Hc=this.$.qa.va;Aa=this.$.qa.va.Lc();const td=Hc.Pa(9,Aa);td.sharedInfo=pc;const me=Qe=>{Qe=Rb.a.vf(Qe.data);e.ULS.sendTraceTag(537170528,0,10,`DdaFacade.CreateCustomFunctionSandbox failed on InsertAgaveTaskpane for persistenting CustomFunctions. errors: ${Wb.a.Uc(Qe)}`)},ve=Qe=>{Qe&&!mc.a(Qe)||e.ULS.sendTraceTag(537170527,0,10,`InsertAgaveTaskPane for addin ${Telemetry.PrivacyRules.GetPrivacyCompliantId(pc.SolutionId,pc.StoreType,pc.AssetId,null,
null,pc.StoreId)} finish with errors: ${Wb.a.Uc(Qe.Errors)}`);this.sMb.shift();0<this.sMb.length&&this.QVf(this.sMb[0],Eb)};if(Eb){const Qe=Ze=>{const nf=Ze.Result;(cc=nf?nf.AgaveData:null)||Eb(null,Ze.Errors?Ze.Errors[0].ErrorCause:5001);Eb(cc,0)};Aa=(Ze,nf,Cb)=>Bb.g(Hc,"InsertAgaveTaskpane",td,pd.b(Ze,ve,Qe),pd.a(nf,me),Cb,null,0)}else Aa=(Qe,Ze,nf)=>Bb.g(Hc,"InsertAgaveTaskpane",td,pd.b(Qe,ve),pd.a(Ze,me),nf,null,0);ub.a(this.$.userOperationManager,Aa,Qe=>new vb.a(519,0,Qe,64),null)}yUj(){return this.$.Xe.get(35)}bSd(Aa){Aa=
this.Xn(Aa);(null===Aa||void 0===Aa?0:Aa.vga)&&Aa.f4f()}JZi(Aa){var Eb=this.Ila(cc=>re.KPa(cc.AR));Eb&&(Eb=this.Xf.getOsfControl(Eb.controlId))&&Eb.notifyAgave(OSF.AgaveHostAction.SendMessage,Aa)}gAi(){return!!this.Ila(Aa=>1===Aa.controlType&&re.KPa(Aa.AR))}fAi(){const Aa=this.Ila(Eb=>re.KPa(Eb.AR));return Aa?Aa.Nz?tb.DOMElementExtensions.isVisible(Aa.Nz):!1:!1}JNj(){const Aa=this.Ila(Eb=>re.KPa(Eb.AR));Aa&&(Aa.Oh(!0),this.raiseEvent("ca",Aa.controlId))}initialize(Aa){const {DdaEventDispatch:Eb}=
a(1436),cc=void 0===this.$||null===this.$||sa.EwaSettings.ya(234);void 0!==this.$&&null!==this.$||e.ULS.sendTraceTag(537170525,0,50,"VSO#2693929: Initialize is called. EwaControl is null");cc&&e.ULS.sendTraceTag(537170524,0,50,"VSO#2693929: Initialize is called. this.initialized is "+this.initialized);this.initialized||($a.PJa(this.$),this.ea=this.$.ea,this.Rh=new Eb(this.$),this.$.$l(this.ee),this.ea.Mk(this.Md),this.ea.VK(this.ho),this.ea.wv(this.rg),this.$.userOperationManager.zs(this.dT),this.kzf(),
this.q9i(),this.hui(),this.$.da.Ja(35,this),this.I3c.la(this),cc&&e.ULS.sendTraceTag(537170522,0,50,"VSO#2693929: SessionIdChanged event is registered"),this.Ype=new eb.a,cc&&e.ULS.sendTraceTag(537170521,0,50,"VSO#2693929: RichApiEventRegistration is constructed"),this.aqe=new Yd(this.$,this.gi,this.Rh),new Pe(this.$,this.gi,this.Rh),this.Zpe=new ce(this.$,this.gi,this.Rh),this.Xpe=new ed(this.$,this.gi,this.Rh),this.Wpe=new oc(this.$,this.gi,this.Rh),this.$pe=new md(this.$,this.gi,this.Rh),this.bqe=
new Zb(this.$,this.gi,this.Rh),this.cqe=new Vc(this.$,this.gi,this.Rh),this.$.hX&&(this.dqe=new yd(this.$,this.gi,this.Rh)),this.eqe=new Hd(this.$,this.gi,this.Rh,Aa),sa.EwaSettings.ya(178)&&(this.k5a=new Vb(this,Ha.h(this.$))),sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled")&&(this.Vpe=new Yc),this.Upe=new Rf(this.$,this.gi,this.Rh),this.initialized=!0,e.ULS.sendTraceTag(537170520,0,50,"DdaFacade is initialized"))}TTh(Aa){if(!this.lFa)return null;
for(let Eb=0,cc=this.lFa.length;Eb<cc;Eb++)if(Aa.startsWith(this.lFa[Eb].WebExtensionId))return this.lFa[Eb];return null}kzf(){var Aa,Eb=this.ea;if(Eb.Oc&&!this.XVb){if(Eb.workbookContext){if(this.p0c=this.$.ea.Dh.get(22),null===(Aa=Eb.workbookContext.WebExtensions)||void 0===Aa?0:Aa.length){Aa=Eb.workbookContext.WebExtensions;Eb=!1;for(let cc=Aa.length-1;0<=cc;cc--){if(!this.ea.isNamedObjectViewMode){this.wwc.push(Aa[cc].InstanceId);if(1!==Aa[cc].WebExtensionType){Aa.splice(cc,1);continue}if(gc.HelperMethods.Vx(Aa[cc])&&
0!==Aa[cc].SharedRuntime.State)1===Aa[cc].SharedRuntime.State?Aa[cc].TaskpaneVisible=!1:2===Aa[cc].SharedRuntime.State?Aa[cc].TaskpaneVisible=!0:e.ULS.sendTraceTag(537170519,0,10,"The sharedRuntime state is invalid");else if(!Aa[cc].ContainsCustomFunctions&&!Aa[cc].TaskpaneVisible&&!Ob.a(Aa[cc])){Aa.splice(cc,1);continue}}const pc=OSF.OsfControl.isFirstPartyStoreString(Aa[cc].PrimaryMarketplace.MarketplaceType);if(sa.EwaSettings.ya(174)&&!pc&&(Aa.splice(cc,1),!Eb)){Eb=!0;const Hc=Object(Za.b)("OfficeVSO:7811663_ConvertBusinessBarManagerService2")?
Object(Sb.d)(sb.a.resolve(bc.h,{Wa:3})):Ra.GetServiceTaskFactory.Za(this.$.da,5,4,3);kb.TaskExtensions.za(Hc,()=>{Hc.result.oh(36,null)},this.ka,3)}sa.EwaSettings.isChangeGateEnabled("OfficeVSO:3937070_RemoveChartTaskPaneExtensionDuringLoad")&&Aa[cc].PrimaryMarketplace&&re.KPa(Aa[cc].PrimaryMarketplace.SolutionId)&&(e.ULS.sendTraceTag(537170518,0,50,"chart task pane info stored in workbook context webextensions"),Aa.splice(cc,1))}this.AOe(Aa)}}else this.p0c=!1;this.XVb=!0}}ohf(Aa){const Eb=Ha.h(this.$),
cc=Eb.ga.Sa.Pc;if(cc&&Aa){Aa=!1;if(this.hg)for(const pc of this.hg)if(re.KPa(pc.AR)||re.DDi(pc.AR)){Aa=!0;break}Aa||Eb.ga.Sa.LI(cc)}}q9i(){this.Xf&&this.ea.isNamedObjectViewMode&&this.$.na&&gf.o(this.$.na)&&(this.$.da.Ba(34).zS?this.$.da.Ba(34).qud():this.$.da.Ba(34).ut(this.pej))}AOe(Aa){let Eb=null;Eb=cc=>{const pc=cc.WebExtensionData,Hc=cc.IsTaskPane,td=cc.RecordHandler,me=()=>{this.gTa.shift();0<this.gTa.length&&Eb(this.gTa[0])};if(this.rda(pc.PrimaryMarketplace.SolutionId))me();else{Hc&&(pc.WebExtensionOsfControlType=
1);var ve=Ob.a(pc);if(!Hc||pc.TaskpaneVisible||ve||pc.SharedRuntime&&0!==pc.SharedRuntime.State||pc.ContainsCustomFunctions){var Qe=new Cd(this,this.Rh,pc,!Hc);e.ULS.sendTraceTag(537170517,0,50,`DdaFacade::CreateAllOsfControls: SolutionId: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(pc.PrimaryMarketplace.SolutionId,pc.PrimaryMarketplace.MarketplaceType,null,null,null,pc.PrimaryMarketplace.MarketplaceRef)}, StoreType: ${pc.PrimaryMarketplace.MarketplaceType}, UseShareRuntime: ${gc.HelperMethods.Vx(pc)}`);
Qe.bud();gc.HelperMethods.Vx(pc)&&(Qe.Awa=re.Qxa(pc,this.$),pc.TaskpaneWidth=this.vxb);ve&&(pc.WebExtensionToolTip="");!sa.EwaSettings.isChangeGateEnabled("OfficeVSO:7610902_EnforceDefaultTaskpaneWidth")&&Hc&&pc.TaskpaneVisible&&!ve&&(pc.TaskpaneWidth=this.vxb);this.hg.push(Qe);var Ze=this.nAa=null;Ze=jc.a.instance.iE(()=>{Qe.Nz&&(ob.a.Ka(Ze),Ze=null,td&&td(cc,Qe),me())},100,vc.a.yuh)}else me()}};for(let cc=0;cc<Aa.length;cc++){if(sa.EwaSettings.isChangeGateEnabled("OfficeVSO:7610902_EnforceDefaultTaskpaneWidth")){const pc=
Aa[cc].WebExtensionType===OSF.OsfControlTarget.TaskPane,Hc=Ob.a(Aa[cc]);pc&&!Hc&&(Aa[cc].TaskpaneWidth=this.vxb)}if(!this.Xn(Aa[cc].InstanceId))if(1!==Aa[cc].WebExtensionType)this.sLa(Aa[cc]);else if(!sa.EwaSettings.ya(52))this.trb(Aa[cc],Eb);else if(this.$.oe&8388608||Aa[cc].TaskpaneVisible){const pc={};pc.solutionId=Aa[cc].PrimaryMarketplace.SolutionId;pc.version=Aa[cc].PrimaryMarketplace.SolutionVersion;pc.storeType=Aa[cc].PrimaryMarketplace.MarketplaceType;pc.storeId=Aa[cc].PrimaryMarketplace.MarketplaceRef;
pc.targetData=Aa[cc];this.Xf.isAddinCommandsAsync(pc,(Hc,td,me)=>{if(Hc){var ve=me.targetData;if(td)if(pc.storeType.toLowerCase()!==OSF.StoreType.OMEX.toLowerCase())Hc=pc.storeType.toLowerCase()===OSF.StoreType.UploadFileDevCatalog.toLowerCase(),td=pc.storeType.toLowerCase()===OSF.StoreType.PrivateCatalog.toLowerCase(),(Hc||td)&&gc.HelperMethods.Vx(ve)&&this.trb(ve,Eb);else if(sa.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForUploadFileCatalog"))this.kmi(me,Eb);else{let Qe=
!1;this.mPd(Ze=>{if(!Ze.errorCode){if(Ze.value)for(const nf of Ze.value){if(Qe)break;Qe=ya.e(nf[1])===ya.e(ve.PrimaryMarketplace.SolutionId)}Qe?gc.HelperMethods.Vx(ve)&&this.trb(ve,Eb):(Ze={},Ze.SolutionId=me.solutionId,Ze.Version=me.version,Ze.StoreType=ve.PrimaryMarketplace.MarketplaceType,Ze.StoreId=me.storeId,Ze.AssetId=null,Ze.AssetStoreId=null,Ze.Width=ve.TaskpaneWidth,Ze.TargetType=ve.WebExtensionType,ve.TaskpaneVisible=!0,this.Vue(Ze,ve,Eb))}},!0)}else this.trb(ve,Eb)}else Hc=me.targetData,
e.ULS.sendTraceTag(542185164,220,15,`Judging AddinCommands failed for ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Hc.PrimaryMarketplace.SolutionId,Hc.PrimaryMarketplace.MarketplaceType,null,null,null,Hc.PrimaryMarketplace.MarketplaceRef)} from ${Hc.PrimaryMarketplace.MarketplaceType} during document loading`)})}}}kmi(Aa,Eb){let cc=!1;this.mPd(pc=>{const Hc=Aa.targetData;if(!pc.errorCode){if(pc.value)for(const td of pc.value){if(cc)break;cc=ya.e(td[1])===ya.e(Hc.PrimaryMarketplace.SolutionId)}cc?
gc.HelperMethods.Vx(Hc)&&this.trb(Hc,Eb):(pc={},pc.SolutionId=Aa.solutionId,pc.Version=Aa.version,pc.StoreType=Hc.PrimaryMarketplace.MarketplaceType,pc.StoreId=Aa.storeId,pc.AssetId=null,pc.AssetStoreId=null,pc.TargetType=Hc.WebExtensionType,pc.Width=Hc.TaskpaneWidth,Hc.TaskpaneVisible=!0,this.Vue(pc,Hc,Eb))}},!0)}trb(Aa,Eb){const cc={};cc.WebExtensionData=Aa;cc.IsTaskPane=!0;this.gTa.push(cc);1===this.gTa.length&&Eb(cc)}Vue(Aa,Eb,cc){const pc={};pc.ActivationInfo=Aa;pc.WebExtensionData=Eb;pc.IsTaskPane=
!1;pc.RecordHandler=(Hc,td)=>{const me=Hc.ActivationInfo;this.Xf.insertBlankControlWithErrorUX(this.QMb(td,me),()=>{this.jUa(td.controlId);this.Xf.purgeOsfControl(td.controlId,!1);this.iqg(me)})};this.gTa.push(pc);1===this.gTa.length&&cc(pc)}iqg(Aa){var Eb={};Eb.solutionId=Aa.SolutionId;Eb.version=Aa.Version;Eb.storeType=Aa.StoreType;Eb.storeId=Aa.StoreId;Eb.assetId=Aa.AssetId;Eb.assetStoreId=Aa.AssetStoreId;Eb.targetType=Aa.TargetType;Eb.sharedRuntimeId=Aa.SharedRuntimeId;Aa=new K.a;Aa.add(Eb);Eb=
{};Eb[ea.a.Asb]=Aa;Eb[ea.a.f_]=3;Aa=new Pb.a(kf.a.KHb,0,this.$.Tc,0,null);this.$.Ia.mc(Aa,Eb)}QMb(Aa,Eb){const cc={};cc.div=Aa.Nz;cc.id=Aa.controlId;cc.solutionId=Eb.SolutionId;cc.version=Eb.Version;cc.storeId=Eb.StoreId;cc.storeType=Eb.StoreType;cc.osfControlType=OSF.OsfControlTarget.TaskPane;return cc}Z7f(){if(sa.EwaSettings.isChangeGateEnabled("OfficeVSO:3935411_RemoveOsfControlsAferSilentReload")){const cc=[];for(var Aa=0;Aa<this.hg.length;Aa++){var Eb=this.hg[Aa];0!==Eb.osfControlType&&3!==Eb.osfControlType&&
4!==Eb.osfControlType||cc.push(Eb)}Aa=!1;for(Eb=0;Eb<cc.length;Eb++){const pc=cc[Eb];this.jUa(pc.controlId);!Aa&&pc&&pc.Zl&&(Aa=gc.HelperMethods.Vx(pc.Zl))}Aa&&this.RL(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:4})}sa.EwaSettings.ya(355)&&kb.TaskExtensions.za(Ra.GetServiceTaskFactory.Za(this.$.da,278,279,3),cc=>{cc&&(cc=cc.result)&&(this.$.da.Ba(278)||this.$.da.Ja(278,cc),cc.Fnf().cqa())},this.ka,3)}CM(){var Aa=new de(this.$,this.gi,this.k9f);void 0===this.$||null===this.$?e.ULS.sendTraceTag(537170514,
0,50,"VSO#2693929: ResetStateForWorkbookReload is called. EwaControl is null"):sa.EwaSettings.ya(234)&&e.ULS.sendTraceTag(537170513,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. RichAPiEventRegistration is null: "+(void 0===this.gi||null===this.gi));if(Aa.BYi()){const Eb=()=>{},cc=Hc=>{Hc=Rb.a.vf(Hc.data);e.ULS.sendTraceTag(537170511,0,10,`ResetStateForWorkbookReload: Failed to recreate event registration information. Errors: ${Wb.a.Uc(Hc)}.`)},pc=Aa.R8g();Aa=re.sod(pc);Aa|=64;this.$.userOperationManager.uG(new vb.a(507,
0,(Hc,td,me)=>Bb.g(this.$.qa.va,"ExecuteRichApiRequest",this.S8g(pc),pd.b(Hc,Eb),pd.a(td,cc),me,null,0),Aa))}}S8g(Aa){const Eb=this.$.qa.va.Pa(1);Eb.request=Aa;return Eb}oJe(Aa,Eb){if(Aa)for(let cc=0;cc<Aa.length;cc++)if(Mc.a.equals(Aa[cc],Eb,!0))return!0;return!1}S7g(Aa){const Eb={};Eb.navigationMode=OSF.OsfNavigationMode.DefaultMode;Eb.assetId=null;Eb.category=null;if(!Aa||3>Aa.length)return Eb;if(Aa[0]){const cc=parseInt(Aa[0],10);isNaN(parseInt(cc,10))||(Eb.navigationMode=cc)}Aa[1]&&(Eb.assetId=
Aa[1]);Aa[2]&&(Eb.category=Aa[2]);return Eb}hui(){if(sa.EwaSettings.ya(60)){var Aa=this.$.workbookContext.FullDocumentInfo.EmbeddingPageOrigin;if(Aa&&"*"!==Aa.trim()){this.pMa=OsfRuntime.Embedded.createOrReplaceEmbeddingEndpoint(new Xa(this),Aa,this.$.workbookContext.FullDocumentInfo.EmbeddingPageSessionInfo,this.$.Xe.get(2));try{this.pMa.init()}catch(Eb){try{this.pMa.dispose()}catch(cc){}this.pMa=null;e.ULS.sendTraceTag(537170510,0,10,"EmbeddingEnpoint failed to initialize. Error message: "+Eb.message)}Aa=
{};Aa.a=this.$.xa.UserSessionId;Xd.b().Of(39,Aa)}}}cig(Aa,Eb,cc){const pc=re.e7g(Aa[0]),Hc=pc.cka,td=pc.bla;pc.cka=()=>{Hc&&Hc();const me=pc.kPa!==OSF.InfoType.Error?Eb:null;Aa.shift();Aa.length?this.cig(Aa,me,cc):me&&me()};pc.bla=()=>{td&&td();cc&&pc.kPa!==OSF.InfoType.Error&&cc()};ca.a.e0d(pc)}$7h(){const Aa={};Aa.AddinRibbonControlsOverriddenByApi=sa.EwaSettings.isChangeGateEnabled("OfficeVSO:4373039_AddinRibbonControlsOverriddenByApi").toString();Aa.AddinActionDefinitionHybridMode=sa.EwaSettings.ya(556).toString();
Aa.UseActionIdForUILessCommand=sa.EwaSettings.ya(559).toString();Aa.AllowStorageAccessByUserActivationOnIFrame=sa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AllowStorageAccessByUserActivationOnIFrame",!1).toString();Aa.RequirementSetRibbonApiOnePointTwo=sa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.RequirementSetRibbonApiOnePointTwo",!1).toString();Aa.flightingTreatmentVariables=w.AFrameworkApplication.fa.Cfc;Aa.ShortcutInfoArrayInUserPreferenceData=sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5232658_ShortcutInfoArrayInUserPreferenceData").toString();
Aa.DisabledChangeGates=w.AFrameworkApplication.fa.Va("DisabledChangeGates");Aa.DmsSdxListWorkbook=w.AFrameworkApplication.XUe;return Aa}static get s$b(){return re.ode}static set s$b(Aa){re.ode=Aa}static getSolutionId(Aa){let Eb=Aa.PrimaryMarketplace.SolutionId;sa.EwaSettings.ya(261)&&Aa.OwnerAddinSolutionId&&(Eb=Aa.OwnerAddinSolutionId);return Eb}static sod(Aa){let Eb=0;sa.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?Aa.RequestFlags&1&&256!==(Aa.RequestFlags&
256)||(Eb=16):Eb=Aa.RequestFlags&1?0:16;return Eb}static Qxa(Aa,Eb){Eb=re.getSolutionId(Aa,Eb);return re.Y9e(Eb,Aa.PrimaryMarketplace.SolutionVersion,Aa.PrimaryMarketplace.MarketplaceType,Aa.PrimaryMarketplace.MarketplaceRef)}static jrh(Aa){return JSON.stringify({["recording"]:Aa})}static Amh(Aa){const Eb={};Eb.visibility=Aa?"Visible":"Hidden";return JSON.stringify(Eb)}static Z3h(Aa){let Eb=Aa.getSolutionId(),cc=Aa.getVersion(),pc=Aa.getStoreType();Aa=Aa.getStoreId();return re.Y9e(Eb,cc,pc,Aa)}static Y9e(Aa,
Eb,cc,pc){return String.format("{0}|{1}|{2}|{3}|{4}|||","2",Aa,Eb,re.Pfi(cc).toString(),pc)}static rqd(Aa,Eb){var cc=Aa.split("|");if(7>cc.length)return e.ULS.sendTraceTag(537170509,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected customFunctionAddinId."),null;if("2"!==cc[0])return e.ULS.sendTraceTag(537170508,0,10,`DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected format='${cc[0]}'.`),null;let pc=cc[1];const Hc=cc[2],td=re.Qfi(cc[3]),me=cc[4];cc=cc[5];pc&&pc.length||(pc=
cc);cc={};cc.InstanceId=String.format("{{{0}}}",O.a.create().toString());cc.WebExtensionOsfControlType=4;cc.WebExtensionType=1;cc.PrimaryMarketplace={};cc.PrimaryMarketplace.SolutionId=pc;cc.PrimaryMarketplace.SolutionVersion=Hc;cc.PrimaryMarketplace.MarketplaceRef=me;cc.PrimaryMarketplace.MarketplaceType=td;cc.ContainsCustomFunctions=Eb?!0:!1;Eb&&(cc.OsfPropertyBag=[["customFunctionAddinId",Aa]]);return cc}static Qfi(Aa){Aa=parseInt(Aa,10);return Aa===OSF.StoreTypeEnum.MarketPlace?OSF.StoreType.OMEX:
Aa===OSF.StoreTypeEnum.Catalog?OSF.StoreType.SPCatalog:Aa===OSF.StoreTypeEnum.SPApp?OSF.StoreType.SPApp:Aa===OSF.StoreTypeEnum.Exchange?OSF.StoreType.Exchange:Aa===OSF.StoreTypeEnum.FileSystem?OSF.StoreType.FileSystem:Aa===OSF.StoreTypeEnum.Registry?OSF.StoreType.Registry:Aa===OSF.StoreTypeEnum.PrivateCatalog?OSF.StoreType.PrivateCatalog:Aa===OSF.StoreTypeEnum.HardCodedPreinstall?OSF.StoreType.HardCodedPreinstall:Aa===OSF.StoreTypeEnum.FirstParty?OSF.StoreType.FirstParty:Aa===OSF.StoreTypeEnum.UploadFileDevCatalog?
OSF.StoreType.UploadFileDevCatalog:Aa===OSF.StoreTypeEnum.WopiCatalog?OSF.StoreType.WopiCatalog:null}static Pfi(Aa){return Aa===OSF.StoreType.OMEX?OSF.StoreTypeEnum.MarketPlace:Aa===OSF.StoreType.SPCatalog?OSF.StoreTypeEnum.Catalog:Aa===OSF.StoreType.SPApp?OSF.StoreTypeEnum.SPApp:Aa===OSF.StoreType.Exchange?OSF.StoreTypeEnum.Exchange:Aa===OSF.StoreType.FileSystem?OSF.StoreTypeEnum.FileSystem:Aa===OSF.StoreType.Registry?OSF.StoreTypeEnum.Registry:Aa===OSF.StoreType.PrivateCatalog?OSF.StoreTypeEnum.PrivateCatalog:
Aa===OSF.StoreType.HardCodedPreinstall?OSF.StoreTypeEnum.HardCodedPreinstall:Aa===OSF.StoreType.FirstParty?OSF.StoreTypeEnum.FirstParty:Aa===OSF.StoreType.UploadFileDevCatalog?OSF.StoreTypeEnum.UploadFileDevCatalog:Aa===OSF.StoreType.WopiCatalog?OSF.StoreTypeEnum.WopiCatalog:-1}owa(Aa){const Eb={};Eb.Version=Aa.version;Eb.AssetId=Aa.assetId;Eb.AssetStoreId=Aa.assetStoreId;Eb.StoreType=Aa.storeType;Eb.Height=Aa.height;Eb.SolutionId=Aa.solutionId;Eb.StoreId=Aa.storeId;Eb.TargetType=Aa.targetType;Eb.Width=
1===Eb.TargetType?0:Aa.width;Eb.SharedRuntimeId=Aa.sharedRuntimeId;return Eb}static TEb(Aa){return Aa===OSF.DDA.EventDispId.dispidSettingsChangedEvent||Aa===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent||Aa===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||Aa===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||Aa===OSF.DDA.EventDispId.dispidRichApiMessageEvent||Aa===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent||Aa===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent||
Aa===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent}static e7g(Aa){return Object(b.a)(new Ye.a,{kPa:Aa.infoType,id:Aa.id,title:Aa.title,description:Aa.description,buttonText:Aa.buttonTxt,cka:Aa.buttonCallback,Kkc:Aa.highPriority,bla:Aa.dismissCallback,errorCode:Aa.errorCode,Olf:Aa.iframeNotificationUrl})}static KPa(Aa){let Eb="FA000000014"===Aa;Eb||(Eb="907DD90F-A82F-4BBF-B4F2-FCD4868A5E14ButtonId1"===Aa);return Eb}static DDi(Aa){return"FA000000005"===Aa}}re.c5a=new B.a;re.ode=!0;Object(c.a)(re,
"DdaFacade",pb.a,[237,743,739,744,745,2])},799:function(r,C,a){a.d(C,"a",function(){return c});r=a(0);class c{constructor(b,e,f,d=null){this.ddaBinding=null;this.dispid=0;this.ArrayData=this.controlId=null;this.dispid=b;this.controlId=e;this.ddaBinding=f;this.ArrayData=d}getDispid(){return this.dispid}getDdaBinding(){return this.ddaBinding}}Object(r.a)(c,"DdaEventArgs",null,[])},853:function(r,C,a){r=a(0);class c{constructor(){this.title=this.id=this.tabs=null}}Object(r.a)(c,"AddInDataTransferObject",
null,[]);a.d(C,"a",function(){return b});class b{constructor(e,f,d){this.vWb=e;this.NCg=f;this.OCg=d}get yu(){return this.vWb}get ITg(){return this.NCg}get JTg(){return this.OCg}static hAb(e){return(e=e.NX)?Object.assign(new c,{tabs:e.yu.toArray(),id:e.ITg,title:e.JTg}):null}}Object(r.a)(b,"OneLineRibbonExtensibility",null,[])},858:function(r,C,a){a.d(C,"a",function(){return c});a.d(C,"b",function(){return b});const c=e=>{let f=null;switch(e){case 0:f="omex";break;case 1:f="spcatalog";break;case 2:f=
"spapp";break;case 3:f="filesystem";break;case 4:f="exchange";break;case 6:f="registry";break;case 7:f="inmemory";break;case 8:f="uploadfiledevcatalog";break;case 9:f="hardcodedpreinstall";break;case 10:f="excatalog";break;case 16:f="wopicatalog"}return f},b=e=>{let f=-1;switch(e.toLowerCase()){case "omex":f=0;break;case "spcatalog":f=1;break;case "spapp":f=2;break;case "filesystem":f=3;break;case "exchange":f=4;break;case "registry":f=6;break;case "inmemory":f=7;break;case "uploadfiledevcatalog":f=
8;break;case "hardcodedpreinstall":f=9;break;case "excatalog":f=10;break;case "wopicatalog":f=16}return f}},861:function(r,C,a){a.d(C,"a",function(){return c});r=a(0);class c{}Object(r.a)(c,"GetEntitlementDetailsParameters",null,[])},891:function(r,C,a){a.r(C);r=a(0);var c=a(198),b=a(15),e=a(106);class f{constructor(){this.startTime=0;this.callback=null}}Object(r.a)(f,"SSOCallbackInfo",null,[]);class d{constructor(){this.accessToken=null}}Object(r.a)(d,"AccessTokenInformation",null,[274]);var h=a(1017);
class l{constructor(){this.token=null;this.expiresOn=0;this.Pja=this.authChallenge=null}}Object(r.a)(l,"CachedTokenInfo",null,[]);class k{constructor(){this.$Wb=new c.a;this.Jba=this.Iba=!1;this.tra=this.authChallenge=null;this.startTime=this.retryCount=0;this.Aze=null}get callbacks(){return this.$Wb}}Object(r.a)(k,"SSORequestInfo",null,[]);class u extends k{constructor(){super();this.errorCode=0}}Object(r.a)(u,"SSOFailedRequestInfo",k,[]);var v=a(6);class x{constructor(L,M,O,B){this.MU=new c.a;this.aI=
new c.a;this.zsa=null;this.Opb=new c.a;this.yke=Promise.resolve(null);this.Kre=!1;this.$0b=M;this.kGa=L;this.mse=O;this.SCg=B}JVj(L){if(this.zsa&&this.zsa.authChallenge===L.authChallenge){if(Date.now()/1E3+x.cVi>this.zsa.expiresOn)return this.zsa=null,!1;L=new h.a;L.token=this.zsa.token;L.expiresOn=this.zsa.expiresOn;L.Pja=this.zsa.Pja;L.lXa=!0;L.ZBb=0;this.sCb(L);return!0}return!1}bUj(L){for(let M=0;M<this.aI.count;M++)if(this.aI.ma(M).authChallenge===L.authChallenge&&this.aI.ma(M).tra===L.tra){let O;
(O=this.aI.ma(M)).retryCount=O.retryCount+1;L.retryCount=this.aI.ma(M).retryCount;if(this.aI.ma(M).retryCount<x.zVi||!this.aI.ma(M).Iba&&L.Iba||!this.aI.ma(M).Jba&&L.Jba){if(!this.aI.ma(M).Iba&&L.Iba||!this.aI.ma(M).Jba&&L.Jba)L.retryCount=0;this.aI.removeAt(M);break}L=new h.a;L.errorCode=this.aI.ma(M).errorCode;this.sCb(L);return!0}return!1}AVg(L,M){for(let O=0;O<this.aI.count;O++)if(this.aI.ma(O).tra===L.tra&&this.aI.ma(O).authChallenge===L.authChallenge)return;this.aI.add(Object.assign(new u,{Iba:L.Iba,
Jba:L.Jba,authChallenge:L.authChallenge,tra:L.tra,errorCode:M,retryCount:L.retryCount}))}get resource(){return this.$0b}fld(L,M,O,B,E,I){const {AppsForOfficeSingleSignOnManager:S}=a(891);""===O&&(O=null);if(this.Kre)S.t8(I,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{var J=null;for(let K of this.MU)if(K.Iba===L&&K.Jba===M&&K.authChallenge===O&&K.tra===E){J=K;break}J||(J=Object.assign(new k,{Iba:L,Jba:M,authChallenge:O,Aze:B,tra:E,retryCount:0,startTime:S.Sx()}),this.MU.add(J));
J.retryCount=0;J.callbacks.add(I);this.yke=this.yke.then(()=>{var {AppsForOfficeSingleSignOnManager:K}=a(891);if(0<this.MU.count){var R=this.MU.ma(0);if(this.JVj(R)||this.bUj(R))return null;for(let P=0;P<this.Opb.count;)this.Opb.ma(P)+x.v6j<K.Sx()?this.Opb.removeAt(P):P++;if(this.Opb.count>=x.vVi||this.MU.count>=x.YUi)return R=new h.a,R.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,this.sCb(R),null;let Z=null;v.AFrameworkApplication.sa&&(K=v.AFrameworkApplication.sa.qF)&&(Z=K.Fd("ComponentAttach",
this.kGa+x.aPg));return R.tra.BRg(this.resource,R.Iba,R.Jba,R.authChallenge,this.SCg,R.Aze).then(P=>{Z&&Z.stop();this.sCb(P)},()=>{Z&&Z.stop();const P=new h.a;P.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;this.sCb(P)})}return null})}}sCb(L){const {AppsForOfficeSingleSignOnManager:M}=a(891);try{if(this.MU.count){var O=this.MU.ma(0);this.MU.removeAt(0);var B=null;L.errorCode||(B=new d,B.accessToken=L.token);L.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&
L.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&L.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&L.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||this.AVg(O,L.errorCode);var E={};null!=L.ZBb&&(E.getTokenSilentTime=L.ZBb.toString());null!=L.Xpd&&(E.getTokenPopupTime=L.Xpd.toString());null!=L.Dnd&&(E.getIDTokenTime=L.Dnd.toString());null!=L.lXa&&(E.tokenCached=L.lXa.toString());L.T3d&&(E.detailedError=L.T3d);L.Pja&&(E.authLibrary=L.Pja);
O.retryCount&&(E.retryCount=O.retryCount);for(var I of O.callbacks)M.t8(I,L.errorCode,B,E);null!=L.lXa&&L.lXa||this.Opb.add(O.startTime);if(!L.errorCode)for(null!=L.expiresOn&&(this.zsa=Object.assign(new l,{token:L.token,expiresOn:L.expiresOn,authChallenge:O.authChallenge,Pja:L.Pja})),this.aI.clear(),I=0;I<this.MU.count;)if(this.MU.ma(I).authChallenge===O.authChallenge){for(let S of this.MU.ma(I).callbacks)M.t8(S,L.errorCode,B,E);this.MU.removeAt(I)}else I++}}catch(S){b.ULS.sendTraceTag(21628945,
344,10,"ReceivedAccessTokenHandler: exception message: {0}",S.message)}}shutdown(){this.Kre=!0;this.MU.clear()}}x.v6j=6E4;x.vVi=6;x.YUi=6;x.zVi=3;x.cVi=300;x.aPg="GetAccessToken";Object(r.a)(x,"SSOCallbackManager",null,[]);var w=a(745),m=a(428),t=a(114),z=a(64),y=a(31),D=a(32),H=a(175),F=a(355);a.d(C,"AppsForOfficeSingleSignOnManager",function(){return G});class G{constructor(L,M,O=null){this.BMc=new e.a;const B=new c.a;M&&B.add(M.zTi);O&&B.addRange(O);this.Kk=L;this.fQg=B}gld(L,M,O,B,E,I,S,J,K,R){R=
Object.assign(new f,{startTime:G.Sx(),callback:R});try{const V=!!O&&""!==O;var Z=R.startTime;const Ea=this.getOsfControl(L);let oa=Ea.getStoreType()||"",ea=Ea.getOwnerAddinStoreType()||"",aa=Ea.getSolutionId()||"";const ia=Ea.getVersion()||"";oa=oa.toLowerCase();ea=ea.toLowerCase();aa=aa.toLowerCase();var P=z.a.Cnd(M)||"";const ya=z.a.Cnd(Ea.getIframeUrl())||"",za=P.toLowerCase()===ya.toLowerCase();P=oa;"inmemory"===oa&&(P=ea);const la=Telemetry.PrivacyRules.GetPrivacyCompliantId(aa,P,Ea.getAssetId(),
null,null,Ea.getStoreId()),xa={["callInstanceId"]:Z.toString(),["controlSolutionId"]:la,["controlVersion"]:ia,["storeType"]:oa,["ownerStoreType"]:ea,["allowConsentPrompt"]:B.toString(),["forMSGraphAccess"]:E.toString(),["allowSignInPrompt"]:I.toString(),["hasAddinAuthChallenge"]:V.toString(),["securityOriginEqualsSourceLocation"]:za.toString(),["singleSignOnEnabled"]:S.toString(),["accountTypeFilter"]:J||""};b.ULS.sendTraceTag(51401115,344,50,"{0}",xa);H.a.sendTelemetryEvent(Object.assign(new F.a,
{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:t.a.Wj(xa)}));Z=!0;const wa=v.AFrameworkApplication.fa.Va("HostAuthType");switch(J){case "aad":Z="aad"===wa;break;case "msa":Z="msa"===wa;break;default:Z=!J||"noFilter"===J}if(Z){J=null;if(S)for(let hb of this.fQg)if(hb.MBi(aa)){J=hb;break}J?this.isSSOAddin(L)?(S=!0,"omex"===P&&(S=!1),"spapp"===P||"spcatalog"===P?(b.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),G.t8(R,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,
null,null)):E&&!S?(b.ULS.sendTraceTag(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),G.t8(R,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):(E&&"exchange"===P&&(B=!1),this.fld(L,M,O,P,B,I,K,J,R))):(b.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),G.t8(R,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):G.t8(R,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)}else G.t8(R,
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,null,null)}catch(V){this.mrc(),b.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",V.message),G.t8(R,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}}getAccessToken(L,M,O,B){this.gld(L,O[w.a.s3c]||null,O[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,O[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,O[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||
!1,O[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||!1,M,O[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||null,O[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,B)}fld(L,M,O,B,E,I,S,J,K){this.BMc.Pb(L)?B=this.BMc.ma(L):(B=new x(L,this.getWebApplicationResource(L).split(",")[0],B,this.getDefaultDisplayName(L)),this.BMc.add(L,B));const R=B.resource;L=G.Bdi(R,this.getWebApplicationId(L));const Z=OfficeExt.WACUtils.getHostSecure(M);
L&&Z?L.toLowerCase()===Z.toLowerCase()?B.fld(E,I,O,S,J,K):(G.yRa('SSO Resource "'+R+'" cannot be used from "'+M+'" origin due to domain mismatch.'),b.ULS.sendTraceTag(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),G.t8(K,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(L||b.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),Z||b.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),G.t8(K,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,
null,null))}mrc(){b.ULS.sendTraceTag(39068820,344,50,"Browser information: {0}",{["UserAgent"]:window.navigator.userAgent})}getOsfControl(L){return this.Kk.getOsfControl(L)}isSSOAddin(L){return this.getOsfControl(L).getManifest().isSSOAddin()}getWebApplicationId(L){return this.getOsfControl(L).getManifest().getWebApplicationId()}getWebApplicationResource(L){return this.getOsfControl(L).getManifest().getWebApplicationResource()}getDefaultDisplayName(L){return this.getOsfControl(L).getManifest().getDefaultDisplayName()}static nfi(){try{const L=
{};y.a.gAa&&m.OAuthManagerSettings.jDb&&(L.UiHostSupportsAuthTokenAddinList=G.O4e);L.UiHostSupportsAuthToken=m.OAuthManagerSettings.jDb;return L}catch(L){b.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",L.message)}return null}static getInstance(L,M,O=null){G.Oa||(G.Oa=new G(L,O));return G.Oa}static yRa(L){window.console.warn&&window.console.warn(L)}static Bdi(L,M){if(!L)return"";M||(M="");let O=L.toLowerCase();var B=M.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(B)||
(G.yRa('SSO App Id "'+M+'" is not a valid format. It will be rejected from store submission.'),b.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));O.endsWith(B)||(G.yRa('SSO Resource "'+L+'" does not end with App Id "'+M+'". It will be rejected from store submission.'),b.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!O.startsWith("https://")&&!O.startsWith("api://"))return G.yRa('SSO Resource "'+L+'" must be https:// or api:// protocol.'),b.ULS.sendTraceTag(590962909,
344,10,"Resource not using https or api protocol."),"";for(M=0;M<L.length;M++){B=L.charAt(M);const E=D.a.charCodeAt(L,M);if(33>E||126<E||"&"===B||"?"===B||"#"===B||"%"===B||"\\"===B)return G.yRa('SSO Resource "'+L+'" contains an invalid character "'+B+'".'),b.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+B+"' in resource URI."),""}if(0<=L.indexOf("::"))return G.yRa('SSO Resource "'+L+'" contains an invalid string "::".'),b.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<
L.length)return G.yRa('SSO Resource "'+L+'" is '+L.length+" characters and exceeds the max length of 120 characters."),b.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+L.length+"."),"";O.startsWith("api://")&&(O="https://"+O.substring(6,O.length));return 8===O.length?"":OfficeExt.WACUtils.getHostSecure(O)||""}static t8(L,M,O,B){var E=L.startTime;let I=0;0<E&&(I=G.Sx()-E);E={["callInstanceId"]:E.toString(),["callDuration"]:I.toString(),["errorCode"]:M.toString()};if(B)for(let S in B)E[S]=
B[S];b.ULS.sendTraceTag(51401116,344,50,"{0}",E);H.a.sendTelemetryEvent(Object.assign(new F.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:t.a.Wj(E)}));L.callback(M,O)}static Sx(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(L){}return Date.now()}}G.O4e="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");G.Oa=null;Object(r.a)(G,
"AppsForOfficeSingleSignOnManager",null,[236])},908:function(r,C,a){a.d(C,"a",function(){return c});r=a(0);var c;(function(b){b[b.myAddins=0]="myAddins";b[b.adminManaged=1]="adminManaged";b[b.popular=2]="popular"})(c||(c={}));Object(r.b)("AddinCollectionType",c)},909:function(r,C,a){a.d(C,"a",function(){return b});r=a(0);var c=a(16);class b{constructor(){this.d2e={["tabhome"]:"Ribbon.Home",["tabinsert"]:"Ribbon.Insert",["tabdata"]:"Ribbon.Data",["tabreview"]:"Ribbon.Review",["tabview"]:"Ribbon.View"};
this.b2e={["tabpagelayoutexcel"]:["Ribbon.PageLayoutExcel",c.a.instance.ha(1633),c.a.instance.ha(1637)],["tabformulas"]:["Ribbon.Formulas",c.a.instance.ha(1634),c.a.instance.ha(1638)],["tabdeveloper"]:["Ribbon.Developer",c.a.instance.ha(1635),c.a.instance.ha(1639)],["tabaddins"]:["Ribbon.AddIns",c.a.instance.ha(1636),c.a.instance.ha(1640)]};this.pec=null}get Eka(){return"SourceControlId"}get sO(){return"Workbook"}get formFactor(){return"DesktopFormFactor"}a$h(){if(!this.pec){this.pec={};for(const e of Object.keys(this.d2e))this.pec[e]=
this.d2e[e];for(const e of Object.keys(this.b2e))this.pec[e]=this.b2e[e][0]}}}Object(r.a)(b,"AddinCommandsStringProvider",null,[776])},910:function(r,C,a){a.d(C,"a",function(){return c});r=a(0);var c;(function(b){b[b.OK=0]="OK";b[b.notReady=1]="notReady";b[b.storeDisabled=2]="storeDisabled";b[b.invokeFailure=3]="invokeFailure"})(c||(c={}));Object(r.b)("AddinDetailsQueryError",c)},912:function(r,C,a){a.d(C,"a",function(){return c});r=a(0);class c{constructor(){this.kPa=0;this.cka=this.buttonText=this.description=
this.title=this.id=null;this.errorCode=0;this.Kkc=!1;this.Olf=this.bla=null}}Object(r.a)(c,"AddInCommandsNotificationParameters",null,[])},988:function(r,C,a){r=a(0);var c=a(15),b=a(88),e=a(166),f=a(14),d=a(93);class h extends Sys.UI.Control{constructor(B,E,I,S){super(document.createElement("div"));this.qU=this.oU=this.tx=this.VH=this.fI=this.tsa=this.Pta=null;this.xnb=this.gta=!1;this.content=this.Dq=null;this.D3=0;this.tEe=null;this.sV=0;this.XRf=null;this.Kse=B;this.Wne=E;this.QQ=I;this.fL=S;this.dh=
E.ownerDocument;this.ikc=this.Ru=this.Qnb=!1}get PX(){this.Pta||(this.Pta=this.dh.createElement("div"),this.Pta.id=this.Hi("WACCalloutOuter"),this.Pta.className="WACCalloutOuter",this.Pta.setAttribute(d.a.te,d.a.ptb),this.Pta.style.width=this.D3+"px");return this.Pta}get Rtb(){if(!this.tsa){this.tsa=this.dh.createElement("div");this.tsa.id=this.Hi("WACCalloutBeakContainer");this.tsa.className="WACCalloutBeakContainer";var B="CalloutBeakTopFilled_32x16x32";if(5===this.sV||6===this.sV||4===this.sV)B=
"CalloutBeakBottomFilled_32x16x32";B=e.createClusteredImage(32,16,B,"WACCalloutBeak",!0,"");this.tsa.appendChild(B)}return this.tsa}set Rtb(B){this.tsa=B}get RPa(){return this.Qnb}get title(){return this.Dq}set title(B){this.Dq!==B&&(this.Dq=B,this.oU&&(this.oU.innerText=this.Dq))}get Ru(){return this.gta}set Ru(B){this.gta!==B&&(this.gta=B,this.fI&&(this.fI.contains(this.tx)&&!this.gta?this.fI.removeChild(this.tx):!this.fI.contains(this.tx)&&this.gta&&this.cwe()))}get ikc(){return this.xnb}set ikc(B){this.xnb!==
B&&(this.xnb=B,this.fI&&(this.fI.contains(this.oU)&&!this.xnb?this.fI.removeChild(this.oU):!this.fI.contains(this.oU)&&this.xnb&&this.rxe()))}show(){this.Qnb||(this.Snh(),this.xn(),this.Wne.appendChild(this.PX),this.PX.style.display="Block",this.QQj(),this.Qnb=!0,this.XRf&&this.XRf())}dismiss(){this.Qnb&&(this.Uca(),this.Wne.removeChild(this.PX),this.Qnb=!1,this.fL&&this.fL())}dispose(){this.dismiss();this.oU=this.tx=this.VH=this.tsa=this.fI=this.Pta=null;Sys.Component.prototype.dispose.call(this)}Hi(B){return this.get_element().id+
B}Snh(){this.fI=this.dh.createElement("div");this.fI.id=this.Hi("WACCalloutHeader");this.fI.className="WACCalloutHeader";this.Ru&&this.cwe();this.ikc&&this.rxe();this.VH=this.dh.createElement("div");this.VH.id=this.Hi("WACCalloutContent");this.VH.className="WACCalloutContent";this.VH.style.width=190<this.D3?this.D3-26+"px":"164px";this.VH.appendChild(this.content);this.PX.appendChild(this.Rtb);this.PX.appendChild(this.fI);this.PX.appendChild(this.VH)}cwe(){this.tx=this.dh.createElement("a");this.tx.className=
"WACCalloutCloseAnchor";this.tx.id=this.Hi("WACCalloutCloseAnchor");this.tx.href="#";this.fI.appendChild(this.tx);const B=e.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",!0,CommonUIStrings.l_DialogClose);this.tx.appendChild(B)}rxe(){this.oU=this.dh.createElement("div");this.oU.className="WACCalloutTitle UIFontBold";this.oU.style.width=190<this.D3?this.D3-30+"px":"160px";this.oU.id=this.Hi("WACCalloutTitle");this.oU.innerText=this.title;this.fI.contains(this.tx)?this.fI.insertBefore(this.oU,
this.tx):this.fI.appendChild(this.oU)}QQj(){var B=this.Kse;let E;if(1===this.sV){var I=this.tEe.y+16;E=-16}else 2===this.sV||3===this.sV||0===this.sV?(I=B.y+B.height+15,E=-15):(I=B.y-this.PX.clientHeight-15-2,E=this.PX.clientHeight-1);this.PX.style.top=I+"px";this.Rtb.style.top=E+"px";1===this.sV?(B=this.tEe.x-16,this.PX.style.left="50%",this.PX.style.marginLeft=-this.D3/2+"px",I=Sys.UI.DomElement.getBounds(this.PX),this.Rtb.style.left=B-I.x+"px"):(I=B.x+this.Kse.width/2,2===this.sV||5===this.sV?
(B=20,I-=36):0===this.sV||4===this.sV?(B=this.D3/2-16,I-=this.D3/2):(B=this.D3-20-32,I=I-this.D3+36),this.PX.style.left=I+"px",this.Rtb.style.left=B+"px")}xn(){this.Ru&&!this.qU&&(this.qU=Object(b.a)(this,this.pca,"closeHandler"),this.QQ.ta(f.a.click,this.tx,this.qU,null))}Uca(){this.Ru&&this.qU&&(this.QQ.Aa(f.a.click,this.tx,this.qU),this.qU=null)}pca(){this.dismiss();return!0}}Object(r.a)(h,"Callout",Sys.UI.Control,[273]);class l extends h{constructor(B,E,I,S,J,K=null){super(B,I,J.PY,K);this.dme=
0;this.D3=this.f$h(S);this.Q0a=E;this.Wf=J;this.x7j=7;this.xm=this.Q0a.ownerDocument.createElement("div");this.xm.className="ModalCalloutControlOverlay";this.xm.tabIndex=0;this.Q0a.insertBefore(this.xm,this.Q0a.firstChild)}show(){this.RPa||(this.Wf.Jxc(),this.Wf.lR(!1),this.xm.style.zIndex=String(this.Wf.R4),super.show(),this.vj(),this.dme=window.setTimeout(Object(b.a)(this,this.dismiss,"dismiss"),1E3*this.x7j))}dismiss(){this.RPa&&(this.Wf.bO(!1),this.xj(),this.Q0a&&this.Q0a.contains(this.xm)&&this.Q0a.removeChild(this.xm),
super.dismiss(),window.clearTimeout(this.dme))}vj(){this.Wf.Yua(Object(b.a)(this,this.dismiss,"dismiss"));this.Wf.Xz.ta(f.a.click,this.xm,Object(b.a)(this,this.Ud,"onClick"))}xj(){this.Wf.cgb(Object(b.a)(this,this.dismiss,"dismiss"));this.Wf.Xz.Aa(f.a.click,this.xm,Object(b.a)(this,this.Ud,"onClick"))}Ud(){this.dismiss();return!0}f$h(B){let E=0;switch(B){case 0:E=190;break;case 1:E=250;break;case 2:E=300;break;case 3:E=360}return E}}Object(r.a)(l,"ModalCallout",h,[]);var k=a(469),u=a(187);class v extends l{constructor(B,
E,I,S,J,K=null){super(B,E,I,S,J,K);this.O_b=null}show(){if(!this.RPa){const B=Object.assign(new k.a,{onShow:()=>{l.prototype.show.call(this)}});u.UISurfaces.aJ().then(E=>{const I=E.externalNotification();this.O_b=E.addNotification(I,B);return null},E=>{c.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",E);return null})}}dismiss(){this.RPa&&this.O_b&&(u.UISurfaces.aJ().then(B=>{B.removeNotification(this.O_b);return this.O_b=null},B=>{c.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",
B);return null}),super.dismiss())}}Object(r.a)(v,"ReactManagedModalCallout",l,[]);var x=a(6);class w{static Cph(B,E,I){return x.AFrameworkApplication.sa.Qa.HS?new v(B,E,I,3,x.AFrameworkApplication.sa,null):new l(B,E,I,3,x.AFrameworkApplication.sa,null)}}Object(r.a)(w,"ModalCalloutControlFactory",null,[]);var m=a(57),t=a(906),z=a(597),y=a(907),D=a(147),H=a(60),F=a(41),G=a(84),L=a(853),M=a(725);a.d(C,"a",function(){return O});class O{static get j6b(){return O.Iha||(O.Iha=G.a.instance.nh("Common.Utils.IAriaNotifier"))}static HOe(B,
E,I,S){O.HK&&O.HK.RPa&&O.HK.dismiss();O.HK=w.Cph(E,B,B);O.HK.content=I;M.b(S)||(O.HK.title=S,O.HK.ikc=!0);B=new Sys.UI.Bounds(0,0,H.a.ajc(),H.a.$ic());O.HK.sV=O.P1h(B,E,O.HK.D3);O.HK.show();O.j6b&&O.j6b.sendNotification(I.innerText,!0)}static Ead(B,E,I,S=null){u.UISurfaces.aJ().then(J=>{let K=null;O.Lpb&&(J.removeNotification(O.Lpb),O.Lpb=null);const R=J.callout(Object.assign(new t.a,{target:B,title:E,content:I,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new y.a,
{onDismiss:()=>{J.removeNotification(K)},directionalHint:null!=S?S:null})})),Z=Object.assign(new k.a,{expirationOptions:Object.assign(new z.a,{displayTimeoutSeconds:7,onExpire:()=>{J.removeNotification(O.Lpb)}})});K=O.Lpb=J.addNotification(R,Z);return null},J=>{c.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",J);return null})}static d0d(B,E=null){O.HK&&O.HK.RPa&&O.HK.dismiss();const I=new D.StandardDialog;I.iWa=!1;I.Ac=0;I.rB(m.a.qMi,CommonUIStrings.l_DialogError,M.b(B)?
O.h$e():B,E)}static e0d(B){O.HK&&O.HK.RPa&&O.HK.dismiss();c.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",B.errorCode));const E=M.b(B.description)?O.h$e():B.description,I=new D.StandardDialog;let S=null;B.cka?(I.Ac=1,I.Qc(1,B.buttonText),I.R2(1)):I.Ac=0;S=J=>{1===J?B.cka():B.bla&&B.bla()};I.iWa=!1;0===B.kPa?I.rB(B.errorCode,B.title?B.title:CommonUIStrings.l_DialogError,E,S):1===B.kPa?I.QT(B.title?B.title:CommonUIStrings.l_DialogWarning,E,S):I.Rqa(B.title?
B.title:CommonUIStrings.l_DialogInfo,E,S)}static P1h(B,E,I){let S=4;const J=B.x+B.width-E.x-E.width;E.x-B.x+E.width/2<=I/2?S=5:J+E.width/2<=I/2&&(S=6);return S}static sXj(B,E,I,S=!1){(E=L.a.hAb(E))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(E,J=>{J&&(S||O.Ead(J,I,B,5))})}static tXj(B,E,I=!1){O.sXj(E.startedNode?E.startedNode.description:String.format(CommonUIStrings.l_NewAddInLoadedContent,B),E,E.startedNode?E.startedNode.title:
String.format(CommonUIStrings.l_NewAddInLoadedTitle,B),I)}static rXj(B,E,I,S){if(O.xvg)B=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentOuterString,String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,I,S,CommonUIStrings.l_InsertionDialogRefresh)),O.Ead(E,B,CommonUIStrings.l_ErrorLoadingAddInsTitle,1);else{E=F.a.nq(E);var J=CommonUIStrings.l_ErrorLoadingAddInsContentOuterString.split("{0}"),K=document.createElement("span");K.innerText=J[0];var R=document.createElement("span");
R.innerText=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,I,S,CommonUIStrings.l_InsertionDialogRefresh);R.className="UIFontBold";I=document.createElement("span");I.innerText=J[1];S=document.createElement("div");Sys.UI.DomElement.addCssClass(S,"ModalCalloutControl");S.appendChild(K);S.appendChild(R);S.appendChild(I);O.HOe(B,E,S,CommonUIStrings.l_ErrorLoadingAddInsTitle)}}static JYj(B,E){var I=CommonUIStrings.l_InstallingCustomFunctionsErrorCalloutMsg,S=CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg;
O.xvg?O.Ead(E,I,S):(E=F.a.nq(E),O.HOe(B,E,O.x9g(S),I))}static x9g(B){const E=document.createElement("div");Sys.UI.DomElement.addCssClass(E,"ModalCalloutControl");E.innerText=B;return E}static h$e(){return CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive}static get xvg(){return x.AFrameworkApplication.sa.Qa.Tk&&x.AFrameworkApplication.sa.Qa.HS}}O.HK=null;O.Lpb=null;O.Iha=null;Object(r.a)(O,"AddInCommandsNotificationFactory",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSOpt.agave.js.map/cfa251239feabfaad65182caefd9c349/EwaDSOpt.agave.js.map