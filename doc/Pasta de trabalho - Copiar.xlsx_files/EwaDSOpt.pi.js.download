'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[5],{1090:function(r,C,a){a.d(C,"a",function(){return c});r=a(0);class c{}c.KLc="b-ring_Apc_Trans";c.Oyg="cdn_static_resource_ewa_image";Object(r.a)(c,"ResourceHosts",null,[])},1091:function(r,C,a){a.d(C,"a",function(){return e});r=a(0);var c=a(62),b=a(1360);class e{static Ykd(f,d,h,l=null){e.ntc||(e.ntc=Array.isArray(c.a.ij(h.xa.NetworkMeasurementUrlList))?c.a.ij(h.xa.NetworkMeasurementUrlList):null);const k=[];
for(let u=0;u<e.ntc.length;u++){const v=e.ntc[u];let x=v.key;x||(x=v.Key);if(l&&!l.includes(x))continue;let w=v.value;w||(w=v.Value);x&&w&&k.push(new b.a(h,x,w,f,d))}return k}}e.ntc=null;Object(r.a)(e,"NetworkConnectionHelpers",null,[])},1093:function(r,C,a){a.d(C,"a",function(){return b});var c=a(522);const b=()=>{c.a.sj(".ewa-bb{padding:0;display:block;background-color:#fcf7b6;color:#444;position:relative;overflow:hidden;cursor:default}.ewa-bb-entry{position:relative;height:auto;border-bottom:1px solid #d7d889;overflow:hidden}.ewa-bb.ewa-bb-react{background-color:#f5f5f5}.ewa-bb-entry:first-child{border-top:1px solid #d7d889}.ewa-bb-entry-body{min-height:24px;position:relative}.ewa-bb-icon{vertical-align:middle;display:inline-block}.ewa-bb-entry-icon{margin:2px 6px 0;display:inline-block}.ewa-bb-entry-title{font-weight:bold}.ewa-bb-entry-message{padding:0 8px}.ewa-bb-entry-button{background-color:#fff;border:1px solid #ababab;color:#444;text-align:center;cursor:default;margin-bottom:1px;padding:3px 10px 4px}.ewa-bb-entry-button:hover{background:#f0f0f0}.ewa-bb-entry-button:active{background:#c6c6c6}.ewa-bb-entry-link{color:#369}.ewa-bb-entry-close{position:absolute;top:50%;margin-top:-8px;cursor:pointer}.ewa-bb-entry-close .clip16x16{display:inline-block}.ewa-bb-entry-title,.ewa-bb-entry-message,.ewa-bb-entry-button-holder,.ewa-bb-entry-link{vertical-align:middle}.ewa-root-ltr .ewa-bb-entry-close,.ewa-nov2-ltr .ewa-bb-entry-close{right:2px}.ewa-root-ltr .ewa-bb-content,.ewa-nov2-ltr .ewa-bb-content{margin-right:26px}.ewa-root-ltr .ewa-bb-entry-button-holder,.ewa-nov2-ltr .ewa-bb-button-holder,.ewa-root-ltr .ewa-bb-entry-link,.ewa-nov2-ltr .ewa-bb-entry-link{margin-left:8px}.ewa-root-rtl .ewa-bb-entry-close,.ewa-nov2-rtl .ewa-bb-entry-close{left:2px}.ewa-root-rtl .ewa-bb-content,.ewa-nov2-rtl .ewa-bb-content{margin-left:26px}.ewa-root-rtl .ewa-bb-entry-button-holder,.ewa-nov2-rtl .ewa-bb-button-holder,.ewa-root-rtl .ewa-bb-entry-link,.ewa-nov2-rtl .ewa-bb-entry-link{margin-right:8px}")}},
1094:function(r,C,a){a.d(C,"a",function(){return f});r=a(0);var c=a(15),b=a(41),e=a(64);a=a(737);class f extends a.a{constructor(d,h){super(d,h);c.ULS.sendTraceTag(537170201,0,50,"WacGdprNoticeBusinessBarEntry.WacGdprNoticeBusinessBarEntry: Called");this.title="";this.message=f.OAa;this.Tya=!0}get linkText(){return f.JCf}$oa(d){super.$oa(d);b.a.openWindow(4,e.a.ZI(f.ICf))}XE(d){super.XE(d);f.oEd&&f.oEd(null)}static initialize(d,h,l,k){c.ULS.sendTraceTag(537170200,0,50,"WacGdprNoticeBusinessBarEntry.Initialize: Called");
f.OAa=d;f.JCf=h;f.ICf=l;f.oEd=k}}f.OAa=null;f.JCf=null;f.ICf=null;f.oEd=null;Object(r.a)(f,"WacGdprNoticeBusinessBarEntry",a.a,[])},1095:function(r,C,a){a.d(C,"a",function(){return c});r=a(0);class c{}c.CFh="ewa-bb";c.EFh="ewa-bb-entry";c.MFh="ewa-bb-react";c.FFh="ewa-bb-entry-body";c.LFh="ewa-bb-icon";c.HFh="ewa-bb-entry-icon";c.KFh="ewa-bb-entry-title";c.JFh="ewa-bb-entry-message";c.XYe="ewa-bb-entry-button";c.IFh="ewa-bb-entry-link";c.GFh="ewa-bb-entry-close";c.YYe="ewa-bb-entry-button-holder";
c.DFh="ewa-bb-content";Object(r.a)(c,"CssClassNames",null,[])},1096:function(r,C,a){a.d(C,"a",function(){return c});r=a(0);a=a(737);class c extends a.a{constructor(b,e){super(b,e);this.Rs=!0;this.title=c.I3;this.message=c.G3}get actionButton(){return c.fZ}Ym(b){super.Ym(b);(b=c.kU)&&b(null)}static initialize(b,e,f,d){c.I3=b;c.G3=e;c.fZ=f;c.kU=d}}c.I3=null;c.G3=null;c.fZ=null;c.kU=null;Object(r.a)(c,"AutomaticSensitivityLabelBusinessBarEntry",a.a,[])},1097:function(r,C,a){a.d(C,"a",function(){return c});
r=a(0);a=a(737);class c extends a.a{constructor(b,e){super(b,e);this.Rs=!0;this.title=c.I3;this.message=c.G3}get actionButton(){return c.fZ}Ym(b){super.Ym(b);(b=c.kU)&&b(null)}static initialize(b,e,f,d){c.I3=b;c.G3=e;c.fZ=f;c.kU=d}}c.I3=null;c.G3=null;c.fZ=null;c.kU=null;Object(r.a)(c,"RecommendedSensitivityLabelBusinessBarEntry",a.a,[])},1098:function(r,C,a){a.d(C,"a",function(){return c});r=a(0);a=a(876);class c extends a.a{constructor(b,e,f){super(b,e,f);c.fZ&&c.kU&&(this.Rs=!0);this.title=c.I3;
this.message=c.G3}get actionButton(){return c.fZ}static initialize(b,e,f,d){c.I3=b;c.G3=e;c.fZ=f;c.kU=d}Ym(b){super.Ym(b);c.kU&&c.kU(null)}}c.I3=null;c.G3=null;c.fZ=null;c.kU=null;Object(r.a)(c,"DataCleansingBusinessBarEntry",a.a,[])},1099:function(r,C,a){a.d(C,"a",function(){return c});r=a(0);a=a(737);class c extends a.a{constructor(b,e){super(b,e);this.Rs=!0;this.title=c.I3;this.message=c.G3}get actionButton(){return c.fZ}Ym(b){super.Ym(b);(b=c.kU)&&b(null)}static initialize(b,e,f,d){c.I3=b;c.G3=
e;c.fZ=f;c.kU=d}}c.I3=null;c.G3=null;c.fZ=null;c.kU=null;Object(r.a)(c,"MandatorySensitivityLabelBusinessBarEntry",a.a,[])},1100:function(r,C,a){a.d(C,"a",function(){return c});r=a(0);a=a(737);class c extends a.a{constructor(b,e){super(b,e);this.Rs=!0;this.title=c.LIb;this.message=c.OAa}get actionButton(){return c.Sbb}Ym(b){super.Ym(b);c.QAa&&c.QAa(null)}static initialize(b,e,f,d){c.LIb=b;c.OAa=e;c.Sbb=f;c.QAa=d}}c.LIb=null;c.OAa=null;c.Sbb=null;c.QAa=null;Object(r.a)(c,"SensitivityLabelMinorVersionLimitReachedBusinessBarEntry",
a.a,[])},1101:function(r,C,a){a.d(C,"a",function(){return c});r=a(0);a=a(737);class c extends a.a{constructor(b,e){super(b,e);c.Sbb&&c.QAa&&(this.Rs=!0);this.title=c.LIb;this.message=c.OAa}get actionButton(){return c.Sbb}Ym(b){super.Ym(b);c.QAa&&c.QAa(null)}static initialize(b,e,f,d){c.LIb=b;c.OAa=e;c.Sbb=f;c.QAa=d}}c.LIb=null;c.OAa=null;c.Sbb=null;c.QAa=null;Object(r.a)(c,"SensitivityApplicationSetLabelErrorBusinessBarEntry",a.a,[])},1103:function(r,C,a){a.d(C,"a",function(){return v});r=a(0);C=
a(230);var c=a(795),b=a(52),e=a(426),f=a(40),d=a(727),h=a(100),l=a(149),k=a(35),u=a(72);class v extends C.a{constructor(x){super();this.$=x;this.uc()}create(){const x=b.GetServiceTaskFactory.create(this.$.da,102,this.$.ka,this.La),w=Object(u.b)("OfficeVSO:7811663_ConvertBusinessBarManagerService2")?Object(h.d)(l.a.resolve(k.h,{Wa:this.La})):b.GetServiceTaskFactory.Za(this.$.da,5,4,this.La),m=b.GetServiceTaskFactory.Za(this.$.da,388,387,this.La),t=Object(h.d)(l.a.resolve(k.W,{Wa:this.La})),z=b.GetServiceTaskFactory.Za(this.$.da,
257,258,this.La),y=e.a(this.$);f.TaskExtensions.za(f.TaskExtensions.xe([x,z,y,w,m,t],this.ka),()=>{this.$b(Object(d.a)(this.$.da,271,()=>new c.ConvertToLinkedEntityManager(this.$,x.result,m.result,z.result,y.result,w.result,t.result)))},this.$.ka,3)}static la(x){x.da.Ja(272,new v(x))}}Object(r.a)(v,"ConvertToLinkedEntityManagerFactory",C.a,[])},1104:function(r,C,a){a.d(C,"a",function(){return c});const c=b=>{const e=Array(b.length);for(let f=0,d=b.length;f<d;f++)e[f]=b[f].cloneNode(!0);return e}},
1105:function(r,C,a){a.d(C,"a",function(){return f});r=a(0);C=a(230);var c=a(984),b=a(987),e=a(727);class f extends C.a{constructor(d){super();this.$=d;this.uc()}create(){const d=Object(e.a)(this.$.da,494,()=>{const h=new b.DataCleansingAnnotationsManager(this.$);return new c.DataCleansingHostManager(this.$,h)});this.$b(d)}static la(d){d.da.Ja(495,new f(d))}}Object(r.a)(f,"DataCleansingHostManagerFactory",C.a,[])},1108:function(r,C,a){a.d(C,"a",function(){return b});var c=a(522);const b=()=>{c.a.sj(".ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:start:decrement{background:linear-gradient(120deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(240deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(0deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:end:increment{background:linear-gradient(300deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(60deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(180deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:start:decrement{background:linear-gradient(30deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(150deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(270deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:end:increment{background:linear-gradient(210deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(330deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(90deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-button:start:decrement,.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-button:end:increment,.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-thumb{width:calc(16px/var(--zoom-level,1));height:calc(16px/var(--zoom-level,1));border:solid calc(1px/var(--zoom-level,1)) #363636;background-color:#b1b1b1}@media screen and (-ms-high-contrast:active){.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar{background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-thumb{background-color:WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-corner{background-color:Window}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:start:decrement{-ms-high-contrast-adjust:none;background:linear-gradient(120deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(240deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(0deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:end:increment{-ms-high-contrast-adjust:none;background:linear-gradient(300deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(60deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(180deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:start:decrement{-ms-high-contrast-adjust:none;background:linear-gradient(30deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(150deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(270deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:end:increment{-ms-high-contrast-adjust:none;background:linear-gradient(210deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(330deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(90deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}}")}},
1112:function(r,C,a){a.d(C,"a",function(){return b});var c=a(522);const b=()=>{c.a.sj('.ewa-sharedUi-launchButton,.ewa-sharedUi-launchButtonWithText{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#fff;padding:2px;cursor:default;width:fit-content}.ewa-sharedUi-launchButton:hover{background-color:#c6c6c6}.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#b1b1b1;padding:1px;cursor:default;width:fit-content}@media(forced-colors:active){.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{background-color:Highlight;color:HighlightText;border-color:CanvasText;forced-color-adjust:none}.ewa-sharedUi-launchButtonClick svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButton:active svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButtonWithTextClick svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-sharedUi-launchButtonWithText .clip16x16,.ewa-sharedUi-launchButtonWithTextClick .clip16x16{float:left}.ewa-sharedUi-launchButton input{cursor:default}.ewa-sharedUi-launchButton .clip16x16,.ewa-sharedUi-launchButtonClick .clip16x16{padding:0}.ewa-sharedUi-launchButtonText{font-family:"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif;font-size:10pt;overflow:hidden;padding-left:2px;cursor:pointer}')}},
1114:function(r,C,a){function c(k,u){this.ID=k;this.type=u}function b(k,u){this.value=k;this.contextId=u}function e(k,u,v,x,w,m,t,z){this.type=k;this.startTime=null==v||void 0==v.value?new b(v,null):v;this.endTime=null==x||void 0==x.value?new b(x,null):x;null!=w&&void 0!=w.value||new b(w,null);null!=m&&void 0!=m.value||new b(m,null);this.operationType=z}function f(k){this.ID=k}function d(){this.Of=[];this.Qsb=[];this.V3c=0;this.duration=this.startTime=null;this.edc={};this.qFd=this.VFd=this.z5c=-1}
function h(k){var u;return(null!=document.body.style.msTransform?u=k.style.msTransform:null!=document.body.style.webkitTransform?u=k.style.webkitTransform:null!=document.body.style.mozTransform?u=k.style.Fok:null!=document.body.style.oTransform?u=k.style.Jok:null!=document.body.style.transform&&(u=k.style.transform),u)?(u=u.replace("rotate(",""),u=u.replace("deg)",""),parseFloat(u)):0}a.d(C,"a",function(){return h});new c(0,0,0,0,0,0);new c(1,1,0,0,0,0);new c(2,2,0,0,0,0);new c(3,3,0,0,0,1);new c(4,
3,1,0,1,1);new c(5,3,0,0,.42,1);new c(6,3,.83,0,1,1);new c(7,3,0,0,.58,1);new c(8,3,.42,0,.58,1);new c(9,3,.1,.25,.75,.9);new c(10,3,.1,.9,.2,1);new c(11,3,.1,.9,.2,1);new c(12,3,.9,.1,.2,1);new c(13,3,.4,0,0,1);new c(14,3,.13,.21,.1,.7);new c(15,3,.02,.33,.38,.77);new c(16,3,.57,.17,.95,.75);new c(17,3,0,.19,.07,.72);new c(18,3,0,0,.95,.37);new c(19,3,.66,0,.34,1);new c(20,3,.8,0,.2,1);new c(21,3,.8,0,.2,1);e.prototype={type:0,startTime:new b(0,null),endTime:new b(0,null),dpk:new b(0,null),gok:new b(0,
null),operationType:0};r=Array(1);r[0]=new b(0,0);new f(0,[new e(5,0,0,0,null,1,1,0)]);new f(1,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,50,null,1,1,0)]);new f(2,[new e(1,3,0,167,null,0,1,1),new e(2,3,0,167,null,0,1,1)]);new f(3,[new e(3,3,0,167,null,0,1,1),new e(4,3,0,167,null,0,1,1)]);new f(4,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,167,null,1,1,0)]);new f(5,[new e(5,2,0,167,null,0,1,0)]);new f(6,[new e(1,3,0,100,null,0,1,1),new e(2,3,0,100,null,0,1,1)]);new f(7,[new e(3,3,0,100,null,0,1,1),new e(4,
3,0,100,null,0,1,1)]);new f(8,[new e(5,2,0,100,null,1,1,0)]);new f(9,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,100,null,1,1,0)]);new f(10,[new e(5,2,0,100,null,0,1,0)]);new f(11,[new e(1,3,0,267,null,0,1,1),new e(2,3,0,267,null,0,1,1)]);new f(12,[new e(3,3,0,267,null,0,1,1),new e(4,3,0,267,null,0,1,1)]);new f(13,[new e(5,2,0,267,null,1,1,0)]);new f(14,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,267,null,1,1,0)]);new f(15,[new e(5,2,0,267,null,0,1,0)]);new f(16,[new e(6,3,0,267,null,0,1,1),new e(7,3,0,267,
null,0,1,1)]);new f(17,[new e(1,3,0,750,null,0,1,1),new e(2,3,0,750,null,0,1,1)]);new f(18,[new e(3,3,0,750,null,0,1,1),new e(4,3,0,750,null,0,1,1)]);new f(19,[new e(5,2,0,750,null,1,1,0)]);new f(20,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,750,null,1,1,0)]);new f(21,[new e(6,3,0,1E3,null,0,1,1),new e(7,3,0,1E3,null,0,1,1)]);new f(22,[new e(1,3,0,367,null,0,1,1),new e(2,3,0,367,null,0,1,1)]);new f(23,[new e(3,3,0,367,null,0,1,1),new e(4,3,0,367,null,0,1,1)]);new f(24,[new e(5,2,0,367,null,1,1,0)]);new f(25,
[new e(5,2,0,0,null,0,2,0),new e(5,2,0,367,null,1,1,0)]);new f(26,[new e(5,2,0,367,null,0,1,0)]);new f(27,[new e(6,2,0,r[0],null,0,1,1),new e(7,2,0,r[0],null,0,1,1)]);new f(28,[new e(5,2,0,0,null,1,1,0),new e(5,2,0,50,null,0,1,0)]);new f(29,[new e(1,3,0,433,null,0,1,1),new e(2,3,0,433,null,0,1,1)]);new f(30,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,50,null,1,1,0),new e(2,3,0,0,null,40,1,1),new e(2,3,0,100,null,0,1,1)]);new f(31,[new e(2,0,0,0,null,32,1,1),new e(2,0,0,100,null,32,1,1),new e(2,3,101,350,
null,0,1,1),new e(3,0,0,0,null,0,2,1),new e(3,0,0,100,null,0,2,1),new e(3,3,101,350,null,0,1,1),new e(5,0,0,0,null,0,2,0),new e(5,0,0,100,null,1,1,0)]);new f(32,[new e(2,3,0,267,null,32,1,1),new e(3,3,0,267,null,0,2,1),new e(5,2,0,0,null,1,0,0),new e(5,2,0,267,null,0,2,0)]);new f(33,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,100,null,0,2,0),new e(5,2,101,267,null,1,1,0)]);new f(34,[new e(1,10,0,300,null,0,1,1),new e(2,10,0,300,null,0,1,1)]);new f(35,[new e(3,10,0,300,null,0,1,1),new e(4,10,0,300,null,
0,1,1)]);new f(36,[new e(1,8,0,750,null,0,1,1),new e(2,8,0,750,null,0,1,1)]);new f(37,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,200,null,0,2,0),new e(5,3,201,500,null,1,1,0)]);new f(38,[new e(1,2,0,0,null,0,2,1),new e(2,2,0,0,null,0,2,1),new e(1,2,0,200,null,0,2,1),new e(2,2,0,200,null,0,2,1),new e(1,3,201,267,null,0,1,1),new e(2,3,201,267,null,0,1,1)]);new f(39,[new e(1,3,0,267,null,0,1,1),new e(2,3,0,267,null,0,1,1)]);new f(40,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,267,null,1,1,0)]);new f(41,[new e(5,
2,0,267,null,0,1,0)]);window.location.search.indexOf("AnimationLogging=1");window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(k){window.setTimeout(k,16)}}();d.prototype={Of:null,Q0g:5,Qsb:null,V3c:0,startTime:null,duration:null,edc:null,z5c:-1,VFd:-1,qFd:-1};d.prototype.Start=function(){this.startTime=new Date;this.edc={}};d.prototype.GetRecentAnimationStats=
function(){var k,u=[],v=0;for(k=l.V3c;k<l.Q0g;k++)null!=l.Qsb[k]&&(u[v]=l.Qsb[k],v++);for(k=0;k<l.V3c;k++)null!=l.Qsb[k]&&(u[v]=l.Qsb[k],v++);return u};d.prototype.GetAnimationSqmStats=function(){var k=[];return k[0]=0>l.z5c?0:l.z5c,k[1]=0>l.VFd?0:l.VFd,k[2]=0>l.qFd?0:l.qFd,k};var l=new d},1115:function(r,C,a){a.d(C,"a",function(){return b});var c=a(1116);const b=()=>{Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=c.a}},1118:function(r,
C,a){a.d(C,"a",function(){return l});r=a(0);var c=a(6);C=a(190);var b=a(163),e=a(10),f=a(58),d=a(52),h=a(40);class l extends C.a{constructor(k){super();this.fP=()=>{this.Cud()};this.lfa=()=>{this.Cud()};this.$=k}dispose(){this.$&&b.a(this.$)&&(b.a(this.$).qUa(this.lfa),this.$.ea.O9(this.fP));this.$=null;super.dispose()}CAh(){c.AFrameworkApplication.jab()&&!this.Cud()&&(b.a(this.$).kJa(this.lfa),this.$.ea.c5(this.fP))}Cud(){return this.$.isEditMode&&(c.AFrameworkApplication.H5a||f.a.qh.Uv)?(b.a(this.$).qUa(this.lfa),
h.TaskExtensions.za(d.GetServiceTaskFactory.create(this.$.da,119,this.ka,1),k=>{k.result.initialize()},this.ka,3),!0):!1}static main(){e.a.Fa(k=>{(new l(k)).CAh()})}}Object(r.a)(l,"FileOpSliceDownloaderBootStraper",C.a,[])},1201:function(r,C,a){r=a(0);var c=a(88),b=a(563),e=a(15),f=a(147);class d{constructor(U,ma,ra){this.E0d=this.F0d=this.G0d=!1;this.T0d=!U&&!ma;this.U0d=!U&&!ra;this.T0d||this.U0d||(this.G0d=!U,this.F0d=!ma,this.E0d=!ra)}}Object(r.a)(d,"RenameDisabledDialogInfo",null,[]);class h extends f.StandardDialog{constructor(U,
ma,ra,Va,ob){super();this.$3d=[];this.j4=new d(U,ma,ra);this.zua=Va;this.qta=ob;this.ef="RenameDisabledDialog";this.Ac=0;this.Qc(1,CommonUIStrings.l_DialogClose);this.fRj();this.KAj()}fRj(){this.j4.T0d?this.ySb(this.zua?this.qta?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.j4.U0d?this.ySb(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.QTg();this.Mua(this.$3d)}ySb(U){Array.add(this.$3d,
U)}QTg(){const U=[];this.j4.G0d||Array.add(U,CommonUIStrings.l_RenameFileRenameDisabledSignIn);this.j4.F0d||Array.add(U,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.j4.E0d||Array.add(U,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<U.length&&Array.add(this.$3d,U)}}Object(r.a)(h,"ReactRenameDisabledDialogBase",f.StandardDialog,[]);class l extends h{constructor(U,ma,ra,Va,ob){super(U,ma,ra,Va,ob)}KAj(){this.cJb(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)}}
Object(r.a)(l,"ReactRenameDisabledDialog",h,[]);var k=a(156);class u{static get Qg(){return k.a.lq(u.cm,CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}u.cm="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(r.a)(u,"RenameDisabledDialogHtml",null,[]);class v extends k.a{constructor(U,ma,ra,Va,ob){super();this.j4=new d(U,ma,ra);this.zua=Va;this.qta=ob;this.ef="RenameDisabledDialog";this.Ac=0;this.Qc(1,CommonUIStrings.l_DialogClose);this.Qg=u.Qg;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.EY("RenameRow")}idb(){if(this.j4.T0d){let U;U=this.zua?this.qta?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;
v.ySb(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),U)}else this.j4.U0d?v.ySb(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.Xpi()}Xpi(){this.j4.G0d&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.j4.F0d&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display="none");this.j4.E0d&&
(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static ySb(U,ma,ra){U.style.display="none";ma.innerText=ra}}Object(r.a)(v,"RenameDisabledDialog",k.a,[]);var x=a(6),w=a(32),m=a(111),t=a(27);class z{constructor(U,ma){this.xHa=0;this.Na=U;this.vaa=ma}initialize(U){if(!this.Na||!this.vaa)return!1;this.xHa=U;this.Ih();return!0}Ih(){this.Na.Hc(t.a.zka,m.a.frame,Object(c.a)(this,this.zka,"commitNewDocumentTitle"))}zka(U,ma,ra,Va,ob){if(1===ra)return this.Na.processAction(t.a.renameFile,
1);U=w.a.Sq(this.vaa.so);ob=(0,ob.getNewDocumentTitle)();ob.length>this.xHa&&(ob=ob.substr(0,this.xHa));if(32!==this.Na.Le(t.a.renameFile,2,ob))return this.XY(U),8;this.XY(ob);return 32}XY(U){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(U))}static Ond(){return new z(x.AFrameworkApplication.dc,x.AFrameworkApplication.zn)}}Object(r.a)(z,"ReactRenameUIHandler",null,[462]);var y=a(96),D=a(532),H=a(565),F=a(14),G=a(113),L=a(250),M=a(93),O=a(41),B=a(31),E=a(84);class I{constructor(U,ma,
ra,Va,ob,ja,lb,wb,Ab,nb,pb,cb){this._initialized=!1;this._element=null;this.xHa=0;this.RYc=this.kSc=!1;this.Na=U;this.zNc=ma;this.Te=ra;this.NB=Va;this.vaa=ob;this.zqe=ja;this.r1b=lb;this.uOc=wb;this.Haa=Ab;this.cje=nb;this.b_a=pb;this.fTc=cb}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(U,ma,ra){if(!(this.Na&&this.vaa&&this.zqe&&this.r1b&&this.uOc&&ma)||0>=U)return!1;this._element=ma;this._element.title=ra;this._element.setAttribute(M.a.te,M.a.Au);this._element.setAttribute("Unselectable",
"on");this.xHa=U;this.fv();return this._initialized=!0}fv(){this.zNc&&(this.zNc.ta(F.a.blur,this._element,Object(c.a)(this,this.onBlur,"onBlur")),this.zNc.ta(F.a.paste,this._element,Object(c.a)(this,this.onPaste,"onPaste")));this.Te.ta(F.a.Ic,this._element,Object(c.a)(this,this.onKeyDown,"onKeyDown"));this.NB.ta(F.a.pointerDown,this._element,Object(c.a)(this,this.onPointerDown,"onPointerDown"));this.NB.ta(F.a.Zg,this._element,Object(c.a)(this,this.Wh,"onPointerUp"))}onBlur(){this.isActive&&!this.kSc&&
(this.cje||this.uOc(this._element),this.pMe(),this.Zcd(!1));return this.kSc=!1}onPaste(){e.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(U){return this.isActive?this.T8i(U):this.U8i(U)}T8i(U){let ma=!1;switch(U.Da.keyCode){case Sys.UI.Key.enter:this.pMe();this.Zcd(this.b_a||this.fTc);ma=!0;break;case Sys.UI.Key.tab:this.cje&&this.uOc(this._element);break;case Sys.UI.Key.esc:this.SUd(),this.Zcd(this.b_a||this.fTc),ma=!0}return ma}U8i(U){let ma=!1;
switch(U.Da.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.vqg(this.fTc),this.isActive&&this.r1b(this._element),ma=!0}return ma}onPointerDown(){this.isActive||(this.vqg(!1),this.isActive&&(this._element.focus(),this.r1b(this._element),this.RYc=!0));return!1}Wh(){return this.RYc?(this.r1b(this._element),this.RYc=!1,!0):!1}iab(){return 32===this.Na.processAction(t.a.renameFile,1)}pMe(){const U=w.a.Sq(this.vaa.so);let ma=this._element.innerText.trim();ma.length>this.xHa&&(ma=ma.substr(0,this.xHa));
ma!==U&&""!==ma?32!==this.Na.Le(t.a.renameFile,2,ma)?this.SUd():this.XY(ma):this.SUd()}SUd(){this.XY(w.a.Sq(this.vaa.so))}XY(U){this._initialized&&(this._element.innerText=U,this.zqe())}vqg(U){this.iab()?this.isActive||(U&&(this.kSc=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(M.a.te,M.a.M4c),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,y.CuiHelper.pWe),this.Haa&&
this.Haa.execute(ma=>{ma.E_f(!0)}),U&&this._element.focus(),e.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.Na.processAction(t.a.pib,2)}Zcd(U){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(M.a.te,M.a.Au);Sys.UI.DomElement.removeCssClass(this._element,y.CuiHelper.pWe);this.Haa&&this.Haa.execute(ma=>{ma.E_f(!1)});U&&(this._element.blur(),this._element.focus())}static mB(){D.a.mB(x.AFrameworkApplication.isRtl)}static Ond(){return new I(x.AFrameworkApplication.dc,
H.a.instance,G.KeyInputManager.instance,L.a.instance,x.AFrameworkApplication.zn,I.mB,O.a.aJj,O.a.bfh,E.a.instance.Dc("Common.App.Header.HeaderEventSource"),B.a.Qna,B.a.Fh,B.a.Bg)}}Object(r.a)(I,"RenameUIHandler",null,[462]);class S{static get instance(){return x.AFrameworkApplication.sa.Qa.Uv?S.Oa||(S.Oa=z.Ond()):S.Oa||(S.Oa=I.Ond())}}S.Oa=null;Object(r.a)(S,"RenameUIHandlerFactory",null,[]);var J=a(103),K=a(148);class R{constructor(){this.QYi=this.MYi=this.Ath=null}}Object(r.a)(R,"RenameMruEntryProperties",
null,[]);var Z=a(384),P=a(179),V=a(666),Ea;(function(U){U[U.unknown=-1]="unknown";U[U.success=0]="success";U[U.renameInvalidFileName=1]="renameInvalidFileName";U[U.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";U[U.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";U[U.permissionDenied=4]="permissionDenied";U[U.serverCommunicationFailure=5]="serverCommunicationFailure";U[U.fileNameTooLong=6]="fileNameTooLong"})(Ea||(Ea={}));Object(r.b)("CommonOperationResult",Ea);class oa{constructor(U,
ma,ra,Va,ob,ja,lb,wb,Ab,nb,pb,cb){this.qje=U;this.Na=ma;this.EOc=ra;this.vx=Va;this.rHa=ob;this.FQg=ja;this.zua=lb;this.Bte=wb;this.fNg=Ab;this.qta=nb;this.Ra=pb;this.eNg=cb}Ih(){x.AFrameworkApplication.sa&&x.AFrameworkApplication.sa.Qa.Uv||this.Ni.Hc(t.a.VDb,m.a.frame,Object(c.a)(this,this.VDb,"initializeRenameUIHandler"));this.Ni.Hc(t.a.pib,m.a.frame,Object(c.a)(this,this.pib,"showRenameDisabledDialog"));this.Ni.Hc(t.a.renameFile,m.a.frame,Object(c.a)(this,this.renameFile,"renameFile"));this.Ni.pf(t.a.fileNameUpdate,
m.a.frame,Object(c.a)(this,this.mtj,"refreshFilename"),64);this.Ni.pf(t.a.$sc,m.a.frame,Object(c.a)(this,this.$sc,"moveToFolderCompleteByHost"),64);this.Ni.Hc(t.a.XRa,m.a.frame,Object(c.a)(this,this.XRa,"moveToFolder"));(x.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IgnorePostMessageChecksForMove",!0)||x.AFrameworkApplication.sa&&(x.AFrameworkApplication.fa.ra("PostMessageEmbedded")||x.AFrameworkApplication.fa.ra("IsJsApi"))&&x.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",
!0))&&x.AFrameworkApplication.oS().execute(U=>{U.wn(P.a.nFf);U.ql(P.a.nFf,oa.bsj);U.wn(P.a.Nid);U.ql(P.a.Nid,oa.$rj)})}iab(){return 0===this.eNg.Jdf()?32:8}dik(){return this.Lx?this.zua?this.Lx.kVe:this.Lx.v7a:!0}VDb(){return S.instance.initialize(x.AFrameworkApplication.Zec,x.AFrameworkApplication.H5a,x.AFrameworkApplication.hTd||CommonUIStrings.l_RenameFileTooltip)?32:8}pib(){const U=this.dik(),ma=this.FQg();e.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",
this.rHa,ma,U,this.zua);x.AFrameworkApplication.sa&&x.AFrameworkApplication.sa.Qa.$w&&x.AFrameworkApplication.fa.ra("ReactRenameDisabledDialogIsEnabled")?new l(this.rHa,!ma,!U,this.zua,this.qta()):new v(this.rHa,!ma,!U,this.zua,this.qta());return 32}renameFile(U,ma,ra,Va,ob){if(1===ra)return this.iab();if(!x.AFrameworkApplication.vec)return 8;if(8===this.iab())return this.Ni.processAction(t.a.pib,2),8;e.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");x.AFrameworkApplication.vec(ob,Object(c.a)(this,
this.oLb,"onRenameFileSuccess"),Object(c.a)(this,this.Haj,"onRenameFileFailure"));x.AFrameworkApplication.AAj=!0;return 32}oLb(U,ma){U?0!==U.OperationResult?this.Qhf(U.OperationResult):(this.sKj(ma,U.NewName),this.qdk(U,Object(c.a)(x.AFrameworkApplication.sa.Qa,x.AFrameworkApplication.sa.Qa.lug,"updateOpenInClientDocumentUrl")),x.AFrameworkApplication.fa.ra("DocumentNameInJewelInfoMenuIsEnabled")&&x.AFrameworkApplication.sa.updateCommandUI(),this.fNg.Isg()):this.Qhf(5)}sKj(U,ma){const ra={};ra[Z.a.dSh]=
ma;U.sendMessage(P.a.Nid,ra)}qdk(U,ma){this.Fdk(U);x.AFrameworkApplication.Ubc=U.DirectInvokeDavUrl;ma=ma(U.EditDocInClientUrl);const ra=new R;ra.QYi=this.vx.so;ra.Ath=ma;ra.MYi=U.EditDocInClientUrl;this.Ni.Le(t.a.renameMostRecentlyUsedFileEntry,2,ra)}Qhf(U){switch(U){case 1:U=new f.StandardDialog,U.Ac=0,U.QT(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.A8f()}}Fdk(U){this.vx.so=oa.u1g(this.vx.so,U.NewName);U.BreadcrumbFolderName&&(this.vx.breadcrumbFolderName=
U.BreadcrumbFolderName);U.BreadcrumbFolderUrl&&(this.vx.breadcrumbFolderUrl=U.BreadcrumbFolderUrl);this.Bte(U.NewName)}Haj(U){const ma=new f.StandardDialog;ma.Ac=0;switch(U){case 1:e.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");ma.Rqa(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:e.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");ma.Rqa(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,
null);break;default:e.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:U}),ma.Rqa(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}x.AFrameworkApplication.oS().execute(ra=>{ra.sendMessage(P.a.cSh,{["FailureMessage"]:Ea[U]})});this.A8f()}mtj(U,ma,ra){if(1===ra)return this.iab();if(!x.AFrameworkApplication.NMa)return 8;x.AFrameworkApplication.NMa(Object(c.a)(this,this.Cvc,"onRefreshFilenameSuccess"),Object(c.a)(this,this.Bvc,"onRefreshFilenameFailure"),
!1);return 32}XRa(U,ma,ra,Va,ob){if(1===ra)return x.AFrameworkApplication.fa.ra("UiHostSupportsMoveToFolder")?32:8;if(2===ra){const ja={};U=x.AFrameworkApplication.xea;ma=x.AFrameworkApplication.fa.ra("UiHostSupportsDocRebootFeatures");U=(!U||U&&ma)&&x.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);ja[Z.a.d4j]=U;ob&&ob.MoveButtonClickedTime&&(ja[Z.a.mXi]=ob.MoveButtonClickedTime.getTime());x.AFrameworkApplication.oS().execute(lb=>{lb.sendMessage(P.a.XRa,
ja)});if(ob&&ob.MoveButtonClickedTime){if(U=K.a.zt())ob=(new Date).getTime()-ob.MoveButtonClickedTime.getTime(),U.set("MovePostDuration",ob.toString());J.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",U)}return 32}return 8}$sc(U,ma,ra,Va,ob){if(1===ra)return x.AFrameworkApplication.fa.ra("UiHostSupportsMoveToFolder")?this.iab():8;if(2===ra){if(!x.AFrameworkApplication.ybg)return J.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),
8;if(!ob)return J.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(ob[Z.a.TAi])if(ob[Z.a.jvg])if(U=ob[Z.a.jvg].toLowerCase(),ma=x.AFrameworkApplication.fa.ra("UiHostSupportsDocRebootFeatures"),ra=x.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),ma&&x.AFrameworkApplication.xea&&ra){const ja={};ja[Z.a.RTa]="1";ja[Z.a.documentUrl]=U;ja[Z.a.reason]=V.a.saveAs;J.Health.instance.recordKpiSuccess("MoveToFolder",null);x.AFrameworkApplication.oS().execute(lb=>
{lb.sendMessage(P.a.$_,ja)})}else if(!x.AFrameworkApplication.xea&&ra)J.Health.instance.recordKpiSuccess("MoveToFolder",null),O.a.Vf(U,O.a.aZ(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return J.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else J.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else x.AFrameworkApplication.NMa(Object(c.a)(this,this.Cvc,"onRefreshFilenameSuccess"),Object(c.a)(this,this.Bvc,"onRefreshFilenameFailure"),
!1),x.AFrameworkApplication.ybg(),J.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32}QWj(U,ma){return U&&ma?U!==this.vx.breadcrumbFolderName||ma!==this.vx.breadcrumbFolderUrl:!1}Cvc(U,ma){U&&(U.NewName!==w.a.Sq(this.vx.so)||this.QWj(U.BreadcrumbFolderName,U.BreadcrumbFolderUrl))&&this.oLb(U,ma)}Bvc(){}A8f(){this.Bte(w.a.Sq(this.vx.so))}get Ni(){return this.Na.value}get Lx(){return this.EOc.value}static get instance(){return oa.Oa||(oa.Oa=oa.hma())}static hma(){return new oa(x.AFrameworkApplication.jab,
new b.a(()=>x.AFrameworkApplication.dc),new b.a(()=>x.AFrameworkApplication.Lx),x.AFrameworkApplication.zn,x.AFrameworkApplication.limitedEdit,()=>x.AFrameworkApplication.userCanRename,x.AFrameworkApplication.yAc,Object(c.a)(S.instance,S.instance.XY,"updateTitle"),E.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>x.AFrameworkApplication.isReadOnlyRecommended,x.AFrameworkApplication.fa,E.a.instance.resolve("Common.IRenameProps"))}static u1g(U,ma){U=w.a.Z6(U);return ma+U}static bsj(U){const ma=
U.Values[Z.a.XEi];e.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",ma);ma?x.AFrameworkApplication.dc.Le(t.a.$sc,2,U.Values):J.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static $rj(U){x.AFrameworkApplication.dc.Le(t.a.renameFile,2,U.Values.NewName)}}oa.Oa=null;Object(r.a)(oa,"RenameActor",null,[]);a(581);class ea{}Object(r.a)(ea,"ActivityEventName",null,[]);class aa{}aa.compatMode="CompatMode";aa.noSelection="NoSelection";
Object(r.a)(aa,"ActivityEventReason",null,[]);var ia=a(664);class ya{constructor(U,ma){this.Na=U;this.fZa=ma}Ih(){this.Na.Hc(t.a.qjg,m.a.frame,Object(c.a)(this,this.uZj,"showRenameDialogAction"))}uZj(U,ma,ra){U=32;if(1===ra)return ia.SessionStatusManager.instance.P8a||x.AFrameworkApplication.R7?8:32;2===ra&&(32!==this.Na.processAction(t.a.renameFile,1)?(this.Na.processAction(t.a.pib,2),U=8):32===this.Na.processAction(t.a.xSb,1)?this.Na.processAction(t.a.xSb,2):this.fZa.value.create().gFc());return U}}
Object(r.a)(ya,"RenameDialogActor",null,[454]);class za{constructor(U,ma,ra){this.dialog=null;this.Na=U;this.vx=ma;this.cta=ra}idi(){const U={};U.nameInputProps={["type"]:"AppInputProps",["id"]:za.G5a,["label"]:CommonUIStrings.l_RenameDialogLabel,["value"]:w.a.Sq(this.vx.so),["maxLength"]:this.cta};return U}gFc(){const U={["id"]:"RenameDialog",["bodyControls"]:this.idi()};this.dialog=new k.a(!1,!1,!0);this.dialog.Ac=1;this.dialog.ef="RenameDialog";this.dialog.initializeAndShow(CommonUIStrings.l_RenameDialogTitle,
Object(c.a)(this,this.fTd,"renameDialogHandler"),U)}fTd(U,ma){ma&&1===U&&ma[za.G5a]&&(U=w.a.Sq(this.vx.so),ma=(ma[za.G5a]||"").trim(),ma!==U&&""!==ma&&this.Na.Le(t.a.renameFile,2,ma))}}za.G5a="txtDocumentName";Object(r.a)(za,"ReactRenameDialog",null,[463]);class la{static get Qg(){return k.a.lq(la.cm,CommonUIStrings.l_RenameDialogLabel)}}la.cm="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(r.a)(la,"RenameDialogHtml",null,[]);class xa extends k.a{constructor(U,ma,ra){super();this.Na=U;this.vx=ma;this.cta=ra;this.ef="RenameDialog";this.Qg=la.Qg}gFc(){var U={["txtDocumentName"]:w.a.Sq(this.vx.so)};this.initializeAndShow(CommonUIStrings.l_RenameDialogTitle,Object(c.a)(this,this.fTd,"renameDialogHandler"),U);U=document.getElementById(xa.G5a);0<this.cta&&(U.maxLength=this.cta);U.focus()}fTd(U,ma){1===U&&(U=w.a.Sq(this.vx.so),ma=(ma[xa.G5a]||"").trim(),ma!==U&&""!==ma&&this.Na.Le(t.a.renameFile,
2,ma))}}xa.G5a="txtDocumentName";Object(r.a)(xa,"RenameDialog",k.a,[463]);class wa{constructor(U){this.vaa=null;this.cta=0;this.Na=U;this._initialized=!1}initialize(U,ma){this.vaa=U;this.cta=ma;this._initialized=!0}create(){return this._initialized?x.AFrameworkApplication.sa&&x.AFrameworkApplication.sa.Qa.$w&&x.AFrameworkApplication.fa.ra("ReactRenameDialogIsEnabled")?new za(this.Na,this.vaa,this.cta):new xa(this.Na,this.vaa,this.cta):null}}Object(r.a)(wa,"RenameDialogFactory",null,[453]);var hb=
a(274),Ja=a(128),Fa=a(140),Ba=a(112),fa=a(108);class ta{constructor(U,ma){this.Na=U;this.Nc=ma}Ih(){this.Na.Hc(t.a.xSb,m.a.frame,Object(c.a)(this,this.vZj,"showRenameFlyoutAction"))}ebh(){return Fa.d("setDocumentTitleFlyoutOpened")&&x.AFrameworkApplication.sa.Qa.Uv}vZj(U,ma,ra){if(1===ra)return this.ebh()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}bVg(){ta.jIi&&x.AFrameworkApplication.T$a&&fa.a.instance.wg(new Ba.a(5,1,5E3,()=>{32===this.Na.processAction(t.a.xSb,
1)&&this.Nc&&this.Nc.Yi.name===hb.AFrame.o6&&(Ja.a("RenameFloatieShownOnNewDocumentLoad",!0),this.Na.processAction(t.a.xSb,2))}))}static get jIi(){ta.RZb&&null!=ta.RZb||(x.AFrameworkApplication.w8("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),ta.RZb=x.AFrameworkApplication.fa?x.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return ta.RZb}}ta.RZb=null;Object(r.a)(ta,"RenameFlyoutActor",null,
[452]);class Oa{constructor(U,ma,ra,Va,ob){this.EOc=ob;this.rje=ra;this.qje=Va;this.JQg=U;this.qta=ma}get Lx(){return this.EOc.value}Jdf(){if(!this.qje())return 5;if(this.qta())return 1;if(this.Lx){if(this.rje&&!this.Lx.kVe)return 3;if(!this.rje&&!this.Lx.v7a)return 4}return this.JQg()?0:2}}Object(r.a)(Oa,"RenameProps",null,[451]);a(198);var Ma=a(106);class fb{constructor(U,ma,ra,Va,ob,ja){this.Hy=!1;this.CUc=new Ma.a;this.mZa=ma;this.fN=ra;this.OEg=Va;this.Ra=ob;this.hse=ja}enable(){this.Hy||(this.Isg(),
this.o2d(),this.Hy=!0)}generateKey(U,ma,ra){return String.format("{0}/{1}/{2}",ra,U,ma)}W8h(){const U=w.a.Sq(this.mZa().so);return this.generateKey(this.mZa().breadcrumbFolderName,this.mZa().breadcrumbFolderUrl,U)}X8h(U,ma,ra){return U&&ma?this.generateKey(U,ma,ra):ra}Zxh(U,ma,ra){return U&&U!==this.mZa().breadcrumbFolderName||ma&&ma!==this.mZa().breadcrumbFolderUrl?!0:ra!==w.a.Sq(this.mZa().so)}Isg(){const U=this.W8h();this.CUc.ia(U,new Date)}KMd(U){this.oVj(U)&&this.Que(U)}oVj(U){const ma=this.OEg();
return ma?this.hse&&this.hse.AFb||!ma.Sqf||!x.AFrameworkApplication.NMa?(this.Tlg(U),this.Hy=!1):!0:!1}iSf(U,ma,ra,Va){const ob=this.Zxh(U,ma,ra);U=this.X8h(U,ma,ra);ma=this.CUc.Ad(U).returnValue;ob&&!ma&&(this.Rhf(Va),e.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.rDd));ob||this.CUc.ia(U,this.fN())}}Object(r.a)(fb,"ARenamedFileChecker",null,[427]);class pa extends fb{constructor(U,ma,ra,Va,ob,ja,lb,wb){super(U,ma,ra,Va,ob,ja);this.spe=ob;this.dNg=lb;this.xIg=wb}get rDd(){return"RenamedFileCheckerUsingSettingsRefresh"}o2d(){this.spe.T2c(Object(c.a)(this,
this.Dif,"handleSettingsRefresh"))}Dif(U,ma){ma&&ma.KJb&&ma.w0i&&(ma.sab("BreadcrumbDocName")||ma.sab("BreadcrumbFolderName")||ma.sab("BreadcrumbFolderUrl")||ma.sab("DirectInvokeDAVUrl")||ma.sab("EditDocInClientUrl"))&&(e.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.rDd),this.KMd(ma))}Tlg(){this.spe.r5f(Object(c.a)(this,this.Dif,"handleSettingsRefresh"))}Que(U){if(U&&U.KJb){const ma=U.KJb;this.iSf(ma.Va("BreadcrumbFolderName"),ma.Va("BreadcrumbFolderUrl"),ma.Va("BreadcrumbDocName"),
U)}}Rhf(U){const ma={OperationResult:0,classId:1};U=U.KJb;ma.BreadcrumbFolderName=U.Va("BreadcrumbFolderName");ma.BreadcrumbFolderUrl=U.Va("BreadcrumbFolderUrl");ma.DirectInvokeDavUrl=U.Va("DirectInvokeDAVUrl");ma.EditDocInClientUrl=U.Va("EditDocInClientUrl");U=U.Va("BreadcrumbDocName");ma.NewName=x.AFrameworkApplication.Pwa?U:w.a.Sq(U);this.xIg.execute(ra=>{this.dyi(ma,ra)})}dyi(U,ma){this.dNg().oLb(U,ma)}}Object(r.a)(pa,"RenamedFileCheckerUsingSettingsRefresh",fb,[]);class Ua extends fb{constructor(U,
ma,ra,Va,ob,ja,lb,wb,Ab,nb){super(U,ra,Va,ob,ja,Ab);this.Tpb=this.Z2b=null;this.mMg=ma;this.Na=lb;this.Me=wb;nb&&nb.execute(pb=>{this.Fvj(pb)})}get rDd(){return"RenamedFileCheckerUsingTask"}Fvj(U){this.Z2b=U;this.Z2b.Vye(Object(c.a)(this,this.tCb,"handleVisibilityChange"))}tCb(U,ma){!this.Hy||0!==ma.newState&&1!==ma.newState||this.Tpb||(this.o2d(),this.KMd(this.Tpb))}o2d(){this.Tpb=new Ba.a(3,2,this.mMg(),Object(c.a)(this,this.KMd,"performRenameFileCheckTick"),89);this.Me.wg(this.Tpb)}Tlg(U){this.Me.jq(U)}Que(U){this.Z2b&&
2===this.Z2b.Snk?this.Kwj(U):x.AFrameworkApplication.NMa(Object(c.a)(this,this.Cvc,"onRefreshFilenameSuccess"),Object(c.a)(this,this.Bvc,"onRefreshFilenameFailure"),!0)}Kwj(U){this.Me.jq(U);this.Tpb=null}Cvc(U){U&&this.iSf(U.BreadcrumbFolderName,U.BreadcrumbFolderUrl,U.NewName,null)}Rhf(){this.Na.processAction(t.a.fileNameUpdate,2)}Bvc(){}}Object(r.a)(Ua,"RenamedFileCheckerUsingTask",fb,[]);var Sa=a(102);class Ia{constructor(){this.Ra=this.Nb=null}get name(){return"Common.App.RenameFile"}Oi(U){this.Nb=
U;this.Ra=x.AFrameworkApplication.fa;this.Nb.register(ya,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").od(()=>new ya(x.AFrameworkApplication.dc,this.Nb.MUd("Common.App.Rename.IRenameDialogFactory"))).gd();this.Nb.register(wa,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").od(()=>new wa(x.AFrameworkApplication.dc)).gd();this.Nb.register(427,"Common.App.Rename.IRenamedFileChecker").od(()=>this.lrh()).gd();this.Nb.register(ta,
"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").od(()=>new ta(x.AFrameworkApplication.dc,Sa.FocusManager.instance())).gd()}lrh(){if(this.Ra.ra("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const U=this.Nb.nh("Common.IRefreshableAppSettings");if(U&&U.Utf)return new pa(()=>U.Ae("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>x.AFrameworkApplication.zn,()=>new Date,()=>x.AFrameworkApplication.Lx,U,this.Nb.nh("Common.ISessionStatus"),()=>oa.instance,this.Nb.Dc("Postmessage.IHostPostmessenger"))}return new Ua(()=>
this.Ra.Ae("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>this.Ra.Ae("RenamedFileCheckerPingIntervalInMs",12E4),()=>x.AFrameworkApplication.zn,()=>new Date,()=>x.AFrameworkApplication.Lx,x.AFrameworkApplication.fa,x.AFrameworkApplication.dc,x.AFrameworkApplication.Xi,this.Nb.nh("Common.ISessionStatus"),this.Nb.Dc("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.Ra.Rv(Object(c.a)(this,this.KC,"onFullAppSettingsReady"))}KC(){const U=x.AFrameworkApplication.sa.Qa.Uv;x.AFrameworkApplication.jab()&&
S.instance.initialize(x.AFrameworkApplication.Zec,U?null:x.AFrameworkApplication.H5a,U?null:x.AFrameworkApplication.hTd||CommonUIStrings.l_RenameFileTooltip)&&(this.Nb.register(Oa,"Common.App.Rename.RenameProps").as("Common.IRenameProps").od(()=>new Oa(()=>x.AFrameworkApplication.userCanRename,()=>x.AFrameworkApplication.isReadOnlyRecommended,x.AFrameworkApplication.yAc,x.AFrameworkApplication.jab,new b.a(()=>x.AFrameworkApplication.Lx))).gd(),oa.instance.Ih(),this.Ra.ra("RenameDialogIsEnabled")&&
(this.Nb.resolve("Common.App.Rename.RenameDialogFactory").initialize(x.AFrameworkApplication.zn,x.AFrameworkApplication.Zec),this.Nb.resolve("Common.App.Rename.IRenameDialogActor").Ih()),this.Nb.resolve("Common.App.Rename.IRenameFlyoutActor").Ih(),x.AFrameworkApplication.yAc&&this.Nb.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.Nb.resolve("Common.App.Rename.IRenameFlyoutActor").bVg())}dispose(){}}Object(r.a)(Ia,"PackageManager",null,[4,5]);var X=a(261);a.d(C,"a",function(){return ca});
const ca=()=>{Type.registerNamespace("Common.App.Rename");X.a.instance.wj(new Ia,7)}},1203:function(r,C,a){a.r(C);r=a(0);var c=a(15),b=a(90),e=a(113),f=a(14),d=a(92),h=a(57),l=a(32),k=a(31),u=a(13),v=a(249),x=a(1095),w=a(7),m=a(273),t=a(1096),z=a(737),y=a(997),D=a(876);class H extends D.a{constructor(Pa,Nb,Tb){super(Pa,Nb,Tb)}XE(Pa){super.XE(Pa)}}Object(r.a)(H,"EditAttemptReadOnlyBusinessBarEntry",D.a,[]);var F=a(50);class G extends z.a{constructor(Pa,Nb,Tb,Vb){super(Pa,Nb);this.error=Tb;this.options=
Vb;this.error&&this.options&2&&(this.message=this.error.Description);this.error&&this.options&1&&(this.title=this.error.Caption);this.Rs=!(Vb&4)}Ym(Pa){super.Ym(Pa);this.error.Appearance&=-33;F.a(this.businessBar.$).hv([this.error])}}Object(r.a)(G,"ErrorBusinessBarEntry",z.a,[]);var L=a(91);class M extends G{constructor(Pa,Nb,Tb,Vb,Jb){super(Pa,Nb,Tb,Vb);this.command=Jb;this.UW=!0}HX(Pa){super.HX(Pa);this.businessBar.$.Ia.mc(new L.a(this.command,Pa,this.businessBar.$.Tc,10,null))}}Object(r.a)(M,"ErrorAndCommandBusinessBarEntry",
G,[]);var O=a(16);class B{constructor(Pa,Nb,Tb,Vb,Jb,Qa,Db,sa,Ha,mb){this.FK=this.eaa=this.CQ=0;this.nEg=Pa;this.C7j=Nb;this.GK=Tb;this.zIg=Db;this.ynb=l.a.Av(Ha);this.FGg=Ha;this.Qbe=sa;this.AIg=mb;0!==Vb&&(this.CQ=Vb);0!==Jb&&(this.eaa=Jb);0!==Qa&&(this.FK=Qa)}get title(){return B.ha(this.C7j)}get message(){return B.ha(this.GK)}get messageId(){return this.GK}get iconName(){return this.AIg}get h3a(){return this.nEg}get actionButton(){return B.ha(this.CQ)}get EJa(){return B.ha(this.eaa)}get link(){return B.ha(this.FK)}get Dl(){return this.zIg}get businessBarType(){return this.Qbe}get hash(){return this.ynb}get alt(){const {BusinessBarControl:Pa}=
a(1203);switch(this.Dl){case Pa.pla:return B.ha(26);case Pa.rx:return B.ha(25);case Pa.gj:return B.ha(24);default:return B.ha(0)}}get yMa(){return this.FGg}set businessBarType(Pa){this.Qbe=Pa}static ha(Pa){return O.a.instance.ha(Pa)}}Object(r.a)(B,"EwaBusinessBarEntry",null,[]);class E extends B{constructor(Pa,Nb,Tb,Vb,Jb,Qa,Db,sa,Ha){super(Pa,0,Nb,Tb,Vb,Jb,Qa,Db,sa,Ha)}get title(){return""}}Object(r.a)(E,"EwaNoTitleBusinessBarEntry",B,[]);var I=a(76);class S extends z.a{constructor(Pa,Nb){super(Pa,
Nb);this.UW=this.Rs=!0}Ym(Pa){super.Ym(Pa);this.set_visible(!1);this.businessBar.$.TJ();this.businessBar.$.Ia.mc(new L.a(1038998010,Pa,this.businessBar.$.Tc,10,null))}HX(Pa){super.HX(Pa);this.businessBar.$.Ia.mc(new L.a(-722953877,Pa,this.businessBar.$.Tc,10,null))}XE(Pa){this.businessBar.removeEntry(55);I.g(Pa)}}Object(r.a)(S,"ExternalLinksEnableContentBusinessBarEntry",z.a,[]);class J extends z.a{constructor(Pa,Nb){super(Pa,Nb);this.Rs=!0;this.UW=!1}Ym(Pa){super.Ym(Pa);this.businessBar.$.Ia.mc(new L.a(-722953877,
Pa,this.businessBar.$.Tc,10,null))}XE(Pa){this.businessBar.removeEntry(5);I.g(Pa)}}Object(r.a)(J,"ExternalLinksShowErrorBusinessBarEntry",z.a,[]);var K=a(12);class R extends z.a{constructor(Pa,Nb,Tb){super(Pa,Nb);this.ZCb=Tb;this.Rs=!0}Ym(Pa){super.Ym(Pa);K.HelperMethods.iT(this.businessBar.$.sF,this.ZCb,this.businessBar.$.wQ)}}Object(r.a)(R,"HelpButtonBusinessBarEntry",z.a,[]);class Z extends z.a{constructor(Pa,Nb,Tb){super(Pa,Nb);this.ZCb=Tb;this.Tya=!0}$oa(Pa){super.$oa(Pa);K.HelperMethods.iT(this.businessBar.$.sF,
this.ZCb,this.businessBar.$.wQ)}}Object(r.a)(Z,"HelpTextBusinessBarEntry",z.a,[]);var P=a(75);class V extends z.a{constructor(Pa,Nb,Tb,Vb){super(Pa,Nb);this.ZCb=Tb;this.command=Vb;this.Tya=!0;this.Rs=1461300262!==Vb}Ym(Pa){super.Ym(Pa);this.businessBar.$.Ia.mc(new L.a(this.command,Pa,this.businessBar.$.Tc,10,null))}$oa(Pa){super.$oa(Pa);const Nb=new L.a(-859308420,Pa,this.businessBar.$.Tc,12,null);this.businessBar.$.Ia.mc(Nb,{[P.a.Og]:"HelpID="+this.ZCb,["InputMethod"]:Pa,[P.a.Gd]:w.a.rS,[w.a.lra]:!0})}}
Object(r.a)(V,"HelpTextTaskPaneAndCommandBusinessBarEntry",z.a,[]);class Ea extends z.a{constructor(Pa,Nb){super(Pa,Nb);this.UW=this.Rs=!0}Ym(Pa){super.Ym(Pa);this.set_visible(!1);this.businessBar.$.TJ();this.businessBar.$.Ia.mc(new L.a(-1081442996,Pa,this.businessBar.$.Tc,10,null))}HX(Pa){super.HX(Pa);this.businessBar.$.Ia.mc(new L.a(1702917262,Pa,this.businessBar.$.Tc,10,null))}XE(Pa){this.businessBar.removeEntry(59);I.g(Pa)}}Object(r.a)(Ea,"LinkedEntitiesEnableUntrustedImagesBusinessBarEntry",
z.a,[]);var oa=a(1099);class ea extends z.a{constructor(Pa,Nb){super(Pa,Nb);(this.policyManager=Pa.$.da.Ba(274))?(this.message=this.policyManager.sxc,this.title=this.policyManager.title,this.Tya=!0):c.ULS.sendTraceTag(537170202,306,50,"Tried creating PolicyBusinessBarEntry but policyManager service has not been registered.")}get linkText(){return this.policyManager.linkText}$oa(Pa){super.$oa(Pa);(Pa=this.policyManager.l9i)&&Pa(null)}}Object(r.a)(ea,"PolicyBusinessBarEntry",z.a,[]);var aa=a(1097),
ia=a(1101),ya=a(1100);a(427);var za=a(128),la=a(27);class xa extends z.a{constructor(Pa,Nb){super(Pa,Nb);this.Rs=!0;this.title=""}Ym(Pa){super.Ym(Pa);za.c(la.a.KYi);window.open("https://www.microsoft.com/edge?form=MI13FQ&OCID=MI13FQ","_blank")}}Object(r.a)(xa,"UnsupportedBrowserBusinessBarEntry",z.a,[]);var wa=a(1094),hb=a(88),Ja=a(896),Fa=a(949),Ba=a(1265);class fa{constructor(){this.$Mc=new Ba.a;this.YMc=new Ba.a;this.XMc=new Ba.a;this.j7g(this.$Mc);this.i7g(this.YMc);this.h7g(this.XMc);this.fSc=
new Ba.a;this.eSc=new Ba.a;this.dSc=new Ba.a;this.J9g(this.fSc);this.I9g(this.eSc);this.H9g(this.dSc);this.rOc=new Ba.a;this.C7g(this.rOc);this.aJa(this.rOc);this.aJa(this.XMc);this.aJa(this.YMc);this.aJa(this.$Mc);this.aJa(this.eSc);this.aJa(this.fSc);this.aJa(this.dSc)}Vfi(Pa,Nb){switch(Pa){case 1:return this.qji(Nb);case 2:return this.U_h(Nb)}return Fa.a.Z_d?this.rOc:null}j7g(Pa){Pa.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);Pa.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);
Pa.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)}i7g(Pa){Pa.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);Pa.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);Pa.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)}h7g(Pa){Pa.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);Pa.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);Pa.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)}J9g(Pa){Pa.add("Headline",
CommonUIStrings.l_WildFireWordBizBarHeadline);Pa.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);Pa.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);Pa.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);Pa.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);Pa.add("OverlayBig","Get the Word app");Pa.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");Pa.add("OverlaySmallSplit1",
"Discover Word");Pa.add("OverlaySmallSplit2","designed for the iPad.");Pa.add("SkipButton","Skip for now")}C7g(Pa){Pa.add("Headline","Get the Office Online extension for Chrome");Pa.add("UseAppButton","Get the extension");Pa.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")}I9g(Pa){Pa.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);Pa.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);Pa.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);
Pa.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);Pa.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);Pa.add("OverlayBig","Get the PowerPoint app");Pa.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");Pa.add("OverlaySmallSplit1","Discover PowerPoint");Pa.add("OverlaySmallSplit2","designed for the iPad.");Pa.add("SkipButton","Skip for now")}H9g(Pa){Pa.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);
Pa.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);Pa.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);Pa.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);Pa.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)}aJa(Pa){Pa.add("Corporation","Microsoft Corporation")}qji(Pa){switch(Pa){case 3:return this.fSc;case 2:return this.eSc;case 1:return this.dSc}return null}U_h(Pa){switch(Pa){case 3:return this.$Mc;case 2:return this.YMc;
case 1:return this.XMc}return null}static get instance(){fa.Oa||(fa.Oa=new fa);return fa.Oa}}fa.Oa=null;Object(r.a)(fa,"WildFireStringFactory",null,[]);var ta=a(6),Oa=a(41);class Ma{constructor(Pa,Nb,Tb,Vb,Jb=null,Qa=null){this.AWc=null;this._id=Pa;this.iXc=Nb;this.THg=Jb;this.Rnb=Vb;this.dqb=Qa;this.HFa=null;this.V0a=Tb;this.Eqb=fa.instance.Vfi(Nb,Pa)}SOe(){this.HFa=new Ja.a(this.title,this.message,null);this.HFa.addButton(this.tGe,Object(hb.a)(this,this.iJf,"onButtonOneClick"),"");this.V0a&&this.HFa.VUg(this.vGe,
Object(hb.a)(this,this.lJf,"onButtonTwoClick"));this.HFa.pca=Object(hb.a)(this,this.sUe,"dismissBar");this.HFa.image=3;this.HFa.id=16;this.HFa.closeable=!0}get title(){return this.Eqb.ma("Headline")}get message(){return this.Eqb.ma("CallToAction")}get Xhk(){return this.V0a}get tGe(){return this.V0a?this.Eqb.ma("InstallButton"):this.Eqb.ma("UseAppButton")}get vGe(){return this.V0a?this.Eqb.ma("OpenAppButton"):""}iJf(){this.V0a?this.Hwi():this.Nhk()}lJf(){this.V0a&&this.Uej()}get openUrl(){this.AWc||
(this.AWc=this.THg());return this.AWc}Hwi(){c.ULS.sendTraceTag(17932829,306,50,"Install App Button of BusinessBar Clicked");this.Rnb&&this.dqb&&this.dqb();Fa.a.O1f(this._id,this.iXc)}Uej(){this.openUrl&&(c.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.Rnb&&this.dqb&&this.dqb(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(Fa.a.oBe(this._id),this.openUrl,0,!1))}Nhk(){Fa.a.Z_d?this.O9g():(c.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),Fa.a.$Yd("BizBarClicked"),
1!==this.iXc&&2!==this.iXc||Fa.a.tfh(this.openUrl,this.Rnb,this._id,this.dqb))}O9g(){this.Rnb?c.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):c.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");Oa.a.aS(ta.AFrameworkApplication.fa.appSettings.WildFireChromeExtensionUrl.toString())}Cyh(){this.Rnb?c.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):c.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");Fa.a.$Yd(Fa.a.geh)}sUe(){Fa.a.Z_d?this.Cyh():(Fa.a.$Yd(Fa.a.t8e(this._id)),
c.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))}static cth(){const Pa=ta.AFrameworkApplication.sa.Qa,Nb=new Ma(Pa.li,Fa.a.vgf(),8<k.a.nDb,1===Pa.uBa,()=>Pa.Is,Pa.KGj());c.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed");return Nb}}Object(r.a)(Ma,"WildFireBusinessBar",null,[]);class fb extends z.a{constructor(Pa,Nb){super(Pa,Nb);this.pFa=Ma.cth();this.Rs=!0;this.UW=this.pFa.Xhk;this.title=this.pFa.title;this.message=this.pFa.message}get actionButton(){return this.pFa.tGe}get EJa(){return this.pFa.vGe}Ym(Pa){super.Ym(Pa);
this.pFa.iJf(null)}HX(Pa){super.HX(Pa);this.pFa.lJf(null)}XE(Pa){super.XE(Pa);this.pFa.sUe(null)}}Object(r.a)(fb,"WildFireMobileAppBusinessBarEntry",z.a,[]);var pa=a(260),Ua=a(23),Sa=a(191),Ia=a(169),X=a(44),ca=a(2),U=a(173),ma=a(1102),ra=a(70),Va=a(136);class ob extends z.a{constructor(Pa,Nb,Tb,Vb){super(Pa,Nb);this.officeScriptsCommandManager=Tb.da.Ba(519);c.ULS.shipAssertTag(512276321,0,!!this.officeScriptsCommandManager);this.id=U.a.create();this.$=Tb;this.title=O.a.instance.ha(2282);this.message=
"";this.y2d=O.a.instance.ha(2278);this.Swg=O.a.instance.ha(2279);this.Qwg=O.a.instance.ha(2280);this.iNe=O.a.instance.ha(2281);this.update(Vb)}update(Pa){this.scriptLink=Pa.scriptLink;this.runStatus=Pa.runStatus;this.buttonText=Pa.buttonText||"";this.CPi(Pa.clickId);this.cDj();"preparing"===this.runStatus?(this.sqa(0),this.message=String.format(O.a.instance.Xb(208),this.buttonText),this.Rs=!0,this.Hua=this.y2d,this.Avb=this.mja=this.Cdb):"running"===this.runStatus?(this.sqa(0),this.message=String.format(O.a.instance.Xb(207),
this.buttonText),this.Rs=!0,this.Hua=this.y2d,this.Avb=this.mja=this.Cdb):"succeeded"===this.runStatus?(this.sqa(0),this.message=String.format(O.a.instance.Xb(210),this.buttonText),"true"===Pa.hasLogs?(this.Rs=!0,this.Hua=this.Qwg,this.mja=this.mTf,this.UW=!0,this.M3c=this.Swg,this.N3c=this.nTf):(this.Rs=!0,this.Hua=this.Swg,this.mja=this.nTf)):"runFailed"===this.runStatus?(this.sqa(1),this.message=String.format(O.a.instance.Xb(209),this.buttonText),this.l9a=qb.pla,"true"===Pa.hasLogs?(this.Rs=!0,
this.Hua=this.Qwg,this.mja=this.mTf,"false"===Pa.isOwner&&(this.UW=!0,this.M3c=this.iNe,this.N3c=this.qKf)):"false"===Pa.isOwner&&(this.Rs=!0,this.Hua=this.iNe,this.mja=this.qKf)):"fetchFailed"===this.runStatus?(this.sqa(1),this.l9a=qb.pla,this.message=O.a.instance.ha(2284)):"canceled"===this.runStatus?(this.sqa(0),this.l9a=qb.rx,this.message=String.format(O.a.instance.Xb(212),this.buttonText)):"alreadyRunning"===this.runStatus?(this.sqa(5),this.l9a=qb.rx,this.message=String.format(O.a.instance.Xb(211),
this.buttonText),this.Rs=!0,this.Hua=this.y2d,this.Avb=this.mja=this.Cdb):"initializing"===this.runStatus&&(this.sqa(0),this.l9a=qb.gj,this.message=O.a.instance.ha(2283))}get Dl(){return this.l9a}get actionButton(){return this.Hua}get EJa(){return this.M3c}Ym(Pa){super.Ym(Pa);this.mja&&this.mja()}HX(Pa){super.HX(Pa);this.EJa&&this.N3c()}XE(Pa){super.XE(Pa);this.Avb&&this.Avb()}cDj(){this.message="";this.l9a=qb.gj;this.Rs=!1;this.Hua="";this.mja=void 0;this.UW=!1;this.M3c="";this.N3c=void 0;this.hideCloseButton=
!1;this.Avb=void 0}Cdb(){const Pa=U.a.create().toString();this.officeScriptsCommandManager.Aki(Pa);this.lrc(-2186799,Pa)}mTf(){const Pa=U.a.create().toString();this.officeScriptsCommandManager.zki(Pa);this.lrc(1036446140,Pa)}nTf(){const Pa=U.a.create();if(this.scriptLink){const Nb=new ma.b(this.scriptLink);this.officeScriptsCommandManager.Eif(this.id.toString(),JSON.stringify(Nb),Pa)}this.lrc(-585097204,Pa.toString())}qKf(){const Pa=U.a.create().toString();this.officeScriptsCommandManager.yki(Pa);
this.lrc(-639858579,Pa)}CPi(Pa){const Nb=[];Nb.push(Object(ca.a)(new ra.a,{name:"id",string:this.id.toString()}));Nb.push(Object(ca.a)(new ra.a,{name:"hasScriptLink",bool:!!this.scriptLink}));Nb.push(Object(ca.a)(new ra.a,{name:"runStatus",string:this.runStatus}));Nb.push(Object(ca.a)(new ra.a,{name:"clickId",string:Pa}));Nb.push(Object(ca.a)(new ra.a,{name:"hasButtonText",bool:!!this.buttonText&&""!==this.buttonText}));za.a(Va.a.f0i,void 0,void 0,Nb)}lrc(Pa,Nb){const Tb=[];Tb.push(Object(ca.a)(new ra.a,
{name:"id",string:this.id.toString()}));Tb.push(Object(ca.a)(new ra.a,{name:"hasScriptLink",bool:!!this.scriptLink}));Tb.push(Object(ca.a)(new ra.a,{name:"runStatus",string:this.runStatus}));Tb.push(Object(ca.a)(new ra.a,{name:"clickId",string:Nb}));za.d(Pa,void 0,void 0,void 0,void 0,void 0,Tb)}}Object(r.a)(ob,"OfficeScriptsRunStatusBusinessBarEntry",z.a,[]);var ja=a(51),lb=a(1);class wb extends D.a{constructor(Pa,Nb,Tb,Vb,Jb,Qa){super(Pa,Nb,Tb);ja.a.instance.create(()=>{this.showCallout(Nb,Vb)},
Jb,Qa,!0,!0)}showCallout(Pa,Nb){if(this.businessBar&&this.businessBar.Ena(Pa.h3a)&&this.lAe()){Pa=new L.a(-847286761,0,this.businessBar.$.Tc,0,null);var Tb={};Tb.CalloutName=Nb;lb.EwaSettings.isChangeGateEnabled("OfficeVSO:6947554_RetrieveBusinessBarButtonElementChange")?Tb.Target=this.HL():Tb.Target=lb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?this.domElement.getElementsByTagName("button")[0]:this.CQ.domElement;this.businessBar.$.Ia.mc(Pa,Tb)}}lAe(){return!0}}
Object(r.a)(wb,"CalloutBusinessBarEntry",D.a,[]);class Ab extends wb{constructor(Pa,Nb,Tb,Vb,Jb,Qa){super(Pa,Nb,Tb,Vb,Jb,Qa)}lAe(){if(!lb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!1))return!0;if(!this.businessBar)return!1;const Pa=this.businessBar.$.da.Ba(465);return Pa&&Pa.jCc?!1:!0}}Object(r.a)(Ab,"OptimizeWorkbookCalloutBusinessBarEntry",wb,[]);var nb=a(20);class pb extends z.a{constructor(Pa,Nb,Tb){super(Pa,Nb);this.update(Tb)}update(Pa){this.title=
Pa.title?Pa.title:"";this.message=Pa.message?Pa.message:"";this.sqa(this.Wkh(Pa.businessBarType));this.hideCloseButton=!!Pa.hideCloseButton}Wkh(Pa){switch(Pa){case "error":return 1;case "blocked":return 2;case "severeWarning":return 3;case "success":return 4;case "warning":return 5;default:return 0}}}Object(r.a)(pb,"MsFormsDataSyncStatusBusinessBarEntry",z.a,[]);class cb extends z.a{constructor(Pa,Nb,Tb,Vb){super(Pa,Nb);this.UW=this.Rs=!0;this.pmj=Tb;this.y0g=Vb}Ym(Pa){super.Ym(Pa);this.businessBar.$.Ia.mc(new L.a(this.pmj,
Pa,this.businessBar.$.Tc,10,null))}HX(Pa){super.Ym(Pa);this.businessBar.$.Ia.mc(new L.a(this.y0g,Pa,this.businessBar.$.Tc,10,null))}}Object(r.a)(cb,"DualCommandActionsBusinessBarEntry",z.a,[]);class Da extends z.a{constructor(Pa,Nb,Tb,Vb){super(Pa,Nb);this.host=Tb.xa.HostName;this.uqi="OneDriveWOPI"===this.host||"Open From URL"===this.host;"Open From URL"===this.host?appChrome.renderSaveACopyToOneDriveCallout(Vb,!1):(this.EHi=lb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SaveACopyToOneDrive",
!1)||lb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SaveACopyToOneDriveB",!1)||lb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SaveACopyToOneDriveC",!1))&&this.uqi&&appChrome.renderSaveACopyToOneDriveCallout(Vb,!1)}}Object(r.a)(Da,"EditAttemptReadOnlyNoEditPermissionsBusinessBarEntry",z.a,[]);var zb=a(1098);a.d(C,"BusinessBarControl",function(){return qb});class qb extends v.a{constructor(Pa,Nb){super(Nb);this.L5e=u.DOMElementExtensions.Nr+",div";this.NV=Array(74);
this.Nn=!1;this.KX=Tb=>{if(Tb.Da.keyCode===b.a.aA){var Vb=this.Wc.querySelectorAll(this.L5e);const Jb=u.DOMElementExtensions.Bm(Vb);Vb=u.DOMElementExtensions.pC(Vb);return u.DOMElementExtensions.CDa(Tb.Da,Jb,Vb)}return!1};this.Ub=Pa;this.set_visible(!1);this.addCssClass(x.a.CFh);lb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)&&this.addCssClass(x.a.MFh);e.KeyInputManager.instance.ta(f.a.Ic,this.Wc,this.KX);m.a(Pa).Zi(this)}get Qe(){return pa.a.H6c}get Wc(){return this.domElement}get Fg(){return this.get_visible()}get $(){return this.Ub}$g(Pa,
Nb){lb.EwaSettings.isChangeGateEnabled("OfficeVSO:7627987_BizBarA11yFocusFix")?Nb||u.DOMElementExtensions.setFocus(u.DOMElementExtensions.Bm(this.Wc.querySelectorAll(this.L5e))):Nb||u.DOMElementExtensions.setFocus(this.domElement.firstChild);return!Nb}ui(Pa){return u.DOMElementExtensions.zg(this.Wc,Pa)}pk(){}Rk(){}dispose(){this.Nn||(e.KeyInputManager.instance.Aa(f.a.Ic,this.Wc,this.KX),d.a.ed(this.NV),this.NV=Array(74),this.Ub=null,super.dispose(),this.Nn=!0)}Ena(Pa){if(!this.get_visible())return!1;
Pa=this.NV[Pa];return!!Pa&&Pa.isVisible}Cld(Pa){return this.Ena(Pa)?this.NV[Pa].HL():null}gG(Pa){return!!this.NV[Pa]}JUb(Pa,Nb){if(Pa=this.NV[Pa])Pa.update(Nb),Pa.Gdk()}LD(Pa,Nb,Tb=null,Vb=null){let Jb=!1;if(this.gG(Pa))Tb=this.NV[Pa].get_visible();else{this.set_visible(!0);const Qa=qb.Dgf()[Pa];this.NV[Pa]=this.Y5(Pa,Nb,Tb,Vb);Tb=!1;Jb=!0;Vb="";let Db=0;Nb&&(Vb=Nb.MessageIdName,Db=Nb.MessageId);const sa=Qa.yMa,Ha=X.PageLoadTrackingInfo.instance.zya(new Date);c.ULS.sendTraceTag(537170258,0,50,`BusinessBarControl.AddEntry of type: ${Pa}, time from app interactive: ${Ha}`);
lb.EwaSettings.isChangeGateEnabled("OfficeVSO:7232357_AvoidBsqmReportingForSuccessBizBars")&&4===Qa.businessBarType||Ia.a(this.$).ATd(Qa.hash,Vb,Db,h.a.UIc,!0,1,Nb,sa)}Tb||!y.BusinessBarManager.fjc().includes(Pa)&&!Jb||(this.NV[Pa].set_visible(!0),this.$.TJ())}removeEntry(Pa){return this.Awj(Pa)}BRd(){d.a.ed(this.NV);this.NV=Array(74);this.set_visible(!1)}Awj(Pa){if(!this.gG(Pa))return!1;d.a.Ka(this.NV[Pa]);this.NV[Pa]=null;this.domElement.hasChildNodes()||this.set_visible(!1);this.$.TJ();return!0}Y5(Pa,
Nb,Tb=null,Vb=null){const Jb=qb.Dgf()[Pa],Qa=!!(this.$.oe&64);switch(Pa){case 23:Pa=new Da(this,Jb,this.Ub,this.Wc);break;case 2:case 4:case 25:case 26:case 36:case 35:Pa=new z.a(this,Jb);break;case 12:case 29:case 30:case 31:case 32:case 57:Pa=Qa?new D.a(this,Jb,-8805455):new z.a(this,Jb);break;case 34:Pa=Qa?new cb(this,Jb,-8805455,-104572626):new z.a(this,Jb);break;case 22:Pa=new H(this,Jb,-8805455);break;case 46:case 45:Pa=Qa?new M(this,Jb,Nb,0,-8805455):new G(this,Jb,Nb,0);break;case 11:case 43:case 7:case 0:case 1:case 3:case 33:case 73:Pa=
new G(this,Jb,Nb,0);break;case 19:Pa=new z.a(this,Jb);break;case 47:Pa=new G(this,Jb,Nb,0);break;case 6:case 14:Pa=new R(this,Jb,Nb.HelpTopicId);break;case 67:case 65:Pa=new Z(this,Jb,Nb.HelpTopicId);break;case 72:Pa=new H(this,Jb,-1698025133);break;case 37:Pa=new Z(this,Jb,w.a.guh);break;case 38:Pa=new z.a(this,Jb);break;case 71:Pa=new z.a(this,Jb);break;case 68:Pa=new H(this,Jb,924877417);break;case 16:Pa=new z.a(this,Jb);Pa.title=l.a.xi(this.$.workbookContext.FullDocumentInfo.IrmPolicyTitle);Pa.message=
l.a.xi(this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription);break;case 18:Pa=new D.a(this,Jb,-1762562205);Pa.hideCloseButton=!0;break;case 20:Pa=new fb(this,Jb);break;case 21:case 56:Pa=new z.a(this,Jb);break;case 28:Pa=new z.a(this,Jb);break;case 24:Pa=new xa(this,Jb);break;case 27:Pa=new ea(this,Jb);break;case 39:Pa=new wa.a(this,Jb);break;case 40:Pa=new t.a(this,Jb);break;case 41:Pa=new aa.a(this,Jb);break;case 42:Pa=new oa.a(this,Jb);break;case 48:Pa=new z.a(this,Jb);break;case 49:Pa=
new z.a(this,Jb);break;case 50:Pa=new z.a(this,Jb);break;case 51:Pa=new z.a(this,Jb);break;case 52:Pa=new z.a(this,Jb);break;case 53:Pa=new ya.a(this,Jb);break;case 54:Pa=new ia.a(this,Jb);break;case 55:Pa=new S(this,Jb);break;case 5:Pa=new J(this,Jb);break;case 58:Pa=new D.a(this,Jb,-1753056834);Nb?(Nb=Nb.Directive,Ua.a.ar(Nb)||"&nbsp;"===Nb||(Pa.message=Nb)):Tb&&(Pa.message=Tb);break;case 59:Pa=new Ea(this,Jb);break;case 60:Pa=new z.a(this,Jb);break;case 63:Pa=new Z(this,Jb,w.a.g_i);break;case 61:Pa=
new V(this,Jb,w.a.b5g,-8805455);break;case 66:Pa=new V(this,Jb,w.a.Krj,1461300262);break;case 62:Pa=new Ab(this,Jb,515196233,13,3E5,"OptimizeWorkbookManager.ShowBusinessBarTeachingCallout");Pa.message=Tb;break;case 70:Pa=new zb.a(this,Jb,-1190551534);break;case 64:Pa=new ob(this,Jb,this.$,Vb);break;case 69:Pa=new pb(this,Jb,Vb);break;default:Pa=new G(this,Jb,Nb,7)}Pa.SOe();return Pa}static Dgf(){let Pa;Pa=Sa.a.Jna()?261:260;return qb.iGe||(qb.iGe=[new B(0,276,277,278,0,0,qb.pla,1,"BB_UnableToRefreshLock"),
new B(1,276,277,278,0,0,qb.pla,1,"BB_UnableToRefreshLockExpected"),new B(2,268,269,0,0,0,qb.rx,5,"BB_WorkbookAlmostTooLarge"),new B(3,270,271,272,0,0,qb.pla,1,"BB_WorkbookTooLarge"),new B(4,259,Pa,0,0,0,qb.rx,5,"BB_ExternalWorkbookLinksDisabled"),new B(5,263,262,264,0,0,qb.pla,5,"BB_ExternalWorkbookLinksShowError","Warning_MessageBar_16"),new B(6,265,266,267,0,0,qb.gj,0,"BB_EditAndRefreshDisabledOnBIAHostedFiles"),new B(7,251,252,253,0,0,qb.gj,5,"BB_UnsupportedFeatures"),new B(8,0,0,0,0,0,qb.gj,0,
"BB_CollabDataAndDataStringsLocaleMismatch"),new B(9,0,0,0,0,0,qb.gj,0,"BB_CollabDataStringsLocaleMismatch"),new B(10,0,0,0,0,0,qb.gj,0,"BB_CollabDataLocaleMismatch"),new B(11,279,280,281,0,0,qb.pla,1,"BB_LastGenericStatusError"),new B(12,282,283,284,0,0,qb.rx,5,"BB_ScratchPadWarning"),new B(13,285,286,287,0,0,qb.pla,1,"BB_AuthenticationLost"),new B(14,288,289,290,0,0,qb.rx,5,"BB_OdfCompatibilityIssues"),new B(15,0,575,0,0,0,qb.rx,5,"BB_PivotChartInteractivityMissingWarning"),new B(16,0,0,0,0,0,qb.gj,
2,"BB_WorkbookIsIrmProtected"),new B(17,0,0,0,0,0,qb.gj,0,"BB_BIFeatureNotAvailable"),new B(18,291,292,287,0,0,qb.rx,5,"BB_AnonymousCreateMode"),new B(19,254,255,0,0,0,qb.rx,5,"BB_UnsupportedInteractiveReportEditing"),new B(20,0,0,0,0,0,qb.gj,0,"BB_MobileAppCampaignBizBar"),new B(21,297,298,0,0,0,qb.gj,0,"BB_TransientServerCommunicationFailures"),new B(22,1643,1654,1655,0,0,qb.gj,5,"BB_EditAttemptInReadOnly"),new B(23,1643,1654,0,0,0,qb.gj,5,"BB_EditAttemptInReadOnlyNoEditPermissions"),new B(24,0,
K.HelperMethods.Yck(),1632,0,0,qb.gj,3,"BB_UnsupportedBrowser"),new B(25,300,301,0,0,0,qb.gj,2,"BB_ReadOnlyPermissions"),new B(26,302,303,0,0,0,qb.gj,2,"BB_DocumentIsIrmProtectedWarning"),new B(27,0,0,0,0,0,qb.rx,5,"BB_PolicyWarningMessage"),new B(28,1285,299,0,0,0,qb.gj,0,"BB_WorkingOnIt"),new B(29,1643,1641,1642,0,0,qb.gj,2,"BB_PasswordProtectedWorkbookLockedForEdit"),new B(30,1656,1657,1658,0,0,qb.gj,5,"BB_WorkbookIsReadOnlyRecommended"),new B(31,1643,1659,1660,0,0,qb.gj,5,"BB_WorkbookHasPasswordToModify"),
new B(32,1643,1661,1664,0,0,qb.gj,3,"BB_LegacySharedWorkbookEditWarning"),new B(33,1651,1662,253,0,0,qb.gj,5,"BB_LegacyConnectionsWarning"),new B(34,1643,1960,1961,1962,0,qb.gj,0,"BB_TooManyLoadBlockingFloatingObjects"),new B(35,1652,1653,0,0,0,qb.gj,2,"BB_GroupedSlicers"),new B(36,313,314,0,0,0,qb.rx,5,"BB_ThirdPartyAddinDisabled"),new B(37,1789,1790,0,0,1791,qb.gj,5,"BB_FinanceLinkedEntityDisclaimerBar"),new B(38,1818,1819,0,0,0,qb.rx,5,"BB_WolframDeprecationAlertBar"),new B(39,0,0,0,0,0,qb.gj,
0,"BB_WacGdprNotice"),new B(40,0,0,0,0,0,qb.gj,0,"BB_AutomaticSensitivityLabel"),new B(41,0,0,0,0,0,qb.gj,0,"BB_RecommendedSensitivityLabel"),new B(42,0,0,0,0,0,qb.gj,0,"BB_MandatorySensitivityLabel"),new B(43,315,316,317,0,0,qb.gj,0,"BB_LocalStorageDisabled"),new B(44,632,633,0,0,0,qb.gj,0,"BB_AutoRefreshDisabled"),new B(45,1014,1012,1016,1314,0,qb.gj,4,"BB_CorruptedFileRepaired"),new B(46,1015,1013,1016,1314,0,qb.gj,5,"CorruptedOdsFileRepaired"),new B(47,273,274,275,0,0,qb.rx,5,"BB_MinorVersionLimitReached"),
new B(48,304,305,0,0,0,qb.rx,5,"BB_SensitivityApplicationGenericError"),new B(49,306,308,0,0,0,qb.rx,5,"BB_SensitivityApplicationTooLargeFileError"),new B(50,307,308,0,0,0,qb.rx,5,"BB_SensitivityApplicationLabelNotSupportedError"),new B(51,309,310,0,0,0,qb.rx,5,"BB_SensitivityApplicationLabelDisabledError"),new B(52,311,312,0,0,0,qb.rx,5,"BB_SensitivityApplicationMandatoryConflictError"),new B(53,0,0,0,0,0,qb.rx,5,"BB_SensitivityApplicationMinorVersionLimitReachedError"),new B(54,0,0,0,0,0,qb.rx,
5,"BB_SensitivityApplicationSetLabelError"),new B(55,2119,2120,2121,2124,0,qb.gj,5,"BB_ExternalWorkbookLinksPromptEnableContent","Warning_MessageBar_16"),new B(56,297,298,0,0,0,qb.gj,0,"BB_NetworkDown"),new B(57,318,319,320,0,0,qb.gj,2,"BB_DefaultToViewDueToCogs"),new B(58,1815,1816,1817,0,0,qb.gj,1,"BB_RefreshLinkedEntityErrorBar"),new B(59,1792,1793,1794,1795,0,qb.gj,1,"BB_LinkedEntitiesUntrustedImagesDisabled"),new E(60,250,0,0,0,qb.gj,5,"BB_CanvasHealth"),new B(61,1017,1018,1314,0,1019,qb.gj,
5,"BB_MismatchedFileFormatConverted"),new B(62,2238,0,2240,0,0,qb.gj,5,"BB_OptimizeWorkbook"),new B(63,321,322,0,0,323,qb.gj,0,"BB_NovModePostDepreciation"),new B(64,0,0,0,0,0,qb.gj,0,"BB_OfficeScriptsRunning"),new B(65,2214,2215,0,0,2217,qb.gj,0,"BB_PowerQueryRefreshDataSourceNotSupported"),new B(66,324,325,0,0,326,qb.gj,5,"BB_ReadOnlyPivotTable"),new B(67,2214,2216,0,0,2217,qb.gj,0,"BB_PowerQueryRefreshHostNotSupported"),new B(68,1057,k.a.ioc?1059:1058,1056,0,0,qb.gj,4,"BB_RefreshPageAfterEnablingTheExtension"),
new B(69,0,0,0,0,0,qb.gj,0,"BB_MsFormsDataSyncStatus"),new B(70,0,0,0,0,0,qb.rx,5,"BB_DataCleansingSuggestions"),new E(71,2324,0,0,0,qb.gj,4,"BB_EditInMiniWAC","EditExcel_16"),new B(72,2326,2327,2325,0,0,qb.rx,5,"BB_PowerQueryUnsupportedTeams"),new B(73,2326,2328,2217,0,0,qb.rx,5,"BB_PowerQueryEnableThirdPartyCookies")])}}qb.pla=nb.a.WIh;qb.rx=nb.a.YIh;qb.gj=nb.a.XIh;qb.iGe=null;Object(r.a)(qb,"BusinessBarControl",v.a,[26])},1214:function(r,C,a){r={};a.r(r);a.d(r,"CalcManager",function(){return Ma});
var c=a(0),b=a(15),e=a(230),f=a(118),d=a(9),h=a(115);a(161);var l=a(198),k=a(126),u=a(188),v=a(100),x=a(74);class w{}w.local="Local";w.r6j="Thread";Object(c.a)(w,"RecalcServiceCreateMode",null,[]);var m=a(186);class t{constructor(X){this.Pce=null;this.init(X)}get qca(){return this.Pce}init(X){this.Pce=new u.a;if(void 0!==X&&null!==X&&void 0!==X.HeadersList&&null!==X.HeadersList&&0<X.HeadersList.length)for(const ca of X.HeadersList)this.qca.ia(ca.Index,ca.Name)}}Object(c.a)(t,"ColHeadersListData",
null,[]);var z=a(1),y=a(30),D=a(107),H=a(23),F=a(19),G=a(178);class L{constructor(X,ca){this.MGe=X;this.sheetName=ca;this.MQb=!1}}Object(c.a)(L,"CalcBlockInformation",null,[]);class M{constructor(X,ca,U,ma,ra){this.type=X;this.fullName=ca;this.range=U;this.sheetId=ma;this.attributes=ra;this.iG=null}}Object(c.a)(M,"CalcNamedObject",null,[]);class O{get hl(){return this.wre}constructor(X){this.zvg=X;this.wre=[];this.J6d=[];this.t3a={};this.QZd=new Map}$eg(X,ca){this.wre[X]=ca;this.zvg&&ca.s$&&this.QZd.set(ca.s$.sheetName,
X)}getSheetIndex(X){if(this.zvg){if(this.QZd.has(X))return this.QZd.get(X)}else for(let ca=1;ca<this.hl.length;ca++)if(H.a.equals(this.hl[ca].s$.sheetName,X,!1))return ca;return-1}}Object(c.a)(O,"GridCache",null,[]);var B=a(714),E=a(564);class I{constructor(X){this.s$=X;this.G8=new B.a(E.a.hh());this.ktc=!1}}Object(c.a)(I,"SheetInformation",null,[]);var S=a(992),J;(function(X){X[X.initialization=0]="initialization";X[X.contentReady=1]="contentReady";X[X.cellEdit=2]="cellEdit"})(J||(J={}));Object(c.b)("UpdateDataTrigger",
J);class K{constructor(X){this.tQd=null;this.PCd=this.sQd=this.GKd=!1;this.pOd=0;this.hOd=this.jOd=this.kOd=this.iOd=-1;this.trueName="TRUE";this.falseName="FALSE";this.instantaneousSupportInformationManager=this.yq=this.errorTypeNames=null;this.Ot=this.currentStateId=-1;this.Pka="";this.Pca=null;this.getNameLoc=(ca,U)=>this.Wnc()?this.Tf.ma(this.currentStateId).hl[0].G8.Pb(U)?(ca=excelOnlineCalc.location.nameLoc(ca,U),excelOnlineCalc.util.success(ca)):excelOnlineCalc.util.success(null):(ca=excelOnlineCalc.util.unavailable([2]),
excelOnlineCalc.util.failure(ca));this.getContainingTable=ca=>{if(!this.Wnc())return ca=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(ca);const U=ca.range.col,ma=ca.range.row;var ra=this.Tf.ma(this.currentStateId).hl[0].G8,Va=null;for(let ob of ra)if(ra=ob.value,2===ra.type&&H.a.equals(ca.sheet.index.toString(),ra.sheetId,!0)){const ja=ra.range;U>=ja.left-1&&U<=ja.right-1&&ma<=ja.bottom-1&&ma>=ja.top-1&&(Va=excelOnlineCalc.location.nameScope(this.documentLoc,ra.sheetId),Va=excelOnlineCalc.location.nameLoc(Va,
ra.fullName))}return Va?excelOnlineCalc.util.success(Va):excelOnlineCalc.util.success(null)};this.getStructRefColumn=(ca,U)=>{if(!this.Wnc()){var ma=excelOnlineCalc.util.unavailable([2]);return excelOnlineCalc.util.failure(ma)}ma=ca.name;var ra=this.Tf.ma(this.currentStateId).hl[0].G8;if(ra.Pb(ma)){ra=ra.ma(ma);const ob=ra.range;if(2!==ra.type)return excelOnlineCalc.util.failure(this.mbd(5));const ja=ra.iG?ra.iG.qca:null;if(!ja)return excelOnlineCalc.util.success(null);for(var Va of ja)if(H.a.equals(Va.value,
U,!0))return ca=excelOnlineCalc.location.documentLoc(ca.scope.document.path,ca.scope.document.name),ca=excelOnlineCalc.location.sheetIndex(ca,ra.sheetId),Va=excelOnlineCalc.location.gridRange(ob.top-1,Va.key,ob.bottom-ob.top+1,1),Va=excelOnlineCalc.location.sheetGridRange(ca,Va),ma=excelOnlineCalc.location.structRefColumnLoc(ma,Va,!!(ra.attributes&16),!!(ra.attributes&8)),excelOnlineCalc.util.success(ma);return ob.right-ob.left+1!==ja.count?(ma=excelOnlineCalc.util.unavailable([17,ca,U]),excelOnlineCalc.util.failure(ma)):
excelOnlineCalc.util.failure(this.mbd(0))}return excelOnlineCalc.util.success(null)};this.getStructRefSpecialRef=(ca,U)=>{if(!this.Wnc())return U=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(U);var ma=this.Tf.ma(this.currentStateId).hl[0].G8;if(ma.Pb(ca.name)){var ra=ma.ma(ca.name);if(2!==ra.type)return excelOnlineCalc.util.failure(this.mbd(5));ma=!!(ra.attributes&16);const Va=!!(ra.attributes&8),ob=ma?1:0,ja=Va?1:0;ca=excelOnlineCalc.location.documentLoc(ca.scope.document.path,
ca.scope.document.name);ca=excelOnlineCalc.location.sheetIndex(ca,ra.sheetId);ra=ra.range;let lb={};if(1===U)lb=excelOnlineCalc.location.gridRange(ra.top-ob-1,ra.left-1,ra.bottom+ja-ra.top+ob+1,ra.right-ra.left+1);else if(2===U)lb=excelOnlineCalc.location.gridRange(ra.top-1,ra.left-1,ra.bottom-ra.top+1,ra.right-ra.left+1);else if(3===U)if(ma)lb=excelOnlineCalc.location.gridRange(ra.top-2,ra.left-1,1,ra.right-ra.left+1);else return excelOnlineCalc.util.success(null);else if(4===U)if(Va)lb=excelOnlineCalc.location.gridRange(ra.bottom,
ra.left-1,1,ra.right-ra.left+1);else return excelOnlineCalc.util.success(null);U=excelOnlineCalc.location.sheetGridRange(ca,lb);return excelOnlineCalc.util.success(U)}return excelOnlineCalc.util.success(null)};this.getDocumentLoc=(ca,U)=>{if((H.a.equals(ca,this.documentLoc.path,!0)||!ca)&&H.a.equals(U,this.documentLoc.name,!0))return excelOnlineCalc.util.success(this.documentLoc);ca=excelOnlineCalc.util.unavailable([0,excelOnlineCalc.location.documentLoc(ca,U)]);return excelOnlineCalc.util.failure(ca)};
this.getSheetIndex=(ca,U)=>{if(!this.Tf.Pb(this.currentStateId)||!this.Tf.ma(this.currentStateId).hl)return U=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(U);ca=this.Tf.ma(this.currentStateId).hl;for(let ma=1;ma<ca.length;ma++)if(H.a.equals(ca[ma].s$.sheetName,U,!0))return excelOnlineCalc.util.success(ca[ma].s$.sheetId);return excelOnlineCalc.util.success(null)};this.getSheetName=(ca,U)=>{if(!this.Tf.Pb(this.currentStateId)||!this.Tf.ma(this.currentStateId).hl)return U=excelOnlineCalc.util.unavailable([2]),
excelOnlineCalc.util.failure(U);ca=this.Tf.ma(this.currentStateId).hl;for(let ma=1;ma<ca.length;ma++)if(H.a.equals(ca[ma].s$.sheetId,U,!0))return excelOnlineCalc.util.success(ca[ma].s$.sheetName);return excelOnlineCalc.util.success(null)};this.getUserDefinedFuncLoc=()=>excelOnlineCalc.util.notImplemented(["ParseGlobals.GetUserDefinedFuncLoc not implemented in main thread"]);this.getSheetRangeIndexes=()=>excelOnlineCalc.util.notImplemented(["ParseGlobals.GetSheetRangeIndexes not implemented in main thread"]);
this.iPf=()=>{this.setNumberFormats()};this.ee=()=>{b.ULS.sendTraceTag(537170081,0,50,"CalcAsyncEngine.OnWorkbookOpened() called");this.Tf=new u.a;this.currentStateId=this.Ot=-1;this.Pka="";this.$4a=null;this.sQd=!1;this.yq&&this.clearCache()};this.Rd=X;this.Tf=new u.a;this.$4a=null;this.documentLoc=excelOnlineCalc.location.documentLoc("",this.Rd.workbookContext.FullDocumentInfo.BreadcrumbDocName);this.Dra();this.kxd=y.a.kxd();this.a8=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SetCellEstimationPrefetch",
!1);this.kFi=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NoCompareCalcModelExpFF1",!1);this.lFi=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NoCompareCalcModelExpFF2",!1);this.Wwd=z.EwaSettings.isChangeGateEnabled("OfficeVSO:7717008_CalcBlocksExtendedTelemetry");this.oCi=z.EwaSettings.isChangeGateEnabled("OfficeVSO:7737506_fixCalcUsedRangeForFreezePanes")}dispose(){this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.JSd(this.iPf);
this.Rd&&this.Rd.hn(this.ee);this.close()}HUb(X){if(!this.yq)return!1;if(!this.instantaneousSupportInformationManager&&(this.instantaneousSupportInformationManager=this.Rd.da.Ba(268),!this.instantaneousSupportInformationManager))return b.ULS.sendTraceTag(537170198,0,50,"CalcAsyncEngine.UpdateData Failed to get instantaneousSupportInformationManager"),!1;2!==X&&(this.currentStateId=this.Rd.ea.eRa,this.currentStateId===d.a.Ye&&(this.currentStateId=this.Rd.ea.gf));if(1===X&&this.currentStateId<this.Ot)return b.ULS.sendTraceTag(537170197,
0,50,`CalcAsyncEngine::UpdateData() currentStateId:${this.currentStateId} < lastUpdatedStateId:${this.Ot} - ignoring update`),!1;this.VMj();0!==X&&this.sQd||(this.CRj(),this.BOj(),this.qPj(),this.setNumberFormats(),this.instantaneousSupportInformationManager.Jye(this.iPf),this.Rd.$l(this.ee),this.sQd=!0);this.jsj();let ca=!1;0===X&&(ca=this.zui());if(0!==X||ca)this.MQj()?(this.pRj(X),this.oRj(),this.Ot=this.currentStateId,this.teh()):b.ULS.sendTraceTag(537170196,0,15,`CalcAsyncEngine::UpdateData() for StateId:${this.currentStateId} failed - no Sheets information`);
2!==X&&this.resumeRecalc();return!0}evalFormula(X,ca,U,ma){if(!this.yq)return b.ULS.sendTraceTag(537170195,0,15,"CalcAsyncEngine.EvalFormula: recalc engine is null"),Promise.resolve({});ca=excelOnlineCalc.calc.sheetCellLocation(null!==U&&void 0!==U?U:x.d(this.Rd.ua.na),ca.top-1,ca.left-1);X=this.yq.evalFormula(this.Rd.ea.gf,X,ca,ma);this.resumeRecalc();return X}X$g(X,ca,U,ma=null){const ra=x.d(this.Rd.ua.na);let Va=X.cell.kJ-1,ob=X.cell.iJ-1;var ja=Va,lb=ob;let wb=null;ma&&(wb=excelOnlineCalc.calc.cellLocation(Va,
ob),Va=ma.top-1,ob=ma.left-1,ja=ma.bottom-1,lb=ma.right-1);U=this.IKc(X,U,"SetCell");0>U||(lb=K.b6("CalculateFormula.cell",ra,Va,ob,ja,lb),ja=[],ma=this.bjc(ra),ca=excelOnlineCalc.calc.inferredRangeFormulaEdit(lb,ca,wb,ma),ja.push(ca),X=(ca=this.qqd())?String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",ra,Va,ob,H.a.MAe(X.cell.text),U,ca.top-1,ca.left-1,ca.bottom-1,ca.right-1):String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",
ra,Va,ob,H.a.MAe(X.cell.text),U,"","","",""),b.ULS.sendTraceTag(537170180,0,50,X),this.yq.editRangeFormulas(U,ja),this.resumeRecalc())}Y$g(X,ca){const U=[];var ma=x.d(this.Rd.ua.na),ra=this.bjc(ma);ca=this.IKc(X[0].Tca,ca,"SetCellBatched");if(0>ca)return!1;for(var Va of X){var ob=Va.Tca.cell.kJ-1,ja=Va.Tca.cell.iJ-1;ob=K.b6("CalculateFormulaBatched.cell",ma,ob,ja,ob,ja);ob=excelOnlineCalc.calc.inferredRangeFormulaEdit(ob,Va.editText,null,ra);U.push(ob)}ra=this.qqd();Va=X[0].Tca.cell.kJ-1;ob=X[0].Tca.cell.iJ-
1;ja=X[X.length-1].Tca.cell.kJ-1;X=X[X.length-1].Tca.cell.iJ-1;ma=ra?String.format("CalcAsyncEngine::CalculateFormulaBatched() for sheet:{0} range:({1},{2},{3},{4}) stateId:{5} viewport:(({6},{7})-({8},{9}))",ma,Va,ob,ja,X,ca,ra.top-1,ra.left-1,ra.bottom-1,ra.right-1):String.format("CalcAsyncEngine::CalculateFormulaBatched() for sheet:{0} range:({1},{2},{3},{4}) stateId:{5} viewport:(({6},{7})-({8},{9}))",ma,Va,ob,ja,X,ca,"","","","");b.ULS.sendTraceTag(508932947,0,50,ma);this.yq.editRangeFormulas(ca,
U);this.resumeRecalc();return!0}n6a(X,ca,U,ma,ra){if(!this.yq)return b.ULS.sendTraceTag(537170179,0,15,"CalcAsyncEngine::EvalFormulaRangeOnClone recalc engine is null"),Promise.reject("RecalcService is null");if(!U||!ca)return b.ULS.sendTraceTag(524120779,0,15,`CalcAsyncEngine::EvalFormulaRangeOnClone inputs are null. originCell null: ${!U}, outputColumnRange null: ${!ca}`),Promise.reject("CalcAsyncEngine::EvalFormulaRangeOnClone: null inputs");b.ULS.shipAssertTag(537170178,0,U.isSingle,"CalcAsyncEngine::EvalFormulaRangeOnClone originCell must be a single cell.");
const Va=x.d(this.Rd.ua.na),ob=this.bjc(Va);let ja=null;if(X){ja=[];for(const Ab of X)if(Ab.column!==U.left){X=Ab.row-1;var lb=Ab.column-1;X=K.b6("EvalFormulaRangeOnClone.cell",Va,X,lb,X,lb);lb=z.EwaSettings.isChangeGateEnabled("OfficeVSO:7459428_TypedValueInCloneWrite")?R(Ab.jp,Ab.formulaBarText,Ab.yi):excelOnlineCalc.calc.valueCellData(Ab.text,Ab.text,Ab.yi,null);ja.push(excelOnlineCalc.calc.rangeWrite(X,lb))}}U=excelOnlineCalc.calc.cellLocation(U.top-1,U.left-1);ca=K.b6("EvalFormulaRangeOnClone.outputColumnRange",
Va,ca.top-1,ca.left-1,ca.bottom-1,ca.right-1);let wb;ra?this.a8&&(ma=[excelOnlineCalc.calc.inferredRangeFormulaEdit(ca,ma,U,ob)],wb=this.yq.evalOnClonedModel(ja,ma,ra)):(ra=[excelOnlineCalc.calc.cellFormulaRangeFormulaEdit(ca,ma,U,ob)],wb=this.yq.evalOnClonedModel(ja,ra));this.resumeRecalc();return wb}ZQe(X){let ca=null;try{if(X)if(this.Pka=F.h(this.Rd).Ca.Txa(X),this.currentStateId=X.OWa,this.currentStateId<this.Ot||this.currentStateId===d.a.Ye)b.ULS.sendTraceTag(537170176,0,50,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() hash:${this.Pka} blockRevision:${this.currentStateId} < lastUpdatedStateId:${this.Ot}`);
else{if(this.Fui(),this.oCi&&1===X.Ex.PaneType&&this.shk(X.na),!this.Y5g())if(ca=this.Rd.yc.Fd("ModelUpdate",`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() Block Hash:${this.Pka} StateId:${this.currentStateId}`),this.$4a=this.p8a(X.na.sheetName))if(F.h(this.Rd).Ca.jn.I5a(X.Xd)){var U=X.qg;if(U){var ma=U.getCalcBlockModel();if(ma)if(this.Q5g(ma)){this.Tf.ma(this.currentStateId).t3a[this.Pka]=new L(ma,X.na.sheetName);var ra=X.Ne;ra?this.bUg(ra.NamedObjects):b.ULS.sendTraceTag(537170144,0,15,
"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel GetGridBlockContentResponse is null")}else this.Wwd&&b.ULS.sendTraceTag(509117971,0,50,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel block is invalid (might be freeze panes removal)");else b.ULS.sendTraceTag(537170145,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model for block")}else b.ULS.sendTraceTag(537170146,0,15,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model accessor for block:${this.Pka}`)}else this.Wwd&&
b.ULS.sendTraceTag(509117972,0,50,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel skipping block update because renderStateInfo doesn't have the block");else{const Va=!!(this.Rd.oe&32),ob=this.Tf.Pb(this.currentStateId)&&this.Tf.ma(this.currentStateId).hl?this.Tf.ma(this.currentStateId).hl.length:0;b.ULS.sendTraceTag(537170147,0,15,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel SheetName not found. Number of existing sheets ${ob}, scratchPad:${Va}, sheetNameLength:${X.na.sheetName?X.na.sheetName.length:
-1} Hash:${X.na.hash}`)}}else b.ULS.shipAssertTag(537170177,0,!1,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() blockCacheItem is null")}finally{ca&&ca.stop()}}Pic(X){var ca;if(!this.Tf.Pb(this.currentStateId))return b.ULS.sendTraceTag(509646790,0,15,`CalcAsyncEngine.getTableHeaders: stateId ${this.currentStateId} not found in gridCache`),null;const U=null===(ca=this.Tf.ma(this.currentStateId))||void 0===ca?void 0:ca.hl;if(!U||!U[0])return null;ca=U[0].G8;if(!ca||!ca.Pb(X.name))return b.ULS.sendTraceTag(509646789,
0,15,`CalcAsyncEngine.getTableHeaders: table key found wasn't found in cached named objects list. cached named objects is null: ${null==ca}`),null;X=ca.ma(X.name);if(!X||!X.iG)return null;ca=new l.a;for(let ma of X.iG.qca)ca.add(ma.value);return ca}Z$g(X,ca,U){var ma=F.h(this.Rd),ra=ma.tc(ca);ra=this.IKc(ra,null,"CopyPaste");U=this.IKc(ma.tc(X),U,"CopyPaste");if(0>ra||0>U||ra!==U)b.ULS.sendTraceTag(537170143,0,15,`CalcAsyncEngine::CalculateFormulaForCopyPaste(). Revision not valid. sourceRevision:${U}, targetRevision:${ra}.`);
else{U=[];ma=x.d(this.Rd.ua.na);var Va=this.bjc(ma);X=K.b6("CalculateFormulaForCopyPaste.srcRange",ma,X.top-1,X.left-1,X.bottom-1,X.right-1);ca=K.b6("CalculateFormulaForCopyPaste.targetRange",ma,ca.top-1,ca.left-1,ca.bottom-1,ca.right-1);ca=excelOnlineCalc.calc.copyPasteRangePasteEdit(ca,X,Va);U.push(ca);ca=Va?String.format("CalcAsyncEngine::CalculateFormulaForCopyPaste() for sheet:{0}, stateId:{1} viewport:(({2},{3})-({4},{5}))",ma,ra,Va.row,Va.column,Va.lastRow,Va.lastColumn):String.format("CalcAsyncEngine::CalculateFormulaForCopyPaste() for sheet:{0}, stateId:{1} viewport:(({2},{3})-({4},{5}))",
ma,ra,"","","","");b.ULS.sendTraceTag(537170142,0,50,ca);this.yq.editRangePaste(ra,U);this.resumeRecalc()}}bjc(X){const ca=this.qqd();let U=null;ca?U=K.b6("GetViewport.viewport",X,ca.top-1,ca.left-1,ca.bottom-1,ca.right-1):b.ULS.sendTraceTag(537170141,0,50,"CalcAsyncEngine::GetViewport() viewportRange is null, calc will use entire sheet...");return U}qqd(){const X=F.h(this.Rd);let ca=X.sk;if(F.h(this.Rd).Mb.tj){ca=X.sg(1).sk;if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:5497152_JSCrash_At_CalcAsyncEngine_GetViewportRange")&&
!ca)return b.ULS.sendTraceTag(537170140,0,15,"CalcAsyncEngine::GetViewportRange viewportRange is null."),null;ca.Hga(1,1);ca.Hga(3,1)}return ca}IKc(X,ca,U){let ma;if(!this.yq||!X)return b.ULS.sendTraceTag(537170139,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() recalc engine is null:${!this.yq}, modifiedCell is null:${!X}, operation:${U}`),-1;const ra=X.cell.kJ-1,Va=X.cell.iJ-1;if(X.cell.Ww){if(ma=X.cell.Ww.X6b,ma===d.a.Ye)return b.ULS.sendTraceTag(537170138,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() BlockRevision unknown for block:${X.cell.Ww.Xd}, operation:${U}`),
-1}else return b.ULS.sendTraceTag(537170137,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() GridBlockModelProxy is null cell:(${X.cell.kJ},${X.cell.iJ}), operation:${U}`),-1;if(ma<this.Ot)return b.ULS.sendTraceTag(537170136,0,50,`CalcAsyncEngine::ValidateCalculateFormulaInit() Can't calc edit in cell:(${ra},${Va}) - blockRevision:${ma} < lastUpdatedStateId:${this.Ot}, operation:${U}`),-1;if(ma<this.currentStateId)return b.ULS.sendTraceTag(537170135,0,50,`CalcAsyncEngine::ValidateCalculateFormulaInit() Can't calc edit in cell:(${ra},${Va}) - blockRevision:${ma} < currentStateId:${this.currentStateId}, operation:${U}`),
-1;ca&&!this.GKd&&(this.yq.setOnRecalcResults(ca),this.GKd=!0);return this.Nck()&&!this.HUb(2)?(b.ULS.sendTraceTag(537170134,0,15,`CalcAsyncEngine.ValidateCalculateFormulaInit: UpdateData failed. operation:${U}`),-1):ma}getFormulaBarText(X,ca,U){return ca&&ca.startsWith("'")?ca:X.cell.formulaBarText||U.toString()}Zqh(X,ca,U){let ma=null;z.EwaSettings.isChangeGateEnabled("OfficeVSO:7616924_fixSheetIdSentToCalcts")&&(this.$4a=this.p8a(U));if(this.xHe()&&this.Tf.ma(this.Ot).t3a){const ja=this.Tf.ma(this.Ot).t3a[X];
if(null===ja||void 0===ja?0:ja.MQb)ma=ja.MGe}U=this.xzi(ma,ca,U);const {M_i:ra,numberOfNonEmptyCells:Va,K_i:ob}=this.Rhh(ma,ca,U);b.ULS.sendTraceTag(50671754,0,50,`CalcAsyncEngine::CreateRangeUpdateCommands() completed for Block Hash:${X} StateId:${this.currentStateId} number of formulas ${ra}, number of non-empty cells ${Va}, number of cells ${ob}`)}xzi(X,ca,U){let ma=!1;const ra=K.J8e(ca);if(X){const Va=K.J8e(X);H.a.equals(Va,ra,!1)&&(ma=!0)}this.kFi&&(ma=!1);ma?this.FUg(X,this.Ot,U):this.HUg(ca,
U);return ma}xHe(){let X=!1;this.yq&&-1!==this.Ot&&(X=this.yq.stateIdAvailable(this.Ot));return X&&this.Tf.Pb(this.Ot)&&this.Ot<this.currentStateId}Rhh(X,ca,U){let ma=0,ra=0,Va=0,ob,ja;for(ca.reset();ob=ca.getNextCell();)Va++,(ob.value||ob.formula)&&ra++,G.f(ob.formula)&&ma++,(ja=U?X.getCell(ob.row,ob.col):null)?this.Nhh(ca,ob,ja):this.GUg(ca,ob);if(U)for(X.reset();ja=X.getNextCell();)(ob=ca.getCell(ja.row,ja.col))||this.Vwe(X,ja);return{M_i:ma,numberOfNonEmptyCells:ra,K_i:Va}}qPj(){this.yq.setOnUpdateRequest(()=>
{})}pPj(){this.yq.setOnUnresponsive((X,ca,U,ma)=>{this.Odj(X,ca,U,ma)})}Odj(X,ca,U,ma){b.ULS.sendTraceTag(537170126,0,15,`CalcAsyncEngine.onUnresponsive: worker thread was unresponsive. timeout:${X}, waitTime:${ca}, timeoutCount:${U}, hasBeenClosed:${ma}.`);ma&&(this.KDj(),this.Dra())}KDj(){this.ee(null,null);this.PCd=this.GKd=!1;this.pOd=0;this.hOd=this.jOd=this.kOd=this.iOd=-1}close(){this.yq.close()}clearCache(){this.yq.clearCache()}resumeRecalc(){this.yq.resumeRecalc()}BOj(){this.yq.setA1ReferenceStyle(!0)}jsj(){if(this.instantaneousSupportInformationManager){var X=
this.instantaneousSupportInformationManager.Lwi;const U=this.instantaneousSupportInformationManager.Owi,ma=this.instantaneousSupportInformationManager.Nwi,ra=this.instantaneousSupportInformationManager.Mwi;var ca=!1;X!==this.iOd&&(ca=!0,this.iOd=X);U!==this.kOd&&(ca=!0,this.kOd=U);ma!==this.jOd&&(ca=!0,this.jOd=ma);ra!==this.hOd&&(ca=!0,this.hOd=ra);const Va=[];z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSExceLintExperimentIsEnabled",!1)&&(ca=excelOnlineCalc.calc.runExperiment("ExceLintExperiment",
null),Va.push(ca),ca=!0);z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnitExperiment",!1)&&(ca=excelOnlineCalc.calc.runExperiment("UnitExperiment",null),Va.push(ca),ca=!0);z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled",!1)&&(ca=excelOnlineCalc.calc.runExperiment("AutocompleteExperiment",null),Va.push(ca),ca=!0);ca&&(X=excelOnlineCalc.calc.recalcServiceConfig(null,X,null,U,null,null,null,ma,Va,ra),this.yq.reconfigure(X))}}pRj(X){let ca=
null;if(this.Tf.Pb(this.currentStateId))try{this.Pca=[],ca=this.Rd.yc.Fd("ModelUpdate",`CalcAsyncEngine::SetUpdatedRanges() StateId:${this.currentStateId} UpdateTriggerData:${J[X]}`),h.a.forEach(this.Tf.ma(this.currentStateId).t3a,(U,ma)=>{ma.MQb||(this.Zqh(U,ma.MGe,ma.sheetName),ma.MQb=!0)},null),this.yq.updateRanges(this.currentStateId,this.Pca)}finally{ca&&ca.stop()}else b.ULS.sendTraceTag(537170122,0,15,`CalcAsyncEngine::SetUpdatedRanges StateId:${this.currentStateId} does not exist in GridCache`)}oRj(){const X=
[],ca=this.xHe();var U=ca&&this.Tf.ma(this.Ot).hl&&this.Tf.ma(this.Ot).hl[0]&&this.Tf.ma(this.Ot).hl[0].ktc?this.Tf.ma(this.Ot).hl[0].G8:null;this.AMe(U,this.Tf.ma(this.currentStateId).hl[0].G8,null,this.Ot,X);this.Tf.ma(this.currentStateId).hl[0].ktc=!0;for(let ma=1;ma<this.Tf.ma(this.currentStateId).hl.length;ma++)U=-1,ca&&this.Tf.ma(this.Ot).hl&&(U=this.spd(this.Tf.ma(this.currentStateId).hl[ma].s$.sheetName,this.Ot)),U=-1!==U&&this.Tf.ma(this.Ot).hl[U].ktc?this.Tf.ma(this.Ot).hl[U].G8:null,this.AMe(U,
this.Tf.ma(this.currentStateId).hl[ma].G8,this.Tf.ma(this.currentStateId).hl[ma].s$.sheetId,this.Ot,X),this.Tf.ma(this.currentStateId).hl[ma].ktc=!0;this.yq.updateNamedObjects(this.currentStateId,X)}AMe(X,ca,U,ma,ra){if(void 0!==U&&null!==U){var Va=excelOnlineCalc.calc.undefinedNamesWrite(U);ra.push(Va)}if(X){var ob=!1;Va=[];var ja=[];if(ca)for(let wb of ca){const Ab=wb.value;if(X.Pb(wb.key)){var lb=X.ma(wb.key);K.cZi(lb,Ab)?ob=!0:(lb=excelOnlineCalc.calc.namedObject(wb.key,null),Va.push(lb),K.U1c(wb.key,
Ab,ja))}else K.U1c(wb.key,Ab,ja)}for(let wb of X)ca&&ca.Pb(wb.key)||(X=excelOnlineCalc.calc.namedObject(wb.key,null),Va.push(X));ob&&(ca=excelOnlineCalc.calc.namedObjectsPromote(U,ma),ra.push(ca));0<Va.length&&(ca=excelOnlineCalc.calc.namedObjectsWrite(U,Va),ra.push(ca));0<ja.length&&(U=excelOnlineCalc.calc.namedObjectsWrite(U,ja),ra.push(U))}else if(ca){ma=[];for(ja of ca)K.U1c(ja.key,ja.value,ma);0<ma.length&&(U=excelOnlineCalc.calc.namedObjectsWrite(U,ma),ra.push(U))}}Y5g(){const X=this.Tf.ma(this.currentStateId).t3a[this.Pka];
return X?(this.Wwd?b.ULS.sendTraceTag(509117004,0,50,`CalcAsyncEngine::BlockPreviouslyHandled Block Hash:${this.Pka} StateId:${this.currentStateId} previously handled. LastUpdatedStateId: ${this.Ot}. sentToRecalcEngine: ${null===X||void 0===X?void 0:X.MQb}`):b.ULS.sendTraceTag(537170121,0,50,`CalcAsyncEngine::BlockPreviouslyHandled Block Hash:${this.Pka} StateId:${this.currentStateId} previously handled`),this.lFi?!1:!0):!1}Q5g(X){return 1===X.getColumnNumbers().length&&X.getColumnNumbers()[0]===
K.rFd+1?!1:!0}zui(){let X=!1;F.h(this.Rd).Ca.Ozb(ca=>{ca.state&1&&this.Rd.ea.gf===ca.Ue.Revision&&(this.ZQe(ca),X=!0)});return X}ROe(X,ca){var U=X.getRowNumbers(),ma=X.getColumnNumbers();X=U[0]-1;U=U[U.length-1]-1;const ra=ma[0]-1;ma=ma[ma.length-1]-1;ca=this.p8a(ca);if(!ca){const Va=this.Tf.Pb(this.currentStateId)&&this.Tf.ma(this.currentStateId).hl?this.Tf.ma(this.currentStateId).hl.length:0;b.ULS.sendTraceTag(537170120,0,15,`CalcAsyncEngine::CreateBlockRangeLocation SheetName not found. Number of existing sheets ${Va}`)}return K.b6("CreateBlockRangeLocation",
ca,X,ra,U,ma)}FUg(X,ca,U){if(U=this.ROe(X,U)){var ma=K.Z$b(X.getRowNumbers());X=K.Z$b(X.getColumnNumbers());ca=excelOnlineCalc.calc.rangePromote(U,ca,ma,X);this.Pca[this.Pca.length]=ca}}HUg(X,ca){if(ca=this.ROe(X,ca)){var U=K.Z$b(X.getRowNumbers());X=K.Z$b(X.getColumnNumbers());X=excelOnlineCalc.calc.rangeWrite(ca,null,U,X);this.Pca[this.Pca.length]=X}}Nhh(X,ca,U){let ma=null,ra=0,Va=0;switch(ca.valueType){case 2:ma=this.lqd(ca);var ob=this.lqd(U);ob=H.a.equals(ob,ma,!1);break;case 1:null===ca.value&&
null===U.value?ob=!0:(ra=parseFloat(ca.value),ob=parseFloat(U.value)===ra);break;default:null===ca.value&&null===U.value?ob=!0:(Va=parseFloat(ca.value),ob=Va===parseFloat(U.value))}ob&&ca.valueType===U.valueType&&ca.ifmt===U.ifmt&&ca.formulaType===U.formulaType&&H.a.equals(U.formula,ca.formula,!1)||(void 0!==ca.formula&&null!==ca.formula||void 0!==ca.value&&null!==ca.value||void 0!==ca.text&&null!==ca.text||0!==ca.valueType?this.j4b(X,ca,ma,ra,Va):this.Vwe(X,ca))}bUg(X){if(this.Rd.oc&&this.Rd.oc.items)for(let Va=
0;Va<this.Rd.oc.count;Va++){var ca=this.Rd.oc.items[Va];if(2!==ca.type&&3!==ca.type)continue;var U=0,ma=ca.name,ra=ma.lastIndexOf("!");if(0<ra){U=ma.substr(0,ra);"'"===U.charAt(0)&&(U=U.substr(1,U.length-2));U=this.spd(U,this.currentStateId);if(-1===U){ma=this.Tf.Pb(this.currentStateId)&&this.Tf.ma(this.currentStateId).hl?this.Tf.ma(this.currentStateId).hl.length:0;b.ULS.sendTraceTag(595096334,0,50,`CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets ${ma}`);continue}ma=
ma.substr(ra+1)}ra=this.Tf.ma(this.currentStateId).hl[U].G8;let ob=ca.usedRange;2===ca.type&&(ob=m.a(ca));if(ra.Pb(ma)){if(U=ra.ma(ma),U.range=ob,U.attributes=ca.attributes,2===U.type)if(ma=ca.fQ,!U.iG)U.iG=new t(ma);else if(ma)for(const ja of ma.HeadersList)U.iG.qca.ia(ja.Index,ja.Name)}else if(U=this.p8a(ca.sheetName)){U=new M(ca.type,ca.name,ob,U,ca.attributes);if(2===U.type)if(ca.fQ)U.iG=new t(ca.fQ);else if(ca=K.ATh(ca.name,X))U.iG=new t(ca.ColHeadersList);ra.ia(ma,U)}else ma=this.Tf.Pb(this.currentStateId)&&
this.Tf.ma(this.currentStateId).hl?this.Tf.ma(this.currentStateId).hl.length:0,b.ULS.sendTraceTag(537170117,0,50,`CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets ${ma}`)}}j4b(X,ca,U,ma,ra){var Va=X.getRowNumbers()[ca.row]-1;X=X.getColumnNumbers()[ca.col]-1;Va=K.b6("AddRangeUpdateCommand",this.$4a,Va,X,Va,X);X=null;let ob=ca.formula||ca.text;const ja=excelOnlineCalc.calc.blankValue;let lb=null;void 0!==ca.text&&null!==ca.text||void 0!==ca.value&&null!==ca.value||
(U="",lb="This cell contains blanks only",0===ca.formulaType&&(ob=""));switch(ca.valueType){case 2:null!==U&&(0===ca.formulaType&&(X=excelOnlineCalc.calc.valueCellData(ob,U,ca.ifmt,lb)),1===ca.formulaType&&(X=excelOnlineCalc.calc.cellFormulaCellData(ob,U,ca.ifmt,lb)),2===ca.formulaType&&(X=excelOnlineCalc.calc.valueCellData("",ja,0,"This cell is a part of an array")));break;case 1:isNaN(ma)?b.ULS.sendTraceTag(537170116,0,50,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${ca.row},${ca.col}) invalid numeric value`):
(0===ca.formulaType&&(X=excelOnlineCalc.calc.valueCellData(ob,ma,ca.ifmt,null)),1===ca.formulaType&&(X=excelOnlineCalc.calc.cellFormulaCellData(ob,ma,ca.ifmt,null)),2===ca.formulaType&&(X=excelOnlineCalc.calc.valueCellData("",ja,0,"This cell is a part of an array")));break;case 3:isNaN(ra)?b.ULS.sendTraceTag(537170115,0,15,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${ca.row},${ca.col}) invalid boolean value`):(U=1===ra?!0:!1,0===ca.formulaType&&(X=excelOnlineCalc.calc.valueCellData(ob,U,ca.ifmt,
null)),1===ca.formulaType&&(X=excelOnlineCalc.calc.cellFormulaCellData(ob,U,ca.ifmt,null)),2===ca.formulaType&&(X=excelOnlineCalc.calc.valueCellData("",ja,0,"This cell is a part of an array")));break;case 4:isNaN(ra)?b.ULS.sendTraceTag(537170114,0,15,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${ca.row},${ca.col}) invalid error value`):(U=excelOnlineCalc.calc.errorValue(ra),0===ca.formulaType&&(X=excelOnlineCalc.calc.valueCellData(ob,U,ca.ifmt,null)),1===ca.formulaType&&(X=excelOnlineCalc.calc.cellFormulaCellData(ob,
U,ca.ifmt,null)),2===ca.formulaType&&(X=excelOnlineCalc.calc.valueCellData("",ja,0,"This cell is a part of an array")));break;default:X=excelOnlineCalc.calc.valueCellData("",ja,ca.ifmt,null)}X&&(ca=excelOnlineCalc.calc.rangeWrite(Va,X,null,null),this.Pca[this.Pca.length]=ca)}GUg(X,ca){switch(ca.valueType){case 2:this.j4b(X,ca,this.lqd(ca),null,0);break;case 1:this.j4b(X,ca,null,parseFloat(ca.value),0);break;default:this.j4b(X,ca,null,null,parseFloat(ca.value))}}Vwe(X,ca){var U=X.getRowNumbers()[ca.row]-
1;X=X.getColumnNumbers()[ca.col]-1;U=K.b6("AddRangeUpdateCommandEmptyCell",this.$4a,U,X,U,X);ca=excelOnlineCalc.calc.valueCellData("",excelOnlineCalc.calc.blankValue,ca.ifmt,null);ca=excelOnlineCalc.calc.rangeWrite(U,ca,null,null);this.Pca[this.Pca.length]=ca}p8a(X){X=this.spd(X,this.currentStateId);return 0<X?this.Tf.ma(this.currentStateId).hl[X].s$.sheetId:null}spd(X,ca){if(!this.Tf.Pb(ca))return b.ULS.sendTraceTag(537170113,0,15,`CalcAsyncEngine.GetSheetInternalIndex StateId:${ca} does not exist in GridCache`),
-1;const U=this.Tf.ma(ca);return U.hl?U.getSheetIndex(X):(b.ULS.sendTraceTag(537170112,0,15,`CalcAsyncEngine.GetSheetInternalIndex sheetsInformation == null for StateId:${ca}`),-1)}MQj(){if(!this.Tf.Pb(this.currentStateId)||!this.Tf.ma(this.currentStateId).hl.length)return b.ULS.sendTraceTag(537170083,0,15,`CalcAsyncEngine::SetSheetNamesAndUsedRanges() No sheets information for StateId:${this.currentStateId} or StateId does not exist in GridCache`),!1;const X=[];for(let ca=1;ca<this.Tf.ma(this.currentStateId).hl.length;ca++){const U=
this.Tf.ma(this.currentStateId).hl[ca];U&&X.push(U.s$)}this.yq.updateSheetNames(this.currentStateId,X);this.yq.updateUnusedCells(this.currentStateId,this.Tf.ma(this.currentStateId).J6d);return!0}setNumberFormats(){if(this.instantaneousSupportInformationManager){var X=[];for(const ca of this.instantaneousSupportInformationManager.sBa){const U=excelOnlineCalc.calc.numberFormat(ca.IfmtIndex,ca.FormatString,ca.Builtin);X.push(U)}this.yq.setNumberFormats(X,!0)}}VMj(){if(this.instantaneousSupportInformationManager&&
this.instantaneousSupportInformationManager.Ef){var X=this.Dui();if(!this.PCd||X)this.Y$b(),this.instantaneousSupportInformationManager.Ef.TrueValueString&&(this.trueName=this.instantaneousSupportInformationManager.Ef.TrueValueString),this.instantaneousSupportInformationManager.Ef.FalseValueString&&(this.falseName=this.instantaneousSupportInformationManager.Ef.FalseValueString),X=S.CalcHelper.NPe(this.instantaneousSupportInformationManager,X),this.yq.setLocale(X),this.PCd=!0}}CRj(){var X=null;if(void 0!==
this.Rd.workbookContext.TimeZoneInformation&&null!==this.Rd.workbookContext.TimeZoneInformation){X=null;this.Rd.workbookContext.TimeZoneInformation.StandardDate.Month&&(X=excelOnlineCalc.date.dateTime(this.Rd.workbookContext.TimeZoneInformation.StandardDate.Year,this.Rd.workbookContext.TimeZoneInformation.StandardDate.Month,this.Rd.workbookContext.TimeZoneInformation.StandardDate.Day,this.Rd.workbookContext.TimeZoneInformation.StandardDate.Hour,this.Rd.workbookContext.TimeZoneInformation.StandardDate.Minute,
this.Rd.workbookContext.TimeZoneInformation.StandardDate.Second,this.Rd.workbookContext.TimeZoneInformation.StandardDate.DayOfWeek+1,this.Rd.workbookContext.TimeZoneInformation.StandardDate.Milliseconds,3));let ca=null;this.Rd.workbookContext.TimeZoneInformation.DaylightDate.Month&&(ca=excelOnlineCalc.date.dateTime(this.Rd.workbookContext.TimeZoneInformation.DaylightDate.Year,this.Rd.workbookContext.TimeZoneInformation.DaylightDate.Month,this.Rd.workbookContext.TimeZoneInformation.DaylightDate.Day,
this.Rd.workbookContext.TimeZoneInformation.DaylightDate.Hour,this.Rd.workbookContext.TimeZoneInformation.DaylightDate.Minute,this.Rd.workbookContext.TimeZoneInformation.DaylightDate.Second,this.Rd.workbookContext.TimeZoneInformation.DaylightDate.DayOfWeek+1,this.Rd.workbookContext.TimeZoneInformation.DaylightDate.Milliseconds,3));X=excelOnlineCalc.date.tzData(this.Rd.workbookContext.TimeZoneInformation.Bias,X,this.Rd.workbookContext.TimeZoneInformation.StandardBias,ca,this.Rd.workbookContext.TimeZoneInformation.DaylightBias)}else b.ULS.sendTraceTag(537170082,
0,15,"CalcAsyncEngine.SetWorkbookProperties: TimeZoneInformation is null");X=excelOnlineCalc.calc.workbookProps(this.Rd.workbookContext.F1904,this.Rd.workbookContext.FDateCompatibility,X);this.yq.setWorkbookProps(X)}Dra(){const X=z.EwaSettings.ya(570)?w.local:w.r6j,[ca,U]=y.a.ES(this.Rd)?[excelOnlineCalc.x10.PluginSchedulerSingleton.instance(),excelOnlineCalc.x10.GridImportManagerSingleton.instance()]:[void 0,void 0];this.tQd=v.d(excelOnlineCalc.calc.createRecalcService(X,ca,U));this.tQd.continueWith(ma=>
{ma.exception?b.ULS.sendTraceTag(537170075,0,50,`CalcAsyncEngine.TryInitialize: Calc web worker failed: ${ma.exception.toString()}`):(b.ULS.sendTraceTag(537170078,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker is working as expected"),(this.yq=this.tQd.result)?this.HUb(0)?this.pPj():b.ULS.sendTraceTag(537170077,0,15,"CalcAsyncEngine.TryInitialize: UpdateData failed to initialize"):b.ULS.sendTraceTag(537170076,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker result is null"))})}Dui(){const X=
this.instantaneousSupportInformationManager.ema;if(!X||this.pOd===X.length)return null;this.pOd=X.length;return S.CalcHelper.yPe(X)}Y$b(){this.errorTypeNames=S.CalcHelper.Y$b()}Fui(){if(!(this.Tf.Pb(this.currentStateId)&&0<this.Tf.ma(this.currentStateId).hl.length)){this.Tf.ia(this.currentStateId,new O(this.kxd));this.Tf.ma(this.currentStateId).$eg(0,new I(null));var X=this.Rd.ua;for(let ma=0;ma<X.count;ma++){var ca=Object(k.a)(D.a,X.getItem(ma));if(ca){void 0!==ca.sheetId&&null!==ca.sheetId&&void 0!==
ca.name&&null!==ca.name&&ca.sheetId.length&&ca.sheetName.length||b.ULS.sendTraceTag(537170074,0,15,`CalcAsyncEngine::InitializeGridForStateId() invalid sheet - index:${ma} Id:${ca.sheetId} Hash:${ca.hash} NameLength:${ca.name?ca.name.length:-1}`);var U=void 0;U=excelOnlineCalc.calc.sheetName(ca.sheetId,ca.name);this.Tf.ma(this.currentStateId).$eg(ma+1,new I(U));U=ca.usedRange.pQ();U=excelOnlineCalc.calc.rangeLocation(0,0,U.LastRow,U.LastColumn);ca=excelOnlineCalc.calc.unusedCellsUpdate(ca.sheetId,
U);this.Tf.ma(this.currentStateId).J6d.push(ca)}else b.ULS.sendTraceTag(537170073,0,15,`CalcAsyncEngine.InitializeGridForStateId(): not sheet item for StateId:${this.currentStateId} sheet-index:${ma}`)}}}shk(X){if(X instanceof D.a){var ca=X.usedRange.pQ();ca=excelOnlineCalc.calc.rangeLocation(0,0,ca.LastRow,ca.LastColumn);ca=excelOnlineCalc.calc.unusedCellsUpdate(X.sheetId,ca);this.Tf.ma(this.currentStateId).J6d[X.index]=ca}}teh(){for(let X of this.Tf)X.key<this.Ot&&this.Tf.remove(X.key)}lqd(X){X=
X.value||X.text;if(void 0===X||null===X)X="";return X}Nck(){if(!this.Tf.Pb(this.currentStateId))return!1;let X=!1;h.a.forEach(this.Tf.ma(this.currentStateId).t3a,(ca,U)=>{U.MQb||(X=!0)},null);return X}mbd(X){const ca={};ca.reason=X;ca.kind=1;return ca}Wnc(){return this.Tf.Pb(this.currentStateId)&&this.Tf.ma(this.currentStateId).hl&&this.Tf.ma(this.currentStateId).hl[0]&&this.Tf.ma(this.currentStateId).hl[0].G8?!0:!1}static cnh(X){const ca=[];if(null===X||void 0===X?0:X.qca)for(let U of X.qca)X=excelOnlineCalc.calc.columnData(U.key,
U.value),ca.push(X);return ca}static cZi(X,ca){if(X.type!==ca.type||X.attributes!==ca.attributes||!H.a.equals(X.fullName,ca.fullName,!1)||!X.range.equals(ca.range))return!1;if(!X.iG&&!ca.iG)return!0;if(!X.iG||!ca.iG||X.iG.qca.count!==ca.iG.qca.count)return!1;for(let U of X.iG.qca){let ma;if(!(U.value&&({value:ma}=ca.iG.qca.Ad(U.key)).returnValue&&ma&&H.a.equals(U.value,ma,!1)))return!1}return!0}static U1c(X,ca,U){var ma=K.b6("NamedObject",ca.sheetId,ca.range.top-1,ca.range.left-1,ca.range.bottom-
1,ca.range.right-1);if(2===ca.type){const ra=!!(ca.attributes&16),Va=!!(ca.attributes&8);ca=K.cnh(ca.iG);ma=excelOnlineCalc.calc.namedTableData(ma,ra,Va,ca);X=excelOnlineCalc.calc.namedObject(X,ma)}else ma=excelOnlineCalc.calc.namedRangeData(ma),X=excelOnlineCalc.calc.namedObject(X,ma);U.push(X)}static J8e(X){const ca=Sys.Serialization.JavaScriptSerializer.serialize(X.getRowNumbers());X=Sys.Serialization.JavaScriptSerializer.serialize(X.getColumnNumbers());return ca+X}static Z$b(X){let ca=null;if(1<
X.length)for(let U=1;U<X.length;U++){let ma=0;for(;X[U-1]+1+ma<X[U];)ca=ca||[],ca.push(X[U-1]+ma),ma++}return ca}static ATh(X,ca){if(!ca)return null;for(let U=0,ma=ca.length;U<ma;++U)if(H.a.equals(X,ca[U].Name,!1))return ca[U];return null}static b6(X,ca,U,ma,ra,Va){const ob=(ja,lb,wb,Ab)=>{(0>wb||wb>=Ab)&&b.ULS.sendTraceTag(537170072,0,15,`CalcAsyncEngine::CreateSheetRangeLocation() callerId:${ja} invalid ${lb}:${wb}`)};void 0!==ca&&null!==ca||b.ULS.sendTraceTag(537170071,0,15,`CalcAsyncEngine::CreateSheetRangeLocation() callerId:${X} sheetId is null`);
ob(X,"top",U,K.eEf);ob(X,"left",ma,K.rFd);ob(X,"bottom",ra,K.eEf);ob(X,"right",Va,K.rFd);return excelOnlineCalc.calc.sheetRangeLocation(ca,U,ma,ra,Va)}}K.eEf=1048576;K.rFd=16384;Object(c.a)(K,"CalcAsyncEngine",null,[2]);const R=(X,ca,U)=>{switch(X.type){case 2:return excelOnlineCalc.calc.valueCellData(ca,X.value,U,null);case 1:return excelOnlineCalc.calc.valueCellData(ca,parseFloat(X.value),U,null);case 3:return excelOnlineCalc.calc.valueCellData(ca,1===parseFloat(X.value),U,null);case 4:return excelOnlineCalc.calc.valueCellData(ca,
excelOnlineCalc.calc.errorValue(parseFloat(X.value)),U,null);default:return excelOnlineCalc.calc.valueCellData("",excelOnlineCalc.calc.blankValue,U,null)}};class Z{constructor(){this.UL=this.VL=this.OG=this.PG=this.j1=!1}}Object(c.a)(Z,"AbsoluteRelativeReferenceInfo",null,[]);var P=a(25);class V{}V.aXf="#";Object(c.a)(V,"Operators",null,[]);var Ea=a(1109);class oa{}oa.sheet="Sheet";oa.sheetRange="SheetRange";oa.document="Document";oa.hri="Ident";Object(c.a)(oa,"TraverseFormulaQualifierTypes",null,
[]);var ea=a(1110),aa=a(953),ia=a(842),ya=a(47),za=a(63),la=a(79),xa=a(296),wa=a(42);class hb extends Sys.EventArgs{constructor(X){super();this.ol=X}}Object(c.a)(hb,"EditedCellRecalcCompleteEventArgs",Sys.EventArgs,[]);var Ja=a(149),Fa=a(35),Ba=a(327);class fa{constructor(X,ca){this.vLf=(U,ma)=>{U=this.gridView.ga.pa.activeCell;const ra=this.gridView.tc(U);null!=ra&&this.Ykj(U,ma.text,ra.cell.yi,ra.cell.Ww.X6b,this.gridView.$.activeItemName)};this.TBa=()=>{this.tAa=Object(xa.a)({message:"PrefetchNotStarted"})};
this.calcManager=X;this.gridView=ca;this.tAa=Object(xa.a)({message:"Ctor"});X=z.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.SetCellEstimationPrefetchMsDebounce",100);this.Ykj=Ba.a((U,ma,ra,Va,ob)=>this.prefetch({text:ma,range:U,ifmt:ra,stateId:Va,sheetName:ob}),X);this.gridView.Gc.ro(this.TBa);this.gridView.ai.fye(this.vLf)}dispose(){this.gridView.ai.R4f(this.vLf);this.gridView.Gc.io(this.TBa);this.mKe()}T8e(X){if(Object(xa.b)(this.tAa))return Object(xa.a)(this.tAa.reason.message);if(fa.H2g(X,
this.tAa.value.key)){for(const ca of this.tAa.value.results.results)if(Object(xa.c)(ca)&&fa.bHi(X,ca))return ca;return Object(xa.a)("RangeNotFoundInPrefetchResult")}return Object(xa.a)("ResultUnavailable")}mKe(){this.tAa=Object(xa.a)({message:"PrefetchResultCleared"})}prefetch(X){this.tAa=Object(xa.a)({message:"EvalInProgress",key:X});this.calcManager.n6a([],X.range,X.range,X.text,!0).then(ca=>{this.tAa=Object(xa.d)({key:X,results:ca})}).catch(ca=>{b.ULS.sendTraceTag(509219811,0,50,`SetCellEstimationPrefetcher.prefetch: evalFormulaRangeOnClonedModel promise rejected with error ${ca}`)})}static H2g(X,
ca){return X.text===ca.text&&X.range.toString()===ca.range.toString()&&X.ifmt===ca.ifmt&&X.stateId===ca.stateId&&X.sheetName===ca.sheetName}static bHi(X,ca){return X.range.top-1===ca.value.cell.row&&X.range.left-1===ca.value.cell.col}}Object(c.a)(fa,"SetCellEstimationPrefetcher",null,[675,2]);var ta=a(92),Oa;let Ma=Oa=class extends wa.a{constructor(X){super();this.wt=null;this.qxg=!1;this.OUd=this.instantaneousSupportInformationManager=this.lMb=null;this.$Hd=new Map;this.Pme=null;this.dvc=ca=>{b.ULS.sendTraceTag(537170005,
0,50,"CalcManager.OnLocaleInformationAvailable() called");ca.JSd(this.dvc);ca.ema.length?this.Iuc(ca,Sys.EventArgs.Empty):(b.ULS.sendTraceTag(537170004,0,50,"CalcManager.OnLocaleInformationAvailable() - waiting for functions information"),ca.oye(this.Iuc))};this.Iuc=ca=>{b.ULS.sendTraceTag(537170003,0,50,"CalcManager.OnFunctionsInfoReady called");ca.wSd(this.Iuc);this.tak(ca)};this.onContentReady=()=>{this.wt&&(this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.Qlc||
za.Task.delay(0).continueWith(()=>{this.wt.HUb(1)},0,null,la.a.current))};this.cJf=(ca,U)=>{this.wt&&(this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.Qlc||this.wt.ZQe(U.Td.block))};b.ULS.sendTraceTag(537170067,0,50,"Creating CalcManager");this.Bmc=!1;this.Ub=X;this.su=F.h(X);this.bOc=null;this.gridView.ut(this.onContentReady);this.gridView.Ca.v2c(this.cJf);this.$.da.Qb(268,ca=>{ca.Ef?(b.ULS.sendTraceTag(537170066,0,50,"CalcManager.ctor: LocaleInformation already available..."),
this.dvc(ca,Sys.EventArgs.Empty)):(b.ULS.sendTraceTag(537170065,0,50,"CalcManager.ctor: waiting for LocaleInformation..."),ca.Jye(this.dvc))});if(this.a8=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SetCellEstimationPrefetch",!1))this.hre=new fa(this,this.su)}VWg(X){this.addHandler(Oa.qWe,X)}PGf(X){this.raiseEvent(Oa.qWe,new hb(X))}get tDc(){return this.hre}get p_(){return this.bOc}get gridView(){return this.su}get $(){return this.Ub}get fH(){return this.Pme}get localeInfo(){return this.p_?
this.p_.config.localeInfo:null}get config(){return this.p_.config}dispose(){b.ULS.sendTraceTag(537170064,0,50,"CalcManager.Dispose called");this.$.da.Qb(268,X=>{X.JSd(this.dvc);X.wSd(this.Iuc)});this.gridView&&(this.gridView.$v(this.onContentReady),this.gridView.Ca&&this.gridView.Ca.x4f(this.cJf),this.su=null);this.bOc=null;this.Bmc=!1;this.a8&&(ta.a.Ka(this.tDc),this.hre=null)}$$g(X,ca,U,ma=null){this.wt&&this.wt.X$g(X,ca,U,ma)}aah(X,ca){return this.wt?this.wt.Y$g(X,ca):!1}evalFormula(X,ca,U,ma){return this.wt?
this.wt.evalFormula(X,ca,U,ma):Promise.reject("calc engine not initialized")}n6a(X,ca,U,ma,ra){return this.wt?this.wt.n6a(X,ca,U,ma,ra):Promise.reject("CalcEngine is null")}Pic(X){if(!X)return b.ULS.sendTraceTag(509649312,0,100,"CalcManager.GetTableHeaders: table is null"),null;if(!this.wt)return null;b.ULS.shipAssertTag(537170059,0,2===X.type,"CalcManager.GetTableHeaders() - ActiveItem is not a table");return this.wt.Pic(X)}j0g(X,ca){if(!ca||2!==X.type)return!1;X=m.a(X);return X.right-X.left+1===
ca.count}a3e(X,ca){if(!this.lMb)return this.qxg||b.ULS.sendTraceTag(537170057,0,15,"CalcManager.ExtractReferenceWrappers - parser not initialized"),null;var U=this.iwb(P.Range.xd(1,1));U=this.lMb.parseFormula(excelOnlineCalc.parse.parseLocals(1,U.range),X);if(!excelOnlineCalc.parse.parseResultHelper.isSuccess(U))return b.ULS.sendTraceTag(537170056,0,10,"CalcManager.ExtractReferenceWrappers - ParseFormula failed"),null;try{let ma;const ra=null!==ca&&void 0!==ca?ca:this.gridView.ga.pa.activeCell,Va=
excelOnlineCalc.location.gridCell(ra.top-1,ra.left-1),ob=excelOnlineCalc.location.documentLoc("",this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),ja=excelOnlineCalc.location.sheetIndex(ob,this.$.ua.na.sheetId),lb=this.vrh(Va,ja);this.OUd||(this.OUd=excelOnlineCalc.util.createResolver(this.urh()));ma=excelOnlineCalc.parse.parseResultHelper.extractReferences(U,this.p_.config.localeInfo,z.EwaSettings.ya(512),lb,this.OUd);z.EwaSettings.ya(101)&&this.mgk(ma,X);return ma}catch(ma){return b.ULS.sendTraceTag(537170055,
0,10,`CalcManager.ExtractReferenceWrappers - exception: ${ma.message}`),null}}extractLetVariables(X,ca){if(!this.lMb)return this.qxg||b.ULS.sendTraceTag(537170054,0,15,"CalcManager.ExtractLetVariables - parser not initialized"),null;const U=this.iwb(P.Range.xd(1,1));X=this.lMb.parseFormula(excelOnlineCalc.parse.parseLocals(1,U.range),X);if(!excelOnlineCalc.parse.parseResultHelper.isSuccess(X))return b.ULS.sendTraceTag(537170053,0,10,"CalcManager.ExtractLetVariables - ParseFormula failed"),null;try{return excelOnlineCalc.parse.parseResultHelper.extractLetVariables(X,
ca,this.p_.config.localeInfo)}catch(ma){return b.ULS.sendTraceTag(537170052,0,10,`CalcManager.ExtractLetVariables - exception: ${ma.message}`),null}}extractReferences(X,ca,U,ma,ra){if(!ca)return b.ULS.sendTraceTag(537170051,0,10,"CalcManager.ExtractReferences - sheetName is null"),null;if(!U)return b.ULS.sendTraceTag(537170050,0,10,"CalcManager.ExtractReferences - documentName is null"),null;const Va=this.a3e(X,ra);if(!Va)return b.ULS.sendTraceTag(537170049,0,15,"CalcManager.ExtractReferences - ExtractReferenceWrappers returned null"),
null;try{return this.pqh(Va,ca,U,X,ma,ra)}catch(ob){return b.ULS.sendTraceTag(537170048,0,10,`CalcManager.ExtractReferences - exception: ${ob.message}`),null}}iwb(X,ca=!0){return X&&this.p_?this.p_.Srh(this.p_.Fth(),X.top-1,X.left-1,ca):null}prf(X,ca){X=this.dOa(X);if(!Object(xa.c)(X))return null;ca=this.fH.parseEdit(ca,X.value);return excelOnlineCalc.util.isSuccess(ca)?ca.value.kind===aa.a.formula:null}oJi(X){X=this.dOa(X);return Object(xa.c)(X)?"Text"===X.value.valueType:null}$pf(X){X=this.dOa(X);
return Object(xa.c)(X)?"Date"===X.value.valueType&&!X.value.hasTime:null}dOa(X){if(null==this.fH)return Object(xa.a)("Number formatter is null");if(null==this.instantaneousSupportInformationManager)return Object(xa.a)("Instantaneous manager is null");if(this.$Hd.has(X))return Object(xa.d)(this.$Hd.get(X));if("number"===typeof X){var ca=this.lod(X);if(null==ca)return Object(xa.a)(`Invalid ifmt=${X}`);var U=ca.FormatString;ca=ca.Builtin}else U=X,ca=!1;U=this.fH.createFormat(U,ca);return excelOnlineCalc.util.isSuccess(U)?
(this.$Hd.set(X,U.value),Object(xa.d)(U.value)):Object(xa.a)("Could not create number format")}getWorksheetFuncId(X){return this.localeInfo.getWorksheetFuncId(X)}pqh(X,ca,U,ma,ra,Va){const ob={Items:[]};for(let Ab=0;Ab<X.length;Ab++){var ja=X[Ab];const nb={};nb.Start=ja.span.start;nb.End=ja.span.end;if(ra||ja.kind!==Ea.a.func)if(ra||ja.kind!==Ea.a.cOi){if(!this.qAh(ja,ca,U))continue;var lb=new Z;const pb=this.Gci(ja,ca,lb,ma,Va);if(z.EwaSettings.ya(512)){var wb=this.t9h(ja);const cb=this.s9h(ja);
if(pb||cb&&0<=wb){let Da={};Da.Span=nb;Da.LetNumber=wb;Da.LetName=cb;Da.Range=pb;Da.IsRangeRef=lb.j1;Da.IsAbsoluteFirstRow=lb.PG;Da.IsAbsoluteFirstColumn=lb.OG;Da.IsAbsoluteSecondRow=lb.VL;Da.IsAbsoluteSecondColumn=lb.UL;Da.IsStructRef=ja.kind===Ea.a.N2d;ob.Items.push(Da)}}else pb&&(wb={},wb.Span=nb,wb.Range=pb,wb.IsRangeRef=lb.j1,wb.IsAbsoluteFirstRow=lb.PG,wb.IsAbsoluteFirstColumn=lb.OG,wb.IsAbsoluteSecondRow=lb.VL,wb.IsAbsoluteSecondColumn=lb.UL,wb.IsStructRef=ja.kind===Ea.a.N2d,ob.Items.push(wb))}else ja=
ja.ref.value.oper.kind,lb={},lb.Span=nb,lb.IsString=2===ja,lb.IsBoolean=4===ja,lb.IsNumber=1===ja,ob.Items.push(lb);else nb.End=ja.span.start+ja.ref.name.length,ja={},ja.Span=nb,ja.IsFunction=!0,ja.FunctionId=this.getWorksheetFuncId(ma.substring(nb.Start,nb.End)),ob.Items.push(ja)}ob.Items.sort((Ab,nb)=>Ab.Span.Start-nb.Span.Start);return ob}t9h(X){return X.kind===Ea.a.Gyf?X.ref.number:-1}s9h(X){return X.kind===Ea.a.Gyf?X.ref.name:null}Gci(X,ca,U,ma,ra){if(X.kind===Ea.a.range)return U.j1=!0,this.KNe(X,
ca,U,ma);if(X.kind===Ea.a.namedRange){U=X.ref;(X=this.$.oc.getItemByName(U.name))||(X=this.$.oc.getItemByName(ca+"!"+U.name));if(!(X&&X.sheetName&&X.usedRange&&H.a.equals(X.sheetName,ca,!0)))return null;ca=2===X.type?m.a(X):X.usedRange;return ya.m(ca,X)}if(X.kind===Ea.a.N2d){let Va=X.ref;Va.name?(ra=this.$.oc.getItemByName(Va.name))||(ra=this.$.oc.getItemByName(ca+"!"+Va.name)):ra=z.EwaSettings.isChangeGateEnabled("OfficeVSO:7907929_RecognizeTableRangeFromOriginCell")&&ra?this.gridView.Wb.rh(ra):
this.gridView.Wb.rh(this.gridView.ga.pa.activeCell);if(!(ra&&ra.sheetName&&ra.usedRange&&H.a.equals(ra.sheetName,ca,!0)))return null;U.j1=!1;return this.KNe(X,ca,U,ma)}return null}KNe(X,ca,U,ma){X=X.ref;if(X.type){if(X.type===ea.a.column){var ra=X.startIndex;X=X.endIndex;U.OG=ra.kind===ia.a.abs;U.UL=X.kind===ia.a.abs;return this.createRange(0,ra.index,d.a.Sg,X.index,ca)}if(X.type===ea.a.row)return ra=X.endIndex,U.PG=X.startIndex.kind===ia.a.abs,U.VL=ra.kind===ia.a.abs,this.createRange(X.startIndex.index,
0,X.endIndex.index,d.a.Rg,ca);if(X.type===ea.a.cell){ra=X.row;var Va=X.col;U.PG=U.VL=ra.kind===ia.a.abs;U.OG=U.UL=Va.kind===ia.a.abs;return this.q8b(X.span.end,ma)&&(U=P.Range.xd(ra.index+1,Va.index+1),U=this.gridView.Wb.Zef(U))?ya.n(U,ca):this.createRange(ra.index,Va.index,ra.index,Va.index,ca)}if(X.type===ea.a.range){ra=X.top;Va=X.left;ma=X.bottom;X=X.right;const ob=Math.min(ra.index,ma.index),ja=Math.min(Va.index,X.index),lb=Math.max(ra.index,ma.index),wb=Math.max(Va.index,X.index);U.PG=ra.kind===
ia.a.abs;U.VL=ma.kind===ia.a.abs;U.OG=Va.kind===ia.a.abs;U.UL=X.kind===ia.a.abs;return this.createRange(ob,ja,lb,wb,ca)}b.ULS.sendTraceTag(537170010,0,10,`CalcManager.CovertFormulaRefToRange: Unsupported formula ref type '${X.type}'`);return null}b.ULS.sendTraceTag(537170011,0,15,"CalcManager.CovertFormulaRefToRange: traverseFormulaRef.Type is null");return null}q8b(X,ca){return ca.length>=X&&0<X&&ca.charAt(X-1)===V.aXf}S$g(X,ca,U){this.wt&&this.wt.Z$g(X,ca,U)}lod(X){return this.instantaneousSupportInformationManager&&
this.instantaneousSupportInformationManager.sBa&&this.instantaneousSupportInformationManager.sBa[X]&&this.fH?this.instantaneousSupportInformationManager.sBa[X]:null}toXLNumber(X){if(!this.fH)return null;X=excelOnlineCalc.numfmt.toXLNumber(this.config.mathpack,this.fH,X);return excelOnlineCalc.util.isSuccess(X)?X.value:null}mgk(X,ca){if(X)for(const U of X)U.ref.type&&U.ref.type===ea.a.cell&&(X=U.ref,Oa.Okj(X,ca)&&(X.span.end+=1,U.span.end+=1))}createRange(X,ca,U,ma,ra){const Va={};Va.FirstRow=X;Va.FirstColumn=
ca;Va.LastRow=U;Va.LastColumn=ma;Va.SheetName=ra;return Va}qAh(X,ca,U){var ma=X.ref.qualifier;if(!ma)return!0;switch(X.ref.qualifier.type){case oa.sheet:return X=ma.document,H.a.equals(ma.sheet,ca,!0)&&(!X||H.a.equals(X.document,U,!0));case oa.sheetRange:return ca=this.$.ua.getItemByName(ca),U=this.$.ua.getItemByName(ma.sheet1),ma=this.$.ua.getItemByName(ma.sheet2),!!ca&&!!U&&!!ma&&(U.index<=ca.index&&ca.index<=ma.index||ma.index<=ca.index&&ca.index<=U.index);case oa.document:return H.a.equals(ma.document,
U,!0);case oa.hri:return ma=ma.name,H.a.equals(ma,ca,!0)||H.a.equals(ma,U,!0);default:return b.ULS.sendTraceTag(537170009,0,10,`CalcManager.GetQualifierData: Unsupported formula qualifier type '${ma.type}'`),!1}}tak(X){this.instantaneousSupportInformationManager=X;X.sBa.length&&X.ema.length?(this.bOc=new S.CalcHelper(this.gridView.$),this.lMb=this.p_.createParser(),this.Pme=this.p_.createNumberFormatter(),this.Bmc=!0,b.ULS.sendTraceTag(537170007,0,50,"CalcManager.TryInitializeInternal: calc initialized"),
this.wt||(b.ULS.sendTraceTag(537170006,0,50,"CalcManager creating calc engine"),this.wt=new K(this.$))):b.ULS.sendTraceTag(537170008,0,15,`CalcManager.TryInitializeInternal: IInstantaneousSupportInformationManager locale information missing, cannot initialize calc. number formats count = ${X.sBa.length}, functions info count = ${X.ema.length}`)}vrh(X,ca){const U={allowUnqualifiedCell:!0,wrapCellReferences:!0};U.config=this.p_.config;U.originGridCell=excelOnlineCalc.util.success(X);U.originSheet=excelOnlineCalc.util.success(ca);
return U}urh(){const X={};X.config=this.p_.config;X.getNameLoc=this.wt.getNameLoc;X.getContainingTable=this.wt.getContainingTable;X.getStructRefColumn=this.wt.getStructRefColumn;X.getStructRefSpecialRef=this.wt.getStructRefSpecialRef;X.getDocumentLoc=this.wt.getDocumentLoc;X.getSheetIndex=this.wt.getSheetIndex;X.getSheetName=this.wt.getSheetName;X.getUserDefinedFuncLoc=this.wt.getUserDefinedFuncLoc;X.getSheetRangeIndexes=this.wt.getSheetRangeIndexes;return X}static Okj(X,ca){return ca.length>X.span.end&&
ca.charAt(X.span.end)===V.aXf}};Ma.qWe="ECRC";Ma=Oa=Object(f.b)([Object(Ja.d)(Fa.i),Object(f.c)(0,Object(Fa.E)()),Object(f.c)(1,Object(Fa.F)())],Ma);Object(c.a)(Ma,"CalcManager",wa.a,[604,2]);var fb=a(40),pa=a(54);class Ua extends e.a{constructor(X){super();this.$=X;this.uc()}create(){if(this.$){b.ULS.sendTraceTag(537169993,0,50,"CalcManagerFactory.Create: Start loading script");if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:5543503_loadCalcCurrentVersion")){var X=78;var ca="Current"}else X=81,ca=
"Stable";b.ULS.sendTraceTag(537169992,0,50,`CalcManagerFactory.Create: Calc ${ca} JS was loaded`);fb.TaskExtensions.za(pa.a.loadScript(X,4,this.La,void 0,void 0,265),()=>{b.ULS.sendTraceTag(537169991,0,50,"CalcManagerFactory.Create: Raised create service event");let U=this.$.da.Ba(266,!1);U||(b.ULS.sendTraceTag(537169990,0,50,"CalcManagerFactory.Create: CalcManager is not registered, creating new CalcManager"),U=new Ma(this.$),this.$.da.Ja(266,U));this.$b(U)},this.ka,3)}else b.ULS.sendTraceTag(537169994,
0,50,"CalcManagerFactory.Create: ewaControl is null, cann't create the service")}static la(X){X&&X.da&&X.da.Ja(265,new Ua(X))}}Object(c.a)(Ua,"CalcManagerFactory",e.a,[]);var Sa=a(10);a.d(C,"a",function(){return Ia});const Ia=()=>{Sa.a.Fa(X=>{z.EwaSettings.xC()||Ua.la(X)})};String(r);window.___1684780567558_closurehack=r},1215:function(r,C,a){r={};a.r(r);a.d(r,"SharedUIControlsFactory",function(){return Pa});var c=a(10),b=a(72),e=a(0),f=a(230),d=a(118),h=a(15),l=a(206),k=a(86),u=a(40),v=a(51),x=a(48),
w=a(1),m=a(663),t=a(33),z=a(130);class y{constructor(){this.startTime=t.a.Lb.Mc;this.Vy=new m.a}x$e(){return z.a(t.a.Lb,this.startTime)}}Object(e.a)(y,"OngoingAction",null,[]);class D extends k.a{constructor(Jb,Qa,Db,sa,Ha=null){super();this.PSa=this.Isb=null;this.M6c=0;this.nwc=null;this.ibj=()=>{const mb=this.PSa.x$e();h.ULS.sendTraceTag(537153861,0,50,`ActionAggregator<${this.uoa}>.OnRunningLong: Operation running for more than ${mb}ms`);this.nwc=v.a.instance.create(this.h9,Math.max(this.xGe-mb,
0),x.a.Rue)};this.h9=()=>{h.ULS.sendTraceTag(537153860,0,50,`ActionAggregator<${this.uoa}>.OnTimeout: Operation running for more than ${this.PSa.x$e()}ms, timing out. Has pending actions: ${this.O9a}`);this.M6c++;this.M6c>this.wGe&&h.ULS.sendTraceTag(537153859,0,50,`ActionAggregator<${this.uoa}>.OnTimeout: passed the allowed bypassed count`);this.PSa.Vy.cancel();this.B4e()};this.KJ=()=>{this.O9a&&h.ULS.sendTraceTag(537153858,0,50,`ActionAggregator<${this.uoa}>.OnDocumentUnhidden: Start. IsActionOngoing: ${this.uPa}, AggregatedActionParams not null: ${this.O9a}`);
this.cvd()};this.CRg=Jb;this.DRg=Qa;this.documentVisibilityObserver=Db;this.uoa=sa;this.RM=Ha;Db&&this.documentVisibilityObserver.Xua(this.KJ);this.L6c=!!Db&&w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperation",!1);this.wGe=w.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLimit",3);Qa=w.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationThresholdInMs",5E3);this.xGe=Jb.C7e(Qa);Jb=
w.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLogThresholdInMs",1E3);this.a$g=Math.max(this.xGe-Qa,0)+Jb}get uPa(){return!!this.PSa}get O9a(){return!!this.Isb}NVf(Jb){h.ULS.sendTraceTag(537153864,0,50,`ActionAggregator<${this.uoa}>.PerformThrottledAction: Start. IsActionOngoing: ${this.uPa}, AggregatedActionParams not null: ${this.O9a}`);this.Isb=this.DRg.eAe(Jb,this.Isb);this.cvd()}dispose(){this.documentVisibilityObserver&&this.documentVisibilityObserver.UCa(this.KJ);
this.iIe();super.dispose()}zeg(Jb){this.L6c?(this.PSa=Jb?new y:null,Jb?this.startTimer():this.iIe()):this.PSa=Jb?{}:null}B4e(Jb=null){this.L6c&&Jb&&Jb.yO?h.ULS.sendTraceTag(537153863,0,50,`ActionAggregator<${this.uoa}>.FinishedCallback: timedout, skipping`):(h.ULS.sendTraceTag(537153862,0,50,`ActionAggregator<${this.uoa}>.FinishedCallback: Start. IsActionOngoing: ${this.uPa}, AggregatedActionParams not null: ${this.O9a}`),this.zeg(!1),this.cvd())}cvd(){if(!this.dSb()){var Jb=this.Isb;this.Isb=null;
this.zeg(!0);h.ULS.sendTraceTag(537153857,0,50,`ActionAggregator<${this.uoa}>.InternalPerformAction: Calling PerformAction.`);var Qa=this.L6c?this.PSa.Vy.token:l.a.none;u.TaskExtensions.za(this.CRg.KVf(Jb),()=>{this.B4e(Qa)},Qa,0,this.RM)}}dSb(){return!this.O9a||this.uPa?!0:this.documentVisibilityObserver&&this.documentVisibilityObserver.Ei?(h.ULS.sendTraceTag(593376846,0,50,`ActionAggregator<${this.uoa}>.ShouldThrottle: Not Calling PerformAction as document is hidden.`),!0):!1}iIe(){this.nwc&&this.nwc.cancel()}startTimer(){this.M6c<=
this.wGe&&(this.nwc=v.a.instance.create(this.ibj,this.a$g,x.a.Rue))}}Object(e.a)(D,"ActionAggregator",k.a,[545,2]);var H=a(31),F=a(90),G=a(113),L=a(14),M=a(49),O=a(42),B=a(20),E=a(7),I=a(141),S=a(16),J=a(19),K=a(63);class R extends O.a{constructor(Jb){super();this.ay=this.firstElement=null;this.VPa=!1;this.ku=null;this.HTj=H.a.Bg;this.aOf=Qa=>{const Db=Qa.Da.keyCode;return Db===F.a.Li?this.L4i():Db===F.a.aA&&Qa.Da.shiftKey?this.mQh(this.firstElement):!1};this.zTf=Qa=>{if(!this.VPa||Qa.Da.keyCode!==
F.a.NH)return!1;R.Kkf();K.Task.delay(1).Mq(()=>{this.ay.focus();return!0},0,this.ka);return!0};this.zej=()=>{document.activeElement&&document.activeElement.id===this.ay.id||(R.Kkf(),K.Task.delay(1).Mq(()=>{this.ay.focus();return!0},0,this.ka))};this.TLf=()=>{this.Vpg(this.ay)};this.$Nf=Qa=>{Qa.stopPropagation();Qa.preventDefault();this.VPa&&(this.VPa=!1)};this.$=Jb;(Jb=this.$.ea.Rc)&&h.ULS.sendTraceTag(39350791,0,50,`EmbedViewFocusControl: PermissionSet = ${Jb.Zva}; InWebPart = '${Jb.inWebPart?"Classic":
"Non Classic"}', InEmbedView = '${Jb.inEmbedView?"True (+Modern)":"False (not Modern)"}'`);Jb&&(Jb.inWebPart||Jb.inEmbedView)?h.ULS.sendTraceTag(537153856,0,15,`EwaControl.EmbedViewFocusControl: disable focus grabbing by embedded workbooks and disable some related keyboard navigation. InWebPart = '${Jb.inWebPart?"Classic":"Non Classic"}', InEmbedView = '${Jb.inEmbedView?"True (+Modern)":"False (not Modern)"}'`):(this.koh(),this.iph(),G.KeyInputManager.instance.ta(L.a.Ic,this.$.domElement,this.zTf));
this.$.da.Ja(238,this)}RXg(Jb){this.addHandler("KBIS",Jb)}Vyj(Jb){this.removeHandler("KBIS",Jb)}dispose(){this.firstElement&&M.a.removeHandler(this.firstElement,L.a.focus,this.TLf);this.ku&&this.ku.detach("focus");this.ay&&(M.a.removeHandler(this.ay,L.a.focus,this.$Nf),M.a.removeHandler(this.ay,L.a.blur,R.onBlur),G.KeyInputManager.instance.Aa(L.a.Ic,this.ay,this.aOf));G.KeyInputManager.instance.Aa(L.a.Ic,this.$.domElement,this.zTf);this.ku=this.ay=this.firstElement=this.$=null;super.dispose()}koh(){this.HTj?
(this.firstElement=document.documentElement,this.ku=I.a.instance.JI(document.parentWindow),this.ku.la("focus",this.zej)):(this.firstElement=R.rPe(),document.body.insertBefore(this.firstElement,document.body.childNodes[0]),M.a.addHandler(this.firstElement,L.a.focus,this.TLf))}iph(){this.ay=R.rPe();this.ay.id=E.a.$We;this.ay.setAttribute(E.a.xv,S.a.instance.ha(863));document.body.appendChild(this.ay);M.a.addHandler(this.ay,L.a.focus,this.$Nf);M.a.addHandler(this.ay,L.a.blur,R.onBlur);G.KeyInputManager.instance.ta(L.a.Ic,
this.ay,this.aOf)}mQh(Jb){this.Vpg(Jb);return!1}L4i(){this.VPa=!0;J.h(this.$).focus();J.h(this.$).ga.Shf();this.raiseEvent("KBIS");return!0}Vpg(Jb){this.VPa?this.VPa=!1:(this.VPa=!0,Jb&&Jb.focus())}static rPe(){const Jb=document.createElement("div");Jb.tabIndex=0;return Jb}static Kkf(){document.body.classList.add(B.a.xZe)}static onBlur(){document.body.classList.remove(B.a.xZe)}}Object(e.a)(R,"EmbedViewFocusControl",O.a,[543,2]);var Z=a(6),P=a(68),V=a(533),Ea=a(25),oa=a(47),ea=a(382),aa=a(201),ia=
a(323),ya=a(119),za=a(34),la=a(231),xa=a(248),wa=a(59);const hb=(Jb,Qa,Db,sa,Ha,mb,qa,Xa,Ca,va,na=null)=>{na=Jb.Pa(1,na);na.selectedRange=Qa;na.richValueKeyPath=Db;na.singleColumn=sa;na.searchForRange=Ha;na.calculateMajorityDataType=mb;return wa.g(Jb,"GetRichValueFieldListContextList",na,qa,Xa,Ca,va,4)};var Ja=a(30);class Fa extends O.a{constructor(Jb,Qa){super();this.xPb=this.Pmd=this.WAb=this.NQ=null;this.l_b=!1;this.Ede=null;this.uPd=!1;this.q6i=(Db,sa,Ha)=>{h.ULS.sendTraceTag(25264350,0,10,"Call to GetRichValueFieldListContextList failed in: "+
Ha);this.xPb&&this.xPb.stop();this.NQ=null;this.raiseEvent("GetFieldInfoListContextOperationFailed")};this.r6i=Db=>{la.a(Db)||(this.xPb&&this.xPb.stop(),this.l_b=!1,(this.NQ=Db.Result)&&0<this.NQ.length&&h.ULS.sendTraceTag(25264351,0,50,`Retrieved ${this.NQ.length} rich value field list context for autocomplete`),this.ZZa=!0,this.uyc())};this.ZZa=!1;this.Ub=Jb;this.RYb=-1;this.tableManager=Qa;this.uPd=w.EwaSettings.isChangeGateEnabled("OfficeVSO:6395797_raiseFieldInfoLoadedEventOnEmptyResults")&&
Ja.a.BO(Jb)}z4b(Jb){this.addHandler("FieldInfoListContextLoaded",Jb)}$zc(Jb){this.removeHandler("FieldInfoListContextLoaded",Jb)}pXg(Jb){this.addHandler("GetFieldInfoListContextOperationFailed",Jb)}Byj(Jb){this.removeHandler("GetFieldInfoListContextOperationFailed",Jb)}get t$a(){return this.ZZa}get WOi(){return this.l_b}get y6e(){return this.RYb}get lcd(){return this.Ede}get $(){return this.Ub}get Pl(){return this.NQ}get X5h(){return!!this.WAb}dispose(){this.Ub=null;this.wgb();super.dispose()}z0(Jb,
Qa,Db,sa=null){if(Jb){this.v7c();this.$7b();var Ha=null,mb=!1;if(!sa&&({ceb:mb,Pl:Ha}=this.iak(Jb,Qa,Db)).returnValue)if(this.uPd||this.wdg(Ha),this.l_b=!0,this.NQ=Ha,this.uPd){if(!mb){this.ZZa=!0;this.uyc();return}}else if(this.NQ&&0<this.NQ.length&&(this.ZZa=!0,this.uyc()),!mb)return;this.Stg(Jb,sa,Qa,Db,!1)}}Stg(Jb,Qa,Db,sa,Ha){if(this.$.ea.Oc){this.$.yc&&(this.xPb=this.$.yc.Fd("WebServiceCall","GetRichValueFieldInfoListContext"));this.WAb=null;var mb=this.$.qa.va.Lc();this.WAb=hb(this.$.qa.va,
Jb,Qa,Db,sa,Ha,this.r6i,this.q6i,null,mb)}else this.NQ=null}wgb(){this.NQ=null;this.ZZa=!1;this.v7c();this.$7b();this.WAb=null;this.RYb=-1}v7c(){Fa.Sub(this.WAb)}$7b(){Fa.Sub(this.Pmd)}uyc(){this.raiseEvent("FieldInfoListContextLoaded")}Uq(Jb){Jb=oa.E(Jb);--Jb.left;--Jb.right;return this.tableManager.Uq(Jb)}NNa(Jb){Jb.FirstColumn=Jb.FirstColumn;Jb.LastColumn=Jb.LastColumn;Jb.FirstRow=Jb.FirstRow;Jb.LastRow=Jb.LastRow;this.$7b();this.Pmd=null;return ea.a(this.$.userOperationManager,(Qa,Db,sa)=>ia.j(this.$.qa.va,
Jb,xa.b(Qa,Ha=>{this.A6i(Ha)}),xa.a(Db,Db,Ha=>{this.z6i(Ha)}),sa,null),Qa=>new aa.a(264,0,Qa,80),null)}z6i(Jb){Jb=ya.a.vf(Jb.data);h.ULS.sendTraceTag(525336847,0,10,`FieldInfoManager.OnGetFullTableRangeFailure - Webservice call failed with Errors: ${za.a.Uc(Jb)}`)}A6i(Jb){if(la.a(Jb))-315732528!==Jb.Errors[0].MessageId&&h.ULS.sendTraceTag(525336846,0,10,`FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call failed with Unexpected error : ${za.a.Uc(Jb.Errors)}`);else if(Jb&&Jb.Result){Jb=Jb.Result;
var Qa=Jb.HasHeaderRow;Qa=new V.AutofilterRange(Jb.TableRange.FirstRow+(Qa?1:0)+1,Jb.TableRange.FirstColumn+1,Jb.TableRange.LastRow+1,Jb.TableRange.LastColumn+1,null,null,null,0,Qa);this.RYb=Jb.TableRange.FirstColumn;(Jb=this.$Yf(!1,!0,Qa))||h.ULS.sendTraceTag(525336844,0,50,"FieldInfoManager.OnGetFullTableRangeSuccess - fieldInfoListContextList is null");this.wdg(Jb)}else h.ULS.sendTraceTag(525336845,0,10,"FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call returned no result")}iak(Jb,
Qa,Db){let sa,Ha;Ha=null;sa=!1;if(Jb.SheetName!==this.$.ea.na.sheetName)return{returnValue:!1,ceb:sa,NNa:!1,Pl:Ha};let mb;this.RYb=-1;if(Db){mb=this.Uq(Jb);if(!mb||!mb.Zma)return{returnValue:!1,ceb:sa,NNa:!1,Pl:Ha};var qa=J.h(this.$).Wb.Zdf(mb);this.Ede=mb;if(w.EwaSettings.isChangeGateEnabled("OfficeVSO:5167298_ObtainFullRangeOfTableForPopulatingInsertDataDropdownCorrectly")&&qa&&0<qa.count)return--Jb.FirstColumn,--Jb.LastColumn,this.Pmd=this.NNa(Jb),{returnValue:!0,ceb:sa,NNa:!0,Pl:Ha};mb.top+=1;
mb.right=oa.E(Jb).right-1}else mb=new V.AutofilterRange(Jb.FirstRow+1,Jb.FirstColumn+1,Jb.LastRow+1,Jb.LastColumn+1,null,null,null,0,!1);if(mb.top>mb.bottom||mb.left>mb.right)return{returnValue:!0,ceb:sa,NNa:!1,Pl:Ha};Jb=J.h(this.$);var Xa=Jb.Mb.width,Ca=Jb.Mb.height;qa=Jb.view.visibleArea;Xa=new P.a(qa.x-Xa,qa.y-Ca,qa.width+Xa,qa.height+Ca);Ca=Jb.gh(mb);if(!qa||!Ca||!Jb.Eoc(mb))return{returnValue:!1,ceb:sa,NNa:!1,Pl:Ha};Xa.contains(Ca)||(sa=!0);Ha=this.$Yf(Qa,Db,mb);return{returnValue:!0,ceb:sa,
NNa:!1,Pl:Ha}}wdg(Jb){Jb&&h.ULS.sendTraceTag(25264348,0,50,`Retrieved ${Jb.length} rich value field contexts from block cache`);this.l_b=!0;(this.NQ=Jb)&&0<this.NQ.length&&(this.ZZa=!0,this.uyc())}$Yf(Jb,Qa,Db){let sa;sa=null;const Ha=Db.clone();if(Qa)for(let mb=Db.right,qa=0;mb>=Db.left;--mb){if(Ha.left=mb,Ha.right=mb,Qa=this.M$e(Ha,!0,Db.left)){sa||(sa=[]);sa[qa]=Qa;if(Jb)break;++qa}}else if(Jb=this.M$e(Ha,!1))sa=[],sa[0]=Jb;return sa}M$e(Jb,Qa,Db=0){var sa=null;if(w.EwaSettings.isChangeGateEnabled("OfficeVSO:5723259_StoreRichValueFieldsInDictionary")){var Ha=
J.h(this.$).Wb.Mdi(Jb);if(Ha&&0<Ha.count){var mb=Array(Ha.count);sa=0;for(var qa of Ha.values)Ha={},Ha.Name=qa,mb[sa]=Ha,++sa;qa="";Ha=-1;0<Jb.top&&Qa&&(Jb=new Ea.Range(Jb.top-1,Jb.left,Jb.top-1,Jb.left,!1,!1),null!=J.h(this.$).tc(Jb)&&null!=J.h(this.$).tc(Jb).originalText&&(qa=J.h(this.$).tc(Jb).originalText),Ha=Jb.left-Db);sa={};sa.ColumnName=qa;sa.ColumnIndex=Ha;sa.FieldInfoDataList=mb}}else if((qa=J.h(this.$).Wb.Zdf(Jb))&&0<qa.count){mb=Array(qa.count);sa=0;for(Ha of qa)qa={},qa.Name=Ha,mb[sa]=
qa,++sa;qa="";Ha=-1;0<Jb.top&&Qa&&(Jb=new Ea.Range(Jb.top-1,Jb.left,Jb.top-1,Jb.left,!1,!1),qa=J.h(this.$).tc(Jb).originalText,Ha=Jb.left-Db);sa={};sa.ColumnName=qa;sa.ColumnIndex=Ha;sa.FieldInfoDataList=mb}return sa}static Sub(Jb){Jb&&Z.AFrameworkApplication.qe.lw(Jb.yv)}}Object(e.a)(Fa,"FieldInfoManager",O.a,[436,2]);class Ba extends Fa{constructor(Jb,Qa,Db,sa){super(Jb,Qa);this.U5a=null;this.NLf=()=>{this.$zc(this.NLf);if(this.Pl&&this.Pl.length&&this.contextMenuManager){var Ha=this.contextMenuManager.$ld("autoFilterRichFieldList"),
mb=window.document.getElementById(this.U5a);Ha.a3(null,mb,this,null,!0)}};this.PDg=Db;this.contextMenuManager=sa}get AI(){return this.PDg}h6h(Jb,Qa){this.U5a=Qa;h.ULS.sendTraceTag(537153825,0,100,`FilterInfoManager.GetFilterFieldInfoListContextAsync - Retrieving the list of field list context for row, col, row, col (${Jb.FirstRow}, ${Jb.FirstColumn}, ${Jb.LastRow}, ${Jb.LastColumn})`);this.Stg(Jb,null,!0,!1,!0)}}Object(e.a)(Ba,"FilterInfoManager",Fa,[437,436,2]);var fa=a(878),ta=a(1113),Oa=a(32),
Ma=a(92),fb=a(9);class pa{}pa.jKh="ewa-sharedUi-launchButton";pa.mKh="ewa-sharedUi-launchButtonWithText";pa.kKh="ewa-sharedUi-launchButtonClick";pa.nKh="ewa-sharedUi-launchButtonWithTextClick";pa.lKh="ewa-sharedUi-launchButtonText";Object(e.a)(pa,"CssClassNames",null,[]);var Ua=a(74);a(527);var Sa=a(250),Ia=a(232);O=a(249);var X=a(297),ca=a(76),U=a(12),ma=a(264),ra=a(37);class Va extends O.a{constructor(Jb,Qa,Db,sa,Ha,mb,qa,Xa,Ca){super(document.createElement("div"));this.Mxf=null;this.g1d=!1;this.Bc=
this.JTb=this.lWa=null;this.hP=()=>{this.raiseEvent("OnObjectButtonMouseOver")};this.gP=()=>{this.raiseEvent("OnObjectButtonMouseOut")};this.h_j=()=>{this.bve()};this.Ud=va=>{this.raiseEvent(this.DMb,va);this.pTa();return!0};this.q4i=va=>{100<z.a(t.a.Lb,this.Mxf)&&this.jrd(new Sys.UI.Point(Math.round(va.clientX),Math.round(va.clientY)))};this.dP=va=>{ca.g(va.Da,!1);return!1};this.Z_=this.kf.qLa();this.set_visible(!1);this.hpc=Ha;this.DMb=mb;this.ytc=Jb;this.d9b=Qa;this.Bc=Ca;this.hpc&&(this.lWa=v.a.instance.create(this.h_j,
3E4,"OnObjectButton.ShyTimerFired",!1,!1));Jb&&this.domElement.classList.add(Jb);this.vub=document.createElement("div");this.domElement.appendChild(this.vub);Db&&this.vub.classList.add(Db);this.O6d(sa);qa&&(this.JTb=document.createElement("div"),this.domElement.appendChild(this.JTb),this.JTb.classList.add(Xa),this.JTb.innerText=qa,this.domElement.style.padding="3px",Sa.a.instance.ta(L.a.pointerDown,this.domElement,this.dP));this.Z2a=new X.a(this.domElement,7);Ia.a.instance.ta(L.a.click,this.domElement,
this.Ud);w.EwaSettings.isChangeGateEnabled("OfficeVSO:4996434_AvoidSelectionFromClickInOOUIPadding")&&Sa.a.instance.ta(L.a.pointerDown,this.domElement,this.dP);Jb=va=>{ca.g(va)};this.Dd.la("mouseup",Jb);this.Dd.la("click",Jb);this.Dd.la("dblclick",Jb)}d_(Jb){this.addHandler(this.DMb,Jb)}P9(Jb){this.get_events().removeHandler(this.DMb,Jb)}jYg(Jb){this.addHandler("OnObjectButtonMouseOver",Jb)}lzj(Jb){this.get_events().removeHandler("OnObjectButtonMouseOver",Jb)}iYg(Jb){this.addHandler("OnObjectButtonMouseOut",
Jb)}kzj(Jb){this.get_events().removeHandler("OnObjectButtonMouseOut",Jb)}O6d(Jb){Jb&&this.Bc.Yh(this.vub,Jb)}Idk(Jb,Qa,Db){this.Bc.ZD(this.vub);Jb?Jb.dea(Qa,16,16,this.vub,16,16,void 0,Db):h.ULS.sendTraceTag(537153824,0,10,"OnObjectButton.UpdateButtonSvgImage: Called without svgIconProvider")}Jdk(Jb,Qa){Jb&&(this.JTb.innerText=Jb);this.domElement.title=Qa}dispose(){this.get_isInitialized()&&(this.hide(),this.Dd.oE(),Ma.a.ed([this.Z_,this.Z2a]),Ia.a.instance.Aa(L.a.click,this.domElement,this.Ud),Sa.a.instance.Aa(L.a.pointerDown,
this.domElement,this.dP),this.lWa&&this.lWa.dispose(),super.dispose())}tgb(){this.d9b&&this.domElement.classList.remove(this.d9b);this.ytc&&this.domElement.classList.add(this.ytc)}pTa(){this.ytc&&this.domElement.classList.remove(this.ytc);this.d9b&&this.domElement.classList.add(this.d9b);this.h6a()}h6a(){this.hpc&&(this.lWa.cancel(),this.Qlg(),this.setOpacity(1));this.set_visible(!0)}rm(Jb,Qa,Db,sa,Ha=!1){Jb=ra.a(sa).Bi(Jb);Qa=ra.a(sa).Bi(Qa);ra.a(sa).UDc(this.domElement);this.domElement.style.top=
U.HelperMethods.ud(Qa);this.domElement.style.left=this.domElement.style.right="";Qa=Jb;Ha&&(Qa=Jb-this.domElement.offsetWidth);ma.c(this.domElement.style,Db,U.HelperMethods.ud(Qa));this.set_visible(!0);this.setOpacity(1);this.hpc&&(this.g1d=!1,this.$1j(),this.lWa.ir())}hide(){this.tgb();this.set_visible(!1);this.hpc&&(this.Qlg(),this.lWa.cancel())}ldc(){this.Dd.la("mouseover",this.hP,!0);this.Dd.la("mouseout",this.gP,!0)}$1j(){this.Z_.Ij("mousemove")||this.Z_.la("mousemove",this.q4i)}Qlg(){this.Z_.Ij("mousemove")&&
this.Z_.detach("mousemove")}jrd(Jb){if(this.domElement.parentNode){var Qa=Sys.UI.DomElement.getBounds(this.domElement);const Db=new Sys.UI.Point(Math.round(Qa.x+Qa.width),Math.round(Qa.y+Qa.height));Qa=Math.abs(Db.x-Jb.x);Jb=Math.abs(Db.y-Jb.y);Jb=Qa>Jb?Qa:Jb;this.g1d?this.setOpacity(Va.hah(Jb)):100>=Jb&&this.bve()}}bve(){this.g1d=!0;this.lWa.cancel()}setOpacity(Jb){H.a.setOpacity(this.domElement,Jb);this.Mxf=t.a.Lb.Mc}static hah(Jb){return 100>=Jb?1:250<=Jb?0:.01*(100-(Jb-100)/150*100)}}Object(e.a)(Va,
"OnObjectButton",O.a,[560,113,2]);var ob=a(802);const ja=pa.lKh;class lb extends k.a{constructor(Jb,Qa,Db,sa,Ha,mb,qa,Xa,Ca=""){super();this.lza=null;this.mlf=!1;this.Bc=this.Wsc=this.Xsc=null;this.buttons={};this.KYe={};this.$=Jb;this.svgIconProvider=Qa;this.I2i=Db;this.Dtd=sa;this.Ctd=Ha;this.altText=mb;this.DMb=qa;this.Bc=Xa;this.buttonText=Ca}get Qs(){return ra.a(this.$).xJa(fb.a.q$i)}get avb(){return fb.a.p$i}get buttonWidth(){return ra.a(this.$).xJa(fb.a.r$i)}dispose(){this.kzh();this.$=null;
super.dispose()}getButton(Jb,Qa=!0){return this.Vxa(Jb,Qa)}Vxa(Jb,Qa=!0){const Db=Jb.toString();Db in this.buttons||this.kph(Jb,Qa);return this.buttons[Db]}rm(Jb,Qa,Db,sa,Ha=!0,mb=!1){this.hide();if(this.$.ea.isNamedObjectViewMode&&Ua.i(this.$.na)){var qa=J.h(this.$).BT.domElement;const Xa=Jb+this.buttonWidth-qa.scrollWidth;qa=Qa+this.buttonWidth-qa.scrollHeight;Jb=0<Xa?Jb-Xa:Jb;Qa=0<qa?Qa-qa:Qa}this.Vxa(sa,Ha).rm(Jb,Qa,Db,this.$,mb)}hide(){const Jb=this.buttons;for(let Qa in Jb)Jb[Qa].hide()}ldc(Jb,
Qa){!this.mlf&&(Qa=this.buttons[Qa.toString()])&&(this.Xsc=(Db,sa)=>{Jb(sa,!0)},Qa.jYg(this.Xsc),this.Wsc=(Db,sa)=>{Jb(sa,!1)},Qa.iYg(this.Wsc),this.mlf=!0,Qa.ldc())}kph(Jb,Qa){this.lza=String.format(this.Dtd===B.a.$dc?'<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>':'<img class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1"/>',Oa.a.xi(this.Dtd),Oa.a.xi(this.Ctd),"{0}");var Db=String.format(this.lza,Oa.a.xi(this.altText));Qa=new Va(""===this.buttonText?
pa.jKh:pa.mKh,""===this.buttonText?pa.kKh:pa.nKh,B.a.aE,Db,Qa,this.DMb,this.buttonText,ja,this.Bc);Db=(sa,Ha)=>{this.I2i(Ha,Jb)};Qa.d_(Db);this.buttons[Jb.toString()]=Qa;this.KYe[Jb.toString()]=Db;Db=J.h(this.$).sg(Jb);Db.domElement.insertBefore(Qa.domElement,Db.domElement.firstChild)}kzh(){for(const Jb of ob.a(this.buttons)){const Qa=this.buttons[Jb];Qa.P9(this.KYe[Jb]);Ma.a.Ka(Qa);delete this.buttons[Jb];this.Xsc&&Qa.lzj(this.Xsc);this.Wsc&&Qa.kzj(this.Wsc)}}domElement(Jb){return this.Vxa(Jb).domElement}h6a(Jb){this.Vxa(Jb).h6a()}$Ub(Jb,
Qa,Db=!0){this.lza=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',Oa.a.xi(this.Dtd),Oa.a.xi(this.Ctd),"{0}");Jb=String.format(this.lza,Oa.a.xi(Jb));this.Vxa(Qa,Db).O6d(Jb)}KXa(Jb,Qa,Db){this.Vxa(Db,!1).Jdk(Jb,Qa)}Ptg(){this.lza=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',"{0}",Oa.a.xi(this.Ctd),"{1}");const Jb=String.format(this.lza,void 0,Oa.a.xi(void 0));this.Vxa(void 0,
!1).O6d(Jb)}PJc(Jb,Qa,Db){this.Vxa(Db,!1).Idk(this.svgIconProvider,Jb,Qa)}}Object(e.a)(lb,"OnObjectLaunchButton",k.a,[533,2]);k=a(101);class wb extends k.a{constructor(Jb,Qa){super(Jb);this.fIb=null;this.Vyh=()=>{this.display()};this.lsi=Math.max(1,Qa)}dispose(){Ma.a.Ka(this.fIb);this.fIb=null;super.dispose()}BWa(){Ma.a.Ka(this.fIb);this.fIb=v.a.instance.create(this.Vyh,this.lsi,x.a.$Oi)}HWa(){Ma.a.Ka(this.fIb);this.hide()}}Object(e.a)(wb,"LoadingIndicatorBehavior",k.a,[559,2]);class Ab extends wb{constructor(Jb,
Qa,Db,sa){super(Jb,Qa);this.eIb=null;this.kGg=Db;this.upi=sa;this.STg()}dispose(){this.eIb=null;super.dispose()}display(){this.kGg(this.eIb)}hide(){this.upi(this.eIb)}STg(){this.eIb=document.createElement("div");this.domElement.appendChild(this.eIb)}}Object(e.a)(Ab,"ShimmerLoadingIndicatorBehavior",wb,[]);var nb=a(78),pb=a(54),cb=a(13);class Da extends wb{constructor(Jb,Qa,Db,sa=null,Ha=null,mb=0){super(Jb,Qa);this.i9a=this.pRa=null;this.i9a=Db;this.jlc=sa||pb.a.current.Uo(105);this.Izf=mb;this.qcd=
Ha;this.RTg()}dispose(){this.pRa=null;super.dispose()}display(){cb.DOMElementExtensions.setVisible(this.pRa,!0)}hide(){cb.DOMElementExtensions.setVisible(this.pRa,!1)}RTg(){this.pRa=document.createElement("div");this.pRa.classList.add(nb.a.TIh);const Jb=document.createElement("div");Jb.classList.add(nb.a.UIh);this.qcd&&""!=this.qcd&&Jb.classList.add(this.qcd);const Qa=0===this.Izf?"":S.a.instance.ha(this.Izf),Db=String.format('<div class="'+nb.a.VIh+'">{0}</div>',Qa);this.jlc?this.i9a.Yh(Jb,`<img src="${this.jlc}" alt="${Qa}" title="${Qa}"/>`+
Db):this.i9a.Yh(Jb,Db);this.pRa.appendChild(Jb);this.domElement.appendChild(this.pRa)}}Object(e.a)(Da,"SpinnerLoadingIndicatorBehavior",wb,[]);var zb=a(149),qb=a(35);Object(zb.b)(qb.tb)(Jb=>Object(d.a)(void 0,void 0,void 0,function*(){const Qa=yield zb.a.resolve(qb.W,{Wa:Jb.Wa});return new Pa(Qa)}));class Pa{constructor(Jb){this.i9a=Jb}sbd(Jb,Qa,Db){return new fa.a(Jb,Qa,Db)}eac(Jb,Qa,Db,sa,Ha,mb,qa,Xa,Ca,va){return new ta.a(Jb,Qa,Db,sa,Ha,mb,qa,Xa,Ca,va)}Owb(Jb,Qa,Db,sa,Ha=0){return new Da(Jb,Qa,
this.i9a,Db,sa,Ha)}wod(Jb){return Jb.da.Ba(238)||new R(Jb)}K4a(Jb,Qa,Db,sa,Ha,mb,qa,Xa=""){return new lb(Jb,Qa,Db,sa,Ha,mb,qa,this.i9a,Xa)}Vad(Jb,Qa){return new Fa(Jb,Qa)}foh(Jb,Qa,Db,sa){return new Ba(Jb,Qa,Db,sa)}vOe(Jb,Qa,Db,sa){return new D(Jb,Qa,Db,sa)}}Object(e.a)(Pa,"SharedUIControlsFactory",null,[501]);var Nb=a(100);class Tb extends f.a{constructor(Jb){super();this.$=Jb;this.uc()}create(){const Jb=Object(Nb.d)(zb.a.resolve(qb.W,{Wa:this.La}));u.TaskExtensions.za(Jb,()=>{this.$b(this.$.da.Ba(12)||
new Pa(Jb.result))},this.ka,3)}static la(Jb){Jb.da.Ja(477,new Tb(Jb))}}Object(e.a)(Tb,"SharedUIControlsFactoryServiceFactory",f.a,[]);a.d(C,"a",function(){return Vb});const Vb=()=>{c.a.Fa(Jb=>{Object(b.b)("OfficeVSO:7629428_MigrateSharedUIControlsFactoryService")||Tb.la(Jb)})};String(r);window.___1684780592868_closurehack=r},1223:function(r,C,a){r=a(0);var c=a(6),b=a(230),e=a(15),f=a(88),d=a(57),h=a(196);class l{constructor(){this.dre=this.XYc=!1;const ra=c.AFrameworkApplication.accessTokenTtl;0>=
ra||(this.accessTokenTtl=ra,e.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.accessTokenTtl,["NowGetTime"]:(new Date).getTime(),["BootTime"]:c.AFrameworkApplication.Yja}),h.a.instance.f3c(Object(f.a)(this,this.GSa,"onSessionExpiredDetected")),h.a.instance.d3c(Object(f.a)(this,this.ARf,"onSessionExpiringDetected")))}GSa(){h.a.instance.WSd(Object(f.a)(this,this.GSa,"onSessionExpiredDetected"));e.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");
this.bni()}ARf(){h.a.instance.VSd(Object(f.a)(this,this.ARf,"onSessionExpiringDetected"));this.dre||this.XYc||(e.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.dre=!0,this.AZj())}bni(){this.XYc||(c.AFrameworkApplication.aw(d.a.fDc),this.XYc=!0,this.zZj())}}Object(r.a)(l,"ASessionExpirationManager",null,[]);var k=a(92),u=a(42),v=a(34),x=a(16),w=a(50),m=a(263),t=a(8),z=a(87),y=a(266),D=a(77);class H extends l{constructor(ra){super();this.Ta=new u.a;this.vG=
this.Tqb=!1;this.$=ra}Uye(ra){this.Ta.addHandler("SessionExpired",ra)}psb(ra){this.Ta.addHandler("TokenRefreshed",ra)}lAc(ra){this.Ta.removeHandler("TokenRefreshed",ra)}get accessTokenExpiringMessage(){const ra=(new Date(this.accessTokenTtl)).format(this.$.xa.ShortTimeFormat);return String.format(x.a.instance.Xb(78),ra)}get tokenExpired(){return this.Tqb}get Xhb(){return!1}get yea(){return!1}get WQd(){return!1}get l8(){return!1}hkc(){return h.a.instance.KS(c.AFrameworkApplication.accessTokenTtl)}dispose(){k.a.Ka(this.Ta);
this.$=null}AZj(){this.$.isEditMode&&this.Ajc(!1)}zZj(){this.Tqb=!0;this.Ajc(!0);this.Ta.raiseEvent("SessionExpired")}Ajc(ra){e.ULS.sendTraceTag(537170715,0,15,`EwaAccessTokenExpirationManager.HandleAccessTokenExpirationDialog: isExpired ${ra}, GotDeploymentOrTimedOutError ${this.$.ea.K0}`);const Va=this.$.Zb.iq;ra&&Va&&Va.isVisible&&1299163859===Va.error.MessageId&&this.$.Zb.iq.Ew();const ob=this.Wd(ra);w.a(this.$).Ys(new m.a(t.a.Qx,5,()=>{const ja=D.a(this.$),lb=ja.$d.activityState;lb[z.a.T4]=this.$.lub(this.$.isEditMode);
lb[z.a.AN]=z.a.xcb;lb[y.a.Fq]=t.a.accessTokenExpiringWarning;ja.$d.xs([ob])}))}Wd(ra){return ra?v.a.FQe():this.Qrh()}Qrh(){const ra=v.a.Wd(12,1,0,0,0,1299163859,"AccessTokenExpiringWarning");ra.Description=this.accessTokenExpiringMessage;return ra}}Object(r.a)(H,"EwaAccessTokenExpirationManager",l,[426,172,2]);var F=a(2),G=a(173),L=a(64),M=a(663),O=a(33);class B{constructor(ra,Va){this.ONb=!1;this.correlationID=ra;this.Zbd=Va;this.kIc=!1;this.creationTime=O.a.Lb.Mc}}Object(r.a)(B,"RefreshAccessTokenContext",
null,[]);var E=a(62),I=a(59),S=a(174),J=a(48),K=a(116),R=a(130),Z=a(1),P=a(23),V=a(157),Ea=a(39),oa=a(125);class ea{}Object(r.a)(ea,"Error",null,[]);class aa{}Object(r.a)(aa,"NamedResult",null,[]);class ia extends aa{}Object(r.a)(ia,"ErrorInfo",aa,[]);class ya{constructor(ra,Va){this.G2b=ra;this.ZH=Va}get tokens(){return this.G2b}get errors(){return this.ZH}}Object(r.a)(ya,"TokenRefreshArgs",null,[424]);class za{constructor(ra,Va){this.documentVisibilityObserver=null;this.Ta=new u.a;this.Vy=null;
this.Lib=this.Rpb=!1;this.ezc=null;this.XNb=!1;this.RDd=!0;this.kke=this.Ije=this.vG=this.Tqb=!1;this.rU=null;this.oif=()=>{if(this.$.ea.Oc)this.Lif(!1);else if(this.RDd){this.RDd=!1;const ob=D.a(this.$);e.ULS.sendTraceTag(537170709,0,50,`EwaAccessTokenExpirationRefreshManager.HandleOnTokenExpiring - session is not active - postponing refresh current-activity [${ob.Pi?ob.Pi.activityName:"None"}] TimeUntilTokenExpirationInMin [${this.Qog()}]`)}};this.Md=(ob,ja)=>{this.context&&(ob=this.$.ea,ja.QG&&
this.context.ONb&&!this.context.kIc?(this.context.kIc=!0,ja={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - reconnect"},ja.IsUserActive=ob.Kf.cr,ja.RefreshAccessTokenCorrelationID=this.context.correlationID,ja=E.a.nd(ja),e.ULS.sendTraceTag(537170708,0,50,ja)):!this.Rpb||ob.Oc||this.context.Zbd||(ja={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - consider abort ongoing refresh due to reopen"},this.Vy&&(this.Vy.cancel(),ja.Aborted=!0,ja.ResetStopRefreshRetriesUntilTokenExpired=
!0,this.Lib=!1),ja.TimeUntilTokenExpirationInMin=this.Qog(),ja.RefreshAccessTokenCorrelationID=this.context.correlationID,ja=E.a.nd(ja),e.ULS.sendTraceTag(572019856,0,50,ja)))};this.NBa=()=>{if(this.context&&this.context.ONb&&!this.context.kIc){var ob={Name:"EwaAccessTokenExpirationRefreshManager.OnOpenWorkbookFailed"};ob.CreatedForExpired=this.context.Zbd;ob.RefreshAccessTokenCorrelationID=this.context.correlationID;ob.OpenWorkbookErrors=v.a.Uc(this.$.ea.jH);ob.ExecutionContextErrors=v.a.Uc(D.a(this.$).$d.errors);
ob.accesstokenTTL=c.AFrameworkApplication.accessTokenTtl;ob=E.a.nd(ob);e.ULS.sendTraceTag(537170707,0,15,ob)}};this.Kif=()=>{this.Lib=!1;this.Lif(!0)};this.iLd=()=>{this.XNb&&(this.$.ea.Kf.WCa(this.iLd),this.XNb=!1);this.plg()};this.$=ra;this.N4d=Va;this.UQd=ra.yc.vh("WebServiceCall","refreshToken");h.a.instance.f3c(this.Kif);h.a.instance.d3c(this.oif);Va=this.$.ea;Va.Mk(this.Md);Va.L4b(this.NBa);this.xWi=this.$.xa.MinTokenLifetimeForRegularExpirationPromptInMin;this.wgg=this.$.xa.ShortAccessTokenExpirationPromptSeconds;
this.T1f=this.$.xa.RefreshAccessTokenDurationLimitInSec;this.Xug(ra.ea.MUf,c.AFrameworkApplication.accessTokenTtl);ra=JSON.stringify({["AccessTokenTtl"]:c.AFrameworkApplication.accessTokenTtl,["NowGetTime"]:(new Date).getTime(),["BootTime"]:c.AFrameworkApplication.Yja,["WopiTokenExpiresAfterMinutes"]:c.AFrameworkApplication.D9d,["WopiTokenTaskItemPriority"]:c.AFrameworkApplication.F9d});e.ULS.sendTraceTag(537170714,217,50,`Initializing EwaAccessTokenExpirationRefreshManager. ${ra}`);this.$.da.Qb(291,
ob=>{this.documentVisibilityObserver=ob})}Uye(ra){this.Ta.addHandler("SessionExpired",ra)}psb(ra){this.Ta.addHandler("TokenRefreshed",ra)}lAc(ra){this.Ta.removeHandler("TokenRefreshed",ra)}get tokenExpired(){return this.Tqb}get yea(){return this.Ije}get l8(){return this.kke}get context(){return this.rU}get Xhb(){return this.l8?!1:this.$.ea.Kf.cr?1>oa.a.J8:6>oa.a.K8}get WQd(){return this.Rpb}hkc(){return h.a.instance.KS(c.AFrameworkApplication.accessTokenTtl)}dispose(){h.a.instance.WSd(this.Kif);h.a.instance.VSd(this.oif);
const ra=this.$.ea;ra&&(ra.Vk(this.Md),ra.nAc(this.NBa));k.a.Ka(this.Ta);this.documentVisibilityObserver=this.$=null}Qog(){return this.hkc()?0:(c.AFrameworkApplication.accessTokenTtl-(new Date).getTime())/6E4}Xug(ra,Va){if(0<Va&&!this.hkc()){const ob=c.AFrameworkApplication.fa.Ae("AccessTokenExpirationPromptSeconds",c.AFrameworkApplication.WZ),ja=(Va-ra.getTime())/6E4;e.ULS.shipAssertTag(537170713,0,0<=ja,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime the access-token expiration time should be after token creation time accessTokenTTL [${Va}] creationTime [${ra.getTime()}] tokenLifetimeInMin [${ja}]`);
ja<this.xWi?(e.ULS.sendTraceTag(537170712,0,15,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [${this.wgg}] tokenLifetimeInMin [${ja}]`),c.AFrameworkApplication.WZ=this.wgg):c.AFrameworkApplication.WZ!==ob&&(e.ULS.sendTraceTag(537170711,0,15,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [${ob}] tokenLifetimeInMin [${ja}]`),c.AFrameworkApplication.WZ=ob)}}imh(ra){return!this.context||
this.context.ONb||this.context.Zbd!==ra?(ra=new B(G.a.create().toString(),ra),this.context&&!this.context.kIc&&e.ULS.sendTraceTag(537170710,0,15,`TokenManager.InitContext: creating new context [${ra.correlationID}] although previeous one [${this.context.correlationID}] not used successfully, isPreviousOneRefreshedSuccessfully [${this.context.ONb}] `),this.rU=ra,!0):!1}jDj(ra){ra&&this.vG&&!this.yea&&this.$.ea.Kf.cr&&!this.l8&&(this.vG=!1)}Lif(ra){this.jDj(ra);if(!(this.Rpb||this.Lib&&!ra||this.vG)&&
this.Xhb){this.Rpb=!0;var Va=this.context?this.context.creationTime:null,ob=this.imh(ra);this.RDd=!0;var ja=this.$.ea,lb={Name:"EwaAccessTokenExpirationRefreshManager.HandleTokenRefresh"};lb.newContextCreated=ob;lb.IsUserActive=ja.Kf.cr;lb.IsSessionActive=ja.Oc;lb.ContainsChangesWorkbookOperations=this.$.userOperationManager.eLa();lb.isSessionExpired=ra;lb.stopRefreshRetriesUntilTokenExpired=this.Lib;lb.FailedToRefreshExpiredToken=this.vG;lb.numOfFailuresWhileUserIsActive=oa.a.J8;lb.numOfFailuresWhileUserIsInActive=
oa.a.K8;lb.numOfFailuresWhileOffline=oa.a.rBa;lb.RefreshAccessTokenCorrelationID=this.context.correlationID;ob&&Va&&(lb.TimeInMinFromPreviosContextCreation=Math.round(R.b(O.a.Lb,Va)/60));Va=E.a.nd(lb);e.ULS.sendTraceTag(40416199,0,50,Va);this.UQd.start();this.Ije=ja.Kf.cr;this.Vy=new M.a;this.ONi(ra);var wb=this.N4d.vtj(!ra,this.Vy?this.Vy.token:null);wb.continueWith(()=>{this.Heh();const Ab=this.N4d.rnj(wb);this.UQd.stop();const nb=this.hkc();if(!Ab||Z.EwaSettings.isChangeGateEnabled("OfficeVSO:5348973_FishbowlFixDuringTokenRefresh")&&
nb){const pb=wb.result.errors;Ab&&nb&&this.pTg(pb);this.Jmi(pb,ra)}else this.Lib=!1,this.Lmi(wb.result.tokens,ra);this.Rpb=!1},8)}}pTg(ra){const Va=[Object(F.a)(new ea,{Id:"200",Details:"Expired accesstoken recieved on successful token request."})];ra.add(Object(F.a)(new ia,{Name:"ExpiredTokenAfterSuccessfulRefresh",Errors:Va}))}ONi(ra){ra&&(this.$.ea.Kf.cr?this.plg():(this.$.ea.Kf.Aja(this.iLd),this.XNb=!0))}plg(){this.ezc=S.AsyncMethodContext.Fr(()=>{this.utj()},1E3*this.T1f,J.a.ctj,this.ezc)}Heh(){this.ezc&&
this.ezc.cancel();this.XNb&&(this.$.ea.Kf.WCa(this.iLd),this.XNb=!1);this.Vy=null}utj(){e.ULS.sendTraceTag(537170706,0,15,`EwaAccessTokenExpirationRefreshManager.RefreshTokenDurationThresholdReached durationLimitInSec [${this.T1f}]`);this.Vy.cancel()}Jmi(ra,Va){this.Lib=!0;Va&&(this.vG||(this.Tqb=this.vG=!0),this.N4d.XFb(ra)&&(this.kke=!0));const ob=!Va||this.Xhb&&!oa.a.SEc?40380379:39982555;Va=this.fPe(Va);Va.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshError";Va.FailedToRefreshExpiredToken=
this.vG;Va.LastErrorIsPermanent=this.l8;if(0<ra.count){var ja=ra.ma(0);Va.errorName=ja.Name;0<ja.Errors.length&&(Va.ErrorId=ja.Errors[0].Id,ja=ja.Errors[0].Details,Va.ErrorDetails=this.oAh(ja.toString())?"PiiScrubbed":ja)}Va=E.a.nd(Va);e.ULS.sendTraceTag(ob,0,15,Va);this.Ta.raiseEvent("TokenRefreshed",new ya(null,ra))}oAh(ra){return P.a.contains(ra,"makes the internet safe for businesses",!0)}fPe(ra){const Va={},ob=this.$.ea;Va.Name="";Va.IsUserActive=ob.Kf.cr;Va.IsSessionActive=ob.Oc;Va.GotDeploymentOrTimedOutError=
ob.K0;Va.TimeInSecFromLastStatefulSuccessfulRequest=ob.SY;Va.TimeFromLastUserActivityInMs=ob.Kf.jjb;Va.calledFromSessionExpiredFlow=ra;Va.RefreshTokenDurationInMS=this.UQd.vd;Va.numOfFailuresWhileUserIsActive=oa.a.J8;Va.numOfFailuresWhileUserIsInActive=oa.a.K8;Va.numOfFailuresWhileOffline=oa.a.rBa;Va.RefreshAccessTokenCorrelationID=this.context.correlationID;Va.accessTokenTTL=c.AFrameworkApplication.accessTokenTtl;Va.ContainsChangesWorkbookOperations=this.$.userOperationManager.eLa();Va.IsDocumentHidden=
this.documentVisibilityObserver?this.documentVisibilityObserver.Ei.toString():"Unknown";Va.TimeFromFirstOpenInHr=Math.floor(R.b(O.a.Lb,K.toUtc(ob.MUf))/3600);return Va}Lmi(ra,Va){this.vG=!1;this.mhk();this.Xug(new Date,c.AFrameworkApplication.accessTokenTtl);const ob=this.$.ea,ja=!Va&&ob.Kf.cr,lb=!this.$.isEditMode&&ob.wfb;Va=this.fPe(Va);Va.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess";Va.shouldTriggerSilentReloadAfterExpiring=ja;Va.WopiTokenTaskItemPriority=c.AFrameworkApplication.F9d;
Va.isDirtyViewSession=lb;Va=E.a.nd(Va);e.ULS.sendTraceTag(39982556,0,15,Va);this.Ta.raiseEvent("TokenRefreshed",new ya(ra,null));lb?ob.Kf.cr&&(e.ULS.sendTraceTag(537170705,0,15,"EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess: User active after refresh dirty view session. trigger request to connect the same server."),ob.fkd()):ob.Kf.cr?ja&&(ra=D.a(this.$).$d.activityState,ra[oa.a.Hjb]=!0,ra[V.a.$Z]=!0,ra[Ea.a.qt]=this.$.isEditMode,w.a(this.$).Ys(new m.a(t.a.rqa,2,null))):ob.Oc&&I.j(this.$.qa.va,
!0,!1,!1,null,null,null,null,null)}mhk(){void 0!==this.$.ea.workbookContext.WorkbookUri&&null!==this.$.ea.workbookContext.WorkbookUri?(this.$.ea.workbookContext.WorkbookUri=L.a.cV(this.$.ea.workbookContext.WorkbookUri,c.AFrameworkApplication.sI,c.AFrameworkApplication.accessToken),this.$.ea.workbookContext.WorkbookUri=L.a.cV(this.$.ea.workbookContext.WorkbookUri,c.AFrameworkApplication.QK,c.AFrameworkApplication.accessTokenTtl.toString()),this.$.ea.lwc()):e.ULS.sendTraceTag(537170704,0,15,"EwaAccessTokenExpirationRefreshManager.UpdateTokensAtContext: WorkbookUri is null");
this.$.xa.AccessToken=c.AFrameworkApplication.accessToken;this.$.xa.AccessTokenValidTo=c.AFrameworkApplication.accessTokenTtl;void 0!==this.$.xa.DocumentHostInfo.QuerySignatureWithoutVersion&&null!==this.$.xa.DocumentHostInfo.QuerySignatureWithoutVersion&&(this.$.xa.DocumentHostInfo.QuerySignatureWithoutVersion=L.a.cV(this.$.xa.DocumentHostInfo.QuerySignatureWithoutVersion,c.AFrameworkApplication.sI,c.AFrameworkApplication.accessToken),this.$.xa.DocumentHostInfo.QuerySignatureWithoutVersion=L.a.cV(this.$.xa.DocumentHostInfo.QuerySignatureWithoutVersion,
c.AFrameworkApplication.QK,c.AFrameworkApplication.accessTokenTtl.toString()));void 0!==this.$.xa.EmbedConfiguratorUrl&&null!==this.$.xa.EmbedConfiguratorUrl&&(this.$.xa.EmbedConfiguratorUrl=L.a.cV(this.$.xa.EmbedConfiguratorUrl,c.AFrameworkApplication.sI,c.AFrameworkApplication.accessToken),this.$.xa.EmbedConfiguratorUrl=L.a.cV(this.$.xa.EmbedConfiguratorUrl,c.AFrameworkApplication.QK,c.AFrameworkApplication.accessTokenTtl.toString()));this.context.ONb=!0}}Object(r.a)(za,"EwaAccessTokenExpirationRefreshManager",
null,[426,172,2]);var la=a(198),xa=a(172),wa=a(126),hb=a(425);class Ja{}Ja.J3b="ActivityDuration";Ja.error="Error";Ja.ogd="Errors";Ja.failed="Failed";Ja.gUh="FirstActivity";Ja.initialized="Initialized";Ja.XLi="LastActivity";Ja.P8f="RetryOverride";Ja.GCj="RequestGroups";Ja.requests="Requests";Ja.t8f="Responses";Ja.gDc="SessionDuration";Ja.status="Status";Ja.success="Success";Ja.successful="Successful";Ja.tokens="Tokens";Object(r.a)(Ja,"SessionExpirationStrings",null,[]);var Fa=a(112);class Ba{constructor(ra){this.Yp=
{};this.jZ={};this.tMg={};this.yAf=15;this.Dje=!1;this.aOg=new Date;this.b_b=new Date;this.Me=ra;this.u2b=new Fa.a(2,2,6E4*this.yAf,Object(f.a)(this,this.ayg,"writeMeasures"),135,"SL",!1);this.Me.wg(this.u2b);this.Vui()}ayg(){e.ULS.sendTraceTag(41964821,217,50,e.ULS.nd({["Aggregate"]:this.jZ,["Current"]:this.Yp}))}Vui(){this.jZ[Ja.GCj]=0;this.jZ[Ja.requests]=0;this.jZ[Ja.t8f]=0;this.jZ[Ja.status]=Ja.initialized;this.jZ[Ja.gUh]=new Date;this.jZ[Ja.gDc]=0;this.jZ[Ja.J3b]=0;this.jZ[Ja.gDc]=0;this.Yp[Ja.gDc]=
0;this.jZ[Ja.J3b]=0;this.Yp[Ja.J3b]=0}Ttd(ra,Va){var ob=ra[Va];ob=ob?ob:0;ob++;ra[Va]=ob;this.oYd(ra)}oYd(ra){const Va=new Date;ra[Ja.J3b]=+Va-+this.b_b;this.b_b=Va;ra[Ja.gDc]=+this.b_b-+this.aOg;ra[Ja.XLi]=this.b_b}V2(ra,Va){this.Yp[ra]=Va;this.oYd(this.Yp)}PXd(ra,Va){this.Yp[ra]=Va;this.oYd(this.Yp)}incrementCounter(ra){this.Ttd(this.Yp,ra);this.Ttd(this.jZ,ra);this.Ttd(this.tMg,ra)}flush(){this.Dje||(this.jZ[Ja.status]=this.Yp[Ja.status],this.ayg(this.u2b),this.Me.Xpa(this.u2b,6E4*this.yAf))}stop(){e.ULS.sendTraceTag(41964822,
217,100,"Stopping logger. Flushing one last time");this.flush();this.Dje=!0;this.Me.jq(this.u2b)}}Object(r.a)(Ba,"SessionLogger",null,[450]);var fa=a(103),ta=a(664),Oa=a(586),Ma=a(384),fb=a(179),pa=a(993),Ua=a(184),Sa=a(144);class Ia{constructor(ra,Va,ob,ja=null,lb=!1,wb=null,Ab=!1,nb=!1){this.bba=0;this.J4=this.Sj=null;this.G2b=new la.a;this.ZH=new la.a;this.yl=null;this.i_a=!1;this.Vqb=this.Wqb=null;this.Me=ra;this.Doe=Va;this.Doe.execute(pb=>{pb.ql(fb.a.Wsd,Object(f.a)(this,this.U7i,"onHostResponseReceived"))});
this.nI=ob;this.fte=new pa.a("WebServiceCall","TokenRefresh");this.il=ja||new Ba(ra);this.WNg=lb;this.SU=wb?wb:ta.SessionStatusManager.instance;this.ife=Ab;this.uYb=nb}U7i(ra){if(ra.MessageId!==fb.a.Wsd)Sa.a(39408099,306,15,"Unexpected message.");else{var Va=new la.a,ob=new la.a;this.il.incrementCounter(Ja.t8f);var ja=ra.Values[Ma.a.fcg];if(!ja||0>=ja.length)Sa.a(40122317,306,15,"Found no tokens in the dictionary"),ja=ra.Values;Sa.a(40122318,306,100,"The Tokens array contains {0} tokens",ja.length);
this.il.V2("Correlation",ra.CorrelationId);var lb="";for(let nb=0;nb<ja.length;nb++){this.il.PXd(Ja.tokens,ja.length);var wb=ja[nb],Ab=wb;if(!Ab||!Ab.Name)continue;this.il.incrementCounter(Ab.Name);const pb=wb;if(pb&&pb.Value)Sa.a(39408128,306,100,"Received token with name: {0}",pb.Name),Va.add(pb),this.G2b.add(pb),this.uYb||this.il.V2(Ja.status,Ja.success),this.ife&&this.SU&&this.SU.IDj();else if(wb=this.mei(wb),Sa.a(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",
Ab.Name,JSON.stringify(wb),this.J4),ob.add(wb),this.uYb||(this.ZH.add(wb),lb=JSON.stringify(wb),this.il.V2(Ja.error,JSON.stringify(wb)),this.il.V2(Ja.status,Ja.failed)),this.ife)for(const cb of wb.Errors)Ab=this.C5h(cb),this.SU&&this.SU.HVg(Ab)}this.uYb?(0<ob.count?this.Vqb?this.Vqb(new ya(Va,ob)):Sa.a(512267295,306,15,"Received errors but the promise has completed"):this.Wqb?this.Wqb(new ya(Va,ob)):Sa.a(512267294,306,15,"Received valid tokens but the promise has completed"),Sa.a(512344162,306,50,
"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",Va.count,ob.count,ra.CorrelationId,this.J4)):(0<ob.count&&""!==lb?(ja=Object.assign(new Ua.a,{extendedProperties:new Map}),ja.extendedProperties.set("Errors",lb),ja.extendedProperties.set("RetryCount",this.bba.toString()),ja.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString()),ja.extendedProperties.set("IsTokenExpiring",this.i_a.toString()),fa.Health.instance.recordKpiFailure("WACTokenRefresh",
"TokenRefreshFailed",!1,!1,ja)):fa.Health.instance.recordKpiSuccess("WACTokenRefresh",null),Sa.a(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",Va.count,ob.count,ra.CorrelationId,this.J4),0<ob.count&&!this.XFb(ob)?(ra=this.nI.Vdf(ob),ra!==this.nI.Hgb&&(this.il.PXd(Ja.P8f,ra),this.Me.Xpa(this.Sj,ra))):(this.il.flush(),this.Sj&&(Sa.a(39408131,306,100,"Deleting task {0} from task manager",this.Sj.name),this.Me.jq(this.Sj)),this.yl&&!this.yl.task.isCompleted?
this.yl.setResult(new ya(Va,ob)):Sa.a(512267293,306,15,"Received results but the task has completed")))}}mei(ra){if(!ra)return null;const Va=Object.assign(new ia,{Name:ra.Name,Errors:[]});for(const ob of ra.Errors)ra=new ea,ra.Id=ob.Id,ra.Details=Oa.a.n8a(ob.Details,500),Va.Errors.push(ra);return Va}requestTokensOnce(){this.C7f()}C7f(){c.AFrameworkApplication.w8("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.bba>=this.nI.$Df?(Sa.a(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",
this.J4),this.jPe(this.yl,"TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts")):(fa.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.obg())}obg(){const ra={};ra[Ma.a.fcg]=this.nI.tokens;const Va=G.a.create().toString();Sa.a(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.nI.tokens),this.bba+1,Va,this.J4);this.Doe.execute(ob=>{ob.sendMessage(fb.a.jBe,ra,Va)});this.bba++;
this.il.incrementCounter(Ja.requests)}jPe(ra,Va,ob){const ja=new la.a;for(let lb=0;lb<this.nI.tokens.length;lb++){const wb=Object.assign(new ia,{Name:this.nI.tokens[lb],Errors:[Object.assign(new ea,{Id:Va,Details:ob})]});ja.add(wb);this.ZH.add(wb)}this.Me.jq(this.Sj);this.il.V2(Ja.ogd,JSON.stringify(this.ZH));this.il.V2(Ja.status,Ja.failed);ra&&!ra.task.isCompleted&&ra.setResult(new ya(new la.a,this.ZH))}vtj(ra,Va=null){this.fte.start();this.i_a=ra;this.J4=G.a.create().toString();Sa.a(41755338,306,
50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.J4,this.i_a);this.bba=0;this.ZH.clear();this.G2b.clear();const ob=new xa.a;this.yl=ob;Va&&Va.R(()=>{const ja=!!ob&&!ob.task.isCompleted;Sa.a(588096223,306,50,"RefreshTokens Cancelled, TaskId: [{0}]. IsTokenExpiring: [{1}]. isTaskStillRunning [{2}].",this.J4,this.i_a,ja);ja&&this.jPe(ob,"ABORTED_BY_CALLER","The refresh was aborted by the caller")});this.uYb?this.D7f(this.nI.$Df).then(ja=>{this.yl&&!this.yl.task.isCompleted&&this.yl.setResult(ja);
this.Vqb=this.Wqb=null;this.il.V2(Ja.ogd,JSON.stringify(this.ZH));this.il.V2(Ja.status,Ja.success);this.il.flush()}).catch(ja=>{this.yl&&!this.yl.task.isCompleted&&this.yl.setResult(Object(wa.a)(424,ja));this.Vqb=this.Wqb=null;this.il.V2(Ja.ogd,JSON.stringify(this.ZH));this.il.V2(Ja.status,Ja.failed);this.il.flush()}):(this.Sj=new Fa.a(this.nI.priority,2,this.nI.Hgb,Object(f.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,fb.a.jBe,!0),this.WNg&&this.C7f(),this.Me.wg(this.Sj));return this.yl.task}D7f(ra){const Va=
this,ob=new Promise((nb,pb)=>{Va.Wqb=nb;Va.Vqb=pb;fa.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null);Va.obg()}),ja=this,lb=new Promise((nb,pb)=>{window.setTimeout(()=>{pb(ja.pPe("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},ja.nI.Hgb)});let wb=ra;const Ab=this;return new Promise((nb,pb)=>{wb--;Promise.race([ob,lb]).then(cb=>{fa.Health.instance.recordKpiSuccess("WACTokenRefresh",null);nb(cb)}).catch(cb=>{var Da=Ab.nI.Hgb;if(Object(hb.a)(424,
cb)&&(cb=Object(wa.a)(424,cb),0<cb.errors.count)){Ab.jQi(cb.errors);Ab.xs(cb.errors);if(Ab.XFb(cb.errors)){pb(cb);return}const zb=Ab.nI.Vdf(cb.errors);zb!==Ab.nI.Hgb?(Ab.il.PXd(Ja.P8f,zb),Da=zb):Ab.xJi(cb.errors)&&(Da=0)}wb?window.setTimeout(()=>{Ab.D7f(wb).then(nb).catch(pb)},Da):(Da=Ab.pPe("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),Ab.xs(Da.errors),pb(Da),Sa.a(512267292,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",
Ab.J4))})})}xs(ra){for(let Va of ra)this.ZH.add(Va)}xJi(ra){if(!ra.count)return!1;ra=ra.ma(ra.count-1);return ra.Errors.length?"TIMEOUT"==ra.Errors[0].Id:!1}pPe(ra,Va){const ob=new la.a;for(let ja=0;ja<this.nI.tokens.length;ja++){const lb=this.Znh(this.nI.tokens[ja],ra,Va);ob.add(lb)}return new ya(new la.a,ob)}Znh(ra,Va,ob){return Object.assign(new ia,{Name:ra,Errors:[Object.assign(new ea,{Id:Va,Details:ob})]})}jQi(ra){if(ra.count){ra=ra.ma(ra.count-1);ra=JSON.stringify(ra);var Va=Object.assign(new Ua.a,
{extendedProperties:new Map});Va.extendedProperties.set("Errors",ra);Va.extendedProperties.set("RetryCount",this.bba.toString());Va.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString());Va.extendedProperties.set("IsTokenExpiring",this.i_a.toString());fa.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,Va);this.il.V2(Ja.error,ra);this.il.V2(Ja.status,Ja.failed)}}rnj(ra){this.fte.stop();const Va=this.boi(ra.result.errors);e.ULS.sendTraceTag(41755339,
217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",!Va,this.J4,this.i_a,this.bba,this.ZH.count,0<ra.result.errors.count?ra.result.errors.ma(0).Name:"",0<ra.result.errors.count&&0<ra.result.errors.ma(0).Errors.length?ra.result.errors.ma(0).Errors[0].Id:"",0<ra.result.errors.count&&0<ra.result.errors.ma(0).Errors.length?ra.result.errors.ma(0).Errors[0].Details:"");return Va?
!1:this.qnj(ra.result.tokens)}XFb(ra){return this.nI.XFb(ra)}qnj(ra){for(let Va=0;Va<ra.count;Va++){const ob=ra.ma(Va);if(ob.Name===Ma.a.accessToken){const ja=(new Date).getTime();ob.Expiry>c.AFrameworkApplication.accessTokenTtl?(e.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:ob.Expiry,["NowGetTime"]:ja,["BootTime"]:c.AFrameworkApplication.Yja},"PreviousAccessTokenTtl",c.AFrameworkApplication.accessTokenTtl),c.AFrameworkApplication.accessToken=ob.Value,c.AFrameworkApplication.accessTokenTtl=
Math.floor(ob.Expiry),c.AFrameworkApplication.E9d=ja,c.AFrameworkApplication.Fua=Math.floor(ob.Expiry)):e.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{["AccessTokenTtl"]:ob.Expiry,["NowGetTime"]:ja,["BootTime"]:c.AFrameworkApplication.Yja},"PreviousAccessTokenTtl",c.AFrameworkApplication.accessTokenTtl)}}return!0}boi(ra){let Va=!1;for(let ob=0;ob<ra.count;ob++){Va=!0;const ja=ra.ma(ob);e.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",
ja.Name,JSON.stringify(ja.Errors),this.J4)}return Va}C5h(ra){let Va=d.a.fDc;ra=parseInt(ra.Id);if(isNaN(ra))Va=d.a.Elk;else{switch(ra){case 401:Va=d.a.Hlk;break;case 403:Va=d.a.Clk;break;case 500:Va=d.a.Dlk;break;case 503:Va=d.a.Glk}Va===d.a.fDc&&(Va=500<ra?d.a.Flk:d.a.Blk)}return Va}}Object(r.a)(Ia,"TokenRefreshManager",null,[425]);class X{constructor(){this.Hgb=c.AFrameworkApplication.Klk;this.$Df=c.AFrameworkApplication.Ilk;this.tokens=c.AFrameworkApplication.nji();this.priority=c.AFrameworkApplication.F9d;
this.Npe=this.cQj();this.t0c=c.AFrameworkApplication.mji()}XFb(ra){ra=JSON.stringify(ra);if(this.t0c&&0<this.t0c.length)for(const Va of this.t0c)if(0<Va.length&&0<=ra.indexOf(Va))return!0;return!1}Vdf(ra){try{if(ra)for(let Va of ra)if(Va.Errors)for(const ob of Va.Errors)if(ob.Id in this.Npe)return Number.parseInvariant(this.Npe[ob.Id].toString())}catch(Va){e.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",Va.toString())}return this.Hgb}cQj(){const ra=
{};try{if(!c.AFrameworkApplication.ljc()||0>=c.AFrameworkApplication.ljc().length||""===c.AFrameworkApplication.ljc()[0])return ra;for(const Va of c.AFrameworkApplication.ljc())0<Va.length&&(ra[Va]=c.AFrameworkApplication.Jlk)}catch(Va){e.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",Va.toString())}return ra}}Object(r.a)(X,"TokenRefreshPolicy",null,[423]);class ca extends b.a{constructor(ra){super();this.$=ra;this.uc()}create(){c.AFrameworkApplication.WS("Microsoft.Office.Excel.Server.Flighting.IDenyListRefreshAccessTokenSilentlyV2_ManagerCreated");
c.AFrameworkApplication.fa.ra("RefreshAccessTokenSilently")?this.$b(this.doh()):this.$b(this.$.da.Ba(38)||this.$.da.Ja(38,new H(this.$)))}doh(){var ra=this.$.da.Ba(38);if(ra)return ra;ra=new Ia(c.AFrameworkApplication.Xi,c.AFrameworkApplication.oS(),new X);return this.$.da.Ja(38,new za(this.$,ra))}static la(ra){ra.da.Ja(39,new ca(ra))}}Object(r.a)(ca,"AccessTokenExpirationManagerFactory",b.a,[]);var U=a(10);a.d(C,"a",function(){return ma});const ma=()=>{U.a.Fa(ca.la)}},1232:function(r,C,a){r=a(0);
var c=a(230),b=a(30),e=a(2),f=a(15),d=a(6),h=a(1382),l=a(187);class k{constructor(){this.onResizeMiddleContainer=this.onTabStripFocus=this.onResizeEnd=this.onResizeStart=this.onOverflowMenuClose=this.onOverflowMenuOpen=this.setFocusCallback=this.onHide=this.onShow=this.onClose=this.onOpen=this.middleContainer=null}}Object(r.a)(k,"TaskPaneGroupAppProps",null,[]);var u=a(31),v=a(1),x=a(42),w=a(222),m=a(20),t=a(7),z=a(273);class y{constructor(){this.type="ExcelLegacyTaskPaneWacInfraProps";this.isSharedRuntime=
!1;this.feedbackTaskPaneProps=this.getContent=null}}Object(r.a)(y,"ExcelLegacyTaskPaneWacInfraProps",null,[]);var D=a(303),H=a(260),F=a(21),G=a(13),L=a(18),M=a(141),O=a(12),B=a(19);class E{constructor(Da){this.width=Da}}Object(r.a)(E,"ActiveTaskPaneData",null,[]);var I=a(63);class S extends x.a{constructor(Da,zb){super();this.isVisible=!1;this.N3d=this.cha=-1;this.VSe=40;this.Ci=this.jQ=this.animationManager=this.lPc=null;this.EJd=()=>{this.S7f()};this.xHc=new Set;this.xHc.add("FieldListTaskPane");
this.xHc.add("PivotTableSettingsTaskPane");this.xHc.add("SlicerSettingsTaskPane");this.Ub=zb;z.a(this.$).Zi(this);this.vB=Da;this.mcb=this.q8g();b.a.qk()||d.AFrameworkApplication.sa.Qa.$f||(this.vB.style.bottom=this.$.oe&4?O.HelperMethods.ud(this.$.Zga):"0");this.Iec={};this.CTb={};this.vae={};this.K3d=M.a.instance.Re(this.Wc);this.K3d.la("focusin",this.EJd);this.Jvi()}get $(){return this.Ub}get pja(){return this.vae}get YN(){return this.lPc}get isCollapsed(){return!this.YN}dispose(){z.a(this.$).gB(this);
const Da=this.Iec;for(let zb in Da)({key:zb,value:Da[zb]}).value();this.CTb=this.vae=this.Iec=null;this.K3d.oE();this.mcb=this.vB=this.K3d=null;super.dispose()}Oxa(Da,zb,qb,Pa,Nb,Tb,Vb,Jb,Qa=S.ANi,Db=S.zNi,sa=null,Ha=null,mb=!1){const qa=Object(e.a)(new y,{getContent:()=>Da});qa.isSharedRuntime=mb;return Object(e.a)(new h.a,{hideHeader:v.EwaSettings.isChangeGateEnabled("OfficeVSO:7858326_TaskPaneReactHeader")?!1:!0,contentProps:qa,title:zb,width:qb,location:2,onOpen:Nb,onClose:Tb,onShow:Vb,onHide:Jb,
iconUrl:sa,iconId:Ha,enableResize:Pa,minResizeWidth:Qa,maxResizeWidth:Db})}m9(Da,zb){l.UISurfaces.nk().then(qb=>{Da in this.pja?qb.setSelectedTaskPane(Da):qb.showTaskPane(Da,zb);return null})}lac(Da,zb){l.UISurfaces.nk().then(qb=>{qb.initializeHiddenSharedRuntimeTaskPane(Da,zb);const Pa=this.$.domElement;Pa.addEventListener("scroll",function Tb(){0!=Pa.scrollLeft&&(Pa.scrollLeft=0,Pa.removeEventListener("scroll",Tb))})})}updateTaskPane(Da,zb){l.UISurfaces.nk().then(qb=>{qb.updateTaskPane(Da,zb);return null})}setSelectedTaskPane(Da){l.UISurfaces.nk().then(zb=>
{zb.setSelectedTaskPane(Da);return null})}hideTaskPane(Da){l.UISurfaces.nk().then(zb=>{zb.hideTaskPane(Da,S.y5j);return null})}get Wc(){return this.vB}get Fg(){return this.isVisible}get Qe(){return H.a.vHc}$g(Da,zb){return zb?!1:(this.bbg(),!0)}ui(Da){return G.DOMElementExtensions.zg(this.Wc,Da)}pk(){this.$.frame.Hf.gl(this.Qe)}Rk(){}q8g(){const Da=document.createElement(w.a.div);Da.style.height="0px";Da.style.width="0px";Da.tabIndex=-1;return Da}g_h(){var Da=G.DOMElementExtensions.getElementById(this.vB,
"tabStripFocusZone");if(Da){Da=Da.getElementsByTagName("button");for(let zb=0;zb<Da.length;zb++)if(Boolean.parse(Da[zb].getAttribute("aria-selected")))return Da[zb].getAttribute("aria-controls")}return null}sih(Da){return(Da=window.getComputedStyle(Da,null).getPropertyValue("transition-duration"))?parseInt(Da.endsWith("ms")?parseFloat(Da):1E3*parseFloat(Da),10):0}duj(){const Da=document.getElementById("tabbedTaskPaneContainer");Da&&Da.addEventListener("transitionend",()=>this.rKa(-1))}Jvi(){l.UISurfaces.nk().then(Da=>
{let zb=new k;zb.middleContainer=this.mcb;zb.onOpen=(qb,Pa)=>{this.isVisible=!0;-1===this.cha&&(this.cha=this.sih(Pa));b.a.qk()||(this.pja[qb]=new E(G.DOMElementExtensions.wR(G.DOMElementExtensions.getElementById(Pa,S.Hng))))};zb.onClose=qb=>{this.isVisible=0<Da.selectors.getTabbedTaskPaneCount();f.ULS.sendTraceTag(537014371,0,50,`Closing of ${qb} TaskPane`);if(!this.isVisible)this.E5e(),b.a.qk()||d.AFrameworkApplication.sa.Qa.$f||window.requestAnimationFrame(()=>{this.k5b(this.mcb)});else if(!b.a.qk()&&
this.YN&&this.YN!==qb){const Pa=1<Da.selectors.getTabbedTaskPaneCount()?this.Oic():0,Nb=1===Da.selectors.getTabbedTaskPaneCount()?-1*this.Oic():0;this.Ize(qb,this.YN,Pa,Nb)}b.a.qk()?this.rKa(this.cha):(d.AFrameworkApplication.sa.Qa.$f&&0>=this.cha&&this.rKa(this.cha),delete this.pja[qb]);delete this.CTb[qb]};zb.onShow=(qb,Pa)=>{null!=this.Wi&&(this.Wi.stop(),this.Wi=null);this.lPc=qb;this.S7f();1!==Pa&&window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.mGj()},0)});b.a.qk()?window.requestAnimationFrame(()=>
{this.rKa(this.cha)}):d.AFrameworkApplication.sa.Qa.$f&&0>=this.cha?window.requestAnimationFrame(()=>{this.rKa(this.cha)}):window.requestAnimationFrame(()=>{this.IHj(this.mcb,this.cha)})};zb.onHide=(qb,Pa,Nb)=>{const Tb=this.g_h();Tb!==qb&&(this.Wi=this.$.yc.Fd("UserAction","TaskPaneToggle"),f.ULS.sendTraceTag(537014370,0,50,`Toggling Pane from ${qb} to ${Tb}`));Nb?b.a.qk()||this.k5b(this.mcb):!b.a.qk()&&Tb&&(qb=1===Object.keys(this.pja).length?this.Oic():0,this.Ize(this.YN,Tb,this.Oic(),qb));this.lPc=
null;Nb&&1!==Pa&&this.E5e();b.a.qk()&&window.requestAnimationFrame(()=>{this.rKa(this.cha)})};zb.setFocusCallback=(qb,Pa)=>{Pa&&(this.CTb[qb]=Pa)};zb.onResizeStart=()=>{b.a.qk()||this.y3c(O.HelperMethods.ud(0))};zb.onResizeEnd=()=>{b.a.qk()?this.rKa():(this.k5b(this.mcb),this.pja[this.YN]=this.Ppd(this.YN));f.ULS.sendTraceTag(537014369,0,50,`Resizing of ${this.YN} TaskPane`)};Da.renderTaskPaneGroups(null,this.vB,zb);d.AFrameworkApplication.sa.Qa.$f&&!b.a.qk()&&this.duj();return null})}k5b(Da){this.y3c(this.$.isChromeRtl?
Da.style.left:Da.style.right)}y3c(Da){f.ULS.sendTraceTag(537014368,0,50,`Grid adjust is triggered for taskPane ${this.YN}`);this.$.gDj(Da)}rKa(Da=0){-1<Da?I.Task.delay(Da+this.VSe).continueWith(()=>{this.$.ACa(D.a.B0("ResetContentAreaMargin"))}):this.$.ACa(D.a.B0("ResetContentAreaMargin"))}Ize(Da,zb,qb,Pa){zb=zb.endsWith(S.L3d)?zb.substring(0,zb.length-S.L3d.length):zb;zb=this.ugf(zb);Pa=zb+Pa;Da=this.ugf(Da);Pa<Da&&this.y3c(O.HelperMethods.ud(zb+qb))}IHj(Da,zb){window.setTimeout(()=>{this.k5b(Da)},
zb+this.VSe)}Oic(){return-1!==this.N3d?this.N3d:this.N3d=G.DOMElementExtensions.wR(G.DOMElementExtensions.getElementById(this.vB,"tabStripFocusZone"))}Ppd(Da){return G.DOMElementExtensions.wR(G.DOMElementExtensions.getElementById(G.DOMElementExtensions.getElementById(this.vB,Da+S.L3d),S.Hng))}ugf(Da){if(Da in this.pja){const zb=this.pja[Da].width;return 0<zb?zb:this.Ppd(Da)}return Da?this.Ppd(Da):0}E5e(){B.h(this.$).setFocus()}mGj(){if(this.CTb[this.YN]){const Da=this.CTb[this.YN];Da&&Da(null,null)}else this.xHc.has(this.YN)||
this.bbg()}bbg(){l.UISurfaces.nk().then(Da=>{1<Da.selectors.getTabbedTaskPaneCount()?Da.focusTabbedTaskPaneArea():(Da=G.DOMElementExtensions.getElementById(this.Wc,"AgaveTaskpaneCloseButtonId"))?Da.focus():(Da=G.DOMElementExtensions.Bm(this.Wc.querySelectorAll("button")))&&Da.focus();return null})}S7f(){this.$.domElement.scrollLeft=0;u.a.xQa&&window.requestAnimationFrame(()=>{this.$.domElement.scrollLeft=0;window.setTimeout(()=>{this.$.domElement.scrollLeft=0},0)})}UF(Da){this.addHandler(S.Lkb,Da)}rH(Da){this.removeHandler(S.Lkb,
Da)}get hQ(){return this.vB}get pF(){f.ULS.shipAssertTag(537151112,11,!1,"ReactTaskPaneManager.TaskPaneButtons should not be used with the WAC infra");return null}ywb(Da,zb,qb,Pa,Nb){let Tb=Da.Ba(zb);Tb||(Tb=L.a(F.a,qb,Da,zb),Tb.SetScriptLoadFlavor(Nb));Pa&&Tb.t2c(Pa);const Vb=""+zb;let Jb=null;const Qa=()=>{Tb.create();Jb()};this.Iec[Vb]=Jb=()=>{Tb.Zzc(Qa);delete this.Iec[Vb]};Tb.y4b(Qa)}initialize(){f.ULS.shipAssertTag(537151111,11,!1,"ReactTaskPaneManager.Initialize should not be used with the WAC infra")}Kig(){}wS(){f.ULS.shipAssertTag(537151110,
11,!1,"ReactTaskPaneManager.InsertPane should not be used with the WAC infra")}$J(){f.ULS.shipAssertTag(537151109,11,!1,"ReactTaskPaneManager.SelectPane should not be used with the WAC infra")}qxe(){f.ULS.shipAssertTag(537151108,11,!1,"ReactTaskPaneManager.AddTaskPane should not be used with the WAC infra")}p7f(){f.ULS.shipAssertTag(537151107,11,!1,"ReactTaskPaneManager.RepositionTaskpaneForCurrentMode should not be used with the WAC infra")}t8a(){f.ULS.shipAssertTag(537151106,11,!1,"ReactTaskPaneManager.GetTaskPane should not be used with the WAC infra");
return null}Dld(){f.ULS.shipAssertTag(537151105,11,!1,"ReactTaskPaneManager.GetButtonsByTaskPaneType should not be used with the WAC infra");return null}xla(){f.ULS.shipAssertTag(537151104,11,!1,"ReactTaskPaneManager.ExpandOrCollapsePane should not be used with the WAC infra")}mD(){f.ULS.shipAssertTag(537151075,11,!1,"ReactTaskPaneManager.UpdateAvailablePanes should not be used with the WAC infra")}setFocusOnToolbarFirstElement(){f.ULS.shipAssertTag(537151070,11,!1,"ReactTaskPaneManager.SetFocusOnToolbarFirstElement should not be used with the WAC infra")}dYd(){f.ULS.shipAssertTag(537151069,
11,!1,"ReactTaskPaneManager.SetFocusOnToolbarLastElement should not be used with the WAC infra")}static la(Da){const zb=S.o9g(Da.qc,Da.isChromeRtl);S.U3g(Da,zb);return new S(zb,Da)}static o9g(Da,zb){const qb=document.createElement("div");qb.id=Da+t.a.wHc;b.a.qk()?qb.classList.add(m.a.Ukk):(qb.classList.add(zb?m.a.Wkk:m.a.Vkk),d.AFrameworkApplication.sa.Qa.$f&&qb.classList.add(m.a.LCa));return qb}static U3g(Da,zb){Da.isMobileMode&&zb.setAttribute("aria-hidden","true");if(d.AFrameworkApplication.sa.Qa.$f){let qb;
(qb=document.getElementById("FarPaneRegion"))?qb.appendChild(zb):f.ULS.shipAssertTag(509097620,11,!1,`FarPaneRegion is not found, regionComposerRoot found=${!!document.getElementById("regionComposerRoot")}`)}else v.EwaSettings.isChangeGateEnabled("OfficeVSO:7643983_GridLayoutRemoval")||b.a.qk()&&zb.classList.add(m.a.lGh),document.getElementById(Da.qc+t.a.X3a).insertBefore(zb,Da.bEa)}}S.ANi=300;S.zNi=950;S.y5j=2;S.L3d="-panel";S.Hng="ExcelTaskPaneContentWrapper";S.bkg="rtpSizeChanged";S.HLe="rtpCollapsed";
S.RUf="rtpAdded";S.Lkb="rtpVisibility";Object(r.a)(S,"ReactTaskPaneManager",x.a,[420,26,2]);var J=a(102),K=a(170),R=a(14),Z=a(250),P=a(113),V=a(92),Ea=a(425),oa=a(232),ea=a(88),aa=a(126),ia=a(101),ya=a(766),za=a(568),la=a(54),xa=a(16);class wa extends Sys.EventArgs{constructor(){super()}}Object(r.a)(wa,"TaskPaneVisibilityChangedEventArgs",Sys.EventArgs,[]);var hb=a(49),Ja=a(90),Fa=a(249);const Ba=ya.a.kJh,fa=ya.a.mJh,ta=`<span class='${m.a.i9b} ${ya.a.nJh} {3}'><img class='{1}' alt='{0}' src='{2}' {4}/></span>`;
class Oa extends Fa.a{constructor(Da){super(document.createElement("a"));this.Ta=new x.a;this.Bc=this.Mse=null;this.Ud=()=>{this.enabled&&this.Ta.raiseEvent("tpButtonClicked",null,this);return!0};this.Bc=Da}rWg(Da){this.Ta.addHandler("tpButtonClicked",Da)}z4f(Da){this.Ta.removeHandler("tpButtonClicked",Da)}get j3a(){return this.domElement}get taskPane(){return this.Mse}get enabled(){return super.enabled}set enabled(Da){Da!==super.enabled&&(this.domElement.classList.toggle(ya.a.MV),this.domElement.classList.toggle(fa),
this.domElement.tabIndex=Da?0:-1,super.enabled=Da)}get qq(){return this.domElement.firstChild.firstChild}dispose(){V.a.ed([this.Ta]);this.Ta=null;this.domElement&&hb.a.Mpa(this.domElement);super.dispose()}Ivi(Da){const zb=6===Da.Ji;var qb=zb&&!Da.Dl;qb=String.format(ta,Da.uS,Da.Dl,qb?la.a.current.Uo(103):la.a.yg(10),ya.a.Oka,qb?String.format('style="width:24px;{0}:0px"',"left"):"");this.Bc.Yh(this.domElement,qb);this.domElement.classList.add(Ba);this.domElement.classList.add(fa);this.domElement.title=
Da.uS;this.domElement.tabIndex=0;G.DOMElementExtensions.xy(this.domElement,t.a.Au,null,null);this.Mse=Da;zb&&(Da=this.taskPane,null===Da||void 0===Da?void 0:Da.ntg());oa.a.instance.ta(R.a.click,this.domElement,this.Ud);P.KeyInputManager.instance.ev(this.domElement,this.Ud,Ja.a.Li)}}Object(r.a)(Oa,"TaskPaneButton",Fa.a,[485]);class Ma extends ia.a{constructor(Da,zb,qb,Pa){super(Da);this.animationManager=this.p8=this.If=null;this.nN=this.KYa=!1;this.Fde=0;this.Ub=null;this.nTc=!1;this.Bc=null;this.$A=
()=>{this.qDi||(this.mD(),this.$.ig())};this.NId=(Nb,Tb)=>{this.onButtonClick(Nb,Tb)};this.O8=()=>{this.rJc()};this.$=zb;this.Bc=Pa;z.a(this.$).Zi(this);this.$.oc.Vg(this.O8);this.configuration=qb;this.baseName=O.HelperMethods.rya(this.domElement,this.configuration.Kng||this.configuration.k3);this.Hec={};this.Xib=[];this.uv=[];this.xub={};this.Nse=document.getElementById(this.baseName+this.configuration.J3d);this.hQ||f.ULS.sendTraceTag(512291722,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+
this.configuration.J3d} not found`);this.BPg=document.getElementById(this.baseName+this.configuration.k3);this.vB||f.ULS.sendTraceTag(512291721,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+this.configuration.k3} not found`);this.CPg=document.getElementById(this.baseName+this.configuration.Q4d);this.jQ||f.ULS.sendTraceTag(512291720,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+this.configuration.Q4d} not found`);Da=String.format(Ma.z5j,this.baseName+this.configuration.ypg,
this.baseName+Ma.BTb);this.Bc.Yh(this.jQ,Da);this.Sbe=document.getElementById(this.baseName+Ma.BTb);this.nGe||f.ULS.sendTraceTag(512291719,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+Ma.BTb} not found`);(this.wub=document.getElementById(this.baseName+Ma.BTb))||f.ULS.sendTraceTag(512291718,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+Ma.BTb} not found`);this.SEg=this.GPe(this.configuration.FLe,this.CLe);this.REg=this.YOe(this.configuration.DLe,xa.a.instance.ha(1297),
this.xji,this.d4a,!0);this.QGg=this.GPe(this.configuration.I2e,this.nQh);this.PGg=this.YOe(this.configuration.G2e,xa.a.instance.ha(1296),this.yji,this.QMa,!1);G.DOMElementExtensions.setVisible(this.QMa,!1);oa.a.instance.ta(R.a.click,this.c4a,Object(ea.a)(this,this.juc,"onCollapseIconClicked"));oa.a.instance.ta(R.a.click,this.PMa,Object(ea.a)(this,this.Buc,"onExpandIconClicked"));oa.a.instance.ta(R.a.click,this.d4a,Object(ea.a)(this,this.juc,"onCollapseIconClicked"));oa.a.instance.ta(R.a.click,this.QMa,
Object(ea.a)(this,this.Buc,"onExpandIconClicked"));P.KeyInputManager.instance.ta(R.a.Ic,this.c4a,Object(ea.a)(this,this.WJf,"onCollapseIconKeyDown"));P.KeyInputManager.instance.ta(R.a.Ic,this.PMa,Object(ea.a)(this,this.ELf,"onExpandIconKeyDown"))}UF(Da){this.addHandler(Ma.Lkb,Da);Da(this,new wa(this.isVisible,G.DOMElementExtensions.isVisible(this.jQ)))}rH(Da){this.removeHandler(Ma.Lkb,Da)}get jQ(){return this.CPg}get Wc(){return this.jQ}get Fg(){return this.KYa}set Fg(Da){this.KYa=Da}get vB(){return this.BPg}get Qe(){return H.a.j_i}get hQ(){return this.Nse}get pF(){return this.uv}get Ci(){return this.If}get YN(){return null}get pja(){return null}get isCollapsed(){return this.nN}get ocd(){return this.Fde}get $(){return this.Ub}set $(Da){this.Ub=
Da}get nGe(){return this.Sbe}get c4a(){return this.REg}get PMa(){return this.PGg}get d4a(){return this.SEg}get QMa(){return this.QGg}get qDi(){return this.nTc}get yji(){return this.configuration.ELe}get xji(){return this.configuration.H2e}ywb(Da,zb,qb,Pa,Nb){let Tb=Da.Ba(zb);Tb||(Tb=L.a(F.a,qb,Da,zb),Tb.SetScriptLoadFlavor(Nb));Pa&&Tb.t2c(Pa);const Vb=""+zb;Vb in this.Hec||Tb.T4b((Db,sa)=>{this.c9(sa)});let Jb=null;const Qa=()=>{Tb.create();Jb()};this.Hec[Vb]=Jb=()=>{Tb.Zzc(Qa);delete this.Hec[Vb]};
Tb.y4b(Qa)}dispose(){if(this.uv)for(let zb=0,qb=this.uv.length;zb<qb;zb++)this.uv[zb].z4f(this.NId),this.uv[zb].dispose();const Da=this.Hec;for(let zb in Da)({key:zb,value:Da[zb]}).value();this.$.ea&&this.$.oc&&this.$.oc.xh(this.O8);this.wub=this.Sbe=this.Nse=this.If=this.xub=this.Xib=this.uv=null;oa.a.instance.Aa(R.a.click,this.c4a,Object(ea.a)(this,this.juc,"onCollapseIconClicked"));oa.a.instance.Aa(R.a.click,this.PMa,Object(ea.a)(this,this.Buc,"onExpandIconClicked"));oa.a.instance.Aa(R.a.click,
this.d4a,Object(ea.a)(this,this.juc,"onCollapseIconClicked"));oa.a.instance.Aa(R.a.click,this.QMa,Object(ea.a)(this,this.Buc,"onExpandIconClicked"));P.KeyInputManager.instance.Aa(R.a.Ic,this.c4a,Object(ea.a)(this,this.WJf,"onCollapseIconKeyDown"));P.KeyInputManager.instance.Aa(R.a.Ic,this.PMa,Object(ea.a)(this,this.ELf,"onExpandIconKeyDown"));super.dispose()}$g(Da,zb){if(zb)return!1;this.If&&!this.isCollapsed?(Da=this.Ci.taskPane,Da.Fg&&Da.$g(!0,!1)||G.DOMElementExtensions.setFocus(this.Ci.j3a)):
G.DOMElementExtensions.setFocus(this.PMa);return!0}ui(Da){return this.isVisible?G.DOMElementExtensions.zg(this.domElement,Da)||G.DOMElementExtensions.zg(this.domElement,G.DOMElementExtensions.iBb(Da)):!1}pk(){}Rk(){this.If&&this.If.taskPane.Rk()}setFocusOnToolbarFirstElement(){this.isCollapsed?G.DOMElementExtensions.setFocus(this.PMa):G.DOMElementExtensions.setFocus(this.c4a)}dYd(){for(let Da=this.uv.length-1;0<=Da;Da--)if(this.uv[Da].isVisible){G.DOMElementExtensions.setFocus(this.uv[Da].j3a);return}this.setFocusOnToolbarFirstElement()}t8a(Da){const zb=
[];for(let qb=this.uv.length-1;0<=qb;qb--)this.uv[qb].taskPane.Ji===Da&&zb.push(this.uv[qb].taskPane);return zb}Dld(Da){const zb=[];for(let qb=0;qb<this.uv.length;qb++)this.uv[qb].taskPane.Ji===Da&&zb.push(this.uv[qb]);return zb}qxe(Da){if(Da){let zb;const qb=Object(aa.a)(403,Da);qb?(zb=new Oa(this.Bc),zb.domElement.id=this.baseName+"bt_"+Da.Ji.toString()+"_"+Da.Zf.InstanceId,this.wub.appendChild(zb.domElement),this.xub["6"]=zb,qb.button=zb):zb=this.xub[Da.Ji.toString()];zb.Ivi(Da);zb.rWg(this.NId);
zb.isVisible=Da.Sr();zb.enabled=Da.Vu();this.Xib.push(Da);this.uv.push(zb);Ma.vXi(Da,this.hQ);this.eEh(zb);this.rJc()}}$J(Da,zb){let qb;for(const Pa of this.uv)qb=Pa.taskPane,qb.Ji===Da.Ji&&qb==Da&&this.z8b(Pa,zb)}Oxa(){f.ULS.shipAssertTag(512291714,11,!1,"TaskPaneControl.GenerateTaskPaneData: should only be used with WAC infra.");return null}m9(){f.ULS.shipAssertTag(512291713,11,!1,"TaskPaneControl.ShowTaskPane: should only be used with WAC infra.")}lac(){f.ULS.shipAssertTag(512291712,11,!1,"TaskPaneControl.createTaskPaneInHidden: should only be used with WAC infra.")}updateTaskPane(){f.ULS.shipAssertTag(512291683,
11,!1,"TaskPaneControl.UpdateTaskPane: should only be used with WAC infra.")}setSelectedTaskPane(){f.ULS.shipAssertTag(512291682,11,!1,"TaskPaneControl.SetSelectedTaskPane: should only be used with WAC infra.")}hideTaskPane(){f.ULS.shipAssertTag(512291681,11,!1,"TaskPaneControl.HideTaskPane: should only be used with WAC infra.")}Kig(Da,zb){Da?(this.nTc=!0,this.WYd(!1)):(this.nTc=!1,this.WYd(!0),zb&&(this.mD(),this.$.ig()))}wS(Da){if(!this.Xib.includes(Da)){let qb=null;qb=()=>{this.mxj(Da);Da.lY(qb)};
Da.iV(qb);this.qxe(Da);var zb=Object(aa.a)(468,Da);zb&&(zb.UF(this.$A),this.$A(zb,Sys.EventArgs.Empty));if(zb=Object(aa.a)(153,Da))zb.UF(this.$A),this.$A(zb,Sys.EventArgs.Empty);if(zb=Object(aa.a)(469,Da))zb.UF(this.$A),this.$A(zb,Sys.EventArgs.Empty);this.raiseEvent(Ma.RUf,null,Da);this.mD()}}z8b(Da,zb){if(Da.taskPane.Vu()&&Da.taskPane.Sr()){if(this.If){this.If.domElement.classList.remove(Ma.urb);this.If.taskPane.isVisible=!1;if(v.EwaSettings.isChangeGateEnabled("OfficeVSO:4961099_RangePickerOnOSF")){const qb=
Object(aa.a)(403,this.If.taskPane);qb&&qb.xk.bSd(qb.Zf.InstanceId)}this.p8=this.If}this.If=Da;this.If.taskPane.isVisible=!0;this.If.domElement.classList.add(Ma.urb);zb&&this.xla(!1,!1);this.skb()}}onButtonClick(Da){let zb=!1;if(this.If!==Da){zb=!0;const qb=Da.taskPane.Wc;this.animationManager.Ilj(qb);if(this.If){if(v.EwaSettings.isChangeGateEnabled("OfficeVSO:4961099_RangePickerOnOSF")){const Pa=Object(aa.a)(403,this.If.taskPane);Pa&&Pa.xk.bSd(Pa.Zf.InstanceId)}this.If.taskPane.isVisible=!1;this.If.domElement.classList.remove(Ma.urb)}this.p8=
this.If;this.If=Da;this.If.domElement.classList.add(Ma.urb);this.If.taskPane.isVisible=!0;this.skb();this.animationManager.gQh(qb)}this.xla(!(this.isCollapsed||zb),!1)}skb(){const Da=this.ocd;let zb=0;this.If&&(zb=this.If.taskPane.nx?this.If.taskPane.nx:this.If.taskPane.fr);zb!==Da&&(this.Fde=zb,this.isCollapsed||(this.animationManager&&this.If?this.animationManager.F5b(this.vB,Da,zb,this.Ci.taskPane):this.vB.style.width=O.HelperMethods.ud(zb)),this.yUa(),this.raiseEvent(Ma.bkg,null,this))}WN(Da){const zb=
new Oa(this.Bc);zb.isVisible=!1;zb.domElement.id=this.baseName+"bt_"+Da.toString();this.wub.appendChild(zb.domElement);this.xub[Da.toString()]=zb}rJc(){if(void 0!==this.uv&&null!==this.uv){void 0===this.If||null===this.If||this.If.taskPane.Vu()||(this.If.domElement.classList.remove(Ma.urb),this.If.taskPane.isVisible=!1,this.If.taskPane.Sr()&&(this.p8=this.If),this.If=null);var Da=null;for(let zb=0;zb<this.uv.length;zb++)if(this.Xib[zb].Sr()){const qb=this.Xib[zb].Vu();(this.uv[zb].enabled=qb)&&!Da&&
(Da=this.uv[zb])}void 0!==this.If&&null!==this.If||!Da||(void 0!==this.p8&&null!==this.p8&&this.p8.taskPane.Vu()&&this.p8.taskPane.Sr()?this.z8b(this.p8,!1):this.z8b(Da,!1));void 0!==za.a(this.$)&&null!==za.a(this.$)&&za.a(this.$).isVisible&&void 0!==this.If&&null!==this.If&&1!==this.If.taskPane.Ji&&(za.a(this.$).isVisible=!1);void 0!==this.If&&null!==this.If&&7!==this.If.taskPane.Ji&&(Da=this.$.da.Ba(52),null===Da||void 0===Da?0:Da.isVisible)&&(Da.isVisible=!1);void 0!==this.If&&null!==this.If&&
8!==this.If.taskPane.Ji&&(Da=this.$.da.Ba(233))&&(Da.isVisible=!1);void 0!==this.If&&null!==this.If&&9!==this.If.taskPane.Ji&&(Da=this.$.da.Ba(248))&&(Da.isVisible=!1);v.EwaSettings.ya(264)&&void 0!==this.If&&null!==this.If&&12!==this.If.taskPane.Ji&&(Da=this.$.da.Ba(302))&&(Da.isVisible=!1);v.EwaSettings.ya(418)&&void 0!==this.If&&null!==this.If&&15!==this.If.taskPane.Ji&&(Da=this.$.da.Ba(365))&&(Da.isVisible=!1);b.a.DAd(this.$)&&void 0!==this.If&&null!==this.If&&13!==this.If.taskPane.Ji&&(Da=this.$.da.Ba(334))&&
(Da.isVisible=!1);void 0!==this.If&&null!==this.If&&14!==this.If.taskPane.Ji&&(Da=this.$.da.Ba(346))&&(Da.isVisible=!1);void 0!==this.If&&null!==this.If&&16!==this.If.taskPane.Ji&&(Da=this.$.da.Ba(371))&&(Da.isVisible=!1);void 0!==this.If&&null!==this.If&&17!==this.If.taskPane.Ji&&(Da=this.$.da.Ba(408))&&(Da.isVisible=!1);this.skb()}}SSh(Da,zb){G.DOMElementExtensions.setVisible(this.d4a,!Da);G.DOMElementExtensions.setVisible(this.QMa,Da);Da&&this.raiseEvent(Ma.HLe,null,this);this.skb();zb&&G.DOMElementExtensions.setFocus(Da?
this.PMa:this.c4a)}Mjc(Da,zb){this.$.Ed(Da,zb,26,null)}c9(Da){Da.SP&&this.wS(Da.SP)}mxj(Da){if(Da){const zb=this.uv.length;let qb=!1;for(let Pa=0;Pa<zb;Pa++){const Nb=this.uv[Pa];if(Nb.taskPane===Da){this.wub.removeChild(Nb.j3a);delete this.xub[Da.Ji.toString()];Array.remove(this.Xib,Da);Array.remove(this.uv,Nb);Nb.z4f(this.NId);Nb.taskPane.Wc.parentNode.removeChild(Nb.taskPane.Wc);this.If&&this.If.taskPane===Nb.taskPane&&(this.If=null);this.p8&&this.p8.taskPane===Nb.taskPane&&(this.p8=null);qb=!0;
break}}qb&&this.rJc()}}eEh(Da){const zb=Da.taskPane.Ji,qb=!!this.If&&1===this.If.taskPane.Ji;(1===zb||!qb&&2===zb)&&this.z8b(Da,!1)}static vXi(Da,zb){const qb=Da.Wc;qb.parentNode&&qb.parentNode.removeChild(qb);zb.appendChild(qb);Da.isVisible=!1}YOe(Da,zb,qb,Pa,Nb){const Tb=document.createElement("a");Tb.setAttribute(t.a.oV,Nb?t.a.kl:t.a.Cs);Tb.setAttribute(t.a.te,t.a.Au);Tb.tabIndex=0;Tb.classList.add(m.a.aE);Tb.classList.add(Da);Tb.classList.add(ya.a.jJh);Da=String.format(Ma.eeh,zb,qb,la.a.yg(10));
this.Bc.Yh(Tb,Da);Pa.appendChild(Tb);return Tb}}Ma.Lkb="tpVisibility";Ma.z5j=`<div id='{0}' class='${ya.a.pJh}'><div id='{1}' class='${ya.a.oJh}'></div></div>`;Ma.eeh="<img title='{0}' class='{1}' alt='{0}' src='{2}'/>";Ma.BTb="novTaskpaneButtonGroup";Ma.urb=ya.a.lJh;Ma.bkg="tpSizeChanged";Ma.HLe="tpCollapsed";Ma.RUf="tpAdded";Object(r.a)(Ma,"TaskPaneControl",ia.a,[420,26,2]);var fb=a(53),pa=a(457),Ua=a(740);class Sa{constructor(){this.H2e=this.ELe=this.G2e=this.DLe=this.I2e=this.FLe=this.ypg=this.Q4d=
this.J3d=this.k3=this.Kng=null}}Object(r.a)(Sa,"Configuration",null,[]);a(438);ia=a(306);class Ia extends ia.a{constructor(Da){super(5,Da)}}Object(r.a)(Ia,"ResizeAnimationEvent",ia.a,[]);var X=a(483),ca=a(601),U=a(104);class ma{constructor(Da,zb){this.Lng=null;this.$=zb;this.taskPane=Da}XPh(){this.Lng=G.DOMElementExtensions.getElementById(this.taskPane.parentNode,this.$.qc+t.a.UHd);const Da=ma.Qbd(this.taskPane),zb=ma.Qbd(this.Lng),qb=ca.a(U.a.Em);qb.animate(Da,t.a.rEc);qb.animate(zb,t.a.rEc)}Ilj(Da){Da.style.opacity=
"0"}gQh(Da){ca.a(U.a.Em).animate(ma.Qbd(Da),t.a.rEc)}F5b(Da,zb,qb,Pa){zb||(Pa.isVisible=!0);this.$.yUa(qb);ca.a(U.a.Em).animate(ma.srh(Da,zb,qb),t.a.rEc,null,null,()=>{this.$.bDa();qb||1===Pa.Ji||(Pa.isVisible=!1);Pa.LX(qb<zb)})}static srh(Da,zb,qb){Da=new Ia(Da);Da.M0g(zb,qb);return Da}static Qbd(Da){Da=new X.a(Da);Da.DN(0,1);return Da}}Object(r.a)(ma,"TaskPaneAnimationManager",null,[446]);const ra=`<div id="{0}" class="${ya.a.tJh}" runat="server"></div></div><div id="{1}" class="${ya.a.sJh} ${ya.a.Kv}" runat="server"></div>`,
Va=`<button type="button" id="{0}" class="${ya.a.qJh}"></button><span><div id="{1}" class="${ya.a.rJh}"></div></span>`,ob=ya.a.dJh;class ja extends Ma{constructor(Da,zb,qb,Pa){super(Da,qb,ja.lnh(),Pa);this.Nwc=null;this.Xzd=!1;this.UT=null;this.H$i=Nb=>{var Tb=!1;if(9===Nb.Da.keyCode){Tb=this.Ci.taskPane.QW(Nb,this.jQ);if(!Tb){Tb=this.$.da.Ba(52);var Vb=this.domElement.querySelectorAll(this.Ci.taskPane===Tb?Tb.Nr:pa.a.Dgj);Tb=G.DOMElementExtensions.Bm(Vb);Vb=G.DOMElementExtensions.pC(Vb);Tb=G.DOMElementExtensions.CDa(Nb.Da,
Tb,Vb)}return Tb}Vb=J.FocusManager.instance().Yi;if(null===Vb||void 0===Vb?0:Vb.LO)return Tb;27===Nb.Da.keyCode&&this.Ci.taskPane.Oh(!1);return Tb};this.ee=()=>{this.jQ.style.bottom=this.vB.style.bottom=this.$.oe&4&&!d.AFrameworkApplication.sa.Qa.$f?O.HelperMethods.ud(this.$.Zga):"0";this.mD()};this.vQf=Nb=>{Object(Ea.a)(403,this.Ci.taskPane)&&(this.Ci.taskPane.zJa.firstChild.style[t.a.pointerEvents]="none");this.Xzd=!0;this.UT=this.wBb(Nb.clientPoint);K.a.instance.ta(R.a.lh,this.domElement.ownerDocument.body,
this.Fvc);K.a.instance.ta(R.a.jf,this.domElement.ownerDocument.body,this.Gvc);Z.a.instance.ta(R.a.dl,this.domElement.ownerDocument.body,this.Fvc);Z.a.instance.ta(R.a.Zg,this.domElement.ownerDocument.body,this.Gvc);return!0};this.Gvc=()=>{Object(Ea.a)(403,this.Ci.taskPane)&&(this.Ci.taskPane.zJa.firstChild.style[t.a.pointerEvents]="");this.Xzd=!1;K.a.instance.Aa(R.a.lh,this.domElement.ownerDocument.body,this.Fvc);K.a.instance.Aa(R.a.jf,this.domElement.ownerDocument.body,this.Gvc);Z.a.instance.Aa(R.a.dl,
this.domElement.ownerDocument.body,this.Fvc);Z.a.instance.Aa(R.a.Zg,this.domElement.ownerDocument.body,this.Gvc);return!0};this.Fvc=Nb=>{this.Xzd&&(Nb=this.wBb(Nb.clientPoint),Nb=Ua.a.oF(Nb,this.UT),this.JAe(Nb.x));return!0};this.Qaj=Nb=>{void 0!==Nb.Da&&null!==Nb.Da&&(9===Nb.Da.keyCode?Nb.Da.shiftKey?(Nb=Object(Ea.a)(26,this.Ci.taskPane)?this.Ci.taskPane:null)&&Nb.$g(!1,!1):this.setFocusOnToolbarFirstElement():37!==Nb.Da.keyCode&&39!==Nb.Da.keyCode||this.JAe(37===Nb.Da.keyCode?-20:20));return!0};
this.$.domElement.classList.add(ob);this.Ing=zb;this.initialize();P.KeyInputManager.instance.ta(R.a.Ic,this.domElement,this.H$i);this.DTb=G.DOMElementExtensions.getElementById(zb.parentNode,this.$.qc+t.a.Ftc);this.zHc=G.DOMElementExtensions.getElementById(zb.parentNode,this.$.qc+t.a.$Gf);this.DTb.title=xa.a.instance.ha(2233);K.a.instance.ta(R.a.mg,this.zHc,this.vQf);Z.a.instance.ta(R.a.pointerDown,this.zHc,this.vQf);P.KeyInputManager.instance.ta(R.a.Ic,this.DTb,this.Qaj)}get Qe(){return H.a.vHc}get CLe(){return this.jQ}get nQh(){return this.CLe}skb(){super.skb();
this.DTb&&(this.Ci&&this.Ci.taskPane.isResizable?(this.DTb.style.display="block",this.zHc.style.display="block"):(this.DTb.style.display="none",this.zHc.style.display="none"))}get lIc(){const Da=this.jQ;return Da&&G.DOMElementExtensions.isVisible(Da)?pa.a.lIc:0}p7f(Da){Da&&(this.animationManager=Da);this.zCj();this.animationManager=Da||new ma(this.vB,this.$);this.animationManager.XPh()}dispose(){this.Nwc&&this.Nwc.rH(this.$A);za.a(this.$)&&za.a(this.$).rH(this.$A);const Da=this.$.da.Ba(52);Da&&Da.rH(this.$A);
this.$.hn(this.ee);V.a.ed([this.Nwc]);this.Nwc=null;super.dispose()}initialize(){this.p7f(null);this.WN(0);this.WN(1);this.WN(2);this.WN(7);this.WN(8);this.WN(9);this.WN(10);this.WN(17);v.EwaSettings.ya(264)&&this.WN(12);v.EwaSettings.ya(418)&&this.WN(15);v.EwaSettings.isChangeGateEnabled("OfficeVSO:4458651_ExternalLinksEnableDisableRibbonButtonDuringSession")?this.WN(13):b.a.DAd(this.$)&&this.WN(13);this.WN(14);this.WN(16);v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPane",
!1)&&this.WN(18);this.mD()}mD(){var Da=0;let zb=0;for(let qb=this.pF.length-1;0<=qb;qb--){const Pa=this.pF[qb].taskPane.Sr(),Nb=this.pF[qb].taskPane;if(this.pF[qb].isVisible=Pa)zb++,(1!==Nb.Ji&&(v.EwaSettings.isChangeGateEnabled("OfficeVSO:4465901_HideCommentsTaskPaneButtonOnClosePane")||7!==Nb.Ji)&&14!==Nb.Ji&&16!==Nb.Ji||Nb.Vu())&&Da++}Da=0<Da;G.DOMElementExtensions.setVisible(this.jQ,Da);this.WYd(Da);G.DOMElementExtensions.setVisible(this.QMa,Da&&this.isCollapsed);G.DOMElementExtensions.setVisible(this.d4a,
Da&&!this.isCollapsed);G.DOMElementExtensions.setVisible(this.nGe,1<zb);this.rJc()}xla(Da,zb){if(this.isCollapsed!==Da){Da||(this.Ing.style.display=d.AFrameworkApplication.sa.Qa.$f?"flex":"block");var qb=this.ocd;this.nN=!this.isCollapsed;var Pa=Da?qb:0;qb=Da?0:qb;this.Ci&&(this.animationManager.F5b(this.vB,Pa,qb,this.Ci.taskPane),this.yUa());Da&&(this.Ing.style.display="none");this.SSh(Da,zb)}}WYd(Da){const zb=this.isVisible!==Da;this.Fg=Da;G.DOMElementExtensions.setVisible(this.domElement,Da);zb&&
(d.AFrameworkApplication.sa.Qa.$f&&G.DOMElementExtensions.toggleCssClass(this.domElement,ya.a.SIh,Da),this.yUa(),this.raiseEvent(Ma.Lkb,new wa(Da,Da),this))}juc(Da){if(Da.Fc===this.d4a&&3!==Da.kc)return!1;this.Mjc(296943390,Da.kc);this.xla(!0,!0);return!0}Buc(Da){if(Da.Fc===this.QMa&&3!==Da.kc)return!1;this.Mjc(-625072140,Da.kc);this.xla(!1,!0);return!0}WJf(Da){return 13===Da.Da.keyCode?(this.Mjc(296943390,Da.kc),this.xla(!0,!0),!0):!1}ELf(Da){return 13===Da.Da.keyCode?(this.Mjc(-625072140,Da.kc),
this.xla(!1,!0),!0):!1}yUa(){let Da=0;this.$.oe&262144&&(Da+=this.lIc,G.DOMElementExtensions.isVisible(this.vB)&&!this.isCollapsed&&(Da+=this.ocd));this.$.yUa(Da)}GPe(Da,zb){const qb=document.createElement("div");qb.classList.add(Da);zb.insertBefore(qb,zb.firstChild);return qb}zCj(){const Da=this.domElement;let zb=document.getElementById(this.$.qc+t.a.X3a);d.AFrameworkApplication.sa.Qa.$f&&(zb=document.getElementById("FarPaneRegion"));Da.parentNode&&Da.parentNode!==zb&&Da.parentNode.removeChild(Da);
zb.appendChild(Da);this.yni()}yni(){const Da=this.vB,zb=this.jQ,qb=this.$.ea;Da.style.right="0";d.AFrameworkApplication.sa.Qa.$f||(Da.style.marginRight=O.HelperMethods.ud(pa.a.lIc));Da.style.bottom=this.$.oe&4&&!d.AFrameworkApplication.sa.Qa.$f?O.HelperMethods.ud(this.$.Zga):"0";this.hQ.style.bottom="0";zb.style.right="0";this.$.$l(this.ee);qb.sJ&&this.ee(null,null)}wBb(Da){const zb=new fb.a(0,0);return Ua.a.kw(zb,this.vB,Da,!1)}JAe(Da){const zb=this.vB.offsetWidth;Da=zb-Da;Da<this.Ci.taskPane.fr?
Da=this.Ci.taskPane.fr:950<Da&&(Da=950);this.Ci.taskPane.nx=Da;const qb=new ma(this.vB,this.$);qb.F5b(this.vB,zb,Da,this.Ci.taskPane);Object(Ea.a)(403,this.Ci.taskPane)||qb.F5b(this.Ci.taskPane.Wc,zb,Da,this.Ci.taskPane);this.$.yUa(this.jQ.offsetWidth+Da);this.$.ACa(D.a.B0("AnimateTaskpaneResize"))}static la(Da,zb){let qb=null;Da.yc&&(qb=Da.yc.vh("ComponentAttach","AttachTaskPanePickerControl"),qb.start());const Pa=ja.q9g(Da.qc),Nb=ja.p9g(Da.qc,zb),Tb=ja.r9g(Da.qc);Pa.appendChild(Tb);Pa.appendChild(Nb);
ja.V3g(Da,Pa);Da=new ja(Pa,Nb,Da,zb);qb&&qb.stop();return Da}static q9g(Da){const zb=document.createElement("div");zb.id=Da+t.a.wHc;return zb}static p9g(Da,zb){const qb=document.createElement("div");qb.id=Da+t.a.ZGf;qb.className=ya.a.eJh;let Pa=String.format(ra,Da+t.a.h_i,Da+t.a.GX);Pa+=String.format(Va,Da+t.a.Ftc,Da+t.a.$Gf);zb.Yh(qb,Pa);d.AFrameworkApplication.sa.Qa.$f&&G.DOMElementExtensions.toggleCssClass(qb,ya.a.LCa,!0);return qb}static r9g(Da){const zb=document.createElement("div");zb.id=Da+
t.a.UHd;zb.className=ya.a.cLh;zb.style.zIndex="100";d.AFrameworkApplication.sa.Qa.$f&&G.DOMElementExtensions.toggleCssClass(zb,ya.a.LCa,!0);return zb}static V3g(Da,zb){(d.AFrameworkApplication.sa.Qa.$f?document.getElementById("FarPaneRegion"):document.getElementById(Da.qc+t.a.X3a)).appendChild(zb)}static lnh(){const Da=new Sa;Da.Kng=t.a.wHc;Da.k3=t.a.ZGf;Da.J3d=t.a.GX;Da.Q4d=t.a.UHd;Da.ypg=t.a.i_i;Da.FLe=ya.a.gJh;Da.I2e=ya.a.iJh;Da.DLe=ya.a.fJh;Da.G2e=ya.a.hJh;Da.ELe=ya.a.l1e;Da.H2e=ya.a.m1e;return Da}}
Object(r.a)(ja,"TaskPanePickerControl",Ma,[]);var lb=a(40),wb=a(727),Ab=a(100),nb=a(149),pb=a(35);a.d(C,"a",function(){return cb});class cb extends c.a{constructor(Da){super();this.$=Da;this.uc()}create(){if(b.a.de())this.t2f(()=>S.la(this.$));else{const Da=Object(Ab.d)(nb.a.resolve(pb.W,{Wa:this.La}));lb.TaskExtensions.za(Da,()=>{this.t2f(()=>ja.la(this.$,Da.result))},this.ka,3)}}static la(Da){Da.da.Ja(50,new cb(Da))}t2f(Da){Da=Object(wb.a)(this.$.da,183,Da);this.$b(Da)}}Object(r.a)(cb,"TaskPaneManagerFactory",
c.a,[])},1236:function(r,C,a){function c(za){const la=new h.StandardDialog;la.Ac=4;za=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,za)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl;la.QT(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,za,J)}r=a(0);var b=a(15),e=a(230),f=a(1369),d=a(6),h=a(147),l=a(88),k=a(911);class u{}u.J6j=864E5;u.UZg=3;u.y0i=144E5;Object(r.a)(u,"AddinConstantsNum",
null,[]);var v=a(745),x=a(825),w=a(859);class m{constructor(za,la,xa,wa=null){this.fa=wa?wa:d.AFrameworkApplication.fa;this.xSc=2;this.z9a=za;this.GQg=la;this.yc=xa}get kza(){return this.xSc}get eik(){return this.GQg}aVd(za){if(this.fa.ra("AgaveSupportsLiveIdSpoofing")){var la=(new Date).getTime();this.z9a(za,this.kza,{["ak0"]:la})}else if(w.a.KVj(za)){la=String.format(d.AFrameworkApplication.sa.Qa.L1+"AddinServiceHandler.ashx?action={0}&app={1}&lc={2}&{3}","laststoreupdate",d.AFrameworkApplication.sa.Qa.li,
this.eik,d.AFrameworkApplication.oj);const xa=d.AFrameworkApplication.qe;let wa=null;this.yc&&(wa=this.yc.Fd("ComponentAttach",x.a[za]+k.a[this.kza]));xa.Sn(la,1,null,null,!0,4,hb=>{this.sej(za,hb.data.Pe);wa&&wa.stop()},hb=>{b.ULS.sendTraceTag(17438153,220,50,"GetLastUpdate request failed with {0}.",hb.data.httpStatus);wa&&wa.stop()},null)}else w.a.Rif(za)?(la=w.a.K7e(za),this.z9a(za,this.kza,{["ak0"]:la})):this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",
!1)&&this.z9a(za,this.kza,null)}sej(za,la){if(la&&""!==la&&(la=Sys.Net.XMLDOM(la))){w.a.MIc(v.a.xze,((new Date).getTime()+u.y0i).toString(),za);let xa=la.getElementsByTagName("update");xa&&xa.length||(xa=la.getElementsByTagName("o:update"));xa&&0<xa.length&&(la=Date.parse(xa[0].firstChild.nodeValue),(w.a.K7e(za)<la||w.a.Rif(za))&&this.z9a(za,this.kza,{["ak0"]:la}))}}}Object(r.a)(m,"AddinCommandsAnonymousAPIInitializer",null,[698]);class t{constructor(za,la,xa){this.xSc=xa;this.z9a=za;this.ti=la}get kza(){return this.xSc}aVd(za){let la=
null;this.ti&&(la=this.ti.Fd("ComponentAttach",x.a[za]+k.a[this.kza]));if(null==this.K_d(za)?0:this.K_d(za)){const xa=(new Date).getTime()-u.UZg*u.J6j;this.z9a(za,this.kza,{["ak0"]:xa})}la&&la.stop()}}Object(r.a)(t,"AddinCommandsInitializerBase",null,[698]);class z extends t{constructor(za,la){super(za,la,5)}K_d(){return!0}}Object(r.a)(z,"AddinCommandsInitializer",t,[]);class y extends t{constructor(za,la){super(za,la,1)}K_d(za){try{const la=v.a.V$e()+za;return Boolean.parse(this.C1h(la)||"false")}catch(la){b.ULS.sendTraceTag(17306844,
220,50,"LocalStorage is not allowed, {0}.",la.toString())}return null}C1h(za){const la=localStorage;return void 0!==la&&null!==la?la.getItem(za):null}}Object(r.a)(y,"AddinCommandsLocalCacheInitializer",t,[]);var D=a(569),H=a(84),F=a(27);class G{constructor(za,la=null){this.yc=za;this.fa=la?la:d.AFrameworkApplication.fa}get appUILocale(){return D.a.KL(d.AFrameworkApplication.lcid).name}Qti(){if(this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)&&this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",
!1)&&this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinHomeTabEntranceEnabled",!1)&&this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableTUIForBEPHomeTab",!1)){var za={};za[v.a.nBh]="TeachingCallout";this.KOd(F.a.Ijb,za)}const la=this.xld();if(la)if(this.fa.ra("OcpsIsEnabled"))H.a.instance.Dc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(xa=>{xa.isFeatureEnabled("ConnectedServices",!0).then(wa=>{for(let hb of la){if(!wa&&0===hb.key)continue;
const Ja=this.i7e(hb.value);Ja&&Ja.aVd(hb.key)}return null})});else for(let xa of la)(za=this.i7e(xa.value))&&za.aVd(xa.key)}bVd(za,la,xa){xa&&xa[v.a.qJa]?(xa[v.a.g5]=za,xa[v.a.f_]=la,this.KOd(F.a.Ypa,xa),w.a.MIc(v.a.qJa,xa[v.a.qJa].toString(),za)):this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&0===za&&(xa={},xa[v.a.g5]=za,xa[v.a.f_]=la,this.KOd(F.a.mH,xa))}i7e(za){let la=null;switch(za){case 1:la=new y(Object(l.a)(this,this.bVd,"retrieveAddinFlagCompleted"),
this.yc);break;case 2:la=new m(Object(l.a)(this,this.bVd,"retrieveAddinFlagCompleted"),this.appUILocale,this.yc,this.fa);break;case 5:la=new z(Object(l.a)(this,this.bVd,"retrieveAddinFlagCompleted"),this.yc)}return la}}Object(r.a)(G,"AddinCommandsInitializerHost",null,[]);var L=a(172),M=a(275),O=a(823),B=a(279),E=a(156),I=a(357),S=a(1);let J;class K extends h.StandardDialog{constructor(za,la){super();this.zce=CommonUIStrings.l_AppsforOfficeDeveloperModeCheckboxLabel;this.vfe=CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrlText;
this.wfe=CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrl;this.kpb=!1;this.Qtb=()=>{this.hide();this.kpb&&c(this.Tha)};this.t2i=()=>{O.a.instance.getItem("optedIntoAddinDeveloperMode")?(O.a.instance.removeItem("optedIntoAddinDeveloperMode"),this.kpb=!1):(O.a.instance.setItem("optedIntoAddinDeveloperMode","true"),this.kpb=!0)};this.Tha=za;J=la}showDialog(za,la){try{this.ef=void 0===this.ef||null===this.ef?B.a.tNb(I.a.E3).toString():this.ef,this.show({["type"]:"StandardDialogProps",["id"]:this.ef,
["dialogIcon"]:3,["headerText"]:za,["titleText"]:la,["resultHandler"]:this.Qtb,["messageAreaLink"]:this.grh(),["permanentDismissCheckbox"]:this.crh(),["renderMicrosoftLogoInHeader"]:!1})}catch(xa){this.WLc(za,la)}}grh(){return{["type"]:"AppLinkProps",["id"]:"WACDialogExtraLink",["text"]:this.vfe,["handler"]:{["href"]:this.wfe,["target"]:"_blank"},["onExecute"]:null}}crh(){return{["type"]:"AppCheckboxProps",["id"]:"WACDialogOptInCheckbox",["label"]:this.zce,["onExecute"]:this.t2i}}WLc(za,la){const xa=
new E.a(!1,!1,!1);xa.Ac=1;xa.ef=B.a.tNb(I.a.E3).toString();xa.Qg=String.format(this.DW(),la,this.wfe,this.vfe,this.zce);xa.initializeAndShow(za,this.JAg,{optInCheckbox:!1})}JAg(za,la){1==za&&la.optInCheckbox&&(O.a.instance.getItem("optedIntoAddinDeveloperMode")?(O.a.instance.removeItem("optedIntoAddinDeveloperMode"),this.kpb=!1):(O.a.instance.setItem("optedIntoAddinDeveloperMode","true"),this.kpb=!0,c(this.Tha)))}DW(){return S.EwaSettings.isChangeGateEnabled("OfficeVSO:7726503_DeveloperModeStyleFix")?
"<div style='height:100px;width:400px;border:none;'><body><p>{0}<a href='{1}'target='_blank'>{2}</a></p><br/><br/><input type='checkbox' id='optInCheckbox'>  {3}</input></body></div>":"<div style=\ufffdheight:100px;width:400px;border:none;\ufffd><body><p>{0}<a href='{1}'target='_blank'>{2}</a></p><br/><br/><input type='checkbox' id='optInCheckbox'>  {3}</input></body></div>"}}Object(r.a)(K,"AppsForOfficeDeveloperModeOptInDialog",h.StandardDialog,[]);var R=a(52),Z=a(40),P=a(91),V=a(18),Ea=a(386);class oa extends G{constructor(za){super(za.yc);
this.Tha=this.YXb=null;this.tHa=new M.a;this.E2f=la=>{1===la&&this.Tha&&this.D2f()};this.$=za;f.a.iDb=f.a.f2e}get appUILocale(){return this.$.xa.UICultureTag}Wqg(){this.Qti();this.Mak()}xld(){const za=new Ea.a;this.$.ea.Dh.get(27)&&(za.ia(0,2),""!==d.AFrameworkApplication.fa.Va("HostInstallAddIns")&&za.ia(16,5));this.$.ea.Dh.get(33)&&za.ia(1,1);S.EwaSettings.ya(52)&&za.ia(8,1);this.$.Xe.get(35)&&za.ia(10,5);return za}KOd(za,la){this.ZDh(()=>{const xa=new P.a(za,0,this.$.Tc,0,null);this.$.Ia.mc(xa,
la)})}ZDh(za){(la=>{la=this.$.da.Ba(la);return!!la&&V.d(la)})(198)?(new L.a,this.$.da.Qb(198,la=>{za(la)})):za(null)}Mak(){this.Tha=d.AFrameworkApplication.fa.Va("DevAddinManifestFileUrl");this.YXb=d.AFrameworkApplication.fa.Va("DevAddinManifestGuid");var za=d.AFrameworkApplication.fa.Va("IsDevAddinTest");if(this.Tha&&this.YXb&&za){za="true"===za;var la=this.tHa.getItem("optedIntoAddinDeveloperMode");const xa=this.tHa.getItem(this.YXb);la||za&&d.AFrameworkApplication.fa.ra("SuppressDeveloperAddinDialogs")?
xa||za&&d.AFrameworkApplication.fa.ra("SuppressDeveloperAddinDialogs")?this.D2f():(za=new h.StandardDialog,za.Ac=4,la=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,this.Tha)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl,za.QT(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,la,this.E2f)):(za=new K(this.Tha,this.E2f),za.Ac=0,za.showDialog(CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeTitle,
CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeMessage))}}D2f(){const za=R.GetServiceTaskFactory.create(this.$.da,106,this.$.ka,1);Z.TaskExtensions.za(za,()=>{za.result.Xf.validateAndCacheNewDevAddinManifest(this.Tha);this.tHa.setItem(this.YXb,"true")},this.$.ka,3)}}Object(r.a)(oa,"AddinCommandsInitService",G,[505]);var ea=a(727);class aa extends e.a{constructor(za){super();this.addinCommandsInitService=null;this.Md=()=>{b.ULS.sendTraceTag(537170701,0,50,`AddinCommandsInitServiceFactory.OnSessionIdChanged: isSessionActive ${this.$.ea.Oc}, isEditMode ${this.$.isEditMode} , showCommandUI [${!!(this.$.oe&
16384)}] `);this.addinCommandsInitService.Wqg();this.$.ea.Vk(this.Md)};this.$=za;this.uc()}create(){this.$.da.Qb(53,()=>{this.$b(Object(ea.a)(this.$.da,202,()=>this.addinCommandsInitService||(this.addinCommandsInitService=new oa(this.$))));this.$.ea.Oc?(b.ULS.sendTraceTag(537170702,0,50,`AddinCommandsInitServiceFactory.Create: calling TryInitializeAddinCommands, isEditMode: [${this.$.isEditMode}], showCommandUI [${!!(this.$.oe&16384)}] `),this.addinCommandsInitService.Wqg()):this.$.ea.Mk(this.Md)})}static la(za){za.da.Ja(201,
new aa(za))}}Object(r.a)(aa,"AddinCommandsInitServiceFactory",e.a,[]);var ia=a(10);a.d(C,"a",function(){return ya});const ya=()=>{ia.a.Fa(aa.la)}},1248:function(r,C,a){r=a(0);var c=a(15),b=a(88),e;(function(O){O[O.generalException=0]="generalException";O[O.invalidArgument=1]="invalidArgument";O[O.notAllowed=2]="notAllowed";O[O.apiNotAvailable=3]="apiNotAvailable";O[O.unresolvedPendingRequest=4]="unresolvedPendingRequest";O[O.timeout=5]="timeout";O[O.adalTimeout=6]="adalTimeout";O[O.userNotSignedIn=
7]="userNotSignedIn";O[O.userAborted=8]="userAborted";O[O.silentSignInFailed=9]="silentSignInFailed";O[O.invalidResourceUrl=10]="invalidResourceUrl";O[O.invalidGrant=11]="invalidGrant";O[O.connectionLost=12]="connectionLost";O[O.clientError=13]="clientError";O[O.serverError=14]="serverError"})(e||(e={}));Object(r.b)("ErrorCodes",e);a(1381);class f{constructor(O,B){this.requestCallback=this.requestParameters=null;this.requestParameters=O;this.requestCallback=B}}Object(r.a)(f,"OutstandingRequest",null,
[]);class d{}d.kZi="AADSTS50058";d.invalidResourceUrl="AADSTS50001";d.fZi="AADSTS65001";d.vZi="AADSTS70011";d.userAborted="13002";d.tkj="Popup Window is null";d.skj="Popup Window closed";d.adalTimeout="Token renewal operation failed due to timeout";d.n8j="tokenRevoked";Object(r.a)(d,"WopiHostErrorType",null,[]);var h=a(6),l=a(428),k=a(583),u=a(43),v=a(1380);class x{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(r.a)(x,"WopiIdentityInfo",
null,[637]);class w{constructor(O,B,E){this.expiration=this.authority=this.accessToken=null;this.accessToken=O;this.authority=B;this.expiration=E}}Object(r.a)(w,"WopiIdentityToken",null,[639]);var m=a(31),t=a(175),z=a(384),y=a(179),D=a(70),H=a(355);class F{constructor(O){this._initialized=!1;this.Udb={};this.FGc={};this.cQ=h.AFrameworkApplication.sa.qF;this.Usd=O}f6a(O){this._initialized||(O.wn(y.a.RWf),O.ql(y.a.RWf,Object(b.a)(this,this.yaj,"onReceivedAccessToken")),this._initialized=!0)}getAccessToken(O,
B,E=null){this.xRa(O,B);return new Promise((I,S)=>{if(this.vvd(B))if(B in this.Udb)S("unresolvedPendingRequest");else{var J=window.setTimeout(()=>{c.ULS.sendTraceTag(37856032,344,10,u.c({["error"]:"Request timeout.",["callerId"]:B}));S("timeout")},12E4);this.gld(O,B,E,(K,R)=>{window.clearTimeout(J);K?I(K):(c.ULS.sendTraceTag(37856033,369,15,u.c({["error"]:e[R]})),S(R))})}else c.ULS.sendTraceTag(37856034,344,10,u.c({["error"]:"Caller is not allowed."})),S("notAllowed")})}getPrimaryIdentityInfo(O){return new Promise((B,
E)=>{this.vvd(O)?this.Tbi((I,S)=>{I?B(I):(c.ULS.sendTraceTag(37856064,369,10,u.c({["error"]:S.toString()})),E(S))}):(c.ULS.sendTraceTag(37856065,344,10,u.c({["error"]:"Caller is not allowed."})),E("notAllowed"))})}getAuthContext(O){return new Promise((B,E)=>{const I=this.getAuthContextSync(O);I?B(I):E("notAllowed")})}getAuthContextSync(O){if(this.vvd(O)){const B=new v.a;B.upn=h.AFrameworkApplication.fa.Va("UserPrincipalName");B.userId=h.AFrameworkApplication.fa.Va("LoggableUserId");B.authority=h.AFrameworkApplication.fa.Va("HostAuthAuthority");
B.tenantId=h.AFrameworkApplication.fa.Va("TenantId");B.isAnonymous=h.AFrameworkApplication.fa.ra("IsAnonymousUser");B.supportsAuthToken=this.Gqi(O);O=h.AFrameworkApplication.fa.Va("HostAuthType");B.authorityType="aad"===O.toLowerCase()?2:"msa"===O.toLowerCase()?1:0;return B}c.ULS.sendTraceTag(40751647,344,10,u.c({["error"]:"Caller is not allowed."}));return null}Gqi(O){const B=l.OAuthManagerSettings.jDb;return m.a.gAa?B&&l.OAuthManagerSettings.Rng?Array.contains(l.OAuthManagerSettings.Rng,O.toLowerCase()):
!1:B}gld(O,B,E,I){var S=[];Array.add(S,Object.assign(new D.a,{name:"CallerId",string:B}));Array.add(S,Object.assign(new D.a,{name:z.a.V1d,string:O.correlationId}));t.a.sendTelemetryEvent(Object.assign(new H.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:S}));S=k.a.create().toString();const J="getAccessToken_"+S,K=this.cQ.Fd("ComponentAttach",J);this.FGc[J]=K;const R={};R[z.a.W1d]=S;R[z.a.t1j]=O.resource;R[z.a.u1j]=O.scope;R[z.a.Rkg]=h.AFrameworkApplication.fa.Va("HostAuthType");
R[z.a.x1j]=h.AFrameworkApplication.fa.Va("UserPrincipalName");R[z.a.v1j]=O.silentLogin;R[z.a.q1j]=O.options;R[z.a.V1d]=O.correlationId;R[z.a.r1j]=B;E&&(R[z.a.addinName]=E.AddinName,R[z.a.p1j]=E.AddinTrustId);this.Usd.execute(Z=>{this.f6a(Z);Z.sendMessage(y.a.getAuthToken,R)});this.Udb[S]=new f(O,I)}Tbi(O){const B=h.AFrameworkApplication.fa.Va("UserName"),E=h.AFrameworkApplication.fa.Va("UserPrincipalName"),I=h.AFrameworkApplication.fa.Va("LoggableUserIdSpace"),S=new x;S.email=E;S.displayName=B;switch(I){case "OrgIdPuid":S.authority=
"AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":S.authority="MicrosoftAccount";break;default:S.authority=I}O(S,null)}yaj(O){let B=null;try{let I=O.Values[z.a.W1d];const S=O.Values[z.a.o1j],J=O.Values[z.a.Rkg],K=O.Values[z.a.w1j];let R=null,Z=null;const P=this.Udb[I];if("undefined"!==typeof P&&P){var E=[];Array.add(E,Object.assign(new D.a,{name:z.a.V1d,string:P.requestParameters.correlationId}));t.a.sendTelemetryEvent(Object.assign(new H.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",
dataFields:E}));B=P.requestCallback;delete this.Udb[I];"undefined"!==typeof S&&S&&S.length?Z=new w(S,J,K):R=e[this.sUi(O)];E="getAccessToken_"+I;E in this.FGc&&(this.FGc[E].stop(),delete this.FGc[E]);B(Z,R)}else c.ULS.sendTraceTag(37856066,344,10,u.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:I}))}catch(I){O=O.Values[z.a.W1d],O in this.Udb&&delete this.Udb[O],this.mrc(),c.ULS.sendTraceTag(37856067,344,10,u.c({["error"]:I.message,["stack"]:I.stack})),B&&B(null,"generalException")}}vvd(O){var B=
h.AFrameworkApplication.lji();O=O.toLowerCase();for(const E of B)if(O===E.toLowerCase())return!0;B=l.OAuthManagerSettings.b4c;for(let E in B)if(O===B[E].toLowerCase())return!0;return!1}sUi(O){O=O.Values[z.a.s1j];this.mrc();c.ULS.sendTraceTag(39068821,344,15,u.c({["error"]:O}));return O?-1<O.indexOf(d.kZi)?9:-1<O.indexOf(d.tkj)||-1<O.indexOf(d.skj)?12:-1<O.indexOf(d.invalidResourceUrl)?10:-1<O.indexOf(d.userAborted)?8:-1<O.indexOf(d.vZi)||-1<O.indexOf(d.fZi)||O===d.n8j?11:-1<O.indexOf(d.adalTimeout)?
6:0:13}xRa(O,B){O=this.btj(O.resource);c.ULS.sendTraceTag(39921882,344,50,u.c({["callerId"]:B,["resource"]:O}))}mrc(){c.ULS.sendTraceTag(39068822,344,50,u.c({["userAgent"]:window.navigator.userAgent}))}btj(O){return(O?O:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(r.a)(F,"WopiIdentityManager",null,[622]);var G=a(261);class L{constructor(){this.Nb=null}get name(){return"Common.App.WopiIdentity"}Oi(O){this.Nb=O;O.register(F,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").gd().od(()=>
new F(O.Dc("Postmessage.IHostPostmessenger")))}init(){h.AFrameworkApplication.fa&&h.AFrameworkApplication.fa.Rv(Object(b.a)(this,this.KC,"onFullAppSettingsReady"))}KC(){try{this.Nb.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(O){c.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+O)}}dispose(){}static main(){G.a.instance.wj(new L)}}Object(r.a)(L,"WopiIdentityPackage",null,[4,5]);a.d(C,"a",function(){return M});const M=()=>{Type.registerNamespace("Common.App.WopiIdentity");
L.main()}},1257:function(r,C,a){r=a(0);var c=a(88),b=a(15),e=a(140),f=a(41);class d{constructor(D){this.Nia=this.Hia=this.Ria=this.Qia=null;this.Oge=this.xee=this.Pge=this.mke=this.Iy=this.oN=!1;this.RXc=this.Dke=null;this.uke=0;this.Ra=this.Ake=null;this.b4=D;this.Dy=3;this.YZa=!0}initialize(D,H,F){this.Qia=this.dpd(D,H);this.Ria=CommonUIStrings.l_SavingStatus;this.Hia=CommonUIStrings.l_ReadOnlyStatus;this.Nia=CommonUIStrings.l_ReviewModeStatus;this.b4&&this.b4.execute(G=>{G.P2c(Object(c.a)(this,
this.ZUb,"updateToSavingStatus"))});this.Iy=!0;this.Ra=F;this.xee=this.Ra.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisplayHeaderSaveStatusAsIcons",!1);return!0}uha(D,H){this.oN=D;this.Dy=H;this.bU(this.YZa)}bU(D){!this.YZa&&D&&(this.Ake=new Date);this.YZa=D;this.Oge=!1;D=null;3===this.Dy&&(D=this.YZa?this.Qia:this.Ria);this.Oyh(D)}dpd(D,H){return D?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):H&&H.length?String.format(CommonUIStrings.l_SavedToStatus,H):
CommonUIStrings.l_SavedStatus}ZUb(){this.bU(!1)}g$h(){switch(this.Dy){case 1:return this.Hia;case 2:return this.Nia;default:return null}}getMode(){if(3!==this.Dy)switch(this.Dy){case 1:return"ReadOnly";case 2:return"ReviewOnly";default:return null}return this.Oge?"FailedToSave":this.YZa?"Saved":"Saving"}oBi(D){return this.mke===this.oN&&this.uke===this.Dy&&this.Dke===D}aed(D){appChrome.getHeaderApi().then(H=>{H.updateDocumentTitleStatus(this.oN,D,this.g$h(),this.Ake,this.YZa,this.xee?H.getHeaderSaveStatusIconProps(this.getMode()):
null);this.Pge=!0;return null});this.RXc=null}Oyh(D){this.Iy&&e.c()&&!this.oBi(D)&&(!this.Pge&&this.Ra.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",!1)?this.aed(D):f.a.XTd()?(this.RXc&&b.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.RXc=window.requestIdleCallback(()=>{this.aed(D)})):window.requestAnimationFrame(()=>{this.aed(D)}),this.mke=this.oN,this.Dke=D,this.uke=this.Dy)}}Object(r.a)(d,"ReactSaveStatusUIHandler",
null,[449]);var h=a(179);class l{constructor(D,H){this.Mt=null;this.Qia=CommonUIStrings.l_SavedStatus;this.Ria=CommonUIStrings.l_SavingStatus;this.Hia=CommonUIStrings.l_ReadOnlyStatus;this.Nia=CommonUIStrings.l_ReviewModeStatus;this.fZb=H;this.b4=D;this.Dy=3;this.eua=!0}fv(){this.b4&&this.b4.execute(D=>{D.P2c(Object(c.a)(this,this.ZUb,"updateToSavingStatus"))});this.fZb.execute(D=>{this.Mt=D})}uha(D,H){this.Dy=H;3===H?this.bU(this.eua):2===H?this.c6d(this.Nia):this.c6d(this.Hia)}ZUb(){this.bU(!1)}bU(D){this.eua=
D;this.c6d(this.eua?this.Qia:this.Ria)}c6d(D){this.Mt&&this.Mt.sendMessage(h.a.gbk,this.pjh(D))}pjh(D){const H={};H.StatusText=D;return H}}Object(r.a)(l,"SaveStatusPostMessageHandler",null,[449]);var k=a(96),u=a(133),v=a(60);class x{constructor(D,H,F,G){this.Nia=this.Hia=this.Ria=this.Qia=null;this.wHa=0;this.MF=this.FYc=this.IFa=this.dNc=this.wIa=null;this.Ee=D;this.Haa=H;this.b4=F;this.gk=G;this.Fie=!0;this.oN=!1;this.Dy=3;this.eua=!0}initialize(D,H){if(!this.Ee)return!1;this.Qia=this.dpd(D,H);
this.Ria=CommonUIStrings.l_SavingStatus;this.Hia=CommonUIStrings.l_ReadOnlyStatus;this.Nia=CommonUIStrings.l_ReviewModeStatus;this.fv();return!0}dpd(D,H){return D?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):H&&H.length?String.format(CommonUIStrings.l_SavedToStatus,H):CommonUIStrings.l_SavedStatus}fv(){this.Haa&&this.Haa.execute(D=>{D.GYg(Object(c.a)(this,this.NQe,"createStatusAndModeElements"));D.zYg(Object(c.a)(this,this.rYj,"showHideSaveStatusElement"));D.I8j&&
this.NQe(null,null)});this.b4&&this.b4.execute(D=>{D.P2c(Object(c.a)(this,this.ZUb,"updateToSavingStatus"))})}px(){this.MF&&this.Ee&&this.Ee.LH(this.MF)}rYj(D,H){this.uha("true"===H,this.Dy)}uha(D,H){this.oN=D;this.Dy=H;this.dNc&&(this.dNc.style.display=this.oN||3===this.Dy||!this.wIa?"none":"");this.IFa&&(this.IFa.style.display=this.oN||3===this.Dy?"none":"",this.IFa.innerText=1===this.Dy?this.Hia:this.Nia,this.IFa.title=1===this.Dy?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);
this.FYc&&(this.FYc.style.display=this.oN||1===this.Dy||!this.wIa&&!this.IFa?"none":"");this.MF&&(this.MF.style.display=this.oN||1===this.Dy?"none":"",this.bU(this.eua),this.MF.title=CommonUIStrings.l_SaveStatusTooltip)}NQe(D,H){D=document.getElementById(k.CuiHelper.Yjf);H&&H.zlk||!D||""===this.Qia||""===this.Ria||""===this.Hia||""===this.Nia||(this.wIa=document.getElementById(k.CuiHelper.h7b),this.dNc=k.CuiHelper.kwa(D,"BreadcrumbAppModeDash","-",null,!1),this.IFa=k.CuiHelper.kwa(D,"BreadcrumbAppModeStatus",
1===this.Dy?this.Hia:this.Nia,null,!1),this.wtg(this.IFa),this.FYc=k.CuiHelper.kwa(D,"BreadcrumbSaveStatusDash","-",null,!1),this.MF=k.CuiHelper.kwa(D,"BreadcrumbSaveStatus",this.Qia,null,!1),this.wtg(this.MF),this.uha(this.oN,this.Dy))}ZUb(){this.bU(!1)}bU(D){this.eua=D;this.Agk(this.eua?this.Qia:this.Ria)}Agk(D){!this.MF||3!==this.Dy&&2!==this.Dy||(this.Fie&&!this.eua?(this.wHa=this.MF.offsetWidth<this.wHa?this.wHa:this.MF.offsetWidth,this.pdk(this.Ria),this.Fie=!1):this.MF.innerText=D)}wtg(D){D.style.direction=
this.gk?"rtl":"ltr";D.style.width="auto";D.style.textAlign=this.gk?"right":"left";D.style.display=this.oN?"none":"";D.setAttribute("Unselectable","on")}pdk(D){this.MF&&(this.MF.style.width="",this.MF.innerText=D,this.wHa=this.MF.offsetWidth<this.wHa?this.wHa:this.MF.offsetWidth,D=u.a.DA(this.MF),this.MF.style.width=this.wHa-v.a.cF(D.paddingLeft)-v.a.cF(D.paddingRight)+1+"px")}}Object(r.a)(x,"SaveStatusUIHandler",null,[449]);var w=a(6),m=a(99);class t{constructor(){this.GYc=this.DXc=this.fqb=this.Nb=
null}get name(){return"Common.App.SaveStatus"}Oi(D){this.Nb=D;w.AFrameworkApplication.fa.ra("PostMessageEmbedded")&&w.AFrameworkApplication.hideHeaderEmbedded?this.Nb.register(l,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").gd().od(()=>new l(this.Nb.Dc("Common.App.HostNotification.EditNotificationEventSource"),this.Nb.Dc("Postmessage.IHostPostmessenger"))):w.AFrameworkApplication.sa.Qa.hvf||(w.AFrameworkApplication.sa.Qa.Uv?this.Nb.register(d,
"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").gd().od(()=>new d(this.Nb.Dc("Common.App.HostNotification.EditNotificationEventSource"))):this.Nb.register(x,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").gd().od(()=>new x(m.EventHandlerManager.instance,this.Nb.Dc("Common.App.Header.HeaderEventSource"),this.Nb.Dc("Common.App.HostNotification.EditNotificationEventSource"),w.AFrameworkApplication.isRtl)))}init(){w.AFrameworkApplication.fa.Rv(Object(c.a)(this,
this.KC,"onFullAppSettingsReady"))}KC(){const D=w.AFrameworkApplication.fa,H=!!w.AFrameworkApplication.sa.Qa&&4===w.AFrameworkApplication.sa.Qa.li;if(D.ra("WordEditorAutoSaveImprovementIsEnabled")||D.ra("PptEditorSaveStatusInHeaderEnabled")||H&&D.ra("SimplifiedReactRibbonUxIsEnabled")||D.ra("ExcelSaveStatusInHeaderEnabled")||D.ra("VisioSaveStatusInHeaderEnabled"))w.AFrameworkApplication.fa.ra("PostMessageEmbedded")&&w.AFrameworkApplication.hideHeaderEmbedded?(this.GYc=this.Nb.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&
this.GYc.fv():w.AFrameworkApplication.sa.Qa.hvf||w.AFrameworkApplication.hideHeader||(w.AFrameworkApplication.sa.Qa.Uv?(this.DXc=this.Nb.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.DXc.initialize(D.ra("IsSkyDrive"),D.Va("HostNameToIncludeInSavedStatus"),w.AFrameworkApplication.fa):(this.fqb=this.Nb.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&this.fqb.initialize(D.ra("IsSkyDrive"),D.Va("HostNameToIncludeInSavedStatus")))}dispose(){this.fqb&&this.fqb.px()}}Object(r.a)(t,
"PackageManager",null,[4,5]);var z=a(261);a.d(C,"a",function(){return y});const y=()=>{Type.registerNamespace("Common.App.SaveStatus");z.a.instance.wj(new t)}},1266:function(r,C,a){var c=a(10);r=a(0);var b=a(15),e=a(230),f=a(92),d=a(6),h=a(198),l=a(9),k=a(42),u=a(936),v=a(234),x=a(59),w=a(478);class m extends Sys.EventArgs{constructor(){super()}}Object(r.a)(m,"NumberFormatsUpdatedEventArgs",Sys.EventArgs,[]);var t=a(51),z=a(48);a(38);var y=a(34),D=a(1),H=a(631);a(23);var F=a(248),G=a(19);a(178);class L{constructor(S){this.data=
S}}Object(r.a)(L,"NumberFormatDataHolder",null,[]);var M=a(188);class O extends k.a{constructor(S,J){super();this.GBd=l.a.Ye;this.c7c=null;this.Pkb=this.iqc=!1;this.eIf=(K,R)=>{var Z;(K=G.h(this.$))&&(R=null!==(Z=null===R||void 0===R?void 0:R.cell)&&void 0!==Z?Z:K.tc(null))&&this.Cra(R.cell.yi,!0)};this.a6i=K=>{this.isActive()&&(y.a.Iq(K.Errors)||!K.Result?(K=K.Errors?K.Errors.map(R=>JSON.stringify(R)).join(","):"None",b.ULS.sendTraceTag(537155726,0,50,`GetCategoryFromServer failed, ignoring - server errors: ${K}`)):
(K=K.Result,b.ULS.sendTraceTag(537155725,0,50,`Updating number format category cache, format index = ${K.Index}, category = ${K.Category}`),this.lPj(K.Index,K.Category),this.raiseEvent(O.S7c,new u.a(K.Index,K.Category),this)))};this.refresh=()=>{b.ULS.sendTraceTag(537155722,0,50,"InstantaneousSupportInformationManager.Refresh: start refresh");this.c8b();this.isActive()&&this.ea.Rc.allowEdits&&(this.Pkb||this.Do&&!(this.ea.eRa>this.GBd)?this.jLc():(b.ULS.sendTraceTag(537155721,0,50,"InstantaneousSupportInformationManager.Refresh: getting instantaneous support information."),
this.Pnd=w.a(this.$.qa.va,this.Do?this.Do.Digest:"",this.J6i,this.I6i,null,null)),b.ULS.sendTraceTag(537155720,0,50,"InstantaneousSupportInformationManager.Refresh: getting functions info."),this.paf())};this.EMf=K=>{b.ULS.sendTraceTag(537155716,0,50,`InstantaneousSupportInformationManager.OnGetFunctionListFailed failed, status = ${K.data.status}, HTTP status = ${K.data.httpStatus}.`);this.UNa=null};this.W1=()=>{this.Pkb=!1;this.ea.gF(this.W1);this.$Ua(this.iqc?O.a_d:O.xHd)};this.Md=(K,R)=>{b.ULS.sendTraceTag(537155715,
0,50,"InstantaneousSupportInformationManager.OnSessionIdChanged called");v.a(R)&&this.$Ua(O.a_d)};this.rg=()=>{b.ULS.sendTraceTag(537155714,0,50,"InstantaneousSupportInformationManager.OnWorkbookMetadataChanged called");3!==this.$.workbookContext.CalcMode&&this.JHd(0===this.$.workbookContext.CalcMode)};this.ee=()=>{b.ULS.sendTraceTag(537155713,0,50,"InstantaneousSupportInformationManager.OnWorkbookOpened called");this.$Ua(O.a_d);D.EwaSettings.ya(269)&&3!==this.$.workbookContext.CalcMode&&this.JHd(0===
this.$.workbookContext.CalcMode)};this.B6i=(K,R,Z)=>{b.ULS.sendTraceTag(537155712,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess called.");this.UNa=null;this.isActive()?K.StateId===l.a.Ye?(b.ULS.sendTraceTag(537155682,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: no session, waiting for session."),this.jLc()):!K.Result||this.xZ&&this.xZ.length?this.$Ua(O.xHd):this.oQf(K,R,Z):b.ULS.sendTraceTag(537155683,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: manager is inactive, skipping.")};
this.oQf=K=>{this.xZ=K.Result;b.ULS.sendTraceTag(537155681,0,50,`InstantaneousSupportInformationManager.OnGetFunctionListSuccess refreshing functions info list, returned ${this.xZ?this.xZ.length:-1} functions.`);K=!1;if(this.xZ){for(const R of this.xZ)R&&(this.D6e[R.NameUI.toLocaleUpperCase()]=R.FunctionIndex.toString(),R.NameUI!==R.NameDataStrings&&(this.D6e[R.NameDataStrings.toLocaleUpperCase()]=R.FunctionIndex.toString(),K=!0),this.mXh.ia(R.FunctionIndex,R.NameUI));this.raiseEvent(O.Hkd,Sys.EventArgs.Empty,
this)}K&&b.ULS.sendTraceTag(537155680,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess NameDataStrings functions names were used.")};this.J6i=K=>{if(this.isActive())if(b.ULS.shipAssertTag(537155679,0,!!this.$,"null ewaControl"),this.iqc=!1,this.GBd=K.StateId,this.GBd===l.a.Ye)this.iqc=!0,this.jLc();else{if(K.Result){var R=this.Do;this.Do=K.Result;b.ULS.sendTraceTag(537155678,0,50,`InstantaneousSupportInformation updated, new result digest: ${this.Do.Digest}.`);K=[];if(R)K=O.j$h(R.NumberFormats,
this.Do.NumberFormats);else for(R=0;R<this.Do.NumberFormats.length;R++)this.Jtc.ia(R,this.Do.NumberFormats[R].NumberFormatCategory);for(const Z of K)this.Jtc.ia(Z,this.Do.NumberFormats[Z].NumberFormatCategory);this.raiseEvent(O.cId,new m(K),this);this.raiseEvent(O.Kzf)}this.$Ua(O.xHd)}};this.I6i=K=>{this.isActive()&&(10===K.data.status?b.ULS.sendTraceTag(537155677,0,50,"Instantaneous support information request cancelled."):(b.ULS.sendTraceTag(21311555,0,10,`Failed to update instantaneous support information, status = ${K.data.status}, HTTP status = ${K.data.httpStatus}.`),
this.iqc=!0,this.jLc()))};b.ULS.sendTraceTag(537155737,0,50,"InstantaneousSupportInformationManager ctor start");this.ea=S;this.$=J;this.Do=this.UNa=this.Pnd=this.NNb=null;this.Jtc=new M.a;this.zAb=new M.a;this.xZ=[];this.mXh=new M.a;this.D6e={};this.ea.Mk(this.Md);this.$.$l(this.ee);G.h(this.$).ga.b5(this.eIf);D.EwaSettings.ya(269)&&this.ea.wv(this.rg);this.$Ua(O.Ylf);b.ULS.sendTraceTag(537155736,0,50,"InstantaneousSupportInformationManager ctor end")}Jye(S){this.addHandler(O.cId,S)}JSd(S){this.removeHandler(O.cId,
S)}vWg(S){this.addHandler(O.S7c,S)}Nxj(S){this.removeHandler(O.S7c,S)}oye(S){this.addHandler(O.Hkd,S)}wSd(S){this.removeHandler(O.Hkd,S)}$Xg(S){this.addHandler(O.Kzf,S)}get Ef(){return this.Do?this.Do.LocaleInformation:null}get sBa(){return this.Do?this.Do.NumberFormats:[]}get ema(){this.xZ&&this.xZ.length||this.paf();return this.xZ}get Lwi(){return this.Do&&void 0!==this.Do.InstantaneousCalcWebWorkerPrecisionSamplingRate&&null!==this.Do.InstantaneousCalcWebWorkerPrecisionSamplingRate?this.Do.InstantaneousCalcWebWorkerPrecisionSamplingRate:
O.fvh}get Owi(){return this.Do&&void 0!==this.Do.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate&&null!==this.Do.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate?this.Do.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate:O.jvh}get Nwi(){return this.Do&&void 0!==this.Do.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate&&null!==this.Do.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate?this.Do.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate:O.ivh}get Mwi(){return this.Do&&
void 0!==this.Do.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate&&null!==this.Do.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate?this.Do.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate:O.hvh}get Vud(){return this.Do?this.Do.InstantaneousCalcWebWorkerRenderingTimeLimitInMs:O.gvh}get Qlc(){return null!==this.c7c?this.c7c:this.Do?this.Do.InstantaneousCalcManualMode:!1}kak(S){let J;if(!S)return{returnValue:!0,category:"General"};J="";if(!({category:S}=this.Cra(S,!1)).returnValue)return{returnValue:!1,
category:J};J=this.Gkh(S);return{returnValue:!0,category:J}}Gkh(S){let J="";switch(S){case 0:J="General";break;case 1:J="Number";break;case 2:J="Currency";break;case 3:J="Accounting";break;case 4:J="Date";break;case 5:J="Time";break;case 6:J="Percentage";break;case 7:J="Fraction";break;case 8:J="Scientific";break;case 9:J="Text";break;case 10:J="Special";break;case 11:J="Custom"}return J}Cra(S,J){let K,R=({value:K}=this.Jtc.Ad(S,0)).returnValue;!R&&0<S&&this.$&&(b.ULS.sendTraceTag(537155735,0,50,
`InstantaneousSupportInformationManager.TryGetNumberFormatCategory: failed to get category from numberFormatIndexToCategoryCache ${S}`),this.W1h(S),J&&(K=this.V1h(S),R=!0),H.a(S,this.$.sF)&&(K=6));return{returnValue:R,category:K}}FCi(S){let J=0;if(({category:J}=this.Cra(S,!0)).returnValue)return 6===J;b.ULS.sendTraceTag(537155733,0,50,`InstantaneousSupportInformationManager.IsFormatInPercentageCategory: failed to get category from format index ${S}`);return!1}NVh(S){b.ULS.sendTraceTag(537155730,0,
50,"InstantaneousSupportInformationManager.ForceRefreshFunctionInfo: Forcing refresh of functions");this.UNa=x.o(this.$.qa.va,{FilterType:0},F.b(this.oQf,S),this.EMf,null,null,null)}U5e(){this.$Ua(O.Ylf)}JHd(S){this.c7c=S}W1h(S){if(this.zAb&&this.$){var J;if(!({value:J}=this.zAb.Ad(S)).returnValue||J.isCompleted)b.ULS.sendTraceTag(537155728,0,50,`Getting number format category for format index: ${S}`),(J=w.c(this.$.qa.va,S,this.a6i,null,null,null))&&this.zAb.ia(S,J)}else b.ULS.sendTraceTag(537155729,
0,15,"GetCategoryFromServerAsync called on disposed InstantaneousSupportInformationManager instance, skipping")}V1h(S){return 1<=S&&8>=S?1:9<=S&&12>=S?2:13===S||14===S?6:15===S?8:17===S|18===S?7:19===S?4:16===S||20<=S&&29>=S||31===S?11:30===S?9:32<=S&&35>=S?3:0}isActive(){const S=void 0===this.ea||null===this.ea,J=!S&&this.ea.Oc;b.ULS.sendTraceTag(537155727,0,50,`InstantaneousSupportInformationManager.IsActive: instantaneous support information manager active:${J} - sessionStateManager IsNullOrUndefined: ${S}`);
return J}lPj(S,J){this.Jtc.ia(S,J)}dispose(){f.a.Ka(this.NNb);this.NNb=null;this.c8b();for(let S of this.zAb){const J=S.value;J&&!J.isCompleted&&d.AFrameworkApplication.qe.lw(J.yv)}this.zAb=null;this.ea&&(this.ea.Vk(this.Md),this.Pkb&&this.ea.gF(this.W1),this.Pkb=!1,this.ea.hx(this.rg));this.ea=null;this.$&&G.h(this.$)&&G.h(this.$).ga&&(G.h(this.$).ga.hga(this.eIf),this.$.hn(this.ee));this.$=null;super.dispose()}isFeatureEnabled(S){try{switch(S){case "LocaleLongDateFormat":return D.EwaSettings.ya(184);
case "GetLocaleDayNames":return D.EwaSettings.ya(185);case "CalculateTextWidthIgnoreLetterSpacing":return D.EwaSettings.ya(255);case "OfficeVSO:3657744_CalcFixForDateFormat":return D.EwaSettings.isChangeGateEnabled("OfficeVSO:3657744_CalcFixForDateFormat");case "OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero":return D.EwaSettings.isChangeGateEnabled("OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero");case "CalcAutocompleteExperiment":return D.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled",
!1);case "CalcWebWorker":return!0;case "CalcPreventSpillingHack":return D.EwaSettings.isChangeGateEnabled("OfficeVSO:7504597_calcPreventSpillingHack");case "CalcDynamicArrayOperators":return D.EwaSettings.ya(101);default:return S.startsWith("OfficeVSO:")?D.EwaSettings.isChangeGateEnabled(S):!1}}catch(J){return b.ULS.sendTraceTag(537155724,0,15,`InstantaneousSupportInformation.IsFeatureEnabled(${S}): feature parsing failed, returning false. Exception: ${J.toString()}.`),!1}}$Ua(S){this.isActive()&&
this.ea.Rc.allowEdits?(f.a.Ka(this.NNb),this.NNb=null,this.NNb=t.a.instance.create(this.refresh,S,z.a.Pwi)):b.ULS.sendTraceTag(537155723,0,50,`InstantaneousSupportInformationManager.ScheduleRefresh: won't schedule refresh. Edit permission: AllowEdits ${void 0!==this.ea&&null!==this.ea&&void 0!==this.ea.Rc&&null!==this.ea.Rc?this.ea.Rc.allowEdits:!1}, IsEditMode ${void 0===this.ea||null===this.ea?!1:this.$.ea.isEditMode}`)}paf(){b.ULS.sendTraceTag(537155719,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync called.");
this.UNa?b.ULS.sendTraceTag(537155718,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync already running, skipping."):this.isActive()?this.xZ&&this.xZ.length||(this.UNa=x.o(this.$.qa.va,{FilterType:0},this.B6i,this.EMf,null,null,null)):b.ULS.sendTraceTag(537155717,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync session is not yet active, skipping.")}jLc(){this.Pkb||(this.Pkb=!0,this.ea.MD(this.W1))}c8b(){this.lw(this.Pnd);this.lw(this.UNa);this.UNa=this.Pnd=null}lw(S){S&&
!S.isCompleted&&this.$.qa.va.Njb(S.yv)}static j$h(S,J){if(!S||!S.length)return[];if(!J||!J.length){J=Array(S.length);for(var K=0;K<S.length;++K)J[K]=S[K].IfmtIndex;return J}K=new M.a;for(const R of S)K.ia(R.IfmtIndex,new L(R));S=new h.a;for(const R of J){let Z;({value:Z}=K.Ad(R.IfmtIndex)).returnValue&&Z.data.FormatString===R.FormatString||S.add(R.IfmtIndex)}return S.toArray()}}O.cId="isim0";O.S7c="isim1";O.Hkd="isim2";O.Kzf="isim3";O.Ylf=100;O.a_d=1E3;O.xHd=3E5;O.fvh=.001;O.jvh=.1;O.ivh=.2;O.hvh=
.001;O.gvh=50;Object(r.a)(O,"InstantaneousSupportInformationManager",k.a,[624,2]);var B=a(727);class E extends e.a{constructor(S){super();this.$=S;this.uc()}create(){if(this.$){b.ULS.sendTraceTag(537155672,0,50,"InstantaneousSupportInformationManagerFactory.Create: Start loading script");var S=Object(B.a)(this.$.da,268,()=>new O(this.$.ea,this.$));this.$b(S)}}static la(S){if(!S)throw Error.argumentNull("ewaControl");S.da.Ja(246,new E(S))}}Object(r.a)(E,"InstantaneousSupportInformationManagerFactory",
e.a,[]);a.d(C,"a",function(){return I});const I=()=>{c.a.Fa(E.la)}},1267:function(r,C,a){r=a(0);var c=a(15),b=a(88),e=a(112),f=a(111),d=a(27);class h{constructor(F,G,L){this.oIa=null;this.Me=F;this.Na=G;this.$fe=L.create()}W2f(){this.oIa?c.ULS.sendTraceTag(23674911,207,50,"The current task is not null, re-use it."):(c.ULS.sendTraceTag(23674910,207,50,"The current sho pane task is null, create new one."),this.oIa=new e.a(2,1,3E4,Object(b.a)(this,this.lSb,"showFloatPane"),67),this.Me.wg(this.oIa))}lSb(){this.oIa=
null;c.ULS.sendTraceTag(23674912,207,50,"The float pane is shown after the task is executed.");this.$fe.display()}$Ta(){this.Na.Hc(d.a.lSb,f.a.frame,Object(b.a)(this,this.cYj,"showFloatPaneHandler"))}cYj(F,G,L,M,O){return F!==d.a.lSb?2:1===L?32:2===L&&O?(c.ULS.sendTraceTag(23674913,207,50,"The application wants to show or hide float pane with argument {0}.",O),O?this.W2f():(this.oIa?(c.ULS.sendTraceTag(23674914,207,50,"Hide float pane via removing show task!"),this.Me.jq(this.oIa)):(c.ULS.sendTraceTag(23674915,
207,50,"Hide float pane immediately!"),this.$fe.remove(null)),this.oIa=null),32):8}}Object(r.a)(h,"FloatPaneActor",null,[517]);var l=a(131),k=a(166),u=a(14),v=a(49),x=a(93);class w{constructor(F,G,L,M,O){this.QUc=this.Cnb=this.W0b=this.Jia=this.TQ=this.hs=this.NNc=this.pN=this.qpb=this.zob=this.Aob=this.PQc=null;this.Me=G;this.Ra=F;this.yj=L;this.Nb=O;this.N3=M}G4a(){this.pN=document.createElement("div");this.pN.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeIn");this.pN.style.width=
this.TQ.width+"px";(this.QUc=this.qai(this.N3))?(this.Jia=document.createElement("a"),this.Jia.setAttribute(x.a.te,x.a.Ds),this.yj.ta(u.a.click,this.Jia,Object(b.a)(this,this.kQf,"onRedirectClick")),this.Jia.href=this.QUc,this.Jia.target="_blank",this.Jia.appendChild(this.TQ),this.pN.appendChild(this.Jia)):this.pN.appendChild(this.TQ);this.hs=document.createElement("a");this.hs.setAttribute(x.a.te,x.a.Au);this.hs.className="StandardButton WACFloatPaneCloseButton";this.hs.title=CommonUIStrings.l_Close;
this.hs.tabIndex=-1;this.NNc=k.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","StandardButtonImage clip16x16 StandardButtonImageNoText",!0,null);this.NNc.setAttribute(x.a.te,x.a.Ds);this.hs.appendChild(this.NNc);this.yj.ta(u.a.click,this.hs,Object(b.a)(this,this.onClose,"onClose"));this.pN.appendChild(this.hs);this.qpb.appendChild(this.pN)}i8h(F){const G=this.Ra.ra("O365PromotionHasStarted");switch(F){case 2:return l.a.Xva(String.format("adppt{0}.png",G?"sale":""));case 1:return l.a.Xva(String.format("adxls{0}.png",
G?"sale":""));case 3:return l.a.Xva(String.format("addoc{0}.png",G?"sale":""))}return null}qai(F){const G=this.Ra.Va("O365AdPaneRedirectedURL");switch(F){case 1:return String.format(G,"Excel");case 2:return String.format(G,"PowerPoint");case 3:return String.format(G,"Word")}return null}hide(F=null){this.Cnb=null;this.pN&&!this.W0b&&(F?c.ULS.sendTraceTag(23674904,207,50,"The float pane is closed automatically."):c.ULS.sendTraceTag(23674903,207,50,"User clicks button to close the float pane."),this.pN.className=
String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeOut"),this.pN.style.height="0px",this.W0b=new e.a(2,1,1E3,Object(b.a)(this,this.remove,"remove"),67),this.Me.wg(this.W0b))}remove(){this.pN&&this.qpb&&(this.Jia&&this.yj.Aa(u.a.click,this.Jia,Object(b.a)(this,this.kQf,"onRedirectClick")),this.yj.Aa(u.a.click,this.hs,Object(b.a)(this,this.onClose,"onClose")),this.qpb.removeChild(this.pN),this.pN=null);this.W0b=null}display(){if(this.PQc=this.Nb.nh("Common.IFloatPaneContainer"))if(this.qpb=this.PQc.container){var F=
this.i8h(this.N3);F?(c.ULS.sendTraceTag(23674908,207,50,"Begin downloading image from server: {0}.",F),this.TQ=document.createElement("img"),this.TQ.className="WACFloatPaneImage",this.Aob=Object(b.a)(this,this.p9i,"onLoadImageFinish"),v.a.addHandler(this.TQ,u.a.load,this.Aob),this.zob=Object(b.a)(this,this.o9i,"onLoadImageError"),v.a.addHandler(this.TQ,u.a.error,this.zob),this.TQ.src=F):c.ULS.sendTraceTag(23674907,207,15,"The target image is empty, can't show the float pane.")}else c.ULS.sendTraceTag(23674906,
207,15,"The container is empty, so the float pane can't be shown.");else c.ULS.sendTraceTag(23674905,207,50,"The IFloatPaneContainer is not registered and the float pane can't be shown.")}p9i(){const F=this.Ra.Ae("O365AdPaneShowingDuration",60);this.G4a();this.pN.style.display="block";this.pN.style.height=this.TQ.height+"px";this.Cnb=new e.a(2,1,1E3*F,Object(b.a)(this,this.hide,"hide"),67);this.Me.wg(this.Cnb);this.N3f()}o9i(){c.ULS.sendTraceTag(23674909,207,15,"The image can't be downloaded, the float pane can't be shown.");
this.N3f();this.TQ=null}N3f(){this.Aob&&this.TQ&&v.a.removeHandler(this.TQ,u.a.load,this.Aob);this.Aob=null;this.zob&&this.TQ&&v.a.removeHandler(this.TQ,u.a.error,this.zob);this.zob=null}kQf(){c.ULS.sendTraceTag(35698659,207,50,"User click the float pane and a new web page will be opened.");return!1}onClose(){this.Cnb&&this.Me.jq(this.Cnb);this.hide();return!0}dispose(){this.hide()}}Object(r.a)(w,"FloatPane",null,[542]);class m{constructor(F,G,L,M,O){this.Me=G;this.Ra=F;this.yj=L;this.Nb=O;this.N3=
M}create(){return new w(this.Ra,this.Me,this.yj,this.N3,this.Nb)}}Object(r.a)(m,"FloatPaneFactory",null,[511]);var t=a(6),z=a(232),y=a(261);class D{constructor(){this.Nb=null}get name(){return"Common.App.FloatPane"}get arf(){return t.AFrameworkApplication.fa.ra("O365AdvertisementIsEnabled")&&t.AFrameworkApplication.fa.ra("IsShowAdvertisementPaneEnabled")}init(){this.arf&&(c.ULS.sendTraceTag(23674944,207,50,"Setup task to show the float pane."),this.Nb.resolve("Common.App.FloatPane.IFloatPaneActor").W2f(),
c.ULS.sendTraceTag(23674945,207,50,"Setup action for excel to show the float pane."),this.Nb.resolve("Common.App.FloatPane.IFloatPaneActor").$Ta())}Oi(F){this.Nb=F;this.arf&&(this.Nb.register(m,"Common.App.FloatPane.FloatPaneFactory").as("Common.App.FloatPane.IFloatPaneFactory").od(()=>new m(t.AFrameworkApplication.fa,t.AFrameworkApplication.Xi,z.a.instance,t.AFrameworkApplication.sa.Qa.li,this.Nb)).gd(),this.Nb.register(h,"Common.App.FloatPane.FloatPaneActor").as("Common.App.FloatPane.IFloatPaneActor").od(()=>
new h(t.AFrameworkApplication.Xi,t.AFrameworkApplication.dc,this.Nb.resolve("Common.App.FloatPane.IFloatPaneFactory"))).gd())}dispose(){}static main(){y.a.instance.wj(new D)}}Object(r.a)(D,"FloatPanePackage",null,[4,5]);a.d(C,"a",function(){return H});const H=()=>{Type.registerNamespace("Common.App.FloatPane");D.main()}},1268:function(r,C,a){var c=a(10);r=a(0);var b=a(15),e=a(235),f=a(6),d=a(92),h=a(32),l=a(38),k=a(42),u=a(16),v=a(30);class x extends k.a{constructor(ya,za,la){super();this.value=null;
this.jBd=ya;this.Hy=za;this.KKg=la}WWg(ya){this.addHandler("EnabledStateChanged",ya)}get isEnabled(){return this.Hy}set isEnabled(ya){ya!==this.Hy&&(this.Hy=ya,v.a.Gp()&&appChrome.api.dispatch(appChrome.actions.toggleButton("Toggle"+this.jBd.replace(" ","")+"Button",ya)),this.raiseEvent("EnabledStateChanged"))}get isVisible(){return this.isEnabled&&!!this.value}get Qi(){return this.value?String.format(u.a.instance.Xb(79),this.jBd,this.value):this.jBd}get Drc(){return this.KKg}}Object(r.a)(x,"StatusBarAggregateControl",
k.a,[594]);class w extends k.a{constructor(){super();this.controls=new l.a(!1);this.Iae=null;this.XZf=()=>{this.raiseEvent("AggregatesChanged")};this.X4(0,415,"Average",!0);this.X4(1,416,"Count",!0);this.X4(2,417,"NumericalCount",!1);this.X4(3,418,"Minimum",!1);this.X4(4,419,"Maximum",!1);this.X4(5,420,"Sum",!0)}fWg(ya){this.addHandler("AggregatesChanged",ya)}Dxj(ya){this.removeHandler("AggregatesChanged",ya)}get Y1a(){return this.Iae||w.dXe}set Y1a(ya){ya=ya||w.dXe;ya!==this.Y1a&&(this.yDa(0,ya.Average),
this.yDa(1,ya.Count),this.yDa(2,ya.NumericalCount),this.yDa(3,ya.Minimum),this.yDa(4,ya.Maximum),this.yDa(5,ya.Sum),this.Iae=ya,this.XZf())}dispose(){d.a.ed(this.controls.values);this.controls.clear();super.dispose()}bya(ya){return this.controls.getItem(ya)}TSg(ya,...za){ya=this.bya(ya.toString());for(const la of za)this.controls.add(la,ya)}X4(ya,za,la,xa){za=new x(u.a.instance.Ha(za),xa,la);za.WWg(this.XZf);this.controls.add(ya.toString(),za)}yDa(ya,za){this.bya(ya.toString()).value=za}static get dXe(){w.Wsa||
(w.Wsa={},w.Wsa.Average=w.Wsa.Count=w.Wsa.NumericalCount=w.Wsa.Minimum=w.Wsa.Sum=null);return w.Wsa}}w.Wsa=null;Object(r.a)(w,"StatusBarAggregateControlCollection",k.a,[]);var m=a(328),t=a(47),z=a(234),y=a(174),D=a(48),H=a(5),F=a(33),G=a(130),L=a(1),M=a(199),O=a(19),B=a(59);const E=(ya,za,la,xa,wa,hb,Ja,Fa=null)=>{Fa=ya.Pa(1,Fa);Fa.activeCell=za;Fa.selectedRanges=la;return B.g(ya,"GetStatusBarAggregates",Fa,xa,wa,hb,Ja,0)};var I=a(55),S=a(63),J=a(231),K=a(149),R=a(35),Z=a(167),P=a(356),V=a(81),Ea=
a(61);const oa=L.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.PauseBeforeCalcRequest",10),ea=[{Z1a:0,name:"Average",jXa:-1015637685,$1a:1,c7a:!0},{Z1a:1,name:"Count",jXa:1957769939,$1a:3,c7a:!1},{Z1a:2,name:"NumericalCount",jXa:-1292677035,$1a:2,c7a:!1},{Z1a:3,name:"Minimum",jXa:405783320,$1a:5,c7a:!0},{Z1a:4,name:"Maximum",jXa:1210824414,$1a:4,c7a:!0},{Z1a:5,name:"Sum",jXa:1265371067,$1a:9,c7a:!0}];class aa{constructor(ya,za=null,la=null){this.Agc=this.nJc=this.oJc=this.mJc=null;this.bva=
new w;this.obb=new l.a(!0);this.eog=0;this.nrg=xa=>{const wa=this.ga.pa.activeCell.clone(),hb=t.d(this.ga.pa.selectedRanges);var Ja=this.$.na;const Fa=null===Ja||void 0===Ja?void 0:Ja.sheetId,Ba=null===Ja||void 0===Ja?void 0:Ja.hash,fa=this.$.ea.gf,ta=this.$.ea.eRa;Ja=this.$.listSeparator;const Oa=t.i(t.H(hb),Ja,this.$,!1),Ma=`=${this.calcManager.config.localeInfo.getWorksheetFuncName(485)}({0}${Ja}5${Ja}{1})`;Promise.all(ea.map(fb=>this.calcManager.evalFormula(String.format(Ma,fb.$1a,Oa),wa,void 0,
fb.c7a?excelOnlineCalc.calc.evalFormulaFormatAggregate():excelOnlineCalc.calc.evalFormulaFormatKnown(0)))).then(fb=>{var pa;const Ua=this.ga.pa.selectedRanges,Sa=this.ga.pa.activeCell,Ia=null===(pa=this.$.na)||void 0===pa?void 0:pa.sheetId;if(t.R(hb,Ua)&&wa.equals(Sa)&&Fa===Ia){pa=[];for(var [,X]of fb.entries()){if(void 0===(null===X||void 0===X?void 0:X.formatted)||!excelOnlineCalc.util.isSuccess(X.formatted)||!excelOnlineCalc.util.isSuccess(X.value)){this.pCc();return}fb=this.calcManager.fH.renderValue(X.formatted.value,
excelOnlineCalc.numfmt.renderInfiniteWidth);if(!excelOnlineCalc.util.isSuccess(fb)){this.pCc();return}fb=excelOnlineCalc.numfmt.renderedValueToString(fb.value);pa.push(fb)}X={};for(var ca of ea)X[ca.name]="";ca=pa[1];fb=pa[2];if(1<+ca&&(X.Count=ca,0<+fb))for(const [U,ma]of ea.entries())X[ma.name]=pa[U];this.ARb(X);this.Q5j(X,ca,fa,ta,hb,wa,Fa,Ba,xa)}}).catch(fb=>{b.ULS.sendTraceTag(537151266,0,10,`TryToCalculateAggregatesUsingCalc: in catch, reason: ${JSON.stringify(fb)}`);this.pCc()})};this.Od=()=>
{this.Jsg()};this.gg=(xa,wa)=>{xa=wa.Td.hash;wa=wa.Td.block;const hb=wa.eda;if(wa.state&4&&hb&&hb!==this.obb.getItem(xa)){this.obb.add(xa,hb);var Ja=(xa=wa.qg)?O.g(xa.getRowNumbers(),xa.getColumnNumbers()):null;e.a.any(this.ga.pa.selectedRanges,Fa=>Fa.Yd(Ja))&&this.Jsg()}};this.fo=(xa,wa)=>{this.obb.remove(wa.Td.hash)};this.ee=()=>{this.$.da.Qb(29,xa=>{this.statusBarManager=xa;xa.TK(this);b.ULS.sendTraceTag(537151265,0,50,"StatusBarAggregateManager.OnWorkbookOpened: after AddFeatureRootUser")})};
this.Md=(xa,wa)=>{!xa.Oc&&z.b(wa)&&this.statusBarManager&&(this.statusBarManager.pH(this),this.statusBarManager=null,b.ULS.sendTraceTag(537151264,0,50,"StatusBarAggregateManager.OnSessionIdChanged: after RemoveFeatureRootUser"))};this.A6j=()=>{let xa;({P7b:xa}=this.sak(this.ga.pa.selectedRanges)).returnValue?this.ARb(xa):this.r7f()};this.r7f=()=>{var xa;const wa=t.d(this.ga.pa.selectedRanges),hb=this.ga.pa.activeCell.clone(),Ja=null===(xa=this.$.na)||void 0===xa?void 0:xa.sheetId;this.oDf(hb,wa,Fa=>
{var Ba;const fa=this.ga.pa.selectedRanges,ta=this.ga.pa.activeCell,Oa=null===(Ba=this.$.na)||void 0===Ba?void 0:Ba.sheetId;t.R(wa,fa)&&hb.equals(ta)&&Ja===Oa&&this.ARb(Fa.Result)})};this.zpf=L.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StatusBarAggregatesCSE",!1);this.Qqf=L.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AggregatesDebugErrorMessageForFF",!1);this.$=ya;this.gridView=O.h(this.$);this.K5=za||f.AFrameworkApplication.qe;this.vi=la||F.a.Lb;this.$.ea.Mk(this.Md);
this.$.$l(this.ee);this.ga.yp(this.Od);this.ga.add_activeCellChanged(this.Od);this.Ca.vv(this.gg);this.Ca.vI(this.fo);for(const xa of ea)this.nRj(xa.Z1a,xa.name,xa.jXa);(this.statusBarManager=this.$.da.Ba(29))&&this.statusBarManager.TK(this);this.zpf&&((L.EwaSettings.xC()?xa=>K.a.resolve(R.i,{Wa:1}).then(wa=>setTimeout(()=>xa(wa),0)):xa=>this.$.da.Qb(266,xa))(xa=>{this.calcManager=xa}),this.$.da.Qb(268,xa=>{this.instantaneousSupportInformationManager=xa}))}Ar(ya){this.bva.fWg(ya)}$r(ya){this.bva.Dxj(ya)}get Y1a(){return this.bva.Y1a}ARb(ya){this.bva.Y1a=
ya}get Ca(){return this.gridView.Ca}get ga(){return this.gridView.ga}dispose(){this.$&&(this.$.ea.Vk(this.Md),this.$.hn(this.ee),this.ga.Rp(this.Od),this.ga.remove_activeCellChanged(this.Od),this.Ca.Vt(this.gg),this.Ca.SJ(this.fo),this.YHe());this.statusBarManager&&(this.statusBarManager.pH(this),this.statusBarManager=null);d.a.ed([this.mJc,this.oJc,this.nJc,this.bva]);this.$=this.bva=this.nJc=this.oJc=this.mJc=null;this.obb&&(this.obb.clear(),this.obb=null)}Gt(ya,za){return this.bya(ya)&&this.sdf(ya,
za)?!0:!1}sdf(ya,za){const la=this.bya(ya);if(!la)return!1;let xa=la.Qi;if(ya.endsWith("Label"))za.Visible=la.isVisible,v.a.Gp()?za.LabelText=xa:za.Value=xa;else if(ya.endsWith("Button"))za.LabelText=xa,za.On=la.isEnabled;else return!1;return!0}Co(){return!0}yd(){return!1}executeCommand(ya,za){ya=this.bya(za.command);if(!ya)return M.a(za.command);ya.isEnabled=!ya.isEnabled;this.YPi(ya.Drc,ya.isEnabled);return S.Task.Ua(!0)}fd(ya,za){return!!this.bya(za.command)}Cd(){return!1}oDf(ya,za,la){const xa=
this.$;this.YHe();this.$.ea.Oc&&(this.Agc=E(xa.qa.va,t.o(ya,xa),t.r(za,xa),la,null,null,null))}sak(ya){let za;return{returnValue:({P7b:za}=aa.mrg(ya)).returnValue||this.s2g(ya)&&this.p2g(ya),P7b:za}}Q5j(ya,za,la,xa,wa,hb,Ja,Fa,Ba){const fa=this.Qqf;if(Ba||!(this.eog>(fa?1E3:20)||Math.random()>(fa?1:.05)))this.eog++,this.oDf(hb,wa,ta=>{var Oa,Ma,fb,pa;if(!J.a(ta)){var Ua=this.ga.pa.selectedRanges,Sa=this.ga.pa.activeCell,Ia=null===(Oa=this.$.na)||void 0===Oa?void 0:Oa.sheetId;Oa=ta.StateId;if(t.R(wa,
Ua)&&hb.equals(Sa)&&Ja===Ia&&la===this.$.ea.gf&&xa===this.$.ea.eRa&&la===Oa){var X=ta.Result;Oa={};const ra={};Ia=!0;for(var ca of ea){var U=X[ca.name],ma=ya[ca.name];const Va=U===ma;Oa[ca.name]=Va;ra[ca.name]=[U.length,ma.length];Ia&&(Ia=Va)}({category:Sa}=this.instantaneousSupportInformationManager?this.instantaneousSupportInformationManager.kak(null!==(pa=null===(fb=null===(Ma=this.gridView.tc(Sa))||void 0===Ma?void 0:Ma.cell)||void 0===fb?void 0:fb.yi)&&void 0!==pa?pa:0):{category:"uninitialized"});
Ma=Ua.length;Ua=t.b(Ua);fb=this.gridView.rjf()||this.gridView.qjf();ca=this.gridView.Mb;pa=ca.eMb;U=this.gridView.Xj("StatusBarAggregates");ca=V.b(hb,ca.Hj,ca.lk,this.gridView.rowsPerBlock,this.gridView.columnsPerBlock,Object(Ea.c)(U)?U.value:null);ca=ca.X+"_"+ca.Y+"_"+ca.PaneType;X=X.Count;U=ya.Count;ma=this.gridView.Wb.oai(wa);ta=`StatusBarAggregateManager.testCalcResult: allCorrect: ${Ia}, ${JSON.stringify(Oa)}, numberFormatCategory: ${Sa}, resLength(server,calc): ${JSON.stringify(ra)}, stateId: ${la}, latestSuccessfulStateId: ${xa}, prevSheetId: ${Ja}, prevSheetHash: ${Fa}, numOfRanges: ${Ma}, numOfCells: ${Ua}, prevActiveCell: ${hb}, prevSelectedRanges: ${wa.join(";")}, sheetHasHidden: ${fb}, panesState: ${pa}, blockPositionString: ${ca}, ReportCalcState: ${ta.ReportCalcState}, CalcComplete: ${ta.CalcComplete}, serverCount: ${X}, calcCount: ${U}, calcCountUnfiltered: ${za}, enumeratorCount: ${ma}, forceTestResult: ${Ba}`;
b.ULS.sendTraceTag(520426510,0,50,ta);U!==X&&!Ba&&this.Qqf&&(ta={Appearance:1,Caption:null,Description:"We need your help!\nYou encountered an error we are having a hard time reproducing.\nPlease save a copy of your workbook at its current state and send it to issolomo@microsoft.com.\nThank you!",Directive:null,MessageId:0,MessageIdName:"StatusBarAggregatesDebugErrorMessageForFF"},ta.MessageIdHash=h.a.Av(ta.MessageIdName),ta.Severity=0,ta.Type=0,L.EwaSettings.Fz()?new P.a(this.$,ta):(new Z.ErrorDialog(this.$,
ta)).ah());Ia||Ba||window.setTimeout(()=>{this.nrg(!0)},100)}}})}s2g(ya){const za=this.gridView.sk,la=this.gridView.Eq;return!!za&&e.a.all(ya,xa=>za.contains(xa))&&e.a.all(ya,xa=>!la.UFb(xa))}p2g(ya){if(500<t.b(ya))return!1;const za=this.vi.hf;ya=this.gridView.Z5("StatusBarAggregateManager.AreAllCellsEmpty",ya);try{for(let la=0;ya.$$mn();la++)if(ya.$$cu().sK||!(la%25)&&100<G.c(this.vi,za))return!1}finally{ya&&ya.dispose()}return!0}bya(ya){return this.bva.bya(ya)}nRj(ya,za,la){this.bva.TSg(ya,"Query"+
za+"Label","Query"+za+"Button",la.toString())}Jsg(){var ya;if(this.$.oe&4&&!this.gridView.Ob&&!this.gridView.hj){var za;({P7b:za}=aa.mrg(this.ga.pa.selectedRanges)).returnValue?this.ARb(za):(this.ARb(null),this.zpf?(null===(ya=this.calcManager)||void 0===ya?0:ya.Bmc)?this.KHj():this.pCc():this.mJc=y.AsyncMethodContext.Fr(this.A6j,500,D.a.H2j,this.mJc))}}KHj(){this.nJc=y.AsyncMethodContext.Fr(()=>this.nrg(!1),oa,D.a.I2j,this.nJc)}pCc(){this.oJc=y.AsyncMethodContext.Fr(this.r7f,500,D.a.G2j,this.oJc)}YHe(){this.Agc&&
(this.K5.lw(this.Agc.yv),this.Agc=null)}YPi(ya,za){const la={};la.a=this.$.xa.UserSessionId;la.b=ya;la.c=za;I.b().Of(29,la)}static initData(){const ya=m.a.rba;for(const za of ea)ya(za.jXa,H.a.yh,0,0)}static la(ya){aa.initData();const za=new aa(ya);ya.Ia.W4(za);ya.da.Ja(27,za)}static mrg(ya){return{returnValue:1===ya.length&&ya[0].isSingle,P7b:null}}}Object(r.a)(aa,"StatusBarAggregateManager",null,[493,2,204,205,210]);a.d(C,"a",function(){return ia});const ia=()=>{c.a.Fa(ya=>{ya.da.Qb(29,()=>{aa.la(ya)})})}},
1278:function(r,C,a){r=a(0);var c=a(15),b=a(230),e=a(37),f=a(92),d=a(31),h=a(84),l=a(555),k=a(9),u=a(53),v=a(7),x=a(177),w=a(74),m=a(303),t=a(136),z=a(47),y=a(30),D=a(13),H=a(12),F=a(109),G=a(19),L=a(319),M=a(137),O=a(383);class B{constructor(P){this.B9a=this.Blc=0;this.t8b=null;this.$qf=!1;this.$=P;this.$qf=P.Gpc}$Ci(){return G.h(this.$).Ob?(c.ULS.sendTraceTag(537149795,0,50,"PinchToZoomAdapter.IsGesturePossible A cell is being edited -> don't allow pinch"),!1):this.$.Zb.Gz?(c.ULS.sendTraceTag(537149794,
0,50,"PinchToZoomAdapter.IsGesturePossible A modal dialog is opened -> don't allow pinch"),!1):!0}U5i(P){this.t8b=new Sys.UI.Point(Math.round(P.Pxa.center.x),Math.round(P.Pxa.center.y));this.Blc=e.a(this.$).zoom;this.B9a=P.Pxa.scale;let V={["InitialZoom"]:this.Blc,["Location"]:"canvas",["InputMethod"]:P.kc};M.b(this.$).Vd(t.a.Jij,V);c.ULS.sendTraceTag(537149793,0,50,`PinchToZoomAdapter.OnGestureStart starting gesture. center (${this.t8b.x},${this.t8b.y}), initial zoom ${this.Blc}, initial scale ${this.B9a}`);
this.$bb(P,"onGestureStart");return!0}T5i(P){if(!this.B9a)return c.ULS.shipAssertTag(537149792,0,!1,"PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be 0"),this.$bb(P,"OnGestureEvent"),!0;if(!isFinite(this.B9a))return c.ULS.sendTraceTag(537149791,0,15,`PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be infinite. initialPinchScale=${this.B9a}`),this.$bb(P,"OnGestureEvent"),!0;const V=P.Pxa.scale/this.B9a*this.Blc;e.a(this.$).oyg(V,this.t8b);c.ULS.sendTraceTag(537149790,
0,50,`PinchToZoomAdapter.OnGestureEvent processing gesture. New zoom ${V}. Current scale ${P.Pxa.scale}`);this.$bb(P,"OnGestureEvent");return!0}S5i(P){e.a(this.$).pyg();c.ULS.sendTraceTag(537149789,0,50,"PinchToZoomAdapter.OnGestureEnd end of gesture");this.$bb(P,"OnGestureEnd")}R5i(P){c.ULS.sendTraceTag(537149788,0,50,"PinchToZoomAdapter.OnGestureCancel gesture canceled");this.$bb(P,"OnGestureCancel")}$bb(P,V){var Ea,oa,ea;this.$qf&&(c.ULS.sendTraceTag(536990857,0,50,`PinchToZoomAdapter.markGestureEventAsHandled - Invoked from ${V},        eventArgs non-null: ${isNullOrUndefined(P)}, gestureData non-null: ${isNullOrUndefined(null===
P||void 0===P?void 0:P.Pxa)},        srcEvent non-null: ${isNullOrUndefined(null===(Ea=null===P||void 0===P?void 0:P.Pxa)||void 0===Ea?void 0:Ea.srcEvent)}`),null===(ea=null===(oa=null===P||void 0===P?void 0:P.Pxa)||void 0===oa?void 0:oa.srcEvent)||void 0===ea?void 0:ea.preventDefault())}}Object(r.a)(B,"PinchToZoomAdapter",null,[444]);var E=a(42);class I extends E.a{constructor(){super()}sze(P){this.addHandler("ZCIEK",P)}K5f(P){this.removeHandler("ZCIEK",P)}n3c(P){this.addHandler("ZCUIK",P)}eTd(P){this.removeHandler("ZCUIK",
P)}nqj(){this.raiseEvent("ZCIEK")}mqj(){this.raiseEvent("ZCUIK")}oqj(){this.raiseEvent("ZCEK")}}Object(r.a)(I,"ZoomEventManager",E.a,[445]);var S=a(23),J=a(89);class K extends E.a{constructor(P){super();this.statusBarManager=null;this.q6e=!1;this.$=P;this.$.da.Qb(29,V=>{this.statusBarManager=V;V.TK(this)})}Ar(P){this.addHandler("Zoom",P)}$r(P){this.removeHandler("Zoom",P)}XA(){this.Co("QueryZoomStatus")&&this.raiseEvent("Zoom")}Gt(P,V){return"QueryZoomStatus"!==P?!1:this.Gmi(V)}Co(){return e.a(this.$).jU()}dispose(){this.statusBarManager&&
(this.statusBarManager.pH(this),this.statusBarManager=null);this.$=null;super.dispose()}zgf(P){P=this.Lii(P);if(!P)return null;P=P.getElementsByClassName("cui-ctl-mediumlabel");return 1!==P.length?(c.ULS.shipAssertTag(537149764,0,!1,"ZoomStatusBarManager.GetZoomUIElement Cannot find zoom label element"),null):P[0]}Gmi(P){if(!this.$)return!1;const V=e.a(this.$).$Vb;let Ea=!1;if(y.a.Gp())S.a.equals(appChrome.selectors.getControlLabel(J.a.zoomStatusBarMenuOpen),V,!1)||(Ea=!0);else{const oa=this.zgf("HandleQueryZoomStatusCommand");
oa?S.a.equals(P.LabelText.toString(),V,!1)||(oa.innerText="",Ea=!0):Ea=!0}Ea&&this.LOj(P,V);return!0}LOj(P,V){P.LabelText=V;y.a.Gp()&&(P.Visible=!0)}Lii(P){var V=D.DOMElementExtensions.getElementById(this.$.domElement,"m_excelWebRenderer_ewaCtl_zoomLevel-Medium14");if(!V)return V=(V=this.$.ea.Rc)?V.inEmbedView:!1,d.a.rq||V||c.ULS.sendTraceTag(537149763,0,15,`ZoomStatusBarManager.GetZoomBaseElement Cannot find zoom label. Called from ${P}`),null;this.q6e||(this.q6e=!0,c.ULS.sendTraceTag(537149762,
0,50,`ZoomManager.GetZoomBaseElement - Zoom label was found first time. Called from ${P}`));return V}}Object(r.a)(K,"ZoomStatusBarManager",E.a,[2,204,205]);class R extends l.a{constructor(P){super(P);this.zoomEventManager=this.rAa=this.AHb=null;this.FHb=-1;this.Zqf=!1;this.Od=()=>{this.FHb=-1};c.ULS.sendTraceTag(537149785,0,50,"AppZoom feature is Enabled.");this.Ukb=new K(P);this.Kij()&&(c.ULS.sendTraceTag(537149784,0,50,"ZoomManager.ZoomManager Attaching pinch to zoom events"),this.D3g());this.Jvj()}dispose(){this.Ukb&&
(f.a.Ka(this.Ukb),this.Ukb=null);this.zoomEventManager&&(this.$.da.XV(419),this.zoomEventManager=null);this.Zqf&&this.vxh();super.dispose()}jU(){return!0}oyg(P,V){P=this.eNa(P);if(G.h(this.$).rtl){const Ea=Math.round(D.DOMElementExtensions.getBounds(this.$.og).width*e.a(this.$).zoom);this.AHb=new Sys.UI.Point(Ea-V.x,V.y)}else this.AHb=V;this.EVa(P,!1,"ZoomWithPinch")}FLc(){return!0}ELc(P,V){var Ea=d.a.isMac?.07:.15;P=this.zoom+(P?Ea:-Ea);P=this.eNa(P);G.h(this.$).rtl?(Ea=Math.round(D.DOMElementExtensions.getBounds(this.$.og).width*
e.a(this.$).zoom),this.rAa=new Sys.UI.Point(Ea-V.x,V.y)):this.rAa=V;V=this.zoom;this.EVa(P,!0,"ZoomWithMouse");V={["InitialZoom"]:V,["FinalZoom"]:P,["Location"]:"canvas"};M.b(this.$).Vd(t.a.Qmk,V)}pyg(){this.AHb=null}GLc(P,V){this.EVa(this.eNa(P),!1,V?"ZoomWithDropDownFromRibbon":"ZoomWithDropDown")}qyg(P){isNaN(P)?c.ULS.sendTraceTag(537149783,0,15,"ZoomManager.ZoomToSelectionForFollowAlongInExcelLive: Invalid zoom value was provided"):this.EVa(this.eNa(P),!1,"ZoomToLevelInExcelLive")}HLc(P,V){this.EVa(this.eNa(P),
!0,V?"ZoomWithShortcuts":"ZoomWithButtons")}lef(P,V){const Ea=G.h(this.$).rtl,[oa,ea]=this.Aod(Ea),[aa,ia]=this.pqd(P,ea);return this.rAa?(P=this.god(this.rAa,P,V,ea,oa,"ZoomWithMouse"),this.rAa=null,P):this.AHb?this.god(this.AHb,P,V,ea,oa,"ZoomWithPinch"):G.h(this.$).ga.Sa.DS?this.Pmk(P,V,ea,oa,aa,ia,G.h(this.$).rtl):this.Rmk(P,V,ea,oa,aa,ia,G.h(this.$).rtl)}Jag(P,V,Ea){if(P){c.ULS.sendTraceTag(537149782,0,50,`Zoom To: (${P.x} ${P.y}) (new top-left) from zoom:${V} to zoom:${Ea}`);P=new u.a(P.x,P.y);
Ea=G.h(this.$).rtl;[,Ea]=this.Aod(Ea);const [oa,ea]=this.pqd(V,Ea);G.h(this.$).Vze(P,oa,ea,"ApplicationZoom")}else c.ULS.sendTraceTag(537149781,0,50,`Zooming top-left: from zoom:${V} to zoom:${Ea}`)}zoomFitToScreen(){const P=this.zoom;var V=G.h(this.$).rtl;const [Ea,oa]=this.Aod(V),[ea,aa]=this.pqd(P,oa);var ia=G.h(this.$).ga.Sa.DS;(V=ia?this.Z$e(this.WSa,ea,aa,!1):this.vef(this.WSa,oa,Ea,ea,aa,V,!1))?(V=Math.min(ea/(V.width+100),aa/(V.height+100)),V=this.BUh(V),this.EVa(V,!0,"ZoomWithFitToScreen"),
ia?G.h(this.$).ga.Sa.Mva(G.h(this.$).ga.Sa.Pc,!1):(ia=z.v(G.h(this.$).ga.pa.activeRange,this.$),G.h(this.$).Eh(ia,null,null,null,3,"ZoomManager.ZoomFitToScreen")),this.FHb=P,this.Zqf||this.A3g()):c.ULS.sendTraceTag(537149780,0,15,`ZoomManager.ZoomFitToScreen: Bounds found to be null with FloatingObjectSelected: ${ia}`)}zoomFitToScreenUndo(){this.EVa(this.FHb,!1,"ZoomWithFitToScreen")}S_d(){return-1!==this.FHb}A3g(){const P=G.h(this.$);P&&(P.ga.yp(this.Od),P.TF(this.Od))}vxh(){const P=G.h(this.$);
P&&(P.ga.Rp(this.Od),P.qH(this.Od))}BUh(P){P=Math.min(P,k.a.KVi);P=Math.max(P,k.a.zWi);return Math.round(100*P)/100}EVa(P,V,Ea){if(this.CLc()){var oa=G.h(this.$).view.visibleArea.toString();P=this.eNa(P);var ea=w.d(this.$.ua.na);ea||(ea=l.a.CGf);G.h(this.$).Mh.e3(5,L.a.BLc,Ea);G.h(this.$).Mh.yoa(L.a.BLc,this.$.ea.gf);c.ULS.sendTraceTag(537149779,0,50,`ZoomManager.SetNewZoomLevel Setting zoom ${P} to sheet ${ea} origin ${Ea} prevZoom ${this.zoom}`);this.FRj(ea,P);this.zoomEventManager.oqj();this.U9j(Ea);
this.f$j(V);this.FHb=-1;O.b(this.$,Ea);P=G.h(this.$).view.visibleArea.toString();c.ULS.sendTraceTag(537149778,0,50,`ZoomManager.SetNewZoomLevel OldGridVisibleArea: ${oa}, NewGridVisibleArea: ${P}, IsShyRibbonActive: ${this.$.m1}`)}}g3h(P){return(P=H.HelperMethods.yE(this.$.og,this.$.domElement,P))?P:new Sys.UI.Point(0,0)}Aod(P){const V=this.g3h(P);P=this.U7h(V,P);return[V,P]}pqd(P,V){const Ea=D.DOMElementExtensions.getBounds(this.$.og);return[Math.round((Ea.width-V.x)*P),Math.round((Ea.height-V.y)*
P)]}U7h(P,V){V=H.HelperMethods.yE(G.h(this.$).domElement,this.$.domElement,V);return V?(P=new Sys.UI.Point(Math.round(V.x-P.x),Math.round(V.y-P.y)),P):new Sys.UI.Point(0,0)}Rmk(P,V,Ea,oa,ea,aa,ia){return(ia=this.vef(P,Ea,oa,ea,aa,ia))?this.cdf(ia,P,V,Ea,oa,ea,aa):null}vef(P,V,Ea,oa,ea,aa,ia=!0){var ya=z.G(G.h(this.$).ga.pa.selectedRanges);if(ia&&(ya=ya.ff(z.G(G.h(this.$).djc())),!ya))return c.ULS.sendTraceTag(537149777,0,50,"ZoomManager.GetSelectedRangeBounds No range inside the viewport is selected."),
null;const za=G.h(this.$).tc(ya.topLeft);ya=G.h(this.$).tc(ya.bottomRight);if(!za||!ya)return c.ULS.sendTraceTag(537149776,0,15,"ZoomManager.GetSelectedRangeBounds Cannot get cells for top-left or bottom-right of the selected range. Will zoom top-left"),null;P=za.cell.kJ===ya.cell.kJ&&za.cell.iJ===ya.cell.iJ?this.$1h(P,ya,V,Ea,oa,aa):this.vhi(P,za,ya,V,Ea,oa,aa);return P?ia?this.a5e(P,oa,ea):P:(c.ULS.sendTraceTag(537149775,0,15,"ZoomManager.GetSelectedRangeBounds got null bounds"),null)}a5e(P,V,Ea){if(0>
P.x||P.x>V)P.x=0;if(0>P.y||P.y>Ea)P.y=0;P.x+P.width>V&&(P.width=V-P.x);P.y+P.height>Ea&&(P.height=Ea-P.y);return P}vhi(P,V,Ea,oa,ea,aa,ia){V=G.h(this.$).getCellBounds(V.cell);if(!V)return null;const ya=G.h(this.$).getCellBounds(Ea.cell);if(!ya)return null;let za=ea.x;ia&&(za=0,V.x=Math.round(aa/P)-V.x-Math.round(V.width),ya.x=Math.round(aa/P)-ya.x-Math.round(ya.width));P=new Sys.UI.Bounds(Math.round((V.x-oa.x)*P)-za,Math.round((V.y-oa.y)*P-ea.y),Math.round((ya.x+ya.width-V.x)*P),Math.round((ya.y+
ya.height-V.y)*P));Ea=Ea.cell.getRange();c.ULS.sendTraceTag(537149774,0,50,`ZoomManager.GetTwoCellsBoundsWithZoom - a range with more than 1 cell was selected. Will zoom to range: (t:${Ea.top}, b:${Ea.bottom}, r:${Ea.right}, l:${Ea.left}) in bounds (${P.x}, ${P.y}, ${P.width}, ${P.height})`);return P}$1h(P,V,Ea,oa,ea,aa){const ia=G.h(this.$).getCellBounds(V.cell);if(!ia)return null;let ya=oa.x;aa&&(ya=0,ia.x=Math.round(ea/P)-ia.x-Math.round(ia.width));P=new Sys.UI.Bounds(Math.round((ia.x-Ea.x)*P)-
ya,Math.round((ia.y-Ea.y)*P-oa.y),Math.round(ia.width*P),Math.round(ia.height*P));V=V.cell.getRange();c.ULS.sendTraceTag(537149773,0,50,`ZoomManager.GetCellBoundsWithZoom - single cell was selected. Will zoom to cell: (t:${V.top}, l:${V.left}) in bounds (${P.x}, ${P.y}, ${P.width}, ${P.height})`);return P}Pmk(P,V,Ea,oa,ea,aa){const ia=this.Z$e(P,ea,aa);return ia?this.cdf(ia,P,V,Ea,oa,ea,aa):null}cdf(P,V,Ea,oa,ea,aa,ia){P=new Sys.UI.Point(this.Idf(aa,P.x,P.width),this.Idf(ia,P.y,P.height));return this.god(P,
V,Ea,oa,ea)}Idf(P,V,Ea){return P===Ea?(c.ULS.sendTraceTag(537149772,0,50,"ZoomManager.GetRelativePointCoordinate returning size/2 since the bounds are the same as the grid bounds"),P/2):P*V/(P-Ea)}Z$e(P,V,Ea,oa=!0){const ea=G.h(this.$).ga.Sa.Pc.domElement;var aa=H.HelperMethods.yE(ea,G.h(this.$).domElement,G.h(this.$).rtl);if(!aa)return c.ULS.sendTraceTag(537149771,0,50,"ZoomManager.GetFloatingObjectBounds got null for floatingObjectPointOnGrid"),null;const ia=G.h(this.$).bCb();aa=new Sys.UI.Point(Math.round((aa.x-
ia.topLeft.x)*P),Math.round((aa.y-ia.topLeft.y)*P));P=new Sys.UI.Bounds(aa.x,aa.y,Math.round(ea.offsetWidth*P),Math.round(ea.offsetHeight*P));return oa?this.a5e(P,V,Ea):P}YGf(){this.Ukb.XA()}e_i(P){"ZoomToLevelInExcelLive"===P?this.zoomEventManager.nqj():this.zoomEventManager.mqj()}Jvj(){this.zoomEventManager=this.$.da.Ja(419,new I)}god(P,V,Ea,oa,ea,aa=""){var ia=G.h(this.$).rtl?0:ea.x;ea="ZoomWithPinch"===aa||"ZoomWithMouse"===aa?new Sys.UI.Point(P.x-ia-Math.round(oa.x*V),P.y-ea.y-Math.round(oa.y*
V)):P;ea=new Sys.UI.Point(Math.round(ea.x/V),Math.round(ea.y/V));c.ULS.shipAssertTag(537149770,0,!!V,"Original zoom level must be different than 0");ia=Ea/V;ea=new Sys.UI.Point(Math.round(ea.x*(1-1/ia)),Math.round(ea.y*(1-1/ia)));"ZoomWithMouse"===aa||"ZoomWithPinch"===aa?(ea.x+=Math.round((oa.x-G.h(this.$).dt)*(ia-1)),ea.y+=Math.round((oa.y-G.h(this.$).gL)*(ia-1))):(ia=Math.round(oa.x*(Ea-V)),0<ia&&ea.x>ia&&(ea.x+=ia),V=Math.round(oa.y*(Ea-V)),0<V&&ea.y>V&&(ea.y+=V));"ZoomWithMouse"===aa&&(P.x||
(ea.x=0),P.y||(ea.y=0));P=G.h(this.$).bCb();return new Sys.UI.Point(ea.x+P.topLeft.x,ea.y+P.topLeft.y)}D3g(){const P=[];h.a.instance.Dc("Common.IGestureInputManager").execute(V=>{0===V.r7h()&&V.huj(document.body,new B(this.$),P)})}Kij(){return this.CLc()&&(d.a.Wo&&d.a.LPa(67)||this.$.Gpc)}FRj(P,V){O.a(this.$)?this.setZoomLevel(P,V,this.U9d,k.a.WNd):this.setZoomLevel(P,V,this.zoomPerSheetId,this.ftf?-1:this.WSa)}setZoomLevel(P,V,Ea,oa){Ea.remove(P);V!==oa&&Ea.add(P,V)}U9j(P){this.Veg();this.$.ACa(m.a.B0("TriggerImmediateZoomOperations"));
this.zhk();this.e_i(P)}zhk(){this.gHi()?this.$.ig():this.Ukb.XA();const P=this.Ukb.zgf("UpdateZoomStatusBar");P&&(P.innerText=this.$Vb)}gHi(){const P=x.a(this.$);return P?P.xq.Tz===(y.a.qQa(this.$)?v.a.Iyc:this.$.qc+v.a.i9f):!1}f$j(P){G.h(this.$).Omk(P);this.C_g()}C_g(){const P=F.a(this.$);if(P)for(const V of G.h(this.$).Ca.uz()){if(!V){c.ULS.sendTraceTag(537149768,0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - cacheItem is null");continue}if(!V.Zk)continue;const Ea=V.qj;if(Ea)for(let oa=
0;oa<Ea.count;oa++)if(2===Ea.Wg(oa).type){const ea=P.Ns(Ea.Wg(oa).Th());ea?(ea.oha(!1),c.ULS.sendTraceTag(537149766,0,50,`ZoomManager.AdjustSlicersToZoom - Slicer zoomed to zoom ${this.zoom}`)):c.ULS.sendTraceTag(537149767,0,50,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - control is null")}}else c.ULS.sendTraceTag(537149769,0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - floatingObjectManager is null")}}Object(r.a)(R,"ZoomManager",l.a,[]);a.d(C,"a",function(){return Z});
class Z extends b.a{constructor(P){super();this.$=P;this.uc()}create(){const P=new R(this.$);this.Bhk(P);this.$.da.Ja(368,P);this.$b(P)}Bhk(P){const V=e.a(this.$);if(V){var Ea=V.uqd("ZoomManagerFactory.UpdateZoomPerSheetIdFromExistingManager");P.fZd(Ea);P.hCc(V.iJc)}else c.ULS.shipAssertTag(537149765,0,!0,"ZoomManagerFactory.UpdateZoomPerSheetIdFromExistingManager existingZoomManager is missing (expected to find here a DefaultZoomManager to pass zoom-per-sheet state from)")}static la(P){P.da.Ja(369,
new Z(P))}}Object(r.a)(Z,"ZoomManagerFactory",b.a,[])},1284:function(r,C,a){r=a(0);var c=a(1001),b=a(6);class e{}Object(r.a)(e,"LokiTokenResult",null,[]);class f{constructor(v){this.T_b=v}Xnd(){const v=this.J9h();return v?f.byd?new Promise((x,w)=>{this.T_b.continueWith(()=>{this.T_b.ji||this.T_b.Jg?w(Error.create("Error downloading auth library")):this.T_b.result.kD("Loki",v).then(m=>{m=b.AFrameworkApplication.fa.ra("ForceLokiFallbackToACLPTokenIsEnabled")?this.M9h():m.IsSuccess&&m.Token?Object.assign(new e,
{isSuccess:!0,token:m.Token,errorMessage:null}):Object.assign(new e,{isSuccess:!1,token:null,errorMessage:JSON.stringify(m)});x(m);return m})})}):Promise.resolve(Object.assign(new e,{isSuccess:!1,token:null,errorMessage:"Not attempting to fetch token because host is not an O365 host."})):Promise.resolve(Object.assign(new e,{isSuccess:!1,token:null,errorMessage:String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",c.a.j8e())}))}M9h(){const v=b.AFrameworkApplication.fa.Va("LokiUserDataSignature")||
"";return Object.assign(new e,{isSuccess:!0,token:v,errorMessage:null})}J9h(){let v=null;const x=c.a.Ggc();2===x?v=b.AFrameworkApplication.fa.Va("LokiAADAppId"):1===x&&(v=b.AFrameworkApplication.fa.Va("LokiMSAAppId"));return v}static get byd(){return b.AFrameworkApplication.fa.ra("IsO365CommercialHost")||b.AFrameworkApplication.fa.ra("IsO365ConsumerHost")}}Object(r.a)(f,"LokiTokenManager",null,[623]);var d=a(261),h=a(84),l=a(529);class k{get name(){return"Common.App.LivePersonaUtils"}init(){h.a.instance.resolve("Common.ILokiTokenManager")}dispose(){}Oi(v){v.register(f,
"Common.App.LivePersonaUtils.LokiTokenManager").as("Common.ILokiTokenManager").gd().od(()=>new f(l.a.mr(v.Dc("Common.App.OAuth.IOAuthManager"))))}static main(){d.a.instance.wj(new k)}}Object(r.a)(k,"LivePersonaUtilsPackage",null,[4,5]);a.d(C,"a",function(){return u});const u=()=>{Type.registerNamespace("Common.App.LivePersonaUtils");k.main()}},1285:function(r,C,a){r=a(0);var c=a(578),b=a(573),e=a(570),f=a(1040);class d{Sqh(G,L){if(G&&!(1>G.length)&&L){var M=Object.assign(new e.a,{ExternalId:"msPresenceOuter",
ControlList:[]});this.poh(G,M.ControlList);L.push(M)}}poh(G,L){const M=Object.assign(new c.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new b.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(L,M);L=Object.assign(new e.a,{Title:"",ControlList:[]});Array.add(M.Menu.MenuSectionList,L);this.vqh(G,L.ControlList)}vqh(G,L){for(let M=0;M<G.length;M++){const O=Object.assign(new f.a,{ExternalId:String.format("CoauthorPersona_{0}",
M),Command:"336231556",DisplayName:G[M].userName,LabelText:G[M].userName,ImageBackColor:G[M].color,PersonaId:G[M].email,IsAnonymous:G[M].isAnonymous});Array.add(L,O)}}}Object(r.a)(d,"PresenceContextMenuSectionBuilder",null,[547]);var h=a(88),l=a(6),k=a(189),u=a(572),v=a(112),x=a(147),w=a(92),m=a(84),t=a(111),z=a(27);class y{constructor(G,L,M,O){this.Pbe=this.R3=this.Sj=this.BF=this.haa=null;this.W1b=G;this.sOg=O;this.W1b.CPa&&(this.Sj=new v.a(3,2,5E3,Object(h.a)(this,this.o4g,"authenticationCheckTask"),
2),l.AFrameworkApplication.Xi.wg(this.Sj),this.Ih(L,M));this.W1b.csb(()=>{this.OIf()});this.W1b.x1a(()=>{this.PIf()})}get businessBar(){return this.R3||(this.R3=m.a.instance.nh("CommonUI.IBusinessBar"))}get jGe(){return this.Pbe||(this.Pbe=m.a.instance.nh("CommonUI.IBusinessBarEntryFactory"))}Ih(G,L){const M=l.AFrameworkApplication.dc;M.pf(z.a.authenticationLost,t.a.frame,G,96);M.pf(z.a.VDe,t.a.frame,L,96);M.Hc(z.a.fIe,t.a.frame,k.ActionManager.ned);M.Hc(z.a.gIe,t.a.frame,k.ActionManager.ned);M.Hc(z.a.$Bd,
t.a.frame,k.ActionManager.ned)}OIf(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);l.AFrameworkApplication.dc.processAction(z.a.authenticationLost,2)}PIf(){this.E5j();l.AFrameworkApplication.dc.processAction(z.a.VDe,2)}o4g(){this.W1b.authenticationCheck()}E5j(){this.BF&&(this.BF.hide(),this.BF.dispose(),this.BF=null);this.haa&&this.businessBar&&(l.AFrameworkApplication.ih||this.businessBar.removeEntry(this.haa),this.haa.dispose(),this.haa=null)}showDialog(G){w.a.Ka(this.BF);this.BF=
new x.StandardDialog;this.sOg||(this.BF.Ru=!1,this.BF.Ac=0);this.BF.Qc(1,CommonUIStrings.l_SignIn);this.BF.QT(CommonUIStrings.l_DefaultDialogTitle,G,Object(h.a)(this,this.Hv,"dialogHandler"))}Hv(G){1===G?(u.a.r9(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),l.AFrameworkApplication.dc.processAction(z.a.$Bd,2)):(this.gSb(),l.AFrameworkApplication.dc.processAction(z.a.gIe,2))}gSb(){this.businessBar&&this.jGe&&(this.haa=this.jGe.create(CommonUIStrings.l_AuthenticationLostTitle,
CommonUIStrings.l_AuthenticationLostMessage,null),this.haa.closeable=!0,this.haa.addButton(CommonUIStrings.l_SignIn,y.K9g,""),this.haa.pca=Object(h.a)(this,this.M9g,"businessBarEntryCloseHandler"),this.businessBar.LD(this.haa,!1))}M9g(){this.vyh();l.AFrameworkApplication.dc.processAction(z.a.fIe,2)}vyh(){this.Sj&&(l.AFrameworkApplication.Xi.jq(this.Sj),this.Sj=null)}dispose(){this.Sj=this.BF=this.haa=null}static K9g(){u.a.r9();l.AFrameworkApplication.dc.processAction(z.a.$Bd,2)}}Object(r.a)(y,"SignOutResponseUI",
null,[2]);var D=a(261);class H{get name(){return"Common.App.UI"}Oi(G){G.register(d,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").gd()}init(){}dispose(){w.a.Ka(H.C4);H.C4=null}static main(){D.a.instance.wj(new H)}}H.C4=null;Object(r.a)(H,"CommonAppUIPackage",null,[4,5]);a.d(C,"a",function(){return F});const F=()=>{Type.registerNamespace("CAUI");H.main()}},1295:function(r,C,a){r=a(0);var c=a(92),b=a(230),e=a(52),f=a(40),d=a(236),h=a(15),l=
a(32),k=a(6),u=a(86),v=a(388),x=a(75),w=a(382),m=a(201),t=a(91),z=a(231),y=a(1),D=a(23),H=a(248);class F{constructor(K){this.$=K}get Sqf(){return this.$.workbookContext.FileCoauthorable}get AFb(){return!1}get v7a(){return this.$.ea.amIAlone}get kVe(){if(this.v7a)return!0;for(const K of this.$.ea.Eo)if(!K.SupportsRename)return!1;return!0}}Object(r.a)(F,"EwaCoauthManager",null,[166]);var G=a(59),L=a(77),M=a(27);class O extends u.a{constructor(K,R){super();this.bga=this.gTd=this.L5f=this.gdd=null;this.Wma=
()=>{var Z=this.$.ea.ao;if(Z&&Z.WorkbookFileName){var P=l.a.Sq(Z.WorkbookFileName),V=!!D.a.compare(this.$.workbookContext.WorkbookFileName,Z.WorkbookFileName,!1),Ea=y.EwaSettings.ya(465)&&!!Z.BreadcrumbFolderUrl&&!!D.a.compare(this.$.workbookContext.FullDocumentInfo.BreadcrumbFolderUrl,Z.BreadcrumbFolderUrl,!1);if(V||Ea)this.bga={},this.bga.NewFileName=P,this.bga.EditDocInClientUrl=Z.EditDocInClientUrl,this.bga.DirectInvokeDAVUrl=Z.DirectInvokeDAVUrl,this.bga.DownloadACopyUrl=Z.DownloadACopyUrl,y.EwaSettings.ya(465)&&
Z.BreadcrumbFolderUrl&&(this.bga.BreadcrumbFolderName=Z.BreadcrumbFolderName,this.bga.BreadcrumbFolderUrl=Z.BreadcrumbFolderUrl),Z=k.AFrameworkApplication.dc.Le(M.a.fileNameUpdate,2,P),this.bga=null,h.ULS.shipAssertTag(537154064,0,32===Z,"RenameFileManager.HandleWorkbookMetadataChanged - Workbook Name Update Failed")}};this.T4i=(Z,P,V)=>{this.L5f=P;this.gTd=V;this.$.Ia.mc(new t.a(1897077126,x.a.fc,2,3,null),{["newFileName"]:Z})};this.S4i=Z=>{this.bga&&Z(this.Kdf(this.bga),this.Mt)};this.oLb=Z=>{z.a(Z)||
!Z.Result?(Z=O.kZh(Z),L.a(this.$).$d.BN([-414480287,650565124,-782844485,1223808266,-62451516,1636785843]),this.gTd(Z)):this.L5f(this.Kdf(Z.Result),this.Mt)};this.Gaj=()=>{this.gTd(5)};this.$=K;this.Mt=R;this.$.ea.wv(this.Wma)}initialize(){k.AFrameworkApplication.vec=this.T4i;k.AFrameworkApplication.NMa=this.S4i;this.gdd=k.AFrameworkApplication.Lx;k.AFrameworkApplication.Lx=new F(this.$)}dispose(){k.AFrameworkApplication.vec=null;k.AFrameworkApplication.NMa=null;this.$.ea.hx(this.Wma);k.AFrameworkApplication.Lx=
this.gdd;this.$=this.gdd=null;super.dispose()}renameFile(K,R){const Z=K.newFileName;if(Z&&(K=l.a.Sq(this.$.workbookContext.WorkbookFileName),!y.EwaSettings.isChangeGateEnabled("OfficeVSO:7439298_CompareNewFileNameForRenameOperation")||D.a.compare(K,Z,!1))){const P=this.$.qa.va.Lc();w.a(this.$.userOperationManager,(V,Ea,oa)=>{var ea=this.$.qa.va;V=H.b(V,this.oLb);Ea=H.a(Ea,this.Gaj);const aa=ea.Pa(9,P);aa.newFileName=Z;return G.g(ea,"RenameFile",aa,V,Ea,oa,null,0)},V=>new m.a(134,0,V),R)}}AAi(){return 32===
k.AFrameworkApplication.dc.processAction(M.a.zka,1)}Kdf(K){var R=this.$.workbookContext;k.AFrameworkApplication.b0=K.DownloadACopyUrl;const Z=y.EwaSettings.ya(465)&&!!K.BreadcrumbFolderUrl;Z&&(k.AFrameworkApplication.zn.breadcrumbFolderName=K.BreadcrumbFolderName,k.AFrameworkApplication.zn.breadcrumbFolderUrl=K.BreadcrumbFolderUrl,R.FullDocumentInfo.BreadcrumbFolderUrl=K.BreadcrumbFolderUrl,R.FullDocumentInfo.BreadcrumbFolderName=K.BreadcrumbFolderName);R.FullDocumentInfo.BreadcrumbDocName=K.NewFileName;
v.d(R,K.NewFileName);R={};R.NewName=K.NewFileName;R.DirectInvokeDavUrl=K.DirectInvokeDAVUrl;R.EditDocInClientUrl=K.EditDocInClientUrl;Z&&(R.BreadcrumbFolderName=K.BreadcrumbFolderName,R.BreadcrumbFolderUrl=K.BreadcrumbFolderUrl);R.OperationResult=0;return R}static kZh(K){switch(K.Errors[0].MessageId){case -414480287:K=2;break;case 650565124:K=1;break;case 1636785843:K=6;break;case -782844485:K=4;break;default:K=5}return K}}Object(r.a)(O,"RenameFileManager",u.a,[625,2]);var B=a(55),E=a(100),I=a(149),
S=a(35);a.d(C,"a",function(){return J});class J extends b.a{constructor(K){super();this.L_=this.renameFileManager=null;this.$=K;this.uc()}create(){if(!this.L_){const K=d.a.O4a(B.b(),this.ka,"Task","IRenameFileManager");this.L_=K.task;const R=e.GetServiceTaskFactory.create(this.$.da,137,this.ka,this.La),Z=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateCommonUiStrings",!1)?Object(E.d)(I.a.resolve(S.p,{Wa:this.La})):e.GetServiceTaskFactory.create(this.$.da,155,this.ka,this.La);f.TaskExtensions.za(f.TaskExtensions.xe([Z,
R],this.ka),()=>{const P=new O(this.$,R.result);this.$.da.Ja(120,P);K.setResult(P)},this.ka,3)}this.L_.continueWith(K=>{this.$b(K.result)})}dispose(){c.a.Ka(this.renameFileManager);this.$=this.renameFileManager=null;super.dispose()}static la(K){K.da.Ja(119,new J(K))}}Object(r.a)(J,"RenameFileManagerServiceFactory",b.a,[])},1298:function(r,C,a){r=a(0);var c=a(2),b=a(15),e=a(31),f=a(92),d=a(14),h=a(126),l=a(425),k=a(86),u=a(9),v=a(71),x=a(467);class w{constructor(oa,ea){this.helpId=this.helpText=this.imageAltText=
this.urlValue=this.longDescription=this.convertToDomainName=this.cardViewManager=null;this.$=ea;this.parentElement=oa}Hmh(){const oa=this.Imh();x.a(this.$,243,242,0,ea=>{this.cardViewManager=ea;ea.rig(this.parentElement,2,oa)})}rkf(){this.cardViewManager&&this.cardViewManager.SOa(-1,-1,this.parentElement)}Imh(){const oa={layoutId:"AutoDetectTooltip"};oa.description=this.longDescription;oa.convertToDomainName=this.convertToDomainName;oa.longDescription=this.longDescription;oa.urlValue=this.urlValue;
oa.imageAltText=this.imageAltText;oa.helpText=this.helpText;oa.helpId=this.helpId;return oa}}Object(r.a)(w,"AutoDetectCardManager",null,[]);var m=a(36),t=a(218),z=a(32),y=a(232),D=a(20),H=a(54);class F extends k.a{constructor(oa,ea,aa){super();this.Ud=ia=>{if(ia.Fc.id===this.hMa.firstChild.id){ia=this.YDe;const ya={};ya.Id=ia.Itb;this.convertToLinkedEntityManager.dad(ya,!0,ia);this.hMa.removeChild(this.hMa.firstChild);return!0}return!1};this.YDe=oa;this.convertToLinkedEntityManager=ea;this.hMa=document.createElement("div");
this.hMa.className="clip16x16";this.lza=String.format('<input type="image" id="{0}" class="{1}" src="{2}" alt="Convert To Linked Entities Column Header Button">',z.a.xi("autodetectid"+this.YDe.left),D.a.hhd,H.a.yg(11));aa.Yh(this.hMa,this.lza);oa=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");y.a.instance.ta(d.a.click,oa,this.Ud)}get domElement(){return this.hMa}dispose(){if(this.hMa){const oa=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");y.a.instance.Aa(d.a.click,
oa,this.Ud)}super.dispose()}static get Q9g(){return"clip16x16"}}Object(r.a)(F,"AutoDetectColumnHeaderButton",k.a,[]);var G=a(1),L=a(1104),M=a(12),O=a(19),B=a(188);class E extends k.a{constructor(oa,ea,aa){super();this.Bc=null;this.$=oa;this.gridView=O.h(oa);this.convertToLinkedEntityManager=ea;this.Bc=aa;this.M9c=new B.a}dispose(){super.dispose()}Syh(oa){for(let ea of this.gridView.vka)for(let aa of ea){const ia=aa,ya=ia.Su,za=L.a(ia.m7);this.QSg(oa,za,ya);ia.kYd(za)}}QSg(oa,ea,aa){if(ea.length){var ia=
aa.length;aa[ia-1]<oa.left||(aa=M.HelperMethods.Ry(new t.a(aa),0,ia,oa.left,M.HelperMethods.eH),0>aa||!(ea=ea[aa]))||(this.gridView.rtl?ea.classList.add(m.a.ZMh):ea.classList.add(m.a.YMh),this.M9c.Pb(oa.left)||this.M9c.add(oa.left,new F(oa,this.convertToLinkedEntityManager,this.Bc)),oa=this.M9c.ma(oa.left).domElement,!ea.getElementsByClassName(F.Q9g).length&&this.R0j(ea)&&ea.appendChild(oa))}}R0j(oa){const ea=parseInt(oa.style.width,10);var aa=document.querySelector(".ewrch-col-cellsel")?"bold":"normal";
aa=E.toh(aa);oa=gridRenderer.CanvasRendererGlobals.measureTextWidth(this.Bc.eei(oa.firstChild.innerHTML),aa,!0,G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1));return 18.4<ea-(ea/2+oa/2)?!0:!1}static toh(oa){return`${"normal"} ${"normal"} ${oa} ${"10pt"}/${"normal"} ${'"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif'}`}}Object(r.a)(E,"AutoDetectColumnHeaderManager",k.a,[]);var I=a(434),S=a(25),J=a(74),K=a(150),R=a(13),Z=a(16),P=a(128),V=a(70);a.d(C,"a",function(){return Ea});
class Ea extends k.a{constructor(oa,ea,aa,ia,ya){super();this.isMac=e.a.isMac;this.f1a=-1;this.xac=null;this.rwa=-1;this.MO=this.Tpc=this.Z0d=this.s1=this.ZDe=!1;this.pV=null;this.Uf=()=>{this.wza&&this.gridView&&this.KY()};this.kd=()=>{this.Wx()};this.Ud=()=>{this.lLa();O.h(this.$).$g(!0,!1)};this.ufa=(la,xa)=>{xa?(this.Qsg(this.xac),this.qib()):(la=[29],this.gridView.pc.Sk(la),this.gridView.pc.rl(null,la),this.pV&&this.pV.rkf())};this.Lj=()=>{this.R$a()&&this.Fi.hide();1===this.gridView.ga.rf&&
this.KY()};this.hy=()=>{const la=this.gridView.ga.rf;this.gridView.ga.pa.activeCell&&1===la&&this.KY()};this.onKeyUp=la=>this.NHb?this.s1?!1:17===la.Da.keyCode&&this.Z0d?(this.MO?(this.qib(),this.sga()):this.kRb(),!0):!1:this.s1=!1;this.onKeyDown=la=>{if(!this.NHb)return this.s1=!1;this.Z0d=!1;this.s1=la.ctrlKey;switch(la.Da.keyCode){case 27:return this.MO?(this.ufa(null,!1),this.sga()):this.pV&&(this.pV.rkf(),this.kRb()),!0;case 13:if(this.MO)return this.MO=!1,this.lLa(),!0;break;case 17:return this.Z0d=
!0}return!1};const {AutoDetectActionButton:za}=a(1398);this.$=oa;this.Jtb=G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AutoDetectRichTooltip",!1);ea||b.ULS.sendTraceTag(537166983,0,15,"AutoDetectManager: SVG icons are enabled, but svgIconProvider is null");this.convertToLinkedEntityManager=ia;ia.HMb();this.Fi=new za(oa,ea,this.Ud,aa,"");this.s4g=new E(this.$,ia,ya);this.gridView=O.h(this.$);this.gridView.ga.ND(this.Uf);this.gridView.Gc.y1a(this.Uf);this.gridView.ut(this.hy);oa.ik(this.kd);
oa.kA(this.Lj);this.gridBlockManager=Object(h.a)(456,this.gridView.Ca);this.Ip=oa.frame.jv;this.KY()}get Wc(){return this.Fi.domElement(1)}get NHb(){const oa=this.Fi.domElement(Ea.vha);return oa?R.DOMElementExtensions.isVisible(oa):!1}get wza(){return this.$.isEditMode&&G.EwaSettings.ya(128)&&G.EwaSettings.ya(131)&&(new K.a(this.$.ua)).ki?!1:-1!==this.rwa}dispose(){this.gridView&&this.gridView.ga.aD(this.Uf);if(this.$){const oa=this.$;oa.Wl(this.kd);oa.$C(this.Lj);O.h(oa).$v(this.hy)}f.a.Ka(this.Fi);
this.Ip=this.$=this.gridView=this.Fi=null;super.dispose()}Wx(){this.ufa(null,!1);this.f1a=-1;this.Fi.hide();this.Hbk();this.MO=!1}sga(){this.Fi.getButton(Ea.vha).tgb();this.MO=!1}kRb(){this.Fi.getButton(Ea.vha).pTa();this.Qsg(this.xac);this.MO=!0;this.$.da.Qb(211,oa=>{oa.Gpa(Z.a.instance.ha(1751))})}onAutoDetectUIShown(){if(this.wza&&-1!==this.f1a)this.convertToLinkedEntityManager.onAutoDetectUIShown()}t4g(oa){var ea=new S.Range(1===oa.top?1:oa.top-1,oa.left,oa.bottom,oa.right,!0,!1);ea=this.gridView.getRangeInformation(ea);
for(const aa of ea)if(Object(l.a)(I.AutoDetectRange,aa)&&this.Fmc(oa,!1,aa))return!0;return!1}lLa(){if(this.wza&&-1!==this.f1a){this.Fi.getButton(Ea.vha).pTa();var oa={};oa.Id=this.rwa;oa.StringId=null;this.convertToLinkedEntityManager.dad(oa,!0,this.xac);b.ULS.sendTraceTag(594612633,0,50,"AutoDetectManager.Convert (AssistedAutoConvertMenuConvertClicked)");oa=[Object(c.a)(new V.a,{name:"Domain",int64:this.rwa})];P.a("AssistedAutoConvertMenuConvertClicked",void 0,void 0,oa);this.rwa=-1}}q1h(){let oa=
Z.a.instance.ha(1747);if(-1!==this.rwa){oa+=" ";try{oa+=this.convertToLinkedEntityManager.jHb(this.rwa.toString())}catch(ea){b.ULS.sendTraceTag(537166982,0,10,`AutoDetectManager.GetButtonAccessibilityString: Could not obtain name from domain ${this.rwa}`)}}oa+=" ";return oa=this.Jtb?oa+Z.a.instance.ha(1750):oa+Z.a.instance.ha(this.isMac?1749:1748)}qib(){this.Jtb&&(this.pV||(this.pV=new w(this.Wc,this.$),this.pV.convertToDomainName=Z.a.instance.ha(1752),this.pV.urlValue="https://support.content.office.net/en-us/media/758743e7-a2ca-42db-9f43-a45b05b1b077.png",
this.pV.imageAltText=Z.a.instance.ha(1754),this.pV.helpId="HID_DataTypes_Wolfram",this.pV.helpText=Z.a.instance.ha(1753)),this.pV.longDescription=this.convertToLinkedEntityManager.V4d(this.f1a.toString()),this.pV.Hmh())}Fmc(oa,ea,aa){if((new S.Range(aa.top,aa.left,aa.bottom===u.a.Sg?aa.bottom:aa.bottom+1,aa.right,!0,!1)).Yd(oa)){if(ea){if(aa&&aa.Itb!==this.f1a){this.f1a=aa.Itb;oa=aa.Itb.toString();ea=this.Jtb?"":this.convertToLinkedEntityManager.V4d(oa);const ia=this.convertToLinkedEntityManager.Yqi(oa);
this.Fi.tkb(this.convertToLinkedEntityManager.jHb(oa),ea,ia,Ea.vha)}this.rwa=aa.Itb;this.xac=aa}return!0}return!1}KY(){if(this.convertToLinkedEntityManager){var oa=this.gridView.ga.rf;if(this.gridBlockManager&&this.gridBlockManager.Erd){var ea=this.gridView.ga.pa.activeCell,aa=!this.gridBlockManager.Or(ea),ia=this.gridView.getRangeInformation(this.gridView.sk);for(const ya of ia)if(Object(l.a)(I.AutoDetectRange,ya))switch(ia=ya,ia.oeh){case 3:if(this.Fmc(ea,!0,ia)){if(1!==oa||aa){this.Wx();return}b.ULS.sendTraceTag(537166981,
0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (AssistedAutoConvertTriggered)");this.jRd();this.Fi.Y2(ea,this.ufa);this.ZDe||(this.ZDe=!0,this.onAutoDetectUIShown());return}break;case 2:case 1:(G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.LoadClassifier",!1)||G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.PasteClassifier",!1))&&this.s4g.Syh(ia);break;default:b.ULS.sendTraceTag(537166980,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (Invalid LinkedEntityClassifierTrigger used)")}}this.Wx()}}Qsg(oa){const ea=
[29];this.gridView.pc.rl(oa,ea);this.gridView.pc.fs(ea)}R$a(){return this.$.ea.isNamedObjectViewMode&&J.f(this.$.na)}jRd(){this.Jtb&&!this.Tpc&&this.Ip&&(this.Ip.Tt(d.a.Ic,this.$.domElement,this.onKeyDown,!0),this.Ip.Tt(d.a.De,this.$.domElement,this.onKeyUp,!0),this.Tpc=!0)}Hbk(){this.Jtb&&this.Tpc&&this.Ip&&(this.Ip.fu(d.a.Ic,this.$.domElement,this.onKeyDown,!0),this.Ip.fu(d.a.De,this.$.domElement,this.onKeyUp,!0),this.Tpc=!1)}static get vha(){return 1}static w3h(oa){return Z.a.instance.ha(1808)+
v.a.space+oa}}Object(r.a)(Ea,"AutoDetectManager",k.a,[])},1302:function(r,C,a){var c=a(10);r=a(0);var b=a(230),e=a(15),f=a(42),d=a(1);class h extends f.a{constructor(){super()}A5d(v,x){e.ULS.sendTraceTag(537154185,0,50,`ProactiveSuggestionManager.TriggerProactiveSuggestion: proactive suggestion was triggered. Range: ${v}, TriggerType: ${x}`);if(d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.DataCleansingProactiveSuggestion",!1))switch(x){case 0:this.raiseEvent("pssort",void 0,v);
break;case 1:this.raiseEvent("psfilter",void 0,v);break;case 2:this.raiseEvent("pscrttbl",void 0,v)}}}Object(r.a)(h,"ProactiveSuggestionManager",f.a,[627]);var l=a(727);class k extends b.a{constructor(v){super();this.$=v;this.uc()}create(){let v=Object(l.a)(this.$.da,476,()=>new h);this.$b(v)}static la(v){v.da.Ja(475,new k(v))}}Object(r.a)(k,"ProactiveSuggestionManagerFactory",b.a,[]);a.d(C,"a",function(){return u});const u=()=>{c.a.Fa(v=>{k.la(v)})}},1303:function(r,C,a){var c=a(10);r=a(0);var b=
a(84),e=a(230),f=a(234),d=a(34),h=a(19);class l{constructor(x,w){this.wqe=this.PSc=!1;this.VBa=(m,t)=>{(null===t||void 0===t?0:t.NI)&&d.a.M2g([t.NI])&&(this.dQb=!0)};this.ho=()=>{this.dQb=!1};this.Md=(m,t)=>{f.b(t)&&this.uha(!0);this.dQb=!1};this.ee=()=>{this.yS=this.$.yS;this.uha()};this.QQf=()=>{this.bU()};this.VPf=()=>{this.yS=this.$.yS};this.OId=()=>{h.h(this.$).Ca.gx(this.OId);this.yS=this.$.yS};this.S$f=w;this.$=x;this.$.userOperationManager.zs(this.VPf);this.$.$l(this.ee);this.$.ea.hZg(this.QQf);
this.$.ea.Mk(this.Md);this.$.K4b(this.VBa);this.$.ea.VK(this.ho);this.uha()}get hMi(){return this.$.ea?this.$.ea.Yxf:!1}get yS(){return this.PSc}set yS(x){x?this.PSc=!0:h.h(this.$)&&h.h(this.$).Ca&&(h.h(this.$).Ca.z7()?this.PSc=!1:h.h(this.$).Ca.Aw(this.OId));this.bU()}get dQb(){return this.wqe}set dQb(x){this.wqe=x;this.bU()}dispose(){this.$&&(this.$.hn(this.ee),this.$.mAc(this.VBa),this.$.userOperationManager&&this.$.userOperationManager.fp(this.VPf),this.$.ea&&(this.$.ea.Yzj(this.QQf),this.$.ea.Vk(this.Md),
this.$.ea.EP(this.ho)),h.h(this.$)&&h.h(this.$).Ca&&h.h(this.$).Ca.gx(this.OId))}uha(x=!1){x=!this.$.isEditMode||x;this.S$f.uha(x,this.$.isEditMode?3:1);this.bU()}bU(){this.$.isEditMode&&this.S$f.bU(!this.yS&&!this.hMi&&!this.dQb)}}Object(r.a)(l,"SaveStatusManager",null,[2]);var k=a(727);class u extends e.a{constructor(x){super();this.Rd=x;this.uc()}create(){const x=b.a.instance;x.Dc("Common.App.SaveStatus.ISaveStatusUIHandler").execute(w=>{const m=new l(this.Rd,w);x.register(l,"Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager").gd().od(()=>
m);w=Object(k.a)(this.Rd.da,300,()=>x.resolve("Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager"));this.$b(w)})}static la(x){x.da.Ja(299,new u(x))}}Object(r.a)(u,"SaveStatusFactory",e.a,[]);a.d(C,"a",function(){return v});const v=()=>{c.a.Fa(u.la)}},1304:function(r,C,a){var c=a(10);r=a(0);var b=a(230),e=a(40),f=a(19),d=a(15),h=a(36),l=a(218),k=a(25),u=a(74),v=a(1),x=a(1104),w=a(12),m=a(170),t=a(14),z=a(180),y=a(232),D=a(162),H=a(71),F=a(95),G=a(150);class L{constructor(J,K,R){this.cRa=
1;this.mba=[];this.active=!1;this.Bc=null;this.onPointerDown=Z=>{v.EwaSettings.oJ()?this.gridView.setLastInputMethod(Z.Da.rawEvent):D.a.slim(Z.Da.rawEvent);return!1};this.ly=()=>{const Z=this.gridView.bqd();if(!(0>=Z||Z===this.cRa||this.gridView.es)){var P=!1,V=[],Ea=[];for(var oa=this.mba.length-1;0<=oa;oa--){var ea=this.mba[oa];if(this.aqd(ea)>Z||ea.bottom<Z)V.push(ea),this.mba.splice(oa,1),P=!0}for(oa=this.tableManager.rangeList.length-1;0<=oa;oa--){ea=this.tableManager.rangeList[oa];const aa=
this.aqd(ea);aa<=Z&&ea.bottom>=Z&&!(aa<=this.cRa&&ea.bottom>=this.cRa)&&ea.Zma&&(Ea.push(ea),P=!0)}if(P){ea=this.gridView.Jwc;for(let aa of ea)for(let ia of aa)for(let ya of ia)this.xnc?this.Ndh(ya,V,Ea):this.Odh(ya,V,Ea,P)}else d.ULS.sendTraceTag(537157657,0,50,"HeaderSnappingFeature:OnVisibleAreaChanged: detected an opportunity for bailing out");this.cRa=Z}};this.nNf=(Z,P)=>{P.isRow||P.m3c(this.kkc)};this.oNf=(Z,P)=>{P.isRow||(this.tableManager.rangeList.length||this.deactivate(),P.bTd(this.kkc))};
this.kkc=(Z,P)=>{if(this.He())this.activate();else if(Z=this.active,this.deactivate(),!Z){d.ULS.sendTraceTag(537157652,0,50,"HeaderSnappingFeature:HeaderBlockOnUpdatedBlock: detected an opportunity for bailing out");return}(P=P.Wq)&&this.ykg(P.m7,P)};this.WPf=(Z,P)=>{!this.gridView.es&&(this.He()?this.activate():(Z=this.active,this.deactivate(),Z||d.ULS.sendTraceTag(537157651,0,50,"HeaderSnappingFeature:OnRangeListUpdated: detected an opportunity for bailing out")),P=P.Wq)&&(Z=x.a(P.m7),this.ykg(Z,
P)&&P.kYd(Z))};this.Oe=()=>{this.gridView.Mb.VW?this.deactivate():this.activate()};this.tableManager=J;this.gridView=K;this.$=K.$;this.Bc=R;J.X2c(this.WPf);K.tXg(this.nNf);K.uXg(this.oNf);this.$.ua.Vg(this.Oe);this.$.oc.Vg(this.Oe);this.sCe(Z=>{Z.m3c(this.kkc)});this.He()&&(this.activate(),this.ly(this,null));this.$.da.Ja(68,this)}dispose(){this.deactivate();this.gridView&&(this.tableManager.QSd(this.WPf),this.gridView.Dyj(this.nNf),this.gridView.Eyj(this.oNf),this.$.ua.xh(this.Oe),this.$.oc.xh(this.Oe),
this.sCe(J=>{J.bTd(this.kkc)}));this.gridView=this.tableManager=this.mba=null}get xnc(){return this.gridView.KE}eIc(J,K,R){if(!u.b(this.$.na)||this.$.ea.isNamedObjectViewMode||this.gridView.Mb.DEa)return K&&d.ULS.sendTraceTag(509166923,0,50,"HeaderSnappingFeature.toggleHeaderSnapping: Header snapping should be disabled in named object view or in top row frozen."),!0;const Z=R.agf();var P=Z.length;if(Z[P-1]<J.left)return!1;var V=w.HelperMethods.Ry(new l.a(Z),0,P,J.left,w.HelperMethods.eH);if(0>V)return!1;
const Ea=J.y4d,oa=J.bEe;P=Math.min(Ea.length+V,P);let ea=0;if(!oa)return d.ULS.sendTraceTag(509220160,0,10,"HeaderSnappingFeature.toggleHeaderSnapping: autoFilterDatas should be initialized."),!1;for(;V<P;V++){const aa=Z[V];K?(R.updateCellText(V,Ea[ea]),R.updateCellAlignment(V,!0),R.activateCellAutoFilter(V,oa[ea]),this.Iwe(J,ea,aa)):(R.updateCellText(V,k.Range.xR(aa)),R.updateCellAlignment(V,!1),R.deactivateCellAutoFilter(V),this.UVe(aa));K&&R.jOj();ea++}R.kn("HeaderSnappingFeature::toggleHeaderSnapping");
J.XDa=K;return!0}fIc(J,K,R,Z){if(!u.b(this.$.na)||this.$.ea.isNamedObjectViewMode||this.gridView.Mb.DEa)return!0;if(!R.length)return!1;var P=Z.length;if(Z[P-1]<J.left)return!1;var V=w.HelperMethods.Ry(new l.a(Z),0,P,J.left,w.HelperMethods.eH);if(0>V)return!1;const Ea=J.y4d,oa=!!J.k3a&&0<J.k3a.length,ea=!!J.menuModel&&0<J.menuModel.length;for(let ya=V,za=0,la=Math.min(Ea.length+V,P);ya<la;ya++,za++)if(P=R[ya]){var aa=null;(V=P.getElementsByClassName(h.a.yhd))&&(aa=V[0]);if(aa&&aa.innerText){if(V=P.getElementsByClassName(h.a.aAe))for(var ia=
V.length-1;0<=ia;ia--)P.removeChild(V[ia]);V=Z[ya];K?(aa.innerText=Ea[za],P.classList.add(h.a.y1e),oa&&J.k3a[za]&&(aa=document.createElement("div"),this.Bc.Yh(aa,J.k3a[za]),ia=J.k3a[za].split(H.a.$0g),3===ia.length?(ia=F.a.Yf(ia[1]),this.awe(aa.firstChild,ia),m.a.instance.ta(t.a.mg,aa.firstChild,this.onPointerDown),z.a.instance.ta(t.a.vq,aa.firstChild,this.onPointerDown)):(ia=new G.a(this.$.ua),(ia.He(2048)||ia.He(4096))&&d.ULS.sendTraceTag(509678873,0,10,"HeaderSnappingFeature.toggleHeaderSnappingHtml: buttonHtml doesn't contain click/pointer handlers for ShowAutoFilterMenu"),
this.awe(aa.firstChild,null)),ea&&J.menuModel[za]&&this.Iwe(J,za,V),P.appendChild(aa.firstChild))):(P.classList.remove(h.a.y1e),aa.textContent=k.Range.xR(V),this.UVe(V))}}J.XDa=K;return!0}awe(J,K){y.a.instance.ta(t.a.click,J,R=>{K&&(v.EwaSettings.oJ()?this.gridView.hVd(R.Da.rawEvent,966232027,K,this.$.get_id()):D.a.hrc(R.Da.rawEvent,966232027,K,this.$.get_id()));return!0})}Iwe(J,K,R){this.$.da.Qb(8,Z=>{Z.cfc.P7i(J,K,R)})}UVe(J){this.$.da.Qb(8,K=>{K.cfc.Q7i(J)})}Odh(J,K,R,Z){const P=J.Su,V=x.a(J.m7);
let Ea;for(let oa=K.length-1;0<=oa;oa--)Ea=K[oa],this.fIc(Ea,!1,V,P)&&K.splice(oa,1);for(K=R.length-1;0<=K;K--)Ea=R[K],this.fIc(Ea,!0,V,P)&&this.mba.push(Ea);Z&&J.kYd(V)}Ndh(J,K,R){if(J.Pah()){for(var Z=K.length-1;0<=Z;Z--)this.eIc(K[Z],!1,J)&&(d.ULS.sendTraceTag(509166921,0,50,"HeaderSnappingFeature.checkTablesForSnapping: Table deactivation succeeded"),K.splice(Z,1));for(K=R.length-1;0<=K;K--)Z=R[K],this.eIc(Z,!0,J)&&(d.ULS.sendTraceTag(509166919,0,50,"HeaderSnappingFeature.checkTablesForSnapping: Table activation succeeded"),
this.mba.push(Z))}else d.ULS.sendTraceTag(509166922,0,15,"HeaderSnappingFeature.checkTablesForSnapping: headerViewBlock can't be snapped")}ykg(J,K){const R=this.xnc?K.agf():K.Su;var Z=R[0];const P=R[R.length-1],V=this.Ehi(Z,P);let Ea=!1;for(let oa=this.mba.length-1;0<=oa;oa--){const ea=this.mba[oa];P>=ea.left&&Z<=ea.right&&(this.xnc?this.eIc(ea,!1,K):this.fIc(ea,!1,J,R),this.mba.splice(oa,1),Ea=!0)}for(let oa=0,ea=V.length;oa<ea;oa++)if(Z=V[oa],this.xnc?this.eIc(Z,!0,K):this.fIc(Z,!0,J,R))this.mba.push(V[oa]),
Ea=!0;return Ea}activate(){this.He()&&!this.active&&(this.gridView.view.As(this.ly),this.active=!0)}deactivate(){this.active&&(this.gridView.view.wq(this.ly),this.active=!1)}He(){return u.b(this.$.na)&&!this.$.ea.isNamedObjectViewMode&&0>=this.gridView.Mb.zQ&&0<this.tableManager.rangeList.length}sCe(J){const K=this.gridView.Jwc;for(let R of K)for(let Z of R)for(let P of Z)J(P)}Ehi(J,K){const R=[];if(!this.active)return R;this.cRa=this.gridView.bqd();for(let Z=this.tableManager.rangeList.length-1;0<=
Z;Z--){const P=this.tableManager.rangeList[Z];P.bottom>=this.cRa&&this.aqd(P)<=this.cRa&&P.left>=J&&P.right<=K&&P.Zma&&R.push(P)}return R}aqd(J){const K=this.gridView.Wb.rh(J);return K&&this.tableManager.wrf(J,K.usedRange.topLeft)?J.top+1:J.top}}Object(r.a)(L,"HeaderSnappingFeature",null,[2]);var M=a(100),O=a(149),B=a(35),E=a(52);class I extends b.a{constructor(J){super();this.$=J;this.uc()}create(){const J=v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateTableManager",!1)?Object(M.d)(O.a.resolve(B.Db,
{Wa:this.La})):E.GetServiceTaskFactory.create(this.$.da,134,this.ka,this.La),K=Object(M.d)(O.a.resolve(B.W,{Wa:this.La}));e.TaskExtensions.za(e.TaskExtensions.xe([K],this.ka),()=>{e.TaskExtensions.za(e.TaskExtensions.xe([J],this.ka),()=>{this.$b(this.$.da.Ba(68)||new L(J.result,f.h(this.$),K.result))},this.ka,11)},this.ka,3)}static la(J){J.da.Ja(67,new I(J))}}Object(r.a)(I,"HeaderSnappingFactory",b.a,[]);a.d(C,"a",function(){return S});const S=()=>{c.a.Fa(I.la)}},1305:function(r,C,a){r=a(0);var c=
a(15),b=a(88),e=a(1399),f=a(1117),d=a(6),h=a(14),l=a(112),k=a(179);class u{constructor(y,D,H,F,G){this.vRc=this.IHa=null;this.LZa=this.vMc=!1;this.Me=D;this.P_b=y;this.ita=H;this.QQ=F;this.rWc=G;this.K2f(null)}K2f(){const y=document.getElementById(d.AFrameworkApplication.Zsb);!this.LZa&&this.QQ&&y&&(this.QQ.ta(h.a.fBa,y,Object(b.a)(this,this.fGd,"mouseActivityHandler"),null),this.LZa=!0);this.rWc(()=>{this.dispose()})}fGd(){this.LZa&&(this.QQ.Aa(h.a.fBa,document.getElementById(d.AFrameworkApplication.Zsb),
Object(b.a)(this,this.fGd,"mouseActivityHandler")),this.LZa=!1);this.sve();return!1}sve(){this.vMc=!0;this.vRc||(this.vRc=new l.a(3,2,this.P_b,Object(b.a)(this,this.K2f,"registerHandlerTask"),112),this.Me.wg(this.vRc));this.IHa||(this.DQb(null),this.IHa=new l.a(3,2,this.P_b,Object(b.a)(this,this.DQb,"sendPostMessageIfNecessary"),111),this.Me.wg(this.IHa))}DQb(){this.vMc&&(this.ita.CWR(()=>this.ita.result.sendMessage(k.a.aik,null)),c.ULS.sendTraceTag(38405446,209,50,"UserActivityHostNotificationManager: sending post message to the host."),
this.vMc=!1)}dispose(){this.LZa&&(this.QQ.Aa(h.a.fBa,document.getElementById(d.AFrameworkApplication.Zsb),Object(b.a)(this,this.fGd,"mouseActivityHandler")),this.LZa=!1)}}Object(r.a)(u,"UserActivityHostNotificationManager",null,[510,2]);var v=a(180),x=a(261),w=a(108),m=a(529);class t{constructor(){this.Nb=null}get name(){return"Common.App.EditNotification"}init(){d.AFrameworkApplication.fa&&d.AFrameworkApplication.fa.Rv(Object(b.a)(this,this.KC,"onFullAppSettingsReady"))}KC(){t.editNotificationIsEnabled&&
0<t.hfd&&(this.Nb.register(e.a,"Common.App.HostNotification.EditNotificationEventSource").gd(),this.Nb.register(u,"Common.App.HostNotification.UserActivityHostNotificationManager").as("Common.Interface.IUserActivityHostNotificationManager").gd().od(()=>new u(6E4,w.a.instance,m.a.mr(this.Nb.Dc("Postmessage.IHostPostmessenger")),v.a.instance,d.AFrameworkApplication.Pib)),this.Nb.register(f.a,"Common.App.HostNotification.EditNotificationManager").as("Common.Interface.IEditNotificationManager").gd().od(()=>
new f.a(t.hfd,w.a.instance,m.a.mr(this.Nb.Dc("Postmessage.IHostPostmessenger")),this.Nb.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.Nb.nh("Common.Interface.IUserActivityHostNotificationManager"),t.editNotificationPostMessageIsEnabled,t.yBh)),this.Nb.resolve("Common.Interface.IEditNotificationManager"),c.ULS.shipAssertTag(38086291,209,0<t.hfd,"EditNotification Interval is less than or equal to 0."))}Oi(y){this.Nb=y}dispose(){}static get hfd(){return d.AFrameworkApplication.fa?
parseInt(d.AFrameworkApplication.fa.appSettings.EditNotificationTimeIntervalMs||"300000"):3E5}static get yBh(){return d.AFrameworkApplication.fa?parseInt(d.AFrameworkApplication.fa.appSettings.EditDocumentUserActionTelemetryReportingIntervalInMilliseconds||"0"):0}static get editNotificationIsEnabled(){return!!d.AFrameworkApplication.fa&&d.AFrameworkApplication.fa.ra("EditNotificationIsEnabled")}static get editNotificationPostMessageIsEnabled(){return!!d.AFrameworkApplication.fa&&d.AFrameworkApplication.fa.ra("EditNotificationPostMessageIsEnabled")}static main(){x.a.instance.wj(new t)}}
Object(r.a)(t,"CommonHostNotificationPackage",null,[4,5]);a.d(C,"a",function(){return z});const z=()=>{Type.registerNamespace("Common.App.HostNotification");t.main()}},1306:function(r,C,a){r=a(0);var c=a(88),b=a(111),e=a(933),f=a(746),d=a(27);class h{constructor(x,w){this.Tmb=null;this.Na=x;this.Ra=w}Ih(){(this.Tmb=this.Ra.Va("StatusBarEnvironmentNameToUse"))&&""!==this.Tmb&&this.Na.pf(d.a.AZf,b.a.frame,Object(c.a)(this,this.yek,"updateEnvironmentName"),96)}yek(x,w,m,t,z){if(1===m)return 32;z[e.a.Value]=
this.Tmb;z[f.a.Qi]=this.Tmb;z[e.a.Visible]=!0;return 32}}Object(r.a)(h,"DisplayEnvironmentName",null,[]);var l=a(6),k=a(261);class u{constructor(){this.Nb=null}get name(){return"Common.App.DisplayEnvironmentName"}Oi(x){this.Nb=x;this.Nb.register(h,"Common.App.DisplayEnvironmentName.DisplayEnvironmentName").gd().od(()=>new h(l.AFrameworkApplication.dc,l.AFrameworkApplication.fa))}init(){this.Nb.resolve("Common.App.DisplayEnvironmentName.DisplayEnvironmentName").Ih()}dispose(){}static main(){k.a.instance.wj(new u)}}
Object(r.a)(u,"DisplayEnvironmentNamePackage",null,[4,5]);a.d(C,"a",function(){return v});const v=()=>{Type.registerNamespace("Common.App.DisplayEnvironmentName");u.main()}},1307:function(r,C,a){var c=a(10);r=a(0);var b=a(230),e=a(15),f=a(32),d=a(94),h=a(201),l=a(59),k=a(12),u=a(248),v=a(466),x=a(19),w=a(114),m=a(128),t=a(55);class z{constructor(F){this.uW=null;this.rBf=new Set;this.kvf=!1;this.x1=(G,L)=>{if(!this.rBf.has(G)){var M=[];if(L){const O=x.h(this.$).Wb.rh(L,!1);if(!O){1!==L.top||1!==L.left||
this.kvf||(M.push(w.a.Ig("IsTableOnA1","false",1)),m.a("MsFormsTableUsage",void 0,void 0,M),this.kvf=!0);return}if(1!==O.usedRange.top||1!==O.usedRange.left)return}L=t.b().uk(G);M.push(w.a.Ig("Command",L,2));m.a("MsFormsTableUsage",void 0,void 0,M);this.rBf.add(G)}};this.m7d=(G,L)=>{if(!this.$.ea.Dh.get(61)||d.k(this.$.Df))d.k(this.$.Df)&&L&&L.item.name===this.uW.GL&&this.eEe();else if(this.$.ua.Pk(this.uW.Qzb)){const M={};M.SheetName=this.uW.Qzb;M.NamedObjectName=this.uW.Qzb;M.FirstColumn=0;M.FirstRow=
0;M.LastColumn=0;M.LastRow=2;const O=E=>{if(!d.k(this.$.Df)){if(null===E||void 0===E?0:E.Result)this.$.workbookContext.MsFormId=E.Result[0][0],this.uW.GL=E.Result[1][0],E=E.Result[2][0],this.KM(!!this.$.workbookContext.MsFormId&&this.cKi(E),1024),this.eEe();d.c(this.$.Df)&&(L?e.ULS.sendTraceTag(537155357,0,50,`Created MsForm successfully, Form Id:${f.a.Av(this.$.workbookContext.MsFormId).toString()}`):e.ULS.sendTraceTag(537155356,0,50,`Reopening workbook that is connected to MsForm, Form Id:${f.a.Av(this.$.workbookContext.MsFormId).toString()}`));
d.c(this.$.Df)&&!L&&e.ULS.sendTraceTag(537155355,0,50,`reopening workbook that is connected to MsForm, Form Id:${f.a.Av(this.$.workbookContext.MsFormId).toString()}`);!d.c(this.$.Df)&&L||this.KM(!0,2048)}},B=this.$.qa.va.Lc();this.$.userOperationManager.uG(new h.a(159,0,(E,I,S)=>l.r(this.$.qa.gy,M,!1,u.b(E,O),I,S,null,B),16))}else L||this.KM(!0,2048)};this.P9i=(G,L)=>{L&&L.item.name===this.uW.Qzb&&(this.KM(!1,1024),this.KM(!0,2048))};this.$=F}uak(){this.uW=v.a.current;this.m7d(null,null);this.$.ua.yja(this.m7d);
this.$.ua.e_(this.P9i)}dispose(){this.$.ua.Qpa(this.m7d)}cKi(F){if(!F)return!0;const G=RegExp("-","g"),L=this.$.workbookContext.MsFormDocUrl.toLowerCase();return L.includes(F.toLowerCase())||L.includes(F.toLowerCase().replace(G,""))?!0:!1}eEe(){d.c(this.$.Df)&&this.uW.GL&&this.$.ua.na&&this.$.ua.na.name!==this.uW.GL&&this.$.ua.Pk(this.uW.GL)&&this.$.ua.getItemByName(this.uW.GL).activate()}KM(F,G){this.$.workbookContext.Options=k.HelperMethods.VP(F,this.$.workbookContext.Options,G)}}Object(r.a)(z,
"MsFormInfoUpdatingService",null,[500,2]);var y=a(727);class D extends b.a{constructor(F){super();this.msFormInfoUpdatingService=null;this.$=F;this.uc()}create(){this.$b(Object(y.a)(this.$.da,237,()=>this.msFormInfoUpdatingService||(this.msFormInfoUpdatingService=new z(this.$))));this.msFormInfoUpdatingService.uak()}static la(F){F.da.Ja(236,new D(F))}}Object(r.a)(D,"MsFormInfoUpdatingServiceFactory",b.a,[]);a.d(C,"a",function(){return H});const H=()=>{c.a.Fa(D.la)}},1333:function(r,C,a){r=a(0);var c=
a(230),b=a(997);class e extends c.a{constructor(l){super();this.$=l;this.uc()}create(){this.$b(this.$.da.Ba(5)||new b.BusinessBarManager(this.$,!this.$.T0))}static la(l){l.da.Ja(4,new e(l))}}Object(r.a)(e,"BusinessBarManagerFactory",c.a,[]);var f=a(10),d=a(72);a.d(C,"a",function(){return h});const h=()=>{Object(d.b)("OfficeVSO:7811663_ConvertBusinessBarManagerService2")||f.a.Fa(e.la)};String(b);window.___1684780567520_closurehack=b},1334:function(r,C,a){r=a(0);var c=a(828),b=a(230);class e extends b.a{constructor(){super();
this.uc()}create(){this.$b(new c.a)}}Object(r.a)(e,"CommonUIJsServiceFactory",b.a,[]);var f=a(10);a.d(C,"a",function(){return d});const d=()=>{f.a.Fa(h=>{h.da.Ja(203,new e)})}},1335:function(r,C,a){r=a(0);var c=a(159),b=a(617);class e extends b.a{constructor(){super()}dispose(){c.WacAirSpace.wvd()&&c.WacAirSpace.dIc()}animate(h,l,k,u,v){l&&c.WacAirSpace.IM(h.element,l);c.WacAirSpace.animate(h,u,v);k&&c.WacAirSpace.dwj(h.element,k)}}Object(r.a)(e,"AnimationManager",b.a,[2]);var f=a(104);a.d(C,"a",
function(){return d});const d=()=>{f.a.Em.Ja(141,new e)}},1343:function(r,C,a){r=a(0);var c=a(230),b=a(52),e=a(40),f=a(1),d=a(15);class h{constructor(k){this.jWa=!0;h.hpf()?h.Azi()?this.jWa=!1:h.upf()?(d.ULS.sendTraceTag(526434368,0,50,`LineageCatchUpExperimentManager is running in hybrid mode. TUI exhausted: ${!k}`),this.jWa=k):this.jWa=!1:this.jWa=!0}I$a(){return!this.jWa}static upf(){return h.hpf()&&f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LineageCatchUpIntegrationTeachingUXTreatmentToControl",
!1)}static hpf(){return f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LineageCatchUpIntegrationSummaryStringTreatment",!1)}static Azi(){return f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BlueDot",!1)}}Object(r.a)(h,"LineageCatchUpExperimentManager",null,[692]);a.d(C,"a",function(){return l});class l extends c.a{constructor(k){super();this.$=k;this.uc()}create(){h.upf()?e.TaskExtensions.za(b.GetServiceTaskFactory.Za(this.$.da,456,457,this.La),k=>{e.TaskExtensions.za(k.result.WVj(),
u=>{this.lPe(u.result)},this.$.ka,3)},this.$.ka,3):this.lPe(!0)}lPe(k){this.$b(this.$.da.Ba(458)||this.$.da.Ja(458,new h(k)))}static la(k){k.da.Ja(459,new l(k))}}Object(r.a)(l,"LineageCatchUpExperimentManagerFactory",c.a,[])},1344:function(r,C,a){r=a(0);var c=a(230),b=a(52),e=a(40),f=a(15),d=a(7),h=a(75),l=a(59),k=a(91),u=a(1);class v{constructor(m,t){this.Pyd=!1;this.rg=()=>{this.mqg()};this.$=m;this.$.ea.zbb&&!v.ICb&&(t&&!t.jWa||this.bkk(),v.Xif?f.ULS.sendTraceTag(537155461,0,50,"LineageTeachingCalloutTriggerManager will not trigger WYWA waterline check as it was already checked in session"):
t&&!t.jWa||this.jkk());f.ULS.sendTraceTag(537155460,0,50,"LineageTeachingCalloutTriggerManager is initialized.")}dispose(){this.TRd();this.$=null;f.ULS.sendTraceTag(537155459,0,50,"LineageTeachingCalloutTriggerManager is disposed.")}disable(){v.ICb||(v.ICb=!0,f.ULS.sendTraceTag(578557781,0,50,"LineageTeachingCalloutTriggerManager.Disable as the pane was opened."));this.TRd()}jkk(){this.$.isAnonymousUser()||l.i(this.$.qa.va,m=>{this.$?(m=m.Result,f.ULS.sendTraceTag(578557780,0,50,`CheckLineageWywaChanges service call succeeded, hasnewchanges = ${m}.`),
v.Xif=!0,m&&this.bqg(0)):f.ULS.sendTraceTag(537155458,0,50,"LineageTeachingCalloutTriggerManager.VerifyWaterlineTrigger ignoring server response as class is disposed.")},()=>{f.ULS.sendTraceTag(537155457,0,10,"CheckLineageWywaChanges service call failed.")},null,null)}bkk(){this.mqg()||(this.$.ea.wv(this.rg),this.Pyd=!0)}mqg(){return this.$.ea&&this.$.ea.ao&&this.$.ea.ao.ShouldTriggerLineageCalloutOnMerge?(f.ULS.sendTraceTag(578557778,0,50,"LineageTeachingCalloutTriggerManager.TriggerLineageCalloutOnMerge"),
this.bqg(1),!0):!1}bqg(m){v.ICb?f.ULS.sendTraceTag(537155456,0,50,"LineageTeachingCalloutTriggerManager.TriggerCallout Will not trigger dialog as it was already shown in session"):(v.ICb=!0,f.ULS.sendTraceTag(578557776,0,50,`LineageTeachingCalloutTriggerManager.TriggerCallout triggering callout due to reason ${m}.`),this.TRd(),u.EwaSettings.ya(418)&&(m=new k.a(-847286761,h.a.fc,this.$.Tc,0,d.a.n2),this.$.Ia.mc(m,{["CalloutName"]:4})))}TRd(){this.Pyd&&(this.Pyd=!1,this.$.ea.hx(this.rg))}}v.ICb=!1;
v.Xif=!1;Object(r.a)(v,"LineageTeachingCalloutTriggerManager",null,[673,2]);var x=a(727);a.d(C,"a",function(){return w});class w extends c.a{constructor(m){super();this.$=m;this.uc()}create(){e.TaskExtensions.za(b.GetServiceTaskFactory.Za(this.$.da,458,459,this.La),m=>{const t=m.result;m=Object(x.a)(this.$.da,403,()=>new v(this.$,t));this.$b(m)},this.$.ka,3)}static la(m){m.da.Ja(402,new w(m))}}Object(r.a)(w,"LineageTeachingCalloutTriggerManagerFactory",c.a,[])},1345:function(r,C,a){r=a(0);var c=a(230),
b=a(15),e=a(249),f=a(7),d=a(273),h=a(30),l=a(260),k=a(13),u=a(19),v=a(734);const x=a(20).a.HMh;class w extends e.a{constructor(L,M,O){super(L);this.nx=0;this.ju=!1;this.kd=()=>{this.Oh(!1)};this.$=M;this.taskPaneManager=O;d.a(M).Zi(this);this.$.ik(this.kd);h.a.de()&&(this.isVisible=!1)}iV(L){this.get_events().addHandler("EnrichmentTaskPaneRemoved",L)}lY(L){this.get_events().removeHandler("EnrichmentTaskPaneRemoved",L)}UF(L){this.addHandler("EnrichmentTaskPaneVilibilityChanged",L)}rH(L){this.removeHandler("EnrichmentTaskPaneVilibilityChanged",
L)}rYg(L){this.addHandler("EnrichmentTaskPaneOnFocus",L)}qzj(L){this.removeHandler("EnrichmentTaskPaneOnFocus",L)}get isVisible(){return super.isVisible}set isVisible(L){super.isVisible=L;this.raiseEvent("EnrichmentTaskPaneVilibilityChanged")}get Fg(){return this.isVisible}get Qe(){return l.a.PDh}get Ji(){return 10}get Dl(){return x}get uS(){return this.titleText}get titleText(){return"Enrichment"}get fr(){return 300}get isResizable(){return!1}get Wc(){return this.domElement}get height(){return this.taskPaneManager.hQ.offsetHeight}get wB(){return this.taskPaneManager.Oxa(this.Wc,
this.titleText,this.fr,this.isResizable,()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=!0},()=>{this.isVisible=!1},this.fr)}Sr(){return this.ju}Vu(){return this.ju}LX(){}dispose(){this.$&&this.$.Wl(this.kd);this.taskPaneManager=this.$=null;super.dispose()}$g(L,M){M||this.raiseEvent("EnrichmentTaskPaneOnFocus");return!M}ui(L){return k.DOMElementExtensions.zg(this.Wc,L)}pk(){}Rk(){}Oh(L){this.ju=L;const M=this.taskPaneManager;this.isVisible=L;h.a.de()?L?this.taskPaneManager.m9("EnrichmentTaskPane",
this.wB):this.taskPaneManager.hideTaskPane("EnrichmentTaskPane"):(L&&0<M.pF.length&&(!M.Ci||10!==M.Ci.taskPane.Ji||M.isCollapsed)&&M.$J(this,!0),M.mD());L||(u.h(this.$).$g(!0,!1),this.$.ig())}QW(){return!1}static la(L,M){var O=L.qc;let B=document.getElementById(O+f.a.OXe);B||(B=v.a("div",L.qc+f.a.OXe,"cui-taskpane"),h.a.de()||(O=document.getElementById(O+f.a.GX),void 0!==O&&null!==O?O.appendChild(B):b.ULS.sendTraceTag(537166720,0,10,`EnrichmentTaskPane.Attach: couldn't find novTaskPaneBodyDiv. IsAppUnloading: ${L.SG}`)));
O=L.da;return O.Ba(257)||O.Ja(257,new w(B,L,M))}}Object(r.a)(w,"EnrichmentTaskPane",e.a,[428,2,418,26]);var m=a(52),t=a(426),z=a(40),y=a(100),D=a(1),H=a(149),F=a(35);a.d(C,"a",function(){return G});class G extends c.a{constructor(L){super();this.fi=this.mj=null;this.$=L;this.uc()}get bF(){this.mj||(this.mj=z.TaskExtensions.za(t.a(this.$),L=>{this.fi=w.la(this.$,L.result)},this.ka,3));return this.mj}create(){const L=m.GetServiceTaskFactory.create(this.$.da,203,this.ka,this.La),M=D.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateCommonUiStrings",
!1)?Object(y.d)(H.a.resolve(F.p,{Wa:this.La})):m.GetServiceTaskFactory.create(this.$.da,155,this.ka,this.La);z.TaskExtensions.za(z.TaskExtensions.ts(z.TaskExtensions.xe([L,M],this.ka),()=>this.bF,this.ka),()=>{this.$b(this.fi)},this.ka,3)}dispose(){this.fi=this.mj=this.$=null;super.dispose()}static la(L){L.da.Ja(258,new G(L))}}Object(r.a)(G,"EnrichmentTaskPaneFactory",c.a,[])},1360:function(r,C,a){r=a(0);var c=a(15),b=a(265);class e{constructor(h,l){this.testName=null;this.startTimeMs=0;this.isSuccess=
!1;this.caller=this.errorStatusCode=this.errorMessage=null;this.reqTotalDurationMs=0;this.browserResourceTiming=null;this.testIteration=0;this.testName=h;this.caller=l;this.reset()}reset(){this.isSuccess=!1;this.startTimeMs=-1;this.errorStatusCode=this.errorMessage="";this.reqTotalDurationMs=-1;this.browserResourceTiming=null}}Object(r.a)(e,"NetworkTestResult",null,[]);var f=a(594);a.d(C,"a",function(){return d});class d{constructor(h,l,k,u,v){this.url="";this.w9a=!1;this.mjb=-1;this.testIteration=
0;this.baseUrl=k;this.fKf=u;this.Qsd=l;this.result=new e(l,v)}runTest(){try{if(this.w9a)return c.ULS.sendTraceTag(537155206,0,50,`NetworkTestReq.RunTest: a test for the host ${this.Qsd} is already mid way, not starting a new one.`),!1;this.reset();this.w9a=!0;this.result.startTimeMs=Date.now();const h=new b.QueryStringBuilder(this.baseUrl);h.a5("tid",this.result.startTimeMs.toString());this.url=h.toString();this.NJj();this.testIteration++;this.result.testIteration=this.testIteration;return!0}catch(h){return this.nzb("Exeption: "+
h.message),!1}}reset(){this.url="";this.result.reset();this.w9a=!1;this.mjb=-1}clearTimeout(){-1!==this.mjb&&(window.clearTimeout(this.mjb),this.mjb=-1)}NJj(){try{const h=new XMLHttpRequest;h.onreadystatechange=()=>{4===h.readyState&&(200===h.status?this.VTh():this.nzb(`Error when downloading resource. status code: ${h.status}, status text: ${h.statusText}`,h.status.toString()))};h.onerror=()=>{this.nzb(`Client error when attempting to download resource. status code: ${h.status}, response: ${h.statusText}`)};
this.mjb=window.setTimeout(()=>{this.mjb=-1;this.nzb("Request timeout")},1E4);h.open("GET",this.url,!0);h.send(null)}catch(h){this.nzb("Exeption: "+h.message)}}VTh(){this.w9a&&(this.result.reqTotalDurationMs=Date.now()-this.result.startTimeMs,this.clearTimeout(),this.result.browserResourceTiming=f.a(this.url),this.result.isSuccess=!0,this.I9b())}nzb(h,l=null){this.w9a&&(this.clearTimeout(),this.result.errorMessage=h,this.result.isSuccess=!1,this.result.errorStatusCode=l,this.I9b())}I9b(){this.w9a=
!1;this.fKf&&this.fKf(this.result,this.Qsd)}}Object(r.a)(d,"NetworkTestReq",null,[])},1398:function(r,C,a){a.r(C);a.d(C,"AutoDetectActionButton",function(){return d});r=a(0);C=a(86);var c=a(1298),b=a(54),e=a(16),f=a(19);class d extends C.a{constructor(h,l,k,u,v){super();this.$=h;this.Kq=u.K4a(h,l,k,"",b.a.yg(11),v,"AutoDetectPointerDown",e.a.instance.ha(1808)+"...")}get Qs(){return this.Kq.Qs}dispose(){this.Kq.dispose();this.$=null;super.dispose()}domElement(h){return this.Kq.domElement(h)}getButton(h){return this.Kq.getButton(h,
!1)}tkb(h,l,k,u){this.Kq.KXa(c.a.w3h(h),l,u);this.Kq.PJc(k,l,u)}Y2(h,l){const k=f.h(this.$),u=k.Mb.Di(h);h=k.gh(h,u);const v=k.sg(u).nm;if(h&&0<=h.x&&0<=h.y&&v.width>h.width+160){let x=h.bottomRight.x+this.Qs,w=h.topLeft.y+this.Qs,m=!1;x+160>v.bottomRight.x&&(x=h.topLeft.x-this.Qs,m=!0);if(w<v.topLeft.y+this.Qs){if(k.Mb.DEa){this.hide();return}w=v.topLeft.y+this.Qs}this.Kq.ldc(l,u);this.rm(x,w,k.rtl,u,m)}else this.hide()}rm(h,l,k,u,v){this.Kq.rm(h,l,k,u,!1,v)}hide(){this.Kq.hide()}}Object(r.a)(d,
"AutoDetectActionButton",C.a,[])},1514:function(r,C,a){a.r(C);var c={};a.r(c);a.d(c,"UnifiedConsentAdapter",function(){return oe});var b={};a.r(b);a.d(b,"ExtendedTooltipsManager",function(){return Ce});var e=a(0),f=a(15),d=a(6),h=a(131),l=a(405);class k extends l.a{constructor(Ya){super(Ya)}get B$b(){return!1}createElement(){const Ya=document.createElement("link");Ya.setAttribute("rel","stylesheet");Ya.setAttribute("type","text/css");Ya.setAttribute("href",this.ix);return Ya}ibd(){return null}uzc(){this.element.setAttribute("href",
"");this.element.setAttribute("href",this.kB.ix)}}Object(e.a)(k,"CssResource",l.a,[]);var u=a(468),v=a(268),x=a(32),w=a(63);class m{constructor(){this.x0b=this.KYb=null}tOi(){this.KYb||(f.ULS.sendTraceTag(21030598,324,50,"InProductMessagingDependenciesLoad usage"),this.KYb=w.Task.WAA(m.AOi(),m.pOi()),this.KYb.continueWith(Ya=>{f.ULS.sendTraceTag(21030599,324,10,"{0}",x.a.Jmd(Ya.exception))},5));return this.KYb}vOi(){if(!this.x0b)try{f.ULS.sendTraceTag(39978390,324,50,"InProductMessagingFreemiumDependenciesLoad usage"),
this.x0b=w.Task.WAA(m.Gfd(v.a.create(d.AFrameworkApplication.fa.Va("DimeUrl"),null,null))),this.x0b.continueWith(Ya=>{f.ULS.sendTraceTag(39978391,324,10,"{0}",x.a.Jmd(Ya.exception))},5)}catch(Ya){f.ULS.sendTraceTag(594874951,324,10,"{0}",x.a.Jmd(Ya))}return this.x0b}static AOi(){var Ya=m.Xic("inproductmessaging.js");Ya=v.a.create(Ya,null,null);return m.Gfd(Ya)}static pOi(){var Ya=m.Xic("inproductmessaging.css");Ya=new k(Ya);return m.Gfd(Ya)}static Xic(Ya){return h.a.Ovb(String.format("ipm/{0}",Ya))}static Gfd(Ya){u.a.gxa(Ya);
return Ya.Cbb}}Object(e.a)(m,"DependencyDownloader",null,[670]);class t{}t.egj="inProductMessagingOverlayDiv";t.hjj="PlayButtonImage";t.pBj="ReplayButtonImage";Object(e.a)(t,"Constants",null,[]);class z{constructor(){this.Ire=this.gme=this.pbe=!0;this.qBj=this.ijj=null;this.MXi=!1;this.locale=null;this.Crg={}}get fEe(){return this.pbe}set fEe(Ya){this.pbe=Ya}get aFf(){return this.gme}set aFf(Ya){this.gme=Ya}get Oig(){return this.Ire}set Oig(Ya){(this.Ire=Ya)&&this.IPj()}IPj(){this.yxe(t.hjj,this.ijj);
this.yxe(t.pBj,this.qBj)}yxe(Ya,Qb){Qb&&(this.Crg[Ya]=Qb)}}Object(e.a)(z,"FirstRunExperienceUISettings",null,[669]);class y{constructor(){this.completed=this.Uvj=!1}}Object(e.a)(y,"FirstRunExperienceViewData",null,[668]);var D=a(88),H=a(189),F=a(111),G=a(27);class L{constructor(Ya,Qb,Ec){this.Na=Ya;this.Wf=Qb;this.pZb=Ec}Ih(){this.Na.pf(G.a.tUh,F.a.frame,Object(D.a)(this,this.rUh,"firstRunExperienceHandler"),64);this.Na.Hc(G.a.T4e,F.a.frame,Object(D.a)(this,this.Lri,"inProductMessagingTabHandler"));
this.Na.Hc(G.a.S4e,F.a.frame,Object(D.a)(this,this.Kri,"inProductMessagingShiftTabHandler"));this.Na.Hc(G.a.cyh,F.a.frame,Object(D.a)(this,this.dyh,"dimeLaunchHandler"));this.Na.Hc(G.a.G6f,F.a.frame,H.ActionManager.fh);this.Na.Hc(G.a.PBj,F.a.frame,H.ActionManager.fh);this.Na.Hc(G.a.QBj,F.a.frame,H.ActionManager.fh);this.Wf&&this.Wf.updateCommandUI()}rUh(Ya,Qb,Ec,id,Bd){2===Ec&&this.pZb.NMi(Bd);return 32}dyh(Ya,Qb,Ec,id,Bd){2===Ec&&this.pZb.KMi(Bd);return 32}Lri(Ya,Qb,Ec){return 2===Ec?this.pZb.kGd():
32}Kri(Ya,Qb,Ec){return 2===Ec?this.pZb.hGd():32}}Object(e.a)(L,"InProductMessagingActor",null,[]);var M=a(126);class O{constructor(){this.h3f=this.i8f=this.Fng=this.Fqc=this.instance=null}}Object(e.a)(O,"DimeExperienceUISettings",null,[]);var B=a(140),E=a(473);class I{constructor(Ya,Qb,Ec,id,Bd){this.bgc=!1;this.Fxb=null;this.Na=Ya;this.zIa=Qb;this.a1b=Ec;this.N3=id;this.cNc=Bd}Eui(Ya){B.b("getHeaderApi")?Ya.isFeatureEnabled("MsoPremiumBadge",!0).then(Qb=>{const Ec=Ya.isFreemiumUpsellEnabled();Ec&&
(appChrome.getHeaderApi().then(id=>{id.updatePremiumStatus(Qb,Ec);return null}),Ya.aUa("MsoPremiumBadge",id=>{appChrome.getHeaderApi().then(Bd=>{Bd.updatePremiumStatus(id.isEnabled,Ec);return null})}));return null}):f.ULS.sendTraceTag(593859840,324,10,"getHeaderApi not available")}NMi(Ya){this.a1b.tOi().continueWith(()=>{this.zIa.WZj(Ya)})}KMi(Ya){let Qb="gopremium",Ec=null,id=()=>{};Ya?(Ya.experience&&""!==Object(M.a)(String,Ya.experience)&&(Qb=Object(M.a)(String,Ya.experience)),Ya.onTaskComplete&&
(id=Ya.onTaskComplete),Ya.campaignId&&""!==Object(M.a)(String,Ya.campaignId)&&(Ec=Object(M.a)(String,Ya.campaignId))):f.ULS.sendTraceTag(51675402,324,50,"Experience not given, using default experience");this.oyf(Qb,id,Ec)}oyf(Ya,Qb,Ec=null){if(this.bgc&&this.Fxb){const id={};id.experience=Ya||"gopremium";id.campaignId=Ec||E.b(this.N3,this.cNc,Object(M.a)(String,id.experience),!0);this.Na.processAction(G.a.G6f,2);f.ULS.sendTraceTag(51675403,324,50,"Launching Freemium Upsell dialog: "+id.experience);
try{const Bd=Object.assign(new O,{instance:this.Fxb,Fqc:id,Fng:Qb||(()=>{}),i8f:Id=>{f.ULS.sendTraceTag(51675405,324,50,"Dime launch result: "+Id.status)},h3f:()=>{f.ULS.sendTraceTag(51675406,324,10,"Dime launch error");this.bgc=!1;this.Fxb=null}});this.zIa.jYj(Bd)}catch(Bd){f.ULS.sendTraceTag(51675407,324,10,"Dime launch error: "+Bd.message),this.bgc=!1,this.Fxb=null,this.Na.Le(G.a.cgc,2,{["experience"]:id.experience})}}else f.ULS.sendTraceTag(39978392,324,10,"FreemiumUpsellDialogDependencies not loaded"),
this.Na.Le(G.a.cgc,2,{["experience"]:Ya})}jzf(){this.a1b.vOi().continueWith(()=>{try{var Ya=x.a.Hl(d.AFrameworkApplication.uiCulture);const id=E.c(this.N3);if(id){var Qb={};Qb.partnerId=id;Qb.language=Ya;Qb.sessionId=d.AFrameworkApplication.userSessionId;Qb.authHint=d.AFrameworkApplication.fa.Va("UserPrincipalName");var Ec=d.AFrameworkApplication.fa.Va("Puid")||"";""!==Ec&&(Ya={},Ya.puid=Ec,Qb.userInfo=Ya);this.Fxb=new Dime(Qb);this.bgc=!0;f.ULS.sendTraceTag(592721856,324,50,"Dime initialized")}else f.ULS.sendTraceTag(51675409,
324,15,"App not supported")}catch(id){f.ULS.sendTraceTag(51675410,324,10,"FreemiumUpsellDialogDependencies failed: "+id.message)}},3)}kGd(){return this.zIa.kGd()}hGd(){return this.zIa.hGd()}}Object(e.a)(I,"InProductMessagingUIManager",null,[666]);class S{constructor(){this.kte=0;this.v_a=Array(5);this.v_a[0]=10;this.v_a[1]=15;this.v_a[2]=50;this.v_a[3]=100;this.v_a[4]=200}Init(Ya){this.kte=Ya}SendTrace(Ya,Qb){f.ULS.sendTraceTag(34182235,this.kte,this.v_a[Ya],"{0}",Qb)}}Object(e.a)(S,"DefaultNetworkingManager",
null,[689]);var J=a(274),K=a(326),R=a(102);class Z{constructor(Ya){this.Nc=Ya}WZj(Ya){Ya&&(InProductMessaging.Networking.NetworkingMgr=new S,InProductMessaging.Networking.NetworkingMgr.Init(387),InProductMessaging.Init(Ya.Oig,Ya.aFf,Ya.fEe,Ya.MXi,Ya.locale,Object(D.a)(this,this.i4i,"onDismissFirstRunExperience"),Ya.Crg),this.AVa(t.egj,!0))}jYj(Ya){if(Ya&&Ya.instance&&Ya.Fqc){let Qb=document.getElementById("wacDimeContainer");Qb||(Qb=document.createElement("div"),Qb.id="wacDimeContainer",document.body.appendChild(Qb));
d.AFrameworkApplication.fa.ra("DimeFocusManagerIsEnabled")&&this.AVa("wacDimeContainer",!1);Ya.Fqc.parentElementId="wacDimeContainer";Ya.instance.launch(Ya.Fqc,Ya.Fng).then(Ec=>{this.jOb();document.body.removeChild(Qb);Ya.i8f(Ec)}).catch(Ec=>{this.jOb();document.body.removeChild(Qb);Ya.h3f(Ec)})}else throw Error.argument("DimeExperienceUISettings");}AVa(Ya,Qb){if(this.Nc&&Ya&&(Ya=document.getElementById(Ya),this.wui(Ya),Ya=this.Nc.mO("InProductMessagingFocusId"))){const Ec=this.Nc.Yi;Ec&&"InProductMessagingFocusId"===
Ec.name||this.Nc.mT("InProductMessagingFocusId",!1);Qb&&this.h1f(Ya.scope)}}wui(Ya){var Qb=this.Nc.rj("InProductMessagingFocusId");Qb.parent=J.AFrame.mV;const Ec=new K.DOMFocusListing(()=>Ya);Ec.Ofb=!1;Ec.xp(3);Ec.xp(2);Ec.xp(4);Qb=this.Nc.Cva(()=>Ya,Qb,Ec);Qb.cOb();Qb.y1=!0;Qb.cLa=!0}h1f(Ya){Ya.ul(R.FocusManager.instance().H4);Ya.ul(R.FocusManager.instance().I4);Ya.bindAction(R.FocusManager.instance().H4,G.a.T4e);Ya.bindAction(R.FocusManager.instance().I4,G.a.S4e)}jOb(){this.Nc&&(this.Nc.t9("InProductMessagingFocusId"),
this.Nc.kUa("InProductMessagingFocusId"))}i4i(Ya,Qb){this.jOb();Ya=Object.assign(new y,{completed:Ya,Uvj:Qb});d.AFrameworkApplication.dc.Le(G.a.qUh,2,Ya)}kGd(){const Ya=document.activeElement,Qb=this.Nc.hS();return Ya&&Qb&&Qb.ag&&Ya===Qb.ag.ay?(Qb.ag.Km(Ya),Qb.hBa()?32:8):4}hGd(){const Ya=document.activeElement,Qb=this.Nc.hS();return Ya&&Qb&&Qb.ag&&Ya===Qb.ag.firstElement?(Qb.ag.Km(Ya),Qb.WRa()?32:8):4}}Object(e.a)(Z,"InProductMessagingUIWrapper",null,[667]);var P=a(142),V=a(261),Ea=a(31);class oa{constructor(){this.Nb=
null}get name(){return"Common.App.InProductMessaging"}Oi(Ya){Ya.register(m,"Common.App.InProductMessaging.DependencyDownloader").as("Common.App.InProductMessaging.IDependencyDownloader").gd().od(()=>new m);Ya.register(Z,"Common.App.InProductMessaging.InProductMessagingUIWrapper").as("Common.IInProductMessagingUIWrapper").gd().od(()=>new Z(R.FocusManager.instance()));Ya.register(I,"Common.App.InProductMessaging.InProductMessagingUIManager").as("Common.IInProductMessagingUIManager").gd().od(()=>new I(d.AFrameworkApplication.dc,
Ya.resolve("Common.IInProductMessagingUIWrapper"),Ya.resolve("Common.App.InProductMessaging.IDependencyDownloader"),d.AFrameworkApplication.sa.Qa.li,d.AFrameworkApplication.sa.Qa.uBa));Ya.register(L,"Common.App.InProductMessaging.InProductMessagingActor").gd().od(()=>new L(d.AFrameworkApplication.dc,d.AFrameworkApplication.sa,Ya.resolve("Common.IInProductMessagingUIManager")));Ya.register(z,"Common.App.InProductMessaging.FirstRunExperienceUISettings").as("Common.IFirstRunExperienceUISettings").gd().od(()=>
new z);Ya.register(y,"Common.App.InProductMessaging.FirstRunExperienceViewData").as("Common.IFirstRunExperienceViewData").gd().od(()=>new y);this.Nb=Ya}init(){this.Nb.resolve("Common.App.InProductMessaging.InProductMessagingActor").Ih();d.AFrameworkApplication.fa.Rv(()=>{d.AFrameworkApplication.sa.Qa.Uv&&P.a.get_instance().Fj(15,()=>{this.Nb.Dc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Ya=>{this.Nb.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").Eui(Ya)})});
d.AFrameworkApplication.fa.ra("FreemiumUpsellShowDialogIsEnabled")&&E.a()&&!Ea.a.Oza&&1!==d.AFrameworkApplication.sa.Qa.li&&this.Nb.Dc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Ya=>{Ya.isFeatureEnabled("MsoPremiumBadge",!0).then(Qb=>{!Qb&&Ya.isFreemiumUpsellEnabled()&&this.Nb.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").jzf();return null})})})}dispose(){}static main(){V.a.instance.wj(new oa)}}Object(e.a)(oa,"InProductMessagingPackage",null,[4,
5]);var ea=a(198),aa=a(43);class ia{constructor(Ya,Qb,Ec,id=null,Bd=null){this.yx=Ya;this.WGa=Qb;this.rnb=Ec;this.Coe=id;this.Dpb=Bd}Phd(Ya){const Qb=new Sys.StringBuilder(this.yx.IPb);Qb.append("RoamingServiceHandler.ashx?action=");Qb.append("getFirstRunExperienceSettings");Qb.append("&");Qb.append(this.Ood(Ya));Qb.append("&");Qb.append(d.AFrameworkApplication.oj);d.AFrameworkApplication.qe.Sn(Qb.toString(),1,null,null,!0,2,Object(D.a)(this,this.Gma,"getRequestSuccessCallback"),Object(D.a)(this,
this.HW,"getRequestFailureCallback"),null)}tec(Ya){var Qb=new Sys.StringBuilder(this.yx.IPb);Qb.append("RoamingServiceHandler.ashx?action=");Qb.append("saveFirstRunExperienceSettings");Qb.append("&");Qb.append(d.AFrameworkApplication.oj);Qb=Qb.toString();Ya=aa.c(Ya);d.AFrameworkApplication.qe.Sn(Qb,2,Ya,null,!0,4,Object(D.a)(this,this.Nkj,"postRequestSuccessCallback"),Object(D.a)(this,this.u9,"postRequestFailureCallback"),null)}Gma(Ya){let Qb=!1,Ec=null;try{if(0<Ya.data.Pe.length){const id=Object(M.a)(Object,
aa.a(Ya.data.Pe)),Bd=id?id[this.yx.c4c]:null;Bd&&(Ec=Object(M.a)(Object,aa.a(Bd.toString())))}Qb=!0}catch(id){this.HW(null)}Qb&&this.WGa&&this.WGa(Ya.data,Ec)}HW(Ya){this.rnb&&this.rnb(Ya?Ya.data:null)}Nkj(Ya){this.Coe&&this.Coe(Ya?Ya.data:null)}u9(Ya){this.Dpb&&this.Dpb(Ya?Ya.data:null)}Ood(Ya){const Qb=new Sys.StringBuilder("requestedsettings=");for(let Ec=0;Ec<Ya.count;Ec++)Qb.append(Ya.ma(Ec)),Ec<Ya.count-1&&Qb.append(";");return Qb.toString()}}Object(e.a)(ia,"FirstRunExperienceRequestHandler",
null,[]);var ya=a(241),za=a(84);class la{constructor(){this.knb=this.LYb=this.yx=null}t0d(Ya){Ya?(this.yx=Ya,this.KEi()&&(f.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),Ya=new ea.a,Ya.add(this.yx.c4c),this.LYb=new ia(this.yx,Object(D.a)(this,this.Gma,"getRequestSuccessCallback"),Object(D.a)(this,this.HW,"getRequestFailureCallback"),null,Object(D.a)(this,this.u9,"postRequestFailureCallback")),this.LYb.Phd(Ya)),(this.yx.Hab||d.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",
!1))&&this.u0d()):f.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")}KEi(){try{if(this.yx.Hab)return!0;if(!d.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||d.AFrameworkApplication.fa.ra("IsAnonymousUser"))return!1;if(this.yx.fBi||this.yx.Kab||d.AFrameworkApplication.fa.ra("IsO365ConsumerHost"))return!0;const Ya=d.AFrameworkApplication.fa.Va("FlightId");return-1!==(Ya?Ya.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(Ya){f.ULS.sendTraceTag(576582624,
306,10,"Error checking setting {0}",Ya?Ya.toString():null)}return!1}E$f(Ya){const Qb={},Ec={};Ec.FREDisplayedDate=(new Date).toUTCString();Ec.VersionDisplayed=Ya;Ec.RemindMeLater=!1;Qb[this.yx.c4c]=aa.c(Ec);f.ULS.sendTraceTag(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");this.LYb&&this.LYb.tec(Qb)}Gma(Ya,Qb){Ya=Ya?+Ya.R5-+Ya.NG:-1;Ya>this.yx.q9f?f.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",
Ya,this.yx.q9f):Qb?this.YWj(Qb)?(f.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",this.yx.TEf),this.u0d()):(this.bed(!1),f.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required.")):(f.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.u0d())}HW(Ya){this.bed(!1);
f.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",Ya?Ya.httpStatus:-1)}u9(Ya){f.ULS.sendTraceTag(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",Ya?Ya.httpStatus:-1)}u0d(){this.bed(!0);var Ya=za.a.instance.nh("Common.ISystemInitiatedFeedback");Ya?this.Dig(Ya):(f.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),d.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",
!0)&&((Ya=za.a.instance.Dc("Common.ISystemInitiatedFeedback"))?Ya.execute(Qb=>{this.Dig(Qb)}):f.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))}Dig(Ya){if(Ya){var Qb=this.yx.EUh;Qb&&(d.AFrameworkApplication.IAa(Qb),d.AFrameworkApplication.NO(Qb));f.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",Qb);Ya.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.knb=Object(D.a)(this,this.l5i,"onFirstRunExperienceCampaignEvent"),
window.addEventListener("FGWebSurfaceEvent",this.knb,!0),window.addEventListener("FRELaunchedEvent",this.knb,!0)):(f.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),this.E$f(this.yx.currentVersion))}else f.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")}l5i(Ya){if(Ya){var Qb=Ya.detail;Ya=Ya.type;var Ec=this.yx&&this.yx.campaignId?this.yx.campaignId.split("-")[0]:null;if("FRELaunchedEvent"===Ya||Ec&&Qb&&Qb.id&&-1!==Qb.id.indexOf(Ec))Qb.success&&
(f.ULS.sendTraceTag(51675546,306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.E$f(this.yx.currentVersion)),window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.knb,!0),window.removeEventListener("FRELaunchedEvent",this.knb,!0))}}YWj(Ya){if("RemindMeLater"in Ya&&"FREDisplayedDate"in Ya){if("true"===Ya.RemindMeLater.toString()&&(+new Date-+new Date(Ya.FREDisplayedDate.toString()))/36E5>this.yx.TEf)return!0}else if(d.AFrameworkApplication.fa.ra("WacShowVersionBasedFREToAllUsers")&&
"VersionDisplayed"in Ya&&Ya.VersionDisplayed<this.yx.currentVersion)return f.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1}bed(Ya){d.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DispatchFREDecisionEvent")&&ya.a.dispatch("FREDecisionEvent",{["show"]:Ya})}}Object(e.a)(la,"FirstRunExperienceLauncher",null,[605]);class xa{constructor(){this.Nb=null}get name(){return"Common.App.FirstRunExperienceLauncher"}Oi(Ya){this.Nb=
Ya;this.Nb.register(605,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").gd().od(()=>new la)}init(){}dispose(){}static main(){V.a.instance.wj(new xa)}}Object(e.a)(xa,"FirstRunExperienceLauncherPackage",null,[4,5]);var wa=a(10),hb=a(230),Ja=a(1);class Fa{constructor(Ya){this.$=Ya}get c4c(){return"Excel"}get campaignId(){return"aed9de6b-d4e7-4878-988a-9dfec66fed9e"}get version(){return 1}get currentVersion(){return 0}get fBi(){return this.isEnabled()&&Ja.EwaSettings.ya(295)}get Kab(){return this.isEnabled()&&
Ja.EwaSettings.ya(297)}get Hab(){return Ja.EwaSettings.ya(296)}get EUh(){return null}get TEf(){return 24}get q9f(){return 4E3}get IPb(){return this.$.xa.WebServiceBase||""}isEnabled(){if(d.AFrameworkApplication.fa?d.AFrameworkApplication.fa.ra("IsAnonymousUser"):1)return!1;const Ya=d.AFrameworkApplication.Yc?Object(M.a)(String,d.AFrameworkApplication.Yc.AudienceGroup):"";return"Unknown"!==Ya&&"Automation"!==Ya}}Object(e.a)(Fa,"FirstRunExperienceLauncherSettings",null,[672]);class Ba{constructor(Ya,
Qb){this.U4e=Ya;this.sUh=Qb}t0d(){this.U4e&&this.U4e.t0d(this.sUh)}}Object(e.a)(Ba,"FirstRunExperienceManager",null,[671]);var fa=a(727);class ta extends hb.a{constructor(Ya){super();this.$=Ya;this.uc()}create(){const Ya=Object(fa.a)(this.$.da,311,()=>this.moh());this.$b(Ya)}moh(){var Ya=new Fa(this.$);Ya=new Ba(za.a.instance.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher"),Ya);Ya.t0d();return Ya}static la(Ya){Ya.da.Ja(312,new ta(Ya))}}Object(e.a)(ta,"FirstRunExperienceManagerFactory",
hb.a,[]);var Oa=a(58);class Ma extends hb.a{constructor(Ya){super();this.Ntd=null;this.$=Ya;this.uc()}create(){const Ya=Object(fa.a)(this.$.da,361,()=>this.Zoh());this.$b(Ya)}Zoh(){this.Ntd=za.a.instance.nh("Common.IInProductMessagingUIManager");Oa.a.qh.Uv?P.a.get_instance().Fj(16,()=>{this.knf()}):this.knf();return this.Ntd}knf(){za.a.instance.Dc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Ya=>{Ya.isFeatureEnabled("MsoPremiumBadge",!0).then(Qb=>{!Qb&&Ya.isFreemiumUpsellEnabled()&&
this.Ntd.jzf();return null})})}static la(Ya){Ya.da.Ja(362,new Ma(Ya))}}Object(e.a)(Ma,"InProductMessagingManagerFactory",hb.a,[]);var fb=a(51),pa=a(425),Ua=a(86),Sa=a(541),Ia=a(19),X=a(589);class ca extends Sa.a{constructor(Ya){super(1);this.mia=!1;this.tJf=()=>{this.refresh()};this.uJf=()=>{this.refresh()};this.gridView=Ia.h(Ya);this.gridView.Gc.ro(this.uJf);this.gridView.Gc.Pm(this.tJf);this.refresh()}get EJ(){return this.Jsc(this.mia)}kZd(Ya){this.mia!==Ya&&(this.mia=Ya,this.rNb())}get name(){return X.a.cellEdit}dispose(){this.gridView.Gc.io(this.uJf);
this.gridView.Gc.fn(this.tJf);this.gridView=null;super.dispose()}rNb(){this.FPd(this.mia)}refresh(){this.kZd(!this.gridView.Ob)}}Object(e.a)(ca,"CellEditSafeStatePublisher",Sa.a,[]);var U=a(42),ma=a(129);class ra{constructor(Ya,Qb){this.handler=null;this.publisher=Ya;this.EJ=Qb}}Object(e.a)(ra,"SafeStatePublisherState",null,[]);var Va=a(628);const ob=Ya=>Ya?`${Ya.Current} / ${Ya.Pending} @${Ya.SuspensionStartTimestamp}`:null,ja=Ya=>(null===Ya||void 0===Ya?void 0:Ya.SuspensionStartTimestamp)&&Ya.Pending>
Ya.Current;class lb extends U.a{constructor(Ya,Qb){super();this.Vxf=null;this.kbb=!1;this.$Kb=(Ec,id)=>{3===id.EEf&&this.kbb&&f.ULS.sendTraceTag(520480204,0,15,"ClientStateMonitor.onMergeDidntOccur: Aborted merge occurred after another aborted merge.");this.kbb=!0;this.gfb()};this.UUa=new ea.a;this.dBa=Ya;this.rpa=Qb;this.LEb=Ja.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DoPendingMergeWhenUnsafe",!1);this.kab=Ja.EwaSettings.isChangeGateEnabled("OfficeVSO:7464389_RetryDoPendingMergeAfterBailout");
this.LEb&&(this.rpa.C1a(this.IBa.bind(this)),this.kab?this.dBa.Fye(this.$Kb):this.dBa.fYg(this.zOf.bind(this)))}get Lck(){return ma.f(ma.c(this.UUa.toArray(),Ya=>0!=Ya.EJ),Ya=>Ya.publisher.name)}R4b(Ya){this.addHandler(lb.TUa,Ya)}qAc(Ya){this.removeHandler(lb.TUa,Ya)}PCa(Ya,Qb){const Ec=new ra(Ya,Qb);this.UUa.add(Ec);Qb=(id,Bd)=>{Ec.EJ=Bd.EJ;this.gfb()};Ya.R4b(Qb);Ec.handler=Qb;this.gfb()}A6d(Ya){let Qb=null;for(let Ec of this.UUa)if(Ec.publisher===Ya){this.Dsg(Ec);Qb=Ec;break}Qb&&(this.UUa.remove(Qb),
this.gfb())}dispose(){for(let Ya of this.UUa)this.Dsg(Ya);this.UUa.clear();this.LEb&&(this.rpa.$fb(this.IBa.bind(this)),this.kab?this.dBa.m5f(this.$Kb):this.dBa.izj(this.zOf.bind(this)));super.dispose()}Bgc(){let Ya=sb.Bgc(this.UUa.toArray().map(Qb=>Qb.EJ));return this.kbb&&1===Ya?2:Ya}Dsg(Ya){Ya.publisher.qAc(Ya.handler)}gfb(){const Ya=this.Bgc();Ya!==this.Vxf&&(this.raiseEvent(lb.TUa,new Va.a(Ya)),this.Vxf=Ya)}zOf(){this.kbb&&f.ULS.sendTraceTag(523317957,0,15,"ClientStateMonitor.onMergeWasAborted: Aborted merge occurred after another aborted merge.");
this.kbb=!0;this.gfb()}IBa(Ya,Qb){Ya=Qb.$ea;(Qb=!ja(Ya))||(Qb=this.dMi,Qb=(null===Ya||void 0===Ya?void 0:Ya.SuspensionStartTimestamp)!==(null===Qb||void 0===Qb?void 0:Qb.SuspensionStartTimestamp));Qb&&(this.kbb=!1);this.dMi=Ya;this.gfb()}}lb.TUa="SSC";Object(e.a)(lb,"ClientStateMonitor",U.a,[]);var wb=a(8),Ab=a(77);class nb extends Sa.a{constructor(Ya,Qb=null){super(1);this.mia=!1;this.eP=()=>{this.refresh()};this.BKf=()=>{this.refresh()};this.$=Ya;this.vhe=Qb||Ab.a(Ya).eS(wb.a.idle);Ab.a(Ya).y2c(this.BKf);
this.n9a.Ar(this.eP);this.refresh()}get EJ(){return this.Jsc(this.mia)}kZd(Ya){Ya!==this.mia&&(this.mia=Ya,this.rNb())}get name(){return X.a.n9a}get n9a(){return this.vhe}dispose(){Ab.a(this.$).Xzc(this.BKf);this.n9a.$r(this.eP);this.vhe=null;super.dispose()}rNb(){this.FPd(this.mia)}refresh(){this.kZd(1===this.n9a.Lv||Ab.a(this.$).Pi===this.n9a)}}Object(e.a)(nb,"IdleActivitySafeStatePublisher",Sa.a,[]);var pb=a(328),cb=a(5),Da=a(23);class zb extends Ua.a{constructor(){super()}yd(){return!1}executeCommand(){return w.Task.Ua(!0)}fd(Ya,
Qb){return 1905775613===Qb.command}Cd(){return!1}}Object(e.a)(zb,"ToggleMergeSuspensionSafeState",Ua.a,[210]);class qb extends U.a{constructor(Ya,Qb){super();this.statusBarManager=null;this.lHd=!1;this.IBa=(Ec,id)=>{Ec=`${id.$ea.Current===id.$ea.Pending?"\u26ad":"\u26ae"}${id.$ea.Current}`;Da.a.equals(this.qtc,Ec,!1)||(this.qtc=Ec,this.XA())};this.FSa=(Ec,id)=>{Ec=0==id.EJ;this.lHd!==Ec&&(this.lHd=Ec,this.XA())};this.mergeSuspensionManager=Qb;this.mergeSuspensionManager.rpa.C1a(this.IBa);this.qtc=
"";pb.a.rba(1905775613,cb.a.$c,0,1);this.Ia=Ya.Ia;this.$Tb=new zb;Ya.da.Qb(29,Ec=>{this.mergeSuspensionManager&&(this.statusBarManager=Ec,Ec.TK(this),this.mergeSuspensionManager.lka.R4b(this.FSa))});this.Ia.W4(this.$Tb)}Ar(Ya){this.addHandler(qb.MFd,Ya)}$r(Ya){this.removeHandler(qb.MFd,Ya)}XA(){this.raiseEvent(qb.MFd)}Co(Ya){return Ya===qb.goj&&!!this.mergeSuspensionManager}Gt(Ya,Qb){if(!this.Co(Ya))return!1;this.mergeSuspensionManager&&(Qb.LabelText=this.qtc,Qb.On=this.lHd);return!0}dispose(){this.$Tb&&
(this.Ia.Rfb(this.$Tb),this.$Tb.dispose(),this.$Tb=null);this.mergeSuspensionManager&&(this.mergeSuspensionManager.rpa.$fb(this.IBa),this.mergeSuspensionManager.lka.qAc(this.FSa),this.mergeSuspensionManager=null);this.statusBarManager&&(this.statusBarManager.pH(this),this.statusBarManager=null);this.qtc=null;super.dispose()}}qb.MFd="MSMSC";qb.goj="QueryMergeSuspensionStatus";Object(e.a)(qb,"MergeSuspensionIndicatorManager",U.a,[204,205,2]);var Pa=a(2),Nb=a(919);class Tb extends Sys.EventArgs{constructor(Ya){super();
this.Uza=Ya}}Object(e.a)(Tb,"TogglePendingMergeBlockedByClientEventArgs",Sys.EventArgs,[]);class Vb{}Object(e.a)(Vb,"SuspensionState",null,[]);class Jb extends Vb{constructor(Ya){super();this.sAe=!1;this.sAe=Ya}}Object(e.a)(Jb,"ReadyForPendingMergeState",Vb,[]);const Qa=new Vb,Db=new Vb,sa=new Jb(!1),Ha=new Jb(!0);var mb=a(920);class qa extends mb.a{constructor(Ya,Qb,Ec){super(Ya);this.u0g=Qb;this.H_j=Ec}}Object(e.a)(qa,"ReadyForPendingMergesUpdatedEventArgs",mb.a,[]);class Xa extends U.a{constructor(Ya,
Qb,Ec){super();this.IBa=(id,Bd)=>{id=this.getState();const Id=this.E1;this.E1=Bd.$ea;Bd=this.getState();this.sRi(id,Bd,Id);this.raiseEvent(Xa.HFd);this.D4e(id,Bd)};this.FSa=(id,Bd)=>{id=this.getState();this.EJ=Bd.EJ;Bd=this.getState();this.D4e(id,Bd)};this.$Kb=(id,Bd)=>{this.kab&&4===Bd.EEf&&(f.ULS.sendTraceTag(520480203,0,50,"MergeSuspensionStateHandler.onMergeDidntOccur: Retry DoPendingMerge after bailout. Current merge counter: {0}, Response merge counter: {1}",ob(this.E1),ob(Bd.E1)),this.C_f(this.getState(),
!0))};this.LEb=Ja.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DoPendingMergeWhenUnsafe",!1);this.kab=Ja.EwaSettings.isChangeGateEnabled("OfficeVSO:7464389_RetryDoPendingMergeAfterBailout");this.lka=Ya;this.lka.R4b(this.FSa);this.rpa=Qb;this.rpa.C1a(this.IBa);this.kab&&(this.dBa=Ec,this.dBa.Fye(this.$Kb));this.E1=Object(Pa.a)(new Nb.a,{Pending:0,Current:0,SuspensionStartTimestamp:null});this.EJ=this.Vsi()}Vsi(){return Object(pa.a)(lb,this.lka)?Object(M.a)(lb,this.lka).Bgc():1}W4b(Ya){this.addHandler(Xa.K4d,
Ya)}uAc(Ya){this.removeHandler(Xa.K4d,Ya)}SYg(Ya){this.addHandler(Xa.pQd,Ya)}Kzj(Ya){this.removeHandler(Xa.pQd,Ya)}eYg(Ya){this.addHandler(Xa.HFd,Ya)}hzj(Ya){this.removeHandler(Xa.HFd,Ya)}dqj(){this.CPd(this.getState()===Db)}dispose(){this.lka.qAc(this.FSa);this.lka=null;this.rpa.$fb(this.IBa);this.rpa=null;this.kab&&(this.dBa.m5f(this.$Kb),this.dBa=null);super.dispose()}bod(){return Object(Pa.a)(new Nb.a,{Current:this.E1.Current,Pending:this.E1.Pending,SuspensionStartTimestamp:this.E1.SuspensionStartTimestamp})}getState(){return ja(this.E1)?
0==this.EJ?Ha:this.LEb&&1==this.EJ?sa:Db:Qa}D4e(Ya,Qb){Ya!==Qb&&(Qb===Db?this.CPd(!0):Ya===Db&&this.CPd(!1));this.C_f(Qb)}C_f(Ya,Qb=!1){Ya instanceof Jb&&this.raiseEvent(Xa.pQd,new qa(this.E1,Ya.sAe||!this.LEb,Qb))}sRi(Ya,Qb,Ec){Ya===Qa&&Qb!==Qa?(Ya=Qb===Db,Qb=Qb===sa,f.ULS.sendTraceTag(252760283,0,50,`MergeSuspensionStateHandler.LogPendingMergesStatusChanged: Pending changes exist. IsBlocking: ${Qb} publisher: ${Qb||Ya?this.lka.Lck.join(","):""} counter: ${ob(this.E1)} isBlockingAllMerges: ${Ya}`)):
Ya!==Qa&&Qb===Qa&&f.ULS.sendTraceTag(252760284,0,50,`MergeSuspensionStateHandler.LogPendingMergesStatusChanged: No pending changes. counter: ${ob(Ec)}`)}CPd(Ya){this.raiseEvent(Xa.K4d,new Tb(Ya))}}Xa.K4d="TPMBBC";Xa.pQd="RFPMU";Xa.HFd="MCC";Object(e.a)(Xa,"MergeSuspensionStateHandler",U.a,[]);class Ca extends U.a{constructor(Ya){super();this.o4=null;this.mqc=0;this.aJb=(Qb,Ec)=>{(null===Ec||void 0===Ec?0:Ec.$ea)&&this.ySa(Ec.$ea,Ca.w9d)};this.kDc=()=>{this.Y7f();this.q_f(this.o4,Ca.nDj)};this.vJd=
(Qb,Ec)=>{Ec.committed&&this.o4.SuspensionStartTimestamp&&f.ULS.sendTraceTag(17318084,0,50,`PendingMergeMonitor.OnEditCellEnded: committed with counter ${ob(this.o4)}`)};this.Y7f();this.$=Ya;this.$.ea.Mk(this.kDc);this.$.ea.VK(this.kDc);Ia.h(this.$).Gc.Pm(this.vJd);this.$.da.Qb(292,Qb=>{Qb.C1a(this.aJb);f.ULS.sendTraceTag(588276809,0,50,"PendingMergeMonitor initialized")})}C1a(Ya){this.addHandler("MCU",Ya)}$fb(Ya){this.removeHandler("MCU",Ya)}get E1(){return this.o4}ySa(Ya,Qb=""){const Ec=this.o4.Current<
Ya.Current||this.o4.Pending<Ya.Pending;if(Ya.SuspensionStartTimestamp&&this.mqc!==Ya.SuspensionStartTimestamp){if(this.mqc>Ya.SuspensionStartTimestamp){Ec&&f.ULS.sendTraceTag(553736149,0,50,`PendingMergeMonitor.OnMergeCounterReceivedFromServer: skipping a higher stale counter received via ${Qb}. S: ${Ca.$Ib(Ya)}, C: ${Ca.$Ib(this.o4)}`);return}Ec||f.ULS.sendTraceTag(553736148,0,50,`PendingMergeMonitor.OnMergeCounterReceivedFromServer: recovering from a potentially stale counter. S: ${Ca.$Ib(Ya)}, C: ${Ca.$Ib(this.o4)}`)}else if(!Ec)return;
this.o4=Ya;this.q_f(Ya,Qb)}dispose(){this.$.ea.Vk(this.kDc);this.$.ea.EP(this.kDc);Ia.h(this.$).Gc.fn(this.vJd);const Ya=this.$.da.Ba(292);Ya&&Ya.$fb(this.aJb);super.dispose()}q_f(Ya,Qb=""){ja(Ya)&&Ya.SuspensionStartTimestamp>this.mqc&&(f.ULS.sendTraceTag(537155416,0,50,`PendingMergeMonitor.RaiseMergeCounterUpdated: Merge suspension requested. MergeCounter: ${ob(Ya)}, Origin: ${Qb}`),this.mqc=Ya.SuspensionStartTimestamp);this.raiseEvent("MCU",new mb.a(Ya))}Y7f(){f.ULS.sendTraceTag(588276808,0,50,
`PendingMergeMonitor.ResetMergeCounter : Last counter was ${Ca.$Ib(this.o4)}`);this.o4=Object(Pa.a)(new Nb.a,{Pending:0,Current:0,SuspensionStartTimestamp:null})}static $Ib(Ya){return Ya?`(${Ya.Current}/${Ya.Pending} @${Ya.SuspensionStartTimestamp})`:"null"}}Ca.w9d="PMM.RTC";Ca.Tcc="PMM.EwaResult";Ca.nDj="PMM.resetMergeCounter";Object(e.a)(Ca,"PendingMergeMonitor",U.a,[]);class va{}Object(e.a)(va,"ClientRevisions",null,[]);var na=a(48),Ka=a(59);const ib=(Ya,Qb,Ec,id,Bd,Id,ee,Fe=null)=>{Fe=Ya.Pa(1,
Fe);Fe.viewportState=Qb;Fe.allowViewAdjustment=Ec;return Ka.g(Ya,"DoPendingMerge",Fe,id,Bd,Id,ee,0)},Ra=(Ya,Qb,Ec,id,Bd,Id,ee=null)=>{ee=Ya.Pa(1,ee);ee.suspensionStartTimestamp=Qb;return Ka.g(Ya,"KeepBlockingPendingMerges",ee,Ec,id,Bd,Id,0)};class ka extends U.a{constructor(Ya,Qb,Ec,id){super();this.cMa=null;this.cHb=0;this.dHb=this.Zab=null;this.iQf=(Bd,Id)=>{this.cMa.c4g(Id.$ea,Id.u0g,Id.H_j)};this.DLb=(Bd,Id)=>{Id.Uza?this.V1j():this.AGc()};this.yOf=()=>{this.cHb=0};this.Abg=()=>{const Bd=this.D8.bod();
Ra(this.va,null!=Bd.SuspensionStartTimestamp?Bd.SuspensionStartTimestamp:0,null,()=>{this.P8i(Bd)},null,null,this.va.Lc())};this.nFa=(Bd,Id)=>{if(Id){Id.Jsb.MergeCount=this.D8.bod();let ee;({min:Bd,max:ee}=Ia.h(this.$).tWi());Ja.EwaSettings.isChangeGateEnabled("OfficeVSO:5524817_LogOnMergeRaceCondition2")?Id.Jsb.ClientRevisions=Object(Pa.a)(new va,{Min:Bd,Max:ee,MaxFromBlockCache:Ia.h(this.$).Ca.bEf}):Id.Jsb.ClientRevisions=Object(Pa.a)(new va,{Min:Bd,Max:ee})}};this.$=Ya;this.w2a=Ec;this.D8=Qb;this.D8.SYg(this.iQf);
this.D8.W4b(this.DLb);this.D8.eYg(this.yOf);this.$.qa.Bja(this.nFa);this.va=this.$.qa.va;this.bUd=this.$.xa.MergeSuspensionRequestThrottlingTimeInMs;this.yLi=this.$.xa.KeepBlockingPendingMergesRequestIntervalMs;this.cMa=id;f.ULS.sendTraceTag(588276807,0,50,"RequestController initialized")}dispose(){this.$.qa.Rpa(this.nFa);this.AGc();this.D8.Kzj(this.iQf);this.D8.uAc(this.DLb);this.D8.hzj(this.yOf);this.D8=null;super.dispose()}V1j(){this.AGc();if(this.TTe()){const Ya=this.D8.bod();f.ULS.sendTraceTag(537155414,
0,50,`RequestController.StartKeepBlockingPendingMergesTimer: Prevented starting StartKeepBlockingPendingMergesTimer because of repeated failure in counter ${ob(Ya)} fail count: ${this.cHb}`)}else this.dHb=this.w2a.create(this.Abg,this.bUd,na.a.dHb),this.Zab=this.w2a.iE(this.Abg,this.yLi,na.a.Zab)}AGc(){this.Zab&&(this.dHb.cancel(),this.Zab.cancel(),this.Zab=this.dHb=null)}P8i(Ya){let Qb;Qb=" fail count: "+this.cHb;this.cHb++;this.TTe()&&this.AGc();f.ULS.sendTraceTag(542229773,0,10,`RequestController.OnKeepBlockingPendingMergesRequestFailed: request failed ${ob(Ya)}${Qb}`)}TTe(){return this.cHb>
ka.hVi}}ka.hVi=5;Object(e.a)(ka,"RequestController",U.a,[]);var da=a(172),kb=a(206),Ob=a(33),lc=a(248);class tc extends Sys.EventArgs{constructor(Ya,Qb){super();this.EEf=Ya;this.E1=Qb}}Object(e.a)(tc,"MergeDidntOccurEventArgs",Sys.EventArgs,[]);class Pb extends U.a{get uPa(){return 0<this.oLd}constructor(Ya,Qb,Ec=null,id=null,Bd=null){super();this.lqc=null;this.oLd=0;this.documentVisibilityObserver=null;this.jxf=!1;this.Hsc=null;this.va=Ya;this.bUd=Qb.xa.MergeSuspensionRequestThrottlingTimeInMs;const Id=
Qb.xa.GetRangeContentPrefetchDelayForMergeInMs;this.Sz=()=>{Qb.kag(Id)};this.vi=Ec||Ob.a.Lb;this.Nvg=0;this.RM=id;this.qDa=Bd;Qb.da.Qb(291,ee=>{this.documentVisibilityObserver=ee})}fYg(Ya){this.addHandler(Pb.NFd,Ya)}izj(Ya){this.removeHandler(Pb.NFd,Ya)}Fye(Ya){this.addHandler(Pb.IFd,Ya)}m5f(Ya){this.removeHandler(Pb.IFd,Ya)}get isDocumentHidden(){return!!this.documentVisibilityObserver&&this.documentVisibilityObserver.Ei}c4g(Ya,Qb,Ec=!1){this.dSb(Ya,Qb,Ec)?(new da.a).setResult(!0):(Qb=this.fij(Ya,
Qb),this.lqc=Ya,this.oLd++,Qb.continueWith(()=>{this.m4i()},0,kb.a.none,this.RM))}fij(Ya,Qb){this.Nvg=this.vi.yha;this.jxf=Qb;f.ULS.sendTraceTag(554767493,0,50,`DoPendingMergeSender.performDoPendingMergeInternal: Sending DoPendingMerge ${Ya.Current} / ${Ya.Pending} @${Ya.SuspensionStartTimestamp}. allowSelectionAdjustment: ${Qb}`);this.isDocumentHidden||this.Sz();return this.VJj(Qb,Ya)}dSb(Ya,Qb,Ec=!1){if(this.qDa&&!Qb&&!this.qDa.JIi())return f.ULS.sendTraceTag(523317956,0,50,"DoPendingMergeSender.shouldThrottle: We can't retrieve selection and selection adjustments are disallowed."),
!0;if(!this.lqc||Ya.SuspensionStartTimestamp>this.lqc.SuspensionStartTimestamp)return this.uPa&&f.ULS.sendTraceTag(523551556,0,50,`DoPendingMergeSender.shouldThrottle: Allowing request for new suspension while previous is ongoing, new counter: ${Ya.Current} / ${Ya.Pending} @${Ya.SuspensionStartTimestamp}`),!1;if(this.uPa)return!0;if(Ec)return!1;Ec=this.lqc;const id=this.vi.yha-this.Nvg<this.bUd;Qb=this.jxf===Qb;return(Ya||Ec?Ya&&Ec?Ya.Current===Ec.Current&&Ya.Pending===Ec.Pending&&Ya.SuspensionStartTimestamp===
Ec.SuspensionStartTimestamp:!1:!0)&&id&&Qb}VJj(Ya,Qb){const Ec=this.va.Lc(),id=()=>{f.ULS.sendTraceTag(588276806,0,10,`DoPendingMergeSender.sendDoPendingMergeRequest: request failed ${Qb.Current} / ${Qb.Pending} @${Qb.SuspensionStartTimestamp}`)};return this.qDa?this.qDa.sGj(this.U4h(Ya,id,Ec)):this.fHe(null,!0,void 0,id,Ec)}U4h(Ya,Qb,Ec){return(id,Bd,Id)=>{let ee=void 0;f.ULS.shipAssertTag(523317955,0,null!=id||Ya,"!allowSelectionAdjustment requires a non-null initialViewportState.");ee=this.n4i.bind(this);
Bd&&(ee=lc.b.call(null,Fe=>{const La=Fe.Result;let Kb=null===La||void 0===La?void 0:La.AdjustedViewportState;3===(null===La||void 0===La?void 0:La.MergeResultState)&&(Kb=void 0);Bd(Kb,Fe.StateId)},ee));Id&&(Qb=lc.a.call(null,Id,Qb));return this.fHe(id,Ya,ee,Qb,Ec)}}fHe(Ya,Qb,Ec,id,Bd){return ib(this.va,Ya,Qb,Ec,id,null,null,Bd)}n4i(Ya){var Qb=Ya.Result;void 0!=Qb&&(Qb=Qb.MergeResultState,Ja.EwaSettings.isChangeGateEnabled("OfficeVSO:7464389_RetryDoPendingMergeAfterBailout")&&2!==Qb?this.Hsc=[Qb,Ya.MergeCount]:
3===Qb&&(f.ULS.sendTraceTag(523317954,0,50,"DoPendingMergeSender.onDoPendingMergeSucceeded: Aborted merge."),this.Dpj()))}Dpj(){this.raiseEvent(Pb.NFd,new Sys.EventArgs)}Cpj(Ya,Qb){this.raiseEvent(Pb.IFd,new tc(Ya,Qb))}m4i(){this.oLd--;if(this.Hsc){const Ya=this.Hsc;this.Hsc=null;this.Cpj(...Ya)}}}Pb.NFd="MWA";Pb.IFd="MDO";Object(e.a)(Pb,"DoPendingMergeSender",U.a,[647,648]);class tb{constructor(Ya=!1){this.divergenceOnResponse=this.adjustedDidntChangeWithDivergence=this.editBoxDivergence=this.differentSheetAdjust=
this.parallel=this.errors=this.nonContinuous=this.divergenceOnViewportReady=this.adjusted=this.adjustedDidntChange=0;this.Iri=Ya}get reportName(){return this.Iri?"SelectionAdjustInHiddenDocument":"SelectionAdjust"}}Object(e.a)(tb,"SelectionAdjustSessionEndsReport",null,[279]);var gc=a(47);class Xb{constructor(Ya,Qb,Ec,id,Bd,Id){this.Ub=Ya;this.QH=Qb;this.eba=Ec;this.G1b=id;this.tae=Bd;this.mN=Id}get activeCell(){return this.QH}get selectedRanges(){return this.eba}get Qr(){let Ya=!1;if(null===this.mN||
void 0===this.mN)Ya=!0;else if(this.mN>=this.selectedRanges.length||!this.selectedRanges[this.mN].contains(this.activeCell))f.ULS.sendTraceTag(521200010,0,50,`SelectionState.indexOfActiveRange: the index of the adjusted active range has changed. indexOfActiveRange: ${this.mN}, selectedRangesLength: ${this.selectedRanges.length}`),Ya=!0;Ya&&(this.mN=this.dah());return this.mN}get activeRange(){return 0>this.Qr?this.activeCell:this.selectedRanges[this.Qr]}get sheetName(){return this.G1b}get activeItemName(){return this.tae}get qAg(){return 1===
this.selectedRanges.length}Wwg(Ya){let Qb=this.selectedRanges.map(Ec=>this.dak(Ec,this.tae));for(let Ec of Qb)if(Ec)for(let id of Ec)if(id.Zk&&id.Ue.Revision<Ya)return!1;return!0}J7j(){var Ya;return{SheetName:this.sheetName,ActiveCell:null===(Ya=this.activeCell)||void 0===Ya?void 0:Ya.toString(),TopLeft:void 0,SelectedRanges:gc.r(this.selectedRanges,this.Ub)}}toString(){var Ya,Qb;return`active cell: ${null!==(Qb=null===(Ya=this.activeCell)||void 0===Ya?void 0:Ya.toString())&&void 0!==Qb?Qb:"null"} selection: ${ma.f(this.selectedRanges,
Ec=>{var id;return null!==(id=null===Ec||void 0===Ec?void 0:Ec.toString())&&void 0!==id?id:"null"}).join(",")}`}equals(Ya){return Ya?this.activeCell.equals(Ya.activeCell)&&gc.R(this.selectedRanges,Ya.selectedRanges)&&this.sheetName===Ya.sheetName:!1}dah(){for(let [Ya,Qb]of this.selectedRanges.entries())if(null===Qb||void 0===Qb?0:Qb.contains(this.activeCell))return Ya;return-1}dak(Ya,Qb){var Ec;const id=Ia.h(this.Ub).Ca.DNa(Ya,Qb);id||f.ULS.sendTraceTag(522803340,0,50,`SelectionState.tryGetBlockCacheItemsFromRange: no items found. range: ${null!==
(Ec=null===Ya||void 0===Ya?void 0:Ya.toString())&&void 0!==Ec?Ec:"null"} ; activeItemNameIsDefined: ${!!Qb}`);return id}}Object(e.a)(Xb,"SelectionState",null,[]);var Ga=a(221),Za=a(761);class Sb{constructor(Ya){this.uGc=0;this.xI=this.KG=null;this.Jae=new tb;this.Kae=new tb(!0);this.vJ=0;this.T5j=!1;this.yWi=1E4;this.ee=()=>{this.DQe()};this.Kj=()=>{this.g5c(!0,!1)};this.Ycb=()=>{this.g5c(!1,!1)};this.$=Ya;this.gridView=Ia.h(this.$);this.gridView.Ca.Aw(this.Kj);this.gridView.Ca.vv(this.Ycb);this.gridView.Ca.Kxe(this.Ycb);
this.gridView.Ca.vba(this.Ycb);this.$.$l(this.ee);this.DQe()}sGj(Ya){let Qb=null,Ec=null,id=()=>{this.L0i()};this.Eof()?(this.dR.parallel++,f.ULS.sendTraceTag(526390086,0,15,`SelectionAdjustManager.runRequestWithSelectionAdjust: Skipping parallel request. Current adjustedSelection is defined : ${!!this.xI}`)):(Qb=(Bd,Id)=>{this.M0i(Bd,Id)},Ec=this.NPj());return null===Ya||void 0===Ya?void 0:Ya(Ec,Qb,id)}JIi(){return!this.Eof()&&this.Bda().qAg}NPj(){var Ya;f.ULS.shipAssertTag(525135961,0,0===this.vJ,
"SelectionAdjustManager.setPreRequestState: unexpected state");this.xI&&(this.dR.errors++,f.ULS.sendTraceTag(526960090,0,10,`SelectionAdjustManager.setPreRequestState: About to ignore a defined Adjusted selection: ${this.xI.toString()}`));this.xI=null;this.KG=this.Bda();let Qb=null;const Ec=null===(Ya=this.KG)||void 0===Ya?void 0:Ya.J7j();Ec&&(Qb={ActiveSheetName:this.KG.sheetName,SheetViewportStateChanges:[Ec]});this.vJ=1;return Qb}L0i(){f.ULS.shipAssertTag(525135960,0,1===this.vJ,"SelectionAdjustManager.onAdjustedRequestFailed: unexpected state");
this.dR.errors++;this.vJ=2;this.Hs()}M0i(Ya,Qb){try{f.ULS.shipAssertTag(525135959,0,1===this.vJ,"SelectionAdjustManager.onAdjustedSelectionReady: unexpected state"),this.uGc=Qb,Qb=2,this.KG?Ya?(this.xI=this.tTj(Ya))?(Qb=7,this.KG.equals(this.xI)?this.KG.equals(this.Bda())?(this.dR.adjustedDidntChange++,Qb=4):(this.dR.adjustedDidntChangeWithDivergence++,Qb=5):this.KG.sheetName!=this.xI.sheetName?(this.dR.differentSheetAdjust++,Qb=10):this.KG.equals(this.Bda())||(this.dR.divergenceOnResponse++,Qb=6,
this.B6f())):this.dR.errors++:(this.dR.errors++,f.ULS.sendTraceTag(537155412,0,15,`SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted returned null, initialSelection: ${this.KG.toString()}`)):(this.dR.errors++,f.ULS.sendTraceTag(537155413,0,10,`SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted selection results returned when not waiting for them, adjusted:  ActiveCell: ${null===Ya||void 0===Ya?void 0:Ya.ActiveCell}`)),this.vJ=Qb}catch(Ec){this.vJ=12,f.ULS.sendTraceTag(525135958,0,10,
`SelectionAdjustManager.OnAdjustedSelectionReady: caught Exception ${Ec}`)}finally{7!=this.vJ?this.Hs():this.g5c(!1,!0)}}dispose(){this.gridView.Ca.gx(this.Kj);this.gridView.Ca.Vt(this.Ycb);this.gridView.Ca.y4f(this.Ycb);this.gridView.Ca.nUa(this.Ycb);this.$.hn(this.ee)}Eof(){return 1===this.vJ||7===this.vJ}tTj(Ya){let Qb;if(!({range:Qb}=gc.ab(Ya.ActiveCell,this.$.ua)).returnValue)return f.ULS.sendTraceTag(537155411,0,10,`SelectionAdjustManager.sheetViewportStateToSelectionState: Unable to extract active cell ${Ya.ActiveCell}`),
null;let Ec=[];const id=this.$.na,Bd=!!id&&2===id.yH;if(Ya.SelectedRanges)Ec=gc.g(Ya.SelectedRanges.Ranges);else if(!Bd)return f.ULS.sendTraceTag(522826913,0,10,`SelectionAdjustManager.sheetViewportStateToSelectionState: SelectedRanges is null, active sheet exists: ${!!id}`),null;return new Xb(this.$,Qb,Ec,Ya.SheetName,this.KG.activeItemName,this.KG.Qr)}Bda(){const Ya=this.$.na;if((null===Ya||void 0===Ya?0:Ya.activeCell)&&Ya.selectedRanges&&Ya.sheetName)return new Xb(this.$,Ya.activeCell,Ya.selectedRanges,
Ya.sheetName,this.$.activeItemName,Ya.Qr);f.ULS.sendTraceTag(525135957,0,15,`SelectionAdjustManager.getCurrentSelection: invalid activeItem. activeItem null: ${!Ya}, activeCell null: ${!(null===Ya||void 0===Ya?0:Ya.activeCell)}, selectedRanges null: ${!(null===Ya||void 0===Ya?0:Ya.selectedRanges)}, sheetName null: ${!(null===Ya||void 0===Ya?0:Ya.sheetName)}`);return null}DQe(){this.$.da.Qb(276,()=>{const Ya=Ga.a(this.$);Ya.dV(this.Jae);Ya.dV(this.Kae)})}g5c(Ya,Qb){var Ec;if(this.IGi(Ya))if(8===this.vJ)f.ULS.sendTraceTag(523106438,
0,15,"SelectionAdjustManager.attemptAdjustSelection: skipping as was already adjusted");else{Qb&&f.ULS.sendTraceTag(524039250,0,50,"SelectionAdjustManager.attemptAdjustSelection: viewport ready on response");try{f.ULS.shipAssertTag(525135956,0,7===this.vJ,"SelectionAdjustManager.attemptAdjustSelection: unexpected state"),this.KG.equals(this.Bda())?(null===(Ec=this.gridView)||void 0===Ec?0:Ec.Ob)?(this.dR.editBoxDivergence++,this.vJ=11):(Ya=0,Ya=this.xI.Qr,-1==Ya?(this.dR.errors++,f.ULS.sendTraceTag(522826912,
0,10,"SelectionAdjustManager.attemptAdjustSelection: invalid indexOfActiveRange")):(this.dR.adjusted++,this.vJ=8,this.gridView.ga.wH(this.xI.selectedRanges,Ya,this.xI.activeCell,0,void 0,"SelectionAdjust"))):(this.dR.divergenceOnViewportReady++,this.B6f(),this.vJ=9)}catch(id){this.vJ=12,f.ULS.sendTraceTag(525135955,0,10,`SelectionAdjustManager.attemptAdjustSelection: caught Exception ${id}`)}finally{this.Hs()}}}IGi(Ya){if(!this.xI)return!1;if(!this.KG)return f.ULS.sendTraceTag(537155409,0,10,`SelectionAdjustManager.attemptAdjustSelection: initialSelection is null while adjustedSelection isn't null, adjustedSelection: ${this.xI.toString()}`),
!1;if(Ia.h(this.$).Ca.bEf<this.uGc)return!1;if(Ya||this.T5j)f.ULS.sendTraceTag(528590295,0,15,"SelectionAdjustManager.attemptAdjustSelection: got to blockCacheConsistent while pending for selection adjust");else if(!this.KG.Wwg(this.uGc)||!this.xI.Wwg(this.uGc))return!1;return!0}Hs(){this.KG=this.xI=null;this.vJ=0}B6f(){const Ya=this.Bda();f.ULS.sendTraceTag(537155408,0,50,`SelectionAdjustManager.ReportDivergence: initial: ${this.KG.toString()} current: ${Ya?Ya.toString():""} adjusted: ${this.xI.toString()} sheetSameBetweenInitialAndAdjusted: ${this.KG.sheetName===
this.xI.sheetName} sheetSameBetweenInitialAndCurrent: ${this.KG.sheetName===(Ya?Ya.sheetName:null)}`)}get dR(){return Za.a.HE(this.yWi)?this.Kae:this.Jae}}Object(e.a)(Sb,"SelectionAdjustManager",null,[646,2]);class sb extends Ua.a{constructor(Ya,Qb,Ec=null){super();this.bGa=this.plc=this.o9a=this.G3a=null;this.$=Ya;this.O_a=new Ca(Ya);this.qDa=new Sb(this.$);this.cMa=new Pb(this.$.qa.va,this.$,void 0,void 0,this.qDa);this.pti(Ya,Ec);this.wia=new Xa(this.bGa,this.O_a,this.cMa);this.VTd=new ka(Ya,this.wia,
Qb,this.cMa);Ja.EwaSettings.ya(230)&&(this.plc=new qb(Ya,this));f.ULS.sendTraceTag(588276810,0,50,"MergeSuspensionManager created")}W4b(Ya){this.wia.W4b(Ya)}uAc(Ya){this.wia&&this.wia.uAc(Ya)}get lka(){return this.bGa}get rpa(){return this.O_a}get D8(){return this.wia}PCa(Ya,Qb){this.bGa.PCa(Ya,Qb)}A6d(Ya){this.bGa.A6d(Ya)}ySa(Ya,Qb=""){this.O_a.ySa(Ya,Qb)}dispose(){this.plc&&(this.plc.dispose(),this.plc=null);this.qDa&&this.qDa.dispose();this.cMa.dispose();this.VTd&&(this.VTd.dispose(),this.VTd=
null);this.wia&&(this.wia.dispose(),this.wia=null);this.O_a.dispose();this.O_a=null;this.bGa.dispose();this.bGa=null;this.G3a&&(this.G3a.dispose(),this.G3a=null);this.o9a&&(this.o9a.dispose(),this.o9a=null);this.$=null;super.dispose()}rNb(){this.wia.dqj()}static Bgc(Ya){let Qb=0;for(let Ec of Ya){if(2==Ec)return 2;1==Ec&&(Qb=1)}return Qb}pti(Ya,Qb){this.bGa=new lb(this.cMa,this.O_a);Qb?Object(pa.a)(nb,Qb)?this.PCa(Qb,Object(M.a)(nb,Qb).EJ):Object(pa.a)(ca,Qb)?this.PCa(Qb,Object(M.a)(ca,Qb).EJ):this.PCa(Qb,
0):(this.G3a=new ca(Ya),this.o9a=new nb(Ya),this.PCa(this.G3a,this.G3a.EJ),this.PCa(this.o9a,this.o9a.EJ))}}Object(e.a)(sb,"MergeSuspensionManager",Ua.a,[629,2]);class bc extends hb.a{constructor(Ya){super();this.Rd=Ya;this.uc()}create(){f.ULS.sendTraceTag(537155419,0,50,"MergeSuspensionFactory.Create");this.$b(this.Rd.da.Ba(343)||this.Rd.da.Ja(343,new sb(this.Rd,fb.a.instance)))}static la(Ya){f.ULS.sendTraceTag(537155418,0,50,"MergeSuspensionFactory.Attach");Ya.da.Ja(344,new bc(Ya))}}Object(e.a)(bc,
"MergeSuspensionFactory",hb.a,[]);var kc=a(92),vb=a(103),ub=a(62),Ub=a(16);class Rd{}Rd.dOi=3;Rd.connected=0;Object(e.a)(Rd,"ConnectionStateConstants",null,[]);var Cd=a(116),Yc=a(130),Kd=a(50);class oc{constructor(Ya,Qb,Ec){var id;this.type=0;this.startTime=null;this.blockedOperationsCount=this.durationMs=0;this.blockedActions=null;this.blockedUserOperationsWhileToastShown=this.durationUntilToastShownMs=0;this.toastRaiser=null;this.wasUserActiveOnPIEnd=this.wasUserActiveOnPIStart=this.hasTabbedOut=
this.isToastShown=!1;this.durationUntilUserInactive=-1;this.isTaskPaneCollapsed=this.isTaskPaneShown=this.isDialogShown=!1;this.dJf=(Bd,Id)=>{this.blockedOperationsCount++;Bd=`${Id.componentName}_${Id.actionName}_${Id.details})`;this.blockedActions[Bd]=this.blockedActions[Bd]?this.blockedActions[Bd]+1:1;this.isToastShown&&this.blockedUserOperationsWhileToastShown++};this.kLd=Bd=>{this.durationUntilUserInactive=Cd.getElapsedSeconds(this.startTime,Ob.a.Lb.Mc);Bd.cTd(this.kLd)};this.JX=()=>{this.hasTabbedOut=
!0};this.Afa=(Bd,Id)=>{Id.mVf!==this.type||this.isToastShown||(this.durationUntilToastShownMs=Yc.a(Ob.a.Lb,this.startTime),this.toastRaiser=Id.toastRaiser,this.isToastShown=!0)};this.startTime=Ya;this.durationUntilToastShownMs=0;this.blockedActions={};this.isToastShown=Ec;if(null===(id=Qb.ea)||void 0===id?0:id.Kf)this.wasUserActiveOnPIStart=Qb.ea.Kf.cr;this.vj(Qb);this.isDialogShown=0<Qb.Zb.hT;Ya=Qb.da.Ba(183);this.isTaskPaneShown=!!Ya&&Ya.isVisible&&!Ya.isCollapsed;this.isTaskPaneCollapsed=!!Ya&&
Ya.isVisible&&Ya.isCollapsed}rdg(){this.durationMs=Yc.a(Ob.a.Lb,this.startTime)}uKd(Ya){var Qb;this.rdg();Kd.a(Ya).GOb(this.dJf);Kd.a(Ya).Lg.oAc(this.Afa);Ya.da.Qb(291,Ec=>{Ec.Wfb(this.JX)});if(null===(Qb=Ya.ea)||void 0===Qb?0:Qb.Kf)Ya.ea.Kf.cTd(this.kLd),this.wasUserActiveOnPIEnd=Ya.ea.Kf.cr}vj(Ya){Kd.a(Ya).M4b(this.dJf);this.isToastShown?this.toastRaiser="Immediate":Kd.a(Ya).Lg.U2c(this.Afa);Ya.da.Qb(291,Qb=>{this.hasTabbedOut=Qb.Ei;Qb.hJa(this.JX)});this.wasUserActiveOnPIStart&&Ya.ea.Kf.pze(this.kLd)}}
Object(e.a)(oc,"PartialInteractivityData",null,[]);var eb=a(1092);class yb extends oc{constructor(Ya,Qb,Ec,id,Bd,Id){super(Ya,Qb,id);this.swappedOffline=this.swappedByOffline=!1;this.lastFailedRequestToOnlineTimeGapSec=this.longestDurationBetweenFailedRequestsSec=this.averageDurationBetweenFailedRequestsSec=0;this.errorDataDuringConnectivityIssuesMode=this.disconnectionSource=null;this.failedRequests=[];this.triggeringRequest=null;this.type=4;this.swappedOffline=Ec;this.disconnectionSource=Enum.toString(eb.a,
Bd);this.triggeringRequest=Id}g3i(Ya,Qb){this.swappedByOffline=Qb;this.uKd(Ya)}uNj(Ya){this.errorDataDuringConnectivityIssuesMode=Ya}xsj(Ya){10>this.failedRequests.length&&(Ya=Ya+"_"+Cd.getElapsedSeconds(this.startTime,Ob.a.Lb.Mc).toString(),this.failedRequests.push(Ya))}}Object(e.a)(yb,"ConnectivityIssuesData",oc,[]);var zc=a(169),dd=a(138),od=a(120);class Ed{}Ed.jBh="DuringWork";Ed.connectivityIssues="ConnectivityIssues";Ed.offline="Offline";Object(e.a)(Ed,"UnavailabilityTypes",null,[]);var ce=
a(55);class wc{constructor(Ya){this.gqc=this.data=null;this.lid=0;this.gNe=null;this.pKf=(Qb,Ec)=>{Ec.xN?(this.data=new yb(Ob.a.Lb.Mc,this.$,5===Ec.gra,0!==Ec.gra,this.$.Lf.disconnectionSource,this.gNe),this.gqc=this.$.Lf.cyf,this.lid=1,this.$.qa.Lf.SZg(this.Fn),zc.a(this.$).z2c(this.C$f)):(this.data.g3i(this.$,5===Ec.gra),this.$.qa.Lf.I5f(this.Fn),this.data.lastFailedRequestToOnlineTimeGapSec=Cd.getElapsedSeconds(this.gqc,Ob.a.Lb.Mc),Ja.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_7pzab_ConnectivityIssues")?
ce.b().JQb(557682689,0,50,Ed.connectivityIssues,this.data.durationMs,"ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: {0}",ub.a.nd(this.data)):f.ULS.sendTraceTag(557682689,0,50,`ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: ${ub.a.nd(this.data)}`),this.data&&this.data.isToastShown&&vb.Health.instance.recordQosError(dd.a.nfh,[od.a.Pqc],!0,!1,!1,!1,null),zc.a(this.$).uSd(this.C$f),this.data=null)};this.C$f=
(Qb,Ec)=>{this.data.uNj(Ec.NR)};this.Fn=(Qb,Ec)=>{this.data.xsj(Ec.context.methodName);Qb=Ob.a.Lb.Mc;Ec=Cd.getElapsedSeconds(this.gqc,Qb);this.gqc=Qb;Ec>this.data.longestDurationBetweenFailedRequestsSec&&(this.data.longestDurationBetweenFailedRequestsSec=Ec);this.lid++;this.data.averageDurationBetweenFailedRequestsSec=this.O$g(Ec)};this.mKf=(Qb,Ec)=>{this.gNe=Ec.A$j};this.$=Ya;Kd.a(this.$).Lg.Uxe(this.pKf);this.$.Lf.Txe(this.mKf)}dispose(){this.$&&(Kd.a(this.$).Lg.I4f(this.pKf),this.$.Lf&&this.$.Lf.H4f(this.mKf));
this.data&&this.$.qa.Lf.I5f(this.Fn);this.$=null}O$g(Ya){const Qb=this.lid-1;return(this.data.averageDurationBetweenFailedRequestsSec*(Qb-1)+Ya)/Qb}}Object(e.a)(wc,"ConnectivityIssuesTelemetryManager",null,[2]);var ed=a(898),md=a(9),Yd=a(1091),$d=a(1090);class bd{constructor(Ya){this.D9f=null;this.uBd=this.WFd=this.bKb=this.cKb=0;this.C_d=!1;this.p$c=this.tWa=this.UFc=this.zcb=null;this.E$c=0;this.QJj=()=>{if(12E4>this.$.ea.Kf.jjb)for(let Qb of this.UFc)Qb.runTest();else this.z2d("UserInactive")};
this.nCj=Qb=>{Qb=Sys.Serialization.JavaScriptSerializer.serialize(Qb);f.ULS.sendTraceTag(388821830,0,50,Qb)};this.DBj=Qb=>{if(Qb){var Ec=this.p$c[Qb.testIteration.toString()];Ec?Ec.push(Qb):(Ec=[Qb],this.p$c[Qb.testIteration.toString()]=Ec);if(Ec.length===this.D9f.length){Ec=Sys.Serialization.JavaScriptSerializer.serialize(Ec);if(this.$&&this.$.Lf){if(Qb.EstimatedLatency=this.$.Lf.kEe,this.$.Lf.kEe>this.$.nA.ExcelRountripThresholdMs){f.ULS.sendTraceTag(570712144,0,50,`Periodic ping tests results when network is slow: ${Ec}, consequtive slow ping iteration #: ${this.E$c++}`);
return}}else f.ULS.sendTraceTag(537155209,0,50,"EwaControl/ConnectivityObserver is null when conducting slow connection speed tests");f.ULS.sendTraceTag(570712142,0,50,`Periodic ping tests results: ${Ec}`);this.E$c=1}}};this.ei=(Qb,Ec)=>{Qb=Ec.context.methodName;if(Qb===md.a.LBb||Qb===md.a.xya)this.bKb++,Qb=Date.now(),this.bVj(Qb)&&(this.bKb=0,this.uBd=Qb,this.n2j())};this.zfa=()=>{this.b2d("OnThrottledUserActivity")};this.JX=()=>{this.z2d("OnDocumentHidden")};this.KJ=()=>{this.b2d("OnDocumentUnhidden")};
this.$=Ya;if(this.D_d=this.Fdh())this.D9f=[$d.a.KLc],this.E$c=1,this.p$c={},this.$.ea.Kf.Aja(this.zfa),this.$.da.Qb(291,Qb=>{Qb.hJa(this.JX);Qb.Xua(this.KJ)})}dispose(){this.$&&(this.C_d&&this.$.qa&&0<this.zcb.count&&this.$.qa.Wt(this.ei),this.D_d&&(this.z2d("Dispose"),this.$.ea.Kf.WCa(this.zfa)))}Usi(){Ja.EwaSettings.ya(199)&&this.ilj();this.D_d&&this.jlj()}qti(){this.bKb=this.cKb;this.uBd=0;var Ya={};if(!this.zcb){this.zcb=new ea.a;const Qb=Yd.a.Ykd(this.nCj,"InitSampleMeasurement",this.$);for(const Ec of Qb)Ya[Ec.Qsd]=
Ec.baseUrl,this.zcb.add(Ec)}Ya=Sys.Serialization.JavaScriptSerializer.serialize(Ya);f.ULS.sendTraceTag(537155210,0,50,`Init Network measurement: numberOfRequestToWaitPerNetworkMeasurement: ${this.cKb}, numberOfRequestFromTheLastNetworkMeasurement: ${this.bKb}, testParams: ${Ya} `);0<this.zcb.count&&this.$.qa.Bs(this.ei)}n2j(){for(let Ya of this.zcb)Ya.runTest()}b2d(Ya){this.tWa&&this.tWa.Zo||(f.ULS.sendTraceTag(537155208,0,50,`NetworkMeasurement.StartConnectionSpeedTest: starting ping tests. caller: ${Ya}`),
this.tWa=fb.a.instance.iE(this.QJj,5E3,na.a.l0j),this.tWa.bX())}z2d(Ya){this.tWa&&this.tWa.Zo&&(f.ULS.sendTraceTag(537155207,0,50,`NetworkMeasurement.StopConnectionSpeedTest: stopping ping tests. caller: ${Ya}`),this.tWa.cancel())}bVj(Ya){return this.bKb>=this.cKb&&Ya-this.uBd>this.WFd}Fdh(){return bd.s9f(this.$.xa.SlowNetworkMeasurementsSamplePercentage)}ilj(){this.cKb=this.$.xa.NumberOfRequestToWaitPerNetworkMeasurement;this.WFd=1E3*this.$.xa.MinTimeBetweenNetworkMeasurementInSec;const Ya=this.$.xa.NetworkMeasurementsSamplePercentage;
0<this.cKb&&0<this.WFd&&(this.C_d=bd.s9f(Ya))&&this.qti()}jlj(){if(!this.UFc){this.UFc=new ea.a;const Ya=Yd.a.Ykd(this.DBj,"PrepareAndInitSlowNetworkTests.ConnectionSpeedTest",this.$,[$d.a.KLc]);for(const Qb of Ya)this.UFc.add(Qb);this.$.ea.Kf.cr&&this.b2d("PrepareAndInitSlowNetworkTests")}}static s9f(Ya){return 100*Math.random()<Ya}}Object(e.a)(bd,"NetworkMeasurement",null,[2]);var Vd=a(40),De=a(141),Pe=a(824);class Zb{constructor(Ya){this._count=0;this.sessionID=this.allOfflinePartialInteractivitiesDataInSession=
null;this.allOfflinePartialInteractivitiesDataInSession=[];this.sessionID=Ya}get count(){return this._count}get QV(){return this.allOfflinePartialInteractivitiesDataInSession[this.allOfflinePartialInteractivitiesDataInSession.length-1]}hek(){this.QV&&this.QV.rdg()}rUg(Ya){this.allOfflinePartialInteractivitiesDataInSession.push(Ya);this._count++}}Object(e.a)(Zb,"OfflinePartialInteractivitiesDataForLog",null,[]);class Vc extends oc{constructor(Ya,Qb,Ec){super(Ya,Qb,Ec);this.timeFromLastOffline=0;this._errorDataDuringOfflineMode=
null;this.timeFromLastOffline=-1;this.type=5}gRj(Ya){this.timeFromLastOffline=Ya}vNj(Ya){this._errorDataDuringOfflineMode=Ya}}Object(e.a)(Vc,"OfflinePartialInteractivityData",oc,[]);class Nc{constructor(Ya,Qb){this.gSa=this.QV=null;this.qOd=-1;this.Gzb=null;this.Xxf=w.Task.delay(0);this.udb=(Ec,id)=>{id.xN?this.u$i(id.gra):this.v$i()};this.Afa=(Ec,id)=>{5===id.mVf&&this.V6a()};this.D$f=(Ec,id)=>{this.QV.vNj(id.NR)};this.V6a=()=>{this.gSa.hek();this.kHj(Nc.pMd,Sys.Serialization.JavaScriptSerializer.serialize(this.gSa))};
this.dCj=Ec=>{if(Ec=Ec.result)this.oxg=!0,f.ULS.sendTraceTag(576811915,0,50,`OfflineModeTelemetryManager.ReportOfflinePartialInteractivityDataFromIDB: Previous session's offline partial interactivy data: ${Ec}`)};this.rwj=()=>{this.oxg&&(this.$?Vd.TaskExtensions.za(this.indexedDB.zdd(Nc.pMd),()=>{f.ULS.sendTraceTag(537155204,0,50,"OfflineModeTelemetryManager.RemoveDataFromIDB: Previous session's offline partial interactivy data successfuly removed from IDB.")},this.$.ka):f.ULS.sendTraceTag(537155203,
0,10,"OfflineModeTelemetryManager.RemoveDataFromIDB: EwaControl is null when attempting to remove offline mode data stored in IDB."))};this.lSa=()=>{if(this.gSa&&0<this.gSa.count){const Ec=Sys.Serialization.JavaScriptSerializer.serialize(this.gSa);f.ULS.sendTraceTag(560791644,0,50,`OfflineModeTelemetryManager.OnBeforeUnload: This session's offline partial interactivy data: ${Ec}`)}};this.$=Ya;this.indexedDB=Qb;this.oxg=!1;this.indexedDB.Bf()&&(this.indexedDB.initialize(Nc.JDb,Nc.KDb),this.yBj(),this.gSa=
new Zb(this.$.xa.UserSessionId),Kd.a(this.$).Lg.O2c(this.udb));this.Jn=De.a.instance.JI();this.Jn.la("beforeunload",this.lSa)}dispose(){this.$&&Kd.a(this.$)&&Kd.a(this.$).Lg.KSd(this.udb);kc.a.Ka(this.Gzb);this.$=this.Gzb=null}u$i(Ya){this.QV=new Vc(Ob.a.Lb.Mc,this.$,0!==Ya);this.QV.gRj(-1!==this.qOd?window.performance.now()-this.qOd:-1);this.gSa.rUg(this.QV);Kd.a(this.$).Lg.U2c(this.Afa);this.V6a();this.Gzb=fb.a.instance.iE(this.V6a,Nc.$Uh,na.a.V6a);zc.a(this.$).z2c(this.D$f)}v$i(){this.QV.uKd(this.$);
this.V6a();kc.a.Ka(this.Gzb);this.Gzb=null;this.qOd=window.performance.now();Kd.a(this.$).Lg.oAc(this.Afa);zc.a(this.$).uSd(this.D$f);this.EBj()}kHj(Ya,Qb){this.$?this.Xxf=Vd.TaskExtensions.za(this.Xxf,()=>{this.indexedDB.Vgb(new Pe.a(Ya,Qb))},this.$.ka):f.ULS.sendTraceTag(537155205,0,15,"OfflineModeTelemetryManager.SaveToIndexedDBSequential: EwaControl is null when attempting to write to IDB")}yBj(){const Ya=this.$.ka;Vd.TaskExtensions.za(Vd.TaskExtensions.za(this.indexedDB.T7a(Nc.pMd),this.dCj,
Ya),this.rwj,Ya)}EBj(){if(this.QV){const Ya=Sys.Serialization.JavaScriptSerializer.serialize(this.QV);Ja.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_71qb3_Offline")?ce.b().JQb(560791645,0,50,Ed.offline,this.QV.durationMs,"OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: {0}",Ya):f.ULS.sendTraceTag(560791645,0,50,`OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: ${Ya}`)}this.QV&&
this.QV.isToastShown&&vb.Health.instance.recordQosError(dd.a.mik,[od.a.Pqc],!0,!1,!1,!1,null)}}Nc.JDb="NetworkAvailability";Nc.KDb="NetworkAvailabilityData";Nc.pMd="partialInteractivityData";Nc.$Uh=3E3;Object(e.a)(Nc,"OfflineModeTelemetryManager",null,[2]);var ld=a(1360);const yd=Ya=>{Ya.isSuccess||(Ya=Sys.Serialization.JavaScriptSerializer.serialize(Ya),f.ULS.sendTraceTag(509669840,0,10,Ya))};class sd{constructor(Ya,Qb){this.Eoa=this.WGd=this.VHf=null;this.$=Ya;Ja.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&
Ea.a.Bg||(this.VHf=new Nc(Ya,Qb));Ja.EwaSettings.ya(199)&&(this.WGd=new bd(this.$),this.WGd.Usi());Ja.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&Ea.a.Bg||(this.Eoa=new ed.NetworkConnectionHealthChecker(this.$));this.gjh=new wc(this.$);Ja.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.1CdnDarkTestEnabled",!1)&&(Ya=this.$,Qb=Ja.EwaSettings.getStringFeatureGate("Microsoft.Office.Excel.1CdnDarkTestTargetUrl",""),""!==Qb&&(new ld.a(Ya,"1CDN",Qb,yd,"runOneCdnNetworkTest")).runTest())}dispose(){kc.a.Ka(this.VHf);
kc.a.Ka(this.WGd);kc.a.Ka(this.Eoa);kc.a.Ka(this.gjh);this.$=null}}Object(e.a)(sd,"NetworkConnectionTelemetryManager",null,[2]);class ic extends oc{constructor(Ya,Qb,Ec,id){super(Ya,Qb,Ec);this.wasInteruptedByOfflineMode=!1;this.type=id;this.wasInteruptedByOfflineMode=!1}udb(){this.wasInteruptedByOfflineMode=!0}}Object(e.a)(ic,"SilentReopenData",oc,[]);class Ic{constructor(Ya){this.y$=null;this.dSf=(Qb,Ec)=>{this.bSf(Ec,3)};this.sOf=(Qb,Ec)=>{this.bSf(Ec,2)};this.$=Ya;this.Lg=Kd.a(this.$).Lg;this.Lg.Cye(this.sOf);
this.Lg.wZg(this.dSf)}dispose(){this.Lg.k5f(this.sOf);this.Lg.jAj(this.dSf);this.y$=this.Lg=this.$=null}bSf(Ya,Qb){Ya.xN?this.y$=new ic(Ob.a.Lb.Mc,this.$,0!==Ya.gra,Qb):(5===Ya.gra&&(this.y$.wasInteruptedByOfflineMode=!0),3!==Ya.gra&&2!==Ya.gra||f.ULS.sendTraceTag(537155202,0,10,"SilentReopenPartialInteractivityTelemetryManager.OnSilentReopen: BackToWork/DuringWork partial interactivity has been swapped to DuringWork/BackToWork."),this.y$.uKd(this.$),2===Qb?Ja.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_8dtae_B2W")?
ce.b().KQb(571289604,0,50,Ed.offline,this.y$.durationMs,this.y$):f.ULS.sendTraceTag(571289604,0,50,ub.a.nd(this.y$)):Ja.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_6w9lg_DuringWork")?ce.b().KQb(542782150,0,50,Ed.jBh,this.y$.durationMs,this.y$):f.ULS.sendTraceTag(542782150,0,50,ub.a.nd(this.y$)),this.y$=null)}}Object(e.a)(Ic,"SilentReopenPartialInteractivityTelemetryManager",null,[2]);class kd extends U.a{constructor(Ya,Qb,Ec=!0){super();this.c3=this.X9b=this.hSa=this.Tqa=
this.oWa=null;this.$Ff=0;this.qzc=this.Lfb=this.Mfb=!1;this.bGf=this.documentVisibilityObserver=null;this.nta=!1;this.Ptd=this.H$=0;this.gGb=!1;this.Xjg=0;this.u_d=!1;this.o3=null;this.bPf=()=>{f.ULS.sendTraceTag(537155219,0,50,"NetworkConnectionStateManager.OnNetworkDownEvent: Network down.");this.Ssc(1,!1)};this.KJ=()=>{this.Bna||this.uIb?window.setTimeout(()=>{this.J4d()},this.$Ff):this.J4d();this.documentVisibilityObserver.UCa(this.KJ);this.gGb=!1};this.Ug=()=>{f.ULS.sendTraceTag(537155218,0,
50,`NetworkConnectionStateManager.OnEditEnded: Edit ended. IsInOfflineMode:${this.uIb}, IsInDuringWorkSilentReopenMode:${this.Frc&&!this.nta}`);this.uIb&&this.Zue();this.Frc&&!this.nta&&this.Wue();Ia.h(this.$).cellTextEditBox.fn(this.Ug);this.Mfb=this.Lfb=!1};this.cPf=()=>{f.ULS.sendTraceTag(537155213,0,50,"NetworkConnectionStateManager.OnNetworkResumedEvent: network was resumed.");this.Ssc(1,!0);this.Lfb&&!this.Mfb&&Ia.h(this.$).cellTextEditBox.fn(this.Ug);this.Lfb=!1};this.zfa=(id,Bd)=>{this.Ptd=
this.H$;this.H$=Bd.WHc};this.cSf=()=>{this.$&&(this.qzc||(Ab.a(this.$).eS(wb.a.RSa).aXg(this.lPf),this.$.$l(this.ee),this.qzc=!0),this.nta=this.pzi(),this.Ssc(2,!1))};this.lPf=()=>{var id=Ab.a(this.$).Pi;const Bd=id.v2g();id=ma.f(id.lu.$d.errors,Id=>Id.MessageIdName);f.ULS.sendTraceTag(545842889,0,50,`NetworkConnectionStateManager.OnOpenWebMethodErrorUserAlertExecuting: IsStateUnrecoverable:${Bd}, IsB2W:${this.nta}, Errors: ${ub.a.nd(id)}`);Bd&&(this.oWa?(this.nta=!1,this.cSe(),this.aJc()):this.Tqa&&
(this.dSe(),this.aJc()))};this.ee=()=>{this.$?(f.ULS.sendTraceTag(541193955,0,50,"NetworkConnectionStateManager.OnWorkbookOpened: Workbook opened."),this.nta=!1,this.c3&&this.c3.Zo&&(kc.a.Ka(this.c3),this.c3=null),this.o3&&this.o3.Zo&&(kc.a.Ka(this.o3),this.o3=null),this.Ssc(2,!0),this.aJc()):f.ULS.sendTraceTag(537155212,0,10,"NetworkConnectionStateManager.OnWorkbookOpened: bug monitoring: EwaControl is null.")};this.nKf=()=>{this.bFf(!0)};this.oKf=()=>{this.bFf(!1)};this.y1b=Rd.dOi;this.A$c=Rd.connected;
this.$=Ya;this.Lf=Ya.qa.Lf;Ec&&(this.bGf=new sd(Ya,Qb));this.$.da.Qb(291,id=>{this.documentVisibilityObserver=id});this.$Ff=this.$.xa.ExcelNetworkCheckAfterTabActivationDelayMs;this.Lf.Iye(this.bPf);this.Lf.msb(this.cPf);this.Lf.Txe(this.nKf);this.Lf.JWg(this.oKf);new Ic(this.$,this);this.ABf=this.$.xa.LongInactivityTimePeriodSeconds;this.$.ea.U4b(this.cSf);this.$.ea.Kf.Aja(this.zfa);this.Xjg=this.$.xa.SilentReopenDuringWorkDelayMs}get wBi(){return this.nta}get uIb(){return!(this.y1b&1)}get Frc(){return!(this.y1b&
2)}get Bna(){return!!(this.A$c&2)}dispose(){this.Lf&&(this.Lf.p5f(this.bPf),this.Lf.FOb(this.cPf),this.Lf.H4f(this.nKf),this.Lf.$xj(this.oKf));this.gGb&&this.documentVisibilityObserver&&(this.documentVisibilityObserver.UCa(this.KJ),this.gGb=!1);this.$&&(this.qzc&&this.aJc(),this.$.ea&&(this.$.ea.ZSd(this.cSf),this.$.ea.Kf&&this.$.ea.Kf.WCa(this.zfa)));this.o3&&(this.o3.dispose(),this.o3=null);kc.a.Ka(this.bGf);this.$=null;super.dispose()}BUi(){this.u_d=!0}Wue(){this.Tqa||(this.Tqa=Kd.a(this.$).Lg.SIa(3,
"NetworkConnectionStateManager.ActivateDuringWorkSilentReopenPartialInteractivity"))}pzi(){if(this.u_d)return this.u_d=!1,!0;const Ya=this.H$>this.ABf||this.Ptd>this.ABf&&10>this.H$;f.ULS.sendTraceTag(537155223,0,50,`NetworkConnectionStateManager.IsBackToWorkSilentReopen: Inactivity duration: Time from last activity:${this.H$}, Time gap between last two activities: ${this.Ptd}. return value:${Ya}`);return Ya}sCj(){this.o3=fb.a.instance.create(()=>{vb.Health.instance.recordQosError(dd.a.q0j,[od.a.Pqc],
!0,!0,!1,!1,null)},6E3,"ReportLongSilentReopenBackToWorkVeto",void 0,!0)}RRg(){this.Tqa||this.c3?f.ULS.sendTraceTag(542782155,0,10,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Trying to activate during-work partial interactivity when we are already in this partial interactivity or there is a running timer that's going to do it soon."):this.c3=fb.a.instance.create(()=>{this.$?this.Tqa?f.ULS.sendTraceTag(537155221,0,15,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Tried to activate SilentReopenDuringWork PI when there is already an DuringWorkSilentReopen partial interactivity object"):
Ia.h(this.$).Ob?(this.Lfb||(Ia.h(this.$).cellTextEditBox.Pm(this.Ug),f.ULS.sendTraceTag(541893722,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Registered OnEditEnded while during-work silent reopen")),this.Mfb=!0,f.ULS.sendTraceTag(537155220,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Need to init during-work silent reopen partial interactivity but the user is during a cell edit. Registered to OnEditEnded event.")):this.Wue():f.ULS.sendTraceTag(537155222,
0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: EwaControl is null")},this.Xjg,na.a.k_j,void 0,!0)}bFf(Ya){this.A$c=this.NGe(2,Ya,!0);this.Nze()}Ssc(Ya,Qb){this.y1b=this.NGe(Ya,Qb,!1);this.Nze()}NGe(Ya,Qb,Ec){Ec=Ec?this.A$c:this.y1b;return Qb?Ec|Ya:Ec&~Ya}J4d(){const Ya=!!this.hSa,Qb=!!this.oWa,Ec=!!this.Tqa,id=!!this.X9b;this.uIb&&!Ya?this.QRg():!this.uIb&&Ya&&this.Fuh();!this.Frc||Qb||Ec?this.Frc||(Qb?this.cSe():(Ec||this.c3&&this.c3.Zo)&&this.dSe()):this.nta?this.PRg():
this.c3||this.RRg();this.Bna&&!id?this.hpg(!0):!this.Bna&&id&&this.hpg(!1)}QRg(){this.$?this.hSa?f.ULS.sendTraceTag(537155215,0,15,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Tried to activate offline PI when there is already an offline partial interactivity object"):Ia.h(this.$).Ob?(this.Mfb||(Ia.h(this.$).cellTextEditBox.Pm(this.Ug),f.ULS.sendTraceTag(537155217,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Registered OnEditEnded during offline mode")),
this.Lfb=!0,f.ULS.sendTraceTag(537155216,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Turned offline while user is editing a cell, registered to OnEditEnded event.")):this.Zue():f.ULS.sendTraceTag(537155214,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: EwaControl is null")}Zue(){this.hSa||(this.hSa=Kd.a(this.$).Lg.SIa(5,"NetworkConnecStateManager.ActivateOfflinePartialInteractivity"))}Fuh(){this.hSa&&(kc.a.Ka(this.hSa),this.hSa=
null)}cSe(){this.oWa&&(kc.a.Ka(this.oWa),this.oWa=null);this.o3&&this.o3.Zo&&this.o3.cancel();this.o3=null}dSe(){this.Tqa&&(kc.a.Ka(this.Tqa),this.Tqa=null);this.c3&&(kc.a.Ka(this.c3),this.c3=null);this.Mfb&&!this.Lfb&&Ia.h(this.$).cellTextEditBox.fn(this.Ug);this.Mfb=!1}PRg(){this.oWa||(this.oWa=Kd.a(this.$).Lg.SIa(2,"NetworkConnectionStateManager.ActivateLongInactivitySilentReopenPartialInteractivity",void 0,Ub.a.instance.ha(2190)));this.sCj()}hpg(Ya){Ya?(this.X9b=Kd.a(this.$).Lg.SIa(4,"NetworkConnectionStateManager.ConnectivityIssues"),
this.hoj()):(kc.a.Ka(this.X9b),this.X9b=null)}hoj(){if(this.$&&this.$.qa){const Ya=this.$.qa.va.Lc();Ka.I(this.$.qa.va,null,null,null,Ya)}}aJc(){Ab.a(this.$).eS(wb.a.RSa).$r(this.lPf);this.$.hn(this.ee);this.qzc=!1}Nze(){this.documentVisibilityObserver||f.ULS.sendTraceTag(537155211,0,15,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: Document visibility observer is null while it shouldn't be.");this.documentVisibilityObserver&&this.documentVisibilityObserver.Ei?this.gGb||
(this.documentVisibilityObserver.Xua(this.KJ),this.gGb=!0,f.ULS.sendTraceTag(541193954,0,50,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: tabbed out user, will update the partial interactivity state when the user will be back.")):this.J4d()}}Object(e.a)(kd,"NetworkConnectionStateManager",U.a,[674,2]);var Hd=a(35),Ud=a(149);class de extends hb.a{constructor(Ya){super();this.$=Ya;this.uc()}create(){void Ud.a.resolve(Hd.Y,{Wa:this.La}).then(Ya=>{let Qb=Object(fa.a)(this.$.da,
400,()=>new kd(this.$,Ya));this.$b(Qb)})}static la(Ya){Ya.da.Ja(401,new de(Ya))}}Object(e.a)(de,"NetworkConnectionStateManagerFactory",hb.a,[]);var qe=a(1093),fe=a(1333),Ke=a(1343),Te=a(1344),Se=a(1103),df=a(1345),te=a(1232),gf=a(1105),cf=a(984),bf=a(989),$a=a(987);String(cf);String(bf);String($a);window.___1684780578254_closurehack=cf;window.___1684780578254_closurehack=bf;window.___1684780578254_closurehack=$a;var Y=a(1302),Ta=a(1201),Bb=a(1295),Rb=a(1278),jc=a(1108),vc=a(1334),bb=a(1284),Mb=a(1257),
hc=a(1303),Cc=a(1266),Wb=a(1214),mc=a(1112),Mc=a(1215),hd=a(1285),pd=a(1304),Nd=a(1335);a(1114);var Xd=a(1223),ae=a(1115),Ve=a(1248),we=a(1305),Mf=a(1267),Ye=a(1306),kf=a(1118),Bf=a(1307),vf=a(1268),Rf=a(1236),re=a(114),Aa=a(112),Eb=a(175),cc=a(282);class pc{constructor(Ya){this.CRa=this.EEd=this.GRa=this.Rrc=0;this.xEd=this.NCf=null;Ya?(this.asc=Ya,this.nxb=Date.now,this.sqh(),this.Tuj()):f.ULS.sendTraceTag(520955213,209,10,"Can not initialize PenMinutesManager because TaskManager is null")}BPj(){this.NCf=
"Office.Excel.Online.Data.Activity.PenMinutes"}Tuj(){window.document.body.addEventListener("pointerenter",Object(D.a)(this,this.Avc,"onPointerEnter"));window.document.body.addEventListener("pointerleave",Object(D.a)(this,this.xfa,"onPointerLeave"));za.a.instance.Dc("Common.App.VisibilityManagement.IVisibilityManager").execute(Ya=>{Ya.Vye(Object(D.a)(this,this.tCb,"handleVisibilityChange"))})}Avc(Ya){"pen"!==Ya.pointerType||this.GRa||(this.GRa=Math.floor(this.nxb()/1E3),this.GRa<=this.Rrc&&(this.GRa=
this.Rrc),this.EEd=0)}xfa(){this.tif()}tif(){const Ya=Math.ceil(this.nxb()/1E3);this.GRa&&Ya>this.Rrc&&(this.EEd=Ya,this.CRa+=this.EEd-this.GRa);this.Rrc=Ya;this.GRa=0}tCb(Ya,Qb){0!==Qb.newState&&this.tif()}sqh(){this.xEd=new Aa.a(4,2,6E4,Object(D.a)(this,this.rRi,"logPenUsage"));this.asc.wg(this.xEd)}rRi(){0<this.CRa&&this.Gbg(this.CRa);this.CRa=0}Gbg(Ya){const Qb=new cc.a;Qb.name=this.NCf;const Ec=[];(Ya=re.a.Ig("PenInputSec",Ya.toString(),3))&&Array.add(Ec,Ya);Qb.dataFields=Ec;Eb.a.sendActivityEvent(Qb)}dispose(){0<
this.CRa&&this.Gbg(this.CRa);this.asc.jq(this.xEd)}}Object(e.a)(pc,"PenMinutesManager",null,[640]);class Hc{constructor(){this.UWc=this.Nb=null}get name(){return"Common.App.PenMinutesManager"}Oi(Ya){this.Nb=Ya;const Qb=d.AFrameworkApplication.Xi;this.Nb.register(640,"Common.App.PenMinutesManager.IPenMinutesManager").gd().od(()=>new pc(Qb))}init(){this.UWc=this.Nb.resolve("Common.App.PenMinutesManager.IPenMinutesManager")}dispose(){this.UWc&&this.UWc.dispose()}static main(){V.a.instance.wj(new Hc)}}
Object(e.a)(Hc,"PenMinutesManagerPackage",null,[4,5]);class td extends hb.a{constructor(Ya){super();this.$=Ya;this.uc()}static la(Ya){Ya.da.Ja(514,new td(Ya))}create(){this.$b(Object(fa.a)(this.$.da,513,()=>{Type.registerNamespace("Common.App.PenMinutesManager");Hc.main();const Ya=za.a.instance.resolve("Common.App.PenMinutesManager.IPenMinutesManager");Ya.BPj();return Ya}))}}Object(e.a)(td,"PenMinutesFactory",hb.a,[]);var me=a(118);class ve{static A1h(Ya){try{return caches.open(ve.Wbe).then(Qb=>Qb.match(Ya))}catch(Qb){return Promise.reject(null)}}static Xxa(Ya,
Qb){try{return ve.A1h(Ya).then(Ec=>Ec&&Number.parseInvariant(Ec.headers.get("cachedTime"))>Date.now()-Qb?Promise.resolve(Ec.text().toLocaleString()):Promise.reject("Not found")).catch(()=>Promise.reject("Cache returned undefined"))}catch(Ec){return Promise.reject(null)}}static store(Ya,Qb){try{return caches.open(ve.Wbe).then(Ec=>{Ec.put(Ya,Qb).then(()=>!0);return!1}).catch(()=>Promise.resolve(!1))}catch(Ec){return Promise.resolve(!0)}}static f3j(Ya,Qb){const Ec={};Ec.body=Qb;const id={};id.cachedTime=
Date.now().toString();Ec.headers=id;Qb=new Response(Qb,Ec);ve.store(Ya,Qb).then(()=>!0)}}ve.Wbe="ConsentState";Object(e.a)(ve,"CacheManager",null,[]);class Qe{constructor(){this.message=null;this.gza=0}}Object(e.a)(Qe,"HttpRequstToPromiseRejectData",null,[]);var Ze=a(70),nf=a(355);class Cb{constructor(Ya){this.JZ=Ya}DX(Ya,Qb,Ec,id,Bd,Id){Eb.a.sendTelemetryEvent(Object.assign(new nf.a,{name:"Office.Online."+Ya,dataFields:[Object.assign(new Ze.a,{name:"EventMessage",string:Qb}),Object.assign(new Ze.a,
{name:"FormFactor",string:this.JZ.formFactor}),Object.assign(new Ze.a,{name:"CorrelationId",string:this.JZ.correlationId}),Object.assign(new Ze.a,{name:"AccountType",string:this.JZ.accountType}),Object.assign(new Ze.a,{name:"OSVersion",string:this.JZ.osVersion}),Object.assign(new Ze.a,{name:"AppId",string:this.JZ.appId}),Object.assign(new Ze.a,{name:"ConsentSurface",string:"AppStart"}),Object.assign(new Ze.a,{name:"ConsentLanguage",string:this.JZ.consentLanguage}),Object.assign(new Ze.a,{name:"EventCode",
string:Ec}),Object.assign(new Ze.a,{name:"Region",string:this.JZ.region}),Object.assign(new Ze.a,{name:"ModelType",string:id}),Object.assign(new Ze.a,{name:"ModelId",string:Bd}),Object.assign(new Ze.a,{name:"Platform",string:this.JZ.os}),Object.assign(new Ze.a,{name:"ReConsentReason",string:""}),Object.assign(new Ze.a,{name:"ConsentType",string:Id})]}))}}Object(e.a)(Cb,"TelemetryLogger",null,[]);var ac=a(251);class qc{constructor(Ya,Qb,Ec){this.lFg="https://consent.config.office.com/consentcheckin/v1.0/consents";
this.Ra=Ya;this.Ah=Qb;this.Bua=Ec;this.YQ=new Cb(Ec)}Awb(Ya,Qb){return new Promise((Ec,id)=>{const Bd=this.Ra.Ae("UCNoticeCheckinCallTimeoutMs",5E3);let Id=this.Ra.Va("UCNoticeCheckinStateUrl");Id&&Id.length||(Id=this.lFg);this.Ah.tba(Id,1,null,this.xnd(Ya),null,!1,0,ee=>{try{if(void 0===ee||null===ee||void 0===ee.data||null===ee.data||void 0===ee.data.Pe||null===ee.data.Pe){this.YQ.DX("UnifiedConsent.ConsentGetFailed","CheckInApi : Invalid response","711",null,null,null);let La=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",
"UnifiedConsent.ConsentGetFailed");id(this.e7(La,ee))}else if(ee.data.httpStatus!==ac.a.xK){this.YQ.DX("UnifiedConsent.ConsentGetFailed","CheckInApi : HTTP failure",ee.data.httpStatus.toString(),null,null,null);let La=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",ee.data.httpStatus,"UnifiedConsent.ConsentGetFailed");id(this.e7(La,ee))}else{var Fe=Qb(ee.data.Pe);if(Fe)Ec(Fe);
else{this.YQ.DX("UnifiedConsent.ConsentGetFailed","CheckInApi : Consent values are empty","712",null,null,null);let La=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}","UnifiedConsent.ConsentGetFailed");id(this.e7(La,ee))}}}catch(La){this.YQ.DX("UnifiedConsent.ConsentGetFailed","CheckInApi : Unexpected failure","713",null,null,null),Fe=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",
La,"UnifiedConsent.ConsentGetFailed"),id(this.e7(Fe,ee))}},ee=>{this.YQ.DX("UnifiedConsent.ConsentGetFailed","CheckInApi : Error in service call ",ee.data.httpStatus.toString(),null,null,null);const Fe=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, request - {1}",ee.data.httpStatus,"UnifiedConsent.ConsentGetFailed");id(this.e7(Fe,ee))},null,void 0,void 0,2500,Bd)})}e7(Ya,Qb){const Ec=new Qe;Ec.message=Ya;Ec.gza=Qb&&Qb.data?Qb.data.httpStatus:
-1;return Ec}xnd(Ya){const Qb={};Qb["Accept-Language"]=this.Bua.consentLanguage;Qb.consentsurface="AppStart";Qb.platform="Web";Qb.formfactor=Ea.a.f1?"Mobile":"Desktop";Qb["x-Cid"]=this.Bua.correlationId;Qb.Authorization="Bearer "+Ya;return Qb}}Object(e.a)(qc,"HttpRequestToPromiseUtility",null,[]);class Oc{constructor(){this.accountType="MSA";this.modelType=null;this.appEnv=0;this.emailId=this.deviceId=this.consentLanguage=this.appVersion=this.appId=this.appName=null;this.formFactor="Unknown";this.token=
this.region=this.osVersion=this.os=null;this.useCache=!1;this.correlationId=this.userId=null;this.isDarkMode=!1}}Object(e.a)(Oc,"WebSdkAdapterProps",null,[]);var xd=a(173);class Md{constructor(Ya,Qb,Ec,id){this.rhe=this.Nha=this.q4=this.EZ=null;this.CYa=id;this.Ra=Ya;this.MDg=Ec;this.Ah=Qb;this.Bua=this.getDimensions();this.YQ=new Cb(this.Bua)}oig(){"MSA"===(this.Ra.Va("HostAuthType")||"").toUpperCase()&&ve.Xxa(this.Bua.userId,this.Ra.Ae("UCNoticeCheckinCacheTimeMs",862E5)).then(()=>{this.YQ.DX(Md.nHa,
"CacheFound","701",this.EZ,this.q4,this.Nha);return{}}).catch(()=>{this.MDg.execute(Ya=>{Ya.kD("Consent",Md.uPg).then(Qb=>{Qb.IsSuccess?(this.YQ.DX(Md.nHa,"CheckInTokenSuccess","702",this.EZ,this.q4,this.Nha),this.f3h(Qb.Token).then(Ec=>{this.i$h(Ec);this.EZ&&""!==this.EZ&&Ya.kD("Consent",Md.wPg).then(id=>{id.IsSuccess?(this.YQ.DX(Md.nHa,"WebTokenSuccess","703",this.EZ,this.q4,this.Nha),this.PYj(id,this.EZ)):this.YQ.DX(Md.nHa,"WebTokenFailed : "+id.ErrorMessage,id.ErrorCode,this.EZ,this.q4,this.Nha);
return{}});return{}})):this.YQ.DX(Md.nHa,"CheckInTokenFailed : "+Qb.ErrorMessage,Qb.ErrorCode,this.EZ,this.q4,this.Nha);return{}})})})}f3h(Ya){this.rhe=new qc(this.Ra,this.Ah,this.Bua);return this.rhe.Awb(Ya,Object(D.a)(this,this.bhj,"parseConsentCheckinState")).then(Qb=>Promise.resolve(Qb),Qb=>Promise.reject("Error while getting result"+Qb))}bhj(Ya){if(void 0===Ya||null===Ya)return this.YQ.DX(Md.nHa,"Checkin response undefined or null","705",this.EZ,this.q4,this.Nha),null;try{let Qb;({Bt:Qb}=aa.d(Ya));
return Qb}catch(Qb){this.YQ.DX(Md.nHa,"Checkin response parse error : "+Qb.message,"706",this.EZ,this.q4,this.Nha)}return null}i$h(Ya){for(const Qb of Ya.consentValues)if(Qb.needConsent&&!Qb.maxPromptsReached){this.q4=Qb.id;this.Nha=Qb.consentType;this.EZ=Qb.modelType;return}ve.f3j(this.Bua.userId,aa.c(Ya))}PYj(Ya,Qb){if(B.a("showConsentNotice")){const Ec=document.createElement("div");document.body.appendChild(Ec);appChrome.api.showConsentNotice(this.K4h(Ya.Token,Qb),Ec)}else this.YQ.DX(Md.nKg,"1JS : ShowConsentNotice API not found",
"704",this.EZ,this.q4,this.Nha)}K4h(Ya,Qb){const Ec=this.Bua;Ec.token=Ya;Ec.modelType=Qb;return Ec}getDimensions(){const Ya=this.gud(this.Ra.Va("SessionStartInfoJson"));return Object.assign(new Oc,{emailId:this.Ra.Va("UserPrincipalName"),userId:this.Ra.Va("LoggableUserId"),accountType:"AAD"===(this.Ra.Va("HostAuthType")||"").toUpperCase()?"AAD":"MSA",appId:this.Ra.Va("OfficeApplicationId"),appVersion:this.Ra.Va("appVersion"),appName:"Application"in Ya?Ya.Application:"",appEnv:this.CYa,consentLanguage:this.Ra.Va("UICulture")||
"en-US",formFactor:Ea.a.f1?"Mobile":"Desktop",os:"Os"in Ya?Ya.Os:"",osVersion:"OsVersion"in Ya?Ya.OsVersion:"",region:this.Ra.Va("region"),correlationId:xd.a.create().toString(),isDarkMode:this.Ra.ra("DarkModeIsOn"),useCache:!0})}gud(Ya){let Qb={};try{Qb=aa.b(Ya)}catch(Ec){}return Qb}}Md.wPg="https://consentservice.microsoft.com/web";Md.uPg="https://consentservice.microsoft.com/checkin";Md.nKg="UnifiedConsent.ConsentGetFailed";Md.nHa="UnifiedConsent.AuthTokenStatus";Object(e.a)(Md,"ConsentNoticeManager",
null,[642]);class je{constructor(){this.Nb=null}get name(){return"Common.App.ConsentNoticeDialog"}Oi(Ya){this.Nb=Ya;Ya.register(Md,"Common.App.ConsentNoticeDialog.ConsentNoticeManager").as("Common.App.ConsentNoticeDialog.IConsentNoticeManager").gd().od(()=>new Md(d.AFrameworkApplication.fa,d.AFrameworkApplication.qe,Ya.Dc("Common.App.OAuth.IOAuthManager"),d.AFrameworkApplication.zMa))}init(){this.Nb.resolve("Common.App.ConsentNoticeDialog.IConsentNoticeManager")}dispose(){}static main(){V.a.instance.wj(new je)}}
Object(e.a)(je,"ConsentNoticeDialogPackage",null,[4,5]);let oe=class{constructor(){Type.registerNamespace("Common.App.ConsentNoticeDialog");je.main();za.a.instance.Dc("Common.App.ConsentNoticeDialog.IConsentNoticeManager").execute(Ya=>Ya.oig())}};oe=Object(me.b)([Object(Ud.d)(Hd.Hb)],oe);Object(e.a)(oe,"UnifiedConsentAdapter",null,[]);var Ge=a(128);let Ce=class{constructor(Ya){this.shortcutKeyManager=Ya.shortcutKeyManager;this.isMac=Ea.a.isMac}mOj(){const Ya=this.Khh.concat(this.LWi).map(Qb=>appChrome.actions.setControlCustomTooltip(Qb.commandId,
this.Vic(Qb)));appChrome.api.dispatch(Ya)}ukb(Ya,Qb){this.Fbk&&(this.wN[0].title=this.wN[2].title=this.M7d(Ya),this.wN[1].title=this.wug(Qb),this.wN[1].shortcut=this.isMac?this.shortcutKeyManager.Dm(192):this.shortcutKeyManager.Dm(154));Ya=this.Vic(this.wN[1]);Qb=this.Vic(this.wN[2]);Ya=[appChrome.actions.setControlCustomTooltip(this.wN[0].commandId,this.Vic(this.wN[0])),appChrome.actions.setControlCustomTooltip(this.wN[1].commandId,Ya),appChrome.actions.setControlCustomTooltip(this.wN[2].commandId,
Qb)];appChrome.api.dispatch(Ya)}pQi(Ya,Qb){this.iIi(Ya)&&Ge.b(Qb)}iIi(Ya){return-1502853784===Ya||-111689794===Ya||-287251124===Ya||-1925065947===Ya||1764140053===Ya||-1590502662===Ya||-600086683===Ya||963349338===Ya||862890474===Ya||1220954656===Ya||1891435765===Ya||1896159024===Ya||-1554384558===Ya||-1985798686===Ya||-911352779===Ya||237279923===Ya||996232352===Ya?!0:!1}get LWi(){this.iI||(this.iI=[],this.iI.push(this.Cj("Paste_MLR",Ub.a.instance.Ha(513),Ub.a.instance.Ha(767),this.shortcutKeyManager.Dm(176))),
this.iI.push(this.Cj("Cut",Ub.a.instance.Ha(511),Ub.a.instance.Ha(768),this.shortcutKeyManager.Dm(172))),this.iI.push(this.Cj("Copy",Ub.a.instance.Ha(512),Ub.a.instance.Ha(769),this.shortcutKeyManager.Dm(174))),this.iI.push(this.Cj("AlignTop_MLR",Ub.a.instance.Ha(791),Ub.a.instance.Ha(792))),this.iI.push(this.Cj("AlignMiddle_MLR",Ub.a.instance.Ha(793),Ub.a.instance.Ha(794))),this.iI.push(this.Cj("AlignBottom_MLR",Ub.a.instance.Ha(795),Ub.a.instance.Ha(796))),this.iI.push(this.Cj("AlignLeft_MLR",Ub.a.instance.Ha(797),
Ub.a.instance.Ha(799))),this.iI.push(this.Cj("AlignCenter_MLR",Ub.a.instance.Ha(800),Ub.a.instance.Ha(801))),this.iI.push(this.Cj("AlignRight_MLR",Ub.a.instance.Ha(802),Ub.a.instance.Ha(803))),this.iI.push(this.Cj("IncreaseIndent",Ub.a.instance.Ha(804),Ub.a.instance.Ha(805))),this.iI.push(this.Cj("DecreaseIndent",Ub.a.instance.Ha(806),Ub.a.instance.Ha(807))),this.iI.push(this.Cj("Wrap",Ub.a.instance.Ha(808),Ub.a.instance.Ha(809))),this.iI.push(this.Cj("Merge",Ub.a.instance.Ha(810),Ub.a.instance.Ha(811))),
this.iI.push(this.Cj("NumberFormatPercentage_MLR",Ub.a.instance.ha(453),Ub.a.instance.Ha(814),this.shortcutKeyManager.Dm(404))),this.iI.push(this.Cj("NumberFormatComma_MLR",Ub.a.instance.Ha(815),Ub.a.instance.Ha(816))));return this.iI}get Khh(){this.lp||(this.lp=[],this.lp.push(this.Cj("UndoRedo",Ub.a.instance.Ha(83),"",this.isMac?this.shortcutKeyManager.Dm(191):this.shortcutKeyManager.Dm(153))),this.lp.push(this.Cj("FormatPainter",Ub.a.instance.ha(14),Ub.a.instance.Ha(770))),this.lp.push(this.Cj("FontName_New",
Ub.a.instance.Ha(771),Ub.a.instance.Ha(772))),this.lp.push(this.Cj("FontSize",Ub.a.instance.Ha(773),Ub.a.instance.Ha(774))),this.lp.push(this.Cj("Bold",Ub.a.instance.ha(1333),Ub.a.instance.Ha(775),this.isMac?this.shortcutKeyManager.Dm(180):this.shortcutKeyManager.Dm(179))),this.lp.push(this.Cj("Italic",Ub.a.instance.ha(1334),Ub.a.instance.Ha(776),this.isMac?this.shortcutKeyManager.Dm(184):this.shortcutKeyManager.Dm(183))),this.lp.push(this.Cj("BordersSplitButtonCompactMenu",Ub.a.instance.Ha(777),
Ub.a.instance.Ha(779),this.isMac?this.shortcutKeyManager.Dm(190):this.shortcutKeyManager.Dm(189))),this.lp.push(this.Cj("FillColor",Ub.a.instance.ha(537),Ub.a.instance.Ha(780))),this.lp.push(this.Cj("FontColor",Ub.a.instance.Ha(781),Ub.a.instance.Ha(782))),this.lp.push(this.Cj("GrowFontSize",Ub.a.instance.Ha(783),Ub.a.instance.Ha(784),this.shortcutKeyManager.Dm(187))),this.lp.push(this.Cj("ShrinkFontSize",Ub.a.instance.Ha(785),Ub.a.instance.Ha(786),this.shortcutKeyManager.Dm(188))),this.lp.push(this.Cj("Underline",
Ub.a.instance.ha(1335),Ub.a.instance.Ha(787),this.isMac?this.shortcutKeyManager.Dm(182):this.shortcutKeyManager.Dm(181))),this.lp.push(this.Cj("Strikethrough",Ub.a.instance.ha(1336),Ub.a.instance.Ha(788),this.isMac?this.shortcutKeyManager.Dm(186):this.shortcutKeyManager.Dm(185))),this.lp.push(this.Cj("DoubleUnderline",Ub.a.instance.Ha(789),Ub.a.instance.Ha(790))),this.lp.push(this.Cj("NumberFormatNew",Ub.a.instance.Ha(812),Ub.a.instance.Ha(813))),this.lp.push(this.Cj("NumberFormatAccountingNew",Ub.a.instance.ha(449),
Ub.a.instance.Ha(817))),this.lp.push(this.Cj("IncreaseDecimal",Ub.a.instance.Ha(818),Ub.a.instance.Ha(819))),this.lp.push(this.Cj("DecreaseDecimal",Ub.a.instance.Ha(820),Ub.a.instance.Ha(821))),this.lp.push(this.Cj("ConditionalFormatting",Ub.a.instance.Ha(822),Ub.a.instance.Ha(823))),this.lp.push(this.Cj("CellStylesGallery",Ub.a.instance.Ha(824),Ub.a.instance.Ha(825))),this.lp.push(this.Cj("FormatAsTableAlt",Ub.a.instance.Ha(826),Ub.a.instance.Ha(827))),this.lp.push(this.Cj("Format",Ub.a.instance.Ha(828),
Ub.a.instance.Ha(829))),this.lp.push(this.Cj("AutoSum",Ub.a.instance.Ha(830),Ub.a.instance.Ha(831),this.shortcutKeyManager.Dm(259))),this.lp.push(this.Cj("SortAndFilter",Ub.a.instance.Ha(832),Ub.a.instance.Ha(833))),this.lp.push(this.Cj("FindAndSelect",Ub.a.instance.Ha(834),Ub.a.instance.Ha(835),this.shortcutKeyManager.Dm(85))),this.lp.push(this.Cj("AnalyzeData",Ub.a.instance.Ha(836),Ub.a.instance.Ha(837))),this.lp.push(this.Cj("Sensitivity",Ub.a.instance.Ha(838),Ub.a.instance.Ha(839))),this.lp.push(this.Cj("InsertCells",
Ub.a.instance.ha(345),Ub.a.instance.Ha(840),this.shortcutKeyManager.Dm(409))),this.lp.push(this.Cj("DeleteCells",Ub.a.instance.ha(409),Ub.a.instance.Ha(841),this.shortcutKeyManager.Dm(407))),this.lp.push(this.Cj("ClearCells",Ub.a.instance.Ha(842),Ub.a.instance.Ha(843))));return this.lp}get Fbk(){this.wN||(this.wN=[],this.wN.push(this.Cj("Undo",this.M7d(2),Ub.a.instance.Ha(765),this.isMac?this.shortcutKeyManager.Dm(191):this.shortcutKeyManager.Dm(153))),this.wN.push(this.Cj("Redo",this.wug(2),Ub.a.instance.Ha(766),
this.isMac?this.shortcutKeyManager.Dm(192):this.shortcutKeyManager.Dm(154))),this.wN.push(this.Cj("UndoRedo",this.M7d(2),"",this.isMac?this.shortcutKeyManager.Dm(191):this.shortcutKeyManager.Dm(153))));return this.wN}Cj(Ya,Qb,Ec,id){return{commandId:Ya,title:Qb,description:Ec,shortcut:id,Eoi:id?!0:!1}}Vic(Ya){let Qb;Qb=Ya.title;Ya.Eoi&&(Qb+=" "+Ya.shortcut);"UndoRedo"!==Ya.commandId&&(Qb+="\n\n"+Ya.description);return Qb}M7d(Ya){switch(Ya){case 1:case 0:return Ya=Ub.a.instance.Ha(81);case 3:return Ya=
Ub.a.instance.Ha(84);case 2:return Ya=Ub.a.instance.Ha(83);case 4:return Ya=Ub.a.instance.Ha(82);default:return Ya=Ub.a.instance.Ha(81)}}wug(Ya){switch(Ya){case 1:case 0:return Ya=Ub.a.instance.Ha(78);case 2:return Ya=Ub.a.instance.Ha(80);case 4:return Ya=Ub.a.instance.Ha(79);default:return Ya=Ub.a.instance.Ha(78)}}};Ce=Object(me.b)([Object(Ud.d)(Hd.G),Object(me.c)(0,Object(Hd.E)())],Ce);Object(e.a)(Ce,"ExtendedTooltipsManager",null,[]);Type.registerNamespace("Common.App.InProductMessaging");oa.main();
Type.registerNamespace("Common.App.FirstRunExperienceLauncher");xa.main();(()=>{wa.a.Fa(()=>{wa.a.Fa(ta.la)})})();(()=>{wa.a.Fa(()=>{wa.a.Fa(Ma.la)})})();wa.a.Fa(bc.la);wa.a.Fa(de.la);(()=>{wa.a.Fa(Ya=>{td.la(Ya)})})();Object(qe.a)();Object(fe.a)();(()=>{wa.a.Fa(Ya=>{Ke.a.la(Ya);Te.a.la(Ya)})})();(()=>{wa.a.Fa(Ya=>{df.a.la(Ya);Se.a.la(Ya)})})();(()=>{wa.a.Fa(Ya=>{te.a.la(Ya)})})();(()=>{Ja.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingServicesMigration",!1)||wa.a.Fa(Ya=>{gf.a.la(Ya)})})();
Object(Y.a)();Object(Ta.a)();(()=>{wa.a.Fa(Ya=>{Bb.a.la(Ya)})})();(()=>{wa.a.Fa(Ya=>{Rb.a.la(Ya)})})();Object(jc.a)();Object(vc.a)();Object(bb.a)();Object(Mb.a)();Object(hc.a)();Object(Cc.a)();Object(Wb.a)();Object(mc.a)();Object(Mc.a)();Object(pd.a)();Object(hd.a)();Object(Nd.a)();Object(Xd.a)();Object(ae.a)();Object(Ve.a)();Object(we.a)();Object(Mf.a)();Object(Ye.a)();kf.a.main();Object(Bf.a)();Object(vf.a)();Object(Rf.a)();String(c);String(b);window.___1684780685188_closurehack=c;window.___1684780685188_closurehack=
b},737:function(r,C,a){a.d(C,"a",function(){return M});r=a(0);var c=a(2),b=a(15),e=a(92),f=a(232),d=a(14),h=a(113),l=a(187),k=a(6),u=a(90);C=a(249);var v=a(1095),x=a(20),w=a(7),m=a(334),t=a(54),z=a(13),y=a(76),D=a(16),H=a(19),F=a(95),G=a(948),L=a(1);class M extends C.a{constructor(O,B){super(document.createElement("div"));this.Ryf=this.BAe=this.Sue=this.k9b=this.Mea=this.eaa=this.CQ=this.qA=null;this.Tya=this.UW=this.Rs=this.hideCloseButton=!1;this.N2i=E=>{this.XE(E)};this.T2i=E=>{13===E.keyCode&&
this.XE(E)};this.tId=E=>{this.Ym(E.kc);return!0};this.zId=E=>{this.HX(E.kc);return!0};this.bvc=E=>{this.$oa(E.kc?E.kc:0);return!0};this.O2i=E=>{this.XE(E.Da);return!0};this.RAg=(E=null)=>{this.Ym(E.inputMethod?E.inputMethod:0);return!0};this.SAg=(E=null)=>{this.HX(E.inputMethod?E.inputMethod:0);return!0};this.R3=O;this.Nu=B;this.y5c=B.h3a.toString();this.title=B.title;this.message=B.message;this.set_visibilityMode(1)}get N9g(){return this.Nu.h3a}get businessBar(){return this.R3}get actionButton(){return this.Nu?
this.Nu.actionButton:""}get EJa(){return this.Nu?this.Nu.EJa:""}get linkText(){return this.Nu?this.Nu.link:""}get Dl(){return this.Nu?this.Nu.Dl:""}get alt(){return this.Nu?this.Nu.alt:""}sqa(O){this.Nu.businessBarType=O}dispose(){e.a.ed([this.k9b,this.CQ,this.eaa]);this.Rs&&this.CQ&&(f.a.instance.Aa(d.a.click,this.CQ.domElement,this.tId),h.KeyInputManager.instance.By(this.domElement,this.Sue));this.UW&&this.eaa&&(f.a.instance.Aa(d.a.click,this.eaa.domElement,this.zId),h.KeyInputManager.instance.By(this.domElement,
this.BAe));this.Tya&&this.Mea&&(f.a.instance.Aa(d.a.click,this.Mea,this.bvc),h.KeyInputManager.instance.By(this.domElement,this.Ryf));this.Mea=this.qA=this.R3=this.eaa=this.CQ=null;super.dispose()}update(){}Gdk(){this.jQe(!0)}SOe(){this.jQe(!1)}arh(){const O=this.businessBar.$.yc.vh("DOMUpdate","ReactBusinessBar");O.start();this.message=F.a.Yf(this.message);this.title=F.a.Yf(this.title);l.UISurfaces.cod().then(B=>{B.initializeMessageBarInStore();let E=Object(c.a)(new G.a,{messageTitle:this.title,
message:this.message,isMultiline:!1,messageBarType:this.Nu.businessBarType,dismissButtonAriaLabel:D.a.instance.ha(10)});this.hideCloseButton||(E.onDismiss=this.O2i);this.Tya&&(E.linkProps={["type"]:"AppLinkProps",["text"]:this.linkText,["onExecute"]:this.bvc});this.Rs&&(E.firstActionButtonProps={["type"]:"AppButtonProps",["label"]:this.actionButton,["onExecute"]:this.RAg});this.UW&&(E.secondActionButtonProps={["type"]:"AppButtonProps",["label"]:this.EJa,["onExecute"]:this.SAg});L.EwaSettings.isChangeGateEnabled("OfficeVSO:7445369_IconFunctionalityReactBizBars")&&
this.Nu.iconName&&(E.messageBarIconProps={["iconName"]:this.Nu.iconName});L.EwaSettings.isChangeGateEnabled("OfficeVSO:7476511_BizBarCallbackTelemetry")?B.createNewMessageBarWithCallback(this.domElement,E,()=>{O.stop();b.ULS.sendTraceTag(509657951,0,50,`React Business Bar created for ${this.Nu.yMa} in: ${O.vd} milliSeconds.`)}):B.createNewMessageBar(this.domElement,E);return null},()=>{b.ULS.sendTraceTag(524075914,0,10,`React BusinessBar for ${this.Nu.yMa} could not be initialized`);return null});
if(k.AFrameworkApplication.fa.ra("Fluent2StyleIsEnabled"))this.domElement.classList.add("VNextBusinessBarEntry"),this.domElement.classList.add("WACBusinessBarEntry");else{let B="1px solid ";switch(this.Nu.businessBarType){case 1:case 2:case 3:B+="#F1707B";break;case 4:B+="#92C353";break;case 5:B+="#FCE100";break;case 0:B+="#C8C6C4";break;default:B+="#C8C6C4"}this.domElement.style.border=B}this.domElement.classList.add("ReactBusinessBarEntry");L.EwaSettings.isChangeGateEnabled("OfficeVSO:7627987_BizBarA11yFocusFix")||
(this.domElement.tabIndex=0);this.businessBar.domElement.appendChild(this.domElement)}iqh(O){O||(this.domElement.tabIndex=0,this.businessBar.domElement.appendChild(this.domElement));var B=this.businessBar.$.qc;O=B+"ewaBusinessBarEntryBody"+this.y5c;const E=B+"ewaBusinessBarEntryTitle"+this.y5c;var I=B+"ewaBusinessBarEntryIcon"+this.y5c;this.domElement.className=v.a.EFh;z.DOMElementExtensions.ZD(this.domElement);B=document.createElement("div");B.className=v.a.FFh;B.id=O;var S=document.createElement("div");
S.className=v.a.DFh;var J=document.createElement("a");J.className=v.a.LFh;J.title=this.alt;var K=document.createElement("span");K.classList.add(x.a.i9b);K.classList.add(v.a.HFh);K.id=I;this.Dl.length&&(I=document.createElement("img"),I.classList.add(this.Dl),I.src=t.a.yg(0),K.appendChild(I));J.appendChild(K);S.appendChild(J);J=document.createElement("span");J.classList.add(v.a.KFh);J.id=E;J.innerText=F.a.Yf(this.title);S.appendChild(J);J=document.createElement("span");J.classList.add(v.a.JFh);J.id=
"message";J.innerText=F.a.Yf(this.message);S.appendChild(J);J=document.createElement("a");J.id="link";J.href="#";J.className=v.a.IFh;J.innerText=F.a.Yf(this.linkText);S.appendChild(J);J=document.createElement("span");J.classList.add(v.a.YYe);K=document.createElement("button");K.type="button";K.id="action";K.className=v.a.XYe;K.innerText=F.a.Yf(this.actionButton);J.appendChild(K);S.appendChild(J);J=document.createElement("span");J.classList.add(v.a.YYe);K=document.createElement("button");K.type="button";
K.id="altAction";K.className=v.a.XYe;K.innerText=F.a.Yf(this.EJa);J.appendChild(K);S.appendChild(J);B.appendChild(S);S=document.createElement("a");S.className=v.a.GFh;S.tabIndex=0;S.setAttribute("role","button");J=document.createElement("span");J.id="close";J.classList.add(x.a.aE);K=document.createElement("img");K.classList.add(x.a.ihd);K.src=t.a.yg(13);K.alt=D.a.instance.ha(793);K.title=D.a.instance.ha(793);K.setAttribute("role","button");J.appendChild(K);S.appendChild(J);B.appendChild(S);this.domElement.appendChild(B);
z.DOMElementExtensions.xy(this.domElement,w.a.Lja,E,O);this.Mea=$get("link",this.domElement);z.DOMElementExtensions.setVisible(this.Mea,this.Tya);this.Tya&&(f.a.instance.ta(d.a.click,this.Mea,this.bvc),this.Ryf=h.KeyInputManager.instance.ev(this.Mea,this.bvc,u.a.Li,u.a.YY));this.CQ=new m.a(z.DOMElementExtensions.getElementById(this.domElement,"action"));this.CQ.isVisible=this.Rs;this.eaa=new m.a(z.DOMElementExtensions.getElementById(this.domElement,"altAction"));this.eaa.isVisible=this.UW;this.Rs&&
(f.a.instance.ta(d.a.click,this.CQ.domElement,this.tId),this.Sue=h.KeyInputManager.instance.ev(this.CQ.domElement,this.tId,u.a.Li,u.a.YY),this.UW&&(f.a.instance.ta(d.a.click,this.eaa.domElement,this.zId),this.BAe=h.KeyInputManager.instance.ev(this.CQ.domElement,this.zId,u.a.Li,u.a.YY)));this.qA=$get("close",this.domElement);this.k9b=this.kf.Re(this.qA);this.k9b.la("click",this.N2i);this.k9b.la("keydown",this.T2i);z.DOMElementExtensions.setVisible(this.qA,!this.hideCloseButton)}jQe(O){L.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",
!1)?this.arh():this.iqh(O)}Ym(){b.ULS.sendTraceTag(21517968,0,50,`BusinessBar [${this.Nu.hash}]: BusinessBarEntry.OnActionClick() for EntryName ${this.Nu.yMa}`);H.h(this.businessBar.$).Up(!0)}HX(){b.ULS.sendTraceTag(537170257,0,50,`BusinessBar [${this.Nu.hash}]: BusinessBarEntry.OnAltActionClick() for EntryName ${this.Nu.yMa}`);H.h(this.businessBar.$).Up(!0)}$oa(){b.ULS.sendTraceTag(537170256,0,50,`BusinessBar [${this.Nu.hash}]: BusinessBarEntry.OnLinkClick() for EntryName ${this.Nu.yMa}`);H.h(this.businessBar.$).Up(!0)}XE(O){b.ULS.sendTraceTag(21517971,
0,50,`BusinessBar [${this.Nu.hash}]: BusinessBarEntry.OnCloseClick() for EntryName ${this.Nu.yMa}`);this.set_visible(!1);this.businessBar.removeEntry(this.N9g);y.g(O)}HL(){return L.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?this.domElement.getElementsByTagName("button")[0]:this.CQ.domElement}}Object(r.a)(M,"BusinessBarEntry",C.a,[])},795:function(r,C,a){a.r(C);var c=a(0),b=a(15),e=a(92),f=a(235),d=a(6),h=a(32),l=a(831),k=a(142),u=a(84),v=a(42),x=a(20),w=a(7),m=
a(177),t=a(1298),z=a(1282),y=a(173),D=a(569),H=a(357),F=a(59);const G=(Ga,Za,Sb,sb,bc,kc=null)=>{kc=Ga.Pa(1,kc);return F.g(Ga,"GetRichDataClassificationLabels",kc,Za,Sb,sb,bc,4)},L=(Ga,Za,Sb,sb,bc,kc,vb,ub,Ub=null)=>{Ub=Ga.Pa(1,Ub);Ub.selectedRanges=Za;Ub.domainId=Sb;Ub.autodetect=sb;return F.g(Ga,"ConvertToLinkedEntity",Ub,bc,kc,vb,ub,4)},M=(Ga,Za,Sb,sb,bc,kc=null)=>{kc=Ga.Pa(1,kc);return F.g(Ga,"OnAutoDetectUIShown",kc,Za,Sb,sb,bc,4)},O=(Ga,Za,Sb,sb,bc,kc=null)=>{kc=Ga.Pa(1,kc);return F.g(Ga,"GetLinkedEntityMetadata",
kc,Za,Sb,sb,bc,4)},B=(Ga,Za,Sb,sb,bc,kc,vb=null)=>{vb=Ga.Pa(1,vb);vb.selectedRanges=Za;return F.g(Ga,"ConvertLinkedEntityToText",vb,Sb,sb,bc,kc,4)},E=(Ga,Za,Sb,sb,bc,kc,vb=null)=>{vb=Ga.Pa(1,vb);vb.selectedRanges=Za;return F.g(Ga,"RefreshLinkedEntitiesInRange",vb,Sb,sb,bc,kc,4)},I=(Ga,Za,Sb,sb,bc,kc,vb,ub,Ub,Rd,Cd=null)=>{Cd=Ga.Pa(1,Cd);Cd.selectedRanges=Za;Cd.isChangeObject=Sb;Cd.isFloodgateEnabled=sb;Cd.isStarterData=bc;Cd.starterDataDomainId=kc;return F.g(Ga,"GetDataSelectorPaneData",Cd,vb,ub,
Ub,Rd,4)},S=(Ga,Za,Sb,sb,bc,kc,vb,ub=null)=>{ub=Ga.Pa(9,ub);ub.activeCell=Za;ub.selectionIndex=Sb;return F.g(Ga,"SelectLinkedEntityForDisambiguation",ub,sb,bc,kc,vb,4)},J=(Ga,Za,Sb,sb,bc,kc,vb,ub,Ub,Rd,Cd,Yc=null)=>{Yc=Ga.Pa(1,Yc);Yc.searchCell=Za;Yc.searchQuery=Sb;Yc.isFloodgateEnabled=sb;Yc.isStarterData=bc;Yc.starterDataDomainId=kc;Yc.starterDataDomainIdString=vb;return F.g(Ga,"LinkedEntitySearch",Yc,ub,Ub,Rd,Cd,4)},K=(Ga,Za,Sb,sb,bc,kc,vb,ub,Ub=null)=>{Ub=Ga.Pa(1,Ub);Ub.cell=Za;Ub.starterDataDomainId=
Sb;Ub.starterDataDomainIdString=sb;return F.g(Ga,"InsertStarterDataTable",Ub,bc,kc,vb,ub,4)},R=(Ga,Za,Sb,sb,bc,kc,vb,ub=null)=>{ub=Ga.Pa(1,ub);ub.activeCell=Za;ub.isBackward=Sb;return F.g(Ga,"MoveToNextAmbiguousLinkedEntity",ub,sb,bc,kc,vb,4)},Z=(Ga,Za,Sb,sb,bc,kc,vb=null)=>{vb=Ga.Pa(9,vb);vb.activeCell=Za;return F.g(Ga,"CancelSearchLinkedEntity",vb,Sb,sb,bc,kc,4)},P=(Ga,Za,Sb,sb,bc,kc,vb,ub=null)=>{ub=Ga.Pa(1,ub);ub.selectedRanges=Za;ub.letyDomainId=Sb;return F.g(Ga,"GetDataTypeSelectorData",ub,
sb,bc,kc,vb,4)},V=(Ga,Za,Sb,sb,bc,kc=null)=>{kc=Ga.Pa(1,kc);return F.g(Ga,"GetErrorMessageForLinkedDataTypeRefresh",kc,Za,Sb,sb,bc,4)},Ea=(Ga,Za,Sb,sb,bc,kc=null)=>{kc=Ga.Pa(1,kc);return F.g(Ga,"GetHasUntrustedImageUrls",kc,Za,Sb,sb,bc,4)},oa=(Ga,Za,Sb,sb,bc,kc=null)=>{kc=Ga.Pa(1,kc);return F.g(Ga,"LinkedEntitiesEnableUntrustedImages",kc,Za,Sb,sb,bc,0)},ea=(Ga,Za,Sb,sb,bc,kc=null)=>{kc=Ga.Pa(1,kc);return F.g(Ga,"LinkedEntityTryAutoRefresh",kc,Za,Sb,sb,bc,0)};var aa=a(88),ia=a(734),ya=a(828);class za{}
za.Sqi="EnrichmentContentFrame";za.width=320;Object(c.a)(za,"EnrichmentConstants",null,[]);class la{constructor(Ga){this.messageType=0;this.messageType=Ga}}Object(c.a)(la,"EnrichmentResponseMessage",null,[]);class xa extends la{constructor(Ga,Za){super(Ga);this.messageContent=null;this.messageContent=Za}}Object(c.a)(xa,"EnrichmentResponseMessageWithContent",la,[]);class wa extends xa{constructor(Ga,Za,Sb){super(Ga,Za);this.telemetryJson=null;this.telemetryJson=Sb}}Object(c.a)(wa,"EnrichmentResponseMessageWithContentAndTelemetryData",
xa,[]);var hb=a(274),Ja=a(14),Fa=a(102),Ba=a(49),fa=a(90),ta=a(113),Oa=a(43),Ma=a(64),fb=a(31),pa=a(111),Ua=a(725),Sa=a(27);class Ia{constructor(Ga,Za,Sb,sb,bc){this.hs=this.jl=this.Lhe=this.Jhe=this.wx=this.rw=null;this.Iy=!1;this.yj=Ga;this.Te=Za;this.MQ=Sb;this.Nc=sb;this.Na=bc;this.Ysa=ta.KeyInputManager.Fm(fa.a.Tra,0)}get ORb(){return!0}get wyb(){return d.AFrameworkApplication.fa.Va("EnrichmentPaneUrl")}dispose(){this.ORb&&this.hs&&(this.yj.Aa(Ja.a.click,this.hs,Object(aa.a)(this,this.lm,"onClosePaneClick")),
this.Te.Aa(Ja.a.De,this.hs,Object(aa.a)(this,this.TNf,"onKeyHide")));this.hs=null;this.wx&&(this.ock(),this.wx.parentNode.removeChild(this.wx),this.wx=null);this.Nc.rj("EnrichmentPaneId").ul(this.Ysa)}show(Ga,Za,Sb){this.rw=Ga;this.Iy||(this.jl=this.G4a(),this.aqa.appendChild(this.jl),this.vuj(),this.Na.Hc(Sa.a.TKe,pa.a.frame,Object(aa.a)(this,this.fli,"handleEscapeKeyAction")),this.NVa(),this.Iy=!0);this.wx.src=this.wyb&&this.wyb.length?this.wyb+"?culture="+Za.market+"&appName="+Za.applicationName+
"&themeId="+Za.themeId+"&featuresBitMask="+Za.featuresBitMask:Ia.eHf;this.Jhe=Za;this.Lhe=Sb;this.mib()}IJc(Ga,Za){Ga=new wa(2,Ga,Za);this.Bxc(Ga)}NVa(){const Ga=this.Nc.rj("EnrichmentPaneId");Ga.parent=hb.AFrame.KRa;this.yj.Urb("EnrichmentPaneId",this.jl);Ga.bindAction(this.Ysa,Sa.a.TKe)}Gdg(){if(this.wx){Fa.FocusManager.Bra(this.wx.contentWindow);const Ga=new wa(4,null,null);this.Bxc(Ga)}}lm(){this.m9b();return!0}TNf(Ga){Ga=Ga.Da.keyCode;return Ga===Sys.UI.Key.enter||Ga===Sys.UI.Key.space?(this.m9b(),
!0):!1}m9b(){this.hide();if(this.rw)this.rw.onPaneClosed()}G4a(){const Ga=ia.a("div","EnrichmentPaneId","EnrichmentPane");this.ORb&&Ga.appendChild(this.fbd());this.Jui(Ga);return Ga}fbd(){const Ga=ia.b("div","EnrichmentPaneHeaderId","EnrichmentPaneHeader"),Za=ia.b("div","EnrichmentPaneTitleId","cui-taskPaneTitle EnrichmentPaneTitle");Za.innerText=CommonUIStrings.l_EnrichmentPaneTitle;Za.title=CommonUIStrings.l_EnrichmentPaneTitle;const Sb=ya.a.Vb("CloseEnrichmentPane","EnrichmentPaneCloseButton",
CommonUIStrings.l_Close,"ClosePaneGlyph_16x16x32",!1);this.yj.ta(Ja.a.click,Sb,Object(aa.a)(this,this.lm,"onClosePaneClick"));this.Te.ta(Ja.a.De,Sb,Object(aa.a)(this,this.TNf,"onKeyHide"));Ga.appendChild(Za);Ga.appendChild(Sb);this.hs=Sb;return Ga}Jui(Ga){this.wx=ia.b("iframe","","EnrichmentFrame");Ga.appendChild(this.wx);this.wx.id=za.Sqi;this.wx.setAttribute("role","presentation")}vuj(){Ba.a.addHandler(this.wx,"load",Object(aa.a)(this,this.wNf,"onIFrameLoad"));Ba.a.addHandler(this.wx,"error",Object(aa.a)(this,
this.Ruc,"onIFrameError"));$addHandler(window,"message",Object(aa.a)(this,this.xNf,"onIFrameMessage"))}ock(){Ba.a.removeHandler(this.wx,"load",Object(aa.a)(this,this.wNf,"onIFrameLoad"));Ba.a.removeHandler(this.wx,"error",Object(aa.a)(this,this.Ruc,"onIFrameError"));$removeHandler(window,"message",Object(aa.a)(this,this.xNf,"onIFrameMessage"))}Guh(){this.wx.src=Ia.eHf}hide(){this.Ekc();this.Guh()}fli(Ga,Za,Sb){if(1!==Sb&&(this.hide(),this.rw))this.rw.onPaneClosed();return 32}wNf(){}Ruc(){}xNf(Ga){Ga=
Ga.rawEvent;if(!this.wx||-1!==this.wx.src.indexOf(Ga.origin)){try{var Za=Oa.a(Ga.data)}catch(Sb){return}if(!Ua.c(Za.messageType)){Ga=window.g_badCastCallback;window.g_badCastCallback=null;switch(Za.messageType){case 2:this.Bxc(new wa(1,Oa.c(this.Jhe),this.Lhe));break;case 1:this.Bxc(new xa(0,this.N_h()));break;case 3:this.rw&&this.rw.selectEntity(Za.messageContent);break;case 5:this.rw&&this.rw.pJb(Za.messageContent);break;case 8:this.rw&&(Za=Oa.a(Za.messageContent),0<Za.DomainId?this.rw.pWd(Za.Query,
Za.TelemetryJson,Za.DomainId,Za.DomainIdString):this.rw.searchEntity(Za.Query,Za.TelemetryJson));break;case 6:this.rw&&this.rw.cancelSearch();break;case 11:Za=Oa.a(Za.messageContent);Za=Ia.dac("keydown","f6",fa.a.lWb,!0,!1,Za,!0,!1);this.wx&&this.wx.dispatchEvent(Za);break;case 12:if(Oa.a(Za.messageContent).keyCode===fa.a.NH&&(Za=Ia.dac("keydown","esc",fa.a.NH,!0,!1,!1,!1,!1),this.wx&&(this.wx.dispatchEvent(Za),this.hide(),this.rw)))this.rw.onPaneClosed();break;case 13:this.rw&&this.rw.selectDataType(Za.messageContent);
break;case 14:this.rw&&this.rw.showHelpArticle(Za.messageContent);break;case 15:this.rw&&this.rw.showSurveyDialog(Za.messageContent);break;case 16:this.rw&&(Za=Oa.a(Za.messageContent),this.rw.insertTable(Za.DomainId,Za.DomainIdString))}window.g_badCastCallback=Ga}}}N_h(){return Oa.c([2,1,3,5,8,6])}Bxc(Ga){Ga=Oa.c(Ga);this.wx.contentWindow.postMessage(Ga,Ma.a.ML(this.wyb))}static dac(Ga,Za,Sb,sb,bc,kc,vb,ub){fb.a.Dz?(kc=String.format("{0} {1} {2}",kc?"Shift":"",vb?"Control":"",ub?"Alt":""),kc.trim(),
Sb=document.createEvent("KeyboardEvent"),Sb.initKeyboardEvent(Ga,sb,bc,window.self,Za,0,kc,!1,"en-US")):(Za={},Za.keyCode=Sb,Za.ctrlKey=vb,Za.shiftKey=kc,Za.altKey=ub,Za.bubbles=sb,Za.cancelable=bc,Sb=new KeyboardEvent(Ga,Za));return Sb}}Ia.eHf="about:blank";Object(c.a)(Ia,"EnrichmentPane",null,[476,2]);class X extends Ia{constructor(Ga){super(d.AFrameworkApplication.sa.Xz,d.AFrameworkApplication.sa.jv,d.AFrameworkApplication.sa.fha,d.AFrameworkApplication.sa.Hf,d.AFrameworkApplication.dc);this.taskPane=
Ga;this.taskPane.rYg(this.Gdg)}get aqa(){return this.taskPane.Wc}mib(){this.taskPane.isVisible||this.taskPane.Oh(!0)}Ekc(){this.taskPane.Oh(!1)}dispose(){this.taskPane&&(this.taskPane.qzj(this.Gdg),this.taskPane=null);super.dispose()}}Object(c.a)(X,"EnrichmentTaskPaneWrapper",Ia,[]);class ca{constructor(Ga){this.fA=null;this.$ha=Ga}FMi(Ga,Za){this.fA=Ga;this.$ha&&this.$ha.show(this,Za,null)}IJc(Ga,Za){this.$ha&&this.$ha.IJc(Ga,Za)}eDb(){this.$ha&&this.$ha.hide()}dispose(){this.$ha&&(this.$ha.dispose(),
this.$ha=null)}selectEntity(Ga){return this.fA?this.fA.selectEntity(Ga):!1}searchEntity(Ga,Za){this.fA&&this.fA.searchEntity(Ga,Za)}pWd(Ga,Za,Sb,sb){this.fA&&this.fA.pWd(Ga,Za,Sb,sb)}pJb(Ga){return this.fA?this.fA.pJb(Ga):!1}onPaneClosed(){if(this.fA)this.fA.onPaneClosed()}cancelSearch(){this.fA&&this.fA.cancelSearch()}selectDataType(Ga){this.fA&&this.fA.selectDataType(Ga)}showHelpArticle(Ga){this.fA&&this.fA.showHelpArticle(Ga)}showSurveyDialog(Ga){this.fA&&this.fA.showSurveyDialog(Ga)}insertTable(Ga,
Za){this.fA&&this.fA.insertTable(Ga,Za)}}Object(c.a)(ca,"EnrichmentManager",null,[473,2]);class U extends ca{constructor(Ga){super(Ga)}dispose(){super.dispose()}}Object(c.a)(U,"ExcelEnrichmentManager",ca,[]);var ma=a(16);class ra{constructor(Ga){this.campaignId=this.commentQuestion=null;this.isZeroBased=!1;this.ratingValuesAscending=this.ratingQuestion=this.aditionalDataRequested=null;this.showPrompt=this.showEmailRequest=!1;this.surveyType=0;this.title=null;this.campaignId=Ga;this.commentQuestion=
ma.a.instance.Xb(199);this.isZeroBased=!1;this.aditionalDataRequested=["EmailAddress"];this.ratingQuestion=ma.a.instance.Xb(195);this.ratingValuesAscending=[ma.a.instance.Xb(196),ma.a.instance.Xb(197),ma.a.instance.Xb(198)];this.showPrompt=!1;this.showEmailRequest=!0;this.surveyType=4;this.title=ma.a.instance.Xb(194)}}Object(c.a)(ra,"FloodgateSurvey",null,[]);var Va=a(25),ob=a(75),ja=a(430),lb=a(47),wb=a(382),Ab=a(201),nb=a(30),pb=a(91),cb=a(34),Da=a(248),zb=a(19);class qb{constructor(){this.market=
this.appCorrelationId=this.sessionId=this.anid=this.applicationVersion=this.applicationName=null;this.featuresBitMask=this.themeId=0;this.disambiguationJson=this.uiLanguage=null}}Object(c.a)(qb,"EnrichmentMessageContentAppProperties",null,[]);class Pa{constructor(Ga,Za,Sb,sb,bc){this.Nwa=this.pUe=!1;this.dhb=this.kea=!0;this.OLb=this.XRb=!1;this.xib=null;this.Lwc=0;this.hy=()=>{(this.dhb||this.Nwa)&&2!==this.Lwc&&(this.OLb||this.ZBd(!1))};this.Md=()=>{b.ULS.sendTraceTag(537166944,0,15,"Session ID changed while ambiguous linked entities are present")};
this.A3i=kc=>{cb.a.ng(kc.Errors)?(kc=cb.a.Uc(kc.Errors),kc.includes("OperationSucceededWithAlert")?b.ULS.sendTraceTag(537166942,0,50,"Convert to Linked Entity failed with an alert"):b.ULS.sendTraceTag(36975687,0,10,`Failed to Convert to Linked Entity. errors: ${kc}`)):kc.Result&&(this.$.ea.Vk(this.Md),this.$.ea.Mk(this.Md),kc=kc.Result,this.xib=kc.SkydanceFeatureBitmask,this.oGd(kc),this.XRb=!0)};this.Uf=()=>{(this.dhb||this.Nwa)&&this.ZBd(!1)};this.Juc=(kc,vb)=>{cb.a.ng(kc.Errors)?b.ULS.sendTraceTag(36975688,
0,10,`Failed to retrieve disambiguation data for Ambiguous Linked Entity. errors: ${cb.a.Uc(kc.Errors)}`):kc.Result&&(kc=kc.Result,kc.DisambiguationJson?(this.XRb=!1,this.Deg(vb),this.xib=kc.SkydanceFeatureBitmask,vb=kc.DisambiguationJson,b.ULS.sendTraceTag(537166940,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Calling LaunchOrUpdateDisambiguationPane"),this.OLb=!1,this.vyf(vb)):b.ULS.sendTraceTag(537166941,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Json is null"))};
this.l6i=(kc,vb)=>{cb.a.ng(kc.Errors)?(vb=cb.a.Uc(kc.Errors),b.ULS.sendTraceTag(36975689,0,10,`Failed to retrieve disambiguation data for search. errors: ${vb}`)):kc.Result&&(kc=kc.Result,kc.DisambiguationJson?(this.Deg(vb),this.xib=kc.SkydanceFeatureBitmask,vb=kc.DisambiguationJson,b.ULS.sendTraceTag(537166938,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Calling LaunchOrUpdateDisambiguationPane"),this.OLb=!0,this.vyf(vb)):b.ULS.sendTraceTag(537166939,0,
10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Json is null"))};this.O9i=kc=>{cb.a.ng(kc.Errors)?(kc=cb.a.Uc(kc.Errors),b.ULS.sendTraceTag(36975690,0,10,`Failed to move to the next ambiguous Linked Entity. errors: ${kc}`),this.dhb=!0):kc.Result&&(kc=kc.Result,this.xib=kc.SkydanceFeatureBitmask,this.oGd(kc),this.XRb=!0)};this.Nbj=kc=>{if(cb.a.ng(kc.Errors)){const vb=cb.a.Uc(kc.Errors);b.ULS.sendTraceTag(36975691,0,10,`Failed to select Linked Entity for Disambiguation.. errors: ${vb}`)}kc.Result?
(this.oGd(kc.Result),this.XRb=!0):this.Tva()};this.iRf=kc=>{cb.a.ng(kc.Errors)?(kc=cb.a.Uc(kc.Errors),b.ULS.sendTraceTag(36975692,0,15,`Failed to retrieve data for searching in Disambiguation Pane.  Error id names: ${kc}`)):kc.Result?this.wdc.IJc(kc.Result,null):(b.ULS.sendTraceTag(537166927,0,50,"ConvertToLinkedEntityDisambiguationPane:OnSearchLinkedEntitySucceeded: Calling CloseDisambiguationPane"),this.Tva())};this.t8i=kc=>{cb.a.ng(kc.Errors)?(kc=cb.a.Uc(kc.Errors),b.ULS.sendTraceTag(537166926,
0,15,`Failed to insert starter data table. Error id names: ${kc}`)):this.Tva()};this.$=Ga;this.gridView=zb.h(this.$);this.gridView.ga.ND(this.Uf);this.gridView.ut(this.hy);this.oYe=sb;this.convertToLinkedEntityManager=bc;nb.a.de()||Sb.wS(Za);Ga=new X(Za);this.wdc=new U(Ga);u.a.instance.Dc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(kc=>{kc.isFeatureEnabled("mso_sendASmile",!0).then(vb=>{this.kea=vb;return null})})}dispose(){this.$&&(this.gridView.ga.aD(this.Uf),this.gridView.$v(this.hy))}selectEntity(Ga){const Za=
lb.o(this.gridView.ga.pa.activeCell,this.$),Sb=()=>new ja.a;wb.a(this.$.userOperationManager,(sb,bc,kc)=>S(this.$.qa.va,Za,Ga,Da.b(sb,this.Nbj),bc,kc,null),sb=>new Ab.a(109,0,sb,void 0,Sb),null);return!0}searchEntity(Ga,Za,Sb=!1,sb=0,bc=null){b.ULS.sendTraceTag(38846755,0,50,`ConvertToLinkedEntityManager:SearchEntity() - Search attempted with TelemetryJSON: ${Za}`);const kc=lb.o(this.gridView.ga.pa.activeCell,this.$);wb.a(this.$.userOperationManager,(vb,ub,Ub)=>J(this.$.qa.va,kc,Ga,this.kea,Sb,sb,
bc,Da.b(vb,this.iRf),ub,Ub,null),vb=>new Ab.a(110,0,vb,16),null)}pJb(Ga){const Za=lb.o(this.gridView.ga.pa.activeCell,this.$);this.dhb=!1;wb.a(this.$.userOperationManager,(Sb,sb,bc)=>R(this.$.qa.va,Za,Ga,Da.b(Sb,this.O9i),sb,bc,null),Sb=>new Ab.a(111,0,Sb,16),null);return!0}onPaneClosed(){this.Nwa=!1;this.pUe=!0;this.Lwc=0;this.OLb=!1}cancelSearch(){const Ga=this.JWd();Ga&&wb.a(this.$.userOperationManager,(Za,Sb,sb)=>Z(this.$.qa.va,Ga,Da.b(Za,this.iRf),Sb,sb,null),Za=>new Ab.a(112,0,Za,16),null)}selectDataType(Ga){b.ULS.sendTraceTag(537166977,
0,50,"ConvertToLinkedEntityDisambiguationPane:SelectDataType: Calling CloseDisambiguationPane");this.Tva();if(Ga&&Ga.length)if(Ga=JSON.parse(Ga))if(null==Ga.domainId)b.ULS.sendTraceTag(537166946,0,10,"Data Selector Pane invoked SelectDataType without passing a DomainId");else{var Za={};Za.Id=Ga.domainId;Za.StringId=Ga.stringId;this.convertToLinkedEntityManager.convertToLinkedEntity(Za)}else b.ULS.sendTraceTag(537166947,0,10,"Failed to parse the dataTypeJson from the Data Type Selector Pane");else b.ULS.sendTraceTag(537166976,
0,10,"Recevied an empty dataTypeJson payload from the Data Type Selector Pane")}showHelpArticle(Ga){const Za=new pb.a(-859308420,ob.a.fc,this.$.Tc,9,null);this.$.Ia.mc(Za,{[ob.a.Og]:"HelpID="+Ga,["InputMethod"]:ob.a.fc,["ShouldCanvasTakeFocus"]:!0,[ob.a.Gd]:w.a.rS})}showSurveyDialog(Ga){z.a.sib(new ra(Ga))}insertTable(Ga,Za){const Sb=this.JWd();Sb&&wb.a(this.$.userOperationManager,(sb,bc,kc)=>K(this.$.qa.va,Sb,Ga,Za,Da.b(sb,this.t8i),bc,kc,null),sb=>new Ab.a(259,0,sb,1),null)}ZBd(Ga){this.launchOrCloseDisambiguationPane(Ga)}launchDisambiguationPaneForSearch(){b.ULS.sendTraceTag(36975685,
0,50,"ConvertToLinkedEntityManager:LaunchDisambiguationPaneForSearch() - Launch Disambiguation Pane For Search attempted");const Ga=this.rJj();Ga&&wb.a(this.$.userOperationManager,(Za,Sb,sb)=>I(this.$.qa.va,Ga,!0,this.kea,!1,null,Da.b(Za,this.l6i),Sb,sb,1),Za=>new Ab.a(114,0,Za,16),null)}launchLinkedEntityDataTypeSelectorPane(Ga,Za){wb.a(this.$.userOperationManager,(Sb,sb,bc)=>P(this.$.qa.va,Ga,Za,Da.b(Sb,this.Juc),sb,bc,2),Sb=>new Ab.a(233,0,Sb,16),null)}zMi(Ga,Za){Ga&&wb.a(this.$.userOperationManager,
(Sb,sb,bc)=>I(this.$.qa.va,Ga,!1,!1,!0,Za,Da.b(Sb,this.Juc),sb,bc,2),Sb=>new Ab.a(257,0,Sb,16),null)}Deg(Ga){Ga&&(this.Lwc=Ga)}vyf(Ga){var Za=new pb.a(-90814711,ob.a.fc,0,10,null);this.$.Ia.mc(Za,null);this.Nwa?this.wdc.IJc(Ga,null):(Za=3,null!=this.xib?Za=this.xib:b.ULS.shipAssertTag(537166937,0,!1,"SkydanceFeatureBitmask was not set"),(Ga=this.z5h(Ga,Za))||b.ULS.sendTraceTag(537166936,0,15,"LaunchOrUpdateDisambiguationPane: null appProperties"),this.oYe||b.ULS.sendTraceTag(537166935,0,15,"LaunchOrUpdateDisambiguationPane: null entitymanager"),
this.wdc.FMi(this.oYe,Ga),this.Nwa=!0)}Tva(){this.Nwa&&(b.ULS.sendTraceTag(537166934,0,100,"ConvertToLinkedEntityDisambiguationPane:CloseDisambiguationPane"),this.wdc.eDb(),this.Nwa=!1,this.Lwc=0,this.OLb=!1)}oGd(Ga){var Za=Ga.Row+1;Ga=Ga.Column+1;0>Za||0>Ga?(b.ULS.sendTraceTag(537166933,0,50,"ConvertToLinkedEntityDisambiguationPane:MoveToAmbiguousLinkedEntity: Calling CloseDisambiguationPane"),this.Tva(),this.$.ea.Vk(this.Md)):(Za=new Va.Range(Za,Ga,Za,Ga,!0,!1),this.gridView.ga.updateSelection(Za,
Za,60),this.dhb=!0)}z5h(Ga,Za){const Sb=new qb;Sb.applicationVersion=d.AFrameworkApplication.buildVersion;Sb.applicationName="ExcelWac";Sb.anid="00000000-0000-0000-0000-000000000000";Sb.sessionId=d.AFrameworkApplication.userSessionId;Sb.appCorrelationId=y.a.create().toString();var sb=D.a.KL(d.AFrameworkApplication.lcid);sb=sb?sb.name:null;Sb.uiLanguage=sb;Sb.market=this.hhc(sb);Sb.themeId=0;Sb.disambiguationJson=Ga;Za<=H.a.E3?Sb.featuresBitMask=Za:b.ULS.sendTraceTag(537166932,0,10,"SkydanceFeaturesBitmask is too large for EnrichmentMessageContentAppProperties");
return Sb}hhc(Ga){Ga=Ga.split("-");return Ga[Ga.length-1]}launchOrCloseDisambiguationPane(Ga){const Za=this.gridView.ga.pa.activeCell;if(this.JWd()&&Za)if(this.gridView.Wb.nEb(Za)){if((!this.pUe||Ga||this.XRb)&&!this.gridView.Ob){Ga&&(this.dhb=!0);var Sb=lb.q(Za,this.$);wb.a(this.$.userOperationManager,(sb,bc,kc)=>I(this.$.qa.va,Sb,!1,this.kea,!1,null,Da.b(sb,this.Juc),bc,kc,1),sb=>new Ab.a(114,0,sb,16),null)}}else this.Tva();else this.Tva()}jtj(){if(this.Nwa){var Ga=this.gridView.ga.pa.activeCell;
if(Ga){var Za=lb.q(Ga,this.$);wb.a(this.$.userOperationManager,(Sb,sb,bc)=>I(this.$.qa.va,Za,!1,this.kea,!1,null,Da.b(Sb,this.Juc),sb,bc,1),Sb=>new Ab.a(114,0,Sb,16),null)}else this.Tva()}}JWd(){const Ga=this.gridView.ga.pa;return Ga.tea()?lb.o(Ga.activeCell,this.$):null}rJj(){const Ga=this.gridView.ga.pa;return Ga.tea()?lb.q(Ga.activeCell,this.$):null}}Object(c.a)(Pa,"ConvertToLinkedEntityDisambiguationPane",null,[2]);var Nb=a(2),Tb=a(385),Vb=a(1370),Jb=a(54),Qa=a(739);class Db{constructor(Ga,Za,
Sb){this.Vyf=2;this.Uyf="Size64by48";this.$=Ga;this.Ya=Za;this.convertToLinkedEntityManager=Sb}GYh(Ga,Za){var {ConvertToLinkedEntityManager:Sb}=a(795);this.Uek();Za=this.Ya.Er(Za).$F();let sb=0,bc=0,kc=!1;for(var vb of Ga.Categories){const ub=this.mZh(vb,sb);ub&&(bc===Sb.Abb&&(kc=!0),Za.MenuSectionList.push(ub),++sb);++bc}kc&&sb<=Sb.Wyf&&Za.MenuSectionList.splice(Sb.Abb,1);Sb=this.Ya.zd().o7b();vb=Jb.a.yg(11);for(const ub of Ga.LongButtons)this.convertToLinkedEntityManager.oWj(ub)&&this.SUg(Sb,ub,
vb);0<Sb.ControlList.length&&Za.MenuSectionList.push(Sb);return Za}SUg(Ga,Za,Sb){if(Za){var sb="Data.ConvertToLinkedEntityMenuItem_"+Za.Name,bc=this.convertToLinkedEntityManager.aW(Za.DomainId);bc&&(Za=Object(Nb.a)(new Tb.a,{Id:sb,ExternalId:sb,Command:"-1662108744",LabelText:Za.Name,Alt:Za.SuperTip,Visible:!0,MenuItemId:a(795).ConvertToLinkedEntityManager.L5a(Za.DomainId),Image16by16:Sb,Image16by16Class:this.xri(bc.FontLocator)}),Ga.ControlList.push(Za))}}hZh(Ga,Za){return Object(Nb.a)(new Vb.a,
{Id:a(795).ConvertToLinkedEntityManager.fWe+Ga.toString(),ExternalId:a(795).ConvertToLinkedEntityManager.fWe+Ga.toString(),MenuItemId:a(795).ConvertToLinkedEntityManager.Ued+Ga.toString(),Command:"-1203788282",QueryCommand:"QueryLinkedEntityGalleryButtons",Icon:this.Clf(Za.FontLocator),LabelText:Za.Name,PreviewIconStyle:{["root"]:{["width"]:24,["min-width"]:24,["height"]:24}},Alt:this.omd(Za)})}u4g(Ga){switch(Ga){case "Animal":return Qa.a.H0g;case "Apple":return Qa.a.O1g;case "Atom":return Qa.a.n3g;
case "Beaker":return Qa.a.k5g;case "Bridge":return Qa.a.L6g;case "Cat":return Qa.a.Ubh;case "City":return Qa.a.leh;case "Constellation":return Qa.a.kjh;case "Dog":return Qa.a.uAh;case "Finance":return Qa.a.c5g;case "GradCap":return Qa.a.Hji;case "HumanAnatomy":return Qa.a.Pqi;case "LocationPointer":return Qa.a.lPi;case "Map":return Qa.a.pfj;case "MedicineNeedle":return Qa.a.PVi;case "Mountain":return Qa.a.gXi;case "Movie":return Qa.a.zXi;case "Music":return Qa.a.LXi;case "OuterSpace":return Qa.a.Ufj;
case "Planet":return Qa.a.gjj;case "Satellite":return Qa.a.IGj;case "WolframGeneric":return Qa.a.BFj;default:return Qa.a.Ykh}}xri(Ga){if("PowerBIRibbon"!==Ga)return x.a.hhd;switch(Ga){case "AnimalRibbon":return x.a.YLh;case "AppleRibbon":return x.a.ZLh;case "AtomRibbon":return x.a.$Lh;case "BeakerRibbon":return x.a.aMh;case "BridgeRibbon":return x.a.bMh;case "CenterMapRibbon":return x.a.cMh;case "CityRibbon":return x.a.dMh;case "CurrencyRibbon":return x.a.eMh;case "ExerciseRibbon":return x.a.fMh;
case "FinanceRibbon":return x.a.b1e;case "FirstAidRibbon":return x.a.gMh;case "GlobeLightningRibbon":return x.a.hMh;case "GradCapRibbon":return x.a.iMh;case "HumanAnatomyRibbon":return x.a.jMh;case "LeafRibbon":return x.a.kMh;case "LocationPointerRibbon":return x.a.mMh;case "MapRibbon":return x.a.$0e;case "MountainRibbon":return x.a.nMh;case "MovieRibbon":return x.a.oMh;case "MusicRibbon":return x.a.pMh;case "NotablePeopleRibbon":return x.a.qMh;case "OuterSpaceRibbon":return x.a.rMh;case "PartlySunnyWeatherRibbon":return x.a.sMh;
case "PowerBIRibbon":return x.a.a1e;case "SatelliteRibbon":return x.a.tMh;case "WolframGenericRibbon":return x.a.lMh;case "YogaRibbon":return x.a.vMh;default:return x.a.Z0e}}Clf(Ga){switch(Ga){case "AnimalRibbon":return"AnimalExcelDataTypes_24";case "AppleRibbon":return"AppleExcelDataTypes_24";case "AtomRibbon":return"AtomExcelDataTypes_24";case "BeakerRibbon":return"BeakerExcelDataTypes_24";case "BridgeRibbon":return"BridgeExcelDataTypes_24";case "CenterMapRibbon":return"CenterMapExcelDataTypes_24";
case "CityRibbon":return"CityExcelDataTypes_24";case "CurrencyRibbon":return"CurrencyExcelDataTypes_24";case "ExerciseRibbon":return"ExerciseExcelDataTypes_24";case "FinanceRibbon":return"Bank_32";case "FirstAidRibbon":return"FirstAidExcelDataTypes_24";case "GlobeLightningRibbon":return"GlobeLightning_24";case "GradCapRibbon":return"GradCapExcelDataTypes_24";case "HumanAnatomyRibbon":return"HumanAnatomyExcelDataTypes_24";case "LeafRibbon":return"LeafExcelDataTypes_24";case "LocationPointerRibbon":return"LocationPointerExcelDataTypes_24";
case "MapRibbon":return"OpenMap_24";case "MountainRibbon":return"MountainExcelDataTypes_24";case "MovieRibbon":return"MovieExcelDataTypes_24";case "MusicRibbon":return"MusicExcelDataTypes_24";case "NotablePeopleRibbon":return"NotablePeopleExcelDataTypes_24";case "OuterSpaceRibbon":return"OuterSpaceExcelDataTypes_24";case "PartlySunnyWeatherRibbon":return"PartlySunnyWeatherExcelDataTypes_24";case "PowerBIRibbon":return"DataProtectionExcelDataTypes_24";case "SatelliteRibbon":return"SatelliteExcelDataTypes_24";
case "WolframGenericRibbon":return"Lightning_24";case "YogaRibbon":return"YogaExcelDataTypes_24";default:return"ConvertToEntity_20"}}mZh(Ga,Za){Za=this.Ya.jE("ConvertToLinkedEntitySection_"+Za,this.Vyf,this.Uyf);var Sb=!1;for(var sb of Ga.DomainIds){const bc=this.convertToLinkedEntityManager.aW(sb);if(!bc||bc.DomainBlocked||!bc.ShowInRibbon)continue;Sb=bc.Name;const kc=a(795).ConvertToLinkedEntityManager.L5a(sb);Za.wu("Data.ConvertToLinkedEntityMenuItem_"+kc,-1203788282,"QueryLinkedEntityGalleryIcon",
void 0,kc,this.Clf(bc.FontLocator),void 0,void 0,this.omd(bc),Sb);Sb=!0}if(!Sb)return null;sb=Za.n7b(!0);Za=this.Ya.zd();Za.title=Ga.Name;Ga=Za.o7b();Ga.ControlList.push(sb);return Ga}Uek(){this.Vyf=5;this.Uyf="Size112by64"}omd(Ga){return Ga.RibbonTooltipHeader?Ga.RibbonTooltipHeader+"\n\n"+Ga.RibbonTooltip:Ga.RibbonTooltip}}Object(c.a)(Db,"ConvertToLinkedEntityMenuRenderer",null,[455]);var sa=a(62),Ha=a(323),mb=a(119),qa=a(1),Xa=a(128),Ca=a(70);class va{constructor(Ga,Za){this.Vrd=this.Xrd=!1;this.taj=
Sb=>{b.ULS.sendTraceTag(537166680,0,50,"OnReadRoamingStringSuccess called.");this.Xrd=!0;if(cb.a.ng(Sb.Errors))b.ULS.sendTraceTag(537166679,0,10,`OnReadRoamingStringSuccess encountered an error. Errors: ${cb.a.Uc(Sb.Errors)}`);else{var sb=0,bc=[],kc=!1;try{if(!Sb.Result)return;const vb=Sb.Result;if(!vb){b.ULS.sendTraceTag(537166678,0,50,"OnReadRoamingStringSuccess - Received an empty roamingXml.");return}bc=this.ohj(vb);if(!bc||!bc.length)return;sb=bc.length;this.dWi(bc);this.iDa.O7f();b.ULS.sendTraceTag(537166677,
0,50,`OnReadRoamingStringSuccess MruCount:${this.iDa.Bfb.length}`);if(qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5199912_LinkedEntityMruWolfram")){for(const ub of this.iDa.Bfb)if(1===(ub.Id&1048320)>>8){kc=!0;break}b.ULS.sendTraceTag(537166676,0,50,`OnReadRoamingStringSuccess MruWolframAvailable:${kc}`)}}finally{b.ULS.sendTraceTag(537166675,0,50,`ParseRecentlyUsedLinkedDataTypes returned ${sb} data types.`),Sb=[],Sb.push(Object(Nb.a)(new Ca.a,{name:"MruCount",int64:sb})),Sb.push(Object(Nb.a)(new Ca.a,
{name:"MruWolframAvailable",bool:kc})),Xa.a("ReadRecentlyUsedLinkedDataTypes",void 0,void 0,Sb)}this.Vrd&&(this.byg(this.iDa.Bfb),this.Vrd=!1)}};this.Lej=Sb=>{b.ULS.sendTraceTag(537166674,0,50,"OnWriteRoamingStringSuccess called.");cb.a.ng(Sb.Errors)?b.ULS.sendTraceTag(537166673,0,10,`OnWriteRoamingStringSuccess encountered an error. Errors: ${cb.a.Uc(Sb.Errors)}`):Sb.Result&&(Sb.Result||b.ULS.sendTraceTag(537166672,0,15,"OnWriteRoamingStringSuccess - Failed to write to the roaming service."))};this.NQf=
(Sb,sb,bc)=>{Sb=mb.a.vf(Sb.data);b.ULS.sendTraceTag(537166671,0,10,`OnRoamingOperationFailure: Encountered errors for ${bc}. Errors: ${cb.a.Uc(Sb)}.`)};this.$=Ga;this.iDa=Za}Vci(){!this.Xrd&&this.$.ea.Oc&&(b.ULS.sendTraceTag(537166691,0,50,"GetRecentlyUsedLinkedDataTypesFromRoamingService - Invoking the GetRecentlyUsedDataTypes operation."),Ha.x(this.$.qa.va,0,this.taj,this.NQf,null,null))}byg(Ga){Ga&&Ga.length?this.Xrd?(Ga=this.eLj(Ga))?(b.ULS.sendTraceTag(537166688,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Invoking the WriteRecentlyUsedDataTypes operation."),
Ha.D(this.$.qa.va,0,Ga,this.Lej,this.NQf,null,null)):b.ULS.sendTraceTag(537166689,0,15,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Created an empty serialized string."):this.Vrd=!0:b.ULS.sendTraceTag(537166690,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Tried writing an empty list of data types.")}eLj(Ga){if(!Ga||!Ga.length)return b.ULS.sendTraceTag(537166687,0,15,"SerializeRecentlyUsedLinkedDataTypes - Received an empty list of data types."),null;var Za=[];for(const Sb of Ga)Ga=
{},Ga.Id=Sb.Id,Sb.StringId&&(Ga.StringId=Sb.StringId),Za.push(Ga);Za="<DataTypes>"+sa.a.nd(Za)+"</DataTypes>";return 1906<Za.length?(b.ULS.sendTraceTag(537166686,0,15,"SerializeRecentlyUsedLinkedDataTypes - Exceeded the MaxSize for ridExcelRecentlyUsedLinkedDataTypes."),null):Za}ohj(Ga){if(!Ga)return b.ULS.sendTraceTag(537166685,0,15,"ParseRecentlyUsedLinkedDataTypes - Received an empty roamingXml."),null;if(!Ga.startsWith("<DataTypes>")||!Ga.endsWith("</DataTypes>"))return b.ULS.sendTraceTag(537166684,
0,15,"ParseRecentlyUsedLinkedDataTypes - Received a string without a prefix/postfix."),null;Ga=Ga.substring(11,Ga.length-12);if(!Ga)return b.ULS.sendTraceTag(537166683,0,15,"ParseRecentlyUsedLinkedDataTypes - Created an empty substring."),null;let Za=[];try{Za=sa.a.ij(Ga)}catch(Sb){return b.ULS.sendTraceTag(537166682,0,10,`ParseRecentlyUsedLinkedDataTypes - Encountered an exception. Message: ${Sb.message}`),null}b.ULS.sendTraceTag(537166681,0,50,`ParseRecentlyUsedLinkedDataTypes returned ${Za.length} data types.`);
return Za}dWi(Ga){const Za=this.iDa.Bfb,Sb=this.iDa.gsj;if(Za.length!==Sb){for(let sb=0;sb<Ga.length&&Za.length<Sb;++sb){const bc=Ga[sb];this.iDa.aW(bc)&&!Za.includes(bc)&&Za.push(bc)}this.iDa.Bfb=Za}}}Object(c.a)(va,"LinkedDataTypeRoamingHandler",null,[]);var na=a(58),Ka=a(52),ib=a(151),Ra=a(40),ka=a(51),da=a(33),kb=a(231),Ob=a(23),lc=a(106),tc=a(72),Pb=a(100),tb=a(149),gc=a(35);a.d(C,"ConvertToLinkedEntityManager",function(){return Xb});class Xb extends v.a{constructor(Ga,Za,Sb,sb,bc,kc,vb){super();
this.avf=this.Lzd=this.HAd=this.yyd=this.xyd=this.aab=this.Avd=null;this.UJb=this.yrd=0;this.loa=null;this.Nvd=!1;this.Bkd=this.So=this.rVd=null;this.Qt=0;this.o_=null;this.HOa=8;this.o7c=this.Tyf=this.Xqf=this.Qdb=!1;this.eCa=this.y7e=this.b4e=null;this.w5c=0;this.E4g=5;this.F6b=3E4;this.Ypg=!1;this.Vba=null;this.Ywa=Array(5);this.Hsg=this.I6d=!1;this.l9f=this.yCd=0;this.Bc=this.Kle=null;this.Kjg=!0;this.Md=(ub,Ub)=>{Ub.Oc&&!Ub.rGb&&this.showUntrustedImageBusinessBarIfNecessary()};this.l7i=ub=>{if(ub.Result){var Ub=
ub.Result;if(Ub&&Ub.length){b.ULS.sendTraceTag(537166922,0,50,`OnGetRichDataClassificationLabelsSuccess: Received ${Ub.length} labels`);var Rd=Ka.GetServiceTaskFactory.Za(this.$.da,274,275,0);Ra.TaskExtensions.za(Rd,()=>{Rd.result.j5c(Ub,2)||b.ULS.sendTraceTag(537166921,0,10,"OnGetRichDataClassificationLabelsSuccess - Failed to apply the policy label.")},this.$.ka,3)}}else b.ULS.sendTraceTag(537166923,0,50,"OnGetRichDataClassificationLabelsSuccess: Received no result")};this.rg=()=>{this.Z$j();this.Vli(this.$.ea.ao.LinkedEntityAsyncRefreshStateId);
this.lab?this.Ymi(this.$.ea.ao.RichDataClassificationLabelStateId):this.o$a&&this.V5d(!0)};this.I4i=()=>{this.I6d=!0;this.So&&this.So.jtj()};this.E6i=ub=>{if(ub&&!kb.a(ub))try{ub.Result.HasUntrustedImageUrl&&(this.businessBar.oh(59,null),this.Hsg=!0)}catch(Ub){b.ULS.sendTraceTag(574718945,0,10,`ConvertToLinkedEntityManager.OnGetHasUntrustedImageUrlsFromServerSuccess: GetHasUntrustedImageUrls encountered exception ${Ub}.`)}};this.syf=()=>{if(!this.Tyf&&this.IEb()&&!this.Awd())if(Xa.a("DataTabActive"),
na.a.qh.HS)if(document.querySelector("#ConvertToLinkedEntityGallery-previewExpandButton")){var ub=this.R$b();if(ub){var Ub={};Ub.InputMethod=ob.a.fc;Ub.CalloutName=8;Ub.Target="[data-unique-id=Ribbon-ConvertToLinkedEntityGallery-previewExpandButton]";this.$.Ia.mc(ub,Ub);this.Tyf=!0}else b.ULS.sendTraceTag(537166880,0,10,"RibbonCommandInfo is null for LinkedEntityGalleryCallout")}else b.ULS.sendTraceTag(537166881,0,10,"Could not locate anchor for the LinkedEntityGalleryCallout");else b.ULS.sendTraceTag(537166882,
0,50,"ConvertToLinkedEntityManager:LaunchLinkedEntityGalleryCallout() - Attempted to launch linked entity gallery callout but callout not enabled")};this.B3i=ub=>{cb.a.ng(ub.Errors)||(this.lab||this.V5d(!1),this.raiseEvent("LinkedEntityConverted"))};this.Qcj=()=>{this.$.da.Qb(211,ub=>{ub.readText(ma.a.instance.ha(1813))})};this.ee=(ub,Ub)=>{b.ULS.sendTraceTag(537166867,0,50,"ConvertToLinkedEntityManager.OnWorkbookOpened called");Ub.oX?b.ULS.sendTraceTag(537166865,0,15,"ConvertToLinkedEntityManager.OnWorkbookOpened called while rendering cached content"):
(this.$.isEditMode?this.sJe():this.mDj(),this.I6d&&this.pXe())};this.N6i=ub=>{this.W8b();if(ub.Result){var Ub=ub.Result;ub=Ub.DomainDataArray;if(this.loa=Ub.Ribbon){var Rd={};Rd.Name=ma.a.instance.ha(1803);Rd.DomainIds=this.bM;this.loa.Categories.splice(Xb.Abb,0,Rd)}0<Ub.MaximumCellsToConvert&&(this.Kle=Ub.MaximumCellsToConvert);this.Qt=2;Ub=!1;if(ub){b.ULS.sendTraceTag(39949271,0,50,`OnGetLinkedEntityServiceDomainsSuccess: Received ${ub.length} domains`);this.iRa||(this.iRa=[]);Rd=ma.a.instance.ha(1800);
const Cd=ma.a.instance.ha(1802);for(const Yc of ub)Yc.DomainId?(this.iRa.push(Yc),Yc.DomainBlocked?(ub=!!Yc.DomainId.StringId,b.ULS.sendTraceTag(537166861,0,50,`Domain: ${ub?Yc.DomainId.Id.toString():Yc.Name} is telemetry only, do not show in menu (Has String ID: ${ub})`)):(this.$V.ia(Xb.L5a(Yc.DomainId),Yc),Yc.Name===Rd||268435456===Yc.DomainId.Id?this.b4e=Yc.DomainId.Id.toString():Yc.Name===Cd||536870912===Yc.DomainId.Id?this.y7e=Yc.DomainId.Id.toString():268435712===Yc.DomainId.Id&&Yc.ShowInRibbon&&
(this.o7c=!0),Ub=!0)):b.ULS.sendTraceTag(537166862,0,10,"OnGetLinkedEntityServiceDomainsSuccess: DomainId is null.")}Ub||(this.iRa=null);this.utg();this.rVd.Vci();this.Ypg||(this.U$j(),this.Ypg=!0)}else this.iRa=null,this.Qt=3,-1<this.HOa&&window.setTimeout(()=>{this.HMb()},100*(8-this.HOa)),b.ULS.sendTraceTag(537166863,0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received no result");this.TQd();this.JPe();this.o7c&&this.tsf&&ib.c(this.syf,this.$.ka,500);this.o$a&&!this.lab&&this.V5d(!0)};this.M6i=
ub=>{ub=mb.a.vf(ub.data);b.ULS.sendTraceTag(34415007,0,15,`OnGetLinkedEntityServiceDomainsFailure [Errors: ${cb.a.Uc(ub)}].`);this.iRa=null;this.Qt=3;this.Qdb=!0;this.TQd()};this.onContentReady=()=>{this.org()&&this.gridView.$v(this.onContentReady);this.Kjg&&this.$.workbookContext.Options&1048576&&(this.businessBar.d_j(),this.Kjg=!1)};this.Lj=()=>{this.W8b()};this.m9i=ub=>{if(kb.a(ub)){const Ub=Object(tc.b)("OfficeVSO:7811663_ConvertBusinessBarManagerService2")?Object(Pb.d)(tb.a.resolve(gc.h,{Wa:0})):
Ka.GetServiceTaskFactory.Za(this.$.da,5,4,0);Ra.TaskExtensions.za(Ub,()=>{let Cd=null;if(null===ub||void 0===ub?0:ub.Errors)Cd=ub.Errors[0];Ub.result.pjg(Cd,null)},this.$.ka,3);b.ULS.sendTraceTag(537166800,0,15,`ConvertToLinkedEntityManager.OnLinkedEntityTryAutoRefreshSuccessCore. LinkedEntityTryAutoRefresh returned with errors [Errors: ${cb.a.Uc(ub.Errors)}].`);const Rd=cb.a.hB(ub.Errors,[-1100324317,-2133389873],"ConvertToLinkedEntityManager:OnLinkedEntityTryAutoRefreshSuccessCore");this.$.ea.ep(Rd)}};
this.h7c=()=>{b.ULS.sendTraceTag(537166796,0,50,`ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck. Checking after a ${this.F6b} millisecond interval`);this.iof("Periodic auto-refresh check",this.P1i,this.O1i)};this.P1i=ub=>{kb.a(ub)?(b.ULS.sendTraceTag(537166795,0,15,`ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. LinkedEntityTryAutoRefresh returned with errors [Errors: ${cb.a.Uc(ub.Errors)}].`),++this.w5c):this.w5c=0;e.a.Ka(this.eCa);this.w5c>=this.E4g?(b.ULS.sendTraceTag(537166794,
0,10,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Failed too many consecutive times. Will stop trying to auto-refresh"),this.eCa=null):(b.ULS.sendTraceTag(537166793,0,50,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Re-creating periodicAutoRefreshCheckContext"),this.eCa=ka.a.instance.create(this.h7c,this.F6b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck"))};this.O1i=ub=>{ub=mb.a.vf(ub.data);f.a.Gh(ub)?b.ULS.sendTraceTag(537166791,0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed with an HTTP error"):
b.ULS.sendTraceTag(537166792,0,15,`OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed [Errors: ${cb.a.Uc(ub)}].`);e.a.Ka(this.eCa);this.eCa=ka.a.instance.create(this.h7c,this.F6b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")};this.n$i=ub=>{ub=!!ub.Result&&ub.Result;b.ULS.sendTraceTag(537166790,0,50,`OnNotifyFeatureLicensingStatusSuccess- operationSucceeded? = ${ub.toString()}`);ub?(b.ULS.sendTraceTag(537166789,0,50,`OnNotifyFeatureLicensingStatusSuccess- successful handshake duration = ${da.a.Lb.hf.m-
this.yrd} ms, retry count = ${this.UJb}`),this.HMb()):this.nGc()};this.m$i=()=>{b.ULS.sendTraceTag(537166788,0,15,"OnNotifyFeatureLicensingStatusFailed");this.nGc()};this.p6i=ub=>{ub.Result?(ub=ub.Result)?(this.cSd(),this.businessBar.pjg(null,ub)):b.ULS.sendTraceTag(537166725,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result"):b.ULS.sendTraceTag(537166726,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result")};this.$=Ga;this.businessBar=kc;this.svgIconProvider=
Sb;this.Bc=vb;this.iRa=[];this.bM=[];this.gridView=zb.h(this.$);this.Xjc=-1;this.yEi=qa.EwaSettings.isChangeGateEnabled("OfficeVSO:4294127_LongButtonVisibleWhenAnyDomainOverrideShowsInRibbon");this.o$a=qa.EwaSettings.ya(387);this.lab=qa.EwaSettings.ya(586);this.tsf=qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityGalleryTeachUIEnabled",!1);this.$V=new lc.a;this.jcb=new Db(Ga,Za,this);sb&&(this.So=new Pa(Ga,sb,bc,this,this));this.$.$l(this.ee);m.a(this.$)&&m.a(this.$).HMj(this);
this.sJe();(this.o$a||this.lab)&&this.$.ea.wv(this.rg);qa.EwaSettings.ya(123)&&qa.EwaSettings.ya(131)&&(this.org()||this.gridView.ut(this.onContentReady));this.$.kA(this.Lj);this.$.ea.Mk(this.Md);this.showUntrustedImageBusinessBarIfNecessary();this.rVd=new va(this.$,this)}dispose(){(this.o$a||this.lab)&&this.$.ea.hx(this.rg);this.$.ea.Vk(this.Md);!this.Vba&&qa.EwaSettings.ya(123)&&qa.EwaSettings.ya(131)&&this.gridView.$v(this.onContentReady);this.So&&this.So.dispose();this.$.$C(this.Lj);this.$.hn(this.ee);
this.o$a&&(this.Avd=null);e.a.Ka(this.eCa)}XXg(Ga){this.addHandler("LinkedEntityConverted",Ga)}azj(Ga){this.removeHandler("LinkedEntityConverted",Ga)}get gsj(){return 5}get Bfb(){return this.bM}set Bfb(Ga){this.bM=Ga}selectEntity(Ga){return this.So?this.So.selectEntity(Ga):!1}searchEntity(Ga,Za){this.So&&this.So.searchEntity(Ga,Za)}pWd(Ga,Za,Sb,sb){this.So&&this.So.searchEntity(Ga,Za,!0,Sb,sb)}pJb(Ga){return this.So?this.So.pJb(Ga):!1}onPaneClosed(){if(this.So)this.So.onPaneClosed()}cancelSearch(){this.So&&
this.So.cancelSearch()}selectDataType(Ga){this.So&&this.So.selectDataType(Ga)}showHelpArticle(Ga){this.So&&this.So.showHelpArticle(Ga)}showSurveyDialog(Ga){this.So&&this.So.showSurveyDialog(Ga)}insertTable(Ga,Za){this.So&&this.So.insertTable(Ga,Za)}Ymi(Ga){this.$.isEditMode&&this.l9f!==Ga&&d.AFrameworkApplication.fa.ra("SupportsPolicies")&&(this.l9f=Ga,b.ULS.sendTraceTag(537166925,0,50,"HandleRichDataClassificationLabelStateIdChanged - Getting rich data classification labels"),G(this.$.qa.va,this.l7i,
null,null,null))}pXe(){this.$.userOperationManager.Bd(new Ab.a(589,0,(Ga,Za,Sb)=>oa(this.$.qa.va,Da.b(Ga,this.I4i),Za,Sb,null),80),null)}showUntrustedImageBusinessBarIfNecessary(){this.I6d||this.Hsg||!this.$.ea.Oc||this.gKj()}gKj(){this.$.userOperationManager.Bd(new Ab.a(588,0,(Ga,Za,Sb)=>Ea(this.$.qa.va,Da.b(Ga,this.E6i),Za,Sb,null),80),null)}V5d(Ga){if(this.o$a&&null==this.Avd&&!this.lab&&d.AFrameworkApplication.fa.ra("SupportsPolicies")&&null!=this.aab&&this.aab&&(!Ga||this.$.workbookContext.Options&
262144)){var Za=Ka.GetServiceTaskFactory.Za(this.$.da,274,275,0);Ra.TaskExtensions.za(Za,()=>{this.Avd=Za.result.w2f(2)},this.$.ka,3)}}get RIb(){return this.Ywa.length}get MVi(){return this.Kle}Zkh(Ga){(Ga=this.yAh(Ga))?this.convertToLinkedEntity(Ga):b.ULS.sendTraceTag(537166920,0,10,"Could not convert key into domain ID")}convertToLinkedEntity(Ga){b.ULS.sendTraceTag(34415004,0,50,`ConvertToLinkedEntityManager:ConvertToLinkedEntity() - conversion attempted  [ServiceEndpoint: ${Ga.Id}].`);if(this.gridView){var Za=
this.gridView.ga.pa.Sd,Sb=Za.ff(this.gridView.dS);this.Nvd&&this.DVg(Ga);if(Sb){Sb=this.gridView.Wb.Xza(Sb);if(!this.bjf(Ga)&&this.wtf(Ga.Id)){b.ULS.sendTraceTag(537166918,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert to organization data type without curated data");if(na.a.qh.HS){Za=this.Gld();if(!Za){b.ULS.sendTraceTag(537166917,0,50,"CalloutAnchorElement is null for blankCellConvert");return}Sb=this.R$b();if(!Sb){b.ULS.sendTraceTag(537166916,0,50,"RibbonCommandInfo is null for blankCellConvert");
return}var sb={["InputMethod"]:ob.a.fc,CalloutName:3};sb.Target=Za;sb.RibbonButtonLabel=qa.EwaSettings.isChangeGateEnabled("OfficeVSO:4244626_BlankCellCalloutRibbonButtonLabel")?this.Z8f(Ga):this.jHb(Ga.Id.toString());sb.ExampleEntities=this.X1e(Ga);this.$.Ia.mc(Sb,sb);return}b.ULS.sendTraceTag(537166915,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert to organization data without curated data, teaching callout not enabled")}if(this.wtf(Ga.Id)&&!Ga.StringId)this.launchLinkedEntityDataTypeSelectorPane(Xb.L5a(Ga));
else{if(Sb){b.ULS.sendTraceTag(537166914,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert an empty range");if(qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LaunchStarterDataForBlankCell",!1)&&this.m4j(Ga)){Za=lb.r(this.gridView.ga.pa.selectedRanges,this.$);this.So.zMi(Za,Ga);return}if(na.a.qh.HS){Za=this.Gld();if(!Za){b.ULS.sendTraceTag(537166913,0,50,"CalloutAnchorElement is null for blankCellConvert");return}Sb=this.R$b();if(!Sb){b.ULS.sendTraceTag(537166912,
0,50,"RibbonCommandInfo is null for blankCellConvert");return}sb={["InputMethod"]:ob.a.fc,CalloutName:2};sb.Target=Za;sb.RibbonButtonLabel=this.Z8f(Ga);sb.ExampleEntities=this.X1e(Ga);sb.BlankCellResourceId=this.J5g(Ga);sb.HasBlankCellWalkthrough=this.Sni(Ga);sb.ServiceDomain=Ga.Id;this.$.Ia.mc(Sb,sb);return}b.ULS.sendTraceTag(537166883,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert a blank range, teaching callout not enabled")}this.dad(Ga,!1,Za)}}}else b.ULS.shipAssertTag(537166919,
0,!1,"grid view should not be null")}convertToLinkedEntityFromAutoDetect(){this.Vba&&this.Vba.lLa()}onAutoDetectUIShown(){wb.a(this.$.userOperationManager,(Ga,Za,Sb)=>M(this.$.qa.va,Ga,Za,Sb,null),Ga=>new Ab.a(230,0,Ga,80),null)}dad(Ga,Za,Sb){const sb=lb.q(Sb,this.$),bc=()=>new ja.a;wb.a(this.$.userOperationManager,(kc,vb,ub)=>L(this.$.qa.va,sb,Ga,Za,Da.b(kc,this.B3i,this.Qcj,this.So.A3i),vb,ub,null),kc=>new Ab.a(115,0,kc,void 0,bc),null)}DVg(Ga){if(this.Nvd){var Za={};Za.Id=Ga.Id;Ga.StringId&&(Za.StringId=
Ga.StringId);if(!(0<this.bM.length&&this.bM[0].Id===Za.Id&&this.bM[0].StringId===Za.StringId)){Ga=!1;this.bM.splice(0,0,Za);for(let Sb=1;Sb<this.bM.length;++Sb)if(this.bM[Sb].Id===Za.Id&&this.bM[Sb].StringId===Za.StringId){this.bM.splice(Sb,1);Ga=!0;break}for(;5<this.bM.length;)this.bM.splice(this.bM.length-1,1);this.loa.Categories[Xb.Abb].DomainIds=this.bM;this.O7f();Ga||this.rVd.byg(this.bM)}}}convertLinkedEntityToText(){b.ULS.sendTraceTag(34719501,0,50,"ConvertToLinkedEntityManager:ConvertLinkedEntityToText() - conversion attempted");
if(this.gridView){var Ga=lb.q(this.gridView.ga.pa.Sd,this.$);wb.a(this.$.userOperationManager,(Za,Sb,sb)=>B(this.$.qa.va,Ga,Za,Sb,sb,null),Za=>new Ab.a(116,0,Za),null)}else b.ULS.shipAssertTag(537166879,0,!1,"grid view should not be null")}refreshLinkedEntitiesInRange(){b.ULS.sendTraceTag(537166878,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange() - refresh attempted");if(zb.h(this.$)){this.$.isEditMode||b.ULS.sendTraceTag(537166876,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange(): Refreshing selection during view mode");
this.cSd();var Ga=lb.r(this.gridView.ga.pa.selectedRanges,this.$);wb.a(this.$.userOperationManager,(Za,Sb,sb)=>E(this.$.qa.va,Ga,Za,Sb,sb,null),Za=>new Ab.a(248,0,Za),null)}else b.ULS.shipAssertTag(537166877,0,!1,"grid view should not be null")}oWj(Ga){Ga=this.aW(Ga.DomainId);if(!Ga||Ga.DomainBlocked||qa.EwaSettings.isChangeGateEnabled("OfficeVSO:4465309_NoCuratedDataNoLongButton")&&!Ga.HasCuratedData)return!1;if(this.yEi){for(let Za of this.$V)if(Za.value.DomainId.Id===Ga.DomainId.Id&&Za.value.ShowInRibbon)return!0;
return!1}return Ga.ShowInRibbon}QUj(Ga){return 2!==this.Qt||!this.Ywa[Ga]}launchDisambiguationPaneForSearch(){this.So&&this.So.launchDisambiguationPaneForSearch()}Cd(Ga,Za,Sb){if("PopulateConvertToLinkedEntityMenu"!==Za)return!1;this.Bkd=Sb.MenuId;if(0===this.Qt||3===this.Qt)return this.Ljj(),!0;if(!this.loa)return b.ULS.sendTraceTag(537166873,0,10,"PopulateMenu: Encountered null ribbon section info"),!1;if(!this.$V)return b.ULS.sendTraceTag(537166872,0,10,"PopulateMenu: Encountered null domain collection"),
!1;this.o_=this.o_||this.jcb.GYh(this.loa,Sb.MenuId);Sb.MenuItems=this.o_;return this.Nvd=!0}Ljj(){-1===this.Xjc&&(this.HMb(),this.Xjc=window.setInterval(()=>{this.HMb()},2E3))}HMb(){this.$.ea.Oc&&2!==this.Qt&&(this.HOa--,b.ULS.sendTraceTag(537166870,0,50,"ConvertToLinkedEntityManager:PopulateDomainData() - populating domains attempted."),this.Qt=1,O(this.$.qa.va,this.N6i,this.M6i,null,null))}Awd(){return this.$.isEditMode&&2!==this.Qt&&(0<=this.HOa||!this.Qdb)}u7d(Ga){d.AFrameworkApplication.ih?
b.ULS.sendTraceTag(537166869,0,50,"UpdatePreviewGalleryVisibility bailed out on shutting down."):m.a(this.$)?(this.Bfk(),Ga&&this.$.ig()):b.ULS.sendTraceTag(537166868,0,50,"UpdatePreviewGalleryVisibility bailed out on null RibbonManager.")}mDj(){this.UJb=0;this.HOa=8;this.Qdb=!1;this.Qt=this.Xjc=0;this.iRa=this.loa=null;this.W8b();for(let Ga=0;Ga<this.RIb;++Ga)this.Ywa[Ga]=null;this.IEb()&&this.u7d(!0)}W8b(){this.o_=null}IEb(){const Ga=w.a.zNb,Za=m.a(this.$);return!!Za&&Za.xq.Tz===Ga}utg(){if(this.loa){let Sb=
0;var Ga=-1,Za=-1;let sb=0,bc=0,kc=0,vb=0;const ub=[null,null,null,null,null];for(const Ub of this.loa.Categories){let Rd=!1;for(const Cd of Ub.DomainIds){let Yc=this.aW(Cd);Yc&&!Yc.DomainBlocked&&Yc.ShowInRibbon&&(Sb<this.RIb?(this.Ywa[Sb]=Cd,bc===Xb.Abb&&(-1===Ga&&(Ga=Sb),Za=Sb,vb=Za-Ga+1),++Sb):Sb===this.RIb&&sb<vb&&bc!==Xb.Abb&&(ub[sb]=Cd,++sb),Rd=!0)}Rd&&++kc;++bc}if(-1<Ga&&kc<=Xb.Wyf){for(;Za>=Ga;--Za)this.Ywa.splice(Za,1);for(Ga=0;Ga<vb;++Ga)this.Ywa.splice(Sb+Ga,0,ub[Ga])}for(;Sb<this.RIb;)this.Ywa[Sb]=
null,++Sb}}org(){const Ga=zb.h(this.$).Ca,Za=this.gridView.ga.rf;if(Ga&&Ga.Erd&&1===Za&&this.gridView.ga.pa.activeCell){const Sb=Object(tc.b)("OfficeVSO:7629428_MigrateSharedUIControlsFactoryService")?Object(Pb.d)(tb.a.resolve(gc.tb,{Wa:1})):Ka.GetServiceTaskFactory.Za(this.$.da,12,477,1);Ra.TaskExtensions.za(Sb,()=>{this.Vba=new t.a(this.$,this.svgIconProvider,Sb.result,this,this.Bc)},this.$.ka,3);return!0}return!1}CMi(){this.So&&this.So.ZBd(!0)}launchLinkedEntityDataTypeSelectorPane(Ga){if(this.So)if(Ga=
this.yed(Ga))if(Ga.DomainId.StringId)b.ULS.sendTraceTag(537166855,0,10,"Domain with a string ID used when launching Data Type Selector pane");else{var Za=lb.r(this.gridView.ga.pa.selectedRanges,this.$);this.So.launchLinkedEntityDataTypeSelectorPane(Za,Ga.DomainId.Id)}else b.ULS.sendTraceTag(537166856,0,10,"Unknown domain used when launching Data Type Selector pane")}njh(Ga){const Za=this.wri(Ga),Sb=h.a.xi(this.jHb(Ga));Ga=h.a.xi(this.V4d(Ga));return Xb.lYh(Za,Jb.a.yg(11),Sb,Ga)}V4d(Ga){try{return this.qVe(parseInt(Ga,
10)).Description}catch(Za){}return ma.a.instance.ha(1797)}jHb(Ga){try{return this.qVe(parseInt(Ga,10)).Name}catch(Za){}return ma.a.instance.ha(1783)}Z8f(Ga){try{return this.aW(Ga).Name}catch(Za){}return this.jHb(Ga.Id.toString())}J5g(Ga){try{return this.aW(Ga).BlankCellResourceId}catch(Za){}return null}Sni(Ga){try{return this.aW(Ga).HasBlankCellWalkthrough}catch(Za){}return!1}bjf(Ga){try{const Za=Xb.L5a(Ga);if(this.$V.Pb(Za))return this.$V.ma(Za).HasCuratedData}catch(Za){}return!1}m4j(Ga){try{return this.aW(Ga).SupportsStarterData}catch(Za){}return!1}wtf(Ga){return 268435968===
Ga}Gld(){return 2===m.a(this.$).KP?"[data-unique-id=LinkedEntity_MLR]":"[data-unique-id=LinkedEntity]"}R$b(){return new pb.a(-847286761,ob.a.fc,this.$.Tc,0,w.a.n2)}JPe(){if(this.IEb()&&!this.Awd()&&!this.Xqf&&qa.EwaSettings.ya(387)&&this.bjf({Id:268435968,StringId:null}))if(b.ULS.sendTraceTag(537166819,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - tried to launch first org data teaching callout"),na.a.qh.HS){const Sb=this.Gld();if(Sb){var Ga=this.R$b();if(Ga){var Za=
{["InputMethod"]:ob.a.fc,CalloutName:6};Za.Target=Sb;Za.ShouldCanvasTakeFocus=!0;this.$.Ia.mc(Ga,Za);this.Xqf=!0}else b.ULS.sendTraceTag(537166817,0,10,"RibbonCommandInfo is null for firstOrgData")}else b.ULS.sendTraceTag(537166818,0,10,"CalloutAnchorElement is null for firstOrgData")}else b.ULS.sendTraceTag(537166816,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - Attempted to launch firstOrgData callout, teaching callout not enabled")}Yqi(Ga){Ga=this.yed(Ga);
return Ga?this.jcb.u4g(Ga.SubdomainFontLocator):(b.ULS.sendTraceTag(537166815,0,10,"ConvertToLinkedEntityManager.IconFromDomainFontLocator: Requested domain that doesn't exist in collection"),null)}Fmc(Ga){return this.Vba?this.Vba.t4g(Ga):!1}s0h(){return this.Vba?this.Vba.q1h():""}kzi(){return this.Vba?this.Vba.NHb:!1}j5h(Ga,Za){const Sb=this.jmf(Ga);if(0>Sb)b.ULS.sendTraceTag(537166813,0,10,`Unexpected menuItemKey for dynamic preview gallery button: ${Ga}`);else if(Ga=(Ga=this.rVe(Ga))?this.aW(Ga):
null)Za[l.a.GalleryButtonProps]=this.jcb.hZh(Sb,Ga),Za[l.a.Alt]=this.jcb.omd(Ga)}O7f(){this.utg();this.IEb()&&this.u7d(!0);this.W8b()}wri(Ga){return Ga===this.b4e?x.a.b1e:Ga===this.y7e?x.a.$0e:x.a.Z0e}X1e(Ga){try{return this.aW(Ga).ExampleEntities}catch(Za){}return ma.a.instance.ha(1805)}TQd(){(0>this.HOa||this.Qdb)&&b.ULS.sendTraceTag(537166811,0,15,"RefreshFullGalleryIfOpened: Out of GetLinkedEntityServiceDomain retries");(2===this.Qt||0>this.HOa||this.Qdb)&&window.clearInterval(this.Xjc);this.Awd()?
this.Bkd&&this.$.frame.Cy(this.Bkd):this.u7d(this.IEb())}sc(Ga){return this.$.qc+Ga}Bfk(){var Ga=!0;const Za=Array(this.RIb),Sb=m.a(this.$)?m.a(this.$).xq:null;if(Sb){for(let sb=0;sb<Za.length;++sb)this.QUj(sb)?Za[sb]=!0:Ga=Za[sb]=!1;Sb.Qeg(["ConvertToLinkedEntityGallery"],Ga);if(!Ga)for(Ga=0;Ga<Za.length;++Ga)Za[Ga]&&Sb.Qeg([this.i5h(Ga)],!0)}else b.ULS.sendTraceTag(537166809,0,15,"UpdateLinkedEntityGalleryButtonsVisibility: ribbonUser should not be null")}aW(Ga){const Za=Xb.L5a(Ga);if(this.$V.Pb(Za))return this.$V.ma(Za);
b.ULS.sendTraceTag(592729218,0,15,`No domain data for domain ID ${Ga.Id} (Has String ID: ${!!Ga.StringId})`);return null}i5h(Ga){return"ConvertToLinkedEntityPreview"+Ga.toString()}k7d(){k.a.get_instance().Fj(10,()=>{this.JPe();this.o7c&&this.tsf&&ib.c(this.syf,this.$.ka,500)})}Jjc(Ga,Za){switch(Ga){case "QueryLinkedEntityGalleryButtons":if(!Za[l.a.InnerHTML]){Ga=Za[ob.a.Gd].toString();const Sb=Ob.a.equals(Ga,ma.a.instance.ha(1800),!0)||Ob.a.equals(Ga,ma.a.instance.ha(1801),!0),sb=Ob.a.equals(Ga,ma.a.instance.ha(1802),
!0);Sb||sb||this.j5h(Ga,Za)}break;case "QueryLinkedEntityMenuGalleryButtons":Za[l.a.InnerHTML]||(Za[l.a.InnerHTML]=this.njh(Za[ob.a.Gd]))}return Za}yAh(Ga){var Za=this.rVe(Ga);if(Za)return Za;if(Za=this.yed(Ga))return Za.DomainId;b.ULS.sendTraceTag(537166805,0,10,`Could not convert key into domain: ${Ga}`);return null}qVe(Ga){const Za={};Za.Id=Ga;return this.aW(Za)}yed(Ga){return this.$V.Pb(Ga)?this.$V.ma(Ga):null}jmf(Ga){if(!Ga.startsWith(Xb.Ued))return-1;const Za=parseInt(Ga.substr(Xb.Ued.length),
10);return isNaN(Za)?(b.ULS.sendTraceTag(537166802,0,10,`Unexpected index in preview gallery button key: ${Ga}`),-1):Za}rVe(Ga){Ga=this.jmf(Ga);return 0>Ga?null:this.Ywa[Ga]}iof(Ga,Za,Sb){this.$V&&this.$V.count&&(b.ULS.sendTraceTag(537166801,0,50,`ConvertToLinkedEntityManager.InvokeLinkedEntityTryAutoRefresh. (${Ga})`),Ga=this.$.qa.va.Lc(),this.$.ea.Oc&&ea(this.$.qa.va,Da.b(this.m9i,Za),Sb,null,null,Ga))}U$j(){this.iof("Auto-refresh on load",null,null)}Z$j(){this.$V&&this.$V.count&&(this.eCa?b.ULS.sendTraceTag(537166799,
0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. A periodic auto-refresh check context already exists. No need to create another one"):this.$.ea.ao.HasAutoRefreshableLinkedEntityDomainsEver?(b.ULS.sendTraceTag(537166797,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book has auto-refreshable domains. Creating periodic auto refresh check context"),this.eCa=ka.a.instance.create(this.h7c,this.F6b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")):
b.ULS.sendTraceTag(537166798,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book doesn't have any auto-refreshable domains. Periodic auto refresh check context will NOT be created"))}nGc(){if(this.$.ea.Oc&&null!=this.aab&&null!=this.xyd&&null!=this.yyd&&null!=this.HAd&&null!=this.Lzd)if(++this.UJb,12>=this.UJb){1===this.UJb&&(this.yrd=da.a.Lb.hf.m,b.ULS.sendTraceTag(537166752,0,50,"StartLinkedEntityDelayedHandshake - starting handshake."));const Ga=this.$.qa.va.Lc();
Ha.v(this.$.qa.va,this.INi,this.JNi(),this.n$i,this.m$i,null,Ga)}else b.ULS.sendTraceTag(537166751,0,15,`StartLinkedEntityDelayedHandshake - Retry count expired - failed handshake duration ${da.a.Lb.hf.m-this.yrd} ms`),this.Qdb=!0,this.TQd()}sJe(){if(this.$.isEditMode)if(null!=this.aab)this.nGc();else{var Ga=da.a.Lb.hf.m,Za=[];u.a.instance.Dc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Sb=>{Sb.isFeatureEnabled("ExcelPowerBiPro",!1).then(sb=>{b.ULS.sendTraceTag(537166747,
0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiPro"} takes ${da.a.Lb.hf.m-Ga} Millisecond.`);b.ULS.sendTraceTag(537166746,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiPro"}] isEnabled=[${sb}]`);return this.aab=sb}).then(()=>{Za.push(Sb.isFeatureEnabled("ExcelWolframAlpha",!1).then(sb=>{b.ULS.sendTraceTag(590960588,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelWolframAlpha"} takes ${da.a.Lb.hf.m-Ga} Millisecond.`);b.ULS.sendTraceTag(537166743,
0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelWolframAlpha"}] isEnabled=[${sb}]`);return this.HAd=sb}))}).then(()=>{Za.push(Sb.isFeatureEnabled("ExcelDisableStockGeographyDataTypes",!1).then(sb=>{b.ULS.sendTraceTag(537166741,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelDisableStockGeographyDataTypes"} takes ${da.a.Lb.hf.m-Ga} Millisecond.`);b.ULS.sendTraceTag(537166740,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelDisableStockGeographyDataTypes"}] isEnabled=[${sb}]`);
const bc=[Object(Nb.a)(new Ca.a,{name:"IsRestrictedByLicense",bool:sb})];Xa.a("SatoriStockGeographyLicensingRestrictions",void 0,void 0,bc);this.avf=sb&&qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StockGeographyLicensingCheck",!1);return sb}))}).then(()=>{Za.push(Sb.isFeatureEnabled("StockHistory",!1).then(sb=>{b.ULS.sendTraceTag(537166739,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"StockHistory"} takes ${da.a.Lb.hf.m-Ga} Millisecond.`);b.ULS.sendTraceTag(537166738,0,50,
`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"StockHistory"}] isEnabled=[${sb}]`);return this.Lzd=sb}))}).then(()=>{Za.push(Sb.isFeatureEnabled("ExcelPowerBiFree",!1).then(sb=>{b.ULS.sendTraceTag(537166736,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiFree"} takes ${da.a.Lb.hf.m-Ga} Millisecond.`);b.ULS.sendTraceTag(537166735,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiFree"}] isEnabled=[${sb}]`);return this.xyd=sb}))}).then(()=>{Za.push(Sb.isFeatureEnabled("ExcelPowerBiPremiumPerUser",
!1).then(sb=>{b.ULS.sendTraceTag(537166734,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiPremiumPerUser"} takes ${da.a.Lb.hf.m-Ga} Millisecond.`);b.ULS.sendTraceTag(537166733,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiPremiumPerUser"}] isEnabled=[${sb}]`);return this.yyd=sb}))}).then(()=>{Promise.all(Za).then(()=>{this.nGc()})})})}}get INi(){return"ExcelPowerBiPro ExcelWolframAlpha StockHistory ExcelPowerBiFree ExcelPowerBiPremiumPerUser ExcelDisableStockGeographyDataTypes".split(" ")}JNi(){return[this.aab,
this.HAd,this.Lzd,this.xyd,this.yyd,this.avf]}cSd(){this.businessBar&&this.businessBar.Ena(58)&&this.businessBar.removeEntry(58)}Vli(Ga){this.yCd!==Ga&&this.businessBar&&((this.yCd=Ga)?V(this.$.qa.va,this.p6i,null,null,null):this.cSd())}static lYh(Ga,Za,Sb,sb){Ga=String.format('<span class="cui-img-32by32 cui-img-cont-float"><IMG class="{0}" src="{1}" alt="{2}" align="middle"></span>',Ga,Za,sb);Sb=String.format('<div class="cui-row-onerow"><p class="cui-ctl-mediumlabel leg-gallerybuttonlabel" align="middle">{0}</p></div>',
Sb);return String.format('<div mscui:controltype="GalleryButton" class="leg-gallerybutton">{0}{1}</div>',Ga,Sb)}static L5a(Ga){return Ga.StringId?Ga.Id.toString()+"."+Ga.StringId:Ga.Id.toString()}}Xb.fWe="ConvertToLinkedEntityPreview";Xb.Ued="PreviewGalleryButtonIndex.";Xb.Abb=0;Xb.Wyf=2;Object(c.a)(Xb,"ConvertToLinkedEntityManager",v.a,[429,430,2,431])},876:function(r,C,a){a.d(C,"a",function(){return b});r=a(0);C=a(737);var c=a(91);class b extends C.a{constructor(e,f,d){super(e,f);this.Rs=!0;this.command=
d}Ym(e){super.Ym(e);this.businessBar.$.Ia.mc(new c.a(this.command,e,this.businessBar.$.Tc,10,null))}}Object(r.a)(b,"CommandActionBusinessBarEntry",C.a,[])},898:function(r,C,a){a.r(C);r=a(0);var c=a(2),b=a(15),e=a(331),f=a(34),d=a(12),h=a(275);class l{constructor(){this.scenario=null;this.timeElapsed=0;this.isNewSession=!1;this.rawData=null}}Object(r.a)(l,"ConnectionErrorLogInfo",null,[]);var k=a(1090),u=a(1091);class v{constructor(w){this.Zsd=[k.a.Oyg,k.a.KLc];this.Om=(m,t)=>{this.JP[t]=m;this.Boi()&&
this.iCj("OnNetworkDownImmediatePing"===m.caller)};this.Eoa=w;this.$=w.$;this.JP={}}xMi(){const w=u.a.Ykd(this.Om,"OnNetworkDownImmediatePing",this.$,this.Zsd);for(const m of w)m.runTest()}Boi(){for(const w of this.Zsd)if(void 0===this.JP[w]||null===this.JP[w])return!1;return!0}iCj(w){const m=this.$.Lf.W7;w&&this.m3j(m);for(var t of this.Zsd)this.JP[t]=Sys.Serialization.JavaScriptSerializer.serialize(this.JP[t]);w=Date.now();t=this.Eoa.Vpd(a(898).NetworkConnectionHealthChecker.EJb).returnValue;const z=
this.Eoa.Vpd(a(898).NetworkConnectionHealthChecker.NQb).returnValue;this.JP.isOfflineMode=m;this.JP.networkDownBBAge=-1===t?t:w-t;this.JP.transientServerCommunicationFailuresBBAge=-1===z?z:w-z;this.Eoa.businessBar?(this.JP.isNetworkDownBBShown=this.Eoa.businessBar.gG(56).toString(),this.JP.isServerErrorBBShown=this.Eoa.businessBar.gG(21).toString()):(this.JP.isNetworkDownBBShown="unknown",this.JP.isServerErrorBBShown="unknown");b.ULS.sendTraceTag(537155224,0,50,`ConnectionHealthTestsRunner.ReportPingResults: ${Sys.Serialization.JavaScriptSerializer.serialize(this.JP)}`)}m3j(w){const {NetworkConnectionHealthChecker:m}=
a(898),t={};for(const z of Object.keys(this.JP)){const y=this.JP[z];t[y.testName]=y.isSuccess}t.isOfflineMode=w;this.Eoa.G2d(m.z$c,Sys.Serialization.JavaScriptSerializer.serialize(t))}}Object(r.a)(v,"ConnectionHealthTestsRunner",null,[]);a.d(C,"NetworkConnectionHealthChecker",function(){return x});class x{constructor(w){this.businessBar=this.hbb=null;this.E1i=(m,t)=>{t.hed?this.G1i(t):this.F1i(t)};this.ei=(m,t)=>{m=t.context.methodName;this.hbb&&m===this.hbb&&(b.ULS.sendTraceTag(537155230,0,50,`NetworkConnectionHealthChecker.OnWebMethodSuccess: Failed web method "${this.hbb}" has now succeeded. Querying local storage for BB showings.`),
this.Jbb(x.NQb,!0),this.hbb=null);this.NAf(!1);this.V9b=!1};this.Fn=(m,t)=>{f.a.Ph(t.errors,[-1387426400])&&!this.V9b&&(this.V9b=!0,this.fhg()&&window.performance.mark(x.UHf),(new v(this)).xMi())};this.Tg=()=>{this.NAf(!0);this.Jbb(x.EJb,!1);this.Jbb(x.NQb,!1)};this.KBa=()=>{this.Jbb(x.EJb,!0)};this.$=w;this.qa=this.$.qa;this.localStorage=new h.a;this.V9b=!1;this.$.ea.yk(this.Tg);this.qa.Lf.msb(this.KBa);this.qa.Bs(this.ei);this.$.da.Qb(5,m=>{this.businessBar=m;m.pWg(this.E1i)});this.qa.Qy(this.Fn)}dispose(){this.$&&
(this.$.ea&&this.$.ea.en(this.Tg),this.qa&&(this.qa.Lf.FOb(this.KBa),this.qa.Rz(this.Fn),this.qa.Wt(this.ei)))}G1i(w){const m={};m.Timestamp=Date.now().toString();switch(w.h3a){case 21:this.hbb=w.data.FailedMethod;m.FailedMethod=this.hbb;this.G2d(x.NQb,JSON.stringify(m));break;case 56:this.G2d(x.EJb,JSON.stringify(m))}}F1i(w){switch(w.h3a){case 21:this.Jbb(x.NQb,!0);break;case 56:this.Jbb(x.EJb,!0)}}G2d(w,m){try{this.localStorage.Bf()&&this.localStorage.setItem(w,m)}catch(t){b.ULS.sendTraceTag(537155231,
0,15,`NetworkConnectionHealthChecker.StoreDataInLocalStorage: Failed to set item to local storage. reason: ${t.message||"Unknown"}`)}}Vpd(w){if(this.localStorage.Bf()&&(w=this.localStorage.$Na(w))&&"null"!==w){var m=JSON.parse(w);w=parseInt(m.Timestamp,10);m=Sys.Serialization.JavaScriptSerializer.serialize(m);return{returnValue:w,rawData:m}}return{returnValue:-1,rawData:null}}NAf(w){if(this.localStorage.Bf()){const m=this.localStorage.$Na(x.z$c);if(m&&"null"!==m){let t=-1;this.V9b&&(t=this.g5h(x.UHf,
x.p0i));b.ULS.sendTraceTag(537155229,0,50,`NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: Ping Results: ${Sys.Serialization.JavaScriptSerializer.serialize(m)}, Period offline: ${t}, New session: ${w}`);this.localStorage.removeItem(x.z$c)}}}g5h(w,m){if(!this.fhg())return-1;window.performance.measure(m,w);w=window.performance.getEntriesByName(m);return w.length&&w[w.length-1]?w[w.length-1].duration:(b.ULS.sendTraceTag(537155228,0,10,`NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: measure name ${m} returned no measures.`),
-1)}Jbb(w,m){try{let t;const z=({rawData:t}=this.Vpd(w)).returnValue;if(-1!==z){const y=Object(c.a)(new l,{timeElapsed:Date.now()-z,scenario:w,isNewSession:!m,rawData:t});b.ULS.sendTraceTag(537155227,0,50,`NetworkConnectionHealthChecker.LogNetworkIssueBBShown: ${JSON.stringify(y)}`)}this.localStorage.removeItem(w)}catch(t){b.ULS.sendTraceTag(537155226,0,15,`NetworkConnectionHealthChecker.LogNetworkIssueBBShown: Failed to get item from local storage. reason: ${t.message||"Unknown"}`)}}fhg(){return d.HelperMethods.n6c&&
e.a.dub}}x.EJb="NetworkDownBBShown";x.NQb="ServerCommunicationFailureBBShown";x.z$c="ConnectionHealthPingRsults";x.UHf="offMoStMa";x.p0i="offMoDuMea";Object(r.a)(x,"NetworkConnectionHealthChecker",null,[2])},949:function(r,C,a){a.d(C,"a",function(){return d});r=a(0);var c=a(15),b=a(6),e=a(41),f=a(31);class d{static d8e(h,l){switch(h){case 3:return d.Gii(l);case 2:return d.Wai(l);case 1:return d.L5h(l)}return""}static Gii(h){switch(h){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkWordWac.toString();
case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkWordWac.toString()}return""}static Wai(h){switch(h){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkPptWac.toString();case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkPptWac.toString()}return""}static L5h(h){switch(h){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkExcelWac.toString()}return""}static openInClient(h,
l,k){if(f.a.Fh||f.a.Vo)window.setTimeout(()=>{d.O1f(k,d.vgf())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(d.oBe(k),h,0,!1)}static tfh(h,l,k,u){l&&u&&u();d.openInClient(h,l,k)}static vgf(){return f.a.Fh?1:f.a.Vo?2:f.a.Wab?3:f.a.isMac?4:0}static get CFb(){return"zh-CN"===window.navigator.language}static O1f(h,l){1===l?(c.ULS.sendTraceTag(17151569,306,50,"User Directed to App Store"),h=d.d8e(h,l),8<f.a.nDb?e.a.Vf(h,void 0,void 0,"RedirectToAppStore"):e.a.aS(h)):document.hidden||
(d.CFb?(h=b.AFrameworkApplication.fa.appSettings.WildFireUrlChinaStoreAndroid.toString())?(c.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),e.a.aS(h)):c.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(c.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(d.d8e(h,l),null,null)))}static oBe(h){switch(h){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}}static get Z_d(){return(f.a.Wab||
f.a.isMac)&&f.a.Wo}static t8e(h){switch(h){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}}static vEi(h){return(h=d.R8h(h))&&""!==h?Boolean.parse(h):!1}static $Yd(h){d.EOj(h)}static R8h(h){try{return localStorage.getItem(h)}catch(l){return c.ULS.sendTraceTag(18416668,306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+l.message),null}}static EOj(h){try{localStorage.setItem(h,"true")}catch(l){c.ULS.sendTraceTag(18416669,
306,50,"WildFire LocalStorage SetItem Failed with exception : "+l.message)}}}d.geh="ChromeExtensionBarDismiss";Object(r.a)(d,"WildFireUtilities",null,[])},992:function(r,C,a){a.r(C);r=a(0);var c=a(15),b=a(235),e;(function(m){m[m.paren=0]="paren";m[m.lead=1]="lead";m[m.intern=2]="intern";m[m.trail=3]="trail";m[m.undefined=4]="undefined"})(e||(e={}));Object(r.b)("CurrencyFormatOption",e);var f;(function(m){m[m.none=-1]="none";m[m.mdy=0]="mdy";m[m.dmy=1]="dmy";m[m.ymd=2]="ymd";m[m.myd=3]="myd";m[m.dym=
4]="dym";m[m.ydm=5]="ydm"})(f||(f={}));Object(r.b)("DateOrderOption",f);var d=a(9);class h{constructor(m,t){({CalcHelper:m}=a(992));t&&(t.Ef||c.ULS.shipAssertTag(537169942,0,!1,"LocaleHolder constructor - locale information is not available"));this.DKg=m.NPe(t,m.yPe(t.ema));this.EKg=excelOnlineCalc.calc.localeInfoFromData(this.localeData)}get localeInfo(){return this.EKg}get localeData(){return this.DKg}}Object(r.a)(h,"LocaleHolder",null,[]);var l=a(1111),k=a(54),u=a(1),v=a(23),x=a(161);a.d(C,"CalcHelper",
function(){return w});class w{constructor(m){this.$=m;(this.Pv=this.$.da.Ba(268))||c.ULS.shipAssertTag(537170070,0,!1,"CalcHelper constructor - IInstantaneousSupportInformationManager is not available");let t;t=u.EwaSettings.isChangeGateEnabled("OfficeVSO:5543503_loadCalcCurrentVersion")?k.a.current.Uo(78):k.a.current.Uo(81);this.logger=new l.a;this.documentLoc=excelOnlineCalc.location.documentLoc("",this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName);this.hPi=new h(m,this.Pv);excelOnlineCalc.config.initCalc(this.logger,
this.Pv?z=>this.Pv.isFeatureEnabled(z):()=>!1,t);this.ks=excelOnlineCalc.config.calcConfig(this.hPi.localeInfo)}get config(){return this.ks}Fth(){if(u.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")){if(!this.$.ua)return c.ULS.shipAssertTag(537170069,0,!1,"CalcHelper.CurrentSheetIndex() - this.ewaControl.Sheets is null"),0;const m=this.$.ua.na;return m?m.index:(c.ULS.shipAssertTag(537170068,0,!1,"CalcHelper.CurrentSheetIndex() - sheet is null"),0)}return this.$.ua.na.index}createParser(){const m=
{};m.config=this.config;return excelOnlineCalc.parse.createParser(m)}createNumberFormatter(){const m=excelOnlineCalc.numfmt.createFormatGlobals(this.config,(t,z)=>excelOnlineCalc.calc.getTime(this.config,t,z,"Estimation"));return excelOnlineCalc.numfmt.createNumberFormatter(m)}Srh(m,t,z,y){if(!y)return{range:{row:t,col:z},sheet:{document:this.documentLoc,index:m}};t=excelOnlineCalc.location.gridCell(t,z);m=excelOnlineCalc.location.sheetIndex(this.documentLoc,m);return excelOnlineCalc.location.sheetGridCell(m,
t)}static NPe(m,t=null){const z=w.Y$b(),y=m.Ef.TrueValueString,D=m.Ef.FalseValueString,H=m.Ef.DecimalSeparator.toString(),F=m.Ef.ListSeparator.toString(),G=m.Ef.ColumnSeparator.toString(),L=m.Ef.RowSeparator.toString(),M=m.Ef.ThousandsDataArray,O=m.Ef.ThousandSeparator.toString(),B=m.Ef.Lcid,E=m.Ef.Country,I=m.Ef.DigitsNumber,S=m.Ef.ExpSeparatedBySpace,J=m.Ef.FractionSeparator.toString(),K=m.Ef.PercentSeparatedBySpace,R=v.a.Ibh(Enum.toString(e,m.Ef.CurrencyFormat)),Z=m.Ef.CurrencySymbolLead,P=m.Ef.CurrencySeparatedBySpace,
V=m.Ef.CurrencySymbolString,Ea=m.Ef.DigitsCurrency,oa=-1===m.Ef.DateOrder?"MDY":x.e(Enum.toString(f,m.Ef.DateOrder)),ea=m.Ef.DateSeparator.toString(),aa=m.Ef.DateAlternativeSeparator.toString(),ia=m.Ef.Year4Digits,ya=m.Ef.Month2Digits,za=m.Ef.Day2Digits,la=m.Ef.LongDateFormat,xa=m.Ef.TimeSeparator.toString(),wa=m.Ef.TimeAltSeparator,hb=m.Ef.Hour2Digits,Ja=m.Ef.Use24HourClock,Fa=m.Ef.AmPmSeparatedBySpace,Ba=[m.Ef.AmString,m.Ef.PmString],fa=m.Ef.DayNameShortArray,ta=m.Ef.DayNameLongArray,Oa=m.Ef.MonthNameShortArray,
Ma=m.Ef.MonthNameLongArray,fb=m.Ef.PictureSpecialArray,pa=b.a.map(("\x00"+m.Ef.PictureSingleString).split(""),ob=>"\x00"===ob?null:ob),Ua=m.Ef.PictureColorArray,Sa=m.Ef.PictureDbnumArray,Ia=m.Ef.RowLetter.toString(),X=m.Ef.ColumnLetter.toString(),ca=m.Ef.LeftBrace.toString(),U=m.Ef.RightBrace.toString(),ma=m.Ef.LeftBracket.toString(),ra=m.Ef.RightBracket.toString(),Va=w.yfi(m.Ef);return excelOnlineCalc.calc.localeData(t,z,y,D,Ia,X,ca,U,ma,ra,H,F,G,L,M,O,B,E,I,S,J,K,R,Z,P,V,Ea,oa,ea,aa,ia,ya,za,la,
xa,wa,hb,Ja,Fa,Ba,fa,ta,Oa,Ma,fb,pa,Ua,Sa,Va,m.Ef.SysDateFormatString,m.Ef.SysTimeFormatString)}static yPe(m){const t=[];if(!m)return t;for(const z of m)m=null,z.IsDynamicUdf||(m=excelOnlineCalc.calc.worksheetFunctionName(z.FunctionIndexInServer,z.NameUI)),m&&t.push(m);return t}static Y$b(){const m=[],t=Object.keys(d.a.errorNames);for(let z=0;z<t.length;z++){const y=excelOnlineCalc.calc.errorTypeName(z+1,t[z]);y&&m.push(y)}return m}static yfi(m){const t=Array(6);t[1]="#"+m.AllStructRefString;t[3]=
"#"+m.HeadersStructRefString;t[2]="#"+m.DataStructRefString;t[4]="#"+m.TotalsStructRefString;t[5]="#"+m.ThisRowStructRefString;return t}}Object(r.a)(w,"CalcHelper",null,[])},997:function(r,C,a){a.r(C);r=a(118);var c=a(0),b=a(15),e=a(6),f=a(92),d=a(31),h=a(145),l=a(274),k=a(42),u=a(86),v;(function(ia){ia[ia.unableToRefreshLock=0]="unableToRefreshLock";ia[ia.unableToRefreshLockExpected=1]="unableToRefreshLockExpected";ia[ia.workbookAlmostTooLarge=2]="workbookAlmostTooLarge";ia[ia.workbookTooLarge=3]=
"workbookTooLarge";ia[ia.externalWorkbookLinksDisabled=4]="externalWorkbookLinksDisabled";ia[ia.externalWorkbookLinksShowError=5]="externalWorkbookLinksShowError";ia[ia.editAndRefreshDisabledOnBIAHostedFiles=6]="editAndRefreshDisabledOnBIAHostedFiles";ia[ia.unsupportedFeatures=7]="unsupportedFeatures";ia[ia.collabDataAndDataStringsLocaleMismatch=8]="collabDataAndDataStringsLocaleMismatch";ia[ia.collabDataStringsLocaleMismatch=9]="collabDataStringsLocaleMismatch";ia[ia.collabDataLocaleMismatch=10]=
"collabDataLocaleMismatch";ia[ia.lastGenericStatusError=11]="lastGenericStatusError";ia[ia.scratchPadWarning=12]="scratchPadWarning";ia[ia.authenticationLost=13]="authenticationLost";ia[ia.odfCompatibilityIssues=14]="odfCompatibilityIssues";ia[ia.pivotChartInteractivityMissingWarning=15]="pivotChartInteractivityMissingWarning";ia[ia.workbookIsIrmProtected=16]="workbookIsIrmProtected";ia[ia.biFeatureNotAvailable=17]="biFeatureNotAvailable";ia[ia.anonymousCreateSaveWarning=18]="anonymousCreateSaveWarning";
ia[ia.unsupportedInteractiveReportEditing=19]="unsupportedInteractiveReportEditing";ia[ia.mobileAppCampaignBizBar=20]="mobileAppCampaignBizBar";ia[ia.transientServerCommunicationFailures=21]="transientServerCommunicationFailures";ia[ia.editAttemptInReadOnly=22]="editAttemptInReadOnly";ia[ia.editAttemptInReadOnlyNoEditPermissions=23]="editAttemptInReadOnlyNoEditPermissions";ia[ia.unsupportedBrowser=24]="unsupportedBrowser";ia[ia.readOnlyPermissions=25]="readOnlyPermissions";ia[ia.documentIsIrmProtectedWarning=
26]="documentIsIrmProtectedWarning";ia[ia.policyWarningMessage=27]="policyWarningMessage";ia[ia.workingOnIt=28]="workingOnIt";ia[ia.passwordProtectedWorkbookLockedForEdit=29]="passwordProtectedWorkbookLockedForEdit";ia[ia.workbookIsReadOnlyRecommended=30]="workbookIsReadOnlyRecommended";ia[ia.workbookHasPasswordToModify=31]="workbookHasPasswordToModify";ia[ia.legacySharedWorkbookEditWarningBB=32]="legacySharedWorkbookEditWarningBB";ia[ia.legacyConnectionsBB=33]="legacyConnectionsBB";ia[ia.tooManyLoadBlockingFloatingObjectsBB=
34]="tooManyLoadBlockingFloatingObjectsBB";ia[ia.groupedSlicersBB=35]="groupedSlicersBB";ia[ia.thirdPartyAddinDisabled=36]="thirdPartyAddinDisabled";ia[ia.financeLinkedEntityDisclaimerBar=37]="financeLinkedEntityDisclaimerBar";ia[ia.wolframDeprecationAlertBar=38]="wolframDeprecationAlertBar";ia[ia.wacGdprNotice=39]="wacGdprNotice";ia[ia.automaticSensitivityLabel=40]="automaticSensitivityLabel";ia[ia.recommendedSensitivityLabel=41]="recommendedSensitivityLabel";ia[ia.mandatorySensitivityLabel=42]=
"mandatorySensitivityLabel";ia[ia.localStorageDisabled=43]="localStorageDisabled";ia[ia.autoRefreshDisabled=44]="autoRefreshDisabled";ia[ia.corruptedFileRepaired=45]="corruptedFileRepaired";ia[ia.corruptedOdsFileRepaired=46]="corruptedOdsFileRepaired";ia[ia.minorVersionLimitReached=47]="minorVersionLimitReached";ia[ia.sensitivityApplicationGenericError=48]="sensitivityApplicationGenericError";ia[ia.sensitivityApplicationTooLargeFileError=49]="sensitivityApplicationTooLargeFileError";ia[ia.sensitivityApplicationLabelNotSupportedError=
50]="sensitivityApplicationLabelNotSupportedError";ia[ia.sensitivityApplicationLabelDisabledError=51]="sensitivityApplicationLabelDisabledError";ia[ia.sensitivityApplicationMandatoryConflictError=52]="sensitivityApplicationMandatoryConflictError";ia[ia.sensitivityApplicationMinorVersionLimitReachedError=53]="sensitivityApplicationMinorVersionLimitReachedError";ia[ia.sensitivityApplicationSetLabelError=54]="sensitivityApplicationSetLabelError";ia[ia.promptEnableExternalLinks=55]="promptEnableExternalLinks";
ia[ia.networkDown=56]="networkDown";ia[ia.defaultToViewDueToCogs=57]="defaultToViewDueToCogs";ia[ia.refreshLinkedEntityErrorBar=58]="refreshLinkedEntityErrorBar";ia[ia.promptEnableLinkedEntitiesUntrustedImages=59]="promptEnableLinkedEntitiesUntrustedImages";ia[ia.canvasHealth=60]="canvasHealth";ia[ia.mismatchedFileFormatConverted=61]="mismatchedFileFormatConverted";ia[ia.optimizeWorkbook=62]="optimizeWorkbook";ia[ia.novModePostDepreciation=63]="novModePostDepreciation";ia[ia.officeScriptsRunning=
64]="officeScriptsRunning";ia[ia.powerQueryRefreshDataSourceNotSupported=65]="powerQueryRefreshDataSourceNotSupported";ia[ia.readOnlyPivotTable=66]="readOnlyPivotTable";ia[ia.powerQueryRefreshHostNotSupported=67]="powerQueryRefreshHostNotSupported";ia[ia.refreshPageAfterEnablingTheExtension=68]="refreshPageAfterEnablingTheExtension";ia[ia.msFormsDataSyncStatus=69]="msFormsDataSyncStatus";ia[ia.dataCleansingSuggestions=70]="dataCleansingSuggestions";ia[ia.editInMiniWAC=71]="editInMiniWAC";ia[ia.powerQueryUnsupportedTeams=
72]="powerQueryUnsupportedTeams";ia[ia.powerQueryEnableThirdPartyCookies=73]="powerQueryEnableThirdPartyCookies";ia[ia.count=74]="count"})(v||(v={}));Object(c.b)("EwaBusinessBarEntryType",v);var x=a(7),w=a(1096);class m extends Sys.EventArgs{constructor(ia,ya,za=null){super();this.h3a=ia;this.hed=ya;this.data=za}}Object(c.a)(m,"BusinessBarEntryDisplayChangedEventArgs",Sys.EventArgs,[]);var t=a(1099),z=a(1097),y=a(1101);a(1100);var D=a(1094),H=a(485),F=a(52),G=a(40),L=a(668),M=a(34),O=a(1),B=a(23),
E=a(19),I=a(65),S=a(77),J=a(949),K=a(30),R=a(43),Z=a(149),P=a(35),V=a(1098),Ea=a(100);a.d(C,"BusinessBarManager",function(){return aa});var oa;const ea=[55,39,5,30,16,14,7,41,4,37,71];let aa=oa=class extends u.a{constructor(ia,ya=!ia.T0){super();this.Ta=new k.a;this.oR=null;this.XPc=[];this.$tc=()=>{this.$.qa.CPa?this.removeEntry(13):this.oh(13,null)};this.ei=(za,la)=>{for(let xa=0,wa=oa.fjc().length;xa<wa;xa++)za=oa.fjc()[xa],this.removeEntry(za);la.context&&0<la.context.communicationErrorRetryCount&&
(b.ULS.sendTraceTag(537170240,0,50,"OnWebMethodSuccess: retry due to previous communication failure succeeded, turning off the TransientServerCommunicationFailures business bar"),this.removeEntry(21));this.tBj()};this.Fn=(za,la)=>{var xa;za=this.GSh(la.errors);let wa=[];for(let Ja=0,Fa=za.length;Ja<Fa;++Ja){const Ba=za[Ja];if(1===Ba.Type&&Ba.Appearance&32)wa=this.ani(Ba,wa);else if(la.nLj){b.ULS.sendTraceTag(537170210,0,50,"OnWebMethodError: Server communication failure detected, turning on the TransientServerCommunicationFailures business bar");
var hb=(null===(xa=la.context)||void 0===xa?0:xa.stopwatch)?la.context.stopwatch.vd:-1;5E3>hb?b.ULS.sendTraceTag(537170208,0,50,`OnWebMethodError:  communication errors duration is below the min time for notification, skipping raise of business bar (duration = ${hb}ms).`):e.AFrameworkApplication.FIi()||this.LVg(Ba,la.context.methodName)}hb=[...oa.fjc()];for(let fa=0,ta=wa.length;fa<ta;++fa){const Oa=wa[fa];this.oh(Oa,Ba);Array.remove(hb,Oa)}for(let fa=0,ta=hb.length;fa<ta;++fa)this.removeEntry(hb[fa])}};
this.Md=(za,la)=>{this.kd(za,la)};this.kd=()=>{const za=this.$.ea;za.Oc||za.Ag()||(this.BRd(),this.XPc.length=0)};this.ee=(za,la)=>{this.$.ea.Ag()&&!la.oX||this.smf(la.oX)};this.KLb=()=>{const za=this.$.userOperationManager.Qic();za&&za.operation.flags&1&&this.Iig()};this.bNf=()=>{this.Iig()};this.rg=()=>{this.kJe();this.Qig()};this.fP=()=>{if(this.$.Y7&&this.$.ea.Ag()&&this.$.ea.Oc)if(this.$.ea.isEditMode)this.removeEntry(45),this.removeEntry(12),this.removeEntry(29),this.removeEntry(30),this.removeEntry(31),
this.removeEntry(32),this.removeEntry(34),this.removeEntry(22),this.removeEntry(57);else{const za=this.$.da.Ba(331);za&&za.TMa||this.removeEntry(55);this.removeEntry(5)}};this.$=ia;this.a2a=ya;this.q3g();e.AFrameworkApplication.qe&&e.AFrameworkApplication.qe.V1c(this);this.TIa=Array(74);for(let za=0;74>za;za++)this.TIa[za]=null;this.vi=L.EcmaDateClock.instance;this.ixf=this.vi.Mc.getTime();ya&&(ya=ia.qa,ya.Qy(this.Fn),ya.Bs(this.ei),ya.csb(this.$tc),ya.x1a(this.$tc),ia.ea.Mk(this.Md),ia.ea.wv(this.rg),
ia.$l(this.ee),ia.ik(this.kd),ia.ea.c5(this.fP),ia.userOperationManager.zs(this.KLb),O.EwaSettings.ya(158)&&ia.ea.Dh.get(45)&&e.AFrameworkApplication.fa.ra("SupportsPolicies")||this.pif(),this.smf(I.c(ia)));ia.da.Ja(5,this);K.a.Bab()&&(this.$.ISb=this.ezi())}pif(){M.a.Iq(this.$.ea.jH)&&this.Fn(this,new H.a(this.$.ea.jH,null,!1,-1,-1,-1,-1,"",-1,"",-1))}pWg(ia){this.Ta.addHandler("bBarAttachedOrDetached",ia)}get pfd(){return this.XPc}get domElement(){return this.oR?this.oR.domElement:null}dispose(){if(this.$){const ia=
this.$,ya=ia.qa;ya.Rz(this.Fn);ya.Wt(this.ei);ya.Tzc(this.$tc);ya.vOb(this.$tc);ia.ea.Vk(this.Md);ia.ea.hx(this.rg);ia.hn(this.ee);ia.Wl(this.kd);ia.ea.O9(this.fP);ia.userOperationManager.fp(this.KLb);E.h(ia).Gc.io(this.bNf)}f.a.Ka(this.oR);this.$=this.oR=null;super.dispose()}ezi(){for(let ia=0;ia<ea.length;ia++)if(this.TIa[ea[ia]])return!0;return!1}Izi(ia){switch(ia){case 4:case 5:case 11:case 55:case 59:case 7:case 37:case 38:case 71:return!0;default:return!1}}oh(ia,ya,za=null,la=null,xa=null){if(!this.$.isMobileMode||
this.Izi(ia))this.a2a&&!this.gG(ia)&&(this.TIa[ia]=this.vi.yha,this.oR.LD(ia,ya,la,xa),K.a.Bab()&&this.Hdk(ia),this.Ta.raiseEvent("bBarAttachedOrDetached",new m(ia,!0,za))),ya&&32===ya.Appearance&&S.a(this.$).$d.Xea(ya)}kYj(ia,ya,za,la){b.ULS.sendTraceTag(537170253,0,50,"BusinessBar.ShowGdprPrivacyNotice: Called");D.a.initialize(ia,ya,za,la);this.oh(39,null)}kXj(ia,ya,za,la){w.a.initialize(ia,ya,za,la);this.oh(40,null)}sZj(ia,ya,za,la){z.a.initialize(ia,ya,za,la);this.oh(41,null)}IXj(ia,ya,za,la){V.a.initialize(ia,
ya,za,la);this.oh(70,null)}IYj(ia,ya,za,la){t.a.initialize(ia,ya,za,la);this.oh(42,null)}yZj(ia,ya,za,la){y.a.initialize(ia,ya,za,la);this.oh(54,null)}removeEntry(ia){this.a2a&&(O.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&b.ULS.sendTraceTag(537170251,0,50,`Removing entry from BB: ${Enum.toString(v,ia)}`),this.TIa[ia]=null,this.oR.removeEntry(ia)&&this.Ta.raiseEvent("bBarAttachedOrDetached",new m(ia,!1)))}Ena(ia){return this.a2a?this.oR.Ena(ia):!1}gG(ia){return this.a2a?
this.oR.gG(ia):!1}FJb(){b.ULS.sendTraceTag(537170248,0,50,"Network disconnect notification received from the app")}otc(){b.ULS.sendTraceTag(537170247,0,50,"Network resumed notification received from the app, turning off the TransientServerCommunicationFailures business bar");this.removeEntry(21)}q3g(){const {BusinessBarControl:ia}=a(1203);if(this.a2a&&!this.oR){E.h(this.$).Gc.ro(this.bNf);var ya=document.getElementById(this.$.qc+x.a.kGe);this.oR=new ia(this.$,ya)}}BRd(){this.a2a&&this.oR.BRd()}Hdk(ia){0<=
ea.indexOf(ia)&&!this.$.ISb&&(this.$.ISb=!0,this.$.s7b=ia,this.$.L3c&&this.Hcg(!0))}tBj(){if(O.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")){const ya=this.vi.yha;if(3E5<=ya-this.ixf){this.ixf=ya;for(let za=0;74>za;za++){var ia=this.TIa[za];if(ia&&(ia=ya-ia,3E5<=ia)){const la=Enum.toString(v,za);b.ULS.sendTraceTag(537170241,0,50,`${"OnWebMethodSuccess"}: entry [${la}] was activated but not turned off for ${ia} Millis`)}}}}}GSh(ia){const ya=[];for(const za of ia)switch(za.MessageId){case -113742550:const la=
[757111532,2113407564,1393475740,1911608588,104919273,-689453604,157762400,-949523941];(this.$.ea.isNamedObjectViewMode||M.a.Ph(ia,la))&&ya.push(-113742550)}return M.a.hB(ia,ya)}ani(ia,ya){switch(ia.MessageId){case 2113407564:const za=M.a.d3a([1821390342,-943219229,-502303485,1437034227]);for(let la=0;la<za.length;la++)za[la].HelpTopicId=ia.HelpTopicId,za[la].HelpDescription=ia.HelpDescription,this.XPc.push(za[la])}switch(ia.MessageId){case -395951567:this.oh(6,ia);break;case 1643490758:this.oh(4,
ia);break;case -907264831:this.oh(5,ia);break;case 757111532:case 2113407564:this.oh(7,ia);break;case 2010656511:this.oh(15,ia);break;case 1321660996:this.$.Jcd=!0;this.oh(8,ia);break;case 526339737:this.$.Jcd=!0;this.oh(9,ia);break;case -407088521:this.oh(10,ia);break;case 1756116017:this.oh(14,ia);break;case -1703455218:this.oh(17,ia);break;case 1393475740:this.oh(25,ia);break;case -949523941:this.oh(26,ia);break;case 1779381952:this.oh(44,ia);break;case 1421575100:this.oh(45,ia);break;case 613676060:this.oh(46,
ia);break;case 1233668252:this.oh(61,ia);break;case 1911608588:ia=!!(this.$.oe&64);!this.$.ea.Ag()&&ia&&ya.push(29);break;case 1544494907:break;case -655555355:ya.push(this.cAd()?1:0);break;case -1221382671:ya.push(2);break;case 1662282929:ya.push(3);break;case 104919273:this.$.ea.Ag()||ya.push(30);break;case -689453604:ia=!!(this.$.oe&64);this.$.ea.Ajf=!0;!this.$.ea.Ag()&&ia&&ya.push(31);break;case 157762400:this.$.ea.Hnc=!0;!this.$.ea.Ag()&&this.$.oe&64&&!this.$.isEditMode&&ya.push(32);break;case -1125398042:O.EwaSettings.isChangeGateEnabled("OfficeVSO:7812191_CleanLoadBlockingFloatingObjects")&&
!this.$.ea.Ag()&&this.$.oe&64&&!this.$.isEditMode&&ya.push(34);break;case -73730134:!this.$.ea.Ag()&&this.$.oe&64&&ya.push(33);break;case -293349236:ya.push(65);break;case 1580811823:ya.push(67);break;case -37299333:break;case 136737622:ya.push(47);break;case -1780327030:this.oh(55,ia);break;case -113742550:this.oh(57,ia);break;case -260312420:this.$.ea.Ag()||ya.push(66);break;case 784737213:this.$.ea.Ag()||ya.push(70);break;default:this.oh(11,ia)}return ya}Fti(){if(e.AFrameworkApplication.fa.ra("WildFireExcelBizBar")&&
!J.a.vEi(J.a.t8e(1))&&(d.a.Vo||d.a.Fh)){const ia=O.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateCommonUiStrings",!1)?Object(Ea.d)(Z.a.resolve(P.p,{Wa:1})):F.GetServiceTaskFactory.create(this.$.da,155,this.$.ka,1);G.TaskExtensions.za(ia,()=>{this.oh(20,null)},this.ka,3)}}Zsi(ia){ia||3!==this.$.workbookContext.WorkbookNovType||this.oh(63,null)}smf(ia){(!ia&&!this.$.printingEnabled||this.$.Xe.get(1))&&this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription&&(b.ULS.sendTraceTag(537170205,
0,50,"BusinessBar.InitBusinessBar: Adding bisinessBar for irm protection."),this.oh(16,null));this.Fti();this.kJe();this.Qig();this.Zsi(ia)}kJe(){this.$.workbookContext.Options&32768&&this.$Xj()}$Xj(){this.TIa[37]||this.oh(37,null)}d_j(){this.TIa[38]||this.oh(38,null)}Qig(){this.$.workbookContext.Options&524288&&this.oh(59,null)}pjg(ia,ya){this.oh(58,ia,null,ya)}Owe(ia,ya=null){this.oR.gG(ia)?this.oR.JUb(ia,ya):this.oh(ia,null,null,null,ya)}Iig(){this.$.oe&8&&this.oh(12,null)}cAd(){const ia=this.$.da.Ba(38);
return ia?ia.tokenExpired:!1}LVg(ia,ya){if(!this.gG(21)&&-1387426400!==ia.MessageId){b.ULS.sendTraceTag(537170204,0,50,"BusinessBar: raising the transient communication failures notification.");const za={};za.FailedMethod=ya;this.oh(21,ia,za)}}static fjc(){return oa.jAe||(oa.jAe=[0,1,2,3])}Hcg(ia){try{const la=h.a.get(x.a.bMd);if(B.a.Gh(la))b.ULS.sendTraceTag(509682970,0,50,"BusinessBarManager.setBusinessBarFlagInCookie: Can't find skeleton cookie eventough alreadyDefinedSkeletonCookie = true. Set page load skeleton cookie."),
this.$.AYd();else{var ya=R.a(decodeURIComponent(la)),za=ya.Options;ya.Options=ia?za|4096:~(~za|4096);try{const xa=R.c(ya);h.a.$t(x.a.bMd,xa,l.AFrame.tQ);b.ULS.sendTraceTag(509686989,0,50,"BusinessBarManager.setBusinessBarFlagInCookie: Business bar flag in PageLoadSkeletonState cookie has been raised");h.a.$t(x.a.t7b,this.$.s7b.toString(),l.AFrame.tQ)}catch(xa){b.ULS.sendTraceTag(509686988,0,50,`BusinessBarManager.setBusinessBarFlagInCookie: Failed setting PageLoadSkeletonState cookie with error message: ${xa.message}`)}}}catch(la){b.ULS.sendTraceTag(509686987,
0,50,`BusinessBarManager.setBusinessBarFlagInCookie: exception while parsing PageLoadSkeletonCookie. Message: ${la.message}`)}}Cld(ia){return this.oR.Cld(ia)}};aa.jAe=null;aa=oa=Object(r.b)([Object(Z.d)(P.h),Object(r.c)(0,Object(P.E)())],aa);Object(c.a)(aa,"BusinessBarManager",u.a,[519,2,80])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSOpt.pi.js.map/e48862309a8db8b366ee64625c110933/EwaDSOpt.pi.js.map