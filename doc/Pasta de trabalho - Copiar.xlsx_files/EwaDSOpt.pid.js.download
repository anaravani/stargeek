'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[9],{1182:function(r,C,a){a.d(C,"a",function(){return h});r=a(0);C=a(754);var c=a(1),b=a(75),e=a(91),f=a(275),d=a(16);class h extends C.a{constructor(l){super(l,h.QNi,d.a.instance.Ha(650),d.a.instance.Ha(652),d.a.instance.Ha(648),d.a.instance.Ha(649),3072,10,new f.a)}WVj(){return this.RDa()}get eY(){return"[data-unique-id=Review]"}get dY(){return"[data-unique-id=pivotOverflowButton]"}get yX(){return'[id="'+this.$.qc+
'Ribbon.Review-title"]'}get VXf(){return!1}get ribbonCommandInfo(){return new e.a(1834994092,b.a.fc,this.$.Tc,9,null)}get Moa(){return c.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.LineageDiscoverabilityCalloutDisplayLimit",3)}MNa(){return 3}fmd(){return 86400}sza(){return this.$.ea.zbb}}h.QNi="LineageDiscoverabilityCallout";Object(r.a)(h,"LineageDiscoverabilityCallout",C.a,[309])},1221:function(r,C,a){var c=a(10);r=a(0);var b=a(15),e=a(230),f=a(52),d=a(40),h=a(2),l=a(173),k=a(748),u=a(728);
class v extends k.a{constructor(){super();this.hasMergedcells=this.tableName=this.interpretations=this.range=null;this.H_=Object.assign(new u.a,{T_:v.getTypeName(),B_:v.we()})}static getTypeName(){return"AugLoop_ExcelTableAi_ExcelRecognizedTableNew"}static we(){return["AugLoop_Core_Annotation"]}}Object(r.a)(v,"ExcelRecognizedTableNew",k.a,[]);class x extends v{constructor(){super();this.requestId=null;this.H_=Object.assign(new u.a,{T_:x.getTypeName(),B_:x.we()})}static getTypeName(){return"AugLoop_ExcelTableai_ExcelRangeMetadata"}static we(){return["AugLoop_ExcelTableAi_ExcelRecognizedTableNew",
"AugLoop_Core_Annotation"]}}Object(r.a)(x,"ExcelRangeMetadata",v,[]);k=a(1359);class w extends k.a{constructor(){super();this.value=null;this.type=0;this.H_=Object.assign(new u.a,{T_:w.getTypeName(),B_:w.we()})}static getTypeName(){return"AugLoop_ExcelTableai_ExtendedExcelCell"}static we(){return["AugLoop_Excel_ExcelCell","AugLoop_Core_GridCell"]}}Object(r.a)(w,"ExtendedExcelCell",k.a,[]);k=a(865);class m extends k.a{constructor(){super();this.mergeCellAddresses=this.requestId=this.cells=this.range=
null;this.H_=Object.assign(new u.a,{T_:m.getTypeName(),B_:m.we()})}static getTypeName(){return"AugLoop_ExcelTableai_RangeDataSignal"}static we(){return["AugLoop_Signals_Signal"]}}Object(r.a)(m,"RangeDataSignal",k.a,[]);var t=a(1125),z=a(106);k=a(42);var y=a(1),D=a(23),H=a(19);class F extends Sys.EventArgs{constructor(xa){super();this.ENb=xa}}Object(r.a)(F,"RecognizedTableUpdateEventArgs",Sys.EventArgs,[]);var G=a(198),L=a(25),M=a(354);class O{constructor(xa,wa,hb,Ja,Fa){this.XB=xa;this.interpretations=
wa;this.tableName=hb;this.id=Ja;this.ujf=Fa}}Object(r.a)(O,"RecognizedTable",null,[]);class B{constructor(xa,wa,hb){this.classification=xa;this.aggregations=wa;this.headerReferences=hb}}Object(r.a)(B,"TableField",null,[]);var E=a(1126);const I=xa=>{var wa=new M.a(S(xa.range),xa.range.worksheetId);var hb=xa.interpretations;var Ja=new G.a;if(hb&&hb.length)for(const X of hb){b:switch(X.orientation.toLowerCase()){case "columnmajor":hb=2;break b;case "rowmajor":hb=1;break b;default:b.ULS.sendTraceTag(537151256,
0,50,"Invalid value for table orientaion."),hb=0}const ca=hb;if(0===ca)b.ULS.sendTraceTag(537151257,0,50,"Invalid value for table orientaion. Skipping current interpretation.");else{hb=E.a;var Fa=S(X.location),Ba=X.confidence,fa=X.headerRowCount,ta=X.headerColumnCount;var Oa=X.fields;var Ma=new G.a;if(Oa)for(const U of Oa){Oa=Ma;var fb=Oa.add;c:switch(U.classification.toLowerCase()){case "dimension":var pa=1;break c;case "measure":pa=2;break c;default:b.ULS.sendTraceTag(537151255,0,50,"Invalid value %s for field classification."),
pa=0}var Ua=U.aggregations;var Sa=new G.a;if(Ua)for(const ma of Ua)switch(ma.toLowerCase()){case "sum":Sa.add(0);break;case "count":Sa.add(1);break;case "average":Sa.add(2);break;case "min":Sa.add(3);break;case "max":Sa.add(4);break;case "distinctcount":Sa.add(5);break;case "stddev":Sa.add(6);break;case "variance":Sa.add(7);break;default:b.ULS.sendTraceTag(537151254,0,50,"Invalid value for aggregation type.")}Ua=Sa;var Ia=U.headerReferences;Sa=new G.a;if(Ia)for(const ma of Ia)Ia=new L.Range(ma.top,
ma.left,ma.top,ma.left,!1,!1),Sa.add(Ia);fb.call(Oa,new B(pa,Ua,Sa))}hb=new hb(Fa,Ba,fa,ta,ca,Ma);Ja.add(hb)}}return new O(wa,Ja,xa.tableName,xa.id,xa.hasMergedcells)},S=xa=>new L.Range(xa.top,xa.left,xa.bottom,xa.right,!1,!1);var J=a(993);class K{constructor(xa,wa){this.PKc=0;this.Qz=new Map;this.gvd=!1;this.tableIntelligenceManager=xa;this.augmentationLoopManager=wa;y.EwaSettings.isChangeGateEnabled("OfficeVSO:7748219_LogE2ELatency")&&(this.Xcc=new J.a("WebServiceCall","TableIntelligenceQueryManagerE2ELatency"),
this.Xcc.start(),this.EGc=!0);this.tableIntelligenceManager.s1a("Valid",this.dej.bind(this));this.tableIntelligenceManager.s1a("Invalid",this.E8i.bind(this));y.EwaSettings.isChangeGateEnabled("OfficeVSO:7408706_QueryManagerCoauthVersionChecking")&&this.augmentationLoopManager.dwe(this.U2i.bind(this))}l8a(xa,wa,hb){if(!this.Qz)return b.ULS.sendTraceTag(521025344,306,10,"Recognized table is null"),[];let Ja=wa;y.EwaSettings.isChangeGateEnabled("OfficeVSO:7408706_QueryManagerCoauthVersionChecking")&&
void 0!==hb&&this.PKc>hb&&(b.ULS.sendTraceTag(509681793,306,50,`getRecognizedTables: maxRevisions: ${hb}, versionChanges: ${this.PKc}`),Ja=wa^4);return this.Qz.has(xa.sheetId)?(wa=this.Qz.get(xa.sheetId).filter(Fa=>Fa.table.XB.range.Yd(xa.range)&&(Ja&Fa.fJb)==Fa.fJb),b.ULS.sendTraceTag(509681792,306,50,`getRecognizedTables: foundRecords: ${wa.length}`),wa):[]}dej(xa,wa){if(this.Qz){if(!this.gvd){y.EwaSettings.isChangeGateEnabled("OfficeVSO:7748219_LogE2ELatency")&&this.EGc&&(this.Xcc.stop(),b.ULS.sendTraceTag(509089223,
0,15,"Elapsed time since annotation invalidation: {0}",this.Xcc.vd),this.EGc=!1);for(const [hb,Ja]of this.Qz)Ja.every(Fa=>4===Fa.fJb)?this.Qz.delete(hb):this.Qz.set(hb,Ja.filter(Fa=>4!==Fa.fJb));this.gvd=!0}xa=wa.ENb;this.Qz.has(xa.XB.sheetId)||this.Qz.set(xa.XB.sheetId,[]);this.Qz.get(xa.XB.sheetId).push({table:xa,fJb:2});this.PKc=0}else b.ULS.sendTraceTag(521025315,306,10,"Recognized table is null")}E8i(xa,wa){this.gvd=!1;y.EwaSettings.isChangeGateEnabled("OfficeVSO:7748219_LogE2ELatency")&&!this.EGc&&
(this.Xcc.start(),this.EGc=!0);xa=wa.ENb;if(this.Qz)if(this.Qz.has(xa.XB.sheetId))for(const hb of this.Qz.get(xa.XB.sheetId))hb.table.id===wa.ENb.id&&(hb.fJb=4);else b.ULS.debugAssertTag(522981602,306,!1,"No recognized tables for sheet");else b.ULS.sendTraceTag(521025314,306,10,"Recognized table is null")}U2i(){this.PKc++}}Object(r.a)(K,"TableIntelligenceQueryManager",null,[389]);class R{}Object(r.a)(R,"RecognizedTableLog",null,[]);class Z{}Object(r.a)(Z,"Interpretation",null,[]);class P{constructor(xa){this.Qz=
new Map;this.H5b=void 0;this.Rsb=new Set;this.qKb=void 0;this.tableIntelligenceManager=xa}wAg(){this.qKb?b.ULS.shipAssertTag(522303246,306,!1,"LogXlimRecognizedTables should not be called twice."):(this.qKb=this.pKb.bind(this),this.tableIntelligenceManager.s1a("Valid",this.qKb))}JRi(xa){xa=this.xY(xa);b.ULS.sendTraceTag(521233111,306,15,`${JSON.stringify(xa)}`)}pKb(xa,wa){xa=wa.ENb;y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(this.Rsb&&this.Qz?(this.Rsb.has(xa.id)||
(this.FVg(xa),this.Rsb.add(xa.id)),this.H5b||(this.H5b=window.setTimeout(this.h9.bind(this),2E3))):b.ULS.sendTraceTag(522303245,306,15,`AnnotationId set or recognized table store is null. annotationIdSet = ${!!this.Rsb}, recognizedTableStore = ${!!this.Qz}`))}h9(){for(const [,xa]of this.Qz)b.ULS.sendTraceTag(521233110,306,15,JSON.stringify(xa));window.clearTimeout(this.H5b);this.Rsb=this.H5b=void 0;this.Qz.clear();this.Qz=void 0;this.tableIntelligenceManager.hxj(this.qKb);this.qKb=void 0}FVg(xa){const wa=
xa.XB.sheetId;this.Qz.has(wa)||this.Qz.set(wa,[]);this.Qz.get(wa).push(this.xY(xa))}xY(xa){const wa=[];for(const hb of xa.interpretations){let Ja=0,Fa=0;for(const Ba of hb.fields)1===Ba.classification?Ja++:2===Ba.classification&&Fa++;wa.push({confidence:hb.confidence,headerRowCount:hb.headerRowCount,headerColumnCount:hb.headerColumnCount,orientation:hb.orientation,measureCount:Fa,dimensionCount:Ja})}return{interpretations:wa,range:{top:xa.XB.range.top,bottom:xa.XB.range.bottom,left:xa.XB.range.left,
right:xa.XB.range.right},isTable:!!xa.tableName,annotationId:xa.id}}}Object(r.a)(P,"RecognizedTableLogger",null,[]);class V extends k.a{constructor(xa,wa){super();this.r$a=this.Lqf=!1;this.NAe={};this.instantaneousSupportInformationManager=null;this.xQd=void 0;this.wBf=!1;this.Qnc=y.EwaSettings.isChangeGateEnabled("OfficeVSO:6621453_TableIntelligenceMigrationToNewALAPI");this.c2e=(hb,Ja)=>{var Fa;1===Ja.operationType&&((Ja=Ja.YB)?(b.ULS.sendTraceTag(537151251,306,50,`TableIntelligenceManager::ExcelRangeMetadataHandler called for requestID = ${Ja.requestId}`),
hb=I(Ja),y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(null===(Fa=this.xQd)||void 0===Fa?void 0:Fa.JRi(hb)),({value:Fa}=this.h1d.Ad(Ja.requestId)).returnValue?(this.h1d.remove(Ja.requestId),Fa(hb)):b.ULS.sendTraceTag(537151250,306,10,`TableIntelligenceManager::ExcelRangeMetadataHandler Callback not found for requestId = ${Ja.requestId}`)):b.ULS.sendTraceTag(537151252,306,10,"TableIntelligenceManager::ExcelRangeMetadataHandler excelRangeMetadata is null."))};
this.Sve=(hb,Ja)=>{this.HOd("RecognizedTableUpdate",Ja)};this.augmentationLoopManager=xa;this.$=wa;this.h1d=new z.a;this.$.da.Ja(20,this);y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(this.xQd=new P(this));this.Qnc&&this.augmentationLoopManager.register(this.augmentationLoopManager.v0().S2("TableIntelligence").P2(()=>{}).build())}Dya(){this.lHc||(this.lHc=new K(this,this.augmentationLoopManager));return this.lHc}c$h(xa,wa){if(y.EwaSettings.isChangeGateEnabled("OfficeVSO:6648526_LimitCellsInSignal")&&
1E4<xa.range.Bw)return b.ULS.sendTraceTag(520501002,306,15,`Signal with range size of ${xa.range.Bw} exceeds limit of ${1E4}`),4;this.LRg();if(this.sGi(xa.range))return this.Dci(xa,wa);b.ULS.sendTraceTag(537151253,306,15,"Range is not completely contained within the viewport");return 2}TYg(xa){this.MRg();this.addHandler("RecognizedTableUpdate",xa);this.cnf()}Lzj(xa){this.removeHandler("RecognizedTableUpdate",xa)}Uad(xa){return(wa,hb)=>{this.HOd(this.hsc(xa),hb)}}s1a(xa,wa){var hb,Ja;y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceSheetCountThreshold",
!1)&&(null===(Ja=null===(hb=this.$)||void 0===hb?void 0:hb.ua)||void 0===Ja?0:Ja.count)&&this.$.ua.count>y.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.TableIntelligenceSheetCountThresholdValue",100)?b.ULS.sendTraceTag(520720838,306,15,`TableIntelligenceManager::addRecognizedTableAnnotationCallback Exceeded max sheet count threshold. SheetCount ${this.$.ua.count}`):(this.Qnc?this.r$a||(this.augmentationLoopManager.K9("TableIntelligence",{Tv:!0,annotationType:v.getTypeName(),WO:this.Uad("New"),
Bkb:this.Uad("Valid"),Wlc:this.Uad("Invalid")}),this.r$a=!0):this.NAe[xa]||(this.r$a||(this.augmentationLoopManager.srb(v.getTypeName()),this.r$a=!0),this.augmentationLoopManager.Ssb.Nua(xa,v.getTypeName(),(Fa,Ba)=>this.HOd(this.hsc(xa),Ba)),this.NAe[xa]=!0),this.JUg(xa,wa),this.cnf())}hxj(xa){this.removeHandler(this.hsc("Valid"),xa)}JUg(xa,wa){this.addHandler(this.hsc(xa),wa)}$tj(){y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligence",!1)&&(this.Qnc?this.augmentationLoopManager.K9("TableIntelligence",
{annotationType:v.getTypeName(),Tv:!0,WO:this.Sve}):(this.augmentationLoopManager.srb(v.getTypeName()),this.augmentationLoopManager.Nua(v.getTypeName(),this.Sve)))}Ztj(){this.Qnc?this.augmentationLoopManager.K9("TableIntelligence",{annotationType:x.getTypeName(),Tv:!1,WO:this.c2e}):(this.augmentationLoopManager.srb(x.getTypeName()),this.augmentationLoopManager.Nua(x.getTypeName(),this.c2e))}MRg(){var xa,wa;y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceSheetCountThreshold",
!1)&&(null===(wa=null===(xa=this.$)||void 0===xa?void 0:xa.ua)||void 0===wa?0:wa.count)&&this.$.ua.count>y.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.TableIntelligenceSheetCountThresholdValue",100)?b.ULS.sendTraceTag(520720837,306,15,`TableIntelligenceManager::addRecognizedTableAnnotationCallback Exceeded max sheet count threshold. SheetCount ${this.$.ua.count}`):this.r$a||(this.$tj(),this.r$a=!0)}LRg(){this.Lqf||(this.Lqf=!0,this.Ztj())}HOd(xa,wa){1===wa.operationType&&((wa=wa.YB)?(wa=
I(wa),this.raiseEvent(xa,new F(wa))):b.ULS.sendTraceTag(523772681,306,10,"TableIntelligenceManager::processAndRaiseExcelRecognizedTableAnnotationReceivedEvent ExcelRecognizedTable is null."))}hsc(xa){return`${"RecognizedTableUpdate"}_${xa}`}Dci(xa,wa){b.ULS.sendTraceTag(537151248,306,15,"On-Demand Metadata Triggered");const hb=xa.range,Ja=H.h(this.$).Bj("TableIntelligence",hb,1),Fa=[],Ba=[];let fa=0;const ta=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1),
Oa=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceNumberFormatEnabled",!1);for(Oa&&!this.instantaneousSupportInformationManager&&this.$.da.Qb(268,Ma=>{this.instantaneousSupportInformationManager=Ma});Ja.$$mn();){const Ma=Ja.$$cu();if(!Ma)continue;if(0===Ma.jp.type&&D.a.ar(Ma.jp.value))continue;Ma.UG&&Ma.range&&Ba.push(Object(h.a)(new t.a,{worksheetId:xa.sheetId,left:Ma.range.left-1,top:Ma.range.top-1,right:Ma.range.right-1,bottom:Ma.range.bottom-1}));const fb=Ma.range.top-
1,pa=Ma.range.left-1;let Ua=null,Sa=null;Oa&&({category:Sa}=this.instantaneousSupportInformationManager.Cra(Ma.cell.yi,!0),Ma.text!=Ma.jp.value&&(Ua=Ma.text,ta&&fa++));Fa.push(Object.assign(new w,{row:fb,column:pa,value:Ma.jp.value,type:Ma.jp.type,displayText:Ua,Iok:Sa}))}ta&&b.ULS.sendTraceTag(526260166,306,50,`TableIntelligenceManager::getRangeDataFromGrid requests non-null displayText: ${fa}, number of values: ${Fa.length}, range size: ${hb.height} rows by ${hb.width} columns`);if(0<Fa.length)return this.Xqh(Fa,
xa,Ba,wa),Ba.length?5:0;b.ULS.sendTraceTag(537151247,306,15,"All cells in range were empty");return 3}Xqh(xa,wa,hb,Ja){var Fa=wa.range;Fa=Object(h.a)(new t.a,{top:Fa.top,left:Fa.left,bottom:Fa.bottom,right:Fa.right,worksheetId:wa.sheetId});wa=l.a.create().toString();xa=Object(h.a)(new m,{cells:xa,range:Fa,mergeCellAddresses:hb,requestId:wa});this.augmentationLoopManager.eTb(xa);this.h1d.add(wa,Ja)}sGi(xa){const wa=H.h(this.$);if(y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",
!1)){const hb=wa.mma();b.ULS.sendTraceTag(520501001,306,50,`viewportWidth: ${hb.width}, viewportHeight: ${hb.height}`)}return wa.Ca.nX(4,this.$.na)&&!!wa.tc(xa.topLeft)&&!!wa.tc(xa.bottomLeft)&&!!wa.tc(xa.topRight)&&!!wa.tc(xa.bottomRight)}cnf(){var xa;!this.wBf&&y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(this.wBf=!0,null===(xa=this.xQd)||void 0===xa?void 0:xa.wAg())}}Object(r.a)(V,"TableIntelligenceManager",k.a,[2,373]);var Ea=a(100),oa=a(149),ea=
a(35);class aa extends e.a{constructor(xa){super();this.$=xa;this.uc()}create(){d.TaskExtensions.za(y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateAugmentationLoopToNewServiceInfra",!1)?Object(Ea.d)(oa.a.resolve(ea.f,{Wa:1})):f.GetServiceTaskFactory.Za(this.$.da,328,327,1),xa=>{if(xa=xa.result){let wa=this.$.da.Ba(20);wa||(wa=new V(xa,this.$),this.$.da.Ja(20,wa));this.$b(wa)}else b.ULS.sendTraceTag(537151246,306,10,"AugmentationLoopManager instance null. Can not create TableIntelligenceManager instance. Creating null service event."),
this.$b(null)},this.$.ka,3)}static la(xa){xa.da.Ja(404,new aa(xa))}}Object(r.a)(aa,"TableIntelligenceManagerFactory",e.a,[]);class ia{constructor(xa,wa){this.OAe=!1;this.tableIntelligenceManager=xa;y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableGridHighlights",!1)&&void f.GetServiceTaskFactory.F0(wa.da,510,511,1);this.tableIntelligenceManager.s1a("Valid",()=>{this.OAe||(b.ULS.sendTraceTag(526979921,0,15,"Received annotation with interpretations"),this.OAe=!0)})}}Object(r.a)(ia,
"TableIntelligenceDarkActivationManager",null,[369]);var ya=a(727);class za extends e.a{constructor(xa){super();this.$=xa;this.uc()}static la(xa){xa.da.Ja(481,new za(xa))}create(){const xa=f.GetServiceTaskFactory.Za(this.$.da,20,404,1);d.TaskExtensions.za(xa,()=>{const wa=xa.result,hb=Object(ya.a)(this.$.da,480,()=>new ia(wa,this.$));this.$b(hb)},this.$.ka,3)}}Object(r.a)(za,"TableIntelligenceDarkActivationManagerFactory",e.a,[]);a.d(C,"a",function(){return la});const la=()=>{c.a.Fa(xa=>{aa.la(xa);
za.la(xa)})}},1275:function(r,C,a){r=a(0);var c=a(230),b=a(2),e=a(15),f=a(273),d=a(260),h=a(140),l=a(1066);class k{constructor(H){this.f6c=this.Ojd=null;this.KYa=this.isFocused=!1;this.$=H}dispose(){}get Wc(){return null}get Fg(){return this.KYa}get Qe(){return d.a.HHd}$g(H,F){F||this.isFocused||!this.Ojd||this.Ojd();return!F}ui(H){return H===document.activeElement&&this.isFocused}pk(){this.isFocused=!0}Rk(){this.isFocused&&this.f6c&&(this.f6c(),this.isFocused=!1)}uui(){e.ULS.shipAssertTag(537169939,
0,h.b("initializeNotificationFocusManagement"),"EwaNotificationFocusManager.InitializeFocusActions: initializeNotificationFocusManagement Api doesnt exist in AppChrome");const H=Object(b.a)(new l.a,{onFirstActionableAppear:()=>{f.a(this.$).Zi(this);this.KYa=!0},onLastActionableDisappear:()=>{f.a(this.$).gB(this);this.KYa=!1},onFocus:()=>{this.isFocused=!0},onBlur:()=>{this.isFocused=!1}});appChrome.initializeNotificationFocusManagement(H).then(F=>{this.Ojd=()=>{F.focus()};this.f6c=()=>{F.blur()};
return null})}}Object(r.a)(k,"EwaNotificationFocusManager",null,[277,2,26]);class u extends c.a{constructor(H){super();this.$=H;this.uc()}create(){this.$b(this.$.da.Ba(357)||new k(this.$))}static la(H){H.da.Ja(358,new u(H))}}Object(r.a)(u,"EwaNotificationFocusManagerFactory",c.a,[]);var v=a(1),x=a(1182);class w extends c.a{constructor(H){super();this.$=H;this.uc()}create(){const H=new x.a(this.$);this.$b(this.$.da.Ba(456)||this.$.da.Ja(456,H))}static la(H){H.da.Ja(457,new w(H))}}Object(r.a)(w,"LineageDiscoverabilityCalloutFactory",
c.a,[]);var m=a(724),t=a(981);class z extends m.a{constructor(H){super(H)}dispose(){super.dispose()}ue(){this.Zd([new t.a(this.$)])}static la(H){m.a.Ie(378,new z(H))}}Object(r.a)(z,"ShowCalloutCommandHandlerFactory",m.a,[]);var y=a(10);a.d(C,"a",function(){return D});const D=()=>{y.a.Fa(H=>{v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateServices1",!1)||z.la(H)});y.a.Fa(u.la);y.a.Fa(w.la)}},1276:function(r,C,a){var c=a(10);r=a(0);var b=a(230),e=a(15),f=a(84),d=a(86),h=a(52),l=a(40),
k=a(59);const u=(J,K,R,Z,P,V,Ea=null)=>{Ea=J.Pa(1,Ea);Ea.businessBarMessageType=K;return k.g(J,"EvaluateOptimizableContentV2",Ea,R,Z,P,V,4)},v=(J,K,R,Z,P,V,Ea=null)=>{Ea=J.Pa(1,Ea);Ea.sheetName=K;return k.g(J,"EvaluateSheetOptimizableContent",Ea,R,Z,P,V,4)};var x=a(1),w=a(16),m=a(91),t=a(75),z=a(19),y=a(43),D=a(126);class H{constructor(J,K){this.sessionID=null;this.pUf=R=>{if(R){var Z={};if(({Bt:Z}=y.d(R.data)).returnValue&&(R=Object(D.a)(Object,Z))&&"OptimizeWorkbookTaskPane"===R.Origin)if(this.sessionID!==
R.SessionId)e.ULS.sendTraceTag(509748062,0,10,"OptimizeWorkbookTaskPaneListener.optimizeWorkbookMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");else switch(R.Event){case "Error_LoadBookData":this.optimizeWorkbookManager.UOj();e.ULS.sendTraceTag(509673560,0,50,"OptimizeWorkbookTaskPaneListener.optimizeWorkbookMessageReceivedEventHandler() - Load book data error Event.");break;case "OptimizeTriggered":this.optimizeWorkbookManager.sPj();e.ULS.sendTraceTag(509688027,
0,50,"OptimizeWorkbookTaskPaneListener.optimizeWorkbookMessageReceivedEventHandler() - Optimize Event.");break;case "TriggerFeedback":this.optimizeWorkbookManager.WXj();e.ULS.sendTraceTag(509748061,0,50,"OptimizeWorkbookTaskPaneListener.optimizeWorkbookMessageReceivedEventHandler() - Feedback Event.");break;default:e.ULS.sendTraceTag(509748060,0,10,"OptimizeWorkbookTaskPaneListener.optimizeWorkbookMessageReceivedEventHandler() - Unhandled Event.")}}};this.optimizeWorkbookManager=J;this.sessionID=
K}initialize(){window.addEventListener("message",this.pUf,!1)}dispose(){window.removeEventListener("message",this.pUf,!1)}}Object(r.a)(H,"OptimizeWorkbookTaskPaneListener",null,[]);var F=a(7),G=a(72),L=a(100),M=a(149),O=a(35);class B extends d.a{constructor(J){super();this.businessBar=null;this.$mb=2;this.lpb=-1;this.jCc=!1;this.QLb=null;this.hzf=this.Jng=this.mtf=this.oUf=!1;this.P4i=K=>{this.$&&((K=K.Result)?K.HasSignificantOptimizableContent?(e.ULS.sendTraceTag(539870352,0,50,"OptimizeWorkbookManager.OnEvaluateSuccess: Operation completed with significant optimizable content"),
K.OptimizableRangesOrPercentage&&(this.lpb=K.OptimizableRangesOrPercentage),0>=this.lpb&&0!==this.$mb&&(e.ULS.sendTraceTag(512349446,0,50,"OptimizeWorkbookManager.OptimizableRangesOrPercentage Range count or percentage must return valid value"),this.$mb=0),this.gSb()):e.ULS.sendTraceTag(537154764,0,50,"OptimizeWorkbookManager.OnEvaluateSuccess: Operation completed without significant optimizable content"):e.ULS.sendTraceTag(537154763,0,50,"OptimizeWorkbookManager.OnEvaluateSuccess: Null result object"))};
this.Xaj=(K,R,Z)=>{(K=K.Result)?K.HasSignificantOptimizableContent?(e.ULS.sendTraceTag(512304643,0,50,"OptimizeWorkbookManager.onRetrieveSuccess: Operation completed with significant optimizable content"),this.jCc=!0,this.FZj(R,Z)):e.ULS.sendTraceTag(512304644,0,50,"OptimizeWorkbookManager.onRetrieveSuccess: Operation completed without significant optimizable content"):e.ULS.sendTraceTag(512304645,0,50,"OptimizeWorkbookManager.onRetrieveSuccess: Null result object")};this.$=J;this.P1j();this.jCc=
!1;this.hBh=x.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.SlowOperationDurationThreshold",2E3);this.QLb=new H(this,this.$.ea.sessionId)}dispose(){this.Z8a();this.$=this.businessBar=null;this.SUe();super.dispose()}Kvi(){this.QLb&&this.QLb.initialize()}SUe(){this.QLb&&this.QLb.dispose()}Z8a(){this.businessBar&&this.businessBar.Ena(62)&&this.businessBar.removeEntry(62)}P1j(){f.a.instance.Dc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(J=>{J.isFeatureEnabled("ExcelOptimizeCellTableBigHammer",
!1).then(K=>{K&&u(this.$.qa.va,this.$mb,this.P4i,null,null,null);return K})})}gSb(){const J=Object(G.b)("OfficeVSO:7624544_ConvertBusinessBarManagerService")?Object(L.d)(M.a.resolve(O.h,{Wa:1})):h.GetServiceTaskFactory.Za(this.$.da,5,4,1);l.TaskExtensions.za(J,()=>{const K=J.result;K&&(K.oh(62,null,null,this.p1h()),this.businessBar=K)},this.$.ka,3)}p1h(){switch(this.$mb){default:return w.a.instance.ha(2239);case 1:return String.format(w.a.instance.Ha(720),this.lpb);case 2:return String.format(w.a.instance.Ha(721),
this.lpb)}}Uvi(){!x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerEnableClosePaneFeedback",!1)||!this.mtf||this.oUf||this.Jng||this.hzf||(f.a.instance.Dc("Common.ISystemInitiatedFeedback").execute(J=>{J.logActivity("Office_Excel_OptimizeWorkbook_InitializeClosePaneFloodgate",null)}),e.ULS.sendTraceTag(509688028,0,50,"OptimizeWorkbookManager.initiateClosePaneFeedback() - Feedback Triggered."))}DOj(J){this.mtf=J}sPj(){this.oUf=!0}UOj(){this.hzf=!0}M$(J,K,R){if(K&&
K.RequestTelemetryData&&!(K.RequestTelemetryData.EcsOperationDuration<this.hBh)&&this.businessBar&&this.businessBar.Ena(62)&&!this.jCc){var Z=R?R:this.$.na.sheetName;if(6===J||7===J||8===J||9===J)this.evaluateSheetOptimizableContent(Z,J,K.RequestTelemetryData.EcsOperationDuration);else{const P=()=>{z.h(this.$).Ca.gx(P);this.evaluateSheetOptimizableContent(Z,J,K.RequestTelemetryData.EcsOperationDuration)};z.h(this.$).Ca.Aw(P)}}}evaluateSheetOptimizableContent(J,K,R){v(this.$.qa.va,J,Z=>{this.Xaj(Z,
K,R)},null,null,null)}FZj(J,K){const R=new m.a(-847286761,t.a.fc,this.$.Tc,0,null),Z={CalloutName:18};Z.Target=this.businessBar.Cld(62);Z.Operation=J;Z.Duration=K;this.$.Ia.mc(R,Z)}WXj(){this.$.Ed(802602464,t.a.fc,12,{[F.a.OI]:"OptimizeWorkbookTaskPane"});this.Jng=!0}}Object(r.a)(B,"OptimizeWorkbookManager",d.a,[374]);var E=a(727);class I extends b.a{constructor(J){super();this.$=J;this.uc()}create(){const J=Object(E.a)(this.$.da,465,()=>new B(this.$));this.$b(J)}static la(J){J.da.Ja(466,new I(J))}}
Object(r.a)(I,"OptimizeWorkbookManagerFactory",b.a,[]);a.d(C,"a",function(){return S});const S=()=>{c.a.Fa(J=>{I.la(J)})}},1499:function(r,C,a){a.r(C);r=a(1275);C=a(1276);var c=a(1221);a=a(981);Object(r.a)();Object(a.b)();Object(C.a)();Object(c.a)()},754:function(r,C,a){r=a(0);var c=a(2),b=a(15),e=a(1394),f=a(906),d=a(907),h=a(172),l=a(776);class k{static lGb(B){return!!(B&1)}static Yyd(B){return!!(B&2)}static wik(B){return!!(B&k.jsi)}}k.jsi=6;Object(r.a)(k,"EwaReactCalloutModeUtil",null,[]);class u{constructor(){this.O_=
0;this.oHb=null;this.VGc=!0}}Object(r.a)(u,"EwaReactShowOrDismissCalloutMetadata",null,[]);var v=a(62),x=a(40),w=a(116),m=a(824),t=a(149),z=a(35);class y{constructor(B,E,I){this.indexedDB=null;this.$=B;this.JN=E;this.tKa=I}nzf(){const B=new h.a;let E=new u;x.TaskExtensions.za(this.bYe(),I=>{I.result?x.TaskExtensions.za(this.indexedDB.T7a(this.JN),S=>{if(S=S.result){S=v.a.ij(S);if(!S){this.h3e(B);return}if(k.lGb(this.tKa)){const J=S.NumberOfDisplays;E.O_=J?Number.parseLocale(J):0}k.Yyd(this.tKa)&&
(S=S.LastDisplay,E.oHb=S?new Date(Number.parseLocale(S)):null)}B.setResult(E)},this.$.ka):this.h3e(B)},this.$.ka,3);return B.task}J$f(B){const E=new h.a;x.TaskExtensions.za(this.bYe(),I=>{I.result||E.setResult(!1);I={};k.lGb(this.tKa)&&(I.NumberOfDisplays=B.O_.toString());k.Yyd(this.tKa)&&(I.LastDisplay=w.toTimestamp(B.oHb).m.toString());I=v.a.nd(I);x.TaskExtensions.za(this.indexedDB.Vgb(new m.a(this.JN,I)),S=>{E.setResult(S.result)},this.$.ka,3)},this.$.ka,3)}bYe(){const B=new h.a;this.indexedDB?
B.setResult(!0):void t.a.resolve(z.Y,{Wa:1}).then(E=>{E.Bf()?(E.initialize("Callouts","EwaCallouts"),this.indexedDB=E,B.setResult(!0)):(b.ULS.sendTraceTag(573609248,0,50,"EwaReactShowOrDismissCalloutIndexedDBLoaderSaver.EnsureIndexedDB: IndexedDb is not supported."),B.setResult(!1))});return B.task}h3e(B){const E=new u;E.VGc=!1;B.setResult(E)}}Object(r.a)(y,"EwaReactShowOrDismissCalloutIndexedDBLoaderSaver",null,[330]);class D{constructor(B,E,I,S,J,K){this.T7b=E;this.V7b=I;this.tKa=S;this.JN=J;this.localStorage=
K;this.$=B}nzf(){const B=new h.a,E=new u;if(k.lGb(this.tKa)){let I=0;E.VGc=({Moa:I}=this.hak()).returnValue&&E.VGc;E.O_=I}B.setResult(E);return B.task}J$f(B){const E=new h.a;var I=!0;if(k.lGb(this.tKa)){const S=this.L8e();S&&(I=Number.parseLocale(S),I=this.Sak((I&~this.V7b|B.O_<<this.T7b).toString()))}E.setResult(I)}hak(){var B;return(B=this.L8e())?(B=(Number.parseLocale(B)&this.V7b)>>this.T7b,b.ULS.sendTraceTag(537169932,0,50,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver - Callout ${this.JN} already appeared. Found the callout in storage.`),
{returnValue:!0,Moa:B}):{returnValue:!1,Moa:0}}Sak(B){try{if(!this.localStorage.Bf())return!1;try{return this.localStorage.setItem("CalloutIds",B),!0}catch(E){b.ULS.sendTraceTag(537169931,0,15,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.TrySaveCalloutIdsToCache: Failed to set item to cache. reason: ${E.message||"Unknown"}`)}}catch(E){b.ULS.sendTraceTag(537169930,0,15,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.TrySaveCalloutIdsToCache: Got Exception when trying to save calloutIds to cache. e.Message: ${E.message}`)}return!1}L8e(){try{if(!this.localStorage.Bf())return b.ULS.sendTraceTag(537169929,
0,50,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.GetCalloutIdsFromCache: Local storage is not supported and display count (if any) won't be saved for ${this.JN}.`),null;const B=this.localStorage.getItem("CalloutIds");return B?B:(b.ULS.sendTraceTag(537169928,0,15,"EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.GetCalloutIdsFromCache: item doesn't exist in local storage"),"0")}catch(B){return b.ULS.sendTraceTag(537169927,0,15,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.GetCalloutIdsFromCache: Got Exception when trying to get calloutIds. e.Message: ${B.message}`),
null}}}Object(r.a)(D,"EwaReactShowOrDismissCalloutLocalStorageLoaderSaver",null,[330]);var H=a(75),F=a(136),G=a(194),L=a(137),M=a(587);a.d(C,"a",function(){return O});class O extends l.a{constructor(B,E,I,S,J,K,R,Z,P,V=!1,Ea=!1,oa=!1,ea=!1,aa=!1,ia=!0,ya=!1,za=null,la=!1){super(B);this.O_=0;this.k0d=this.kLc=this.pxg=!1;this.SPf=()=>{this.Tlc()};this.xEg=E;this.qXj=I;this.Dyh=S;this.Cu=J;this.Bu=K;this.localStorage=P;this.wEg=R;this.vEg=Z;this.LNi=V;this.wsd=Ea;this.Gyh=oa;this.setInitialFocus=ea;
this.useCoachmark=aa;this.iCc=!1;this.xOj=ia;this.MEf=this.d$h();this.w3a=za;this.k0d=la;this.hasDynamicSizing=ya}get h5b(){return{}}set nzg(B){this.Cu=B}q$d(){}MNa(){return 1}fmd(){return 0}get Moa(){return 1}get VXf(){return!0}get JN(){return this.xEg}get V7b(){return this.wEg}get T7b(){return this.vEg}show(){x.TaskExtensions.za(this.RDa(),B=>{B.result&&this.FXj()},this.$.ka)}jAf(){L.b(this.$).Vd(F.a.j_e,this.ggf("dismiss"),void 0,!0)}aBf(){L.b(this.$).Vd(F.a.j_e,this.ggf("show"),void 0,!0)}Zxa(){const B=
Object(c.a)(new e.a,{label:this.Dyh,onExecute:()=>{this.q$d();this.jAf();this.kLc=!0;this.Tlc()}});let E=null;this.wsd||(E=Object(c.a)(new e.a,{label:this.qXj,onExecute:()=>{this.kLc=!0;this.aBf();const I=G.c({["InputMethod"]:H.a.fc},this.h5b);this.$.Ia.mc(this.ribbonCommandInfo,I);this.Tlc()}}));return Object(c.a)(new f.a,{target:this.Ric(),content:this.Bu,title:this.Cu,primaryButtonProps:this.wsd?B:E,secondaryButtonProps:this.wsd?null:B,showCloseIcon:this.k0d,preventLightDismiss:!this.LNi,hasDynamicSizing:this.hasDynamicSizing,
calloutProps:Object(c.a)(new d.a,{onDismiss:()=>{this.Tlc()},directionalHint:this.w3a,preventDismissOnScroll:!0,preventDismissOnResize:!this.Gyh,isBeakVisible:this.xOj,setInitialFocus:this.setInitialFocus}),useTeachingStyles:!0,hasFocusableControls:!0,useCoachmark:this.useCoachmark})}Tlc(){this.pxg=!0;const B=this.$.da.Ba(418);B&&B.Jzj(this.SPf);(this.VXf&&this.kLc||this.k0d)&&this.jrg(!0);this.kLc||b.ULS.sendTraceTag(537169935,0,50,`EwaReactShowOrDismissCallout - Callout ${this.JN} was dismissed without user interaction`);
this.dismiss()}RDa(){const B=new h.a;this.sza()?x.TaskExtensions.za(this.MEf.nzf(),E=>{var I=this.MNa();E=E.result;if(E.VGc)if(this.O_=E.O_,k.lGb(I)&&(this.iCc||E.O_>=this.Moa))b.ULS.sendTraceTag(573609250,0,50,`EwaReactShowOrDismissCallout - Callout ${this.JN} already appeared. Found the callout in storage.`),this.iCc=!0,B.setResult(!1);else{if(k.Yyd(I)&&E.oHb&&(I=w.getElapsedSeconds(E.oHb,new Date),(E=this.fmd())||b.ULS.shipAssertTag(537169933,0,!1,`GetCooldownPeriodInSeconds returned 0 callout ${this.JN} with mode RestrictedBycooldown`),
I<E)){B.setResult(!1);return}I=!this.lM&&!!this.Ric()&&!M.a(this.$);B.setResult(I)}else B.setResult(!1),b.ULS.sendTraceTag(537169934,0,50,`EwaReactShowOrDismissCallout.ShouldShowCallout: Failed to retrieve metadata for callout ${this.JN}.`)},this.$.ka):B.setResult(!1);return B.task}sza(){return!0}Ric(){if(document.querySelector(this.eY))return this.eY;if(document.querySelector(this.dY))return this.dY;if(document.querySelector(this.yX))return this.yX;b.ULS.shipAssertTag(592528907,0,!1,`EwaReactShowOrDismissCallout.GetTargetObject: Cannot retrieve the Callout Target Object, Callout: ${this.JN}`);
return null}jrg(B=!1){this.iCc=!0;this.MNa();const E=new u;E.O_=B?this.Moa:this.O_+1;E.oHb=new Date;this.MEf.J$f(E)}FXj(){this.iCc=!0;this.jrg();b.ULS.sendTraceTag(593494082,0,50,`EwaReactShowOrDismissCallout - Showing ${this.JN} callout, current number of displayes: ${this.O_}`);this.$.da.Qb(418,B=>{this.pxg||B.RYg(this.SPf)});super.show()}d$h(){const B=this.MNa();return k.wik(B)?new y(this.$,this.JN,B):new D(this.$,this.T7b,this.V7b,B,this.JN,this.localStorage)}ggf(B){return{["selection"]:B,["callout"]:this.JN,
["Location"]:"floatie",["displayCount"]:this.O_}}}Object(r.a)(O,"EwaReactShowOrDismissCallout",l.a,[])},776:function(r,C,a){a.d(C,"a",function(){return f});r=a(0);var c=a(15),b=a(187),e=a(906);class f{constructor(d){this.lM=null;this.$=d}show(){const d=this.Zxa();c.ULS.shipAssertTag(537169938,0,!!d,"EwaReactCallout.Show: Cannot retrieve the Callout Parameters");b.UISurfaces.aJ().then(h=>{const l=h.callout(d);this.lM=h.addNotification(l)},h=>{c.ULS.sendTraceTag(537169936,0,15,`EwaReactCallout.Show: Failed to GetNotificationsAPIAsync: ${h}`);
return null})}dismiss(){this.lM&&b.UISurfaces.aJ().then(d=>{d.removeNotification(this.lM);return this.lM=null})}fKc(d){b.UISurfaces.aJ().then(h=>{h.updateNotification(this.lM,h.callout(Object.assign(new e.a,d)))},h=>{c.ULS.sendTraceTag(522782336,0,15,`EwaReactCallout.Update: Failed to GetNotificationsAPIAsync: ${h}`);return null})}}Object(r.a)(f,"EwaReactCallout",null,[325])},981:function(r,C,a){function c(){window.__reslicingWorkaround=!0}r=a(118);var b=a(0),e=a(754),f=a(75),d=a(91),h=a(275),l=a(9),
k=a(1);const u='[id="'+l.a.Alg+'"]';class v extends e.a{constructor(Qa,Db,sa,Ha,mb,qa,Xa,Ca,va,na){super(Qa,Db,null,sa,Ha,mb,qa,Xa,new h.a,Ca,!0,!0,va,!1,!1,void 0,na)}get eY(){return u}get dY(){return u}get yX(){return u}get ribbonCommandInfo(){return new d.a(-847286761,f.a.fc,this.$.Tc,0,null)}sza(){return!(k.EwaSettings.isChangeGateEnabled("OfficeVSO:7270447_DisableCalloutInSpecialModes")&&(this.$.isMobileMode||this.$.ea.Rc.inEmbedView||this.$.ea.Rc.inWebPart))}}Object(b.a)(v,"ZoomTeachingCallout",
e.a,[]);var x=a(16);class w extends v{constructor(Qa){super(Qa,"AdjustZoomTeachingCallout",x.a.instance.Ha(694),null,x.a.instance.Ha(693),2,1,!1,!0,2)}}Object(b.a)(w,"AdjustZoomTeachingCallout",v,[]);class m extends e.a{constructor(Qa){super(Qa,"ConditionalFormattingManageRulesTeachingCallout",x.a.instance.Ha(643),x.a.instance.Ha(644),x.a.instance.Ha(641),x.a.instance.Ha(642),2,1,new h.a)}get eY(){return"[data-unique-id=Ribbon-ConditionalFormatting]"}get dY(){return'[data-unique-id="RibbonOverflowMenu"]'}get yX(){return'[id="m_excelWebRenderer_ewaCtl_Styles.CondFmt-Large"]'}get ribbonCommandInfo(){return new d.a(-20558303,
f.a.fc,this.$.Tc,0,null)}}Object(b.a)(m,"ConditionalFormattingManageRulesTeachingCallout",e.a,[]);var t;(function(Qa){Qa[Qa.overrideBrowserShortcuts=0]="overrideBrowserShortcuts";Qa[Qa.conditionalFormattingManageRules=1]="conditionalFormattingManageRules";Qa[Qa.linkedEntityBlankCellConvert=2]="linkedEntityBlankCellConvert";Qa[Qa.linkedEntityNoCuratedData=3]="linkedEntityNoCuratedData";Qa[Qa.lineageDiscoverability=4]="lineageDiscoverability";Qa[Qa.lineageTeachingCallout=5]="lineageTeachingCallout";
Qa[Qa.linkedEntityFirstOrganizationData=6]="linkedEntityFirstOrganizationData";Qa[Qa.adjustZoomTeachingCallout=7]="adjustZoomTeachingCallout";Qa[Qa.linkedEntityGallery=8]="linkedEntityGallery";Qa[Qa.fixedFreezePane=9]="fixedFreezePane";Qa[Qa.phoneticTeachingCallout=10]="phoneticTeachingCallout";Qa[Qa.powerQueryCallout=11]="powerQueryCallout";Qa[Qa.tableAIConvertToTableCallout=12]="tableAIConvertToTableCallout";Qa[Qa.optimizeWorkbookBusinessBarCallout=13]="optimizeWorkbookBusinessBarCallout";Qa[Qa.tableInNewWorkbook=
14]="tableInNewWorkbook";Qa[Qa.formulaByExampleCurtainLifterCallout=15]="formulaByExampleCurtainLifterCallout";Qa[Qa.dataCleansing=16]="dataCleansing";Qa[Qa.optimizeWorkbookSlowOperationsCallout=18]="optimizeWorkbookSlowOperationsCallout";Qa[Qa.excelBetterEntryTeachingCallout=19]="excelBetterEntryTeachingCallout";Qa[Qa.excelLiveWebEntryPointCallout=20]="excelLiveWebEntryPointCallout";Qa[Qa.functionDialog=21]="functionDialog";Qa[Qa.length=22]="length"})(t||(t={}));Object(b.b)("EwaCalloutName",t);var z=
a(38);class y extends v{constructor(Qa){super(Qa,"FixedFreezePaneTeachingCallout",x.a.instance.Ha(647),x.a.instance.Ha(645),x.a.instance.Ha(646),65536,16,!0,!1,8)}MNa(){return 0}}Object(b.a)(y,"FixedFreezePaneTeachingCallout",v,[]);var D=a(1182);class H extends e.a{constructor(Qa){super(Qa,H.UNi,"",x.a.instance.Ha(651),x.a.instance.Ha(653),x.a.instance.Ha(654),4096,12,new h.a,void 0,!0);this.w3a=9}get eY(){return H.uCd}get dY(){return H.uCd}get yX(){return H.uCd}get ribbonCommandInfo(){return null}}
H.UNi="LineageTeachingCallout";H.uCd="#LineagePaneFilterButton";Object(b.a)(H,"LineageTeachingCallout",e.a,[]);var F=a(2),G=a(15),L=a(1394),M=a(103),O=a(906),B=a(907),E=a(776),I=a(7),S=a(54),J=a(23),K=a(977);class R extends K.a{constructor(Qa){super("TextAboveImage");this.imageHeight=this.imageWidth=this.image=this.paragraphs=null;this.paragraphs=Qa.paragraphs;this.image=Qa.image;this.imageWidth=Qa.imageWidth;this.imageHeight=Qa.imageHeight}}Object(b.a)(R,"TextAboveImage",K.a,[]);class Z{constructor(Qa,
Db){this.imageHeight=this.imageWidth=this.image=this.paragraphs=null;this.paragraphs=Qa;this.image=Db}}Object(b.a)(Z,"TextAboveImageCustomProps",null,[]);var P=a(885);class V extends E.a{constructor(Qa){super(Qa);this.bcg=0;this.mWa=this.target=null;this.vKc=!1;this.Bu=this.Cu=null;this.S5c=0}FE(Qa,Db,sa,Ha,mb,qa){if(!this.$o()){switch(Ha){case "DataTypes_PBI":this.S5c=1;break;default:this.S5c=0}this.target=Qa;this.Cu=String.format(x.a.instance.Ha(676),Db);this.Bu=String.format(x.a.instance.Ha(677),
sa);this.bcg=qa;this.ILj(Ha,mb)}}ILj(Qa,Db){const sa=!!this.$.xa&&J.a.equals(this.$.xa.UICultureTag,"en-us",!0);this.vKc=Db&&sa;Db&&!sa?this.mWa="BlankCell":Qa?this.mWa=Qa:(G.ULS.sendTraceTag(537169926,0,15,"LinkedEntityBlankCellConvertTeachingCallout.SetActionButtonAndSidePaneId: Callout BlankCellResourceId was null"),this.mWa="BlankCell")}show(){G.ULS.shipAssertTag(537169925,0,!!this.target&&!!this.Bu&&!!this.Cu,"LinkedEntityBlankCellConvertTeachingCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");
this.$o()||(G.ULS.sendTraceTag(537169924,0,50,"LinkedEntityBlankCellConvertTeachingCallout.Show() - Showing LinkedEntityBlankCellConvertTeachingCallout callout."),super.show())}$o(){return!!this.lM}Zxa(){const Qa=Object(F.a)(new L.a,{label:x.a.instance.Ha(682),ariaDescription:x.a.instance.Ha(683),onExecute:()=>{G.ULS.sendTraceTag(537169923,0,50,'LinkedEntityBlankCellConvertTeachingCallout - clicked "Got it" button');this.dismiss()}}),Db=Object(F.a)(new L.a,{label:this.vKc?x.a.instance.Ha(680):x.a.instance.Ha(678),
ariaDescription:this.vKc?x.a.instance.Ha(681):x.a.instance.Ha(679),onExecute:()=>{G.ULS.sendTraceTag(537169922,0,50,'LinkedEntityBlankCellConvertTeachingCallout - clicked "'+(this.vKc?"Try sample data":"Learn more")+'" button');var qa=new Map;qa.set("Domain",this.bcg.toString());M.Health.instance.recordKpiUsage("LinkedEntityBlankCellCalloutActionUsed",0,"ropari",qa);qa=new d.a(-859308420,f.a.fc,this.$.Tc,9,null);this.$.Ia.mc(qa,{[f.a.Og]:"HelpID="+this.mWa,["InputMethod"]:f.a.fc,["ShouldCanvasTakeFocus"]:!0,
[f.a.Gd]:I.a.rS});this.dismiss()}});var sa=!!this.$&&!!this.$.frame&&!!this.$.frame.DE&&this.$.frame.DE.EO;switch(this.S5c){case 1:var Ha=sa?129:126;break;default:Ha=sa?128:123}Ha=Object(F.a)(new P.a(S.a.current.Uo(Ha)),{alt:x.a.instance.Xb(184)});const mb=this.Bu.split("\n\n");sa=Object(F.a)(new Z(mb,Ha),{imageWidth:280,imageHeight:sa?142:192});sa=new R(sa);return Object(F.a)(new O.a,{target:this.target,content:sa,title:this.Cu,primaryButtonProps:Db,secondaryButtonProps:Qa,showCloseIcon:!0,calloutProps:Object(F.a)(new B.a,
{onDismiss:()=>{this.dismiss()},setInitialFocus:!0,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!0,hasFocusableControls:!0})}}Object(b.a)(V,"LinkedEntityBlankCellConvertTeachingCallout",E.a,[]);class Ea extends e.a{constructor(Qa){super(Qa,"LinkedEntityFirstOrganizationDataCallout",x.a.instance.Ha(672),x.a.instance.Ha(674),x.a.instance.Ha(670),x.a.instance.Ha(671),8192,13,new h.a,void 0,void 0,!0,!0);this.target=null;this.mWa=
"DataTypes_PBI"}get eY(){return this.target.toString()}get dY(){return this.target.toString()}get yX(){return'[id="'+this.$.qc+'Ribbon.Data.LinkedEntity"]'}get ribbonCommandInfo(){return new d.a(-859308420,f.a.fc,this.$.Tc,9,null)}get h5b(){return{[f.a.Og]:"HelpID="+this.mWa,["ShouldCanvasTakeFocus"]:!0,[f.a.Gd]:I.a.rS}}FE(Qa){this.$o()||(this.target=Qa,this.mWa="DataTypes_PBI")}$o(){return!!this.lM}sza(){G.ULS.shipAssertTag(537169921,0,!!this.target,"LinkedEntityFirstOrganizationDataTeachingCallout.InternalShouldShowCallout(): Cannot retrieve the callout target. InitializeCalloutProperties should be called before InternalShouldShowCallout");
return!this.$o()}}Object(b.a)(Ea,"LinkedEntityFirstOrganizationDataTeachingCallout",e.a,[]);class oa extends e.a{constructor(Qa){super(Qa,"LinkedEntityGalleryTeachingCallout","",x.a.instance.Ha(682),x.a.instance.Ha(684),x.a.instance.Ha(685),49152,14,new h.a,void 0,!0,!0,!0,!0);this.target=null;this.w3a=5}get Moa(){return 2}get eY(){return this.target.toString()}get dY(){this.w3a=7;return"[data-unique-id=Ribbon-ConvertToLinkedEntityGallery]"}get yX(){return""}get ribbonCommandInfo(){return new d.a(-847286761,
f.a.fc,this.$.Tc,0,I.a.zNb)}show(){G.ULS.shipAssertTag(537169920,0,!!this.target,"LinkedEntityGalleryTeachingCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");this.$o()||(G.ULS.sendTraceTag(558690322,0,50,"LinkedEntityGalleryTeachingCallout.Show() - LinkedEntityGalleryTeachingCallout Coachmark was shown."),super.show())}FE(Qa){this.$o()||(this.target=Qa)}$o(){return!!this.lM}sza(){G.ULS.shipAssertTag(537168099,0,!!this.target,"LinkedEntityGalleryTeachingCallout.InternalShouldShowCallout(): Cannot retrieve the callout target. InitializeCalloutProperties should be called before InternalShouldShowCallout");
return!this.$o()}}Object(b.a)(oa,"LinkedEntityGalleryTeachingCallout",e.a,[]);var ea=a(12);class aa extends E.a{constructor(Qa){super(Qa);this.Bu=this.Cu=this.target=null}FE(Qa,Db,sa){this.$o()||(this.target=Qa,this.Cu=String.format(x.a.instance.Xb(186),Db),this.Bu=String.format(x.a.instance.Xb(188),sa))}show(){G.ULS.shipAssertTag(537168098,0,!!this.target&&!!this.Bu&&!!this.Cu,"LinkedEntityNoCuratedDataTeachingCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");
this.$o()||(G.ULS.sendTraceTag(537168097,0,50,"LinkedEntityNoCuratedDataTeachingCallout.Show() - Showing LinkedEntityNoCuratedDataTeachingCallout callout."),super.show())}$o(){return!!this.lM}Zxa(){const Qa=Object(F.a)(new L.a,{label:x.a.instance.ha(1806),ariaDescription:x.a.instance.ha(1807),onExecute:()=>{G.ULS.sendTraceTag(537168096,0,50,'LinkedEntityNoCuratedDataTeachingCallout - clicked "Learn how" button');M.Health.instance.recordKpiUsage("LinkedEntityNoCuratedDataCalloutActionUsed",0,"ropari",
null);ea.HelperMethods.Vf("https://go.microsoft.com/fwlink/?linkid=2134990",void 0,void 0,"NoCuratedDataCallout.NoCuratedDataFWLink");this.dismiss()}});var Db=Object(F.a)(new P.a(S.a.current.Uo(this.$&&this.$.frame&&this.$.frame.DE&&this.$.frame.DE.EO?130:127)),{alt:x.a.instance.Xb(189)});Db=Object(F.a)(new Z([this.Bu],Db),{imageWidth:280,imageHeight:142});Db=new R(Db);return Object(F.a)(new O.a,{target:this.target,content:Db,title:this.Cu,primaryButtonProps:Qa,showCloseIcon:!0,calloutProps:Object(F.a)(new B.a,
{onDismiss:()=>{this.dismiss()},setInitialFocus:!0,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!0,hasFocusableControls:!0})}}Object(b.a)(aa,"LinkedEntityNoCuratedDataTeachingCallout",E.a,[]);var ia=a(175),ya=a(355);class za extends E.a{constructor(Qa){super(Qa);this.Bu=this.Cu=null}FE(Qa){this.$o()||(this.target=Qa,this.jMj())}show(){G.ULS.shipAssertTag(526234880,0,!!this.target&&!!this.Bu&&!!this.Cu,"OptimizeWorkbookBusinessBarCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");
this.$o()||(G.ULS.sendTraceTag(526234851,0,50,"OptimizeWorkbookBusinessBarCallout.Show() - Showing OptimizeWorkbookBusinessBarCallout callout."),ia.a.sendTelemetryEvent(Object(F.a)(new ya.a,{name:"Office.Excel.Online.OptimizeWorkbook.BigHammerBusinessBarCalloutShown"})),super.show())}$o(){return!!this.lM}Zxa(){return Object(F.a)(new O.a,{target:this.target,title:this.Cu,content:this.Bu,showCloseIcon:!0,calloutProps:Object(F.a)(new B.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!1,preventDismissOnResize:!1,
preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!0,hasFocusableControls:!1})}jMj(){let Qa=-1,Db=0;const sa=this.$.da.Ba(465);sa&&(Qa=sa.lpb,Db=sa.$mb);switch(Db){default:this.Cu=x.a.instance.Ha(722);this.Bu=x.a.instance.Ha(725);break;case 1:G.ULS.debugAssertTag(512368795,0,-1!==Qa,"OptimizeWorkbookBusinessBarCallout.setCalloutTitleAndBody: Invalid range count");this.Cu=String.format(x.a.instance.Ha(723),Qa);this.Bu=x.a.instance.Ha(726);break;case 2:G.ULS.debugAssertTag(512368794,
0,-1!==Qa,"OptimizeWorkbookBusinessBarCallout.setCalloutTitleAndBody: Invalid percentage"),this.Cu=String.format(x.a.instance.Ha(724),Qa),this.Bu=x.a.instance.Ha(726)}}}Object(b.a)(za,"OptimizeWorkbookBusinessBarCallout",E.a,[]);var la=a(145);class xa extends e.a{constructor(Qa,Db,sa,Ha,mb,qa,Xa,Ca=!1,va="OverrideBrowserShortcutsTeachingCallout"){super(Qa,va,Db,sa,Ha,mb,qa,Xa,new h.a,Ca)}get eY(){return"[data-unique-id=Help]"}get dY(){return"[data-unique-id=pivotOverflowButton]"}get yX(){return'[id="'+
this.$.qc+'Ribbon.Help-title"]'}get ribbonCommandInfo(){return new d.a(-1018439626,f.a.fc,this.$.Tc,0,I.a.n2)}sza(){return!la.a.get(I.a.Uhb)}}Object(b.a)(xa,"OverrideBrowserShortcutsTeachingCallout",e.a,[]);class wa extends xa{constructor(Qa,Db,sa,Ha,mb,qa,Xa,Ca=!1){super(Qa,Db,sa,Ha,mb,qa,Xa,Ca,"OverrideBrowserShortcutsTeachingCalloutOptInByDefault")}get ribbonCommandInfo(){return new d.a(-901364793,f.a.fc,this.$.Tc,0,I.a.n2)}get h5b(){return{[I.a.SLd]:!1}}}Object(b.a)(wa,"OverrideBrowserShortcutsTeachingCalloutOptInByDefault",
xa,[]);var hb=a(41);class Ja extends e.a{constructor(Qa,Db,sa,Ha,mb,qa,Xa,Ca,va,na,Ka=!1,ib=!1,Ra=!1,ka=!1,da=!1,kb=!0,Ob=!1,lc=null,tc=!1){super(Qa,Db,sa,Ha,mb,qa,Ca,va,na,Ka,ib,Ra,ka,da,kb,Ob,lc,tc);this.learnMoreUrl=null;this.learnMoreUrl=Xa}ofj(){try{hb.a.aS(this.learnMoreUrl)}catch(Qa){}}q$d(){null!=this.learnMoreUrl&&this.ofj()}}Object(b.a)(Ja,"EwaReactShowOrLearnMoreCallout",e.a,[]);const Fa='[id="'+l.a.Alg+'"]';class Ba extends Ja{constructor(Qa){super(Qa,"PhoneticTeachingCallout",x.a.instance.Ha(695),
x.a.instance.Ha(698),x.a.instance.Ha(697),x.a.instance.Ha(696),"https://go.microsoft.com/fwlink/?linkid=2194045",131072,17,new h.a,void 0,void 0,void 0,void 0,void 0,void 0,!0,3,!0)}get eY(){return Fa}get dY(){return Fa}get yX(){return Fa}get ribbonCommandInfo(){return new d.a(1455037301,f.a.fc,this.$.Tc,0,null)}jAf(){G.ULS.sendTraceTag(545837391,1,50,"PhoneticTeachingCallout - click learn more")}aBf(){G.ULS.sendTraceTag(545837390,1,50,"PhoneticTeachingCallout - click show")}}Object(b.a)(Ba,"PhoneticTeachingCallout",
Ja,[]);var fa=a(177);class ta extends e.a{constructor(Qa,Db,sa,Ha,mb,qa){super(Qa,Db,x.a.instance.Ha(708),x.a.instance.Ha(707),x.a.instance.Ha(703),sa,Ha,mb,new h.a,!0,!1,void 0,void 0,void 0,!0,!0);this.w3a=5;this.k7c=qa}get Moa(){return 2}get eY(){return 1===fa.a(this.$).KP?"[data-unique-id=Ribbon-Refresh]":"[data-unique-id=Ribbon-RefreshAll]"}get dY(){return"[data-unique-id=Connections_MLR"}sza(){return this.k7c}get yX(){return'[id="'+this.$.qc+'Ribbon.Data.RefreshAll"]'}get ribbonCommandInfo(){return new d.a(-859308420,
f.a.fc,this.$.Tc,9,null)}get h5b(){return{[f.a.Og]:"HelpID=PowerQuery_Refresh",["ShouldCanvasTakeFocus"]:!0,[f.a.Gd]:I.a.rS}}L_d(){return this.RDa()}show(){this.Ric()?super.show():G.ULS.sendTraceTag(509677597,0,10,"PowerQueryRefreshTeachingCalloutBase.Show: Target object is null.")}}Object(b.a)(ta,"PowerQueryRefreshTeachingCalloutBase",e.a,[]);class Oa extends ta{constructor(Qa){super(Qa,"PowerQueryRefreshFromTableTeachingCallout",x.a.instance.Ha(705),3145728,20,k.EwaSettings.isChangeGateEnabled("OfficeVSO:7847555_PowerQueryTaskPaneSwitchToNewFeatureGateAPI")?
k.EwaSettings.isChangeGateEnabled("OfficeVSO:7111771_PowerQueryRefreshWeb"):k.EwaSettings.VFi())}}Object(b.a)(Oa,"PowerQueryRefreshFromTableTeachingCallout",ta,[]);class Ma extends e.a{constructor(Qa){super(Qa,"QueriesTaskPaneTeachingCallout",x.a.instance.Ha(702),x.a.instance.Ha(701),x.a.instance.Ha(k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryConnectionsTaskPane",!1)?849:699),x.a.instance.Ha(k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryConnectionsTaskPane",
!1)?850:700),12582912,22,new h.a,!0,void 0,void 0,void 0,void 0,!0,!0);this.w3a=5;this.k7c=k.EwaSettings.isChangeGateEnabled("OfficeVSO:7847555_PowerQueryTaskPaneSwitchToNewFeatureGateAPI")?k.EwaSettings.isChangeGateEnabled("OfficeVSO:7095227_PowerQueryTaskPaneGroupsOperations"):k.EwaSettings.kGi()}get Moa(){return 2}get eY(){return"[data-unique-id=Ribbon-OpenQueriesTaskPane]"}get dY(){return"[data-unique-id=Connections_MLR]"}get yX(){return'[id="'+this.$.qc+'Ribbon.Data.Queries"]'}L_d(){return this.RDa()}show(){this.Ric()?
super.show():G.ULS.sendTraceTag(537168092,0,10,"QueriesTaskPaneTeachingCallout.Show: Target object is null.")}sza(){return this.k7c}get ribbonCommandInfo(){return new d.a(1156885807,f.a.fc,this.$.Tc,0,I.a.zNb)}}Object(b.a)(Ma,"QueriesTaskPaneTeachingCallout",e.a,[]);var fb=a(430),pa=a(201),Ua=a(478),Sa=a(231),Ia=a(248);class X extends ta{constructor(Qa){super(Qa,"PowerQueryAuthenticatedRefreshTeachingCallout",x.a.instance.Ha(706),805306368,28,k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",
!1))}}Object(b.a)(X,"PowerQueryAuthenticatedRefreshTeachingCallout",ta,[]);class ca{constructor(Qa){this.djf=this.Cjf=!1;this.RDa=!0;this.h7i=Db=>{if(Db&&!Sa.a(Db))try{const sa=Db.Result,Ha=sa.QueryGroups;if(0<sa.Queries.length||0<Ha.length)this.Cjf=!0,this.djf=sa.PowerQueryDataSources?sa.PowerQueryDataSources.includes("Excel.CurrentWorkbook")||sa.PowerQueryDataSources.includes("OData.Feed"):!1,this.rFc()}catch(sa){G.ULS.sendTraceTag(537168095,0,10,`PowerQueryCallout.OnGetQueriesSuccess: QueryInfoList retrieval encountered exception ${sa}.`)}};
this.Kuc=()=>{G.ULS.sendTraceTag(537168094,0,15,"PowerQueryCallout.OnGetQueriesFailure")};this.$=Qa;this.vZf=new Ma(Qa);this.zNd=k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",!1)?new X(Qa):new Oa(Qa)}show(){this.RDa&&this.hKj()}hKj(){this.$.userOperationManager.Bd(new pa.a(587,0,(Qa,Db,sa)=>Ua.d(this.$.qa.va,Ia.b(Qa,this.h7i),Ia.a(Db,this.Kuc),sa,null),80,()=>new fb.a),null)}rFc(){this.vZf.L_d().continueWith(Qa=>{Qa.result&&this.Cjf?(this.vZf.show(),this.RDa=
!1):this.zNd.L_d().continueWith(Db=>{Db.result&&(this.zNd instanceof X||this.djf)&&this.zNd.show();this.RDa=!1})})}}Object(b.a)(ca,"PowerQueryCallout",null,[325]);class U extends E.a{constructor(Qa){super(Qa);this.uHd=this.had=this.Bu=this.Cu=this.target=null}FE(Qa,Db,sa){this.$o()||(this.target=Qa,this.had=Db,this.uHd=sa,this.Cu=x.a.instance.Ha(710),this.Bu=x.a.instance.Ha(711))}show(){G.ULS.shipAssertTag(537168091,0,!!this.target&&!!this.Bu&&!!this.Cu&&!!this.had&&!!this.uHd,"TableAIConvertToTableCallout.Show() - Cannot retrieve the Callout Parameters, Initialize should be called before show");
this.$o()||(G.ULS.sendTraceTag(0,0,50,"TableAIConvertToTableCallout.Show() - Showing TableAIConvertToTableCallout callout."),super.show())}$o(){return!!this.lM}Zxa(){const Qa=Object(F.a)(new L.a,{label:x.a.instance.Ha(712),ariaDescription:x.a.instance.Ha(714),onExecute:()=>{G.ULS.sendTraceTag(0,0,50,'TableAIConvertToTableCallout - clicked "Format as table" button');this.had();this.dismiss()}}),Db=Object(F.a)(new L.a,{label:x.a.instance.Ha(713),ariaDescription:x.a.instance.Ha(715),onExecute:()=>{G.ULS.sendTraceTag(0,
0,50,'TableAIConvertToTableCallout - clicked "No thanks" button');this.uHd();this.dismiss()}});return Object(F.a)(new O.a,{target:this.target,content:this.Bu,title:this.Cu,primaryButtonProps:Qa,secondaryButtonProps:Db,showCloseIcon:!0,calloutProps:Object(F.a)(new B.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!0,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!1,hasFocusableControls:!0})}}Object(b.a)(U,"TableAIConvertToTableCallout",
E.a,[]);var ma=a(181),ra=a(84);class Va{constructor(Qa){this.G9j=Qa}show(){ra.a.instance.Dc("Common.ISystemInitiatedFeedback").execute(Qa=>{Qa.logActivity(this.G9j,null)})}}Object(b.a)(Va,"EwaLppCallout",null,[325]);var ob=a(47);class ja extends Va{constructor(Qa){super("ExcelTableInNewWorkbook");this.nwd=this.fAa=!1;this.createTable=()=>{const Db=ob.v(new ma.a(1,1,8,3,l.a.Sg,l.a.Rg),this.$),sa={};sa.TableRange=Db;sa.HasHeader=!1;this.$.Ed(71074531,f.a.fc,9,sa)};this.xQe=()=>{this.createSampleTable("0")};
this.yQe=()=>{this.createSampleTable("2")};this.zQe=()=>{this.createSampleTable("1")};this.$=Qa;(this.fAa=k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableInNewWorkbook",!1))&&window.addEventListener("ExcelCreateSampleTable",this.createTable,!0);if(this.nwd=k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CreateSampleTableCallout",!1))window.addEventListener("ExcelCreateSampleTableBlank",this.xQe,!0),window.addEventListener("ExcelCreateSampleTableContact",this.yQe,!0),window.addEventListener("ExcelCreateSampleTableToDo",
this.zQe,!0)}dispose(){this.fAa&&window.removeEventListener("ExcelCreateSampleTable",this.createTable,!0);this.nwd&&(window.removeEventListener("ExcelCreateSampleTableBlank",this.xQe,!0),window.removeEventListener("ExcelCreateSampleTableContact",this.yQe,!0),window.removeEventListener("ExcelCreateSampleTableToDo",this.zQe,!0))}createSampleTable(Qa){const Db={};Db[f.a.Gd]=Qa;this.$.Ed(1371713064,f.a.fc,9,Db)}}Object(b.a)(ja,"TableInNewWorkbookCallout",Va,[]);var lb=a(1146);class wb extends E.a{constructor(Qa){super(Qa);
this.CFc=5E3;this.Cu=lb.a.Title;this.currentState=0}jxa(Qa,Db){lb.c.get(this.currentState).includes(Qa)&&(6===Qa?window.requestAnimationFrame(()=>this.Fdc(Qa,Db)):this.Fdc(Qa,Db))}XUb(Qa){this.target=Qa}show(){super.dismiss();this.U7f();super.show()}dismiss(){this.jxa(0);window.clearTimeout(this.q3f);super.dismiss()}Zxa(){return Object(F.a)(new O.a,{target:this.target,title:this.Cu,content:this.Bu,showCloseIcon:!0,calloutProps:{setInitialFocus:!1,preventDismissOnResize:!0,preventDismissOnScroll:!0,
preventDismissOnLostFocus:!0,isBeakVisible:!0,directionalHint:12,onDismiss:void 0},useTeachingStyles:!1,hasFocusableControls:!1})}update(){this.U7f();super.fKc({message:this.Bu})}Fdc(Qa,Db){const sa=lb.b.get(Qa);this.Ddk(this.tAh(Qa)?`${sa}${Db}`:sa);this.currentState=Qa;0!=this.currentState?(this.update(),this.show()):this.dismiss()}tAh(Qa){switch(Qa){case 5:case 6:return!0;default:return!1}}U7f(){window.clearTimeout(this.q3f);this.q3f=window.setTimeout(()=>this.dismiss(),this.CFc)}Ddk(Qa){this.Bu=
Qa}}Object(b.a)(wb,"FormulaByExampleCurtainLifterCallout",E.a,[]);var Ab=a(200);class nb extends e.a{constructor(Qa){super(Qa,"DataCleansingTeachingCallout",Ab.a.ha(1952),Ab.a.ha(1953),"",Ab.a.ha(1954),16777216,24,new h.a,!0,!1,!1,!1,!0,!0,!0,5,!0);this.v2d="[id=DataCleansingTaskPane]";this.Jxg=!1}FE(Qa,Db){this.nzg=String.format(x.a.instance.Xb(213),Qa);this.Jxg=Db}MNa(){return k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPaneDiscoverabilityCallout",!1)&&this.Jxg?
0:2}fmd(){return 2592E3}get eY(){return this.v2d}get dY(){return this.v2d}get yX(){return this.v2d}get ribbonCommandInfo(){return new d.a(-1190551534,f.a.fc,this.$.Tc,0,null)}}Object(b.a)(nb,"DataCleansingTeachingCallout",e.a,[]);var pb=a(114);class cb extends E.a{constructor(Qa){super(Qa);this.Bu=this.Cu=this.target=null;this.duration=0}FE(Qa,Db,sa){this.$o()||(this.target=Qa,this.Cu=this.Q1h(Db),this.Bu=x.a.instance.Ha(737),this.operation=Db,this.duration=sa)}show(){G.ULS.shipAssertTag(512304648,
0,!!this.target&&!!this.Bu&&!!this.Cu,"OptimizeWorkbookSlowOperationsCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");if(!this.$o()){G.ULS.sendTraceTag(512304647,0,50,"OptimizeWorkbookSlowOperationsCallout.Show() - Showing OptimizeWorkbookSlowOperationsCallout callout.");var Qa={["Operation"]:this.operation,["Duration"]:this.duration};ia.a.sendTelemetryEvent(Object(F.a)(new ya.a,{name:"Office.Excel.Online.OptimizeWorkbook.BigHammerSlowOperationsCalloutShown",
dataFields:pb.a.Wj(Qa)}));super.show()}}$o(){return!!this.lM}Zxa(){return Object(F.a)(new O.a,{target:this.target,title:this.Cu,content:this.Bu,showCloseIcon:!0,calloutProps:Object(F.a)(new B.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!1,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!0,hasFocusableControls:!1})}Q1h(Qa){switch(Qa){case 0:return x.a.instance.Ha(727);case 1:return x.a.instance.Ha(728);case 2:return x.a.instance.Ha(729);
case 3:return x.a.instance.Ha(730);case 4:return x.a.instance.Ha(731);case 5:return x.a.instance.Ha(732);case 6:return x.a.instance.Ha(733);case 7:return x.a.instance.Ha(734);case 8:return x.a.instance.Ha(735);case 9:return x.a.instance.Ha(736);default:return G.ULS.debugAssertTag(512304646,0,!1,"OptimizeWorkbookSlowOperationsCallout.getCalloutTitle: Invalid operation"),""}}}Object(b.a)(cb,"OptimizeWorkbookSlowOperationsCallout",E.a,[]);class Da extends E.a{constructor(){super(...arguments);this.tAg=
"ClickOnLaunch";this.Pzg="ClickOnDismiss";this.mBg="Show";this.$zg="BetterEntryPoint_InsertTab";this.CBg=500;this.nAg=280;this.mAg=192;this.WAg="[data-unique-id=Ribbon-InsertAddinTransitionEntry]";this.fAg="[data-unique-id=Home]";this.pAg="InsertAddinTransitionEntry";this.gAg="Home";this.oAg="InsertAddInFlyout";this.YAg="RibbonOverflowMenu-overflow"}FE(){}show(){this.RA(this.mBg);G.ULS.sendTraceTag(509367621,0,50,"ExcelBetterEntryTeachingCallout.Show() - Showing ExcelBetterEntryTeachingCallout callout.");
super.show()}Zxa(){let Qa=this.WAg;var Db=document.getElementById(this.pAg),sa=Db?window.getComputedStyle(Db,null):null;if(null==Db||sa&&"none"===sa.display)Qa=this.fAg;Db=CommonUIStrings.l_BetterEntryPointTUI_Title;var Ha=CommonUIStrings.l_BetterEntryPointTUI_Content;sa=new P.a("https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RE5elF8");Ha=Ha.split("\n");sa=Object.assign(new Z(Ha,sa),{imageWidth:this.nAg,imageHeight:this.mAg});sa=new R(sa);Ha=Object.assign(new L.a,{label:CommonUIStrings.l_BetterEntryPointTUI_ButtonText1,
ariaDescription:CommonUIStrings.l_BetterEntryPointTUI_ButtonText1,onExecute:()=>{this.wmi();this.RA(this.tAg);this.dismiss()}});const mb=Object.assign(new L.a,{label:CommonUIStrings.l_BetterEntryPointTUI_ButtonText2,ariaDescription:CommonUIStrings.l_BetterEntryPointTUI_ButtonText2,onExecute:()=>{this.RA(this.Pzg);this.dismiss()}});return Object.assign(new O.a,{target:Qa,content:sa,title:Db,primaryButtonProps:Ha,secondaryButtonProps:mb,showCloseIcon:!0,hasDynamicSizing:!1,preventLightDismiss:!1,useTeachingStyles:!0,
calloutProps:Object.assign(new B.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!0})})}wmi(){appChrome.api.dispatch(appChrome.actions.setCurrentTab(this.gAg));window.setTimeout(()=>{this.YBd()},this.CBg)}YBd(){const Qa=document.getElementById(this.oAg),Db=Qa?window.getComputedStyle(Qa,null):null;if(null==Qa||Db&&"none"===Db.display){const sa=document.getElementById(this.YAg);null!=sa?(sa.onclick=function(){window.setTimeout(()=>{const Ha=document.querySelector("[data-unique-id='Overflow-InsertAddInFlyout']");
null!=Ha&&(Ha.click(),G.ULS.sendTraceTag(509367620,0,50,"Launch flyout in overflow"))},500);sa.onclick=function(){}},sa.click()):G.ULS.sendTraceTag(509367619,0,10,"Neither ribbon nor overflow can launch flyout")}else Qa.click(),G.ULS.sendTraceTag(509367618,0,50,"Launch flyout in ribbon button")}RA(Qa){Qa={["AppTeachingUICalloutAction"]:Qa,["AppTeachingUICalloutGoal"]:this.$zg};ia.a.sendTelemetryEvent(Object.assign(new ya.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:pb.a.Wj(Qa)}))}}
Object(b.a)(Da,"ExcelBetterEntryTeachingCallout",E.a,[]);class zb extends e.a{constructor(Qa){super(Qa,"FunctionDialogTeachingCallout",void 0,x.a.instance.Ha(763),x.a.instance.Ha(760),x.a.instance.Ha(761),1073741824,30,new h.a,!0,!0,!1,!1,!0,!0,!0,5,!0)}FE(Qa){this.R3c=`[id=${"CellEdit"===Qa?this.$.qc+I.a.Yfc:"InsertFunction"}]`}MNa(){return 1}get eY(){return this.R3c}get dY(){return this.R3c}get yX(){return this.R3c}get ribbonCommandInfo(){return null}}Object(b.a)(zb,"FunctionDialogTeachingCallout",
e.a,[]);class qb extends Va{constructor(Qa){super("ExcelLiveWebEntryPointCallout");this.Hza=!1;this.Ukg=()=>{this.$.Ed(327119921,f.a.fc,9,null)};this.$=Qa;(this.Hza=k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelLiveWebEntryPointCalloutEnabled",!1))&&window.addEventListener("TryCoEditInTeams",this.Ukg,!0)}dispose(){this.Hza&&window.removeEventListener("TryCoEditInTeams",this.Ukg,!0)}}Object(b.a)(qb,"ExcelLiveWebEntryPointCallout",Va,[]);class Pa{constructor(Qa){this.$=Qa;this.Hx=
new z.a(!1)}Eai(Qa){if(!this.Hx.Pb(t[Qa]))switch(Qa){case 0:this.bmh(Qa);break;case 2:this.Hx.add(t[Qa],new V(this.$));break;case 3:this.Hx.add(t[Qa],new aa(this.$));break;case 6:this.Hx.add(t[Qa],new Ea(this.$));break;case 1:this.Hx.add(t[Qa],new m(this.$));break;case 4:this.Hx.add(t[Qa],new D.a(this.$));break;case 5:this.Hx.add(t[Qa],new H(this.$));break;case 7:this.Hx.add(t[Qa],new w(this.$));break;case 8:this.Hx.add(t[Qa],new oa(this.$));break;case 9:this.Hx.add(t[Qa],new y(this.$));break;case 13:this.Hx.add(t[Qa],
new za(this.$));break;case 10:this.Hx.add(t[Qa],new Ba(this.$));break;case 11:this.Hx.add(t[Qa],new ca(this.$));break;case 12:this.Hx.add(t[Qa],new U(this.$));break;case 14:this.Hx.add(t[Qa],new ja(this.$));break;case 15:this.Hx.add(t[Qa],new wb(this.$));break;case 16:this.Hx.add(t[Qa],new nb(this.$));break;case 18:this.Hx.add(t[Qa],new cb(this.$));break;case 20:this.Hx.add(t[Qa],new qb(this.$));break;case 19:this.Hx.add(t[Qa],new Da(this.$));break;case 21:this.Hx.add(t[Qa],new zb(this.$));break;
default:return null}return this.Hx.getItem(t[Qa])}bmh(Qa){this.Hx.add(t[Qa],new wa(this.$,x.a.instance.Ha(640),x.a.instance.Ha(637),x.a.instance.Ha(638),x.a.instance.Ha(639),16,4,!0))}}Object(b.a)(Pa,"EwaCalloutFactory",null,[]);var Nb=a(58),Tb=a(63),Vb=a(160);e=a(35);E=a(149);a.d(C,"b",function(){return c});a.d(C,"a",function(){return Jb});let Jb=class{constructor(Qa){this.$=Qa;this.eGh=new Pa(this.$)}yd(){return!1}Cd(){return!1}fd(Qa,Db,sa){Qa=sa.CalloutName;this.DWj=k.EwaSettings.isChangeGateEnabled("OfficeVSO:6189760_SuppressTeachingCalloutForLiveMeetings")&&
Object(Vb.c)(this.$)&&!this.Qzi(Qa);return!!Db&&-847286761===Db.command&&Nb.a.qh.HS&&!this.DWj}Qzi(Qa){return k.EwaSettings.isChangeGateEnabled("OfficeVSO:6774891_ShowCalloutForExcelLiveOnMobile")&&this.$.Sv&&9===Qa}executeCommand(Qa,Db,sa){Qa=sa.CalloutName;if(Db=this.eGh.Eai(Qa)){switch(Qa){case 2:Db.FE(sa.Target,sa.RibbonButtonLabel,sa.ExampleEntities,sa.BlankCellResourceId,sa.HasBlankCellWalkthrough,sa.ServiceDomain);break;case 3:Db.FE(sa.Target,sa.RibbonButtonLabel,sa.ExampleEntities);break;
case 6:Db.FE(sa.Target);break;case 8:Db.FE(sa.Target);break;case 13:Db.FE(sa.Target);break;case 15:return Db.XUb(sa.Target),Db.jxa(sa.NewState,sa.Reason),Tb.Task.Ua(!0);case 12:Db.FE(sa.Target,sa.ConvertToTableCallback,sa.NoThanksCallback);break;case 16:Db.FE(sa.SuggestionsCount,sa.WithoutCoolDown);break;case 18:Db.FE(sa.Target,sa.Operation,sa.Duration);break;case 19:Db.FE();break;case 21:Db.FE(sa.Trigger)}Db.show();return Tb.Task.Ua(!0)}return Tb.Task.Ua(!1)}};Jb=Object(r.b)([Object(E.d)(e.xb),Object(r.c)(0,
Object(e.E)())],Jb);Object(b.a)(Jb,"ShowCalloutCommandHandler",null,[210])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSOpt.pid.js.map/c3bde6e1315f5d267dcfa630f6b4e392/EwaDSOpt.pid.js.map