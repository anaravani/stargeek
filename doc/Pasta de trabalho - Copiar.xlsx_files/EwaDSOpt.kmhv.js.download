'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[50],{1516:function(r,C,a){a.r(C);var c={};a.r(c);a.d(c,"TryOfficeThroughTellMeCommandHandler",function(){return Pe});var b={};a.r(b);a.d(b,"NamedSheetViewPublic",function(){return de});var e={};a.r(e);a.d(e,"NamedSheetViewTeachingCallout",function(){return bf});var f={};a.r(f);a.d(f,"SheetOptionsToggleCommandHandler",function(){return Cc});var d=a(0),h=a(563),l=a(15),k=a(88),u=a(198),v=a(852),x=a(32),w=a(146);class m{static qDh(Wb){return m.eGe("New",
Wb)}static rDh(Wb){return m.eGe("Open",Wb)}static OFe(Wb,mc){return m.aka("LoadingMenuSection",m.ZOi,Wb,m.nub("lblLoading",mc))}static oub(Wb,mc,Mc=null,hd=null){return m.aka("MessageMenuSection",m.pFf,mc,m.nub("lblMessage",Wb,Mc,hd))}static w8g(Wb){return m.OFe(Wb,CommonUIStrings.l_VoicedLoadingText)}static x8g(Wb,mc){return m.oub(CommonUIStrings.l_NewCreationLocationMessage,Wb.Qi,mc.kT,mc.bra)}static v8g(Wb,mc){return m.oub(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,mc.bra,"\n\n"),
Wb.Qi)}static QFe(Wb){return m.oub(CommonUIStrings.l_NewGenericErrorMessage,Wb.Qi)}static t8g(Wb,mc,Mc){return m.aka("menuNewBlank",m.Xoi,Mc?Wb.Qi:null,m.gub(Wb.Tjf,Wb.Ujf,Wb.Vjf,null,Wb.S0,Wb.tDb,mc,"blank"))}static u9g(){return m.nub("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)}static bGe(){return m.nub("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)}static v9g(Wb,mc){return m.aka("menuNewTemplates",Wb,null,mc)}static r8g(Wb,mc){return m.aka("menuNewMoreTemplates",m.Q5e,
null,m.gub("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,Wb,mc))}static u7g(Wb,mc,Mc){let hd="";Mc&&mc&&(hd=m.aka("BrowseMoreMenuSection",m.Q5e,null,m.gub("btnBrowseMore",mc,mc,null,null,null,Wb||"1959943459",Mc)));return hd}static nub(Wb,mc,Mc=null,hd=null){let pd=hd;mc&&0<mc.length&&(pd=m.lGf.hxc(mc).trimEnd(),pd=0<=pd.indexOf("{0}")?String.format(pd,hd):String.format("{0} {1}",pd,hd));Mc=Mc&&hd?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',
x.a.dg(Mc),x.a.dg(hd),x.a.dg(pd)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',x.a.dg(Wb||""),m.lGf.hxc(x.a.dg(mc||"")),Mc)}static gub(Wb,mc,Mc,hd,pd,Nd,Xd,ae){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',x.a.dg(Wb||""),x.a.dg(mc||
""),x.a.dg(Mc||""),hd||"32by32",x.a.dg(pd||""),x.a.dg(Nd||""),Xd,x.a.dg(ae||""))}static eGe(Wb,mc){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',Wb,mc)}static aka(Wb,mc,Mc,hd){Mc=Mc?String.format('Title="{0}"',x.a.dg(Mc)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',
x.a.dg(Wb||""),x.a.dg(mc||""),Mc,hd)}}m.pFf="MenuMru";m.ZOi="MenuLoading";m.Xoi="MenuHeader";m.Q5e="MenuFooter";m.lGf=w.a.dz("\n","&#10;");Object(d.a)(m,"NewAndOpenXmlUtilities",null,[]);var t=a(6),z=a(103),y=a(128),D=a(140);class H{constructor(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}}Object(d.a)(H,"HostInformation",null,[]);var F=a(112),G=a(108),L=a(41),M=a(235),O=a(384),B=a(179),E=a(666),I=a(588),S=a(111),J=a(27),K=a(70);class R{constructor(Wb,mc,Mc,hd,pd,Nd){this.J0a=this.Oo=
this.YWb=null;this.T1b=this.xZc=!1;this.Rle=0;this.nZc=this.GTc=!1;this.t4=Wb;this.dnb=mc;this.TGa=new h.a(()=>new v.a(Mc.value,Object(k.a)(this,this.uBb,"getMoreInfoEventReceived")));this.eLg=hd;this.Kta=pd;this.qOg=Nd;this.rqb=this.$Ec;this.VZb=!!t.AFrameworkApplication.fa&&t.AFrameworkApplication.fa.ra("GateTemplateRenderingByGetMoreInfoResponse");2===this.UA.VO&&(this.nZc=!0);t.AFrameworkApplication.fa&&t.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",
!1)&&this.FRh()}get fR(){switch(this.UA.VO){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}FRh(){G.a.instance.wg(new F.a(5,1,0,()=>{this.getTemplateListJson()}))}Ih(){const Wb=this.UA.Acb;Wb.Hc(J.a.newDocument,S.a.frame,Object(k.a)(this,this.newDocument,"newDocument"));Wb.Hc(J.a.zxc,S.a.frame,Object(k.a)(this,this.zxc,"populateNewMenu"))}newDocument(Wb,mc,Mc,hd,pd){if(1===Mc)return 32;if(2===Mc&&pd){if(t.AFrameworkApplication.fa.ra("BackstagePremiumTemplateExperienceEnabled")&&
pd.IsPremium)return appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1)),t.AFrameworkApplication.dc.processAction(J.a.hlj,2);if(pd.MenuItemId&&pd.SourceControlId)return"NewDocumentHome"===pd.SourceControlId&&y.a("NewDocumentFromHomeTab"),this.J4a(pd.MenuItemId,pd.SourceControlId)}return 8}J4a(Wb,mc){var Mc=this.rtc.ubd;if(null===Mc)return 8;var hd=t.AFrameworkApplication.fa.ra("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(t.AFrameworkApplication.xea&&hd){l.ULS.sendTraceTag(51455198,
202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");const pd={};pd[O.a.cog]=Wb;pd[O.a.fR]=this.fR;pd[O.a.lcid]=t.AFrameworkApplication.lcid.toString();pd[O.a.reason]=E.a.createNew;pd[O.a.uiCulture]=t.AFrameworkApplication.uiCulture;pd[O.a.dataCulture]=t.AFrameworkApplication.dataCulture;t.AFrameworkApplication.oS().execute(Nd=>{Nd.sendMessage(B.a.J4a,pd)})}else hd=(new Date).getTime(),mc=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",
Mc,x.a.Rf(this.Goa),x.a.Rf(Wb),x.a.Rf(this.fR),x.a.Rf(t.AFrameworkApplication.lcid.toString()),x.a.Rf(hd.toString()),x.a.Rf(mc),x.a.Rf(t.AFrameworkApplication.canary),t.AFrameworkApplication.oj),(Mc=t.AFrameworkApplication.fa.Va("ScenarioId"))&&""!==Mc&&(mc+="&wdscenarioid="+x.a.Rf(Mc)),mc+="&"+t.AFrameworkApplication.Eic(),t.AFrameworkApplication.Mna&&(mc+="&"+t.AFrameworkApplication.Zhc()),(Mc=this.Oo?this.Oo.kT:null)?mc+="&DestinationUrl="+x.a.Rf(Mc):3===this.UA.VO&&l.ULS.sendTraceTag(508928088,
202,10,"CreateNewDocument: getMorInfoResult is null or PersonalFileStorageUrl is empty"),L.a.Vf(mc,"_blank",void 0,"CreateNewDocument");2!==this.UA.VO&&3!==this.UA.VO||l.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:I.a[this.UA.VO],["Template"]:Wb});t.AFrameworkApplication.fa&&t.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.Excel.ChangeGate.ConsumerTemplateTelemetry")&&1===this.UA.VO&&("blank"===Wb?y.b("ConsumerTemplateNewBlank"):(Wb=[Object.assign(new K.a,
{name:"TemplateId",string:Wb})],y.b("ConsumerTemplateNew",null,0,!0,0,Wb)));return 32}sSi(Wb){let mc=Number.MAX_VALUE,Mc=Number.MIN_VALUE;const hd=window.performance;if(hd&&"undefined"!==typeof hd.getEntriesByName){for(let Nd=0;Nd<Wb.length;Nd++){var pd=hd.getEntriesByName(Wb[Nd]);pd&&0<pd.length&&(pd=pd[0],mc=Math.min(parseInt(String(pd.fetchStart)),mc),Mc=Math.max(parseInt(String(pd.responseEnd)),Mc))}Mc>mc&&l.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:Mc-
mc,["MinFetchStart"]:mc,["MaxResponseEnd"]:Mc})}}zxc(Wb,mc,Mc,hd,pd){if(1===Mc)return this.nZc&&(t.AFrameworkApplication.WS("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),this.nZc=!1),32;2!==Mc||this.GTc||(this.Rle=(new Date).getTime(),l.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",{["ShouldShowTemplates"]:this.$Ec,["CachedNewMenuXmlExists"]:!!this.YWb,["ShouldCallGetMoreInfo"]:this.UA.supportsGetMoreInfoForPersonalStorage}));t.AFrameworkApplication.w8("AdditionalDocumentTemplates-tf;AdditionalDocumentTemplates-cf");
t.AFrameworkApplication.w8("WordConsumerTemplates-tf;WordConsumerTemplates-cf");return this.Zjj(pd)}Zjj(Wb){Wb&&(this.YWb?Wb.PopulationXML=this.YWb:(this.UA.supportsGetMoreInfoForPersonalStorage&&!this.Oo&&this.TYi.I0("Opened New menu",!0),Wb.PopulationXML=this.QZh(this.getTemplateListJson())));return 32}Rtf(){return!this.UA.supportsGetMoreInfoForPersonalStorage||!!this.Oo&&3===this.Oo.state&&!!this.Oo.bra&&!!this.Oo.kT}Myd(){return t.AFrameworkApplication.sa&&t.AFrameworkApplication.sa.Qa.k1&&!this.VZb?
!0:this.Rtf()}getTemplateListJson(){if(!this.$Ec&&!this.VZb&&!this.Myd())return null;if(this.rqb&&!this.T1b){var Wb="9";t.AFrameworkApplication.fa&&t.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)&&(Wb="21");const mc=t.AFrameworkApplication.fa.appSettings;"NumberOfTemplatesInBackstage"in mc&&(Wb=mc.NumberOfTemplatesInBackstage);let Mc=this.fR;"TemplateCollectionId"in mc&&(Mc=mc.TemplateCollectionId);t.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordConsumerTemplates",
!1)&&(Mc="WordConsumerWAC",Wb="23");Wb=String.format(this.UA.L1+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",x.a.Rf(t.AFrameworkApplication.lcid.toString()),x.a.Rf(Mc),Wb);Boolean.parse(mc.AppendOriginQueryParam||"false")&&(Wb+="&org=backstage");Boolean.parse(mc.BackstagePremiumTemplateExperienceEnabled||"false")&&"TemplateTier"in mc&&(Wb+="&templateTier="+mc.TemplateTier);Wb+="&"+t.AFrameworkApplication.Eic();t.AFrameworkApplication.Mna&&(Wb+="&"+t.AFrameworkApplication.Zhc());this.UA.GJb.Sn(Wb,
1,null,null,!1,2,hd=>{this.UA.vRa("CreateNewActor.GetTemplateListJson",hd.data);this.N5j(hd.data.Pe)},hd=>{this.UA.vRa("CreateNewActor.GetTemplateListJson",hd.data);this.M5j()},null,void 0,void 0,void 0,void 0,"5");this.rqb=!1}return this.J0a}N5j(Wb){t.AFrameworkApplication.fa&&t.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)?this.J0a=this.JSh(Wb):this.J0a=Wb;this.rqb=!1;this.MNb();if(this.VZb){if(!this.Oo)return;if(this.Oo&&!this.Myd()){l.ULS.sendTraceTag(508867410,
202,10,"GetMoreInfo Received but info is missing");this.ced();return}}this.EUe()}EUe(){if(t.AFrameworkApplication.sa&&t.AFrameworkApplication.sa.Qa.k1&&D.c()){const Wb=t.AFrameworkApplication.fa.ra("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC"),mc=t.AFrameworkApplication.xea;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.J0a,!0,Wb&&mc));3===this.UA.VO&&l.ULS.sendTraceTag(508867409,202,15,"DispatchSuccessTemplateListJson")}}M5j(){this.T1b=this.rqb=!0;this.MNb();this.ced();
z.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)}ced(){t.AFrameworkApplication.sa&&t.AFrameworkApplication.sa.Qa.k1&&D.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1)),3===this.UA.VO&&l.ULS.sendTraceTag(508867408,202,15,"DispatchFailureTemplateListJson"))}JSh(Wb){Wb=JSON.parse(Wb);const mc=new u.a;mc.add("TM00002102");mc.add("TM00002101");mc.add("TM16392939");const Mc=M.a.y9d(Wb,hd=>mc.contains(hd.AssetId));
Wb=Wb.slice(0,9);Wb.splice.apply(Wb,[2,0].concat(Mc));return JSON.stringify(Wb)}Qgi(Wb){var mc=0;for(var Mc=0;Mc<Wb.length;Mc++)if("ST"===Wb[Mc].ImageType){mc=Mc;break}const hd=Wb.length?Wb[mc]:null;Wb=hd?hd.Url||"":"";var pd;let Nd=Mc=mc=!1;if(hd&&(pd=hd.AspectRatio))pd=parseFloat(pd),1>pd?mc=!0:1.5<pd?Mc=!0:1===pd&&(Nd=!0);else switch(l.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",{["Url"]:Wb}),this.UA.VO){case 3:mc=!0;break;case 2:Mc=!0;break;case 5:Nd=!0}return{returnValue:Wb,
zri:mc?"95by123":Mc?"123by69":Nd?"100by100":"123by95"}}QZh(Wb){Wb=({CEc:mc}=this.u8g(Wb,this.rtc,this.rtc.jKa||"1056925771")).returnValue;if(mc){this.YWb=Wb;var mc=(new Date).getTime()-this.Rle;l.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",{["ElapsedMsSinceMenuOpened"]:mc})}return Wb}uBb(Wb,mc){l.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.Oo||3!==Wb.state?2===Wb.state&&(l.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),
this.xZc=!0,this.MNb()):(this.Oo=Wb,mc||this.MNb(),t.AFrameworkApplication.sa&&t.AFrameworkApplication.sa.Qa.k1&&D.c()&&D.d("setFileMenuHostInformation")&&(Wb=Object.assign(new H,{hostUrl:this.Oo.kT,hostName:this.Oo.bra,folderUrl:t.AFrameworkApplication.breadcrumbFolderUrl,folderName:t.AFrameworkApplication.breadcrumbFolderName}),l.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(Wb)),this.VZb&&this.J0a&&this.J0a.length&&
(this.Myd()?this.EUe():this.ced(),l.ULS.sendTraceTag(508867407,202,15,"Dispatched on GetMoreInfoReceived"))))}u8g(Wb,mc,Mc){let hd;hd=!1;const pd=this.Rtf();let Nd="";this.UA.supportsGetMoreInfoForPersonalStorage&&(this.xZc?(Nd=m.QFe(mc),this.xZc=!1,l.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):this.Oo?pd?Nd=m.x8g(mc,this.Oo):this.Oo.Swi?(hd=!0,this.rqb=!1,Nd=m.v8g(mc,this.Oo),l.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):
(hd=!0,Nd=m.QFe(mc),l.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",{["PersonalFileStorageUrlIsSet"]:!!this.Oo.kT,["StorageServiceDisplayNameIsSet"]:!!this.Oo.bra})):(Nd=m.w8g(mc.Qi),l.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));pd&&(Nd+=m.t8g(mc,Mc,!Nd)+({CEc:hd}=this.t9g(Wb,Mc)).returnValue);return{returnValue:m.qDh(Nd),CEc:hd}}t9g(Wb,mc){let Mc;Mc=!1;if(!this.$Ec)return Mc=!0,l.ULS.sendTraceTag(5849609,
202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",CEc:Mc};let hd="",pd="",Nd="MenuTemplate";if(this.T1b)hd=m.bGe(),this.T1b=!1,l.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(Wb){try{const Xd=Sys.Serialization.JavaScriptSerializer.deserialize(Wb,!0);hd=this.s9g(Xd,mc);l.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");t.AFrameworkApplication.mGf&&"OneDrive"===this.Goa&&(pd=m.r8g(this.UYi,t.AFrameworkApplication.mGf))}catch(Xd){l.ULS.sendTraceTag(5849613,
202,10,"Failed to parse JSON response from template service {0}",{["JsonToConvert"]:Wb}),hd=m.bGe()}Mc=!0}else Nd="MenuLoading",hd=m.u9g(),l.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:m.v9g(Nd,hd)+pd,CEc:Mc}}s9g(Wb,mc){let Mc="";const hd=[];for(let Nd=0;Nd<Wb.length;Nd++){var pd=Wb[Nd];let Xd="";if(pd){const ae=pd.Title,Ve=pd.AssetId;pd=pd.Thumbnails;Ve&&ae&&pd&&({zri:pd,returnValue:Xd}=this.Qgi(pd),Mc+=m.gub("jbtnNewTemplate"+Nd,ae,null,
pd,null,Xd,mc,Ve))}hd[Nd]=Xd}Wb=new F.a(4,1,5E3,()=>{this.sSi(hd)},106);this.UA.ptc.wg(Wb);return Mc}MNb(){this.GTc=!0;this.UA.eGf.Cy(this.rtc.Izb);this.GTc=!1}get UA(){return this.t4.value}get rtc(){return this.dnb.value}get TYi(){return this.TGa.value}get UYi(){return this.eLg.value}get Goa(){return this.Kta.value}get $Ec(){return this.qOg.value}}Object(d.a)(R,"CreateNewActor",null,[]);var Z=a(1393);class P extends Z.a{constructor(){super()}mxe(){this.eV(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);
this.eV(1,CommonUIStrings.l_OpenMenuServerErrorMessage);this.eV(2,CommonUIStrings.l_Open);this.eV(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.eV(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.eV(5,CommonUIStrings.l_VoicedLoadingText)}static get instance(){return P.Oa||(P.Oa=new P)}static sfj(Wb){return P.instance.ha(Wb)}}P.Oa=null;Object(d.a)(P,"MruActorIntlHelper",Z.a,[]);var V;(function(Wb){Wb[Wb.success=0]="success";Wb[Wb.failure=1]="failure";Wb[Wb.spinner=2]="spinner";Wb[Wb.none=3]="none"})(V||
(V={}));Object(d.b)("DisplayState",V);var Ea=a(43);class oa{constructor(Wb,mc,Mc,hd,pd,Nd,Xd,ae){this.YNc=null;this.n0c=!0;this.XWb="";this.cQg=0;this.s_a=null;this.uUc=3;this.Ra=ae;this.t4=Wb;this.hk=mc;this.dHg=Mc;this.gEg=hd;this.fEg=pd;this.TGa=new h.a(()=>new v.a(Nd.value,null));this.NHg=new h.a(()=>new v.a(Xd.value,Object(k.a)(this,this.DXi,"mruEventResultReceived")));this.Ra.ra("WacInTabOpenMRUIsEnabledForUiHost");this.Ra.ra("UiHostSupportsDocRebootFeatures")}DXi(Wb,mc){this.s_a=Wb;mc||this.e2f()}cvj(){this.$E.Acb.pf(J.a.yxc,
S.a.frame,Object(k.a)(this,this.yxc,"populateMruMenu"),96)}yxc(Wb,mc,Mc,hd,pd){return 1!==Mc&&pd?this.Vjj(pd):32}Vjj(Wb){this.WDh();this.VDh();Wb.PopulationXML=m.rDh(this.XWb+this.YNc);return 32}WDh(){var Wb=3;let mc=!1;if(this.XWb&&this.cQg===this.s_a.A7j)l.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),Wb=this.uUc;else{l.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});
var Mc=this.$E.Sx();this.s_a=this.CXi.I0("File Open opened",!0);this.XWb&&2!==this.uUc&&3!==this.s_a.state?mc=!0:(Wb=this.Cei(this.s_a),t.AFrameworkApplication.sa&&t.AFrameworkApplication.sa.Qa.k1&&D.c()&&Wb&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(Wb,!0)),this.XWb=({LYi:Wb}=this.RZh(this.s_a)).returnValue);Mc=this.$E.Sx()-Mc;l.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:Mc})}2!==Wb&&(Mc={["DisplayState"]:V[Wb]},
1!==Wb&&(Mc.IsStale=mc),l.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",Mc));this.uUc=Wb}Cei(Wb){let mc;try{mc=Ea.c(Wb.rGd)}catch(Mc){mc=null,l.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",Mc)}return mc}VDh(){this.n0c?(l.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.YNc=({glk:this.n0c}=this.LTi()).returnValue):l.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");
l.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",{["WaitingOnLinkInfo"]:this.n0c,["NotDisplayingLink"]:!this.YNc})}RZh(Wb){let mc;1===Wb.state||0===Wb.state?(l.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),Wb=2,mc=m.OFe(this.Kma(2),this.Kma(5))):3===Wb.state&&Wb.rGd?(mc=this.s8g(Wb.rGd),Wb=0):(l.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),mc=m.oub(this.Kma(1),this.Kma(2)),Wb=1);return{returnValue:mc,
LYi:Wb}}s8g(Wb){let mc;const Mc=this.YIb.jKa||"2155708348";if(Wb.length){mc=m.nub("lblRecentDocuments",this.Kma(3));let hd=0;for(let pd=0;pd<Wb.length;pd++){const Nd=Wb[pd];"FileName"in Nd&&"DocumentUrl"in Nd&&"Path"in Nd&&(mc+=m.gub("MruButton"+pd,Nd.FileName.toString(),Nd.Path.toString(),null,this.YIb.S0,this.YIb.tDb,Mc,Nd.DocumentUrl.toString()),Nd.IsPinned&&hd++)}mc=m.aka("RecentDocumentsMenuSection",m.pFf,this.Kma(2),mc);l.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",
["TotalDocuments"]:Wb.length,["NumPinnedDocuments"]:hd})}else mc=m.oub(this.Kma(0),this.Kma(2)),l.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return mc}LTi(){let Wb;Wb=!0;let mc=this.O6g;var Mc=this.N6g;if(mc&&Mc||!this.$E.supportsGetMoreInfoForPersonalStorage)Wb=!1;else{const hd=this.fic.I0("File Open",!1);3===hd.state&&(mc=hd.kT,Mc=hd.bra,Wb=!1)}Mc=Mc?String.format(this.Kma(4),Mc):null;return{returnValue:m.u7g(this.YIb.jKa,Mc,mc),glk:Wb}}e2f(){this.$E.eGf.Cy(this.YIb.Izb)}get $E(){return this.t4.value}get Kma(){return this.hk.value}get YIb(){return this.dHg.value}get O6g(){return this.gEg.value}get N6g(){return this.fEg.value}get fic(){return this.TGa.value}get CXi(){return this.NHg.value}}
Object(d.a)(oa,"MruRenderer",null,[]);var ea=a(251),aa=a(801);class ia{constructor(Wb,mc,Mc,hd,pd,Nd,Xd){this.Oo=null;this.Jqe=!1;this.dta=this.$be=0;this.lLg=Wb;this.H_a=mc;this.L_b=Mc;this.dnb=hd;this.Kta=pd;this.t4=Nd;this.TGa=new h.a(()=>new v.a(Xd.value,Object(k.a)(this,this.uBb,"getMoreInfoEventReceived")))}J4a(){!this.Oo&&this.YGd.supportsGetMoreInfoForPersonalStorage?this.fic.I0("NewDocumentFromStream",!0):this.createNewDocumentFromStream()}uBb(Wb){if(!this.Oo&&3===Wb.state)this.Oo=Wb;else if(2===
Wb.state){this.Jqe?l.ULS.sendTraceTag(24904471,202,10,"After second try GetMoreResult still fail."):(this.fic.I0("NewDocumentFromStream",!0),this.Jqe=!0);return}this.createNewDocumentFromStream()}createNewDocumentFromStream(){this.$be=(new Date).getTime();var Wb=this.$Rh.ubd;if(null===Wb)this.H_a(null);else{var mc=this.L_b.menuItemId,Mc=this.L_b.lF,hd=this.L_b.q3j,pd=this.L_b.eSh;this.dta="streamBase64"===hd?pd.length/1024:0;l.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.fR,
this.dta);var Nd=(new Date).getTime();Wb=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",Wb,x.a.Rf(this.Goa),x.a.Rf(mc),x.a.Rf(this.fR),x.a.Rf(t.AFrameworkApplication.lcid.toString()),x.a.Rf(Nd.toString()),x.a.Rf(Mc),x.a.Rf(t.AFrameworkApplication.canary),t.AFrameworkApplication.oj,x.a.Rf(hd));Wb+="&"+t.AFrameworkApplication.Eic();t.AFrameworkApplication.Mna&&(Wb+="&"+t.AFrameworkApplication.Zhc());(mc=this.Oo?this.Oo.kT:null)&&
(Wb+="&DestinationUrl="+x.a.Rf(mc));this.YGd.GJb.Sn(Wb,2,pd,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(k.a)(this,this.OYi,"newDocumentFromStreamSuccessHandler"),Object(k.a)(this,this.NYi,"newDocumentFromStreamFailureHandler"),null,void 0,void 0,void 0,void 0,"31")}}OYi(Wb){if(Wb&&Wb.data&&Wb.data.Pe)if(({Bt:mc}=Ea.d(Wb.data.Pe)).returnValue)if(Wb=mc,Wb.StatusCode!==ea.a.xK&&Wb.StatusCode!==ea.a.Qwb)l.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",
this.fR,this.dta,Wb.StatusCode),this.H_a(null);else if(Wb.NewDocumentUrl&&""!==Wb.NewDocumentUrl){var mc=(new Date).getTime()-this.$be;l.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.fR,this.dta,mc);this.lLg(Wb.NewDocumentUrl)}else l.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.fR,this.dta),this.H_a(null);else l.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",
this.fR,this.dta,{["ResponseData"]:aa.a.Mjb(Wb.data.Pe)}),this.H_a(null);else l.ULS.sendTraceTag(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.fR,this.dta),this.H_a(null)}NYi(Wb){Wb&&Wb.data&&l.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.fR,this.dta,Wb.data.status);this.H_a(null)}get fR(){switch(this.YGd.VO){case 3:return"WordWAC";case 1:return"ExcelWAC";
case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get $Rh(){return this.dnb.value}get Goa(){return this.Kta.value}get YGd(){return this.t4.value}get fic(){return this.TGa.value}}Object(d.a)(ia,"NewDocumentFromStreamOperation",null,[]);class ya{constructor(Wb,mc,Mc,hd){this.dnb=Wb;this.Kta=mc;this.t4=Mc;this.MHg=hd}create(Wb,mc,Mc){return new ia(Wb,mc,Mc,this.dnb,this.Kta,this.t4,this.MHg)}}Object(d.a)(ya,"NewDocumentFromStreamOperationFactory",null,[551]);var za=a(84),la=a(529),xa=
a(63);class wa{get name(){return"Common.App.NewAndOpen.UX"}Oi(Wb){Wb.register(ya,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").gd().od(()=>new ya(new h.a(()=>t.AFrameworkApplication.sa.Qa.Qmd()),new h.a(()=>t.AFrameworkApplication.Goa),new h.a(()=>Wb.nh("Common.INewAndOpenCommonHelpers")),new h.a(()=>Wb.nh("Common.IEventEmitter<Common.IGetMoreInfoResult>"))))}init(){t.AFrameworkApplication.fa.Rv(()=>{this.MDb()})}MDb(){const Wb=
la.a.mr(za.a.instance.Dc("Common.INewAndOpenCommonHelpers")),mc=la.a.mr(za.a.instance.Dc("Common.IEventEmitter<Common.IGetMoreInfoResult>"));t.AFrameworkApplication.Goa&&xa.Task.WAA.call(null,Wb,mc).continueWith(()=>{const Mc=new R(new h.a(()=>Wb.result),new h.a(()=>t.AFrameworkApplication.sa.Qa.Qmd()),new h.a(()=>mc.result),new h.a(()=>t.AFrameworkApplication.sa.Qa.Rmd().jKa||"1959943459"),new h.a(()=>t.AFrameworkApplication.Goa),new h.a(()=>t.AFrameworkApplication.gFi));Mc.Ih();Mc.MNb()});if(t.AFrameworkApplication.E0f){const Mc=
la.a.mr(za.a.instance.Dc("Common.IEventEmitter<Common.IMruResult>"));xa.Task.WAA.call(null,Wb,mc,Mc).continueWith(()=>{const hd=new oa(new h.a(()=>Wb.result),new h.a(()=>P.sfj),new h.a(()=>t.AFrameworkApplication.sa.Qa.Rmd()),new h.a(()=>t.AFrameworkApplication.rfj),new h.a(()=>t.AFrameworkApplication.qfj),new h.a(()=>mc.result),new h.a(()=>Mc.result),t.AFrameworkApplication.fa);hd.cvj();hd.e2f()})}}dispose(){}}Object(d.a)(wa,"UXPackageManager",null,[4,5,2]);var hb=a(261),Ja=a(10),Fa=a(724),Ba=a(52),
fa=a(40),ta=a(199),Oa=a(1);class Ma{constructor(Wb){this.Ni=Wb}yd(){return!1}executeCommand(Wb,mc,Mc){return 2!==this.Ni.Le(J.a.newDocument,2,Mc)?xa.Task.Ua(!0):ta.a(mc.command)}fd(Wb,mc){return 1056925771===mc.command}Cd(Wb,mc,Mc){Wb=!0;switch(mc){case "PopulateNewMenu":this.Ni&&(Oa.EwaSettings.isChangeGateEnabled("OfficeVSO:6883546_ConsumerTemplatesFileNewTrigger")&&t.AFrameworkApplication.NO("XLS-ConsumerTemplates-Treatment;XLS-ConsumerTemplates-Control"),Oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConsumerTemplates",
!1)&&(t.AFrameworkApplication.fa.appSettings.TemplateCollectionId="ExcelConsumerWAC",t.AFrameworkApplication.fa.appSettings.NumberOfTemplatesInBackstage="23"),this.Ni.Le(J.a.zxc,2,Mc));break;default:Wb=!1}return Wb}}Object(d.a)(Ma,"CreateNewCommandHandler",null,[210]);var fb=a(100),pa=a(149),Ua=a(35);class Sa extends Fa.a{constructor(Wb){super(Wb)}ue(){const Wb=Oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateCommonUiStrings",!1)?Object(fb.d)(pa.a.resolve(Ua.p,{Wa:this.La})):Ba.GetServiceTaskFactory.create(this.$.da,
155,this.ka,this.La),mc=Ba.GetServiceTaskFactory.create(this.$.da,165,this.ka,this.La);fa.TaskExtensions.za(fa.TaskExtensions.xe([Wb,mc],this.ka),()=>{this.Zd([new Ma(t.AFrameworkApplication.dc)])},this.ka,3)}static la(Wb){Fa.a.Ie(87,new Sa(Wb))}}Object(d.a)(Sa,"CreateNewCommandHandlerFactory",Fa.a,[]);var Ia=a(522),X=a(94),ca=a(201),U=a(12),ma=a(23),ra=a(248),Va=a(466);class ob{}ob.create="Create";ob.activate="Activate";ob.close="Close";ob.remove="Delete";ob.duplicate="Duplicate";Object(d.a)(ob,
"Actions",null,[]);var ja=a(34),lb=a(50);class wb extends xa.Task{constructor(Wb){super();this.Z9d=null;this.a$d=0;this.MWb=null;this._state=0;this.moveNext=()=>{try{for(this._state=1;1===this._state;)this.I_a=this.I_a()}catch(mc){this.dispose(),this.HDa(mc),this._state=3}};this.ov=Wb;this.I_a=this.ILc;this.moveNext()}ILc(){this.Z9d=ja.a.Wd(3,2,0,1667,0,-1244327602,"MsFormDeleteConfirmation");this.MWb=lb.a(this.ov.$).wk(this.Z9d).G();this.MWb.isCompleted||(this._state=2,this.MWb.adb(this.moveNext));
return this.xyg}xyg(){this.a$d=this.MWb.I0();0===this.a$d&&(this.ov.$.workbookContext.Options=U.HelperMethods.VP(!1,this.ov.$.workbookContext.Options,2048),this.ov.deleteMsFormMetaDataSheet());this._state=3;this.rVa(!0)}dispose(){}}Object(d.a)(wb,"$$sm_Microsoft$Office$Excel$WebUI$Client$MsForm$MsFormCommandHandler$DeleteMsForm",xa.Task,[2]);class Ab{}Ab.action="Action";Ab.CUh="FlexPane";Ab.Vfc="formId";Ab.id="id";Ab.title="Title";Ab.YVb="XlWorkbookId";Ab.zWh="Fragment";Ab.host="Host";Ab.J8j="TopView";
Ab.accountType="auth_pvr";Object(d.a)(Ab,"Parameters",null,[]);var nb=a(59);const pb=(Wb,mc,Mc,hd,pd,Nd,Xd=null)=>{Xd=Wb.Pa(9,Xd);Xd.sheetName=mc;Xd.confirmationChoice=!0;return nb.g(Wb,"DeleteSheet",Xd,Mc,hd,pd,Nd,0)};class cb{constructor(Wb){this.To="Excel";this.$=Wb;this.uW=Va.a.current}get hasMsForm(){return X.c(this.$.Df)}get btc(){return this.$.workbookContext.MsFormId}get VVb(){return this.$.workbookContext.MsFormDocUrl}get accountType(){return ma.a.contains(this.$.nA.DocumentHostInfo.FileSource,
"onedrive",!0)?"MSA":"OrgId"}yd(Wb,mc){switch(mc){case -105284469:return!X.k(this.$.Df)||this.hasMsForm;case -1219864912:case 1674421386:case -1128532220:case 2023601781:return!this.hasMsForm}return!1}executeCommand(Wb,mc){Wb=fa.TaskExtensions.Ik();mc=mc.command;switch(mc){case -105284469:this.insertMsForm();break;case -1219864912:this.previewMsForm();break;case -1128532220:this.editMsForm();break;case 1674421386:this.sendMsForm();break;case 2023601781:Wb=this.deleteMsForm();break;default:Wb=ta.a(mc)}return Wb}fd(Wb,
mc){if(!this.$.ea.Dh.get(61))return!1;Wb=!1;switch(mc.command){case -105284469:Wb=X.k(this.$.Df)&&!this.hasMsForm;break;case -1219864912:case 1674421386:case -1128532220:case 2023601781:Wb=this.hasMsForm}return Wb}Cd(){return!1}insertMsForm(){const Wb=x.a.Sq(this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),mc={},Mc={};mc[Ab.action]=ob.create;mc[Ab.accountType]=this.accountType;Mc[Ab.action]=ob.create;Mc[Ab.YVb]=encodeURIComponent(this.VVb);Mc[Ab.host]=this.To;Mc[Ab.title]=encodeURIComponent(Wb);
this.OIb(mc,Mc);this.$.workbookContext.Options=U.HelperMethods.VP(!1,this.$.workbookContext.Options,2048)}editMsForm(){const Wb={},mc={};Wb[Ab.accountType]=this.accountType;mc[Ab.Vfc]=this.btc;mc[Ab.YVb]=encodeURIComponent(this.VVb);mc[Ab.host]=this.To;this.OIb(Wb,mc)}previewMsForm(){const Wb={},mc={};Wb[Ab.accountType]=this.accountType;mc[Ab.Vfc]=this.btc;mc[Ab.YVb]=encodeURIComponent(this.VVb);mc[Ab.host]=this.To;mc[Ab.J8j]="Preview";this.OIb(Wb,mc)}sendMsForm(){const Wb={},mc={};Wb[Ab.accountType]=
this.accountType;mc[Ab.Vfc]=this.btc;mc[Ab.CUh]="SendForm";mc[Ab.YVb]=encodeURIComponent(this.VVb);mc[Ab.host]=this.To;this.OIb(Wb,mc)}deleteMsForm(){return new wb(this)}deleteMsFormMetaDataSheet(){this.$.userOperationManager.uG(new ca.a(158,0,(Wb,mc,Mc)=>pb(this.$.qa.gy,this.uW.Qzb,ra.b(Wb,()=>{this.hwh()}),mc,Mc,null)))}hwh(){const Wb={},mc={};Wb[Ab.action]=ob.remove;Wb[Ab.accountType]=this.accountType;mc[Ab.action]=ob.remove;mc[Ab.host]=this.To;mc[Ab.Vfc]=encodeURIComponent(this.btc);mc[Ab.YVb]=
encodeURIComponent(this.VVb);this.OIb(Wb,mc)}OIb(Wb,mc){const Mc=this.$.xa.MsFormBaseUrl+"/Pages/DesignPage.aspx";let hd="";var pd="";if(mc){for(let ae in mc){var Nd=ae,Xd=mc[ae];pd+=pd.length?"&":"";pd+=Nd+"="+Xd}Wb||(Wb={});Wb[Ab.zWh]=encodeURIComponent(pd)}if(Wb)for(let ae in Wb)mc=ae,pd=Wb[ae],hd+=hd.length?"&":"?",hd+=mc+"="+pd;window.open(Mc+hd,"_blank")}}Object(d.a)(cb,"MsFormCommandHandler",null,[210]);class Da extends Fa.a{constructor(Wb){super(Wb)}ue(){const Wb=Ba.GetServiceTaskFactory.create(this.$.da,
203,this.ka,this.La);fa.TaskExtensions.za(fa.TaskExtensions.xe([Wb],this.ka),()=>{this.Zd([new cb(this.$)])},this.ka,3)}static la(Wb){Wb.ea.Dh.get(61)&&Fa.a.Ie(215,new Da(Wb))}}Object(d.a)(Da,"MsFormCommandHandlerFactory",Fa.a,[]);var zb=a(230),qb=a(72);class Pa extends zb.a{constructor(Wb){super();this.$=Wb;this.uc()}create(){fa.TaskExtensions.za(Object(qb.b)("OfficeVSO:7624895_MigrateNewAndOpenCoreManagerToNewServiceInfra")?Object(fb.d)(pa.a.resolve(Ua.fb,{Wa:this.La})):Ba.GetServiceTaskFactory.create(this.$.da,
164,this.ka,this.La),()=>{this.$b(new wa)},this.ka,3)}}Object(d.a)(Pa,"NewAndOpenUXFactory",zb.a,[]);class Nb{constructor(Wb,mc){this.Ni=mc;this.$=Wb}executeCommand(Wb,mc,Mc){Wb=2;switch(mc.command){case J.a.openUrlInNewTab:Wb=this.Ni.Le(J.a.openUrlInNewTab,2,Mc);break;case J.a.QSa:Wb=this.Ni.Le(J.a.QSa,2,Mc)}return 2!==Wb?xa.Task.Ua(!0):ta.a(mc.command)}fd(Wb,mc){return mc.command===J.a.openUrlInNewTab||mc.command===J.a.QSa}Cd(Wb,mc,Mc){return"PopulateMruMenu"===mc?(this.Ni.Le(J.a.yxc,2,Mc),!0):
!1}yd(){return!1}}Object(d.a)(Nb,"OpenFromMruCommandHandler",null,[210]);class Tb extends Fa.a{constructor(Wb){super(Wb)}ue(){const Wb=Oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateCommonUiStrings",!1)?Object(fb.d)(pa.a.resolve(Ua.p,{Wa:this.La})):Ba.GetServiceTaskFactory.create(this.$.da,155,this.ka,this.La),mc=Ba.GetServiceTaskFactory.create(this.$.da,165,this.ka,this.La);fa.TaskExtensions.za(fa.TaskExtensions.xe([Wb,mc],this.ka),()=>{this.Zd([new Nb(this.$,t.AFrameworkApplication.dc)])},
this.ka,3)}static la(Wb){Fa.a.Ie(88,new Tb(Wb))}}Object(d.a)(Tb,"OpenFromMruCommandHandlerFactory",Fa.a,[]);var Vb=a(173),Jb=a(31),Qa=a(190),Db=a(162),sa=a(74),Ha=a(58),mb=a(216),qa=a(603),Xa=a(91),Ca=a(19),va=a(263),na=a(220),Ka=a(13);class ib extends na.a{constructor(Wb,mc,Mc,hd=null){super(Wb,Mc,2,hd);this.aSc=null;this.onResize=()=>{const pd=this.d8h();this.aPa.setAttribute("width",pd.x.toString());this.aPa.setAttribute("height",pd.y.toString());this.mek(pd);this.RJd()};this.HSe=mc;this.$.kA(this.onResize);
this.xkc()}get aPa(){return this.aSc}initialize(){const Wb=this.$.qc+"iframeDialog_frame",mc=this.$.qc+"iframeDialog";this.Kc.style.margin=U.HelperMethods.ud(0);this.Kc.style.marginBottom=U.HelperMethods.ud(-2);const Mc=document.createElement("iframe");Mc.id=Wb;Mc.frameBorder="0";Mc.scrolling="auto";Mc.src=this.naf(mc);this.Kc.appendChild(Mc);this.aSc=document.getElementById(Wb);this.domElement.id=mc;this.onResize(null,Sys.EventArgs.Empty);super.initialize()}dispose(){this.$&&this.$.$C(this.onResize);
super.dispose()}setFocus(){Ka.DOMElementExtensions.setFocus(this.aPa)}onHide(){this.aPa.contentWindow.close();Ka.DOMElementExtensions.tg(this.aPa);this.aSc=null;super.onHide()}mek(Wb){const mc=this.domElement.style;mc.width=U.HelperMethods.ud(Wb.x);mc.marginLeft=U.HelperMethods.ud(-Wb.x/2)}d8h(){const Wb=Ka.DOMElementExtensions.getBounds(document.body);return new Sys.UI.Point(Math.min(Math.floor(.9*Wb.width),this.HSe.x),Math.min(Math.floor(.9*Wb.height),this.HSe.y))}}Object(d.a)(ib,"IFrameDialog",
na.a,[]);var Ra=a(7),ka=a(83),da=a(16);class kb extends ib{constructor(Wb){super(Wb,new Sys.UI.Point(960,680),da.a.instance.ha(1264));this.name=Ra.a.bXe}get dd(){return"EmbeddingDialog"}naf(Wb){const mc=new Sys.StringBuilder(this.$.xa.EmbedConfiguratorUrl);mb.a.Ml(mc,Ra.a.qGh,Wb);ka.a(this.$.xa,32)&&mb.a.Ml(mc,Ra.a.fZe,"1");ka.a(this.$.xa,33)&&mb.a.Ml(mc,Ra.a.gZe,"1");ka.a(this.$.xa,34)&&mb.a.Ml(mc,Ra.a.eZe,"1");return mc.toString()}onShow(){l.ULS.sendTraceTag(537151690,0,50,"EmbeddingDialog.OnShow: the dialog is being shown");
super.onShow()}}Object(d.a)(kb,"EmbeddingDialog",ib,[]);var Ob=a(894),lc=a(92),tc=a(64),Pb=a(771);class tb{}tb.bgg="FrameDialog_ShareFromEdit";tb.view="FrameDialog_View";tb.OKe="FrameDialog_CloseAndRefresh";tb.NSj="FrameDialog_ShareFromView";tb.edit="FrameDialog_Edit";tb.ntj="FrameDialog_RefreshGrid";tb.Ufh="FrameDialog_CloseMe";tb.YKe="FrameDialog_CloseMeError";tb.ready="FrameDialog_Ready";tb.kjj="FrameDialog_PleaseClose";tb.QL="GotoRange";Object(d.a)(tb,"PostMessageConstants",null,[]);var gc=a(323),
Xb=a(119),Ga=a(231);class Za{constructor(){this.QL=null;this.vNd=1461300262}}Object(d.a)(Za,"SessionUpdateContext",null,[]);class Sb extends ib{constructor(Wb,mc,Mc){super(Wb,new Sys.UI.Point(Sb.Fvh,Sb.dvh),da.a.instance.ha(mc?1269:1268));this.Q4a=null;this.tTc=!1;this.ewc=hd=>{const pd=this.$,Nd=new Za;Nd.QL=hd.Values[tb.QL];let Xd=!1;switch(hd.MessageId){case tb.bgg:this.Ew();Xd=!0;Nd.vNd=1334518759;break;case tb.view:this.rra=da.a.instance.ha(1269);this.Oug(!0);break;case tb.OKe:this.Ew(),Xd=!0}hd=
new ca.a(140,0,(ae,Ve,we)=>gc.o(pd.qa.va,ra.b(ae,this.Vbj),Ve,we,Nd));hd.flags=Xd?16:80;pd.userOperationManager.Bd(hd,this.je)};this.E4i=()=>{const hd=this.$;hd.xa.SurveyRedirectUrl?(this.Ew(),hd.Ed(1305810481,0,8,null)):(this.rra=da.a.instance.ha(1268),this.Oug(!1))};this.jcj=()=>{const hd=this.$;this.Ew();hd.Ed(1334518759,0,8,null)};this.AKb=hd=>{const pd=this.$;this.Ew();hd.MessageId===tb.YKe&&pd.ea.fkd()};this.vaj=()=>{this.tTc=!0;this.raiseEvent(Sb.oCd)};this.Vbj=(hd,pd)=>{if(!Ga.a(hd)){hd=this.$;
if(pd.QL){const Nd=hd.ea.ua;if(Nd.contains(pd.QL.SheetName))this.Yuc(pd);else{let Xd=null;Xd=()=>{Nd.Qpa(Xd);this.Yuc(pd)};Nd.yja(Xd)}}1461300262!==pd.vNd&&hd.Ed(pd.vNd,0,8,null)}};this.c_a=mc;this.je=Mc}WXg(Wb){this.addHandler(Sb.oCd,Wb)}$yj(Wb){this.removeHandler(Sb.oCd,Wb)}get dd(){return"FormDialog"}get qsf(){return this.tTc}get bab(){return this.c_a}dispose(){lc.a.Ka(this.Q4a);this.Q4a=null;super.dispose()}initialize(){super.initialize();const Wb=tc.a.ML(this.$.xa.FormLightBoxUrl),mc=this.Q4a=
new Ob.a(this.aPa.contentWindow,Wb);mc.isEnabled()&&mc.$Q(Wb)&&(this.Kpa(tb.bgg,this.ewc),this.Kpa(tb.view,this.ewc),this.Kpa(tb.OKe,this.ewc),this.Kpa(tb.NSj,this.jcj),this.Kpa(tb.edit,this.E4i),this.Kpa(tb.ntj,this.ewc),this.Kpa(tb.ready,this.vaj),this.Kpa(tb.Ufh,this.AKb),this.Kpa(tb.YKe,this.AKb))}close(Wb){Wb===this.RN&&this.qsf&&this.Q4a.send(new Pb.a(tb.kjj))||super.close(Wb)}naf(){return this.uPe(this.bab)}uPe(Wb){const mc=this.$.xa,Mc=new Sys.StringBuilder(mc.FormLightBoxUrl);mb.a.Ml(Mc,
Ra.a.jWh,this.$.ea.sessionId);mb.a.Ml(Mc,Ra.a.hWh,Wb?Ra.a.iWh:Ra.a.gWh);Xb.a.Xsb(Mc,mc);return Mc.toString()}Oug(Wb){this.tTc=!1;this.aPa.src=this.uPe(Wb);this.c_a=Wb}Kpa(Wb,mc){this.Q4a.wn(Wb);this.Q4a.ql(Wb,mc)}Yuc(Wb){const mc=this.$.ea.ua.getItemByName(Wb.QL.SheetName);mc&&0===mc.qB&&Ca.h(this.$).Eh(Wb.QL,null,null,null,20,"FormDialog.OnItemInserted")}}Sb.Fvh=900;Sb.dvh=1200;Sb.oCd="lightBoxReady";Object(d.a)(Sb,"FormDialog",ib,[239]);var sb;(function(Wb){Wb[Wb.comment=10]="comment";Wb[Wb.range=
12]="range";Wb[Wb.table=13]="table";Wb[Wb.chart=14]="chart";Wb[Wb.sheet=15]="sheet"})(sb||(sb={}));Object(d.b)("NavigationType",sb);var bc=a(1027),kc=a(132),vb=a(20),ub=a(571),Ub=a(998),Rd=a(295),Cd=a(785),Yc=a(54);class Kd extends Cd.a{constructor(Wb,mc,Mc,hd,pd,Nd=0,Xd){super(Wb,da.a.instance.ha(mc),!1);this.Bc=null;this.message=Mc;this.u0i=hd;this.o9d=pd;this.operationFlags=Nd;this.Bc=Xd}get dd(){return"WebMethodConfirmationDialog"}get oD(){return 1005}get XKa(){return this.operationFlags}initialize(){let Wb=
"<div class='"+kc.a.Ft+"'>\r\n\t<div class='"+kc.a.rZe+"'>\r\n\t\t<div class='"+vb.a.GKe+"'>\r\n\t\t\t<img src='{0}' class='"+vb.a.d1e+"' alt='{1}' />\r\n\t\t</div>\r\n\t</div>\r\n\t<div class='"+kc.a.tZe+"'>\r\n\t\t<p>{2}</p>\r\n\t</div>\r\n</div>";Wb=String.format(Wb,Yc.a.yg(13),da.a.instance.ha(25),da.a.instance.ha(this.message));this.Bc.Yh(this.Kc,Wb);this.addButton(0,this.u0i);this.addButton(1);super.initialize()}CI(){return this.o9d}}Object(d.a)(Kd,"WebMethodConfirmationDialog",Cd.a,[]);class oc extends bc.a{constructor(Wb,
mc){super(Wb,da.a.instance.ha(1271));this.Bc=this.zXa=this.eVa=this.textBox=null;this.$Sf=()=>{const Mc=this.$;this.Ew();const hd=new Kd(Mc,1274,1275,1276,(pd,Nd,Xd)=>{var ae=Mc.qa.va.Lc(),Ve=Mc.qa.va;ae=Ve.Pa(1,ae);return nb.g(Ve,"UnshareForm",ae,pd,Nd,Xd,null,0)},16,this.Bc);hd.initialize();hd.ah()};this.Bc=mc}get dd(){return"ShareFormDialog"}dispose(){this.zXa&&this.zXa.P9(this.$Sf);lc.a.ed([this.textBox,this.eVa,this.zXa]);this.zXa=this.eVa=this.textBox=null;super.dispose()}initialize(){let Wb=
"<div class='"+kc.a.Ft+"'>\r\n\t<span>{0}</span>\r\n</div>\r\n<div class='"+kc.a.Qdc+"'>\r\n\t<input type='text' id='{1}' class='"+kc.a.zL+"' aria-live='polite' aria-atomic='true'/>\r\n\t<br />\r\n\t<a href='#' id='{2}' class='{3}'>{4}</a>\r\n</div>";Wb=String.format(Wb,da.a.instance.ha(1272),"sfd_input","sfd_unshare",vb.a.Pq,da.a.instance.ha(1273));this.Bc.Yh(this.Kc,Wb);this.textBox=new Rd.a(this.getElementById("sfd_input"));this.eVa=new Ub.a(this.textBox.domElement);this.zXa=ub.a.create(this.getElementById("sfd_unshare"));
this.zXa.d_(this.$Sf);this.textBox.text=da.a.instance.ha(736);this.textBox.enabled=!1;this.textBox.readOnly=!Jb.a.Fh;this.addButton(1,10);super.initialize()}e3a(){return(Wb,mc,Mc)=>{var hd=this.$.qa.va.Lc(),pd=this.$.qa.va;Wb=this.E7a(Wb);mc=this.FNa(mc);hd=pd.Pa(1,hd);return nb.g(pd,"ShareForm",hd,Wb,mc,Mc,null,0)}}U1(Wb,mc,Mc){this.textBox.text=Wb.Result;this.textBox.enabled=!0;Ka.DOMElementExtensions.setVisible(this.zXa.domElement,!0);super.U1(Wb,mc,Mc)}setFocus(){if(this.textBox&&this.textBox.enabled)try{this.textBox.focus();
return}catch(Wb){}super.setFocus()}}Object(d.a)(oc,"ShareFormDialog",bc.a,[]);var eb=a(259),yb=a(8),zc=a(87),dd=a(266),od=a(77),Ed=a(641),ce=a(153),wc=a(433),ed=a(267),md=a(17),Yd=a(265),$d=a(30);class bd extends Qa.a{constructor(Wb,mc,Mc){super();this.oHe=this.pHe=!1;this.K6a=0;this.yla=!1;this.R1i=()=>{this.pHe=!0;this.mig()};this.$=Wb;this.Ya=mc;this.LL=Mc;od.a(this.$).YQd(new ce.a(yb.a.Gsg,yb.a.idle,bd.Jch),new eb.a(yb.a.WKe,yb.a.K1,null,yb.a.xQ,yb.a.idle))}get wLc(){return X.b(this.$.Df)}get PVd(){return this.$.isEditMode&&
(this.$.ea.CBh||this.$.yS)}yd(Wb,mc){switch(mc){case 353606613:case -1099009678:case 192430811:return!Oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.Lgg();case 783415632:return!Oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)||this.Lgg();case 869186573:return this.Mgg();case -1570751769:case 1986648902:return 131072!==(this.$.qW&131072);case 330035228:return!(this.d7a(!0)&&this.wLc);case -509039657:return!(this.d7a()&&this.wLc);
case 1334518759:return!(this.d7a()&&this.wLc&&this.DHe())}return!1}Lgg(){return this.$.ea.isNamedObjectViewMode||this.$.isMobileMode||this.Mgg()}Mgg(){const Wb=this.$.workbookContext.FullDocumentInfo,mc=ed.a()&&this.$.ea.Dh.get(5);return!Wb.FileSharingUrl&&!mc}executeCommand(Wb,mc,Mc){Wb=this.$.workbookContext.FullDocumentInfo;var hd=J.a.workflow,pd=fa.TaskExtensions.Ik();const Nd=mc.command;if(Nd===hd||-266099===Nd)return this.Kni(mc,hd,Wb);switch(Nd){case 1986648902:this.rfg();break;case -1570751769:this.bli(mc);
break;case 869186573:mc=J.a.MSj;pd=t.AFrameworkApplication.fa.ra("ShareMenuIsEnabled");hd=null;(Oa.EwaSettings.ya(478)||pd)&&Mc&&"CopyLink"===Mc.SourceControlId?(hd={},hd[O.a.Khb]="copy",mc=J.a.tZd):pd&&Mc&&"ManageAccess"===Mc.SourceControlId?(hd={},hd[O.a.Khb]="manageAccess",mc=J.a.OSj):Mc&&"LinkToComment"===Mc.SourceControlId?(hd={},hd[O.a.Khb]="copy",hd[O.a.uZd]=Mc.navId,mc=J.a.tZd):$d.a.Ftf()&&Mc&&"SaveAsCopyLink"===Mc.SourceControlId&&(hd={},hd[O.a.Khb]="copy",mc=J.a.tZd);pd=this.wjg(Wb,hd);
y.c(mc);break;case -1099009678:pd=this.mEc(12,Wb);break;case 192430811:pd=this.mEc(13,Wb);break;case 353606613:pd=this.mEc(14,Wb);break;case 783415632:Mc&&"LinkToThisSheet"===Mc.SourceControlId&&l.ULS.sendTraceTag(509691100,0,50,"SocialSharingCommandHandler.ExecuteCommand: Share Sheet invoked from Collab Corner");pd=this.mEc(15,Wb);break;case -59906385:case 1197060601:this.Pmi(mc,Wb);break;case 1305810481:this.Xhf(!1,mc);break;case 330035228:this.Xhf(!0,mc);break;case -509039657:Mc=Object(fb.d)(pa.a.resolve(Ua.W,
{Wa:0}));fa.TaskExtensions.za(Mc,Xd=>{this.deleteForm(Xd.result)},this.$.ka,3);break;case 1334518759:mc.QEb=!0;Mc=Object(fb.d)(pa.a.resolve(Ua.W,{Wa:0}));fa.TaskExtensions.za(Mc,Xd=>{this.shareForm(Xd.result)},this.$.ka,3);break;case 710925581:Ha.a.qh.EEc("710925581")&&(pd=fa.TaskExtensions.za(this.LL.value,Xd=>{Xd.result.sendMessage(B.a.conversation,{})},this.ka,3));break;case 327119921:this.Mki();break;default:pd=ta.a(Nd)}return pd}fd(Wb,mc){Wb=!1;mc=mc.command;if(mc===J.a.workflow)return!0;switch(mc){case 1986648902:case -1570751769:case 869186573:case -59906385:case 1197060601:case 1305810481:case 330035228:case -509039657:case 1334518759:case -266099:case 710925581:case 327119921:Wb=
!0;break;case 353606613:case -1099009678:case 192430811:Wb=Oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)&&!this.$.ea.isNamedObjectViewMode;break;case 783415632:Wb=Oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)&&!this.$.ea.isNamedObjectViewMode}return Wb}Cd(Wb,mc,Mc){if("PopulateFormMenu"===mc){mc=this.wLc?this.DHe()?bd.kQh:bd.lQh:bd.SYi;Wb=this.Ya.zd();for(let hd=0;hd<mc.length;hd++)Wb.buttons.push(this.Ya.Vb(mc[hd]));mc=this.Ya.Er("Forms.Flyout");
mc.hd.push(Wb);Mc.MenuItems=mc.$F();return!0}return!1}Kni(Wb,mc,Mc){return this.PVd&&Wb.command===mc?(this.NVd(Wb,-266099),fa.TaskExtensions.Kda()):fa.TaskExtensions.za(this.LL.value,hd=>{qa.a(hd.result,B.a.workflow,null,Mc.WorkflowPostMessage)||U.HelperMethods.Vf(Mc.WorkflowUrl,"_blank",void 0,"SocialSharingCommandHandler.WorkflowUrl")},this.ka,3)}DHe(){return!!this.$.workbookContext.FullDocumentInfo.ShareFormCommandUrl||this.$.ea.Dh.get(26)}Mki(){var Wb=Vb.a.create().toString();l.ULS.sendTraceTag(528581128,
306,50,`Calling share to teams deeplink with ID: ${Wb}`);var mc=this.$.frame,Mc=mc.wcb,hd=this.$;const pd=new Yd.QueryStringBuilder(t.AFrameworkApplication.fa.Va("TeamsMeetingShareEndpoint"));pd.Tj("deeplinkId",Wb);pd.Tj("lm","deeplink");Wb=pd.Tj;var Nd={};const Xd=new Yd.QueryStringBuilder(t.AFrameworkApplication.fa.Va("TeamsAppSharingUrl"));Xd.Tj("auth","2");Xd.Tj("flight","officeunihost");Xd.Tj("source","TEAMS-ELECTRON.meetingStage.deeplink");var ae={};ae.fileType=x.a.Z6(hd.workbookContext.FullDocumentInfo.WorkbookPath).substring(1);
ae.objectUrl=hd.workbookContext.FullDocumentInfo.WorkbookPath;ae.baseUrl=hd.workbookContext.FullDocumentInfo.BreadcrumbBrandUrl;{hd=hd.workbookContext.WorkbookFileVersionId;let Ve=decodeURIComponent(hd);for(;hd!=Ve;)hd=Ve,Ve=decodeURIComponent(hd);0>hd.indexOf("{")||0>hd.indexOf("}")?(l.ULS.sendTraceTag(528250338,306,15,`Decoded fileId does not match expected format. Decoded id: ${hd}`),hd=""):hd=hd.substring(hd.indexOf("{")+1,hd.indexOf("}")).toLowerCase()}ae.fileId=hd;ae=Ea.c(Ea.c(ae));Xd.Tj("subEntityId",
ae.substring(1,ae.length-1));Nd.appSharingUrl=Xd.toString();Nd.appId=t.AFrameworkApplication.fa.Va("TeamsAppId");Nd.useMeetNow=Oa.EwaSettings.isChangeGateEnabled("OfficeVSO:7569119_MeetNowIsEnabled");Nd=JSON.stringify(Nd);Wb.call(pd,"appContext",Nd);Mc.call(mc,pd.toString(),!0)}bli(Wb){this.PVd?this.NVd(Wb,1986648902):this.rfg()}Xhf(Wb,mc){!Wb&&this.$.xa.SurveyRedirectUrl?this.Dnj():(Wb=new Sb(this.$,Wb,mc),Wb.initialize(),Wb.ah())}Pmi(Wb,mc){this.PVd&&1197060601===Wb.command?this.NVd(Wb,-59906385):
fa.TaskExtensions.za(this.LL.value,Mc=>{Mc=Mc.result;Mc&&qa.a(Mc,B.a.replyWithChanges,null,this.$.ea.Dh.get(8))||(Mc=new Sys.StringBuilder(mc.ReplyWithChangesUrl),mb.a.Ml(Mc,wc.e,wc.d),Db.a.ntw(Mc.toString(),this.$))},this.ka,3)}NVd(Wb,mc){const Mc=od.a(this.$).$d.activityState,hd=new Xa.a(mc,Wb.method,Wb.mode,Wb.Jf,Wb.tabName);lb.a(this.$).Ys(new va.a(yb.a.Qx,5,()=>{Mc[dd.a.Fq]=yb.a.u$f;Mc[Ed.a.n1c]=hd;this.$.Vl.jA("SocialSharingSaveBeforeCommand");this.$.Vl.Wwe(hd.command)}))}rfg(){const Wb=this.$.xa.DocumentHostInfo;
Wb.HostEmbeddedViewUrl||this.pHe?this.mig():this.$.Xe.get(53)&&fa.TaskExtensions.za(this.LL.value,mc=>{this.Tak(mc.result)||Db.a.ntw(Wb.FileEmbedCommandUrl,this.$)},this.ka,3)}Tak(Wb){return Wb.isEnabled()&&(this.oHe||(this.oHe=Wb.ql(B.a.nHe,this.R1i)))?Wb.sendMessage(B.a.ORh,null):!1}mig(){if(Jb.a.rq)Db.a.ntw(this.$.xa.EmbedConfiguratorUrl,this.$);else{const Wb=new kb(this.$);Wb.initialize();Wb.ah()}}deleteForm(Wb){const mc=this.$;Wb=new Kd(mc,1277,1278,1270,(Mc,hd,pd)=>{var Nd=mc.qa.va.Lc(),Xd=
mc.qa.va;Nd=Xd.Pa(9,Nd);Nd.surveyId=null;return nb.g(Xd,"DeleteSurvey",Nd,Mc,hd,pd,null,0)},0,Wb);Wb.initialize();Wb.ah()}shareForm(Wb){const mc=this.$.workbookContext.FullDocumentInfo;this.$.ea.Dh.get(26)?(Wb=new oc(this.$,Wb),Wb.initialize(),Wb.ah()):fa.TaskExtensions.za(this.LL.value,Mc=>{qa.a(Mc.result,B.a.shareForm,{[O.a.v4j]:this.$.workbookContext.SurveyTitle},this.$.ea.Dh.get(10))||Db.a.ntw(mc.ShareFormCommandUrl,this.$)},this.ka,3)}Dnj(){const Wb=this.$;Wb.xa.SurveyRedirectUrl.replace(RegExp("&startupdialog=[formedit|formpreview]",
"gi"),"");const mc=new Sys.StringBuilder(Wb.xa.SurveyRedirectUrl);mb.a.Ml(mc,"startupDialog","FormEdit");const Mc=od.a(this.$),hd=Mc.$d.activityState;hd[zc.a.T4]=mc.toString();hd[zc.a.AN]=zc.a.JGd;this.$.Vl.jA("SocialSharingEnvironmentChange");lb.a(Wb).Ys(new va.a(yb.a.Qx,5,()=>{const pd=ja.a.Wd(3,2,1322,1323,1324,554412057,"FossEnvironmentUnsupported");Mc.$d.xs([pd]);hd[dd.a.Fq]=yb.a.Gsg}))}d7a(Wb=!1){return(this.$.ea.isEditMode||Wb)&&this.$.ea.Dh.get(25)&&ed.a()}Vei(Wb){var mc=Ca.h(this.$).ga;let Mc=
!1;const hd=this.$.ua.na?sa.d(this.$.ua.na):null;if(!hd)return l.ULS.sendTraceTag(537151649,0,10,`SocialSharingCommandHandler.GetSharingDetail: Unable to find current sheet id for navType: ${sb[Wb]}.`),null;var pd=null;14===Wb?pd=this.sei(mc):12===Wb?(pd=mc.Uka,pd=ma.a.contains(pd,"!",!0)?pd.split("!")[1]:pd,Ca.h(this.$).ga.pa.WL()&&(Mc=!0)):13===Wb&&(mc=mc.pa.selectedRanges,mc[0]&&(mc=Ca.h(this.$).Wb.rh(mc[0])))&&(pd=mc.ek);if(!pd&&15!==Wb)return l.ULS.sendTraceTag(537151648,0,10,`SocialSharingCommandHandler.GetSharingDetail: Unable to find the selected range reference or object id for navType: ${sb[Wb]}`),
null;mc={};mc[O.a.Khb]="copy";mc[O.a.uZd]=this.w5h(Wb,pd,hd);mc[O.a.PSj]="deepLinkShare";l.ULS.sendTraceTag(537151647,0,50,`SocialSharingCommandHandler.GetSharingDetail: Send Section_Sharing post message with navType: ${sb[Wb]} and sectionNameOrId: ${pd} and SheetId: ${hd} and isPartialTable: ${Mc}`);return mc}sei(Wb){if(Wb.Sa.DS&&(Wb=Wb.Sa.Pc.floatingObject)&&0===Wb.type){const mc=Wb.id.split(".");if(1<mc.length)return mc[1];l.ULS.sendTraceTag(537151646,0,10,`SocialSharingCommandHandler.GetSelectedFloatingObjectXluid: Invalid floating object id =  ${Wb.id}`)}return null}w5h(Wb,
mc,Mc){let hd=Wb+"_";hd=btoa(15===Wb?hd+Mc:hd+(mc+"_"+Mc));hd=hd.replace(RegExp("\\+","g"),"-");hd=hd.replace(RegExp("\\/","g"),"_");return hd=hd.replace(RegExp("\\=+$","g"),"")}wjg(Wb,mc,Mc=!1){return fa.TaskExtensions.za(this.LL.value,hd=>{qa.a(hd.result,B.a.sharing,mc,this.$.ea.Dh.get(5))?(l.ULS.sendTraceTag(537151644,0,50,`SocialSharingCommandHandler.ShowShareDialog: Send UI_Sharing post message with mode: ${mc?mc[O.a.Khb]:""}`),Mc&&Oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",
!1)&&Oa.EwaSettings.isChangeGateEnabled("OfficeVSO:7750148_DeepLinkCreationSurveyFPS")&&!this.yla&&(this.K6a=window.setInterval(()=>{this.K9j()},6E4),this.yla=!0)):U.HelperMethods.Vf(Wb.FileSharingUrl,"_blank",void 0,"SocialSharingCommandHandler.FileSharingUrl")},this.ka,3)}mEc(Wb,mc){if(15===Wb&&!Oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)||15!==Wb&&!Oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.$.isMobileMode)return null;
const Mc=this.Vei(Wb);if(Mc)return l.ULS.sendTraceTag(520737606,0,50,`SocialSharingCommandHandler.ShareExcelSection: Calling share dialog with nav id=${Mc[O.a.uZd]}`),this.wjg(mc,Mc,!0);l.ULS.sendTraceTag(537151643,0,10,`SocialSharingCommandHandler.ShareExcelSection: Unable to get the sharing details for navType: ${sb[Wb]}`);return null}K9j(){this.yla&&window.clearInterval(this.K6a);Oa.EwaSettings.isChangeGateEnabled("OfficeVSO:7750148_DeepLinkCreationSurveyFPS")&&(this.$.Ed(638984051,0,0,null),l.ULS.sendTraceTag(512328542,
0,50,"SocialSharingCommandHandler.triggerDeepLinkCreationSurvey: FPS survey got triggered."))}}bd.SYi=[103];bd.kQh=[107,104,105,106];bd.lQh=[104,105];bd.Jch=[new md.a(yb.a.WKe,554412057,0,0,1325),new md.a(yb.a.idle,554412057,0,1)];Object(d.a)(bd,"SocialSharingCommandHandler",Qa.a,[210]);class Vd extends Fa.a{constructor(Wb){super(Wb)}ue(){const Wb=new h.a(()=>Ba.GetServiceTaskFactory.create(this.$.da,137,this.ka,this.La));fa.TaskExtensions.za(Ba.GetServiceTaskFactory.create(this.$.da,102,this.ka,
this.La),mc=>{this.Zd([new bd(this.$,mc.result,Wb)])},this.ka,3)}static la(Wb){Fa.a.Ie(114,new Vd(Wb))}}Object(d.a)(Vd,"SocialSharingCommandHandlerFactory",Fa.a,[]);var De=a(118);let Pe=class{constructor(Wb){this.Ni=Wb}executeCommand(Wb,mc,Mc){return 2!==this.Ni.Le(J.a.tryOfficeThroughTellMe,2,Mc)?xa.Task.Ua(!0):ta.a(mc.command)}fd(Wb,mc){return 215809929===mc.command}Cd(){return!1}yd(){return!1}};Pe=Object(De.b)([Object(pa.d)(Ua.Gb),Object(De.c)(0,Object(Ua.a)())],Pe);Object(d.a)(Pe,"TryOfficeThroughTellMeCommandHandler",
null,[210]);class Zb extends Fa.a{constructor(Wb){super(Wb)}ue(){this.Zd([new Pe(t.AFrameworkApplication.dc)])}static la(Wb){Fa.a.Ie(207,new Zb(Wb))}}Object(d.a)(Zb,"TryOfficeThroughTellMeCommandHandlerFactory",Fa.a,[]);var Vc=a(172),Nc=a(276),ld=a(156),yd=a(200);class sd{static DW(){return ld.a.lq(sd.cm,yd.a.Ha(444))}}sd.cm="<div class='namedsheetview_teaching_dialog_control' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_description_label' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_textarea' id='TextArea'> <label id='TeachingDescriptionId' class='WACDialogLabel' >{0}</label> </div> </div> </div>";
Object(d.a)(sd,"NamedSheetViewTeachingDialogHtml",null,[]);var ic=a(75),Ic=a(168),kd=a(55);class Hd extends Nc.a{constructor(Wb){super(Wb);this.stopwatch=this.Lu=null;this.cYi=mc=>{if(1===mc)this.$.Ia.mc(new Xa.a(-2050946363,ic.a.fc,2,8,null)).continueWith(Mc=>{this.Lu.setResult(!Ic.a(Mc)&&Mc.result)}),mc="Yes";else{const Mc=2===mc;this.Lu.setResult(Mc);mc=2===mc?"No":"Close";Mc&&this.dmj()}this.eRi(mc);this.hide()}}get dd(){return"ShowNamedSheetViewTeachingDialog"}sh(){this.Ac=4;this.stopwatch=this.$.yc.Fd("UserAction",
this.dd);const Wb=da.a.instance.ha(1913);this.Qg=sd.DW();this.Lu=new Vc.a;this.initializeAndShow(Wb,this.cYi,{});return this.Lu.task}Uz(Wb){super.Uz(Wb);this.Qc(1,da.a.instance.ha(1915));this.Qc(2,da.a.instance.Ha(457))}dmj(){this.$.ea.DGd=!1}eRi(Wb){const mc={};mc.a=this.$.xa.UserSessionId;mc.b="NamedSheetViewTeachingDialogClose";mc.c=Wb;mc.e=!0;this.stopwatch&&(this.stopwatch.stop(),mc.d=this.stopwatch.vd);kd.b().Of(53,mc,!0)}}Object(d.a)(Hd,"NamedSheetViewTeachingDialog",Nc.a,[]);var Ud=a(160);
let de=class{constructor(Wb){this.$=Wb;Object(qb.b)("OfficeVSO:7629405_namedSheetViewPublic_Migration")||Wb.da.Ja(309,this)}dWa(){return this.$Vj()?(new Hd(this.$)).sh():xa.Task.Ua(!0)}$Vj(){const Wb=this.$.ua.na;return this.$.ea.Kcb&&this.$.ea.DGd&&!Wb.Ze.yC&&this.$.ea.aO&&!Object(Ud.g)(this.$)}};de=Object(De.b)([Object(pa.d)(Ua.db),Object(De.c)(0,Object(Ua.E)())],de);Object(d.a)(de,"NamedSheetViewPublic",null,[490]);class qe extends zb.a{constructor(Wb){super();this.$=Wb;this.uc()}create(){this.$b(this.$.da.Ba(309)||
new de(this.$))}static la(Wb){Wb.da.Ja(310,new qe(Wb))}}Object(d.a)(qe,"NamedSheetViewPublicFactory",zb.a,[]);var fe=a(2),Ke=a(1394),Te=a(906),Se=a(469);class df{constructor(Wb,mc,Mc,hd,pd,Nd,Xd){this.title=Wb;this.body=mc;this.omj=Mc;this.primaryButtonAction=hd;this.secondaryButtonAction=Nd;this.Tag=pd;this.targetObject=Xd}}Object(d.a)(df,"NamedSheetViewTeachingCalloutContent",null,[]);class te{constructor(Wb){this.Qse=0;this.Qng=Wb}get Ong(){return this.Qse}get Onj(){return this.Ong<this.Qng.count?
this.Qng.ma(this.Qse++):null}}Object(d.a)(te,"NamedSheetViewTeachingCalloutList",null,[]);var gf=a(1068),cf;let bf=cf=class{constructor(Wb){this.$=Wb;this.stopwatch=this.I5b=this.CHc=this.R3d=null;this.Png=0}xti(Wb){this.Png=Wb;const mc=Object(fe.a)(new u.a,{});cf.nCi(Wb)?(mc.add(new df(da.a.instance.Ha(446),da.a.instance.Ha(447),da.a.instance.ha(1943),()=>{this.v8(2,"Continue");this.Zca(!0)},da.a.instance.ha(1944),()=>{this.Zca();this.v8(1,"ExitGuide")},gf.a())),1===Wb&&mc.add(new df(da.a.instance.ha(1945),
da.a.instance.Ha(449),da.a.instance.ha(1943),()=>{this.v8(2,"FirstEnterTempViewContinueSecond");this.Zca(!0)},da.a.instance.ha(1944),()=>{this.Zca();this.v8(1,"FirstEnterTempViewExitGuideSecond")},gf.a())),mc.add(new df(da.a.instance.Ha(450),da.a.instance.Ha(451),da.a.instance.ha(1943),()=>{this.v8(2,"FirstEnterExitCalloutContinue");this.Zca(!0)},da.a.instance.ha(1944),()=>{this.Zca();this.v8(1,"FirstEnterExitCalloutGuide")},cf.J$h())),mc.add(new df(da.a.instance.ha(1946),da.a.instance.Ha(448),da.a.instance.ha(1947),
()=>{this.LYj();this.Zca();this.v8(1,"LearnMore")},da.a.instance.ha(1948),()=>{this.Zca();this.v8(1,"Done")},cf.I$h()))):2===Wb&&mc.add(new df(da.a.instance.ha(1945),da.a.instance.Ha(449),da.a.instance.ha(1942),()=>{this.Zca();this.v8(1,"EnterTempViewAfterPersistedView")},null,null,gf.a()));this.R3d=new te(mc)}LYj(){const Wb=new Xa.a(-859308420,ic.a.fc,this.$.Tc,9,null);this.$.Ia.mc(Wb,{[ic.a.Og]:"HelpID=SheetViews",["InputMethod"]:ic.a.fc,[ic.a.Gd]:Ra.a.rS,["ShouldCanvasTakeFocus"]:!0})}show(Wb){this.xti(Wb);
this.mib()}jPj(Wb){this.I5b=Wb}mib(){var Wb=this.R3d.Onj;if(Wb){var mc=Object(fe.a)(new Ke.a,{label:Wb.omj,onExecute:Wb.primaryButtonAction}),Mc=null;Wb.Tag&&(Mc=Object(fe.a)(new Ke.a,{label:Wb.Tag,onExecute:Wb.secondaryButtonAction}));Wb=Object(fe.a)(new Te.a,{target:Wb.targetObject,content:Wb.body,title:Wb.title,showCloseIcon:!0,primaryButtonProps:mc,secondaryButtonProps:Mc,useTeachingStyles:!0});Wb=this.I5b.callout(Wb);mc=Object(fe.a)(new Se.a,{onShow:()=>{this.v8(0)}});this.CHc=this.I5b.addNotification(Wb,
mc)}}dismiss(){this.Zca();this.v8(1,"DismissedByOthers")}Zca(Wb=!1){this.CHc&&(this.I5b.removeNotification(this.CHc),this.CHc=null);Wb&&this.mib()}v8(Wb,mc=null){const Mc={};Mc.a=this.$.xa.UserSessionId;Mc.b=this.Png;Mc.c=this.R3d.Ong;Mc.d=Wb;Mc.e=mc;0===Wb?this.stopwatch=this.$.yc.Fd("UserAction","ShowNamedSheetViewTeachingCallout"):(this.stopwatch&&(this.stopwatch.stop(),Mc.f=this.stopwatch.vd,this.stopwatch=null),2===Wb&&(this.stopwatch=this.$.yc.Fd("UserAction","ShowNamedSheetViewTeachingCalloutNext")));
kd.b().Of(52,Mc,!0)}static I$h(){return document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv")}static J$h(){return document.querySelector("[data-unique-id=Ribbon-NamedSheetViewExit]")}static nCi(Wb){return 0===Wb||1===Wb}};bf=cf=Object(De.b)([Object(pa.d)(Ua.eb),Object(De.c)(0,Object(Ua.E)())],bf);Object(d.a)(bf,"NamedSheetViewTeachingCallout",null,[388]);class $a extends zb.a{constructor(Wb){super();this.$=Wb;this.uc()}create(){let Wb=this.$.da.Ba(322);Wb||(Wb=new bf(this.$),this.$.da.Ja(322,
Wb));this.$b(Wb)}static la(Wb){Wb.da.Ja(323,new $a(Wb))}}Object(d.a)($a,"NamedSheetViewTeachingCalloutFactory",zb.a,[]);var Y=a(126),Ta=a(382),Bb=a(107),Rb=a(383);class jc{constructor(Wb,mc){this.sheetName=null;this.value=!1;this.sheetName=Wb;this.value=mc}getSheetName(){return this.sheetName}Gya(){return this.value}}Object(d.a)(jc,"MacroRecorderSheetOptionToggledPayload",null,[144]);const vc=(Wb,mc,Mc,hd,pd,Nd,Xd,ae=null)=>{ae=Wb.Pa(9,ae);ae.sheetName=mc;ae.show=Mc;return nb.g(Wb,"ShowGridlines",
ae,hd,pd,Nd,Xd,0)},bb=(Wb,mc,Mc,hd,pd,Nd,Xd,ae=null)=>{ae=Wb.Pa(9,ae);ae.sheetName=mc;ae.show=Mc;return nb.g(Wb,"ShowHeadings",ae,hd,pd,Nd,Xd,0)},Mb=(Wb,mc,Mc,hd,pd,Nd,Xd,ae=null)=>{ae=Wb.Pa(9,ae);ae.sheetName=mc;ae.directionRtl=Mc;return nb.g(Wb,"ChangeSheetDirection",ae,hd,pd,Nd,Xd,0)};var hc;let Cc=hc=class{constructor(Wb){this.$=Wb}yd(){return!1}executeCommand(Wb,mc){const Mc={};this.$.Qk(Mc);Wb=mc.command;const hd=Object(Y.a)(Bb.a,this.$.ua.getItemByName(Mc.SheetName));if(!hd)return ta.a(Wb);
let pd,Nd,Xd,ae,Ve;switch(Wb){case 705559150:case -1411193626:pd=16;Nd=!hd.hideGridLines;Xd=vc;Ve=183;ae=hd.hideGridLines;break;case -2052321504:case 515737500:pd=4;Nd=!hd.headersVisible;Xd=bb;Ve=184;ae=!hd.headersVisible;break;case -1478455630:pd=2;Nd=!hd.displayRtl;Xd=Mb;Ve=185;ae=!hd.displayRtl;Ca.h(this.$).Ca.Bdk(Nd);break;default:return ta.a(Wb)}hd.Zub(pd,Nd);const we=()=>new jc(Mc.SheetName,ae),Mf=this.$.qa.va;return Ta.a(this.$.userOperationManager,(Ye,kf,Bf)=>Xd(Mf,Mc.SheetName,ae,ra.b(Ye,
vf=>{hc.zLb(vf,hd,pd,Nd)}),ra.a(kf,()=>{hc.JKb(hd,pd,Nd)}),Bf,null),Ye=>new ca.a(Ve,0,Ye,void 0,we),mc)}fd(Wb,mc){Wb=!1;switch(mc.command){case -1411193626:case 515737500:case -1478455630:Wb=!0;break;case 705559150:case -2052321504:Wb=Rb.a(this.$)}return Wb}Cd(){return!1}static zLb(Wb,mc,Mc,hd){ja.a.Iq(Wb.Errors)&&mc.Zub(Mc,!hd)}static JKb(Wb,mc,Mc){Wb.Zub(mc,!Mc)}};Cc=hc=Object(De.b)([Object(pa.d)(Ua.wb),Object(De.c)(0,Object(Ua.E)())],Cc);Object(d.a)(Cc,"SheetOptionsToggleCommandHandler",null,[210]);
Type.registerNamespace("Common.App.NewAndOpen.UX");hb.a.instance.wj(new wa);Ja.a.Fa(Sa.la);Ia.a.sj(".MsformCalloutContent{color:#fff;font-size:13pt;line-height:1;padding-right:5px;margin-bottom:12px;margin-top:-6px;padding-left:10px;width:90%}.MsFormCalloutOuter{background-color:#107c41;z-index:1030}");(()=>{Ja.a.Fa(Wb=>{Da.la(Wb)})})();(()=>{Ja.a.Fa(Wb=>{Wb.da.Ja(165,new Pa(Wb))})})();Ja.a.Fa(Tb.la);Ja.a.Fa(Vd.la);(()=>{Ja.a.Fa(Wb=>{Object(qb.b)("OfficeVSO:7624545_MigrateTryOfficeThroughTellMeCommandHandlerService")||
Zb.la(Wb)})})();(()=>{Ja.a.Fa(Wb=>{Object(qb.b)("OfficeVSO:7629405_namedSheetViewPublic_Migration")||(qe.la(Wb),$a.la(Wb))})})();String(b);String(e);String(c);String(f);window.___1684780685153_closurehack=b;window.___1684780685153_closurehack=e;window.___1684780685153_closurehack=c;window.___1684780685153_closurehack=f}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSOpt.kmhv.js.map/a986fc9b2724e874b7b9884a91c317af/EwaDSOpt.kmhv.js.map